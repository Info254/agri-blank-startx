function zW(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const c=Object.getOwnPropertyDescriptor(r,a);c&&Object.defineProperty(e,a,c.get?c:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var Oa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Loe(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),n}var NW={exports:{}},hP={},FW={exports:{}},bi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hw=Symbol.for("react.element"),zoe=Symbol.for("react.portal"),Noe=Symbol.for("react.fragment"),Foe=Symbol.for("react.strict_mode"),Boe=Symbol.for("react.profiler"),joe=Symbol.for("react.provider"),$oe=Symbol.for("react.context"),Uoe=Symbol.for("react.forward_ref"),Voe=Symbol.for("react.suspense"),Goe=Symbol.for("react.memo"),Woe=Symbol.for("react.lazy"),O$=Symbol.iterator;function Hoe(e){return e===null||typeof e!="object"?null:(e=O$&&e[O$]||e["@@iterator"],typeof e=="function"?e:null)}var BW={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jW=Object.assign,$W={};function fv(e,t,n){this.props=e,this.context=t,this.refs=$W,this.updater=n||BW}fv.prototype.isReactComponent={};fv.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};fv.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function UW(){}UW.prototype=fv.prototype;function dz(e,t,n){this.props=e,this.context=t,this.refs=$W,this.updater=n||BW}var fz=dz.prototype=new UW;fz.constructor=dz;jW(fz,fv.prototype);fz.isPureReactComponent=!0;var k$=Array.isArray,VW=Object.prototype.hasOwnProperty,pz={current:null},GW={key:!0,ref:!0,__self:!0,__source:!0};function WW(e,t,n){var r,a={},c=null,f=null;if(t!=null)for(r in t.ref!==void 0&&(f=t.ref),t.key!==void 0&&(c=""+t.key),t)VW.call(t,r)&&!GW.hasOwnProperty(r)&&(a[r]=t[r]);var i=arguments.length-2;if(i===1)a.children=n;else if(1<i){for(var v=Array(i),b=0;b<i;b++)v[b]=arguments[b+2];a.children=v}if(e&&e.defaultProps)for(r in i=e.defaultProps,i)a[r]===void 0&&(a[r]=i[r]);return{$$typeof:hw,type:e,key:c,ref:f,props:a,_owner:pz.current}}function qoe(e,t){return{$$typeof:hw,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mz(e){return typeof e=="object"&&e!==null&&e.$$typeof===hw}function Zoe(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var R$=/\/+/g;function lO(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Zoe(""+e.key):t.toString(36)}function FE(e,t,n,r,a){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(c){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case hw:case zoe:f=!0}}if(f)return f=e,a=a(f),e=r===""?"."+lO(f,0):r,k$(a)?(n="",e!=null&&(n=e.replace(R$,"$&/")+"/"),FE(a,t,n,"",function(b){return b})):a!=null&&(mz(a)&&(a=qoe(a,n+(!a.key||f&&f.key===a.key?"":(""+a.key).replace(R$,"$&/")+"/")+e)),t.push(a)),1;if(f=0,r=r===""?".":r+":",k$(e))for(var i=0;i<e.length;i++){c=e[i];var v=r+lO(c,i);f+=FE(c,t,n,v,a)}else if(v=Hoe(e),typeof v=="function")for(e=v.call(e),i=0;!(c=e.next()).done;)c=c.value,v=r+lO(c,i++),f+=FE(c,t,n,v,a);else if(c==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return f}function WT(e,t,n){if(e==null)return e;var r=[],a=0;return FE(e,r,"","",function(c){return t.call(n,c,a++)}),r}function Xoe(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var vs={current:null},BE={transition:null},Koe={ReactCurrentDispatcher:vs,ReactCurrentBatchConfig:BE,ReactCurrentOwner:pz};function HW(){throw Error("act(...) is not supported in production builds of React.")}bi.Children={map:WT,forEach:function(e,t,n){WT(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return WT(e,function(){t++}),t},toArray:function(e){return WT(e,function(t){return t})||[]},only:function(e){if(!mz(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};bi.Component=fv;bi.Fragment=Noe;bi.Profiler=Boe;bi.PureComponent=dz;bi.StrictMode=Foe;bi.Suspense=Voe;bi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Koe;bi.act=HW;bi.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=jW({},e.props),a=e.key,c=e.ref,f=e._owner;if(t!=null){if(t.ref!==void 0&&(c=t.ref,f=pz.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(v in t)VW.call(t,v)&&!GW.hasOwnProperty(v)&&(r[v]=t[v]===void 0&&i!==void 0?i[v]:t[v])}var v=arguments.length-2;if(v===1)r.children=n;else if(1<v){i=Array(v);for(var b=0;b<v;b++)i[b]=arguments[b+2];r.children=i}return{$$typeof:hw,type:e.type,key:a,ref:c,props:r,_owner:f}};bi.createContext=function(e){return e={$$typeof:$oe,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:joe,_context:e},e.Consumer=e};bi.createElement=WW;bi.createFactory=function(e){var t=WW.bind(null,e);return t.type=e,t};bi.createRef=function(){return{current:null}};bi.forwardRef=function(e){return{$$typeof:Uoe,render:e}};bi.isValidElement=mz;bi.lazy=function(e){return{$$typeof:Woe,_payload:{_status:-1,_result:e},_init:Xoe}};bi.memo=function(e,t){return{$$typeof:Goe,type:e,compare:t===void 0?null:t}};bi.startTransition=function(e){var t=BE.transition;BE.transition={};try{e()}finally{BE.transition=t}};bi.unstable_act=HW;bi.useCallback=function(e,t){return vs.current.useCallback(e,t)};bi.useContext=function(e){return vs.current.useContext(e)};bi.useDebugValue=function(){};bi.useDeferredValue=function(e){return vs.current.useDeferredValue(e)};bi.useEffect=function(e,t){return vs.current.useEffect(e,t)};bi.useId=function(){return vs.current.useId()};bi.useImperativeHandle=function(e,t,n){return vs.current.useImperativeHandle(e,t,n)};bi.useInsertionEffect=function(e,t){return vs.current.useInsertionEffect(e,t)};bi.useLayoutEffect=function(e,t){return vs.current.useLayoutEffect(e,t)};bi.useMemo=function(e,t){return vs.current.useMemo(e,t)};bi.useReducer=function(e,t,n){return vs.current.useReducer(e,t,n)};bi.useRef=function(e){return vs.current.useRef(e)};bi.useState=function(e){return vs.current.useState(e)};bi.useSyncExternalStore=function(e,t,n){return vs.current.useSyncExternalStore(e,t,n)};bi.useTransition=function(){return vs.current.useTransition()};bi.version="18.3.1";FW.exports=bi;var X=FW.exports;const Se=Bi(X),gz=zW({__proto__:null,default:Se},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yoe=X,Joe=Symbol.for("react.element"),Qoe=Symbol.for("react.fragment"),eae=Object.prototype.hasOwnProperty,tae=Yoe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nae={key:!0,ref:!0,__self:!0,__source:!0};function qW(e,t,n){var r,a={},c=null,f=null;n!==void 0&&(c=""+n),t.key!==void 0&&(c=""+t.key),t.ref!==void 0&&(f=t.ref);for(r in t)eae.call(t,r)&&!nae.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Joe,type:e,key:c,ref:f,props:a,_owner:tae.current}}hP.Fragment=Qoe;hP.jsx=qW;hP.jsxs=qW;NW.exports=hP;var he=NW.exports,ZW={exports:{}},xl={},XW={exports:{}},KW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Ne,Xe){var pt=Ne.length;Ne.push(Xe);e:for(;0<pt;){var zt=pt-1>>>1,Ft=Ne[zt];if(0<a(Ft,Xe))Ne[zt]=Xe,Ne[pt]=Ft,pt=zt;else break e}}function n(Ne){return Ne.length===0?null:Ne[0]}function r(Ne){if(Ne.length===0)return null;var Xe=Ne[0],pt=Ne.pop();if(pt!==Xe){Ne[0]=pt;e:for(var zt=0,Ft=Ne.length,un=Ft>>>1;zt<un;){var Tn=2*(zt+1)-1,fn=Ne[Tn],Cn=Tn+1,Vt=Ne[Cn];if(0>a(fn,pt))Cn<Ft&&0>a(Vt,fn)?(Ne[zt]=Vt,Ne[Cn]=pt,zt=Cn):(Ne[zt]=fn,Ne[Tn]=pt,zt=Tn);else if(Cn<Ft&&0>a(Vt,pt))Ne[zt]=Vt,Ne[Cn]=pt,zt=Cn;else break e}}return Xe}function a(Ne,Xe){var pt=Ne.sortIndex-Xe.sortIndex;return pt!==0?pt:Ne.id-Xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var f=Date,i=f.now();e.unstable_now=function(){return f.now()-i}}var v=[],b=[],T=1,A=null,M=3,R=!1,B=!1,L=!1,j=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H(Ne){for(var Xe=n(b);Xe!==null;){if(Xe.callback===null)r(b);else if(Xe.startTime<=Ne)r(b),Xe.sortIndex=Xe.expirationTime,t(v,Xe);else break;Xe=n(b)}}function K(Ne){if(L=!1,H(Ne),!B)if(n(v)!==null)B=!0,ot(Y);else{var Xe=n(b);Xe!==null&&Je(K,Xe.startTime-Ne)}}function Y(Ne,Xe){B=!1,L&&(L=!1,V(ye),ye=-1),R=!0;var pt=M;try{for(H(Xe),A=n(v);A!==null&&(!(A.expirationTime>Xe)||Ne&&!je());){var zt=A.callback;if(typeof zt=="function"){A.callback=null,M=A.priorityLevel;var Ft=zt(A.expirationTime<=Xe);Xe=e.unstable_now(),typeof Ft=="function"?A.callback=Ft:A===n(v)&&r(v),H(Xe)}else r(v);A=n(v)}if(A!==null)var un=!0;else{var Tn=n(b);Tn!==null&&Je(K,Tn.startTime-Xe),un=!1}return un}finally{A=null,M=pt,R=!1}}var se=!1,ce=null,ye=-1,ze=5,Le=-1;function je(){return!(e.unstable_now()-Le<ze)}function Re(){if(ce!==null){var Ne=e.unstable_now();Le=Ne;var Xe=!0;try{Xe=ce(!0,Ne)}finally{Xe?$e():(se=!1,ce=null)}}else se=!1}var $e;if(typeof $=="function")$e=function(){$(Re)};else if(typeof MessageChannel<"u"){var Ge=new MessageChannel,ht=Ge.port2;Ge.port1.onmessage=Re,$e=function(){ht.postMessage(null)}}else $e=function(){j(Re,0)};function ot(Ne){ce=Ne,se||(se=!0,$e())}function Je(Ne,Xe){ye=j(function(){Ne(e.unstable_now())},Xe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ne){Ne.callback=null},e.unstable_continueExecution=function(){B||R||(B=!0,ot(Y))},e.unstable_forceFrameRate=function(Ne){0>Ne||125<Ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ze=0<Ne?Math.floor(1e3/Ne):5},e.unstable_getCurrentPriorityLevel=function(){return M},e.unstable_getFirstCallbackNode=function(){return n(v)},e.unstable_next=function(Ne){switch(M){case 1:case 2:case 3:var Xe=3;break;default:Xe=M}var pt=M;M=Xe;try{return Ne()}finally{M=pt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ne,Xe){switch(Ne){case 1:case 2:case 3:case 4:case 5:break;default:Ne=3}var pt=M;M=Ne;try{return Xe()}finally{M=pt}},e.unstable_scheduleCallback=function(Ne,Xe,pt){var zt=e.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?zt+pt:zt):pt=zt,Ne){case 1:var Ft=-1;break;case 2:Ft=250;break;case 5:Ft=1073741823;break;case 4:Ft=1e4;break;default:Ft=5e3}return Ft=pt+Ft,Ne={id:T++,callback:Xe,priorityLevel:Ne,startTime:pt,expirationTime:Ft,sortIndex:-1},pt>zt?(Ne.sortIndex=pt,t(b,Ne),n(v)===null&&Ne===n(b)&&(L?(V(ye),ye=-1):L=!0,Je(K,pt-zt))):(Ne.sortIndex=Ft,t(v,Ne),B||R||(B=!0,ot(Y))),Ne},e.unstable_shouldYield=je,e.unstable_wrapCallback=function(Ne){var Xe=M;return function(){var pt=M;M=Xe;try{return Ne.apply(this,arguments)}finally{M=pt}}}})(KW);XW.exports=KW;var rae=XW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iae=X,_l=rae;function mn(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YW=new Set,H1={};function Vm(e,t){__(e,t),__(e+"Capture",t)}function __(e,t){for(H1[e]=t,e=0;e<t.length;e++)YW.add(t[e])}var Mh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hk=Object.prototype.hasOwnProperty,oae=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,D$={},L$={};function aae(e){return Hk.call(L$,e)?!0:Hk.call(D$,e)?!1:oae.test(e)?L$[e]=!0:(D$[e]=!0,!1)}function sae(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function lae(e,t,n,r){if(t===null||typeof t>"u"||sae(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function xs(e,t,n,r,a,c,f){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=c,this.removeEmptyString=f}var Da={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Da[e]=new xs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Da[t]=new xs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Da[e]=new xs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Da[e]=new xs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Da[e]=new xs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Da[e]=new xs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Da[e]=new xs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Da[e]=new xs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Da[e]=new xs(e,5,!1,e.toLowerCase(),null,!1,!1)});var yz=/[\-:]([a-z])/g;function _z(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(yz,_z);Da[t]=new xs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(yz,_z);Da[t]=new xs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(yz,_z);Da[t]=new xs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Da[e]=new xs(e,1,!1,e.toLowerCase(),null,!1,!1)});Da.xlinkHref=new xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Da[e]=new xs(e,1,!1,e.toLowerCase(),null,!0,!0)});function vz(e,t,n,r){var a=Da.hasOwnProperty(t)?Da[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(lae(t,n,a,r)&&(n=null),r||a===null?aae(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var $h=iae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,HT=Symbol.for("react.element"),jy=Symbol.for("react.portal"),$y=Symbol.for("react.fragment"),xz=Symbol.for("react.strict_mode"),qk=Symbol.for("react.profiler"),JW=Symbol.for("react.provider"),QW=Symbol.for("react.context"),bz=Symbol.for("react.forward_ref"),Zk=Symbol.for("react.suspense"),Xk=Symbol.for("react.suspense_list"),wz=Symbol.for("react.memo"),Zd=Symbol.for("react.lazy"),e9=Symbol.for("react.offscreen"),z$=Symbol.iterator;function Lx(e){return e===null||typeof e!="object"?null:(e=z$&&e[z$]||e["@@iterator"],typeof e=="function"?e:null)}var Co=Object.assign,cO;function s1(e){if(cO===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);cO=t&&t[1]||""}return`
`+cO+e}var uO=!1;function hO(e,t){if(!e||uO)return"";uO=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(b){var r=b}Reflect.construct(e,[],t)}else{try{t.call()}catch(b){r=b}e.call(t.prototype)}else{try{throw Error()}catch(b){r=b}e()}}catch(b){if(b&&r&&typeof b.stack=="string"){for(var a=b.stack.split(`
`),c=r.stack.split(`
`),f=a.length-1,i=c.length-1;1<=f&&0<=i&&a[f]!==c[i];)i--;for(;1<=f&&0<=i;f--,i--)if(a[f]!==c[i]){if(f!==1||i!==1)do if(f--,i--,0>i||a[f]!==c[i]){var v=`
`+a[f].replace(" at new "," at ");return e.displayName&&v.includes("<anonymous>")&&(v=v.replace("<anonymous>",e.displayName)),v}while(1<=f&&0<=i);break}}}finally{uO=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?s1(e):""}function cae(e){switch(e.tag){case 5:return s1(e.type);case 16:return s1("Lazy");case 13:return s1("Suspense");case 19:return s1("SuspenseList");case 0:case 2:case 15:return e=hO(e.type,!1),e;case 11:return e=hO(e.type.render,!1),e;case 1:return e=hO(e.type,!0),e;default:return""}}function Kk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $y:return"Fragment";case jy:return"Portal";case qk:return"Profiler";case xz:return"StrictMode";case Zk:return"Suspense";case Xk:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case QW:return(e.displayName||"Context")+".Consumer";case JW:return(e._context.displayName||"Context")+".Provider";case bz:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case wz:return t=e.displayName||null,t!==null?t:Kk(e.type)||"Memo";case Zd:t=e._payload,e=e._init;try{return Kk(e(t))}catch{}}return null}function uae(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kk(t);case 8:return t===xz?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ef(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function t9(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function hae(e){var t=t9(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(f){r=""+f,c.call(this,f)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(f){r=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function qT(e){e._valueTracker||(e._valueTracker=hae(e))}function n9(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=t9(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function o2(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Yk(e,t){var n=t.checked;return Co({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function N$(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ef(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function r9(e,t){t=t.checked,t!=null&&vz(e,"checked",t,!1)}function Jk(e,t){r9(e,t);var n=Ef(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Qk(e,t.type,n):t.hasOwnProperty("defaultValue")&&Qk(e,t.type,Ef(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function F$(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Qk(e,t,n){(t!=="number"||o2(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var l1=Array.isArray;function r_(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ef(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function eR(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(mn(91));return Co({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function B$(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(mn(92));if(l1(n)){if(1<n.length)throw Error(mn(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ef(n)}}function i9(e,t){var n=Ef(t.value),r=Ef(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function j$(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function o9(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tR(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?o9(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ZT,a9=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ZT=ZT||document.createElement("div"),ZT.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ZT.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function q1(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var b1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dae=["Webkit","ms","Moz","O"];Object.keys(b1).forEach(function(e){dae.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),b1[t]=b1[e]})});function s9(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||b1.hasOwnProperty(e)&&b1[e]?(""+t).trim():t+"px"}function l9(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=s9(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var fae=Co({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nR(e,t){if(t){if(fae[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(mn(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(mn(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(mn(61))}if(t.style!=null&&typeof t.style!="object")throw Error(mn(62))}}function rR(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iR=null;function Sz(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var oR=null,i_=null,o_=null;function $$(e){if(e=pw(e)){if(typeof oR!="function")throw Error(mn(280));var t=e.stateNode;t&&(t=gP(t),oR(e.stateNode,e.type,t))}}function c9(e){i_?o_?o_.push(e):o_=[e]:i_=e}function u9(){if(i_){var e=i_,t=o_;if(o_=i_=null,$$(e),t)for(e=0;e<t.length;e++)$$(t[e])}}function h9(e,t){return e(t)}function d9(){}var dO=!1;function f9(e,t,n){if(dO)return e(t,n);dO=!0;try{return h9(e,t,n)}finally{dO=!1,(i_!==null||o_!==null)&&(d9(),u9())}}function Z1(e,t){var n=e.stateNode;if(n===null)return null;var r=gP(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(mn(231,t,typeof n));return n}var aR=!1;if(Mh)try{var zx={};Object.defineProperty(zx,"passive",{get:function(){aR=!0}}),window.addEventListener("test",zx,zx),window.removeEventListener("test",zx,zx)}catch{aR=!1}function pae(e,t,n,r,a,c,f,i,v){var b=Array.prototype.slice.call(arguments,3);try{t.apply(n,b)}catch(T){this.onError(T)}}var w1=!1,a2=null,s2=!1,sR=null,mae={onError:function(e){w1=!0,a2=e}};function gae(e,t,n,r,a,c,f,i,v){w1=!1,a2=null,pae.apply(mae,arguments)}function yae(e,t,n,r,a,c,f,i,v){if(gae.apply(this,arguments),w1){if(w1){var b=a2;w1=!1,a2=null}else throw Error(mn(198));s2||(s2=!0,sR=b)}}function Gm(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function p9(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function U$(e){if(Gm(e)!==e)throw Error(mn(188))}function _ae(e){var t=e.alternate;if(!t){if(t=Gm(e),t===null)throw Error(mn(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var c=a.alternate;if(c===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===c.child){for(c=a.child;c;){if(c===n)return U$(a),e;if(c===r)return U$(a),t;c=c.sibling}throw Error(mn(188))}if(n.return!==r.return)n=a,r=c;else{for(var f=!1,i=a.child;i;){if(i===n){f=!0,n=a,r=c;break}if(i===r){f=!0,r=a,n=c;break}i=i.sibling}if(!f){for(i=c.child;i;){if(i===n){f=!0,n=c,r=a;break}if(i===r){f=!0,r=c,n=a;break}i=i.sibling}if(!f)throw Error(mn(189))}}if(n.alternate!==r)throw Error(mn(190))}if(n.tag!==3)throw Error(mn(188));return n.stateNode.current===n?e:t}function m9(e){return e=_ae(e),e!==null?g9(e):null}function g9(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=g9(e);if(t!==null)return t;e=e.sibling}return null}var y9=_l.unstable_scheduleCallback,V$=_l.unstable_cancelCallback,vae=_l.unstable_shouldYield,xae=_l.unstable_requestPaint,Bo=_l.unstable_now,bae=_l.unstable_getCurrentPriorityLevel,Tz=_l.unstable_ImmediatePriority,_9=_l.unstable_UserBlockingPriority,l2=_l.unstable_NormalPriority,wae=_l.unstable_LowPriority,v9=_l.unstable_IdlePriority,dP=null,yu=null;function Sae(e){if(yu&&typeof yu.onCommitFiberRoot=="function")try{yu.onCommitFiberRoot(dP,e,void 0,(e.current.flags&128)===128)}catch{}}var Cc=Math.clz32?Math.clz32:Aae,Tae=Math.log,Eae=Math.LN2;function Aae(e){return e>>>=0,e===0?32:31-(Tae(e)/Eae|0)|0}var XT=64,KT=4194304;function c1(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function c2(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,c=e.pingedLanes,f=n&268435455;if(f!==0){var i=f&~a;i!==0?r=c1(i):(c&=f,c!==0&&(r=c1(c)))}else f=n&~a,f!==0?r=c1(f):c!==0&&(r=c1(c));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,c=t&-t,a>=c||a===16&&(c&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Cc(t),a=1<<n,r|=e[n],t&=~a;return r}function Pae(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cae(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,c=e.pendingLanes;0<c;){var f=31-Cc(c),i=1<<f,v=a[f];v===-1?(!(i&n)||i&r)&&(a[f]=Pae(i,t)):v<=t&&(e.expiredLanes|=i),c&=~i}}function lR(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function x9(){var e=XT;return XT<<=1,!(XT&4194240)&&(XT=64),e}function fO(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function dw(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Cc(t),e[t]=n}function Iae(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-Cc(n),c=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~c}}function Ez(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Cc(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Gi=0;function b9(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var w9,Az,S9,T9,E9,cR=!1,YT=[],hf=null,df=null,ff=null,X1=new Map,K1=new Map,Jd=[],Mae="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G$(e,t){switch(e){case"focusin":case"focusout":hf=null;break;case"dragenter":case"dragleave":df=null;break;case"mouseover":case"mouseout":ff=null;break;case"pointerover":case"pointerout":X1.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":K1.delete(t.pointerId)}}function Nx(e,t,n,r,a,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:c,targetContainers:[a]},t!==null&&(t=pw(t),t!==null&&Az(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Oae(e,t,n,r,a){switch(t){case"focusin":return hf=Nx(hf,e,t,n,r,a),!0;case"dragenter":return df=Nx(df,e,t,n,r,a),!0;case"mouseover":return ff=Nx(ff,e,t,n,r,a),!0;case"pointerover":var c=a.pointerId;return X1.set(c,Nx(X1.get(c)||null,e,t,n,r,a)),!0;case"gotpointercapture":return c=a.pointerId,K1.set(c,Nx(K1.get(c)||null,e,t,n,r,a)),!0}return!1}function A9(e){var t=um(e.target);if(t!==null){var n=Gm(t);if(n!==null){if(t=n.tag,t===13){if(t=p9(n),t!==null){e.blockedOn=t,E9(e.priority,function(){S9(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function jE(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=uR(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);iR=r,n.target.dispatchEvent(r),iR=null}else return t=pw(n),t!==null&&Az(t),e.blockedOn=n,!1;t.shift()}return!0}function W$(e,t,n){jE(e)&&n.delete(t)}function kae(){cR=!1,hf!==null&&jE(hf)&&(hf=null),df!==null&&jE(df)&&(df=null),ff!==null&&jE(ff)&&(ff=null),X1.forEach(W$),K1.forEach(W$)}function Fx(e,t){e.blockedOn===t&&(e.blockedOn=null,cR||(cR=!0,_l.unstable_scheduleCallback(_l.unstable_NormalPriority,kae)))}function Y1(e){function t(a){return Fx(a,e)}if(0<YT.length){Fx(YT[0],e);for(var n=1;n<YT.length;n++){var r=YT[n];r.blockedOn===e&&(r.blockedOn=null)}}for(hf!==null&&Fx(hf,e),df!==null&&Fx(df,e),ff!==null&&Fx(ff,e),X1.forEach(t),K1.forEach(t),n=0;n<Jd.length;n++)r=Jd[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Jd.length&&(n=Jd[0],n.blockedOn===null);)A9(n),n.blockedOn===null&&Jd.shift()}var a_=$h.ReactCurrentBatchConfig,u2=!0;function Rae(e,t,n,r){var a=Gi,c=a_.transition;a_.transition=null;try{Gi=1,Pz(e,t,n,r)}finally{Gi=a,a_.transition=c}}function Dae(e,t,n,r){var a=Gi,c=a_.transition;a_.transition=null;try{Gi=4,Pz(e,t,n,r)}finally{Gi=a,a_.transition=c}}function Pz(e,t,n,r){if(u2){var a=uR(e,t,n,r);if(a===null)SO(e,t,r,h2,n),G$(e,r);else if(Oae(a,e,t,n,r))r.stopPropagation();else if(G$(e,r),t&4&&-1<Mae.indexOf(e)){for(;a!==null;){var c=pw(a);if(c!==null&&w9(c),c=uR(e,t,n,r),c===null&&SO(e,t,r,h2,n),c===a)break;a=c}a!==null&&r.stopPropagation()}else SO(e,t,r,null,n)}}var h2=null;function uR(e,t,n,r){if(h2=null,e=Sz(r),e=um(e),e!==null)if(t=Gm(e),t===null)e=null;else if(n=t.tag,n===13){if(e=p9(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return h2=e,null}function P9(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bae()){case Tz:return 1;case _9:return 4;case l2:case wae:return 16;case v9:return 536870912;default:return 16}default:return 16}}var of=null,Cz=null,$E=null;function C9(){if($E)return $E;var e,t=Cz,n=t.length,r,a="value"in of?of.value:of.textContent,c=a.length;for(e=0;e<n&&t[e]===a[e];e++);var f=n-e;for(r=1;r<=f&&t[n-r]===a[c-r];r++);return $E=a.slice(e,1<r?1-r:void 0)}function UE(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function JT(){return!0}function H$(){return!1}function bl(e){function t(n,r,a,c,f){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=c,this.target=f,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(c):c[i]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?JT:H$,this.isPropagationStopped=H$,this}return Co(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=JT)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=JT)},persist:function(){},isPersistent:JT}),t}var pv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Iz=bl(pv),fw=Co({},pv,{view:0,detail:0}),Lae=bl(fw),pO,mO,Bx,fP=Co({},fw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mz,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bx&&(Bx&&e.type==="mousemove"?(pO=e.screenX-Bx.screenX,mO=e.screenY-Bx.screenY):mO=pO=0,Bx=e),pO)},movementY:function(e){return"movementY"in e?e.movementY:mO}}),q$=bl(fP),zae=Co({},fP,{dataTransfer:0}),Nae=bl(zae),Fae=Co({},fw,{relatedTarget:0}),gO=bl(Fae),Bae=Co({},pv,{animationName:0,elapsedTime:0,pseudoElement:0}),jae=bl(Bae),$ae=Co({},pv,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Uae=bl($ae),Vae=Co({},pv,{data:0}),Z$=bl(Vae),Gae={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wae={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hae={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qae(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Hae[e])?!!t[e]:!1}function Mz(){return qae}var Zae=Co({},fw,{key:function(e){if(e.key){var t=Gae[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=UE(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Wae[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mz,charCode:function(e){return e.type==="keypress"?UE(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?UE(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Xae=bl(Zae),Kae=Co({},fP,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X$=bl(Kae),Yae=Co({},fw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mz}),Jae=bl(Yae),Qae=Co({},pv,{propertyName:0,elapsedTime:0,pseudoElement:0}),ese=bl(Qae),tse=Co({},fP,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),nse=bl(tse),rse=[9,13,27,32],Oz=Mh&&"CompositionEvent"in window,S1=null;Mh&&"documentMode"in document&&(S1=document.documentMode);var ise=Mh&&"TextEvent"in window&&!S1,I9=Mh&&(!Oz||S1&&8<S1&&11>=S1),K$=" ",Y$=!1;function M9(e,t){switch(e){case"keyup":return rse.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function O9(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Uy=!1;function ose(e,t){switch(e){case"compositionend":return O9(t);case"keypress":return t.which!==32?null:(Y$=!0,K$);case"textInput":return e=t.data,e===K$&&Y$?null:e;default:return null}}function ase(e,t){if(Uy)return e==="compositionend"||!Oz&&M9(e,t)?(e=C9(),$E=Cz=of=null,Uy=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return I9&&t.locale!=="ko"?null:t.data;default:return null}}var sse={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function J$(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sse[e.type]:t==="textarea"}function k9(e,t,n,r){c9(r),t=d2(t,"onChange"),0<t.length&&(n=new Iz("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var T1=null,J1=null;function lse(e){V9(e,0)}function pP(e){var t=Wy(e);if(n9(t))return e}function cse(e,t){if(e==="change")return t}var R9=!1;if(Mh){var yO;if(Mh){var _O="oninput"in document;if(!_O){var Q$=document.createElement("div");Q$.setAttribute("oninput","return;"),_O=typeof Q$.oninput=="function"}yO=_O}else yO=!1;R9=yO&&(!document.documentMode||9<document.documentMode)}function e5(){T1&&(T1.detachEvent("onpropertychange",D9),J1=T1=null)}function D9(e){if(e.propertyName==="value"&&pP(J1)){var t=[];k9(t,J1,e,Sz(e)),f9(lse,t)}}function use(e,t,n){e==="focusin"?(e5(),T1=t,J1=n,T1.attachEvent("onpropertychange",D9)):e==="focusout"&&e5()}function hse(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return pP(J1)}function dse(e,t){if(e==="click")return pP(t)}function fse(e,t){if(e==="input"||e==="change")return pP(t)}function pse(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rc=typeof Object.is=="function"?Object.is:pse;function Q1(e,t){if(Rc(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Hk.call(t,a)||!Rc(e[a],t[a]))return!1}return!0}function t5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function n5(e,t){var n=t5(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=t5(n)}}function L9(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?L9(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function z9(){for(var e=window,t=o2();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=o2(e.document)}return t}function kz(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mse(e){var t=z9(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&L9(n.ownerDocument.documentElement,n)){if(r!==null&&kz(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,c=Math.min(r.start,a);r=r.end===void 0?c:Math.min(r.end,a),!e.extend&&c>r&&(a=r,r=c,c=a),a=n5(n,c);var f=n5(n,r);a&&f&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),c>r?(e.addRange(t),e.extend(f.node,f.offset)):(t.setEnd(f.node,f.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gse=Mh&&"documentMode"in document&&11>=document.documentMode,Vy=null,hR=null,E1=null,dR=!1;function r5(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;dR||Vy==null||Vy!==o2(r)||(r=Vy,"selectionStart"in r&&kz(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),E1&&Q1(E1,r)||(E1=r,r=d2(hR,"onSelect"),0<r.length&&(t=new Iz("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Vy)))}function QT(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Gy={animationend:QT("Animation","AnimationEnd"),animationiteration:QT("Animation","AnimationIteration"),animationstart:QT("Animation","AnimationStart"),transitionend:QT("Transition","TransitionEnd")},vO={},N9={};Mh&&(N9=document.createElement("div").style,"AnimationEvent"in window||(delete Gy.animationend.animation,delete Gy.animationiteration.animation,delete Gy.animationstart.animation),"TransitionEvent"in window||delete Gy.transitionend.transition);function mP(e){if(vO[e])return vO[e];if(!Gy[e])return e;var t=Gy[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in N9)return vO[e]=t[n];return e}var F9=mP("animationend"),B9=mP("animationiteration"),j9=mP("animationstart"),$9=mP("transitionend"),U9=new Map,i5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bf(e,t){U9.set(e,t),Vm(t,[e])}for(var xO=0;xO<i5.length;xO++){var bO=i5[xO],yse=bO.toLowerCase(),_se=bO[0].toUpperCase()+bO.slice(1);Bf(yse,"on"+_se)}Bf(F9,"onAnimationEnd");Bf(B9,"onAnimationIteration");Bf(j9,"onAnimationStart");Bf("dblclick","onDoubleClick");Bf("focusin","onFocus");Bf("focusout","onBlur");Bf($9,"onTransitionEnd");__("onMouseEnter",["mouseout","mouseover"]);__("onMouseLeave",["mouseout","mouseover"]);__("onPointerEnter",["pointerout","pointerover"]);__("onPointerLeave",["pointerout","pointerover"]);Vm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vm("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var u1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vse=new Set("cancel close invalid load scroll toggle".split(" ").concat(u1));function o5(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,yae(r,t,void 0,e),e.currentTarget=null}function V9(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var c=void 0;if(t)for(var f=r.length-1;0<=f;f--){var i=r[f],v=i.instance,b=i.currentTarget;if(i=i.listener,v!==c&&a.isPropagationStopped())break e;o5(a,i,b),c=v}else for(f=0;f<r.length;f++){if(i=r[f],v=i.instance,b=i.currentTarget,i=i.listener,v!==c&&a.isPropagationStopped())break e;o5(a,i,b),c=v}}}if(s2)throw e=sR,s2=!1,sR=null,e}function co(e,t){var n=t[yR];n===void 0&&(n=t[yR]=new Set);var r=e+"__bubble";n.has(r)||(G9(t,e,2,!1),n.add(r))}function wO(e,t,n){var r=0;t&&(r|=4),G9(n,e,r,t)}var eE="_reactListening"+Math.random().toString(36).slice(2);function eb(e){if(!e[eE]){e[eE]=!0,YW.forEach(function(n){n!=="selectionchange"&&(vse.has(n)||wO(n,!1,e),wO(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[eE]||(t[eE]=!0,wO("selectionchange",!1,t))}}function G9(e,t,n,r){switch(P9(t)){case 1:var a=Rae;break;case 4:a=Dae;break;default:a=Pz}n=a.bind(null,t,n,e),a=void 0,!aR||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function SO(e,t,n,r,a){var c=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var f=r.tag;if(f===3||f===4){var i=r.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(f===4)for(f=r.return;f!==null;){var v=f.tag;if((v===3||v===4)&&(v=f.stateNode.containerInfo,v===a||v.nodeType===8&&v.parentNode===a))return;f=f.return}for(;i!==null;){if(f=um(i),f===null)return;if(v=f.tag,v===5||v===6){r=c=f;continue e}i=i.parentNode}}r=r.return}f9(function(){var b=c,T=Sz(n),A=[];e:{var M=U9.get(e);if(M!==void 0){var R=Iz,B=e;switch(e){case"keypress":if(UE(n)===0)break e;case"keydown":case"keyup":R=Xae;break;case"focusin":B="focus",R=gO;break;case"focusout":B="blur",R=gO;break;case"beforeblur":case"afterblur":R=gO;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":R=q$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":R=Nae;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":R=Jae;break;case F9:case B9:case j9:R=jae;break;case $9:R=ese;break;case"scroll":R=Lae;break;case"wheel":R=nse;break;case"copy":case"cut":case"paste":R=Uae;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":R=X$}var L=(t&4)!==0,j=!L&&e==="scroll",V=L?M!==null?M+"Capture":null:M;L=[];for(var $=b,H;$!==null;){H=$;var K=H.stateNode;if(H.tag===5&&K!==null&&(H=K,V!==null&&(K=Z1($,V),K!=null&&L.push(tb($,K,H)))),j)break;$=$.return}0<L.length&&(M=new R(M,B,null,n,T),A.push({event:M,listeners:L}))}}if(!(t&7)){e:{if(M=e==="mouseover"||e==="pointerover",R=e==="mouseout"||e==="pointerout",M&&n!==iR&&(B=n.relatedTarget||n.fromElement)&&(um(B)||B[Oh]))break e;if((R||M)&&(M=T.window===T?T:(M=T.ownerDocument)?M.defaultView||M.parentWindow:window,R?(B=n.relatedTarget||n.toElement,R=b,B=B?um(B):null,B!==null&&(j=Gm(B),B!==j||B.tag!==5&&B.tag!==6)&&(B=null)):(R=null,B=b),R!==B)){if(L=q$,K="onMouseLeave",V="onMouseEnter",$="mouse",(e==="pointerout"||e==="pointerover")&&(L=X$,K="onPointerLeave",V="onPointerEnter",$="pointer"),j=R==null?M:Wy(R),H=B==null?M:Wy(B),M=new L(K,$+"leave",R,n,T),M.target=j,M.relatedTarget=H,K=null,um(T)===b&&(L=new L(V,$+"enter",B,n,T),L.target=H,L.relatedTarget=j,K=L),j=K,R&&B)t:{for(L=R,V=B,$=0,H=L;H;H=xy(H))$++;for(H=0,K=V;K;K=xy(K))H++;for(;0<$-H;)L=xy(L),$--;for(;0<H-$;)V=xy(V),H--;for(;$--;){if(L===V||V!==null&&L===V.alternate)break t;L=xy(L),V=xy(V)}L=null}else L=null;R!==null&&a5(A,M,R,L,!1),B!==null&&j!==null&&a5(A,j,B,L,!0)}}e:{if(M=b?Wy(b):window,R=M.nodeName&&M.nodeName.toLowerCase(),R==="select"||R==="input"&&M.type==="file")var Y=cse;else if(J$(M))if(R9)Y=fse;else{Y=hse;var se=use}else(R=M.nodeName)&&R.toLowerCase()==="input"&&(M.type==="checkbox"||M.type==="radio")&&(Y=dse);if(Y&&(Y=Y(e,b))){k9(A,Y,n,T);break e}se&&se(e,M,b),e==="focusout"&&(se=M._wrapperState)&&se.controlled&&M.type==="number"&&Qk(M,"number",M.value)}switch(se=b?Wy(b):window,e){case"focusin":(J$(se)||se.contentEditable==="true")&&(Vy=se,hR=b,E1=null);break;case"focusout":E1=hR=Vy=null;break;case"mousedown":dR=!0;break;case"contextmenu":case"mouseup":case"dragend":dR=!1,r5(A,n,T);break;case"selectionchange":if(gse)break;case"keydown":case"keyup":r5(A,n,T)}var ce;if(Oz)e:{switch(e){case"compositionstart":var ye="onCompositionStart";break e;case"compositionend":ye="onCompositionEnd";break e;case"compositionupdate":ye="onCompositionUpdate";break e}ye=void 0}else Uy?M9(e,n)&&(ye="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ye="onCompositionStart");ye&&(I9&&n.locale!=="ko"&&(Uy||ye!=="onCompositionStart"?ye==="onCompositionEnd"&&Uy&&(ce=C9()):(of=T,Cz="value"in of?of.value:of.textContent,Uy=!0)),se=d2(b,ye),0<se.length&&(ye=new Z$(ye,e,null,n,T),A.push({event:ye,listeners:se}),ce?ye.data=ce:(ce=O9(n),ce!==null&&(ye.data=ce)))),(ce=ise?ose(e,n):ase(e,n))&&(b=d2(b,"onBeforeInput"),0<b.length&&(T=new Z$("onBeforeInput","beforeinput",null,n,T),A.push({event:T,listeners:b}),T.data=ce))}V9(A,t)})}function tb(e,t,n){return{instance:e,listener:t,currentTarget:n}}function d2(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,c=a.stateNode;a.tag===5&&c!==null&&(a=c,c=Z1(e,n),c!=null&&r.unshift(tb(e,c,a)),c=Z1(e,t),c!=null&&r.push(tb(e,c,a))),e=e.return}return r}function xy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function a5(e,t,n,r,a){for(var c=t._reactName,f=[];n!==null&&n!==r;){var i=n,v=i.alternate,b=i.stateNode;if(v!==null&&v===r)break;i.tag===5&&b!==null&&(i=b,a?(v=Z1(n,c),v!=null&&f.unshift(tb(n,v,i))):a||(v=Z1(n,c),v!=null&&f.push(tb(n,v,i)))),n=n.return}f.length!==0&&e.push({event:t,listeners:f})}var xse=/\r\n?/g,bse=/\u0000|\uFFFD/g;function s5(e){return(typeof e=="string"?e:""+e).replace(xse,`
`).replace(bse,"")}function tE(e,t,n){if(t=s5(t),s5(e)!==t&&n)throw Error(mn(425))}function f2(){}var fR=null,pR=null;function mR(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var gR=typeof setTimeout=="function"?setTimeout:void 0,wse=typeof clearTimeout=="function"?clearTimeout:void 0,l5=typeof Promise=="function"?Promise:void 0,Sse=typeof queueMicrotask=="function"?queueMicrotask:typeof l5<"u"?function(e){return l5.resolve(null).then(e).catch(Tse)}:gR;function Tse(e){setTimeout(function(){throw e})}function TO(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Y1(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Y1(t)}function pf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function c5(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var mv=Math.random().toString(36).slice(2),du="__reactFiber$"+mv,nb="__reactProps$"+mv,Oh="__reactContainer$"+mv,yR="__reactEvents$"+mv,Ese="__reactListeners$"+mv,Ase="__reactHandles$"+mv;function um(e){var t=e[du];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Oh]||n[du]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=c5(e);e!==null;){if(n=e[du])return n;e=c5(e)}return t}e=n,n=e.parentNode}return null}function pw(e){return e=e[du]||e[Oh],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Wy(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(mn(33))}function gP(e){return e[nb]||null}var _R=[],Hy=-1;function jf(e){return{current:e}}function po(e){0>Hy||(e.current=_R[Hy],_R[Hy]=null,Hy--)}function io(e,t){Hy++,_R[Hy]=e.current,e.current=t}var Af={},es=jf(Af),Us=jf(!1),Tm=Af;function v_(e,t){var n=e.type.contextTypes;if(!n)return Af;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},c;for(c in n)a[c]=t[c];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Vs(e){return e=e.childContextTypes,e!=null}function p2(){po(Us),po(es)}function u5(e,t,n){if(es.current!==Af)throw Error(mn(168));io(es,t),io(Us,n)}function W9(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(mn(108,uae(e)||"Unknown",a));return Co({},n,r)}function m2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Af,Tm=es.current,io(es,e),io(Us,Us.current),!0}function h5(e,t,n){var r=e.stateNode;if(!r)throw Error(mn(169));n?(e=W9(e,t,Tm),r.__reactInternalMemoizedMergedChildContext=e,po(Us),po(es),io(es,e)):po(Us),io(Us,n)}var xh=null,yP=!1,EO=!1;function H9(e){xh===null?xh=[e]:xh.push(e)}function Pse(e){yP=!0,H9(e)}function $f(){if(!EO&&xh!==null){EO=!0;var e=0,t=Gi;try{var n=xh;for(Gi=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}xh=null,yP=!1}catch(a){throw xh!==null&&(xh=xh.slice(e+1)),y9(Tz,$f),a}finally{Gi=t,EO=!1}}return null}var qy=[],Zy=0,g2=null,y2=0,Ll=[],zl=0,Em=null,bh=1,wh="";function tm(e,t){qy[Zy++]=y2,qy[Zy++]=g2,g2=e,y2=t}function q9(e,t,n){Ll[zl++]=bh,Ll[zl++]=wh,Ll[zl++]=Em,Em=e;var r=bh;e=wh;var a=32-Cc(r)-1;r&=~(1<<a),n+=1;var c=32-Cc(t)+a;if(30<c){var f=a-a%5;c=(r&(1<<f)-1).toString(32),r>>=f,a-=f,bh=1<<32-Cc(t)+a|n<<a|r,wh=c+e}else bh=1<<c|n<<a|r,wh=e}function Rz(e){e.return!==null&&(tm(e,1),q9(e,1,0))}function Dz(e){for(;e===g2;)g2=qy[--Zy],qy[Zy]=null,y2=qy[--Zy],qy[Zy]=null;for(;e===Em;)Em=Ll[--zl],Ll[zl]=null,wh=Ll[--zl],Ll[zl]=null,bh=Ll[--zl],Ll[zl]=null}var pl=null,fl=null,yo=!1,Sc=null;function Z9(e,t){var n=Fl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function d5(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,pl=e,fl=pf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,pl=e,fl=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Em!==null?{id:bh,overflow:wh}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Fl(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,pl=e,fl=null,!0):!1;default:return!1}}function vR(e){return(e.mode&1)!==0&&(e.flags&128)===0}function xR(e){if(yo){var t=fl;if(t){var n=t;if(!d5(e,t)){if(vR(e))throw Error(mn(418));t=pf(n.nextSibling);var r=pl;t&&d5(e,t)?Z9(r,n):(e.flags=e.flags&-4097|2,yo=!1,pl=e)}}else{if(vR(e))throw Error(mn(418));e.flags=e.flags&-4097|2,yo=!1,pl=e}}}function f5(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;pl=e}function nE(e){if(e!==pl)return!1;if(!yo)return f5(e),yo=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!mR(e.type,e.memoizedProps)),t&&(t=fl)){if(vR(e))throw X9(),Error(mn(418));for(;t;)Z9(e,t),t=pf(t.nextSibling)}if(f5(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(mn(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){fl=pf(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}fl=null}}else fl=pl?pf(e.stateNode.nextSibling):null;return!0}function X9(){for(var e=fl;e;)e=pf(e.nextSibling)}function x_(){fl=pl=null,yo=!1}function Lz(e){Sc===null?Sc=[e]:Sc.push(e)}var Cse=$h.ReactCurrentBatchConfig;function jx(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(mn(309));var r=n.stateNode}if(!r)throw Error(mn(147,e));var a=r,c=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===c?t.ref:(t=function(f){var i=a.refs;f===null?delete i[c]:i[c]=f},t._stringRef=c,t)}if(typeof e!="string")throw Error(mn(284));if(!n._owner)throw Error(mn(290,e))}return e}function rE(e,t){throw e=Object.prototype.toString.call(t),Error(mn(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function p5(e){var t=e._init;return t(e._payload)}function K9(e){function t(V,$){if(e){var H=V.deletions;H===null?(V.deletions=[$],V.flags|=16):H.push($)}}function n(V,$){if(!e)return null;for(;$!==null;)t(V,$),$=$.sibling;return null}function r(V,$){for(V=new Map;$!==null;)$.key!==null?V.set($.key,$):V.set($.index,$),$=$.sibling;return V}function a(V,$){return V=_f(V,$),V.index=0,V.sibling=null,V}function c(V,$,H){return V.index=H,e?(H=V.alternate,H!==null?(H=H.index,H<$?(V.flags|=2,$):H):(V.flags|=2,$)):(V.flags|=1048576,$)}function f(V){return e&&V.alternate===null&&(V.flags|=2),V}function i(V,$,H,K){return $===null||$.tag!==6?($=kO(H,V.mode,K),$.return=V,$):($=a($,H),$.return=V,$)}function v(V,$,H,K){var Y=H.type;return Y===$y?T(V,$,H.props.children,K,H.key):$!==null&&($.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Zd&&p5(Y)===$.type)?(K=a($,H.props),K.ref=jx(V,$,H),K.return=V,K):(K=XE(H.type,H.key,H.props,null,V.mode,K),K.ref=jx(V,$,H),K.return=V,K)}function b(V,$,H,K){return $===null||$.tag!==4||$.stateNode.containerInfo!==H.containerInfo||$.stateNode.implementation!==H.implementation?($=RO(H,V.mode,K),$.return=V,$):($=a($,H.children||[]),$.return=V,$)}function T(V,$,H,K,Y){return $===null||$.tag!==7?($=xm(H,V.mode,K,Y),$.return=V,$):($=a($,H),$.return=V,$)}function A(V,$,H){if(typeof $=="string"&&$!==""||typeof $=="number")return $=kO(""+$,V.mode,H),$.return=V,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case HT:return H=XE($.type,$.key,$.props,null,V.mode,H),H.ref=jx(V,null,$),H.return=V,H;case jy:return $=RO($,V.mode,H),$.return=V,$;case Zd:var K=$._init;return A(V,K($._payload),H)}if(l1($)||Lx($))return $=xm($,V.mode,H,null),$.return=V,$;rE(V,$)}return null}function M(V,$,H,K){var Y=$!==null?$.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return Y!==null?null:i(V,$,""+H,K);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case HT:return H.key===Y?v(V,$,H,K):null;case jy:return H.key===Y?b(V,$,H,K):null;case Zd:return Y=H._init,M(V,$,Y(H._payload),K)}if(l1(H)||Lx(H))return Y!==null?null:T(V,$,H,K,null);rE(V,H)}return null}function R(V,$,H,K,Y){if(typeof K=="string"&&K!==""||typeof K=="number")return V=V.get(H)||null,i($,V,""+K,Y);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case HT:return V=V.get(K.key===null?H:K.key)||null,v($,V,K,Y);case jy:return V=V.get(K.key===null?H:K.key)||null,b($,V,K,Y);case Zd:var se=K._init;return R(V,$,H,se(K._payload),Y)}if(l1(K)||Lx(K))return V=V.get(H)||null,T($,V,K,Y,null);rE($,K)}return null}function B(V,$,H,K){for(var Y=null,se=null,ce=$,ye=$=0,ze=null;ce!==null&&ye<H.length;ye++){ce.index>ye?(ze=ce,ce=null):ze=ce.sibling;var Le=M(V,ce,H[ye],K);if(Le===null){ce===null&&(ce=ze);break}e&&ce&&Le.alternate===null&&t(V,ce),$=c(Le,$,ye),se===null?Y=Le:se.sibling=Le,se=Le,ce=ze}if(ye===H.length)return n(V,ce),yo&&tm(V,ye),Y;if(ce===null){for(;ye<H.length;ye++)ce=A(V,H[ye],K),ce!==null&&($=c(ce,$,ye),se===null?Y=ce:se.sibling=ce,se=ce);return yo&&tm(V,ye),Y}for(ce=r(V,ce);ye<H.length;ye++)ze=R(ce,V,ye,H[ye],K),ze!==null&&(e&&ze.alternate!==null&&ce.delete(ze.key===null?ye:ze.key),$=c(ze,$,ye),se===null?Y=ze:se.sibling=ze,se=ze);return e&&ce.forEach(function(je){return t(V,je)}),yo&&tm(V,ye),Y}function L(V,$,H,K){var Y=Lx(H);if(typeof Y!="function")throw Error(mn(150));if(H=Y.call(H),H==null)throw Error(mn(151));for(var se=Y=null,ce=$,ye=$=0,ze=null,Le=H.next();ce!==null&&!Le.done;ye++,Le=H.next()){ce.index>ye?(ze=ce,ce=null):ze=ce.sibling;var je=M(V,ce,Le.value,K);if(je===null){ce===null&&(ce=ze);break}e&&ce&&je.alternate===null&&t(V,ce),$=c(je,$,ye),se===null?Y=je:se.sibling=je,se=je,ce=ze}if(Le.done)return n(V,ce),yo&&tm(V,ye),Y;if(ce===null){for(;!Le.done;ye++,Le=H.next())Le=A(V,Le.value,K),Le!==null&&($=c(Le,$,ye),se===null?Y=Le:se.sibling=Le,se=Le);return yo&&tm(V,ye),Y}for(ce=r(V,ce);!Le.done;ye++,Le=H.next())Le=R(ce,V,ye,Le.value,K),Le!==null&&(e&&Le.alternate!==null&&ce.delete(Le.key===null?ye:Le.key),$=c(Le,$,ye),se===null?Y=Le:se.sibling=Le,se=Le);return e&&ce.forEach(function(Re){return t(V,Re)}),yo&&tm(V,ye),Y}function j(V,$,H,K){if(typeof H=="object"&&H!==null&&H.type===$y&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case HT:e:{for(var Y=H.key,se=$;se!==null;){if(se.key===Y){if(Y=H.type,Y===$y){if(se.tag===7){n(V,se.sibling),$=a(se,H.props.children),$.return=V,V=$;break e}}else if(se.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Zd&&p5(Y)===se.type){n(V,se.sibling),$=a(se,H.props),$.ref=jx(V,se,H),$.return=V,V=$;break e}n(V,se);break}else t(V,se);se=se.sibling}H.type===$y?($=xm(H.props.children,V.mode,K,H.key),$.return=V,V=$):(K=XE(H.type,H.key,H.props,null,V.mode,K),K.ref=jx(V,$,H),K.return=V,V=K)}return f(V);case jy:e:{for(se=H.key;$!==null;){if($.key===se)if($.tag===4&&$.stateNode.containerInfo===H.containerInfo&&$.stateNode.implementation===H.implementation){n(V,$.sibling),$=a($,H.children||[]),$.return=V,V=$;break e}else{n(V,$);break}else t(V,$);$=$.sibling}$=RO(H,V.mode,K),$.return=V,V=$}return f(V);case Zd:return se=H._init,j(V,$,se(H._payload),K)}if(l1(H))return B(V,$,H,K);if(Lx(H))return L(V,$,H,K);rE(V,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,$!==null&&$.tag===6?(n(V,$.sibling),$=a($,H),$.return=V,V=$):(n(V,$),$=kO(H,V.mode,K),$.return=V,V=$),f(V)):n(V,$)}return j}var b_=K9(!0),Y9=K9(!1),_2=jf(null),v2=null,Xy=null,zz=null;function Nz(){zz=Xy=v2=null}function Fz(e){var t=_2.current;po(_2),e._currentValue=t}function bR(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function s_(e,t){v2=e,zz=Xy=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Bs=!0),e.firstContext=null)}function Vl(e){var t=e._currentValue;if(zz!==e)if(e={context:e,memoizedValue:t,next:null},Xy===null){if(v2===null)throw Error(mn(308));Xy=e,v2.dependencies={lanes:0,firstContext:e}}else Xy=Xy.next=e;return t}var hm=null;function Bz(e){hm===null?hm=[e]:hm.push(e)}function J9(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Bz(t)):(n.next=a.next,a.next=n),t.interleaved=n,kh(e,r)}function kh(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Xd=!1;function jz(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Q9(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ph(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function mf(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ri&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,kh(e,n)}return a=r.interleaved,a===null?(t.next=t,Bz(r)):(t.next=a.next,a.next=t),r.interleaved=t,kh(e,n)}function VE(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ez(e,n)}}function m5(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var f={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?a=c=f:c=c.next=f,n=n.next}while(n!==null);c===null?a=c=t:c=c.next=t}else a=c=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:c,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function x2(e,t,n,r){var a=e.updateQueue;Xd=!1;var c=a.firstBaseUpdate,f=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var v=i,b=v.next;v.next=null,f===null?c=b:f.next=b,f=v;var T=e.alternate;T!==null&&(T=T.updateQueue,i=T.lastBaseUpdate,i!==f&&(i===null?T.firstBaseUpdate=b:i.next=b,T.lastBaseUpdate=v))}if(c!==null){var A=a.baseState;f=0,T=b=v=null,i=c;do{var M=i.lane,R=i.eventTime;if((r&M)===M){T!==null&&(T=T.next={eventTime:R,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var B=e,L=i;switch(M=t,R=n,L.tag){case 1:if(B=L.payload,typeof B=="function"){A=B.call(R,A,M);break e}A=B;break e;case 3:B.flags=B.flags&-65537|128;case 0:if(B=L.payload,M=typeof B=="function"?B.call(R,A,M):B,M==null)break e;A=Co({},A,M);break e;case 2:Xd=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,M=a.effects,M===null?a.effects=[i]:M.push(i))}else R={eventTime:R,lane:M,tag:i.tag,payload:i.payload,callback:i.callback,next:null},T===null?(b=T=R,v=A):T=T.next=R,f|=M;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;M=i,i=M.next,M.next=null,a.lastBaseUpdate=M,a.shared.pending=null}}while(!0);if(T===null&&(v=A),a.baseState=v,a.firstBaseUpdate=b,a.lastBaseUpdate=T,t=a.shared.interleaved,t!==null){a=t;do f|=a.lane,a=a.next;while(a!==t)}else c===null&&(a.shared.lanes=0);Pm|=f,e.lanes=f,e.memoizedState=A}}function g5(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(mn(191,a));a.call(r)}}}var mw={},_u=jf(mw),rb=jf(mw),ib=jf(mw);function dm(e){if(e===mw)throw Error(mn(174));return e}function $z(e,t){switch(io(ib,t),io(rb,e),io(_u,mw),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:tR(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=tR(t,e)}po(_u),io(_u,t)}function w_(){po(_u),po(rb),po(ib)}function e7(e){dm(ib.current);var t=dm(_u.current),n=tR(t,e.type);t!==n&&(io(rb,e),io(_u,n))}function Uz(e){rb.current===e&&(po(_u),po(rb))}var Eo=jf(0);function b2(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var AO=[];function Vz(){for(var e=0;e<AO.length;e++)AO[e]._workInProgressVersionPrimary=null;AO.length=0}var GE=$h.ReactCurrentDispatcher,PO=$h.ReactCurrentBatchConfig,Am=0,Po=null,ia=null,va=null,w2=!1,A1=!1,ob=0,Ise=0;function Wa(){throw Error(mn(321))}function Gz(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Rc(e[n],t[n]))return!1;return!0}function Wz(e,t,n,r,a,c){if(Am=c,Po=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,GE.current=e===null||e.memoizedState===null?Rse:Dse,e=n(r,a),A1){c=0;do{if(A1=!1,ob=0,25<=c)throw Error(mn(301));c+=1,va=ia=null,t.updateQueue=null,GE.current=Lse,e=n(r,a)}while(A1)}if(GE.current=S2,t=ia!==null&&ia.next!==null,Am=0,va=ia=Po=null,w2=!1,t)throw Error(mn(300));return e}function Hz(){var e=ob!==0;return ob=0,e}function hu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return va===null?Po.memoizedState=va=e:va=va.next=e,va}function Gl(){if(ia===null){var e=Po.alternate;e=e!==null?e.memoizedState:null}else e=ia.next;var t=va===null?Po.memoizedState:va.next;if(t!==null)va=t,ia=e;else{if(e===null)throw Error(mn(310));ia=e,e={memoizedState:ia.memoizedState,baseState:ia.baseState,baseQueue:ia.baseQueue,queue:ia.queue,next:null},va===null?Po.memoizedState=va=e:va=va.next=e}return va}function ab(e,t){return typeof t=="function"?t(e):t}function CO(e){var t=Gl(),n=t.queue;if(n===null)throw Error(mn(311));n.lastRenderedReducer=e;var r=ia,a=r.baseQueue,c=n.pending;if(c!==null){if(a!==null){var f=a.next;a.next=c.next,c.next=f}r.baseQueue=a=c,n.pending=null}if(a!==null){c=a.next,r=r.baseState;var i=f=null,v=null,b=c;do{var T=b.lane;if((Am&T)===T)v!==null&&(v=v.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),r=b.hasEagerState?b.eagerState:e(r,b.action);else{var A={lane:T,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};v===null?(i=v=A,f=r):v=v.next=A,Po.lanes|=T,Pm|=T}b=b.next}while(b!==null&&b!==c);v===null?f=r:v.next=i,Rc(r,t.memoizedState)||(Bs=!0),t.memoizedState=r,t.baseState=f,t.baseQueue=v,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do c=a.lane,Po.lanes|=c,Pm|=c,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function IO(e){var t=Gl(),n=t.queue;if(n===null)throw Error(mn(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,c=t.memoizedState;if(a!==null){n.pending=null;var f=a=a.next;do c=e(c,f.action),f=f.next;while(f!==a);Rc(c,t.memoizedState)||(Bs=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,r]}function t7(){}function n7(e,t){var n=Po,r=Gl(),a=t(),c=!Rc(r.memoizedState,a);if(c&&(r.memoizedState=a,Bs=!0),r=r.queue,qz(o7.bind(null,n,r,e),[e]),r.getSnapshot!==t||c||va!==null&&va.memoizedState.tag&1){if(n.flags|=2048,sb(9,i7.bind(null,n,r,a,t),void 0,null),ba===null)throw Error(mn(349));Am&30||r7(n,t,a)}return a}function r7(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Po.updateQueue,t===null?(t={lastEffect:null,stores:null},Po.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function i7(e,t,n,r){t.value=n,t.getSnapshot=r,a7(t)&&s7(e)}function o7(e,t,n){return n(function(){a7(t)&&s7(e)})}function a7(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Rc(e,n)}catch{return!0}}function s7(e){var t=kh(e,1);t!==null&&Ic(t,e,1,-1)}function y5(e){var t=hu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ab,lastRenderedState:e},t.queue=e,e=e.dispatch=kse.bind(null,Po,e),[t.memoizedState,e]}function sb(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Po.updateQueue,t===null?(t={lastEffect:null,stores:null},Po.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function l7(){return Gl().memoizedState}function WE(e,t,n,r){var a=hu();Po.flags|=e,a.memoizedState=sb(1|t,n,void 0,r===void 0?null:r)}function _P(e,t,n,r){var a=Gl();r=r===void 0?null:r;var c=void 0;if(ia!==null){var f=ia.memoizedState;if(c=f.destroy,r!==null&&Gz(r,f.deps)){a.memoizedState=sb(t,n,c,r);return}}Po.flags|=e,a.memoizedState=sb(1|t,n,c,r)}function _5(e,t){return WE(8390656,8,e,t)}function qz(e,t){return _P(2048,8,e,t)}function c7(e,t){return _P(4,2,e,t)}function u7(e,t){return _P(4,4,e,t)}function h7(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function d7(e,t,n){return n=n!=null?n.concat([e]):null,_P(4,4,h7.bind(null,t,e),n)}function Zz(){}function f7(e,t){var n=Gl();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Gz(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function p7(e,t){var n=Gl();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Gz(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function m7(e,t,n){return Am&21?(Rc(n,t)||(n=x9(),Po.lanes|=n,Pm|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Bs=!0),e.memoizedState=n)}function Mse(e,t){var n=Gi;Gi=n!==0&&4>n?n:4,e(!0);var r=PO.transition;PO.transition={};try{e(!1),t()}finally{Gi=n,PO.transition=r}}function g7(){return Gl().memoizedState}function Ose(e,t,n){var r=yf(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},y7(e))_7(t,n);else if(n=J9(e,t,n,r),n!==null){var a=ms();Ic(n,e,r,a),v7(n,t,r)}}function kse(e,t,n){var r=yf(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(y7(e))_7(t,a);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var f=t.lastRenderedState,i=c(f,n);if(a.hasEagerState=!0,a.eagerState=i,Rc(i,f)){var v=t.interleaved;v===null?(a.next=a,Bz(t)):(a.next=v.next,v.next=a),t.interleaved=a;return}}catch{}finally{}n=J9(e,t,a,r),n!==null&&(a=ms(),Ic(n,e,r,a),v7(n,t,r))}}function y7(e){var t=e.alternate;return e===Po||t!==null&&t===Po}function _7(e,t){A1=w2=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function v7(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ez(e,n)}}var S2={readContext:Vl,useCallback:Wa,useContext:Wa,useEffect:Wa,useImperativeHandle:Wa,useInsertionEffect:Wa,useLayoutEffect:Wa,useMemo:Wa,useReducer:Wa,useRef:Wa,useState:Wa,useDebugValue:Wa,useDeferredValue:Wa,useTransition:Wa,useMutableSource:Wa,useSyncExternalStore:Wa,useId:Wa,unstable_isNewReconciler:!1},Rse={readContext:Vl,useCallback:function(e,t){return hu().memoizedState=[e,t===void 0?null:t],e},useContext:Vl,useEffect:_5,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,WE(4194308,4,h7.bind(null,t,e),n)},useLayoutEffect:function(e,t){return WE(4194308,4,e,t)},useInsertionEffect:function(e,t){return WE(4,2,e,t)},useMemo:function(e,t){var n=hu();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=hu();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ose.bind(null,Po,e),[r.memoizedState,e]},useRef:function(e){var t=hu();return e={current:e},t.memoizedState=e},useState:y5,useDebugValue:Zz,useDeferredValue:function(e){return hu().memoizedState=e},useTransition:function(){var e=y5(!1),t=e[0];return e=Mse.bind(null,e[1]),hu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Po,a=hu();if(yo){if(n===void 0)throw Error(mn(407));n=n()}else{if(n=t(),ba===null)throw Error(mn(349));Am&30||r7(r,t,n)}a.memoizedState=n;var c={value:n,getSnapshot:t};return a.queue=c,_5(o7.bind(null,r,c,e),[e]),r.flags|=2048,sb(9,i7.bind(null,r,c,n,t),void 0,null),n},useId:function(){var e=hu(),t=ba.identifierPrefix;if(yo){var n=wh,r=bh;n=(r&~(1<<32-Cc(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ob++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Ise++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Dse={readContext:Vl,useCallback:f7,useContext:Vl,useEffect:qz,useImperativeHandle:d7,useInsertionEffect:c7,useLayoutEffect:u7,useMemo:p7,useReducer:CO,useRef:l7,useState:function(){return CO(ab)},useDebugValue:Zz,useDeferredValue:function(e){var t=Gl();return m7(t,ia.memoizedState,e)},useTransition:function(){var e=CO(ab)[0],t=Gl().memoizedState;return[e,t]},useMutableSource:t7,useSyncExternalStore:n7,useId:g7,unstable_isNewReconciler:!1},Lse={readContext:Vl,useCallback:f7,useContext:Vl,useEffect:qz,useImperativeHandle:d7,useInsertionEffect:c7,useLayoutEffect:u7,useMemo:p7,useReducer:IO,useRef:l7,useState:function(){return IO(ab)},useDebugValue:Zz,useDeferredValue:function(e){var t=Gl();return ia===null?t.memoizedState=e:m7(t,ia.memoizedState,e)},useTransition:function(){var e=IO(ab)[0],t=Gl().memoizedState;return[e,t]},useMutableSource:t7,useSyncExternalStore:n7,useId:g7,unstable_isNewReconciler:!1};function _c(e,t){if(e&&e.defaultProps){t=Co({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function wR(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Co({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var vP={isMounted:function(e){return(e=e._reactInternals)?Gm(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ms(),a=yf(e),c=Ph(r,a);c.payload=t,n!=null&&(c.callback=n),t=mf(e,c,a),t!==null&&(Ic(t,e,a,r),VE(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ms(),a=yf(e),c=Ph(r,a);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=mf(e,c,a),t!==null&&(Ic(t,e,a,r),VE(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ms(),r=yf(e),a=Ph(n,r);a.tag=2,t!=null&&(a.callback=t),t=mf(e,a,r),t!==null&&(Ic(t,e,r,n),VE(t,e,r))}};function v5(e,t,n,r,a,c,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,c,f):t.prototype&&t.prototype.isPureReactComponent?!Q1(n,r)||!Q1(a,c):!0}function x7(e,t,n){var r=!1,a=Af,c=t.contextType;return typeof c=="object"&&c!==null?c=Vl(c):(a=Vs(t)?Tm:es.current,r=t.contextTypes,c=(r=r!=null)?v_(e,a):Af),t=new t(n,c),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=vP,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=c),t}function x5(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&vP.enqueueReplaceState(t,t.state,null)}function SR(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},jz(e);var c=t.contextType;typeof c=="object"&&c!==null?a.context=Vl(c):(c=Vs(t)?Tm:es.current,a.context=v_(e,c)),a.state=e.memoizedState,c=t.getDerivedStateFromProps,typeof c=="function"&&(wR(e,t,c,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&vP.enqueueReplaceState(a,a.state,null),x2(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function S_(e,t){try{var n="",r=t;do n+=cae(r),r=r.return;while(r);var a=n}catch(c){a=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:t,stack:a,digest:null}}function MO(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function TR(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var zse=typeof WeakMap=="function"?WeakMap:Map;function b7(e,t,n){n=Ph(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){E2||(E2=!0,DR=r),TR(e,t)},n}function w7(e,t,n){n=Ph(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){TR(e,t)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){TR(e,t),typeof r!="function"&&(gf===null?gf=new Set([this]):gf.add(this));var f=t.stack;this.componentDidCatch(t.value,{componentStack:f!==null?f:""})}),n}function b5(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new zse;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Kse.bind(null,e,t,n),t.then(e,e))}function w5(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function S5(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Ph(-1,1),t.tag=2,mf(n,t,1))),n.lanes|=1),e)}var Nse=$h.ReactCurrentOwner,Bs=!1;function cs(e,t,n,r){t.child=e===null?Y9(t,null,n,r):b_(t,e.child,n,r)}function T5(e,t,n,r,a){n=n.render;var c=t.ref;return s_(t,a),r=Wz(e,t,n,r,c,a),n=Hz(),e!==null&&!Bs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Rh(e,t,a)):(yo&&n&&Rz(t),t.flags|=1,cs(e,t,r,a),t.child)}function E5(e,t,n,r,a){if(e===null){var c=n.type;return typeof c=="function"&&!n3(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=c,S7(e,t,c,r,a)):(e=XE(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!(e.lanes&a)){var f=c.memoizedProps;if(n=n.compare,n=n!==null?n:Q1,n(f,r)&&e.ref===t.ref)return Rh(e,t,a)}return t.flags|=1,e=_f(c,r),e.ref=t.ref,e.return=t,t.child=e}function S7(e,t,n,r,a){if(e!==null){var c=e.memoizedProps;if(Q1(c,r)&&e.ref===t.ref)if(Bs=!1,t.pendingProps=r=c,(e.lanes&a)!==0)e.flags&131072&&(Bs=!0);else return t.lanes=e.lanes,Rh(e,t,a)}return ER(e,t,n,r,a)}function T7(e,t,n){var r=t.pendingProps,a=r.children,c=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},io(Yy,cl),cl|=n;else{if(!(n&1073741824))return e=c!==null?c.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,io(Yy,cl),cl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=c!==null?c.baseLanes:n,io(Yy,cl),cl|=r}else c!==null?(r=c.baseLanes|n,t.memoizedState=null):r=n,io(Yy,cl),cl|=r;return cs(e,t,a,n),t.child}function E7(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ER(e,t,n,r,a){var c=Vs(n)?Tm:es.current;return c=v_(t,c),s_(t,a),n=Wz(e,t,n,r,c,a),r=Hz(),e!==null&&!Bs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Rh(e,t,a)):(yo&&r&&Rz(t),t.flags|=1,cs(e,t,n,a),t.child)}function A5(e,t,n,r,a){if(Vs(n)){var c=!0;m2(t)}else c=!1;if(s_(t,a),t.stateNode===null)HE(e,t),x7(t,n,r),SR(t,n,r,a),r=!0;else if(e===null){var f=t.stateNode,i=t.memoizedProps;f.props=i;var v=f.context,b=n.contextType;typeof b=="object"&&b!==null?b=Vl(b):(b=Vs(n)?Tm:es.current,b=v_(t,b));var T=n.getDerivedStateFromProps,A=typeof T=="function"||typeof f.getSnapshotBeforeUpdate=="function";A||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(i!==r||v!==b)&&x5(t,f,r,b),Xd=!1;var M=t.memoizedState;f.state=M,x2(t,r,f,a),v=t.memoizedState,i!==r||M!==v||Us.current||Xd?(typeof T=="function"&&(wR(t,n,T,r),v=t.memoizedState),(i=Xd||v5(t,n,i,r,M,v,b))?(A||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=v),f.props=r,f.state=v,f.context=b,r=i):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{f=t.stateNode,Q9(e,t),i=t.memoizedProps,b=t.type===t.elementType?i:_c(t.type,i),f.props=b,A=t.pendingProps,M=f.context,v=n.contextType,typeof v=="object"&&v!==null?v=Vl(v):(v=Vs(n)?Tm:es.current,v=v_(t,v));var R=n.getDerivedStateFromProps;(T=typeof R=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(i!==A||M!==v)&&x5(t,f,r,v),Xd=!1,M=t.memoizedState,f.state=M,x2(t,r,f,a);var B=t.memoizedState;i!==A||M!==B||Us.current||Xd?(typeof R=="function"&&(wR(t,n,R,r),B=t.memoizedState),(b=Xd||v5(t,n,b,r,M,B,v)||!1)?(T||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(r,B,v),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(r,B,v)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||i===e.memoizedProps&&M===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&M===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=B),f.props=r,f.state=B,f.context=v,r=b):(typeof f.componentDidUpdate!="function"||i===e.memoizedProps&&M===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&M===e.memoizedState||(t.flags|=1024),r=!1)}return AR(e,t,n,r,c,a)}function AR(e,t,n,r,a,c){E7(e,t);var f=(t.flags&128)!==0;if(!r&&!f)return a&&h5(t,n,!1),Rh(e,t,c);r=t.stateNode,Nse.current=t;var i=f&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&f?(t.child=b_(t,e.child,null,c),t.child=b_(t,null,i,c)):cs(e,t,i,c),t.memoizedState=r.state,a&&h5(t,n,!0),t.child}function A7(e){var t=e.stateNode;t.pendingContext?u5(e,t.pendingContext,t.pendingContext!==t.context):t.context&&u5(e,t.context,!1),$z(e,t.containerInfo)}function P5(e,t,n,r,a){return x_(),Lz(a),t.flags|=256,cs(e,t,n,r),t.child}var PR={dehydrated:null,treeContext:null,retryLane:0};function CR(e){return{baseLanes:e,cachePool:null,transitions:null}}function P7(e,t,n){var r=t.pendingProps,a=Eo.current,c=!1,f=(t.flags&128)!==0,i;if((i=f)||(i=e!==null&&e.memoizedState===null?!1:(a&2)!==0),i?(c=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),io(Eo,a&1),e===null)return xR(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(f=r.children,e=r.fallback,c?(r=t.mode,c=t.child,f={mode:"hidden",children:f},!(r&1)&&c!==null?(c.childLanes=0,c.pendingProps=f):c=wP(f,r,0,null),e=xm(e,r,n,null),c.return=t,e.return=t,c.sibling=e,t.child=c,t.child.memoizedState=CR(n),t.memoizedState=PR,e):Xz(t,f));if(a=e.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return Fse(e,t,f,r,i,a,n);if(c){c=r.fallback,f=t.mode,a=e.child,i=a.sibling;var v={mode:"hidden",children:r.children};return!(f&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=v,t.deletions=null):(r=_f(a,v),r.subtreeFlags=a.subtreeFlags&14680064),i!==null?c=_f(i,c):(c=xm(c,f,n,null),c.flags|=2),c.return=t,r.return=t,r.sibling=c,t.child=r,r=c,c=t.child,f=e.child.memoizedState,f=f===null?CR(n):{baseLanes:f.baseLanes|n,cachePool:null,transitions:f.transitions},c.memoizedState=f,c.childLanes=e.childLanes&~n,t.memoizedState=PR,r}return c=e.child,e=c.sibling,r=_f(c,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Xz(e,t){return t=wP({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function iE(e,t,n,r){return r!==null&&Lz(r),b_(t,e.child,null,n),e=Xz(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Fse(e,t,n,r,a,c,f){if(n)return t.flags&256?(t.flags&=-257,r=MO(Error(mn(422))),iE(e,t,f,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(c=r.fallback,a=t.mode,r=wP({mode:"visible",children:r.children},a,0,null),c=xm(c,a,f,null),c.flags|=2,r.return=t,c.return=t,r.sibling=c,t.child=r,t.mode&1&&b_(t,e.child,null,f),t.child.memoizedState=CR(f),t.memoizedState=PR,c);if(!(t.mode&1))return iE(e,t,f,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var i=r.dgst;return r=i,c=Error(mn(419)),r=MO(c,r,void 0),iE(e,t,f,r)}if(i=(f&e.childLanes)!==0,Bs||i){if(r=ba,r!==null){switch(f&-f){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|f)?0:a,a!==0&&a!==c.retryLane&&(c.retryLane=a,kh(e,a),Ic(r,e,a,-1))}return t3(),r=MO(Error(mn(421))),iE(e,t,f,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Yse.bind(null,e),a._reactRetry=t,null):(e=c.treeContext,fl=pf(a.nextSibling),pl=t,yo=!0,Sc=null,e!==null&&(Ll[zl++]=bh,Ll[zl++]=wh,Ll[zl++]=Em,bh=e.id,wh=e.overflow,Em=t),t=Xz(t,r.children),t.flags|=4096,t)}function C5(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),bR(e.return,t,n)}function OO(e,t,n,r,a){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=r,c.tail=n,c.tailMode=a)}function C7(e,t,n){var r=t.pendingProps,a=r.revealOrder,c=r.tail;if(cs(e,t,r.children,n),r=Eo.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&C5(e,n,t);else if(e.tag===19)C5(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(io(Eo,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&b2(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),OO(t,!1,a,n,c);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&b2(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}OO(t,!0,n,null,c);break;case"together":OO(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function HE(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Rh(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Pm|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(mn(153));if(t.child!==null){for(e=t.child,n=_f(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=_f(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Bse(e,t,n){switch(t.tag){case 3:A7(t),x_();break;case 5:e7(t);break;case 1:Vs(t.type)&&m2(t);break;case 4:$z(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;io(_2,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(io(Eo,Eo.current&1),t.flags|=128,null):n&t.child.childLanes?P7(e,t,n):(io(Eo,Eo.current&1),e=Rh(e,t,n),e!==null?e.sibling:null);io(Eo,Eo.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return C7(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),io(Eo,Eo.current),r)break;return null;case 22:case 23:return t.lanes=0,T7(e,t,n)}return Rh(e,t,n)}var I7,IR,M7,O7;I7=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};IR=function(){};M7=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,dm(_u.current);var c=null;switch(n){case"input":a=Yk(e,a),r=Yk(e,r),c=[];break;case"select":a=Co({},a,{value:void 0}),r=Co({},r,{value:void 0}),c=[];break;case"textarea":a=eR(e,a),r=eR(e,r),c=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=f2)}nR(n,r);var f;n=null;for(b in a)if(!r.hasOwnProperty(b)&&a.hasOwnProperty(b)&&a[b]!=null)if(b==="style"){var i=a[b];for(f in i)i.hasOwnProperty(f)&&(n||(n={}),n[f]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(H1.hasOwnProperty(b)?c||(c=[]):(c=c||[]).push(b,null));for(b in r){var v=r[b];if(i=a!=null?a[b]:void 0,r.hasOwnProperty(b)&&v!==i&&(v!=null||i!=null))if(b==="style")if(i){for(f in i)!i.hasOwnProperty(f)||v&&v.hasOwnProperty(f)||(n||(n={}),n[f]="");for(f in v)v.hasOwnProperty(f)&&i[f]!==v[f]&&(n||(n={}),n[f]=v[f])}else n||(c||(c=[]),c.push(b,n)),n=v;else b==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,i=i?i.__html:void 0,v!=null&&i!==v&&(c=c||[]).push(b,v)):b==="children"?typeof v!="string"&&typeof v!="number"||(c=c||[]).push(b,""+v):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(H1.hasOwnProperty(b)?(v!=null&&b==="onScroll"&&co("scroll",e),c||i===v||(c=[])):(c=c||[]).push(b,v))}n&&(c=c||[]).push("style",n);var b=c;(t.updateQueue=b)&&(t.flags|=4)}};O7=function(e,t,n,r){n!==r&&(t.flags|=4)};function $x(e,t){if(!yo)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ha(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function jse(e,t,n){var r=t.pendingProps;switch(Dz(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ha(t),null;case 1:return Vs(t.type)&&p2(),Ha(t),null;case 3:return r=t.stateNode,w_(),po(Us),po(es),Vz(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(nE(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Sc!==null&&(NR(Sc),Sc=null))),IR(e,t),Ha(t),null;case 5:Uz(t);var a=dm(ib.current);if(n=t.type,e!==null&&t.stateNode!=null)M7(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(mn(166));return Ha(t),null}if(e=dm(_u.current),nE(t)){r=t.stateNode,n=t.type;var c=t.memoizedProps;switch(r[du]=t,r[nb]=c,e=(t.mode&1)!==0,n){case"dialog":co("cancel",r),co("close",r);break;case"iframe":case"object":case"embed":co("load",r);break;case"video":case"audio":for(a=0;a<u1.length;a++)co(u1[a],r);break;case"source":co("error",r);break;case"img":case"image":case"link":co("error",r),co("load",r);break;case"details":co("toggle",r);break;case"input":N$(r,c),co("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!c.multiple},co("invalid",r);break;case"textarea":B$(r,c),co("invalid",r)}nR(n,c),a=null;for(var f in c)if(c.hasOwnProperty(f)){var i=c[f];f==="children"?typeof i=="string"?r.textContent!==i&&(c.suppressHydrationWarning!==!0&&tE(r.textContent,i,e),a=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(c.suppressHydrationWarning!==!0&&tE(r.textContent,i,e),a=["children",""+i]):H1.hasOwnProperty(f)&&i!=null&&f==="onScroll"&&co("scroll",r)}switch(n){case"input":qT(r),F$(r,c,!0);break;case"textarea":qT(r),j$(r);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(r.onclick=f2)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{f=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=o9(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=f.createElement(n,{is:r.is}):(e=f.createElement(n),n==="select"&&(f=e,r.multiple?f.multiple=!0:r.size&&(f.size=r.size))):e=f.createElementNS(e,n),e[du]=t,e[nb]=r,I7(e,t,!1,!1),t.stateNode=e;e:{switch(f=rR(n,r),n){case"dialog":co("cancel",e),co("close",e),a=r;break;case"iframe":case"object":case"embed":co("load",e),a=r;break;case"video":case"audio":for(a=0;a<u1.length;a++)co(u1[a],e);a=r;break;case"source":co("error",e),a=r;break;case"img":case"image":case"link":co("error",e),co("load",e),a=r;break;case"details":co("toggle",e),a=r;break;case"input":N$(e,r),a=Yk(e,r),co("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Co({},r,{value:void 0}),co("invalid",e);break;case"textarea":B$(e,r),a=eR(e,r),co("invalid",e);break;default:a=r}nR(n,a),i=a;for(c in i)if(i.hasOwnProperty(c)){var v=i[c];c==="style"?l9(e,v):c==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,v!=null&&a9(e,v)):c==="children"?typeof v=="string"?(n!=="textarea"||v!=="")&&q1(e,v):typeof v=="number"&&q1(e,""+v):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(H1.hasOwnProperty(c)?v!=null&&c==="onScroll"&&co("scroll",e):v!=null&&vz(e,c,v,f))}switch(n){case"input":qT(e),F$(e,r,!1);break;case"textarea":qT(e),j$(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ef(r.value));break;case"select":e.multiple=!!r.multiple,c=r.value,c!=null?r_(e,!!r.multiple,c,!1):r.defaultValue!=null&&r_(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=f2)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ha(t),null;case 6:if(e&&t.stateNode!=null)O7(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(mn(166));if(n=dm(ib.current),dm(_u.current),nE(t)){if(r=t.stateNode,n=t.memoizedProps,r[du]=t,(c=r.nodeValue!==n)&&(e=pl,e!==null))switch(e.tag){case 3:tE(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&tE(r.nodeValue,n,(e.mode&1)!==0)}c&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[du]=t,t.stateNode=r}return Ha(t),null;case 13:if(po(Eo),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(yo&&fl!==null&&t.mode&1&&!(t.flags&128))X9(),x_(),t.flags|=98560,c=!1;else if(c=nE(t),r!==null&&r.dehydrated!==null){if(e===null){if(!c)throw Error(mn(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(mn(317));c[du]=t}else x_(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ha(t),c=!1}else Sc!==null&&(NR(Sc),Sc=null),c=!0;if(!c)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Eo.current&1?oa===0&&(oa=3):t3())),t.updateQueue!==null&&(t.flags|=4),Ha(t),null);case 4:return w_(),IR(e,t),e===null&&eb(t.stateNode.containerInfo),Ha(t),null;case 10:return Fz(t.type._context),Ha(t),null;case 17:return Vs(t.type)&&p2(),Ha(t),null;case 19:if(po(Eo),c=t.memoizedState,c===null)return Ha(t),null;if(r=(t.flags&128)!==0,f=c.rendering,f===null)if(r)$x(c,!1);else{if(oa!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(f=b2(e),f!==null){for(t.flags|=128,$x(c,!1),r=f.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)c=n,e=r,c.flags&=14680066,f=c.alternate,f===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=f.childLanes,c.lanes=f.lanes,c.child=f.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=f.memoizedProps,c.memoizedState=f.memoizedState,c.updateQueue=f.updateQueue,c.type=f.type,e=f.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return io(Eo,Eo.current&1|2),t.child}e=e.sibling}c.tail!==null&&Bo()>T_&&(t.flags|=128,r=!0,$x(c,!1),t.lanes=4194304)}else{if(!r)if(e=b2(f),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),$x(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!yo)return Ha(t),null}else 2*Bo()-c.renderingStartTime>T_&&n!==1073741824&&(t.flags|=128,r=!0,$x(c,!1),t.lanes=4194304);c.isBackwards?(f.sibling=t.child,t.child=f):(n=c.last,n!==null?n.sibling=f:t.child=f,c.last=f)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Bo(),t.sibling=null,n=Eo.current,io(Eo,r?n&1|2:n&1),t):(Ha(t),null);case 22:case 23:return e3(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?cl&1073741824&&(Ha(t),t.subtreeFlags&6&&(t.flags|=8192)):Ha(t),null;case 24:return null;case 25:return null}throw Error(mn(156,t.tag))}function $se(e,t){switch(Dz(t),t.tag){case 1:return Vs(t.type)&&p2(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return w_(),po(Us),po(es),Vz(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Uz(t),null;case 13:if(po(Eo),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(mn(340));x_()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return po(Eo),null;case 4:return w_(),null;case 10:return Fz(t.type._context),null;case 22:case 23:return e3(),null;case 24:return null;default:return null}}var oE=!1,Ka=!1,Use=typeof WeakSet=="function"?WeakSet:Set,Kn=null;function Ky(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ko(e,t,r)}else n.current=null}function MR(e,t,n){try{n()}catch(r){ko(e,t,r)}}var I5=!1;function Vse(e,t){if(fR=u2,e=z9(),kz(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,c=r.focusNode;r=r.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var f=0,i=-1,v=-1,b=0,T=0,A=e,M=null;t:for(;;){for(var R;A!==n||a!==0&&A.nodeType!==3||(i=f+a),A!==c||r!==0&&A.nodeType!==3||(v=f+r),A.nodeType===3&&(f+=A.nodeValue.length),(R=A.firstChild)!==null;)M=A,A=R;for(;;){if(A===e)break t;if(M===n&&++b===a&&(i=f),M===c&&++T===r&&(v=f),(R=A.nextSibling)!==null)break;A=M,M=A.parentNode}A=R}n=i===-1||v===-1?null:{start:i,end:v}}else n=null}n=n||{start:0,end:0}}else n=null;for(pR={focusedElem:e,selectionRange:n},u2=!1,Kn=t;Kn!==null;)if(t=Kn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Kn=e;else for(;Kn!==null;){t=Kn;try{var B=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(B!==null){var L=B.memoizedProps,j=B.memoizedState,V=t.stateNode,$=V.getSnapshotBeforeUpdate(t.elementType===t.type?L:_c(t.type,L),j);V.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var H=t.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(mn(163))}}catch(K){ko(t,t.return,K)}if(e=t.sibling,e!==null){e.return=t.return,Kn=e;break}Kn=t.return}return B=I5,I5=!1,B}function P1(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var c=a.destroy;a.destroy=void 0,c!==void 0&&MR(t,n,c)}a=a.next}while(a!==r)}}function xP(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function OR(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function k7(e){var t=e.alternate;t!==null&&(e.alternate=null,k7(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[du],delete t[nb],delete t[yR],delete t[Ese],delete t[Ase])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function R7(e){return e.tag===5||e.tag===3||e.tag===4}function M5(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||R7(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function kR(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=f2));else if(r!==4&&(e=e.child,e!==null))for(kR(e,t,n),e=e.sibling;e!==null;)kR(e,t,n),e=e.sibling}function RR(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(RR(e,t,n),e=e.sibling;e!==null;)RR(e,t,n),e=e.sibling}var Ma=null,vc=!1;function Bd(e,t,n){for(n=n.child;n!==null;)D7(e,t,n),n=n.sibling}function D7(e,t,n){if(yu&&typeof yu.onCommitFiberUnmount=="function")try{yu.onCommitFiberUnmount(dP,n)}catch{}switch(n.tag){case 5:Ka||Ky(n,t);case 6:var r=Ma,a=vc;Ma=null,Bd(e,t,n),Ma=r,vc=a,Ma!==null&&(vc?(e=Ma,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ma.removeChild(n.stateNode));break;case 18:Ma!==null&&(vc?(e=Ma,n=n.stateNode,e.nodeType===8?TO(e.parentNode,n):e.nodeType===1&&TO(e,n),Y1(e)):TO(Ma,n.stateNode));break;case 4:r=Ma,a=vc,Ma=n.stateNode.containerInfo,vc=!0,Bd(e,t,n),Ma=r,vc=a;break;case 0:case 11:case 14:case 15:if(!Ka&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var c=a,f=c.destroy;c=c.tag,f!==void 0&&(c&2||c&4)&&MR(n,t,f),a=a.next}while(a!==r)}Bd(e,t,n);break;case 1:if(!Ka&&(Ky(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){ko(n,t,i)}Bd(e,t,n);break;case 21:Bd(e,t,n);break;case 22:n.mode&1?(Ka=(r=Ka)||n.memoizedState!==null,Bd(e,t,n),Ka=r):Bd(e,t,n);break;default:Bd(e,t,n)}}function O5(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Use),t.forEach(function(r){var a=Jse.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function fc(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var c=e,f=t,i=f;e:for(;i!==null;){switch(i.tag){case 5:Ma=i.stateNode,vc=!1;break e;case 3:Ma=i.stateNode.containerInfo,vc=!0;break e;case 4:Ma=i.stateNode.containerInfo,vc=!0;break e}i=i.return}if(Ma===null)throw Error(mn(160));D7(c,f,a),Ma=null,vc=!1;var v=a.alternate;v!==null&&(v.return=null),a.return=null}catch(b){ko(a,t,b)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)L7(t,e),t=t.sibling}function L7(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fc(t,e),uu(e),r&4){try{P1(3,e,e.return),xP(3,e)}catch(L){ko(e,e.return,L)}try{P1(5,e,e.return)}catch(L){ko(e,e.return,L)}}break;case 1:fc(t,e),uu(e),r&512&&n!==null&&Ky(n,n.return);break;case 5:if(fc(t,e),uu(e),r&512&&n!==null&&Ky(n,n.return),e.flags&32){var a=e.stateNode;try{q1(a,"")}catch(L){ko(e,e.return,L)}}if(r&4&&(a=e.stateNode,a!=null)){var c=e.memoizedProps,f=n!==null?n.memoizedProps:c,i=e.type,v=e.updateQueue;if(e.updateQueue=null,v!==null)try{i==="input"&&c.type==="radio"&&c.name!=null&&r9(a,c),rR(i,f);var b=rR(i,c);for(f=0;f<v.length;f+=2){var T=v[f],A=v[f+1];T==="style"?l9(a,A):T==="dangerouslySetInnerHTML"?a9(a,A):T==="children"?q1(a,A):vz(a,T,A,b)}switch(i){case"input":Jk(a,c);break;case"textarea":i9(a,c);break;case"select":var M=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!c.multiple;var R=c.value;R!=null?r_(a,!!c.multiple,R,!1):M!==!!c.multiple&&(c.defaultValue!=null?r_(a,!!c.multiple,c.defaultValue,!0):r_(a,!!c.multiple,c.multiple?[]:"",!1))}a[nb]=c}catch(L){ko(e,e.return,L)}}break;case 6:if(fc(t,e),uu(e),r&4){if(e.stateNode===null)throw Error(mn(162));a=e.stateNode,c=e.memoizedProps;try{a.nodeValue=c}catch(L){ko(e,e.return,L)}}break;case 3:if(fc(t,e),uu(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Y1(t.containerInfo)}catch(L){ko(e,e.return,L)}break;case 4:fc(t,e),uu(e);break;case 13:fc(t,e),uu(e),a=e.child,a.flags&8192&&(c=a.memoizedState!==null,a.stateNode.isHidden=c,!c||a.alternate!==null&&a.alternate.memoizedState!==null||(Jz=Bo())),r&4&&O5(e);break;case 22:if(T=n!==null&&n.memoizedState!==null,e.mode&1?(Ka=(b=Ka)||T,fc(t,e),Ka=b):fc(t,e),uu(e),r&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!T&&e.mode&1)for(Kn=e,T=e.child;T!==null;){for(A=Kn=T;Kn!==null;){switch(M=Kn,R=M.child,M.tag){case 0:case 11:case 14:case 15:P1(4,M,M.return);break;case 1:Ky(M,M.return);var B=M.stateNode;if(typeof B.componentWillUnmount=="function"){r=M,n=M.return;try{t=r,B.props=t.memoizedProps,B.state=t.memoizedState,B.componentWillUnmount()}catch(L){ko(r,n,L)}}break;case 5:Ky(M,M.return);break;case 22:if(M.memoizedState!==null){R5(A);continue}}R!==null?(R.return=M,Kn=R):R5(A)}T=T.sibling}e:for(T=null,A=e;;){if(A.tag===5){if(T===null){T=A;try{a=A.stateNode,b?(c=a.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(i=A.stateNode,v=A.memoizedProps.style,f=v!=null&&v.hasOwnProperty("display")?v.display:null,i.style.display=s9("display",f))}catch(L){ko(e,e.return,L)}}}else if(A.tag===6){if(T===null)try{A.stateNode.nodeValue=b?"":A.memoizedProps}catch(L){ko(e,e.return,L)}}else if((A.tag!==22&&A.tag!==23||A.memoizedState===null||A===e)&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===e)break e;for(;A.sibling===null;){if(A.return===null||A.return===e)break e;T===A&&(T=null),A=A.return}T===A&&(T=null),A.sibling.return=A.return,A=A.sibling}}break;case 19:fc(t,e),uu(e),r&4&&O5(e);break;case 21:break;default:fc(t,e),uu(e)}}function uu(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(R7(n)){var r=n;break e}n=n.return}throw Error(mn(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(q1(a,""),r.flags&=-33);var c=M5(e);RR(e,c,a);break;case 3:case 4:var f=r.stateNode.containerInfo,i=M5(e);kR(e,i,f);break;default:throw Error(mn(161))}}catch(v){ko(e,e.return,v)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Gse(e,t,n){Kn=e,z7(e)}function z7(e,t,n){for(var r=(e.mode&1)!==0;Kn!==null;){var a=Kn,c=a.child;if(a.tag===22&&r){var f=a.memoizedState!==null||oE;if(!f){var i=a.alternate,v=i!==null&&i.memoizedState!==null||Ka;i=oE;var b=Ka;if(oE=f,(Ka=v)&&!b)for(Kn=a;Kn!==null;)f=Kn,v=f.child,f.tag===22&&f.memoizedState!==null?D5(a):v!==null?(v.return=f,Kn=v):D5(a);for(;c!==null;)Kn=c,z7(c),c=c.sibling;Kn=a,oE=i,Ka=b}k5(e)}else a.subtreeFlags&8772&&c!==null?(c.return=a,Kn=c):k5(e)}}function k5(e){for(;Kn!==null;){var t=Kn;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ka||xP(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ka)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:_c(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var c=t.updateQueue;c!==null&&g5(t,c,r);break;case 3:var f=t.updateQueue;if(f!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}g5(t,f,n)}break;case 5:var i=t.stateNode;if(n===null&&t.flags&4){n=i;var v=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":v.autoFocus&&n.focus();break;case"img":v.src&&(n.src=v.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var b=t.alternate;if(b!==null){var T=b.memoizedState;if(T!==null){var A=T.dehydrated;A!==null&&Y1(A)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(mn(163))}Ka||t.flags&512&&OR(t)}catch(M){ko(t,t.return,M)}}if(t===e){Kn=null;break}if(n=t.sibling,n!==null){n.return=t.return,Kn=n;break}Kn=t.return}}function R5(e){for(;Kn!==null;){var t=Kn;if(t===e){Kn=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Kn=n;break}Kn=t.return}}function D5(e){for(;Kn!==null;){var t=Kn;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{xP(4,t)}catch(v){ko(t,n,v)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(v){ko(t,a,v)}}var c=t.return;try{OR(t)}catch(v){ko(t,c,v)}break;case 5:var f=t.return;try{OR(t)}catch(v){ko(t,f,v)}}}catch(v){ko(t,t.return,v)}if(t===e){Kn=null;break}var i=t.sibling;if(i!==null){i.return=t.return,Kn=i;break}Kn=t.return}}var Wse=Math.ceil,T2=$h.ReactCurrentDispatcher,Kz=$h.ReactCurrentOwner,jl=$h.ReactCurrentBatchConfig,Ri=0,ba=null,Xo=null,Ra=0,cl=0,Yy=jf(0),oa=0,lb=null,Pm=0,bP=0,Yz=0,C1=null,Ns=null,Jz=0,T_=1/0,mh=null,E2=!1,DR=null,gf=null,aE=!1,af=null,A2=0,I1=0,LR=null,qE=-1,ZE=0;function ms(){return Ri&6?Bo():qE!==-1?qE:qE=Bo()}function yf(e){return e.mode&1?Ri&2&&Ra!==0?Ra&-Ra:Cse.transition!==null?(ZE===0&&(ZE=x9()),ZE):(e=Gi,e!==0||(e=window.event,e=e===void 0?16:P9(e.type)),e):1}function Ic(e,t,n,r){if(50<I1)throw I1=0,LR=null,Error(mn(185));dw(e,n,r),(!(Ri&2)||e!==ba)&&(e===ba&&(!(Ri&2)&&(bP|=n),oa===4&&Qd(e,Ra)),Gs(e,r),n===1&&Ri===0&&!(t.mode&1)&&(T_=Bo()+500,yP&&$f()))}function Gs(e,t){var n=e.callbackNode;Cae(e,t);var r=c2(e,e===ba?Ra:0);if(r===0)n!==null&&V$(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&V$(n),t===1)e.tag===0?Pse(L5.bind(null,e)):H9(L5.bind(null,e)),Sse(function(){!(Ri&6)&&$f()}),n=null;else{switch(b9(r)){case 1:n=Tz;break;case 4:n=_9;break;case 16:n=l2;break;case 536870912:n=v9;break;default:n=l2}n=G7(n,N7.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function N7(e,t){if(qE=-1,ZE=0,Ri&6)throw Error(mn(327));var n=e.callbackNode;if(l_()&&e.callbackNode!==n)return null;var r=c2(e,e===ba?Ra:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=P2(e,r);else{t=r;var a=Ri;Ri|=2;var c=B7();(ba!==e||Ra!==t)&&(mh=null,T_=Bo()+500,vm(e,t));do try{Zse();break}catch(i){F7(e,i)}while(!0);Nz(),T2.current=c,Ri=a,Xo!==null?t=0:(ba=null,Ra=0,t=oa)}if(t!==0){if(t===2&&(a=lR(e),a!==0&&(r=a,t=zR(e,a))),t===1)throw n=lb,vm(e,0),Qd(e,r),Gs(e,Bo()),n;if(t===6)Qd(e,r);else{if(a=e.current.alternate,!(r&30)&&!Hse(a)&&(t=P2(e,r),t===2&&(c=lR(e),c!==0&&(r=c,t=zR(e,c))),t===1))throw n=lb,vm(e,0),Qd(e,r),Gs(e,Bo()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(mn(345));case 2:nm(e,Ns,mh);break;case 3:if(Qd(e,r),(r&130023424)===r&&(t=Jz+500-Bo(),10<t)){if(c2(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){ms(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=gR(nm.bind(null,e,Ns,mh),t);break}nm(e,Ns,mh);break;case 4:if(Qd(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var f=31-Cc(r);c=1<<f,f=t[f],f>a&&(a=f),r&=~c}if(r=a,r=Bo()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Wse(r/1960))-r,10<r){e.timeoutHandle=gR(nm.bind(null,e,Ns,mh),r);break}nm(e,Ns,mh);break;case 5:nm(e,Ns,mh);break;default:throw Error(mn(329))}}}return Gs(e,Bo()),e.callbackNode===n?N7.bind(null,e):null}function zR(e,t){var n=C1;return e.current.memoizedState.isDehydrated&&(vm(e,t).flags|=256),e=P2(e,t),e!==2&&(t=Ns,Ns=n,t!==null&&NR(t)),e}function NR(e){Ns===null?Ns=e:Ns.push.apply(Ns,e)}function Hse(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],c=a.getSnapshot;a=a.value;try{if(!Rc(c(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qd(e,t){for(t&=~Yz,t&=~bP,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Cc(t),r=1<<n;e[n]=-1,t&=~r}}function L5(e){if(Ri&6)throw Error(mn(327));l_();var t=c2(e,0);if(!(t&1))return Gs(e,Bo()),null;var n=P2(e,t);if(e.tag!==0&&n===2){var r=lR(e);r!==0&&(t=r,n=zR(e,r))}if(n===1)throw n=lb,vm(e,0),Qd(e,t),Gs(e,Bo()),n;if(n===6)throw Error(mn(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,nm(e,Ns,mh),Gs(e,Bo()),null}function Qz(e,t){var n=Ri;Ri|=1;try{return e(t)}finally{Ri=n,Ri===0&&(T_=Bo()+500,yP&&$f())}}function Cm(e){af!==null&&af.tag===0&&!(Ri&6)&&l_();var t=Ri;Ri|=1;var n=jl.transition,r=Gi;try{if(jl.transition=null,Gi=1,e)return e()}finally{Gi=r,jl.transition=n,Ri=t,!(Ri&6)&&$f()}}function e3(){cl=Yy.current,po(Yy)}function vm(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,wse(n)),Xo!==null)for(n=Xo.return;n!==null;){var r=n;switch(Dz(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&p2();break;case 3:w_(),po(Us),po(es),Vz();break;case 5:Uz(r);break;case 4:w_();break;case 13:po(Eo);break;case 19:po(Eo);break;case 10:Fz(r.type._context);break;case 22:case 23:e3()}n=n.return}if(ba=e,Xo=e=_f(e.current,null),Ra=cl=t,oa=0,lb=null,Yz=bP=Pm=0,Ns=C1=null,hm!==null){for(t=0;t<hm.length;t++)if(n=hm[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,c=n.pending;if(c!==null){var f=c.next;c.next=a,r.next=f}n.pending=r}hm=null}return e}function F7(e,t){do{var n=Xo;try{if(Nz(),GE.current=S2,w2){for(var r=Po.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}w2=!1}if(Am=0,va=ia=Po=null,A1=!1,ob=0,Kz.current=null,n===null||n.return===null){oa=1,lb=t,Xo=null;break}e:{var c=e,f=n.return,i=n,v=t;if(t=Ra,i.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){var b=v,T=i,A=T.tag;if(!(T.mode&1)&&(A===0||A===11||A===15)){var M=T.alternate;M?(T.updateQueue=M.updateQueue,T.memoizedState=M.memoizedState,T.lanes=M.lanes):(T.updateQueue=null,T.memoizedState=null)}var R=w5(f);if(R!==null){R.flags&=-257,S5(R,f,i,c,t),R.mode&1&&b5(c,b,t),t=R,v=b;var B=t.updateQueue;if(B===null){var L=new Set;L.add(v),t.updateQueue=L}else B.add(v);break e}else{if(!(t&1)){b5(c,b,t),t3();break e}v=Error(mn(426))}}else if(yo&&i.mode&1){var j=w5(f);if(j!==null){!(j.flags&65536)&&(j.flags|=256),S5(j,f,i,c,t),Lz(S_(v,i));break e}}c=v=S_(v,i),oa!==4&&(oa=2),C1===null?C1=[c]:C1.push(c),c=f;do{switch(c.tag){case 3:c.flags|=65536,t&=-t,c.lanes|=t;var V=b7(c,v,t);m5(c,V);break e;case 1:i=v;var $=c.type,H=c.stateNode;if(!(c.flags&128)&&(typeof $.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(gf===null||!gf.has(H)))){c.flags|=65536,t&=-t,c.lanes|=t;var K=w7(c,i,t);m5(c,K);break e}}c=c.return}while(c!==null)}$7(n)}catch(Y){t=Y,Xo===n&&n!==null&&(Xo=n=n.return);continue}break}while(!0)}function B7(){var e=T2.current;return T2.current=S2,e===null?S2:e}function t3(){(oa===0||oa===3||oa===2)&&(oa=4),ba===null||!(Pm&268435455)&&!(bP&268435455)||Qd(ba,Ra)}function P2(e,t){var n=Ri;Ri|=2;var r=B7();(ba!==e||Ra!==t)&&(mh=null,vm(e,t));do try{qse();break}catch(a){F7(e,a)}while(!0);if(Nz(),Ri=n,T2.current=r,Xo!==null)throw Error(mn(261));return ba=null,Ra=0,oa}function qse(){for(;Xo!==null;)j7(Xo)}function Zse(){for(;Xo!==null&&!vae();)j7(Xo)}function j7(e){var t=V7(e.alternate,e,cl);e.memoizedProps=e.pendingProps,t===null?$7(e):Xo=t,Kz.current=null}function $7(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=$se(n,t),n!==null){n.flags&=32767,Xo=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{oa=6,Xo=null;return}}else if(n=jse(n,t,cl),n!==null){Xo=n;return}if(t=t.sibling,t!==null){Xo=t;return}Xo=t=e}while(t!==null);oa===0&&(oa=5)}function nm(e,t,n){var r=Gi,a=jl.transition;try{jl.transition=null,Gi=1,Xse(e,t,n,r)}finally{jl.transition=a,Gi=r}return null}function Xse(e,t,n,r){do l_();while(af!==null);if(Ri&6)throw Error(mn(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(mn(177));e.callbackNode=null,e.callbackPriority=0;var c=n.lanes|n.childLanes;if(Iae(e,c),e===ba&&(Xo=ba=null,Ra=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||aE||(aE=!0,G7(l2,function(){return l_(),null})),c=(n.flags&15990)!==0,n.subtreeFlags&15990||c){c=jl.transition,jl.transition=null;var f=Gi;Gi=1;var i=Ri;Ri|=4,Kz.current=null,Vse(e,n),L7(n,e),mse(pR),u2=!!fR,pR=fR=null,e.current=n,Gse(n),xae(),Ri=i,Gi=f,jl.transition=c}else e.current=n;if(aE&&(aE=!1,af=e,A2=a),c=e.pendingLanes,c===0&&(gf=null),Sae(n.stateNode),Gs(e,Bo()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(E2)throw E2=!1,e=DR,DR=null,e;return A2&1&&e.tag!==0&&l_(),c=e.pendingLanes,c&1?e===LR?I1++:(I1=0,LR=e):I1=0,$f(),null}function l_(){if(af!==null){var e=b9(A2),t=jl.transition,n=Gi;try{if(jl.transition=null,Gi=16>e?16:e,af===null)var r=!1;else{if(e=af,af=null,A2=0,Ri&6)throw Error(mn(331));var a=Ri;for(Ri|=4,Kn=e.current;Kn!==null;){var c=Kn,f=c.child;if(Kn.flags&16){var i=c.deletions;if(i!==null){for(var v=0;v<i.length;v++){var b=i[v];for(Kn=b;Kn!==null;){var T=Kn;switch(T.tag){case 0:case 11:case 15:P1(8,T,c)}var A=T.child;if(A!==null)A.return=T,Kn=A;else for(;Kn!==null;){T=Kn;var M=T.sibling,R=T.return;if(k7(T),T===b){Kn=null;break}if(M!==null){M.return=R,Kn=M;break}Kn=R}}}var B=c.alternate;if(B!==null){var L=B.child;if(L!==null){B.child=null;do{var j=L.sibling;L.sibling=null,L=j}while(L!==null)}}Kn=c}}if(c.subtreeFlags&2064&&f!==null)f.return=c,Kn=f;else e:for(;Kn!==null;){if(c=Kn,c.flags&2048)switch(c.tag){case 0:case 11:case 15:P1(9,c,c.return)}var V=c.sibling;if(V!==null){V.return=c.return,Kn=V;break e}Kn=c.return}}var $=e.current;for(Kn=$;Kn!==null;){f=Kn;var H=f.child;if(f.subtreeFlags&2064&&H!==null)H.return=f,Kn=H;else e:for(f=$;Kn!==null;){if(i=Kn,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:xP(9,i)}}catch(Y){ko(i,i.return,Y)}if(i===f){Kn=null;break e}var K=i.sibling;if(K!==null){K.return=i.return,Kn=K;break e}Kn=i.return}}if(Ri=a,$f(),yu&&typeof yu.onPostCommitFiberRoot=="function")try{yu.onPostCommitFiberRoot(dP,e)}catch{}r=!0}return r}finally{Gi=n,jl.transition=t}}return!1}function z5(e,t,n){t=S_(n,t),t=b7(e,t,1),e=mf(e,t,1),t=ms(),e!==null&&(dw(e,1,t),Gs(e,t))}function ko(e,t,n){if(e.tag===3)z5(e,e,n);else for(;t!==null;){if(t.tag===3){z5(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gf===null||!gf.has(r))){e=S_(n,e),e=w7(t,e,1),t=mf(t,e,1),e=ms(),t!==null&&(dw(t,1,e),Gs(t,e));break}}t=t.return}}function Kse(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ms(),e.pingedLanes|=e.suspendedLanes&n,ba===e&&(Ra&n)===n&&(oa===4||oa===3&&(Ra&130023424)===Ra&&500>Bo()-Jz?vm(e,0):Yz|=n),Gs(e,t)}function U7(e,t){t===0&&(e.mode&1?(t=KT,KT<<=1,!(KT&130023424)&&(KT=4194304)):t=1);var n=ms();e=kh(e,t),e!==null&&(dw(e,t,n),Gs(e,n))}function Yse(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),U7(e,n)}function Jse(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(mn(314))}r!==null&&r.delete(t),U7(e,n)}var V7;V7=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Us.current)Bs=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Bs=!1,Bse(e,t,n);Bs=!!(e.flags&131072)}else Bs=!1,yo&&t.flags&1048576&&q9(t,y2,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;HE(e,t),e=t.pendingProps;var a=v_(t,es.current);s_(t,n),a=Wz(null,t,r,e,a,n);var c=Hz();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vs(r)?(c=!0,m2(t)):c=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,jz(t),a.updater=vP,t.stateNode=a,a._reactInternals=t,SR(t,r,e,n),t=AR(null,t,r,!0,c,n)):(t.tag=0,yo&&c&&Rz(t),cs(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(HE(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=ele(r),e=_c(r,e),a){case 0:t=ER(null,t,r,e,n);break e;case 1:t=A5(null,t,r,e,n);break e;case 11:t=T5(null,t,r,e,n);break e;case 14:t=E5(null,t,r,_c(r.type,e),n);break e}throw Error(mn(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:_c(r,a),ER(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:_c(r,a),A5(e,t,r,a,n);case 3:e:{if(A7(t),e===null)throw Error(mn(387));r=t.pendingProps,c=t.memoizedState,a=c.element,Q9(e,t),x2(t,r,null,n);var f=t.memoizedState;if(r=f.element,c.isDehydrated)if(c={element:r,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){a=S_(Error(mn(423)),t),t=P5(e,t,r,n,a);break e}else if(r!==a){a=S_(Error(mn(424)),t),t=P5(e,t,r,n,a);break e}else for(fl=pf(t.stateNode.containerInfo.firstChild),pl=t,yo=!0,Sc=null,n=Y9(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(x_(),r===a){t=Rh(e,t,n);break e}cs(e,t,r,n)}t=t.child}return t;case 5:return e7(t),e===null&&xR(t),r=t.type,a=t.pendingProps,c=e!==null?e.memoizedProps:null,f=a.children,mR(r,a)?f=null:c!==null&&mR(r,c)&&(t.flags|=32),E7(e,t),cs(e,t,f,n),t.child;case 6:return e===null&&xR(t),null;case 13:return P7(e,t,n);case 4:return $z(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=b_(t,null,r,n):cs(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:_c(r,a),T5(e,t,r,a,n);case 7:return cs(e,t,t.pendingProps,n),t.child;case 8:return cs(e,t,t.pendingProps.children,n),t.child;case 12:return cs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,c=t.memoizedProps,f=a.value,io(_2,r._currentValue),r._currentValue=f,c!==null)if(Rc(c.value,f)){if(c.children===a.children&&!Us.current){t=Rh(e,t,n);break e}}else for(c=t.child,c!==null&&(c.return=t);c!==null;){var i=c.dependencies;if(i!==null){f=c.child;for(var v=i.firstContext;v!==null;){if(v.context===r){if(c.tag===1){v=Ph(-1,n&-n),v.tag=2;var b=c.updateQueue;if(b!==null){b=b.shared;var T=b.pending;T===null?v.next=v:(v.next=T.next,T.next=v),b.pending=v}}c.lanes|=n,v=c.alternate,v!==null&&(v.lanes|=n),bR(c.return,n,t),i.lanes|=n;break}v=v.next}}else if(c.tag===10)f=c.type===t.type?null:c.child;else if(c.tag===18){if(f=c.return,f===null)throw Error(mn(341));f.lanes|=n,i=f.alternate,i!==null&&(i.lanes|=n),bR(f,n,t),f=c.sibling}else f=c.child;if(f!==null)f.return=c;else for(f=c;f!==null;){if(f===t){f=null;break}if(c=f.sibling,c!==null){c.return=f.return,f=c;break}f=f.return}c=f}cs(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,s_(t,n),a=Vl(a),r=r(a),t.flags|=1,cs(e,t,r,n),t.child;case 14:return r=t.type,a=_c(r,t.pendingProps),a=_c(r.type,a),E5(e,t,r,a,n);case 15:return S7(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:_c(r,a),HE(e,t),t.tag=1,Vs(r)?(e=!0,m2(t)):e=!1,s_(t,n),x7(t,r,a),SR(t,r,a,n),AR(null,t,r,!0,e,n);case 19:return C7(e,t,n);case 22:return T7(e,t,n)}throw Error(mn(156,t.tag))};function G7(e,t){return y9(e,t)}function Qse(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fl(e,t,n,r){return new Qse(e,t,n,r)}function n3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ele(e){if(typeof e=="function")return n3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===bz)return 11;if(e===wz)return 14}return 2}function _f(e,t){var n=e.alternate;return n===null?(n=Fl(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function XE(e,t,n,r,a,c){var f=2;if(r=e,typeof e=="function")n3(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case $y:return xm(n.children,a,c,t);case xz:f=8,a|=8;break;case qk:return e=Fl(12,n,t,a|2),e.elementType=qk,e.lanes=c,e;case Zk:return e=Fl(13,n,t,a),e.elementType=Zk,e.lanes=c,e;case Xk:return e=Fl(19,n,t,a),e.elementType=Xk,e.lanes=c,e;case e9:return wP(n,a,c,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case JW:f=10;break e;case QW:f=9;break e;case bz:f=11;break e;case wz:f=14;break e;case Zd:f=16,r=null;break e}throw Error(mn(130,e==null?e:typeof e,""))}return t=Fl(f,n,t,a),t.elementType=e,t.type=r,t.lanes=c,t}function xm(e,t,n,r){return e=Fl(7,e,r,t),e.lanes=n,e}function wP(e,t,n,r){return e=Fl(22,e,r,t),e.elementType=e9,e.lanes=n,e.stateNode={isHidden:!1},e}function kO(e,t,n){return e=Fl(6,e,null,t),e.lanes=n,e}function RO(e,t,n){return t=Fl(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function tle(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fO(0),this.expirationTimes=fO(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fO(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function r3(e,t,n,r,a,c,f,i,v){return e=new tle(e,t,n,i,v),t===1?(t=1,c===!0&&(t|=8)):t=0,c=Fl(3,null,null,t),e.current=c,c.stateNode=e,c.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jz(c),e}function nle(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jy,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function W7(e){if(!e)return Af;e=e._reactInternals;e:{if(Gm(e)!==e||e.tag!==1)throw Error(mn(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(mn(171))}if(e.tag===1){var n=e.type;if(Vs(n))return W9(e,n,t)}return t}function H7(e,t,n,r,a,c,f,i,v){return e=r3(n,r,!0,e,a,c,f,i,v),e.context=W7(null),n=e.current,r=ms(),a=yf(n),c=Ph(r,a),c.callback=t??null,mf(n,c,a),e.current.lanes=a,dw(e,a,r),Gs(e,r),e}function SP(e,t,n,r){var a=t.current,c=ms(),f=yf(a);return n=W7(n),t.context===null?t.context=n:t.pendingContext=n,t=Ph(c,f),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=mf(a,t,f),e!==null&&(Ic(e,a,f,c),VE(e,a,f)),f}function C2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function N5(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function i3(e,t){N5(e,t),(e=e.alternate)&&N5(e,t)}function rle(){return null}var q7=typeof reportError=="function"?reportError:function(e){console.error(e)};function o3(e){this._internalRoot=e}TP.prototype.render=o3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(mn(409));SP(e,t,null,null)};TP.prototype.unmount=o3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Cm(function(){SP(null,e,null,null)}),t[Oh]=null}};function TP(e){this._internalRoot=e}TP.prototype.unstable_scheduleHydration=function(e){if(e){var t=T9();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Jd.length&&t!==0&&t<Jd[n].priority;n++);Jd.splice(n,0,e),n===0&&A9(e)}};function a3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function EP(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function F5(){}function ile(e,t,n,r,a){if(a){if(typeof r=="function"){var c=r;r=function(){var b=C2(f);c.call(b)}}var f=H7(t,r,e,0,null,!1,!1,"",F5);return e._reactRootContainer=f,e[Oh]=f.current,eb(e.nodeType===8?e.parentNode:e),Cm(),f}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var i=r;r=function(){var b=C2(v);i.call(b)}}var v=r3(e,0,!1,null,null,!1,!1,"",F5);return e._reactRootContainer=v,e[Oh]=v.current,eb(e.nodeType===8?e.parentNode:e),Cm(function(){SP(t,v,n,r)}),v}function AP(e,t,n,r,a){var c=n._reactRootContainer;if(c){var f=c;if(typeof a=="function"){var i=a;a=function(){var v=C2(f);i.call(v)}}SP(t,f,e,a)}else f=ile(n,t,e,a,r);return C2(f)}w9=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=c1(t.pendingLanes);n!==0&&(Ez(t,n|1),Gs(t,Bo()),!(Ri&6)&&(T_=Bo()+500,$f()))}break;case 13:Cm(function(){var r=kh(e,1);if(r!==null){var a=ms();Ic(r,e,1,a)}}),i3(e,1)}};Az=function(e){if(e.tag===13){var t=kh(e,134217728);if(t!==null){var n=ms();Ic(t,e,134217728,n)}i3(e,134217728)}};S9=function(e){if(e.tag===13){var t=yf(e),n=kh(e,t);if(n!==null){var r=ms();Ic(n,e,t,r)}i3(e,t)}};T9=function(){return Gi};E9=function(e,t){var n=Gi;try{return Gi=e,t()}finally{Gi=n}};oR=function(e,t,n){switch(t){case"input":if(Jk(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=gP(r);if(!a)throw Error(mn(90));n9(r),Jk(r,a)}}}break;case"textarea":i9(e,n);break;case"select":t=n.value,t!=null&&r_(e,!!n.multiple,t,!1)}};h9=Qz;d9=Cm;var ole={usingClientEntryPoint:!1,Events:[pw,Wy,gP,c9,u9,Qz]},Ux={findFiberByHostInstance:um,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ale={bundleType:Ux.bundleType,version:Ux.version,rendererPackageName:Ux.rendererPackageName,rendererConfig:Ux.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$h.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=m9(e),e===null?null:e.stateNode},findFiberByHostInstance:Ux.findFiberByHostInstance||rle,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sE.isDisabled&&sE.supportsFiber)try{dP=sE.inject(ale),yu=sE}catch{}}xl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ole;xl.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!a3(t))throw Error(mn(200));return nle(e,t,null,n)};xl.createRoot=function(e,t){if(!a3(e))throw Error(mn(299));var n=!1,r="",a=q7;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=r3(e,1,!1,null,null,n,!1,r,a),e[Oh]=t.current,eb(e.nodeType===8?e.parentNode:e),new o3(t)};xl.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(mn(188)):(e=Object.keys(e).join(","),Error(mn(268,e)));return e=m9(t),e=e===null?null:e.stateNode,e};xl.flushSync=function(e){return Cm(e)};xl.hydrate=function(e,t,n){if(!EP(t))throw Error(mn(200));return AP(null,e,t,!0,n)};xl.hydrateRoot=function(e,t,n){if(!a3(e))throw Error(mn(405));var r=n!=null&&n.hydratedSources||null,a=!1,c="",f=q7;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),t=H7(t,null,e,1,n??null,a,!1,c,f),e[Oh]=t.current,eb(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new TP(t)};xl.render=function(e,t,n){if(!EP(t))throw Error(mn(200));return AP(null,e,t,!1,n)};xl.unmountComponentAtNode=function(e){if(!EP(e))throw Error(mn(40));return e._reactRootContainer?(Cm(function(){AP(null,null,e,!1,function(){e._reactRootContainer=null,e[Oh]=null})}),!0):!1};xl.unstable_batchedUpdates=Qz;xl.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!EP(n))throw Error(mn(200));if(e==null||e._reactInternals===void 0)throw Error(mn(38));return AP(e,t,n,!1,r)};xl.version="18.3.1-next-f1338f8080-20240426";function Z7(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z7)}catch(e){console.error(e)}}Z7(),ZW.exports=xl;var Wm=ZW.exports;const PP=Bi(Wm);var sle,B5=Wm;sle=B5.createRoot,B5.hydrateRoot;const lle="modulepreload",cle=function(e){return"/"+e},j5={},gw=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),i=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=Promise.allSettled(n.map(v=>{if(v=cle(v),v in j5)return;j5[v]=!0;const b=v.endsWith(".css"),T=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${T}`))return;const A=document.createElement("link");if(A.rel=b?"stylesheet":lle,b||(A.as="script"),A.crossOrigin="",A.href=v,i&&A.setAttribute("nonce",i),document.head.appendChild(A),b)return new Promise((M,R)=>{A.addEventListener("load",M),A.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${v}`)))})}))}function c(f){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=f,window.dispatchEvent(i),!i.defaultPrevented)throw f}return a.then(f=>{for(const i of f||[])i.status==="rejected"&&c(i.reason);return t().catch(c)})};/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cb(){return cb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cb.apply(this,arguments)}var sf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(sf||(sf={}));const $5="popstate";function ule(e){e===void 0&&(e={});function t(r,a){let{pathname:c,search:f,hash:i}=r.location;return FR("",{pathname:c,search:f,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:I2(a)}return dle(t,n,null,e)}function Ko(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function X7(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function hle(){return Math.random().toString(36).substr(2,8)}function U5(e,t){return{usr:e.state,key:e.key,idx:t}}function FR(e,t,n,r){return n===void 0&&(n=null),cb({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?gv(t):t,{state:n,key:t&&t.key||r||hle()})}function I2(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function gv(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function dle(e,t,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:c=!1}=r,f=a.history,i=sf.Pop,v=null,b=T();b==null&&(b=0,f.replaceState(cb({},f.state,{idx:b}),""));function T(){return(f.state||{idx:null}).idx}function A(){i=sf.Pop;let j=T(),V=j==null?null:j-b;b=j,v&&v({action:i,location:L.location,delta:V})}function M(j,V){i=sf.Push;let $=FR(L.location,j,V);b=T()+1;let H=U5($,b),K=L.createHref($);try{f.pushState(H,"",K)}catch(Y){if(Y instanceof DOMException&&Y.name==="DataCloneError")throw Y;a.location.assign(K)}c&&v&&v({action:i,location:L.location,delta:1})}function R(j,V){i=sf.Replace;let $=FR(L.location,j,V);b=T();let H=U5($,b),K=L.createHref($);f.replaceState(H,"",K),c&&v&&v({action:i,location:L.location,delta:0})}function B(j){let V=a.location.origin!=="null"?a.location.origin:a.location.href,$=typeof j=="string"?j:I2(j);return $=$.replace(/ $/,"%20"),Ko(V,"No window.location.(origin|href) available to create URL for href: "+$),new URL($,V)}let L={get action(){return i},get location(){return e(a,f)},listen(j){if(v)throw new Error("A history only accepts one active listener");return a.addEventListener($5,A),v=j,()=>{a.removeEventListener($5,A),v=null}},createHref(j){return t(a,j)},createURL:B,encodeLocation(j){let V=B(j);return{pathname:V.pathname,search:V.search,hash:V.hash}},push:M,replace:R,go(j){return f.go(j)}};return L}var V5;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(V5||(V5={}));function fle(e,t,n){return n===void 0&&(n="/"),ple(e,t,n,!1)}function ple(e,t,n,r){let a=typeof t=="string"?gv(t):t,c=s3(a.pathname||"/",n);if(c==null)return null;let f=K7(e);mle(f);let i=null;for(let v=0;i==null&&v<f.length;++v){let b=Ale(c);i=Tle(f[v],b,r)}return i}function K7(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(c,f,i)=>{let v={relativePath:i===void 0?c.path||"":i,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};v.relativePath.startsWith("/")&&(Ko(v.relativePath.startsWith(r),'Absolute route path "'+v.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),v.relativePath=v.relativePath.slice(r.length));let b=vf([r,v.relativePath]),T=n.concat(v);c.children&&c.children.length>0&&(Ko(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),K7(c.children,t,T,b)),!(c.path==null&&!c.index)&&t.push({path:b,score:wle(b,c.index),routesMeta:T})};return e.forEach((c,f)=>{var i;if(c.path===""||!((i=c.path)!=null&&i.includes("?")))a(c,f);else for(let v of Y7(c.path))a(c,f,v)}),t}function Y7(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),c=n.replace(/\?$/,"");if(r.length===0)return a?[c,""]:[c];let f=Y7(r.join("/")),i=[];return i.push(...f.map(v=>v===""?c:[c,v].join("/"))),a&&i.push(...f),i.map(v=>e.startsWith("/")&&v===""?"/":v)}function mle(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Sle(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const gle=/^:[\w-]+$/,yle=3,_le=2,vle=1,xle=10,ble=-2,G5=e=>e==="*";function wle(e,t){let n=e.split("/"),r=n.length;return n.some(G5)&&(r+=ble),t&&(r+=_le),n.filter(a=>!G5(a)).reduce((a,c)=>a+(gle.test(c)?yle:c===""?vle:xle),r)}function Sle(e,t){return e.length===t.length&&e.slice(0,-1).every((r,a)=>r===t[a])?e[e.length-1]-t[t.length-1]:0}function Tle(e,t,n){let{routesMeta:r}=e,a={},c="/",f=[];for(let i=0;i<r.length;++i){let v=r[i],b=i===r.length-1,T=c==="/"?t:t.slice(c.length)||"/",A=W5({path:v.relativePath,caseSensitive:v.caseSensitive,end:b},T),M=v.route;if(!A&&b&&n&&!r[r.length-1].route.index&&(A=W5({path:v.relativePath,caseSensitive:v.caseSensitive,end:!1},T)),!A)return null;Object.assign(a,A.params),f.push({params:a,pathname:vf([c,A.pathname]),pathnameBase:Mle(vf([c,A.pathnameBase])),route:M}),A.pathnameBase!=="/"&&(c=vf([c,A.pathnameBase]))}return f}function W5(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Ele(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let c=a[0],f=c.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:r.reduce((b,T,A)=>{let{paramName:M,isOptional:R}=T;if(M==="*"){let L=i[A]||"";f=c.slice(0,c.length-L.length).replace(/(.)\/+$/,"$1")}const B=i[A];return R&&!B?b[M]=void 0:b[M]=(B||"").replace(/%2F/g,"/"),b},{}),pathname:c,pathnameBase:f,pattern:e}}function Ele(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),X7(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,i,v)=>(r.push({paramName:i,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function Ale(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return X7(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function s3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Ple(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?gv(e):e;return{pathname:n?n.startsWith("/")?n:Cle(n,t):t,search:Ole(r),hash:kle(a)}}function Cle(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function DO(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Ile(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function J7(e,t){let n=Ile(e);return t?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Q7(e,t,n,r){r===void 0&&(r=!1);let a;typeof e=="string"?a=gv(e):(a=cb({},e),Ko(!a.pathname||!a.pathname.includes("?"),DO("?","pathname","search",a)),Ko(!a.pathname||!a.pathname.includes("#"),DO("#","pathname","hash",a)),Ko(!a.search||!a.search.includes("#"),DO("#","search","hash",a)));let c=e===""||a.pathname==="",f=c?"/":a.pathname,i;if(f==null)i=n;else{let A=t.length-1;if(!r&&f.startsWith("..")){let M=f.split("/");for(;M[0]==="..";)M.shift(),A-=1;a.pathname=M.join("/")}i=A>=0?t[A]:"/"}let v=Ple(a,i),b=f&&f!=="/"&&f.endsWith("/"),T=(c||f===".")&&n.endsWith("/");return!v.pathname.endsWith("/")&&(b||T)&&(v.pathname+="/"),v}const vf=e=>e.join("/").replace(/\/\/+/g,"/"),Mle=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Ole=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kle=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Rle(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const eH=["post","put","patch","delete"];new Set(eH);const Dle=["get",...eH];new Set(Dle);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ub(){return ub=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ub.apply(this,arguments)}const l3=X.createContext(null),Lle=X.createContext(null),Hm=X.createContext(null),CP=X.createContext(null),qm=X.createContext({outlet:null,matches:[],isDataRoute:!1}),tH=X.createContext(null);function zle(e,t){let{relative:n}=t===void 0?{}:t;yw()||Ko(!1);let{basename:r,navigator:a}=X.useContext(Hm),{hash:c,pathname:f,search:i}=iH(e,{relative:n}),v=f;return r!=="/"&&(v=f==="/"?r:vf([r,f])),a.createHref({pathname:v,search:i,hash:c})}function yw(){return X.useContext(CP)!=null}function _w(){return yw()||Ko(!1),X.useContext(CP).location}function nH(e){X.useContext(Hm).static||X.useLayoutEffect(e)}function rH(){let{isDataRoute:e}=X.useContext(qm);return e?Xle():Nle()}function Nle(){yw()||Ko(!1);let e=X.useContext(l3),{basename:t,future:n,navigator:r}=X.useContext(Hm),{matches:a}=X.useContext(qm),{pathname:c}=_w(),f=JSON.stringify(J7(a,n.v7_relativeSplatPath)),i=X.useRef(!1);return nH(()=>{i.current=!0}),X.useCallback(function(b,T){if(T===void 0&&(T={}),!i.current)return;if(typeof b=="number"){r.go(b);return}let A=Q7(b,JSON.parse(f),c,T.relative==="path");e==null&&t!=="/"&&(A.pathname=A.pathname==="/"?t:vf([t,A.pathname])),(T.replace?r.replace:r.push)(A,T.state,T)},[t,r,f,c,e])}function iH(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=X.useContext(Hm),{matches:a}=X.useContext(qm),{pathname:c}=_w(),f=JSON.stringify(J7(a,r.v7_relativeSplatPath));return X.useMemo(()=>Q7(e,JSON.parse(f),c,n==="path"),[e,f,c,n])}function Fle(e,t){return Ble(e,t)}function Ble(e,t,n,r){yw()||Ko(!1);let{navigator:a}=X.useContext(Hm),{matches:c}=X.useContext(qm),f=c[c.length-1],i=f?f.params:{};f&&f.pathname;let v=f?f.pathnameBase:"/";f&&f.route;let b=_w(),T;if(t){var A;let j=typeof t=="string"?gv(t):t;v==="/"||(A=j.pathname)!=null&&A.startsWith(v)||Ko(!1),T=j}else T=b;let M=T.pathname||"/",R=M;if(v!=="/"){let j=v.replace(/^\//,"").split("/");R="/"+M.replace(/^\//,"").split("/").slice(j.length).join("/")}let B=fle(e,{pathname:R}),L=Gle(B&&B.map(j=>Object.assign({},j,{params:Object.assign({},i,j.params),pathname:vf([v,a.encodeLocation?a.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?v:vf([v,a.encodeLocation?a.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),c,n,r);return t&&L?X.createElement(CP.Provider,{value:{location:ub({pathname:"/",search:"",hash:"",state:null,key:"default"},T),navigationType:sf.Pop}},L):L}function jle(){let e=Zle(),t=Rle(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},t),n?X.createElement("pre",{style:a},n):null,null)}const $le=X.createElement(jle,null);class Ule extends X.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?X.createElement(qm.Provider,{value:this.props.routeContext},X.createElement(tH.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Vle(e){let{routeContext:t,match:n,children:r}=e,a=X.useContext(l3);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),X.createElement(qm.Provider,{value:t},r)}function Gle(e,t,n,r){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var c;if(!n)return null;if(n.errors)e=n.matches;else if((c=r)!=null&&c.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let f=e,i=(a=n)==null?void 0:a.errors;if(i!=null){let T=f.findIndex(A=>A.route.id&&(i==null?void 0:i[A.route.id])!==void 0);T>=0||Ko(!1),f=f.slice(0,Math.min(f.length,T+1))}let v=!1,b=-1;if(n&&r&&r.v7_partialHydration)for(let T=0;T<f.length;T++){let A=f[T];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(b=T),A.route.id){let{loaderData:M,errors:R}=n,B=A.route.loader&&M[A.route.id]===void 0&&(!R||R[A.route.id]===void 0);if(A.route.lazy||B){v=!0,b>=0?f=f.slice(0,b+1):f=[f[0]];break}}}return f.reduceRight((T,A,M)=>{let R,B=!1,L=null,j=null;n&&(R=i&&A.route.id?i[A.route.id]:void 0,L=A.route.errorElement||$le,v&&(b<0&&M===0?(B=!0,j=null):b===M&&(B=!0,j=A.route.hydrateFallbackElement||null)));let V=t.concat(f.slice(0,M+1)),$=()=>{let H;return R?H=L:B?H=j:A.route.Component?H=X.createElement(A.route.Component,null):A.route.element?H=A.route.element:H=T,X.createElement(Vle,{match:A,routeContext:{outlet:T,matches:V,isDataRoute:n!=null},children:H})};return n&&(A.route.ErrorBoundary||A.route.errorElement||M===0)?X.createElement(Ule,{location:n.location,revalidation:n.revalidation,component:L,error:R,children:$(),routeContext:{outlet:null,matches:V,isDataRoute:!0}}):$()},null)}var oH=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(oH||{}),M2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(M2||{});function Wle(e){let t=X.useContext(l3);return t||Ko(!1),t}function Hle(e){let t=X.useContext(Lle);return t||Ko(!1),t}function qle(e){let t=X.useContext(qm);return t||Ko(!1),t}function aH(e){let t=qle(),n=t.matches[t.matches.length-1];return n.route.id||Ko(!1),n.route.id}function Zle(){var e;let t=X.useContext(tH),n=Hle(M2.UseRouteError),r=aH(M2.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function Xle(){let{router:e}=Wle(oH.UseNavigateStable),t=aH(M2.UseNavigateStable),n=X.useRef(!1);return nH(()=>{n.current=!0}),X.useCallback(function(a,c){c===void 0&&(c={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,ub({fromRouteId:t},c)))},[e,t])}function Kle(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Yle(e){Ko(!1)}function Jle(e){let{basename:t="/",children:n=null,location:r,navigationType:a=sf.Pop,navigator:c,static:f=!1,future:i}=e;yw()&&Ko(!1);let v=t.replace(/^\/*/,"/"),b=X.useMemo(()=>({basename:v,navigator:c,static:f,future:ub({v7_relativeSplatPath:!1},i)}),[v,i,c,f]);typeof r=="string"&&(r=gv(r));let{pathname:T="/",search:A="",hash:M="",state:R=null,key:B="default"}=r,L=X.useMemo(()=>{let j=s3(T,v);return j==null?null:{location:{pathname:j,search:A,hash:M,state:R,key:B},navigationType:a}},[v,T,A,M,R,B,a]);return L==null?null:X.createElement(Hm.Provider,{value:b},X.createElement(CP.Provider,{children:n,value:L}))}function j7e(e){let{children:t,location:n}=e;return Fle(BR(t),n)}new Promise(()=>{});function BR(e,t){t===void 0&&(t=[]);let n=[];return X.Children.forEach(e,(r,a)=>{if(!X.isValidElement(r))return;let c=[...t,a];if(r.type===X.Fragment){n.push.apply(n,BR(r.props.children,c));return}r.type!==Yle&&Ko(!1),!r.props.index||!r.props.children||Ko(!1);let f={id:r.props.id||c.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(f.children=BR(r.props.children,c)),n.push(f)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jR(){return jR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jR.apply(this,arguments)}function Qle(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,c;for(c=0;c<r.length;c++)a=r[c],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function ece(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function tce(e,t){return e.button===0&&(!t||t==="_self")&&!ece(e)}function $R(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function nce(e,t){let n=$R(e);return t&&t.forEach((r,a)=>{n.has(a)||t.getAll(a).forEach(c=>{n.append(a,c)})}),n}const rce=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ice="6";try{window.__reactRouterVersion=ice}catch{}const oce="startTransition",H5=gz[oce];function $7e(e){let{basename:t,children:n,future:r,window:a}=e,c=X.useRef();c.current==null&&(c.current=ule({window:a,v5Compat:!0}));let f=c.current,[i,v]=X.useState({action:f.action,location:f.location}),{v7_startTransition:b}=r||{},T=X.useCallback(A=>{b&&H5?H5(()=>v(A)):v(A)},[v,b]);return X.useLayoutEffect(()=>f.listen(T),[f,T]),X.useEffect(()=>Kle(r),[r]),X.createElement(Jle,{basename:t,children:n,location:i.location,navigationType:i.action,navigator:f,future:r})}const ace=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",sce=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,U7e=X.forwardRef(function(t,n){let{onClick:r,relative:a,reloadDocument:c,replace:f,state:i,target:v,to:b,preventScrollReset:T,viewTransition:A}=t,M=Qle(t,rce),{basename:R}=X.useContext(Hm),B,L=!1;if(typeof b=="string"&&sce.test(b)&&(B=b,ace))try{let H=new URL(window.location.href),K=b.startsWith("//")?new URL(H.protocol+b):new URL(b),Y=s3(K.pathname,R);K.origin===H.origin&&Y!=null?b=Y+K.search+K.hash:L=!0}catch{}let j=zle(b,{relative:a}),V=lce(b,{replace:f,state:i,target:v,preventScrollReset:T,relative:a,viewTransition:A});function $(H){r&&r(H),H.defaultPrevented||V(H)}return X.createElement("a",jR({},M,{href:B||j,onClick:L||c?r:$,ref:n,target:v}))});var q5;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(q5||(q5={}));var Z5;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Z5||(Z5={}));function lce(e,t){let{target:n,replace:r,state:a,preventScrollReset:c,relative:f,viewTransition:i}=t===void 0?{}:t,v=rH(),b=_w(),T=iH(e,{relative:f});return X.useCallback(A=>{if(tce(A,n)){A.preventDefault();let M=r!==void 0?r:I2(b)===I2(T);v(e,{replace:M,state:a,preventScrollReset:c,relative:f,viewTransition:i})}},[b,v,T,r,a,n,e,c,f,i])}function V7e(e){let t=X.useRef($R(e)),n=X.useRef(!1),r=_w(),a=X.useMemo(()=>nce(r.search,n.current?null:t.current),[r.search]),c=rH(),f=X.useCallback((i,v)=>{const b=$R(typeof i=="function"?i(a):i);n.current=!0,c("?"+b,v)},[c,a]);return[a,f]}function cce(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function vw(...e){return t=>e.forEach(n=>cce(n,t))}function qr(...e){return X.useCallback(vw(...e),e)}var Pf=X.forwardRef((e,t)=>{const{children:n,...r}=e,a=X.Children.toArray(n),c=a.find(uce);if(c){const f=c.props.children,i=a.map(v=>v===c?X.Children.count(f)>1?X.Children.only(null):X.isValidElement(f)?f.props.children:null:v);return he.jsx(UR,{...r,ref:t,children:X.isValidElement(f)?X.cloneElement(f,void 0,i):null})}return he.jsx(UR,{...r,ref:t,children:n})});Pf.displayName="Slot";var UR=X.forwardRef((e,t)=>{const{children:n,...r}=e;if(X.isValidElement(n)){const a=dce(n);return X.cloneElement(n,{...hce(r,n.props),ref:t?vw(t,a):a})}return X.Children.count(n)>1?X.Children.only(null):null});UR.displayName="SlotClone";var c3=({children:e})=>he.jsx(he.Fragment,{children:e});function uce(e){return X.isValidElement(e)&&e.type===c3}function hce(e,t){const n={...t};for(const r in t){const a=e[r],c=t[r];/^on[A-Z]/.test(r)?a&&c?n[r]=(...i)=>{c(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...c}:r==="className"&&(n[r]=[a,c].filter(Boolean).join(" "))}return{...e,...n}}function dce(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function sH(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=sH(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function jr(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=sH(e))&&(r&&(r+=" "),r+=t);return r}const X5=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,K5=jr,G7e=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return K5(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:c}=t,f=Object.keys(a).map(b=>{const T=n==null?void 0:n[b],A=c==null?void 0:c[b];if(T===null)return null;const M=X5(T)||X5(A);return a[b][M]}),i=n&&Object.entries(n).reduce((b,T)=>{let[A,M]=T;return M===void 0||(b[A]=M),b},{}),v=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((b,T)=>{let{class:A,className:M,...R}=T;return Object.entries(R).every(B=>{let[L,j]=B;return Array.isArray(j)?j.includes({...c,...i}[L]):{...c,...i}[L]===j})?[...b,A,M]:b},[]);return K5(e,f,v,n==null?void 0:n.class,n==null?void 0:n.className)},u3="-",fce=e=>{const t=mce(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:f=>{const i=f.split(u3);return i[0]===""&&i.length!==1&&i.shift(),lH(i,t)||pce(f)},getConflictingClassGroupIds:(f,i)=>{const v=n[f]||[];return i&&r[f]?[...v,...r[f]]:v}}},lH=(e,t)=>{var f;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),a=r?lH(e.slice(1),r):void 0;if(a)return a;if(t.validators.length===0)return;const c=e.join(u3);return(f=t.validators.find(({validator:i})=>i(c)))==null?void 0:f.classGroupId},Y5=/^\[(.+)\]$/,pce=e=>{if(Y5.test(e)){const t=Y5.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},mce=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return yce(Object.entries(e.classGroups),n).forEach(([c,f])=>{VR(f,r,c,t)}),r},VR=(e,t,n,r)=>{e.forEach(a=>{if(typeof a=="string"){const c=a===""?t:J5(t,a);c.classGroupId=n;return}if(typeof a=="function"){if(gce(a)){VR(a(r),t,n,r);return}t.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([c,f])=>{VR(f,J5(t,c),n,r)})})},J5=(e,t)=>{let n=e;return t.split(u3).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},gce=e=>e.isThemeGetter,yce=(e,t)=>t?e.map(([n,r])=>{const a=r.map(c=>typeof c=="string"?t+c:typeof c=="object"?Object.fromEntries(Object.entries(c).map(([f,i])=>[t+f,i])):c);return[n,a]}):e,_ce=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const a=(c,f)=>{n.set(c,f),t++,t>e&&(t=0,r=n,n=new Map)};return{get(c){let f=n.get(c);if(f!==void 0)return f;if((f=r.get(c))!==void 0)return a(c,f),f},set(c,f){n.has(c)?n.set(c,f):a(c,f)}}},cH="!",vce=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,a=t[0],c=t.length,f=i=>{const v=[];let b=0,T=0,A;for(let j=0;j<i.length;j++){let V=i[j];if(b===0){if(V===a&&(r||i.slice(j,j+c)===t)){v.push(i.slice(T,j)),T=j+c;continue}if(V==="/"){A=j;continue}}V==="["?b++:V==="]"&&b--}const M=v.length===0?i:i.substring(T),R=M.startsWith(cH),B=R?M.substring(1):M,L=A&&A>T?A-T:void 0;return{modifiers:v,hasImportantModifier:R,baseClassName:B,maybePostfixModifierPosition:L}};return n?i=>n({className:i,parseClassName:f}):f},xce=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},bce=e=>({cache:_ce(e.cacheSize),parseClassName:vce(e),...fce(e)}),wce=/\s+/,Sce=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=t,c=[],f=e.trim().split(wce);let i="";for(let v=f.length-1;v>=0;v-=1){const b=f[v],{modifiers:T,hasImportantModifier:A,baseClassName:M,maybePostfixModifierPosition:R}=n(b);let B=!!R,L=r(B?M.substring(0,R):M);if(!L){if(!B){i=b+(i.length>0?" "+i:i);continue}if(L=r(M),!L){i=b+(i.length>0?" "+i:i);continue}B=!1}const j=xce(T).join(":"),V=A?j+cH:j,$=V+L;if(c.includes($))continue;c.push($);const H=a(L,B);for(let K=0;K<H.length;++K){const Y=H[K];c.push(V+Y)}i=b+(i.length>0?" "+i:i)}return i};function Tce(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=uH(t))&&(r&&(r+=" "),r+=n);return r}const uH=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=uH(e[r]))&&(n&&(n+=" "),n+=t);return n};function Ece(e,...t){let n,r,a,c=f;function f(v){const b=t.reduce((T,A)=>A(T),e());return n=bce(b),r=n.cache.get,a=n.cache.set,c=i,i(v)}function i(v){const b=r(v);if(b)return b;const T=Sce(v,n);return a(v,T),T}return function(){return c(Tce.apply(null,arguments))}}const lo=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},hH=/^\[(?:([a-z-]+):)?(.+)\]$/i,Ace=/^\d+\/\d+$/,Pce=new Set(["px","full","screen"]),Cce=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Ice=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Mce=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Oce=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,kce=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,lh=e=>c_(e)||Pce.has(e)||Ace.test(e),jd=e=>yv(e,"length",jce),c_=e=>!!e&&!Number.isNaN(Number(e)),LO=e=>yv(e,"number",c_),Vx=e=>!!e&&Number.isInteger(Number(e)),Rce=e=>e.endsWith("%")&&c_(e.slice(0,-1)),Jr=e=>hH.test(e),$d=e=>Cce.test(e),Dce=new Set(["length","size","percentage"]),Lce=e=>yv(e,Dce,dH),zce=e=>yv(e,"position",dH),Nce=new Set(["image","url"]),Fce=e=>yv(e,Nce,Uce),Bce=e=>yv(e,"",$ce),Gx=()=>!0,yv=(e,t,n)=>{const r=hH.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},jce=e=>Ice.test(e)&&!Mce.test(e),dH=()=>!1,$ce=e=>Oce.test(e),Uce=e=>kce.test(e),Vce=()=>{const e=lo("colors"),t=lo("spacing"),n=lo("blur"),r=lo("brightness"),a=lo("borderColor"),c=lo("borderRadius"),f=lo("borderSpacing"),i=lo("borderWidth"),v=lo("contrast"),b=lo("grayscale"),T=lo("hueRotate"),A=lo("invert"),M=lo("gap"),R=lo("gradientColorStops"),B=lo("gradientColorStopPositions"),L=lo("inset"),j=lo("margin"),V=lo("opacity"),$=lo("padding"),H=lo("saturate"),K=lo("scale"),Y=lo("sepia"),se=lo("skew"),ce=lo("space"),ye=lo("translate"),ze=()=>["auto","contain","none"],Le=()=>["auto","hidden","clip","visible","scroll"],je=()=>["auto",Jr,t],Re=()=>[Jr,t],$e=()=>["",lh,jd],Ge=()=>["auto",c_,Jr],ht=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ot=()=>["solid","dashed","dotted","double","none"],Je=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ne=()=>["start","end","center","between","around","evenly","stretch"],Xe=()=>["","0",Jr],pt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],zt=()=>[c_,Jr];return{cacheSize:500,separator:":",theme:{colors:[Gx],spacing:[lh,jd],blur:["none","",$d,Jr],brightness:zt(),borderColor:[e],borderRadius:["none","","full",$d,Jr],borderSpacing:Re(),borderWidth:$e(),contrast:zt(),grayscale:Xe(),hueRotate:zt(),invert:Xe(),gap:Re(),gradientColorStops:[e],gradientColorStopPositions:[Rce,jd],inset:je(),margin:je(),opacity:zt(),padding:Re(),saturate:zt(),scale:zt(),sepia:Xe(),skew:zt(),space:Re(),translate:Re()},classGroups:{aspect:[{aspect:["auto","square","video",Jr]}],container:["container"],columns:[{columns:[$d]}],"break-after":[{"break-after":pt()}],"break-before":[{"break-before":pt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ht(),Jr]}],overflow:[{overflow:Le()}],"overflow-x":[{"overflow-x":Le()}],"overflow-y":[{"overflow-y":Le()}],overscroll:[{overscroll:ze()}],"overscroll-x":[{"overscroll-x":ze()}],"overscroll-y":[{"overscroll-y":ze()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[L]}],"inset-x":[{"inset-x":[L]}],"inset-y":[{"inset-y":[L]}],start:[{start:[L]}],end:[{end:[L]}],top:[{top:[L]}],right:[{right:[L]}],bottom:[{bottom:[L]}],left:[{left:[L]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Vx,Jr]}],basis:[{basis:je()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Jr]}],grow:[{grow:Xe()}],shrink:[{shrink:Xe()}],order:[{order:["first","last","none",Vx,Jr]}],"grid-cols":[{"grid-cols":[Gx]}],"col-start-end":[{col:["auto",{span:["full",Vx,Jr]},Jr]}],"col-start":[{"col-start":Ge()}],"col-end":[{"col-end":Ge()}],"grid-rows":[{"grid-rows":[Gx]}],"row-start-end":[{row:["auto",{span:[Vx,Jr]},Jr]}],"row-start":[{"row-start":Ge()}],"row-end":[{"row-end":Ge()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Jr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Jr]}],gap:[{gap:[M]}],"gap-x":[{"gap-x":[M]}],"gap-y":[{"gap-y":[M]}],"justify-content":[{justify:["normal",...Ne()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ne(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ne(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[$]}],px:[{px:[$]}],py:[{py:[$]}],ps:[{ps:[$]}],pe:[{pe:[$]}],pt:[{pt:[$]}],pr:[{pr:[$]}],pb:[{pb:[$]}],pl:[{pl:[$]}],m:[{m:[j]}],mx:[{mx:[j]}],my:[{my:[j]}],ms:[{ms:[j]}],me:[{me:[j]}],mt:[{mt:[j]}],mr:[{mr:[j]}],mb:[{mb:[j]}],ml:[{ml:[j]}],"space-x":[{"space-x":[ce]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ce]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Jr,t]}],"min-w":[{"min-w":[Jr,t,"min","max","fit"]}],"max-w":[{"max-w":[Jr,t,"none","full","min","max","fit","prose",{screen:[$d]},$d]}],h:[{h:[Jr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Jr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Jr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Jr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",$d,jd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",LO]}],"font-family":[{font:[Gx]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Jr]}],"line-clamp":[{"line-clamp":["none",c_,LO]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",lh,Jr]}],"list-image":[{"list-image":["none",Jr]}],"list-style-type":[{list:["none","disc","decimal",Jr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[V]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[V]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ot(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",lh,jd]}],"underline-offset":[{"underline-offset":["auto",lh,Jr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Re()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Jr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Jr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[V]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ht(),zce]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Lce]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Fce]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[B]}],"gradient-via-pos":[{via:[B]}],"gradient-to-pos":[{to:[B]}],"gradient-from":[{from:[R]}],"gradient-via":[{via:[R]}],"gradient-to":[{to:[R]}],rounded:[{rounded:[c]}],"rounded-s":[{"rounded-s":[c]}],"rounded-e":[{"rounded-e":[c]}],"rounded-t":[{"rounded-t":[c]}],"rounded-r":[{"rounded-r":[c]}],"rounded-b":[{"rounded-b":[c]}],"rounded-l":[{"rounded-l":[c]}],"rounded-ss":[{"rounded-ss":[c]}],"rounded-se":[{"rounded-se":[c]}],"rounded-ee":[{"rounded-ee":[c]}],"rounded-es":[{"rounded-es":[c]}],"rounded-tl":[{"rounded-tl":[c]}],"rounded-tr":[{"rounded-tr":[c]}],"rounded-br":[{"rounded-br":[c]}],"rounded-bl":[{"rounded-bl":[c]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[V]}],"border-style":[{border:[...ot(),"hidden"]}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[V]}],"divide-style":[{divide:ot()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...ot()]}],"outline-offset":[{"outline-offset":[lh,Jr]}],"outline-w":[{outline:[lh,jd]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:$e()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[V]}],"ring-offset-w":[{"ring-offset":[lh,jd]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",$d,Bce]}],"shadow-color":[{shadow:[Gx]}],opacity:[{opacity:[V]}],"mix-blend":[{"mix-blend":[...Je(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Je()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[v]}],"drop-shadow":[{"drop-shadow":["","none",$d,Jr]}],grayscale:[{grayscale:[b]}],"hue-rotate":[{"hue-rotate":[T]}],invert:[{invert:[A]}],saturate:[{saturate:[H]}],sepia:[{sepia:[Y]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[v]}],"backdrop-grayscale":[{"backdrop-grayscale":[b]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[T]}],"backdrop-invert":[{"backdrop-invert":[A]}],"backdrop-opacity":[{"backdrop-opacity":[V]}],"backdrop-saturate":[{"backdrop-saturate":[H]}],"backdrop-sepia":[{"backdrop-sepia":[Y]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[f]}],"border-spacing-x":[{"border-spacing-x":[f]}],"border-spacing-y":[{"border-spacing-y":[f]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Jr]}],duration:[{duration:zt()}],ease:[{ease:["linear","in","out","in-out",Jr]}],delay:[{delay:zt()}],animate:[{animate:["none","spin","ping","pulse","bounce",Jr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[K]}],"scale-x":[{"scale-x":[K]}],"scale-y":[{"scale-y":[K]}],rotate:[{rotate:[Vx,Jr]}],"translate-x":[{"translate-x":[ye]}],"translate-y":[{"translate-y":[ye]}],"skew-x":[{"skew-x":[se]}],"skew-y":[{"skew-y":[se]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Jr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Jr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Re()}],"scroll-mx":[{"scroll-mx":Re()}],"scroll-my":[{"scroll-my":Re()}],"scroll-ms":[{"scroll-ms":Re()}],"scroll-me":[{"scroll-me":Re()}],"scroll-mt":[{"scroll-mt":Re()}],"scroll-mr":[{"scroll-mr":Re()}],"scroll-mb":[{"scroll-mb":Re()}],"scroll-ml":[{"scroll-ml":Re()}],"scroll-p":[{"scroll-p":Re()}],"scroll-px":[{"scroll-px":Re()}],"scroll-py":[{"scroll-py":Re()}],"scroll-ps":[{"scroll-ps":Re()}],"scroll-pe":[{"scroll-pe":Re()}],"scroll-pt":[{"scroll-pt":Re()}],"scroll-pr":[{"scroll-pr":Re()}],"scroll-pb":[{"scroll-pb":Re()}],"scroll-pl":[{"scroll-pl":Re()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Jr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[lh,jd,LO]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},W7e=Ece(Vce),Gce=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>gw(async()=>{const{default:r}=await Promise.resolve().then(()=>_v);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)};class h3 extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class Wce extends h3{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Q5 extends h3{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class eU extends h3{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var GR;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(GR||(GR={}));var Hce=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function i(T){try{b(r.next(T))}catch(A){f(A)}}function v(T){try{b(r.throw(T))}catch(A){f(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,v)}b((r=r.apply(e,t||[])).next())})};class qce{constructor(t,{headers:n={},customFetch:r,region:a=GR.Any}={}){this.url=t,this.headers=n,this.region=a,this.fetch=Gce(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var r;return Hce(this,void 0,void 0,function*(){try{const{headers:a,method:c,body:f}=n;let i={},{region:v}=n;v||(v=this.region);const b=new URL(`${this.url}/${t}`);v&&v!=="any"&&(i["x-region"]=v,b.searchParams.set("forceFunctionRegion",v));let T;f&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",T=f):typeof f=="string"?(i["Content-Type"]="text/plain",T=f):typeof FormData<"u"&&f instanceof FormData?T=f:(i["Content-Type"]="application/json",T=JSON.stringify(f)));const A=yield this.fetch(b.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),a),body:T}).catch(L=>{throw new Wce(L)}),M=A.headers.get("x-relay-error");if(M&&M==="true")throw new Q5(A);if(!A.ok)throw new eU(A);let R=((r=A.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),B;return R==="application/json"?B=yield A.json():R==="application/octet-stream"?B=yield A.blob():R==="text/event-stream"?B=A:R==="multipart/form-data"?B=yield A.formData():B=yield A.text(),{data:B,error:null,response:A}}catch(a){return{data:null,error:a,response:a instanceof eU||a instanceof Q5?a.context:void 0}}})}}var Fs={},d3={},IP={},xw={},MP={},OP={},Zce=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},E_=Zce();const Xce=E_.fetch,fH=E_.fetch.bind(E_),pH=E_.Headers,Kce=E_.Request,Yce=E_.Response,_v=Object.freeze(Object.defineProperty({__proto__:null,Headers:pH,Request:Kce,Response:Yce,default:fH,fetch:Xce},Symbol.toStringTag,{value:"Module"})),Jce=Loe(_v);var kP={};Object.defineProperty(kP,"__esModule",{value:!0});let Qce=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};kP.default=Qce;var mH=Oa&&Oa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(OP,"__esModule",{value:!0});const eue=mH(Jce),tue=mH(kP);let nue=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=eue.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var f,i,v;let b=null,T=null,A=null,M=c.status,R=c.statusText;if(c.ok){if(this.method!=="HEAD"){const V=await c.text();V===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?T=V:T=JSON.parse(V))}const L=(f=this.headers.Prefer)===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),j=(i=c.headers.get("content-range"))===null||i===void 0?void 0:i.split("/");L&&j&&j.length>1&&(A=parseInt(j[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(T)&&(T.length>1?(b={code:"PGRST116",details:`Results contain ${T.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},T=null,A=null,M=406,R="Not Acceptable"):T.length===1?T=T[0]:T=null)}else{const L=await c.text();try{b=JSON.parse(L),Array.isArray(b)&&c.status===404&&(T=[],b=null,M=200,R="OK")}catch{c.status===404&&L===""?(M=204,R="No Content"):b={message:L}}if(b&&this.isMaybeSingle&&(!((v=b==null?void 0:b.details)===null||v===void 0)&&v.includes("0 rows"))&&(b=null,M=200,R="OK"),b&&this.shouldThrowOnError)throw new tue.default(b)}return{error:b,data:T,count:A,status:M,statusText:R}});return this.shouldThrowOnError||(a=a.catch(c=>{var f,i,v;return{error:{message:`${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(i=c==null?void 0:c.stack)!==null&&i!==void 0?i:""}`,hint:"",code:`${(v=c==null?void 0:c.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,n)}returns(){return this}overrideTypes(){return this}};OP.default=nue;var rue=Oa&&Oa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(MP,"__esModule",{value:!0});const iue=rue(OP);let oue=class extends iue.default{select(t){let n=!1;const r=(t??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:r,foreignTable:a,referencedTable:c=a}={}){const f=c?`${c}.order`:"order",i=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${i?`${i},`:""}${t}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,n,{foreignTable:r,referencedTable:a=r}={}){const c=typeof a>"u"?"offset":`${a}.offset`,f=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(c,`${t}`),this.url.searchParams.set(f,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:r=!1,buffers:a=!1,wal:c=!1,format:f="text"}={}){var i;const v=[t?"analyze":null,n?"verbose":null,r?"settings":null,a?"buffers":null,c?"wal":null].filter(Boolean).join("|"),b=(i=this.headers.Accept)!==null&&i!==void 0?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${b}"; options=${v};`,f==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};MP.default=oue;var aue=Oa&&Oa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xw,"__esModule",{value:!0});const sue=aue(MP);let lue=class extends sue.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:r,type:a}={}){let c="";a==="plain"?c="pl":a==="phrase"?c="ph":a==="websearch"&&(c="w");const f=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${c}fts${f}.${n}`),this}match(t){return Object.entries(t).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(t,n,r){return this.url.searchParams.append(t,`not.${n}.${r}`),this}or(t,{foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,n,r){return this.url.searchParams.append(t,`${n}.${r}`),this}};xw.default=lue;var cue=Oa&&Oa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(IP,"__esModule",{value:!0});const Wx=cue(xw);let uue=class{constructor(t,{headers:n={},schema:r,fetch:a}){this.url=t,this.headers=n,this.schema=r,this.fetch=a}select(t,{head:n=!1,count:r}={}){const a=n?"HEAD":"GET";let c=!1;const f=(t??"*").split("").map(i=>/\s/.test(i)&&!c?"":(i==='"'&&(c=!c),i)).join("");return this.url.searchParams.set("select",f),r&&(this.headers.Prefer=`count=${r}`),new Wx.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:r=!0}={}){const a="POST",c=[];if(this.headers.Prefer&&c.push(this.headers.Prefer),n&&c.push(`count=${n}`),r||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(t)){const f=t.reduce((i,v)=>i.concat(Object.keys(v)),[]);if(f.length>0){const i=[...new Set(f)].map(v=>`"${v}"`);this.url.searchParams.set("columns",i.join(","))}}return new Wx.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:r=!1,count:a,defaultToNull:c=!0}={}){const f="POST",i=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&i.push(this.headers.Prefer),a&&i.push(`count=${a}`),c||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const v=t.reduce((b,T)=>b.concat(Object.keys(T)),[]);if(v.length>0){const b=[...new Set(v)].map(T=>`"${T}"`);this.url.searchParams.set("columns",b.join(","))}}return new Wx.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new Wx.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Wx.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};IP.default=uue;var RP={},DP={};Object.defineProperty(DP,"__esModule",{value:!0});DP.version=void 0;DP.version="0.0.0-automated";Object.defineProperty(RP,"__esModule",{value:!0});RP.DEFAULT_HEADERS=void 0;const hue=DP;RP.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${hue.version}`};var gH=Oa&&Oa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(d3,"__esModule",{value:!0});const due=gH(IP),fue=gH(xw),pue=RP;let mue=class yH{constructor(t,{headers:n={},schema:r,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},pue.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=a}from(t){const n=new URL(`${this.url}/${t}`);return new due.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new yH(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:a=!1,count:c}={}){let f;const i=new URL(`${this.url}/rpc/${t}`);let v;r||a?(f=r?"HEAD":"GET",Object.entries(n).filter(([T,A])=>A!==void 0).map(([T,A])=>[T,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([T,A])=>{i.searchParams.append(T,A)})):(f="POST",v=n);const b=Object.assign({},this.headers);return c&&(b.Prefer=`count=${c}`),new fue.default({method:f,url:i,headers:b,schema:this.schemaName,body:v,fetch:this.fetch,allowEmpty:!1})}};d3.default=mue;var vv=Oa&&Oa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.PostgrestError=Fs.PostgrestBuilder=Fs.PostgrestTransformBuilder=Fs.PostgrestFilterBuilder=Fs.PostgrestQueryBuilder=Fs.PostgrestClient=void 0;const _H=vv(d3);Fs.PostgrestClient=_H.default;const vH=vv(IP);Fs.PostgrestQueryBuilder=vH.default;const xH=vv(xw);Fs.PostgrestFilterBuilder=xH.default;const bH=vv(MP);Fs.PostgrestTransformBuilder=bH.default;const wH=vv(OP);Fs.PostgrestBuilder=wH.default;const SH=vv(kP);Fs.PostgrestError=SH.default;var gue=Fs.default={PostgrestClient:_H.default,PostgrestQueryBuilder:vH.default,PostgrestFilterBuilder:xH.default,PostgrestTransformBuilder:bH.default,PostgrestBuilder:wH.default,PostgrestError:SH.default};const{PostgrestClient:yue,PostgrestQueryBuilder:Y7e,PostgrestFilterBuilder:J7e,PostgrestTransformBuilder:Q7e,PostgrestBuilder:eHe,PostgrestError:tHe}=gue;function _ue(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const vue=_ue(),xue="2.11.15",bue=`realtime-js/${xue}`,wue="1.0.0",TH=1e4,Sue=1e3;var M1;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(M1||(M1={}));var Za;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Za||(Za={}));var xc;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(xc||(xc={}));var WR;(function(e){e.websocket="websocket"})(WR||(WR={}));var lm;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(lm||(lm={}));class Tue{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const a=n.getUint8(1),c=n.getUint8(2);let f=this.HEADER_LENGTH+2;const i=r.decode(t.slice(f,f+a));f=f+a;const v=r.decode(t.slice(f,f+c));f=f+c;const b=JSON.parse(r.decode(t.slice(f,t.byteLength)));return{ref:null,topic:i,event:v,payload:b}}}let EH=class{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var no;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(no||(no={}));const tU=(e,t,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((c,f)=>(c[f]=Eue(f,e,t,a),c),{})},Eue=(e,t,n,r)=>{const a=t.find(i=>i.name===e),c=a==null?void 0:a.type,f=n[e];return c&&!r.includes(c)?AH(c,f):HR(f)},AH=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return Iue(t,n)}switch(e){case no.bool:return Aue(t);case no.float4:case no.float8:case no.int2:case no.int4:case no.int8:case no.numeric:case no.oid:return Pue(t);case no.json:case no.jsonb:return Cue(t);case no.timestamp:return Mue(t);case no.abstime:case no.date:case no.daterange:case no.int4range:case no.int8range:case no.money:case no.reltime:case no.text:case no.time:case no.timestamptz:case no.timetz:case no.tsrange:case no.tstzrange:return HR(t);default:return HR(t)}},HR=e=>e,Aue=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Pue=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Cue=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Iue=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let c;const f=e.slice(1,n);try{c=JSON.parse("["+f+"]")}catch{c=f?f.split(","):[]}return c.map(i=>AH(t,i))}return e},Mue=e=>typeof e=="string"?e.replace(" ","T"):e,PH=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class zO{constructor(t,n,r={},a=TH){this.channel=t,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var nU;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(nU||(nU={}));class O1{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:c,onLeave:f,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=O1.syncState(this.state,a,c,f),this.pendingDiffs.forEach(v=>{this.state=O1.syncDiff(this.state,v,c,f)}),this.pendingDiffs=[],i()}),this.channel._on(r.diff,{},a=>{const{onJoin:c,onLeave:f,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=O1.syncDiff(this.state,a,c,f),i())}),this.onJoin((a,c,f)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:c,newPresences:f})}),this.onLeave((a,c,f)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:c,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,a){const c=this.cloneDeep(t),f=this.transformState(n),i={},v={};return this.map(c,(b,T)=>{f[b]||(v[b]=T)}),this.map(f,(b,T)=>{const A=c[b];if(A){const M=T.map(j=>j.presence_ref),R=A.map(j=>j.presence_ref),B=T.filter(j=>R.indexOf(j.presence_ref)<0),L=A.filter(j=>M.indexOf(j.presence_ref)<0);B.length>0&&(i[b]=B),L.length>0&&(v[b]=L)}else i[b]=T}),this.syncDiff(c,{joins:i,leaves:v},r,a)}static syncDiff(t,n,r,a){const{joins:c,leaves:f}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(c,(i,v)=>{var b;const T=(b=t[i])!==null&&b!==void 0?b:[];if(t[i]=this.cloneDeep(v),T.length>0){const A=t[i].map(R=>R.presence_ref),M=T.filter(R=>A.indexOf(R.presence_ref)<0);t[i].unshift(...M)}r(i,T,v)}),this.map(f,(i,v)=>{let b=t[i];if(!b)return;const T=v.map(A=>A.presence_ref);b=b.filter(A=>T.indexOf(A.presence_ref)<0),t[i]=b,a(i,b,v),b.length===0&&delete t[i]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const a=t[r];return"metas"in a?n[r]=a.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):n[r]=a,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var rU;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(rU||(rU={}));var iU;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(iU||(iU={}));var gh;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(gh||(gh={}));class f3{constructor(t,n={config:{}},r){this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=Za.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new zO(this,xc.join,this.params,this.timeout),this.rejoinTimer=new EH(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Za.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Za.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Za.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Za.errored,this.rejoinTimer.scheduleTimeout())}),this._on(xc.reply,{},(a,c)=>{this._trigger(this._replyEventName(c),a)}),this.presence=new O1(this),this.broadcastEndpointURL=PH(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Za.closed){const{config:{broadcast:c,presence:f,private:i}}=this.params;this._onError(T=>t==null?void 0:t(gh.CHANNEL_ERROR,T)),this._onClose(()=>t==null?void 0:t(gh.CLOSED));const v={},b={broadcast:c,presence:f,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(T=>T.filter))!==null&&a!==void 0?a:[],private:i};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:b},v)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:T})=>{var A;if(this.socket.setAuth(),T===void 0){t==null||t(gh.SUBSCRIBED);return}else{const M=this.bindings.postgres_changes,R=(A=M==null?void 0:M.length)!==null&&A!==void 0?A:0,B=[];for(let L=0;L<R;L++){const j=M[L],{filter:{event:V,schema:$,table:H,filter:K}}=j,Y=T&&T[L];if(Y&&Y.event===V&&Y.schema===$&&Y.table===H&&Y.filter===K)B.push(Object.assign(Object.assign({},j),{id:Y.id}));else{this.unsubscribe(),this.state=Za.errored,t==null||t(gh.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=B,t&&t(gh.SUBSCRIBED);return}}).receive("error",T=>{this.state=Za.errored,t==null||t(gh.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(T).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(gh.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this._on(t,n,r)}async send(t,n={}){var r,a;if(!this._canPush()&&t.type==="broadcast"){const{event:c,payload:f}=t,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:f,private:this.private}]})};try{const b=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=b.body)===null||a===void 0?void 0:a.cancel()),b.ok?"ok":"error"}catch(b){return b.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var f,i,v;const b=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((v=(i=(f=this.params)===null||f===void 0?void 0:f.config)===null||i===void 0?void 0:i.broadcast)===null||v===void 0)&&v.ack)&&c("ok"),b.receive("ok",()=>c("ok")),b.receive("error",()=>c("error")),b.receive("timeout",()=>c("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Za.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(xc.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new zO(this,xc.leave,{},t),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,n,r){const a=new AbortController,c=setTimeout(()=>a.abort(),r),f=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(c),f}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new zO(this,t,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var a,c;const f=t.toLocaleLowerCase(),{close:i,error:v,leave:b,join:T}=xc;if(r&&[i,v,b,T].indexOf(f)>=0&&r!==this._joinRef())return;let M=this._onMessage(f,n,r);if(n&&!M)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(R=>{var B,L,j;return((B=R.filter)===null||B===void 0?void 0:B.event)==="*"||((j=(L=R.filter)===null||L===void 0?void 0:L.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===f}).map(R=>R.callback(M,r)):(c=this.bindings[f])===null||c===void 0||c.filter(R=>{var B,L,j,V,$,H;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in R){const K=R.id,Y=(B=R.filter)===null||B===void 0?void 0:B.event;return K&&((L=n.ids)===null||L===void 0?void 0:L.includes(K))&&(Y==="*"||(Y==null?void 0:Y.toLocaleLowerCase())===((j=n.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const K=($=(V=R==null?void 0:R.filter)===null||V===void 0?void 0:V.event)===null||$===void 0?void 0:$.toLocaleLowerCase();return K==="*"||K===((H=n==null?void 0:n.event)===null||H===void 0?void 0:H.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===f}).map(R=>{if(typeof M=="object"&&"ids"in M){const B=M.data,{schema:L,table:j,commit_timestamp:V,type:$,errors:H}=B;M=Object.assign(Object.assign({},{schema:L,table:j,commit_timestamp:V,eventType:$,new:{},old:{},errors:H}),this._getPayloadRecords(B))}R.callback(M,r)})}_isClosed(){return this.state===Za.closed}_isJoined(){return this.state===Za.joined}_isJoining(){return this.state===Za.joining}_isLeaving(){return this.state===Za.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const a=t.toLocaleLowerCase(),c={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(c):this.bindings[a]=[c],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var c;return!(((c=a.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===r&&f3.isEqual(a.filter,n))}),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(xc.close,{},t)}_onError(t){this._on(xc.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Za.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=tU(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=tU(t.columns,t.old_record)),n}}const oU=()=>{},Oue=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class kue{constructor(t,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=TH,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=oU,this.ref=0,this.logger=oU,this.conn=null,this.sendBuffer=[],this.serializer=new Tue,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=c=>{let f;return c?f=c:typeof fetch>"u"?f=(...i)=>gw(async()=>{const{default:v}=await Promise.resolve().then(()=>_v);return{default:v}},void 0).then(({default:v})=>v(...i)):f=fetch,(...i)=>f(...i)},this.endPoint=`${t}/${WR.websocket}`,this.httpEndpoint=PH(t),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:c=>[1e3,2e3,5e3,1e4][c-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(c,f)=>f(JSON.stringify(c)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new EH(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=vue),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wue}))}disconnect(t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case M1.connecting:return lm.Connecting;case M1.open:return lm.Open;case M1.closing:return lm.Closing;default:return lm.Closed}}isConnected(){return this.connectionState()===lm.Open}channel(t,n={config:{}}){const r=`realtime:${t}`,a=this.getChannels().find(c=>c.topic===r);if(a)return a;{const c=new f3(`realtime:${t}`,n,this);return this.channels.push(c),c}}push(t){const{topic:n,event:r,payload:a,ref:c}=t,f=()=>{this.encode(t,i=>{var v;(v=this.conn)===null||v===void 0||v.send(i)})};this.log("push",`${n} ${r} (${c})`,a),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(t=null){let n=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:bue};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(xc.access_token,{access_token:n})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(Sue,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,n=>{let{topic:r,event:a,payload:c,ref:f}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),f&&f===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${c.status||""} ${r} ${a} ${f&&"("+f+")"||""}`,c),Array.from(this.channels).filter(i=>i._isMember(r)).forEach(i=>i._trigger(a,c,f)),this.stateChangeCallbacks.message.forEach(i=>i(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(xc.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${t}${r}${a}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([Oue],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class p3 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ya(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Rue extends p3{constructor(t,n){super(t),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class qR extends p3{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var Due=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function i(T){try{b(r.next(T))}catch(A){f(A)}}function v(T){try{b(r.throw(T))}catch(A){f(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,v)}b((r=r.apply(e,t||[])).next())})};const CH=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>gw(async()=>{const{default:r}=await Promise.resolve().then(()=>_v);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},Lue=()=>Due(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield gw(()=>Promise.resolve().then(()=>_v),void 0)).Response:Response}),ZR=e=>{if(Array.isArray(e))return e.map(n=>ZR(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));t[a]=ZR(r)}),t};var Zm=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function i(T){try{b(r.next(T))}catch(A){f(A)}}function v(T){try{b(r.throw(T))}catch(A){f(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,v)}b((r=r.apply(e,t||[])).next())})};const NO=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),zue=(e,t,n)=>Zm(void 0,void 0,void 0,function*(){const r=yield Lue();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(a=>{t(new Rue(NO(a),e.status||500))}).catch(a=>{t(new qR(NO(a),a))}):t(new qR(NO(e),e))}),Nue=(e,t,n,r)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function bw(e,t,n,r,a,c){return Zm(this,void 0,void 0,function*(){return new Promise((f,i)=>{e(n,Nue(t,r,a,c)).then(v=>{if(!v.ok)throw v;return r!=null&&r.noResolveJson?v:v.json()}).then(v=>f(v)).catch(v=>zue(v,i,r))})})}function O2(e,t,n,r){return Zm(this,void 0,void 0,function*(){return bw(e,"GET",t,n,r)})}function Kd(e,t,n,r,a){return Zm(this,void 0,void 0,function*(){return bw(e,"POST",t,r,a,n)})}function Fue(e,t,n,r,a){return Zm(this,void 0,void 0,function*(){return bw(e,"PUT",t,r,a,n)})}function Bue(e,t,n,r){return Zm(this,void 0,void 0,function*(){return bw(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function IH(e,t,n,r,a){return Zm(this,void 0,void 0,function*(){return bw(e,"DELETE",t,r,a,n)})}var Os=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function i(T){try{b(r.next(T))}catch(A){f(A)}}function v(T){try{b(r.throw(T))}catch(A){f(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,v)}b((r=r.apply(e,t||[])).next())})};const jue={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},aU={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class $ue{constructor(t,n={},r,a){this.url=t,this.headers=n,this.bucketId=r,this.fetch=CH(a)}uploadOrUpdate(t,n,r,a){return Os(this,void 0,void 0,function*(){try{let c;const f=Object.assign(Object.assign({},aU),a);let i=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(f.upsert)});const v=f.metadata;typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",f.cacheControl),v&&c.append("metadata",this.encodeMetadata(v)),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",f.cacheControl),v&&c.append("metadata",this.encodeMetadata(v))):(c=r,i["cache-control"]=`max-age=${f.cacheControl}`,i["content-type"]=f.contentType,v&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),a!=null&&a.headers&&(i=Object.assign(Object.assign({},i),a.headers));const b=this._removeEmptyFolders(n),T=this._getFinalPath(b),A=yield this.fetch(`${this.url}/object/${T}`,Object.assign({method:t,body:c,headers:i},f!=null&&f.duplex?{duplex:f.duplex}:{})),M=yield A.json();return A.ok?{data:{path:b,id:M.Id,fullPath:M.Key},error:null}:{data:null,error:M}}catch(c){if(ya(c))return{data:null,error:c};throw c}})}upload(t,n,r){return Os(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,a){return Os(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(t),f=this._getFinalPath(c),i=new URL(this.url+`/object/upload/sign/${f}`);i.searchParams.set("token",n);try{let v;const b=Object.assign({upsert:aU.upsert},a),T=Object.assign(Object.assign({},this.headers),{"x-upsert":String(b.upsert)});typeof Blob<"u"&&r instanceof Blob?(v=new FormData,v.append("cacheControl",b.cacheControl),v.append("",r)):typeof FormData<"u"&&r instanceof FormData?(v=r,v.append("cacheControl",b.cacheControl)):(v=r,T["cache-control"]=`max-age=${b.cacheControl}`,T["content-type"]=b.contentType);const A=yield this.fetch(i.toString(),{method:"PUT",body:v,headers:T}),M=yield A.json();return A.ok?{data:{path:c,fullPath:M.Key},error:null}:{data:null,error:M}}catch(v){if(ya(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(t,n){return Os(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const c=yield Kd(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),f=new URL(this.url+c.url),i=f.searchParams.get("token");if(!i)throw new p3("No token returned by API");return{data:{signedUrl:f.toString(),path:t,token:i},error:null}}catch(r){if(ya(r))return{data:null,error:r};throw r}})}update(t,n,r){return Os(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return Os(this,void 0,void 0,function*(){try{return{data:yield Kd(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(ya(a))return{data:null,error:a};throw a}})}copy(t,n,r){return Os(this,void 0,void 0,function*(){try{return{data:{path:(yield Kd(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(ya(a))return{data:null,error:a};throw a}})}createSignedUrl(t,n,r){return Os(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),c=yield Kd(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const f=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${f}`)},{data:c,error:null}}catch(a){if(ya(a))return{data:null,error:a};throw a}})}createSignedUrls(t,n,r){return Os(this,void 0,void 0,function*(){try{const a=yield Kd(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${c}`):null})),error:null}}catch(a){if(ya(a))return{data:null,error:a};throw a}})}download(t,n){return Os(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),f=c?`?${c}`:"";try{const i=this._getFinalPath(t);return{data:yield(yield O2(this.fetch,`${this.url}/${a}/${i}${f}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(i){if(ya(i))return{data:null,error:i};throw i}})}info(t){return Os(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield O2(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:ZR(r),error:null}}catch(r){if(ya(r))return{data:null,error:r};throw r}})}exists(t){return Os(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield Bue(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(ya(r)&&r instanceof qR){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),a=[],c=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";c!==""&&a.push(c);const i=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",v=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});v!==""&&a.push(v);let b=a.join("&");return b!==""&&(b=`?${b}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${b}`)}}}remove(t){return Os(this,void 0,void 0,function*(){try{return{data:yield IH(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(ya(n))return{data:null,error:n};throw n}})}list(t,n,r){return Os(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},jue),n),{prefix:t||""});return{data:yield Kd(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(ya(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const Uue="2.7.1",Vue={"X-Client-Info":`storage-js/${Uue}`};var by=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function i(T){try{b(r.next(T))}catch(A){f(A)}}function v(T){try{b(r.throw(T))}catch(A){f(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,v)}b((r=r.apply(e,t||[])).next())})};class Gue{constructor(t,n={},r){this.url=t,this.headers=Object.assign(Object.assign({},Vue),n),this.fetch=CH(r)}listBuckets(){return by(this,void 0,void 0,function*(){try{return{data:yield O2(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ya(t))return{data:null,error:t};throw t}})}getBucket(t){return by(this,void 0,void 0,function*(){try{return{data:yield O2(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(ya(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return by(this,void 0,void 0,function*(){try{return{data:yield Kd(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ya(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return by(this,void 0,void 0,function*(){try{return{data:yield Fue(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ya(r))return{data:null,error:r};throw r}})}emptyBucket(t){return by(this,void 0,void 0,function*(){try{return{data:yield Kd(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(ya(n))return{data:null,error:n};throw n}})}deleteBucket(t){return by(this,void 0,void 0,function*(){try{return{data:yield IH(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(ya(n))return{data:null,error:n};throw n}})}}class Wue extends Gue{constructor(t,n={},r){super(t,n,r)}from(t){return new $ue(this.url,this.headers,t,this.fetch)}}const Hue="2.52.0";let h1="";typeof Deno<"u"?h1="deno":typeof document<"u"?h1="web":typeof navigator<"u"&&navigator.product==="ReactNative"?h1="react-native":h1="node";const que={"X-Client-Info":`supabase-js-${h1}/${Hue}`},Zue={headers:que},Xue={schema:"public"},Kue={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Yue={};var Jue=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function i(T){try{b(r.next(T))}catch(A){f(A)}}function v(T){try{b(r.throw(T))}catch(A){f(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,v)}b((r=r.apply(e,t||[])).next())})};const Que=e=>{let t;return e?t=e:typeof fetch>"u"?t=fH:t=fetch,(...n)=>t(...n)},ehe=()=>typeof Headers>"u"?pH:Headers,the=(e,t,n)=>{const r=Que(n),a=ehe();return(c,f)=>Jue(void 0,void 0,void 0,function*(){var i;const v=(i=yield t())!==null&&i!==void 0?i:e;let b=new a(f==null?void 0:f.headers);return b.has("apikey")||b.set("apikey",e),b.has("Authorization")||b.set("Authorization",`Bearer ${v}`),r(c,Object.assign(Object.assign({},f),{headers:b}))})};var nhe=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function i(T){try{b(r.next(T))}catch(A){f(A)}}function v(T){try{b(r.throw(T))}catch(A){f(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,v)}b((r=r.apply(e,t||[])).next())})};function rhe(e){return e.endsWith("/")?e:e+"/"}function ihe(e,t){var n,r;const{db:a,auth:c,realtime:f,global:i}=e,{db:v,auth:b,realtime:T,global:A}=t,M={db:Object.assign(Object.assign({},v),a),auth:Object.assign(Object.assign({},b),c),realtime:Object.assign(Object.assign({},T),f),global:Object.assign(Object.assign(Object.assign({},A),i),{headers:Object.assign(Object.assign({},(n=A==null?void 0:A.headers)!==null&&n!==void 0?n:{}),(r=i==null?void 0:i.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>nhe(this,void 0,void 0,function*(){return""})};return e.accessToken?M.accessToken=e.accessToken:delete M.accessToken,M}const MH="2.71.1",Ny=30*1e3,XR=3,FO=XR*Ny,ohe="http://localhost:9999",ahe="supabase.auth.token",she={"X-Client-Info":`gotrue-js/${MH}`},KR="X-Supabase-Api-Version",OH={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},lhe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,che=10*60*1e3;class m3 extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Gr(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class uhe extends m3{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function hhe(e){return Gr(e)&&e.name==="AuthApiError"}class kH extends m3{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Uf extends m3{constructor(t,n,r,a){super(t,r,a),this.name=n,this.status=r}}class Gd extends Uf{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function dhe(e){return Gr(e)&&e.name==="AuthSessionMissingError"}class lE extends Uf{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cE extends Uf{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class uE extends Uf{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fhe(e){return Gr(e)&&e.name==="AuthImplicitGrantRedirectError"}class sU extends Uf{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class YR extends Uf{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function BO(e){return Gr(e)&&e.name==="AuthRetryableFetchError"}class lU extends Uf{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class JR extends Uf{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const k2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),cU=` 	
\r=`.split(""),phe=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<cU.length;t+=1)e[cU[t].charCodeAt(0)]=-2;for(let t=0;t<k2.length;t+=1)e[k2[t].charCodeAt(0)]=t;return e})();function uU(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(k2[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(k2[r]),t.queuedBits-=6}}function RH(e,t,n){const r=phe[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function hU(e){const t=[],n=f=>{t.push(String.fromCodePoint(f))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},c=f=>{yhe(f,r,n)};for(let f=0;f<e.length;f+=1)RH(e.charCodeAt(f),a,c);return t.join("")}function mhe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function ghe(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}mhe(r,t)}}function yhe(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function _he(e){const t=[],n={queue:0,queuedBits:0},r=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)RH(e.charCodeAt(a),n,r);return new Uint8Array(t)}function vhe(e){const t=[];return ghe(e,n=>t.push(n)),new Uint8Array(t)}function xhe(e){const t=[],n={queue:0,queuedBits:0},r=a=>{t.push(a)};return e.forEach(a=>uU(a,n,r)),uU(null,n,r),t.join("")}function bhe(e){return Math.round(Date.now()/1e3)+e}function whe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const gc=()=>typeof window<"u"&&typeof document<"u",Kp={tested:!1,writable:!1},DH=()=>{if(!gc())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Kp.tested)return Kp.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Kp.tested=!0,Kp.writable=!0}catch{Kp.tested=!0,Kp.writable=!1}return Kp.writable};function She(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,c)=>{t[c]=a})}catch{}return n.searchParams.forEach((r,a)=>{t[a]=r}),t}const LH=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>gw(async()=>{const{default:r}=await Promise.resolve().then(()=>_v);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},The=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Fy=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Yp=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ud=async(e,t)=>{await e.removeItem(t)};class LP{constructor(){this.promise=new LP.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}LP.promiseConstructor=Promise;function jO(e){const t=e.split(".");if(t.length!==3)throw new JR("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!lhe.test(t[r]))throw new JR("JWT not in base64url format");return{header:JSON.parse(hU(t[0])),payload:JSON.parse(hU(t[1])),signature:_he(t[2]),raw:{header:t[0],payload:t[1]}}}async function Ehe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Ahe(e,t){return new Promise((r,a)=>{(async()=>{for(let c=0;c<1/0;c++)try{const f=await e(c);if(!t(c,null,f)){r(f);return}}catch(f){if(!t(c,f)){a(f);return}}})()})}function Phe(e){return("0"+e.toString(16)).substr(-2)}function Che(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let c=0;c<56;c++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(t),Array.from(t,Phe).join("")}async function Ihe(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(c=>String.fromCharCode(c)).join("")}async function Mhe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await Ihe(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function wy(e,t,n=!1){const r=Che();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await Fy(e,`${t}-code-verifier`,a);const c=await Mhe(r);return[c,r===c?"plain":"s256"]}const Ohe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function khe(e){const t=e.headers.get(KR);if(!t||!t.match(Ohe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Rhe(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Dhe(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Lhe=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Sy(e){if(!Lhe.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $O(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function dU(e){return JSON.parse(JSON.stringify(e))}var zhe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};const rm=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Nhe=[502,503,504];async function fU(e){var t;if(!The(e))throw new YR(rm(e),0);if(Nhe.includes(e.status))throw new YR(rm(e),e.status);let n;try{n=await e.json()}catch(c){throw new kH(rm(c),c)}let r;const a=khe(e);if(a&&a.getTime()>=OH["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new lU(rm(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new Gd}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((c,f)=>c&&typeof f=="string",!0))throw new lU(rm(n),e.status,n.weak_password.reasons);throw new uhe(rm(n),e.status||500,r)}const Fhe=(e,t,n,r)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function xi(e,t,n,r){var a;const c=Object.assign({},r==null?void 0:r.headers);c[KR]||(c[KR]=OH["2024-01-01"].name),r!=null&&r.jwt&&(c.Authorization=`Bearer ${r.jwt}`);const f=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(f.redirect_to=r.redirectTo);const i=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",v=await Bhe(e,t,n+i,{headers:c,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(v):{data:Object.assign({},v),error:null}}async function Bhe(e,t,n,r,a,c){const f=Fhe(t,r,a,c);let i;try{i=await e(n,Object.assign({},f))}catch(v){throw console.error(v),new YR(rm(v),0)}if(i.ok||await fU(i),r!=null&&r.noResolveJson)return i;try{return await i.json()}catch(v){await fU(v)}}function fh(e){var t;let n=null;Vhe(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=bhe(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function pU(e){const t=fh(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ef(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function jhe(e){return{data:e,error:null}}function $he(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:c}=e,f=zhe(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),i={action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:c},v=Object.assign({},f);return{data:{properties:i,user:v},error:null}}function Uhe(e){return e}function Vhe(e){return e.access_token&&e.refresh_token&&e.expires_in}const UO=["global","local","others"];var Ghe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};class Whe{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=LH(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n=UO[0]){if(UO.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${UO.join(", ")}`);try{return await xi(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await xi(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ef})}catch(r){if(Gr(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=Ghe(t,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await xi(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:$he,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Gr(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await xi(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ef})}catch(n){if(Gr(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,a,c,f,i,v;try{const b={nextPage:null,lastPage:0,total:0},T=await xi(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(c=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&c!==void 0?c:""},xform:Uhe});if(T.error)throw T.error;const A=await T.json(),M=(f=T.headers.get("x-total-count"))!==null&&f!==void 0?f:0,R=(v=(i=T.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&v!==void 0?v:[];return R.length>0&&(R.forEach(B=>{const L=parseInt(B.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(B.split(";")[1].split("=")[1]);b[`${j}Page`]=L}),b.total=parseInt(M)),{data:Object.assign(Object.assign({},A),b),error:null}}catch(b){if(Gr(b))return{data:{users:[]},error:b};throw b}}async getUserById(t){Sy(t);try{return await xi(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ef})}catch(n){if(Gr(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Sy(t);try{return await xi(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:ef})}catch(r){if(Gr(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){Sy(t);try{return await xi(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:ef})}catch(r){if(Gr(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){Sy(t.userId);try{const{data:n,error:r}=await xi(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(Gr(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Sy(t.userId),Sy(t.id);try{return{data:await xi(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}}}function mU(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function Hhe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ty={debug:!!(globalThis&&DH()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class zH extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class qhe extends zH{}async function Zhe(e,t,n){Ty.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Ty.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Ty.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await n()}finally{Ty.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Ty.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new qhe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ty.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Hhe();const Xhe={url:ohe,storageKey:ahe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:she,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function gU(e,t,n){return await n()}const Ey={};class hb{constructor(t){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=hb.nextInstanceID,hb.nextInstanceID+=1,this.instanceID>0&&gc()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Xhe),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Whe({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=LH(a.fetch),this.lock=a.lock||gU,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:gc()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Zhe:this.lock=gU,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:DH()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=mU(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=mU(this.memoryStorage)),gc()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}get jwks(){var t,n;return(n=(t=Ey[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Ey[this.storageKey]=Object.assign(Object.assign({},Ey[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Ey[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ey[this.storageKey]=Object.assign(Object.assign({},Ey[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${MH}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=She(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),gc()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:c}=await this._getSessionFromURL(n,r);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),fhe(c)){const v=(t=c.details)===null||t===void 0?void 0:t.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:f,redirectType:i}=a;return this._debug("#_initialize()","detected session in URL",f,"redirect type",i),await this._saveSession(f),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Gr(n)?{error:n}:{error:new kH("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,a;try{const c=await xi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:fh}),{data:f,error:i}=c;if(i||!f)return{data:{user:null,session:null},error:i};const v=f.session,b=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:b,session:v},error:null}}catch(c){if(Gr(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(t){var n,r,a;try{let c;if("email"in t){const{email:T,password:A,options:M}=t;let R=null,B=null;this.flowType==="pkce"&&([R,B]=await wy(this.storage,this.storageKey)),c=await xi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:M==null?void 0:M.emailRedirectTo,body:{email:T,password:A,data:(n=M==null?void 0:M.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:M==null?void 0:M.captchaToken},code_challenge:R,code_challenge_method:B},xform:fh})}else if("phone"in t){const{phone:T,password:A,options:M}=t;c=await xi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:T,password:A,data:(r=M==null?void 0:M.data)!==null&&r!==void 0?r:{},channel:(a=M==null?void 0:M.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:M==null?void 0:M.captchaToken}},xform:fh})}else throw new cE("You must provide either an email or phone number and a password");const{data:f,error:i}=c;if(i||!f)return{data:{user:null,session:null},error:i};const v=f.session,b=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:b,session:v},error:null}}catch(c){if(Gr(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(t){try{let n;if("email"in t){const{email:c,password:f,options:i}=t;n=await xi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:f,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:pU})}else if("phone"in t){const{phone:c,password:f,options:i}=t;n=await xi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:f,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:pU})}else throw new cE("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new lE}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(Gr(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,r,a,c;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(c=t.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;if(n==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(t){var n,r,a,c,f,i,v,b,T,A,M,R;let B,L;if("message"in t)B=t.message,L=t.signature;else{const{chain:j,wallet:V,statement:$,options:H}=t;let K;if(gc())if(typeof V=="object")K=V;else{const se=window;if("solana"in se&&typeof se.solana=="object"&&("signIn"in se.solana&&typeof se.solana.signIn=="function"||"signMessage"in se.solana&&typeof se.solana.signMessage=="function"))K=se.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof V!="object"||!(H!=null&&H.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");K=V}const Y=new URL((n=H==null?void 0:H.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in K&&K.signIn){const se=await K.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},H==null?void 0:H.signInWithSolana),{version:"1",domain:Y.host,uri:Y.href}),$?{statement:$}:null));let ce;if(Array.isArray(se)&&se[0]&&typeof se[0]=="object")ce=se[0];else if(se&&typeof se=="object"&&"signedMessage"in se&&"signature"in se)ce=se;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ce&&"signature"in ce&&(typeof ce.signedMessage=="string"||ce.signedMessage instanceof Uint8Array)&&ce.signature instanceof Uint8Array)B=typeof ce.signedMessage=="string"?ce.signedMessage:new TextDecoder().decode(ce.signedMessage),L=ce.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in K)||typeof K.signMessage!="function"||!("publicKey"in K)||typeof K!="object"||!K.publicKey||!("toBase58"in K.publicKey)||typeof K.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");B=[`${Y.host} wants you to sign in with your Solana account:`,K.publicKey.toBase58(),...$?["",$,""]:[""],"Version: 1",`URI: ${Y.href}`,`Issued At: ${(a=(r=H==null?void 0:H.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((c=H==null?void 0:H.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${H.signInWithSolana.notBefore}`]:[],...!((f=H==null?void 0:H.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${H.signInWithSolana.expirationTime}`]:[],...!((i=H==null?void 0:H.signInWithSolana)===null||i===void 0)&&i.chainId?[`Chain ID: ${H.signInWithSolana.chainId}`]:[],...!((v=H==null?void 0:H.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${H.signInWithSolana.nonce}`]:[],...!((b=H==null?void 0:H.signInWithSolana)===null||b===void 0)&&b.requestId?[`Request ID: ${H.signInWithSolana.requestId}`]:[],...!((A=(T=H==null?void 0:H.signInWithSolana)===null||T===void 0?void 0:T.resources)===null||A===void 0)&&A.length?["Resources",...H.signInWithSolana.resources.map(ce=>`- ${ce}`)]:[]].join(`
`);const se=await K.signMessage(new TextEncoder().encode(B),"utf8");if(!se||!(se instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");L=se}}try{const{data:j,error:V}=await xi(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:B,signature:xhe(L)},!((M=t.options)===null||M===void 0)&&M.captchaToken?{gotrue_meta_security:{captcha_token:(R=t.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:fh});if(V)throw V;return!j||!j.session||!j.user?{data:{user:null,session:null},error:new lE}:(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),{data:Object.assign({},j),error:V})}catch(j){if(Gr(j))return{data:{user:null,session:null},error:j};throw j}}async _exchangeCodeForSession(t){const n=await Yp(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:c,error:f}=await xi(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:fh});if(await Ud(this.storage,`${this.storageKey}-code-verifier`),f)throw f;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new lE}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:a??null}),error:f})}catch(c){if(Gr(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(t){try{const{options:n,provider:r,token:a,access_token:c,nonce:f}=t,i=await xi(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:c,nonce:f,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:fh}),{data:v,error:b}=i;return b?{data:{user:null,session:null},error:b}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new lE}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:b})}catch(n){if(Gr(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,r,a,c,f;try{if("email"in t){const{email:i,options:v}=t;let b=null,T=null;this.flowType==="pkce"&&([b,T]=await wy(this.storage,this.storageKey));const{error:A}=await xi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},create_user:(r=v==null?void 0:v.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:b,code_challenge_method:T},redirectTo:v==null?void 0:v.emailRedirectTo});return{data:{user:null,session:null},error:A}}if("phone"in t){const{phone:i,options:v}=t,{data:b,error:T}=await xi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:i,data:(a=v==null?void 0:v.data)!==null&&a!==void 0?a:{},create_user:(c=v==null?void 0:v.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},channel:(f=v==null?void 0:v.channel)!==null&&f!==void 0?f:"sms"}});return{data:{user:null,session:null,messageId:b==null?void 0:b.message_id},error:T}}throw new cE("You must provide either an email or phone number.")}catch(i){if(Gr(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(t){var n,r;try{let a,c;"options"in t&&(a=(n=t.options)===null||n===void 0?void 0:n.redirectTo,c=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:f,error:i}=await xi(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:c}}),redirectTo:a,xform:fh});if(i)throw i;if(!f)throw new Error("An error occurred on token verification.");const v=f.session,b=f.user;return v!=null&&v.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:b,session:v},error:null}}catch(a){if(Gr(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var n,r,a;try{let c=null,f=null;return this.flowType==="pkce"&&([c,f]=await wy(this.storage,this.storageKey)),await xi(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:f}),headers:this.headers,xform:jhe})}catch(c){if(Gr(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new Gd;const{error:a}=await xi(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Gr(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:a,options:c}=t,{error:f}=await xi(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}else if("phone"in t){const{phone:r,type:a,options:c}=t,{data:f,error:i}=await xi(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:i}}throw new cE("You must provide either an email or phone number and a type")}catch(n){if(Gr(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await Yp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<FO:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const f=await Yp(this.userStorage,this.storageKey+"-user");f!=null&&f.user?t.user=f.user:t.user=$O()}if(this.storage.isServer&&t.user){let f=this.suppressGetSessionWarning;t=new Proxy(t,{get:(v,b,T)=>(!f&&b==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),f=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,b,T))})}return{data:{session:t},error:null}}const{session:a,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{session:null},error:c}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await xi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ef}):await this._useSession(async n=>{var r,a,c;const{data:f,error:i}=n;if(i)throw i;return!(!((r=f.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Gd}:await xi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(a=f.session)===null||a===void 0?void 0:a.access_token)!==null&&c!==void 0?c:void 0,xform:ef})})}catch(n){if(Gr(n))return dhe(n)&&(await this._removeSession(),await Ud(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:a,error:c}=r;if(c)throw c;if(!a.session)throw new Gd;const f=a.session;let i=null,v=null;this.flowType==="pkce"&&t.email!=null&&([i,v]=await wy(this.storage,this.storageKey));const{data:b,error:T}=await xi(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:i,code_challenge_method:v}),jwt:f.access_token,xform:ef});if(T)throw T;return f.user=b.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(r){if(Gr(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Gd;const n=Date.now()/1e3;let r=n,a=!0,c=null;const{payload:f}=jO(t.access_token);if(f.exp&&(r=f.exp,a=r<=n),a){const{session:i,error:v}=await this._callRefreshToken(t.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!i)return{data:{user:null,session:null},error:null};c=i}else{const{data:i,error:v}=await this._getUser(t.access_token);if(v)throw v;c={access_token:t.access_token,refresh_token:t.refresh_token,user:i.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(n){if(Gr(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:f,error:i}=n;if(i)throw i;t=(r=f.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new Gd;const{session:a,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{user:null,session:null},error:c}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Gr(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!gc())throw new uE("No browser detected.");if(t.error||t.error_description||t.error_code)throw new uE(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new sU("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new uE("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new sU("No code detected.");const{data:$,error:H}=await this._exchangeCodeForSession(t.code);if(H)throw H;const K=new URL(window.location.href);return K.searchParams.delete("code"),window.history.replaceState(window.history.state,"",K.toString()),{data:{session:$.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:c,refresh_token:f,expires_in:i,expires_at:v,token_type:b}=t;if(!c||!i||!f||!b)throw new uE("No session defined in URL");const T=Math.round(Date.now()/1e3),A=parseInt(i);let M=T+A;v&&(M=parseInt(v));const R=M-T;R*1e3<=Ny&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${A}s`);const B=M-A;T-B>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",B,M,T):T-B<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",B,M,T);const{data:L,error:j}=await this._getUser(c);if(j)throw j;const V={provider_token:r,provider_refresh_token:a,access_token:c,expires_in:A,expires_at:M,refresh_token:f,token_type:b,user:L.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:V,redirectType:t.type},error:null}}catch(r){if(Gr(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await Yp(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:c}=n;if(c)return{error:c};const f=(r=a.session)===null||r===void 0?void 0:r.access_token;if(f){const{error:i}=await this.admin.signOut(f,t);if(i&&!(hhe(i)&&(i.status===404||i.status===401||i.status===403)))return{error:i}}return t!=="others"&&(await this._removeSession(),await Ud(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=whe(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,a;try{const{data:{session:c},error:f}=n;if(f)throw f;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",t,"session",c)}catch(c){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",c),console.error(c)}})}async resetPasswordForEmail(t,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await wy(this.storage,this.storageKey,!0));try{return await xi(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(c){if(Gr(c))return{data:null,error:c};throw c}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:r,error:a}=await this._useSession(async c=>{var f,i,v,b,T;const{data:A,error:M}=c;if(M)throw M;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(f=t.options)===null||f===void 0?void 0:f.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(v=t.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await xi(this.fetch,"GET",R,{headers:this.headers,jwt:(T=(b=A.session)===null||b===void 0?void 0:b.access_token)!==null&&T!==void 0?T:void 0})});if(a)throw a;return gc()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Gr(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,a;const{data:c,error:f}=n;if(f)throw f;return await xi(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(r=c.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Gr(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Ahe(async a=>(a>0&&await Ehe(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await xi(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:fh})),(a,c)=>{const f=200*Math.pow(2,a);return c&&BO(c)&&Date.now()+f-r<Ny})}catch(r){if(this._debug(n,"error",r),Gr(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),gc()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await Yp(this.storage,this.storageKey);if(a&&this.userStorage){let f=await Yp(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:a.user},await Fy(this.userStorage,this.storageKey+"-user",f)),a.user=(t=f==null?void 0:f.user)!==null&&t!==void 0?t:$O()}else if(a&&!a.user&&!a.user){const f=await Yp(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(a.user=f.user,await Ud(this.storage,this.storageKey+"-user"),await Fy(this.storage,this.storageKey,a)):a.user=$O()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const c=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<FO;if(this._debug(r,`session has${c?"":" not"} expired with margin of ${FO}s`),c){if(this.autoRefreshToken&&a.refresh_token){const{error:f}=await this._callRefreshToken(a.refresh_token);f&&(console.error(f),BO(f)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:i}=await this._getUser(a.access_token);!i&&(f!=null&&f.user)?(a.user=f.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(r,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new Gd;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new LP;const{data:c,error:f}=await this._refreshAccessToken(t);if(f)throw f;if(!c.session)throw new Gd;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const i={session:c.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(c){if(this._debug(a,"error",c),Gr(c)){const f={session:null,error:c};return BO(c)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(f),f}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(c),c}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,n,r=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const c=[],f=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(t,n)}catch(v){c.push(v)}});if(await Promise.all(f),c.length>0){for(let i=0;i<c.length;i+=1)console.error(c[i]);throw c[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Fy(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const c=dU(a);await Fy(this.storage,this.storageKey,c)}else{const a=dU(n);await Fy(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ud(this.storage,this.storageKey),await Ud(this.storage,this.storageKey+"-code-verifier"),await Ud(this.storage,this.storageKey+"-user"),this.userStorage&&await Ud(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&gc()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ny);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-t)/Ny);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ny}ms, refresh threshold is ${XR} ticks`),a<=XR&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof zH)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!gc()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[c,f]=await wy(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(f)}`});a.push(i.toString())}if(r!=null&&r.queryParams){const c=new URLSearchParams(r.queryParams);a.push(c.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:a,error:c}=n;return c?{data:null,error:c}:await xi(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Gr(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,a;const{data:c,error:f}=n;if(f)return{data:null,error:f};const i=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:v,error:b}=await xi(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:(r=c==null?void 0:c.session)===null||r===void 0?void 0:r.access_token});return b?{data:null,error:b}:(t.factorType==="totp"&&(!((a=v==null?void 0:v.totp)===null||a===void 0)&&a.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(n){if(Gr(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:c}=n;if(c)return{data:null,error:c};const{data:f,error:i}=await xi(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),{data:f,error:i})})}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:c}=n;return c?{data:null,error:c}:await xi(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(t==null?void 0:t.factors)||[],a=r.filter(f=>f.factor_type==="totp"&&f.status==="verified"),c=r.filter(f=>f.factor_type==="phone"&&f.status==="verified");return{data:{all:r,totp:a,phone:c},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,r;const{data:{session:a},error:c}=t;if(c)return{data:null,error:c};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=jO(a.access_token);let i=null;f.aal&&(i=f.aal);let v=i;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(A=>A.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(v="aal2");const T=f.amr||[];return{data:{currentLevel:i,nextLevel:v,currentAuthenticationMethods:T},error:null}}))}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(i=>i.kid===t);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(i=>i.kid===t),r&&this.jwks_cached_at+che>a)return r;const{data:c,error:f}=await xi(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=a,r=c.keys.find(i=>i.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:R,error:B}=await this.getSession();if(B||!R.session)return{data:null,error:B};r=R.session.access_token}const{header:a,payload:c,signature:f,raw:{header:i,payload:v}}=jO(r);n!=null&&n.allowExpired||Rhe(c.exp);const b=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!b){const{error:R}=await this.getUser(r);if(R)throw R;return{data:{claims:c,header:a,signature:f},error:null}}const T=Dhe(a.alg),A=await crypto.subtle.importKey("jwk",b,T,!0,["verify"]);if(!await crypto.subtle.verify(T,A,f,vhe(`${i}.${v}`)))throw new JR("Invalid JWT signature");return{data:{claims:c,header:a,signature:f},error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}}}hb.nextInstanceID=0;const Khe=hb;class Yhe extends Khe{constructor(t){super(t)}}var Jhe=function(e,t,n,r){function a(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function i(T){try{b(r.next(T))}catch(A){f(A)}}function v(T){try{b(r.throw(T))}catch(A){f(A)}}function b(T){T.done?c(T.value):a(T.value).then(i,v)}b((r=r.apply(e,t||[])).next())})};class Qhe{constructor(t,n,r){var a,c,f;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const i=rhe(t),v=new URL(i);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const b=`sb-${v.hostname.split(".")[0]}-auth-token`,T={db:Xue,realtime:Yue,auth:Object.assign(Object.assign({},Kue),{storageKey:b}),global:Zue},A=ihe(r??{},T);this.storageKey=(a=A.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(c=A.global.headers)!==null&&c!==void 0?c:{},A.accessToken?(this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(M,R)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(R)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=A.auth)!==null&&f!==void 0?f:{},this.headers,A.global.fetch),this.fetch=the(n,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.rest=new yue(new URL("rest/v1",v).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),A.accessToken||this._listenForAuthEvents()}get functions(){return new qce(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Wue(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return Jhe(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:c,flowType:f,lock:i,debug:v},b,T){const A={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Yhe({url:this.authUrl.href,headers:Object.assign(Object.assign({},A),b),storageKey:c,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:a,flowType:f,lock:i,debug:v,fetch:T,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new kue(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const rHe=(e,t,n)=>new Qhe(e,t,n);function ede(e,t){const n=X.createContext(t),r=c=>{const{children:f,...i}=c,v=X.useMemo(()=>i,Object.values(i));return he.jsx(n.Provider,{value:v,children:f})};r.displayName=e+"Provider";function a(c){const f=X.useContext(n);if(f)return f;if(t!==void 0)return t;throw new Error(`\`${c}\` must be used within \`${e}\``)}return[r,a]}function qs(e,t=[]){let n=[];function r(c,f){const i=X.createContext(f),v=n.length;n=[...n,f];const b=A=>{var V;const{scope:M,children:R,...B}=A,L=((V=M==null?void 0:M[e])==null?void 0:V[v])||i,j=X.useMemo(()=>B,Object.values(B));return he.jsx(L.Provider,{value:j,children:R})};b.displayName=c+"Provider";function T(A,M){var L;const R=((L=M==null?void 0:M[e])==null?void 0:L[v])||i,B=X.useContext(R);if(B)return B;if(f!==void 0)return f;throw new Error(`\`${A}\` must be used within \`${c}\``)}return[b,T]}const a=()=>{const c=n.map(f=>X.createContext(f));return function(i){const v=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:v}}),[i,v])}};return a.scopeName=e,[r,tde(a,...t)]}function tde(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const f=r.reduce((i,{useScope:v,scopeName:b})=>{const A=v(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return n.scopeName=t.scopeName,n}function Zo(e){const t=X.useRef(e);return X.useEffect(()=>{t.current=e}),X.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}var $o=globalThis!=null&&globalThis.document?X.useLayoutEffect:()=>{},nde=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Qn=nde.reduce((e,t)=>{const n=X.forwardRef((r,a)=>{const{asChild:c,...f}=r,i=c?Pf:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),he.jsx(i,{...f,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function R2(e,t){e&&Wm.flushSync(()=>e.dispatchEvent(t))}var g3="Avatar",[rde,iHe]=qs(g3),[ide,NH]=rde(g3),FH=X.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,c]=X.useState("idle");return he.jsx(ide,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:c,children:he.jsx(Qn.span,{...r,ref:t})})});FH.displayName=g3;var BH="AvatarImage",jH=X.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...c}=e,f=NH(BH,n),i=ode(r,c.referrerPolicy),v=Zo(b=>{a(b),f.onImageLoadingStatusChange(b)});return $o(()=>{i!=="idle"&&v(i)},[i,v]),i==="loaded"?he.jsx(Qn.img,{...c,ref:t,src:r}):null});jH.displayName=BH;var $H="AvatarFallback",UH=X.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,c=NH($H,n),[f,i]=X.useState(r===void 0);return X.useEffect(()=>{if(r!==void 0){const v=window.setTimeout(()=>i(!0),r);return()=>window.clearTimeout(v)}},[r]),f&&c.imageLoadingStatus!=="loaded"?he.jsx(Qn.span,{...a,ref:t}):null});UH.displayName=$H;function ode(e,t){const[n,r]=X.useState("idle");return $o(()=>{if(!e){r("error");return}let a=!0;const c=new window.Image,f=i=>()=>{a&&r(i)};return r("loading"),c.onload=f("loaded"),c.onerror=f("error"),c.src=e,t&&(c.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var oHe=FH,aHe=jH,sHe=UH;function vn(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function ys({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,a]=ade({defaultProp:t,onChange:n}),c=e!==void 0,f=c?e:r,i=Zo(n),v=X.useCallback(b=>{if(c){const A=typeof b=="function"?b(e):b;A!==e&&i(A)}else a(b)},[c,e,a,i]);return[f,v]}function ade({defaultProp:e,onChange:t}){const n=X.useState(e),[r]=n,a=X.useRef(r),c=Zo(t);return X.useEffect(()=>{a.current!==r&&(c(r),a.current=r)},[r,a,c]),n}function sde(e,t=[]){let n=[];function r(c,f){const i=X.createContext(f),v=n.length;n=[...n,f];function b(A){const{scope:M,children:R,...B}=A,L=(M==null?void 0:M[e][v])||i,j=X.useMemo(()=>B,Object.values(B));return he.jsx(L.Provider,{value:j,children:R})}function T(A,M){const R=(M==null?void 0:M[e][v])||i,B=X.useContext(R);if(B)return B;if(f!==void 0)return f;throw new Error(`\`${A}\` must be used within \`${c}\``)}return b.displayName=c+"Provider",[b,T]}const a=()=>{const c=n.map(f=>X.createContext(f));return function(i){const v=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:v}}),[i,v])}};return a.scopeName=e,[r,lde(a,...t)]}function lde(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const f=r.reduce((i,{useScope:v,scopeName:b})=>{const A=v(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return n.scopeName=t.scopeName,n}function xv(e){const t=e+"CollectionProvider",[n,r]=sde(t),[a,c]=n(t,{collectionRef:{current:null},itemMap:new Map}),f=R=>{const{scope:B,children:L}=R,j=Se.useRef(null),V=Se.useRef(new Map).current;return he.jsx(a,{scope:B,itemMap:V,collectionRef:j,children:L})};f.displayName=t;const i=e+"CollectionSlot",v=Se.forwardRef((R,B)=>{const{scope:L,children:j}=R,V=c(i,L),$=qr(B,V.collectionRef);return he.jsx(Pf,{ref:$,children:j})});v.displayName=i;const b=e+"CollectionItemSlot",T="data-radix-collection-item",A=Se.forwardRef((R,B)=>{const{scope:L,children:j,...V}=R,$=Se.useRef(null),H=qr(B,$),K=c(b,L);return Se.useEffect(()=>(K.itemMap.set($,{ref:$,...V}),()=>void K.itemMap.delete($))),he.jsx(Pf,{[T]:"",ref:H,children:j})});A.displayName=b;function M(R){const B=c(e+"CollectionConsumer",R);return Se.useCallback(()=>{const j=B.collectionRef.current;if(!j)return[];const V=Array.from(j.querySelectorAll(`[${T}]`));return Array.from(B.itemMap.values()).sort((K,Y)=>V.indexOf(K.ref.current)-V.indexOf(Y.ref.current))},[B.collectionRef,B.itemMap])}return[{Provider:f,Slot:v,ItemSlot:A},M,r]}var cde=X.createContext(void 0);function bv(e){const t=X.useContext(cde);return e||t||"ltr"}function ude(e,t=globalThis==null?void 0:globalThis.document){const n=Zo(e);X.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var hde="DismissableLayer",QR="dismissableLayer.update",dde="dismissableLayer.pointerDownOutside",fde="dismissableLayer.focusOutside",yU,VH=X.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Xm=X.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:c,onInteractOutside:f,onDismiss:i,...v}=e,b=X.useContext(VH),[T,A]=X.useState(null),M=(T==null?void 0:T.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,R]=X.useState({}),B=qr(t,ce=>A(ce)),L=Array.from(b.layers),[j]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),V=L.indexOf(j),$=T?L.indexOf(T):-1,H=b.layersWithOutsidePointerEventsDisabled.size>0,K=$>=V,Y=gde(ce=>{const ye=ce.target,ze=[...b.branches].some(Le=>Le.contains(ye));!K||ze||(a==null||a(ce),f==null||f(ce),ce.defaultPrevented||i==null||i())},M),se=yde(ce=>{const ye=ce.target;[...b.branches].some(Le=>Le.contains(ye))||(c==null||c(ce),f==null||f(ce),ce.defaultPrevented||i==null||i())},M);return ude(ce=>{$===b.layers.size-1&&(r==null||r(ce),!ce.defaultPrevented&&i&&(ce.preventDefault(),i()))},M),X.useEffect(()=>{if(T)return n&&(b.layersWithOutsidePointerEventsDisabled.size===0&&(yU=M.body.style.pointerEvents,M.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(T)),b.layers.add(T),_U(),()=>{n&&b.layersWithOutsidePointerEventsDisabled.size===1&&(M.body.style.pointerEvents=yU)}},[T,M,n,b]),X.useEffect(()=>()=>{T&&(b.layers.delete(T),b.layersWithOutsidePointerEventsDisabled.delete(T),_U())},[T,b]),X.useEffect(()=>{const ce=()=>R({});return document.addEventListener(QR,ce),()=>document.removeEventListener(QR,ce)},[]),he.jsx(Qn.div,{...v,ref:B,style:{pointerEvents:H?K?"auto":"none":void 0,...e.style},onFocusCapture:vn(e.onFocusCapture,se.onFocusCapture),onBlurCapture:vn(e.onBlurCapture,se.onBlurCapture),onPointerDownCapture:vn(e.onPointerDownCapture,Y.onPointerDownCapture)})});Xm.displayName=hde;var pde="DismissableLayerBranch",mde=X.forwardRef((e,t)=>{const n=X.useContext(VH),r=X.useRef(null),a=qr(t,r);return X.useEffect(()=>{const c=r.current;if(c)return n.branches.add(c),()=>{n.branches.delete(c)}},[n.branches]),he.jsx(Qn.div,{...e,ref:a})});mde.displayName=pde;function gde(e,t=globalThis==null?void 0:globalThis.document){const n=Zo(e),r=X.useRef(!1),a=X.useRef(()=>{});return X.useEffect(()=>{const c=i=>{if(i.target&&!r.current){let v=function(){GH(dde,n,b,{discrete:!0})};const b={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=v,t.addEventListener("click",a.current,{once:!0})):v()}else t.removeEventListener("click",a.current);r.current=!1},f=window.setTimeout(()=>{t.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(f),t.removeEventListener("pointerdown",c),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function yde(e,t=globalThis==null?void 0:globalThis.document){const n=Zo(e),r=X.useRef(!1);return X.useEffect(()=>{const a=c=>{c.target&&!r.current&&GH(fde,n,{originalEvent:c},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function _U(){const e=new CustomEvent(QR);document.dispatchEvent(e)}function GH(e,t,n,{discrete:r}){const a=n.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?R2(a,c):a.dispatchEvent(c)}var VO=0;function zP(){X.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??vU()),document.body.insertAdjacentElement("beforeend",e[1]??vU()),VO++,()=>{VO===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),VO--}},[])}function vU(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var GO="focusScope.autoFocusOnMount",WO="focusScope.autoFocusOnUnmount",xU={bubbles:!1,cancelable:!0},_de="FocusScope",ww=X.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:c,...f}=e,[i,v]=X.useState(null),b=Zo(a),T=Zo(c),A=X.useRef(null),M=qr(t,L=>v(L)),R=X.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;X.useEffect(()=>{if(r){let L=function(H){if(R.paused||!i)return;const K=H.target;i.contains(K)?A.current=K:Wd(A.current,{select:!0})},j=function(H){if(R.paused||!i)return;const K=H.relatedTarget;K!==null&&(i.contains(K)||Wd(A.current,{select:!0}))},V=function(H){if(document.activeElement===document.body)for(const Y of H)Y.removedNodes.length>0&&Wd(i)};document.addEventListener("focusin",L),document.addEventListener("focusout",j);const $=new MutationObserver(V);return i&&$.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",L),document.removeEventListener("focusout",j),$.disconnect()}}},[r,i,R.paused]),X.useEffect(()=>{if(i){wU.add(R);const L=document.activeElement;if(!i.contains(L)){const V=new CustomEvent(GO,xU);i.addEventListener(GO,b),i.dispatchEvent(V),V.defaultPrevented||(vde(Tde(WH(i)),{select:!0}),document.activeElement===L&&Wd(i))}return()=>{i.removeEventListener(GO,b),setTimeout(()=>{const V=new CustomEvent(WO,xU);i.addEventListener(WO,T),i.dispatchEvent(V),V.defaultPrevented||Wd(L??document.body,{select:!0}),i.removeEventListener(WO,T),wU.remove(R)},0)}}},[i,b,T,R]);const B=X.useCallback(L=>{if(!n&&!r||R.paused)return;const j=L.key==="Tab"&&!L.altKey&&!L.ctrlKey&&!L.metaKey,V=document.activeElement;if(j&&V){const $=L.currentTarget,[H,K]=xde($);H&&K?!L.shiftKey&&V===K?(L.preventDefault(),n&&Wd(H,{select:!0})):L.shiftKey&&V===H&&(L.preventDefault(),n&&Wd(K,{select:!0})):V===$&&L.preventDefault()}},[n,r,R.paused]);return he.jsx(Qn.div,{tabIndex:-1,...f,ref:M,onKeyDown:B})});ww.displayName=_de;function vde(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Wd(r,{select:t}),document.activeElement!==n)return}function xde(e){const t=WH(e),n=bU(t,e),r=bU(t.reverse(),e);return[n,r]}function WH(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function bU(e,t){for(const n of e)if(!bde(n,{upTo:t}))return n}function bde(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function wde(e){return e instanceof HTMLInputElement&&"select"in e}function Wd(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&wde(e)&&t&&e.select()}}var wU=Sde();function Sde(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=SU(e,t),e.unshift(t)},remove(t){var n;e=SU(e,t),(n=e[0])==null||n.resume()}}}function SU(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Tde(e){return e.filter(t=>t.tagName!=="A")}var Ede=gz.useId||(()=>{}),Ade=0;function Qa(e){const[t,n]=X.useState(Ede());return $o(()=>{e||n(r=>r??String(Ade++))},[e]),e||(t?`radix-${t}`:"")}const Pde=["top","right","bottom","left"],Cf=Math.min,hl=Math.max,D2=Math.round,hE=Math.floor,If=e=>({x:e,y:e}),Cde={left:"right",right:"left",bottom:"top",top:"bottom"},Ide={start:"end",end:"start"};function eD(e,t,n){return hl(e,Cf(t,n))}function Dh(e,t){return typeof e=="function"?e(t):e}function Lh(e){return e.split("-")[0]}function wv(e){return e.split("-")[1]}function y3(e){return e==="x"?"y":"x"}function _3(e){return e==="y"?"height":"width"}function Mf(e){return["top","bottom"].includes(Lh(e))?"y":"x"}function v3(e){return y3(Mf(e))}function Mde(e,t,n){n===void 0&&(n=!1);const r=wv(e),a=v3(e),c=_3(a);let f=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[c]>t.floating[c]&&(f=L2(f)),[f,L2(f)]}function Ode(e){const t=L2(e);return[tD(e),t,tD(t)]}function tD(e){return e.replace(/start|end/g,t=>Ide[t])}function kde(e,t,n){const r=["left","right"],a=["right","left"],c=["top","bottom"],f=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?c:f;default:return[]}}function Rde(e,t,n,r){const a=wv(e);let c=kde(Lh(e),n==="start",r);return a&&(c=c.map(f=>f+"-"+a),t&&(c=c.concat(c.map(tD)))),c}function L2(e){return e.replace(/left|right|bottom|top/g,t=>Cde[t])}function Dde(e){return{top:0,right:0,bottom:0,left:0,...e}}function HH(e){return typeof e!="number"?Dde(e):{top:e,right:e,bottom:e,left:e}}function z2(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function TU(e,t,n){let{reference:r,floating:a}=e;const c=Mf(t),f=v3(t),i=_3(f),v=Lh(t),b=c==="y",T=r.x+r.width/2-a.width/2,A=r.y+r.height/2-a.height/2,M=r[i]/2-a[i]/2;let R;switch(v){case"top":R={x:T,y:r.y-a.height};break;case"bottom":R={x:T,y:r.y+r.height};break;case"right":R={x:r.x+r.width,y:A};break;case"left":R={x:r.x-a.width,y:A};break;default:R={x:r.x,y:r.y}}switch(wv(t)){case"start":R[f]-=M*(n&&b?-1:1);break;case"end":R[f]+=M*(n&&b?-1:1);break}return R}const Lde=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:c=[],platform:f}=n,i=c.filter(Boolean),v=await(f.isRTL==null?void 0:f.isRTL(t));let b=await f.getElementRects({reference:e,floating:t,strategy:a}),{x:T,y:A}=TU(b,r,v),M=r,R={},B=0;for(let L=0;L<i.length;L++){const{name:j,fn:V}=i[L],{x:$,y:H,data:K,reset:Y}=await V({x:T,y:A,initialPlacement:r,placement:M,strategy:a,middlewareData:R,rects:b,platform:f,elements:{reference:e,floating:t}});T=$??T,A=H??A,R={...R,[j]:{...R[j],...K}},Y&&B<=50&&(B++,typeof Y=="object"&&(Y.placement&&(M=Y.placement),Y.rects&&(b=Y.rects===!0?await f.getElementRects({reference:e,floating:t,strategy:a}):Y.rects),{x:T,y:A}=TU(b,M,v)),L=-1)}return{x:T,y:A,placement:M,strategy:a,middlewareData:R}};async function db(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:c,rects:f,elements:i,strategy:v}=e,{boundary:b="clippingAncestors",rootBoundary:T="viewport",elementContext:A="floating",altBoundary:M=!1,padding:R=0}=Dh(t,e),B=HH(R),j=i[M?A==="floating"?"reference":"floating":A],V=z2(await c.getClippingRect({element:(n=await(c.isElement==null?void 0:c.isElement(j)))==null||n?j:j.contextElement||await(c.getDocumentElement==null?void 0:c.getDocumentElement(i.floating)),boundary:b,rootBoundary:T,strategy:v})),$=A==="floating"?{x:r,y:a,width:f.floating.width,height:f.floating.height}:f.reference,H=await(c.getOffsetParent==null?void 0:c.getOffsetParent(i.floating)),K=await(c.isElement==null?void 0:c.isElement(H))?await(c.getScale==null?void 0:c.getScale(H))||{x:1,y:1}:{x:1,y:1},Y=z2(c.convertOffsetParentRelativeRectToViewportRelativeRect?await c.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:$,offsetParent:H,strategy:v}):$);return{top:(V.top-Y.top+B.top)/K.y,bottom:(Y.bottom-V.bottom+B.bottom)/K.y,left:(V.left-Y.left+B.left)/K.x,right:(Y.right-V.right+B.right)/K.x}}const zde=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:c,platform:f,elements:i,middlewareData:v}=t,{element:b,padding:T=0}=Dh(e,t)||{};if(b==null)return{};const A=HH(T),M={x:n,y:r},R=v3(a),B=_3(R),L=await f.getDimensions(b),j=R==="y",V=j?"top":"left",$=j?"bottom":"right",H=j?"clientHeight":"clientWidth",K=c.reference[B]+c.reference[R]-M[R]-c.floating[B],Y=M[R]-c.reference[R],se=await(f.getOffsetParent==null?void 0:f.getOffsetParent(b));let ce=se?se[H]:0;(!ce||!await(f.isElement==null?void 0:f.isElement(se)))&&(ce=i.floating[H]||c.floating[B]);const ye=K/2-Y/2,ze=ce/2-L[B]/2-1,Le=Cf(A[V],ze),je=Cf(A[$],ze),Re=Le,$e=ce-L[B]-je,Ge=ce/2-L[B]/2+ye,ht=eD(Re,Ge,$e),ot=!v.arrow&&wv(a)!=null&&Ge!==ht&&c.reference[B]/2-(Ge<Re?Le:je)-L[B]/2<0,Je=ot?Ge<Re?Ge-Re:Ge-$e:0;return{[R]:M[R]+Je,data:{[R]:ht,centerOffset:Ge-ht-Je,...ot&&{alignmentOffset:Je}},reset:ot}}}),Nde=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:c,rects:f,initialPlacement:i,platform:v,elements:b}=t,{mainAxis:T=!0,crossAxis:A=!0,fallbackPlacements:M,fallbackStrategy:R="bestFit",fallbackAxisSideDirection:B="none",flipAlignment:L=!0,...j}=Dh(e,t);if((n=c.arrow)!=null&&n.alignmentOffset)return{};const V=Lh(a),$=Mf(i),H=Lh(i)===i,K=await(v.isRTL==null?void 0:v.isRTL(b.floating)),Y=M||(H||!L?[L2(i)]:Ode(i)),se=B!=="none";!M&&se&&Y.push(...Rde(i,L,B,K));const ce=[i,...Y],ye=await db(t,j),ze=[];let Le=((r=c.flip)==null?void 0:r.overflows)||[];if(T&&ze.push(ye[V]),A){const Ge=Mde(a,f,K);ze.push(ye[Ge[0]],ye[Ge[1]])}if(Le=[...Le,{placement:a,overflows:ze}],!ze.every(Ge=>Ge<=0)){var je,Re;const Ge=(((je=c.flip)==null?void 0:je.index)||0)+1,ht=ce[Ge];if(ht)return{data:{index:Ge,overflows:Le},reset:{placement:ht}};let ot=(Re=Le.filter(Je=>Je.overflows[0]<=0).sort((Je,Ne)=>Je.overflows[1]-Ne.overflows[1])[0])==null?void 0:Re.placement;if(!ot)switch(R){case"bestFit":{var $e;const Je=($e=Le.filter(Ne=>{if(se){const Xe=Mf(Ne.placement);return Xe===$||Xe==="y"}return!0}).map(Ne=>[Ne.placement,Ne.overflows.filter(Xe=>Xe>0).reduce((Xe,pt)=>Xe+pt,0)]).sort((Ne,Xe)=>Ne[1]-Xe[1])[0])==null?void 0:$e[0];Je&&(ot=Je);break}case"initialPlacement":ot=i;break}if(a!==ot)return{reset:{placement:ot}}}return{}}}};function EU(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function AU(e){return Pde.some(t=>e[t]>=0)}const Fde=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=Dh(e,t);switch(r){case"referenceHidden":{const c=await db(t,{...a,elementContext:"reference"}),f=EU(c,n.reference);return{data:{referenceHiddenOffsets:f,referenceHidden:AU(f)}}}case"escaped":{const c=await db(t,{...a,altBoundary:!0}),f=EU(c,n.floating);return{data:{escapedOffsets:f,escaped:AU(f)}}}default:return{}}}}};async function Bde(e,t){const{placement:n,platform:r,elements:a}=e,c=await(r.isRTL==null?void 0:r.isRTL(a.floating)),f=Lh(n),i=wv(n),v=Mf(n)==="y",b=["left","top"].includes(f)?-1:1,T=c&&v?-1:1,A=Dh(t,e);let{mainAxis:M,crossAxis:R,alignmentAxis:B}=typeof A=="number"?{mainAxis:A,crossAxis:0,alignmentAxis:null}:{mainAxis:A.mainAxis||0,crossAxis:A.crossAxis||0,alignmentAxis:A.alignmentAxis};return i&&typeof B=="number"&&(R=i==="end"?B*-1:B),v?{x:R*T,y:M*b}:{x:M*b,y:R*T}}const jde=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:c,placement:f,middlewareData:i}=t,v=await Bde(t,e);return f===((n=i.offset)==null?void 0:n.placement)&&(r=i.arrow)!=null&&r.alignmentOffset?{}:{x:a+v.x,y:c+v.y,data:{...v,placement:f}}}}},$de=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:c=!0,crossAxis:f=!1,limiter:i={fn:j=>{let{x:V,y:$}=j;return{x:V,y:$}}},...v}=Dh(e,t),b={x:n,y:r},T=await db(t,v),A=Mf(Lh(a)),M=y3(A);let R=b[M],B=b[A];if(c){const j=M==="y"?"top":"left",V=M==="y"?"bottom":"right",$=R+T[j],H=R-T[V];R=eD($,R,H)}if(f){const j=A==="y"?"top":"left",V=A==="y"?"bottom":"right",$=B+T[j],H=B-T[V];B=eD($,B,H)}const L=i.fn({...t,[M]:R,[A]:B});return{...L,data:{x:L.x-n,y:L.y-r,enabled:{[M]:c,[A]:f}}}}}},Ude=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:c,middlewareData:f}=t,{offset:i=0,mainAxis:v=!0,crossAxis:b=!0}=Dh(e,t),T={x:n,y:r},A=Mf(a),M=y3(A);let R=T[M],B=T[A];const L=Dh(i,t),j=typeof L=="number"?{mainAxis:L,crossAxis:0}:{mainAxis:0,crossAxis:0,...L};if(v){const H=M==="y"?"height":"width",K=c.reference[M]-c.floating[H]+j.mainAxis,Y=c.reference[M]+c.reference[H]-j.mainAxis;R<K?R=K:R>Y&&(R=Y)}if(b){var V,$;const H=M==="y"?"width":"height",K=["top","left"].includes(Lh(a)),Y=c.reference[A]-c.floating[H]+(K&&((V=f.offset)==null?void 0:V[A])||0)+(K?0:j.crossAxis),se=c.reference[A]+c.reference[H]+(K?0:(($=f.offset)==null?void 0:$[A])||0)-(K?j.crossAxis:0);B<Y?B=Y:B>se&&(B=se)}return{[M]:R,[A]:B}}}},Vde=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:a,rects:c,platform:f,elements:i}=t,{apply:v=()=>{},...b}=Dh(e,t),T=await db(t,b),A=Lh(a),M=wv(a),R=Mf(a)==="y",{width:B,height:L}=c.floating;let j,V;A==="top"||A==="bottom"?(j=A,V=M===(await(f.isRTL==null?void 0:f.isRTL(i.floating))?"start":"end")?"left":"right"):(V=A,j=M==="end"?"top":"bottom");const $=L-T.top-T.bottom,H=B-T.left-T.right,K=Cf(L-T[j],$),Y=Cf(B-T[V],H),se=!t.middlewareData.shift;let ce=K,ye=Y;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(ye=H),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(ce=$),se&&!M){const Le=hl(T.left,0),je=hl(T.right,0),Re=hl(T.top,0),$e=hl(T.bottom,0);R?ye=B-2*(Le!==0||je!==0?Le+je:hl(T.left,T.right)):ce=L-2*(Re!==0||$e!==0?Re+$e:hl(T.top,T.bottom))}await v({...t,availableWidth:ye,availableHeight:ce});const ze=await f.getDimensions(i.floating);return B!==ze.width||L!==ze.height?{reset:{rects:!0}}:{}}}};function NP(){return typeof window<"u"}function Sv(e){return qH(e)?(e.nodeName||"").toLowerCase():"#document"}function ml(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Pu(e){var t;return(t=(qH(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function qH(e){return NP()?e instanceof Node||e instanceof ml(e).Node:!1}function Dc(e){return NP()?e instanceof Element||e instanceof ml(e).Element:!1}function wu(e){return NP()?e instanceof HTMLElement||e instanceof ml(e).HTMLElement:!1}function PU(e){return!NP()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ml(e).ShadowRoot}function Sw(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Lc(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function Gde(e){return["table","td","th"].includes(Sv(e))}function FP(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function x3(e){const t=b3(),n=Dc(e)?Lc(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Wde(e){let t=Of(e);for(;wu(t)&&!A_(t);){if(x3(t))return t;if(FP(t))return null;t=Of(t)}return null}function b3(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function A_(e){return["html","body","#document"].includes(Sv(e))}function Lc(e){return ml(e).getComputedStyle(e)}function BP(e){return Dc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Of(e){if(Sv(e)==="html")return e;const t=e.assignedSlot||e.parentNode||PU(e)&&e.host||Pu(e);return PU(t)?t.host:t}function ZH(e){const t=Of(e);return A_(t)?e.ownerDocument?e.ownerDocument.body:e.body:wu(t)&&Sw(t)?t:ZH(t)}function fb(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=ZH(e),c=a===((r=e.ownerDocument)==null?void 0:r.body),f=ml(a);if(c){const i=nD(f);return t.concat(f,f.visualViewport||[],Sw(a)?a:[],i&&n?fb(i):[])}return t.concat(a,fb(a,[],n))}function nD(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function XH(e){const t=Lc(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=wu(e),c=a?e.offsetWidth:n,f=a?e.offsetHeight:r,i=D2(n)!==c||D2(r)!==f;return i&&(n=c,r=f),{width:n,height:r,$:i}}function w3(e){return Dc(e)?e:e.contextElement}function u_(e){const t=w3(e);if(!wu(t))return If(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:c}=XH(t);let f=(c?D2(n.width):n.width)/r,i=(c?D2(n.height):n.height)/a;return(!f||!Number.isFinite(f))&&(f=1),(!i||!Number.isFinite(i))&&(i=1),{x:f,y:i}}const Hde=If(0);function KH(e){const t=ml(e);return!b3()||!t.visualViewport?Hde:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function qde(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ml(e)?!1:t}function Im(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),c=w3(e);let f=If(1);t&&(r?Dc(r)&&(f=u_(r)):f=u_(e));const i=qde(c,n,r)?KH(c):If(0);let v=(a.left+i.x)/f.x,b=(a.top+i.y)/f.y,T=a.width/f.x,A=a.height/f.y;if(c){const M=ml(c),R=r&&Dc(r)?ml(r):r;let B=M,L=nD(B);for(;L&&r&&R!==B;){const j=u_(L),V=L.getBoundingClientRect(),$=Lc(L),H=V.left+(L.clientLeft+parseFloat($.paddingLeft))*j.x,K=V.top+(L.clientTop+parseFloat($.paddingTop))*j.y;v*=j.x,b*=j.y,T*=j.x,A*=j.y,v+=H,b+=K,B=ml(L),L=nD(B)}}return z2({width:T,height:A,x:v,y:b})}function Zde(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const c=a==="fixed",f=Pu(r),i=t?FP(t.floating):!1;if(r===f||i&&c)return n;let v={scrollLeft:0,scrollTop:0},b=If(1);const T=If(0),A=wu(r);if((A||!A&&!c)&&((Sv(r)!=="body"||Sw(f))&&(v=BP(r)),wu(r))){const M=Im(r);b=u_(r),T.x=M.x+r.clientLeft,T.y=M.y+r.clientTop}return{width:n.width*b.x,height:n.height*b.y,x:n.x*b.x-v.scrollLeft*b.x+T.x,y:n.y*b.y-v.scrollTop*b.y+T.y}}function Xde(e){return Array.from(e.getClientRects())}function rD(e,t){const n=BP(e).scrollLeft;return t?t.left+n:Im(Pu(e)).left+n}function Kde(e){const t=Pu(e),n=BP(e),r=e.ownerDocument.body,a=hl(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),c=hl(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let f=-n.scrollLeft+rD(e);const i=-n.scrollTop;return Lc(r).direction==="rtl"&&(f+=hl(t.clientWidth,r.clientWidth)-a),{width:a,height:c,x:f,y:i}}function Yde(e,t){const n=ml(e),r=Pu(e),a=n.visualViewport;let c=r.clientWidth,f=r.clientHeight,i=0,v=0;if(a){c=a.width,f=a.height;const b=b3();(!b||b&&t==="fixed")&&(i=a.offsetLeft,v=a.offsetTop)}return{width:c,height:f,x:i,y:v}}function Jde(e,t){const n=Im(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,c=wu(e)?u_(e):If(1),f=e.clientWidth*c.x,i=e.clientHeight*c.y,v=a*c.x,b=r*c.y;return{width:f,height:i,x:v,y:b}}function CU(e,t,n){let r;if(t==="viewport")r=Yde(e,n);else if(t==="document")r=Kde(Pu(e));else if(Dc(t))r=Jde(t,n);else{const a=KH(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return z2(r)}function YH(e,t){const n=Of(e);return n===t||!Dc(n)||A_(n)?!1:Lc(n).position==="fixed"||YH(n,t)}function Qde(e,t){const n=t.get(e);if(n)return n;let r=fb(e,[],!1).filter(i=>Dc(i)&&Sv(i)!=="body"),a=null;const c=Lc(e).position==="fixed";let f=c?Of(e):e;for(;Dc(f)&&!A_(f);){const i=Lc(f),v=x3(f);!v&&i.position==="fixed"&&(a=null),(c?!v&&!a:!v&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Sw(f)&&!v&&YH(e,f))?r=r.filter(T=>T!==f):a=i,f=Of(f)}return t.set(e,r),r}function efe(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const f=[...n==="clippingAncestors"?FP(t)?[]:Qde(t,this._c):[].concat(n),r],i=f[0],v=f.reduce((b,T)=>{const A=CU(t,T,a);return b.top=hl(A.top,b.top),b.right=Cf(A.right,b.right),b.bottom=Cf(A.bottom,b.bottom),b.left=hl(A.left,b.left),b},CU(t,i,a));return{width:v.right-v.left,height:v.bottom-v.top,x:v.left,y:v.top}}function tfe(e){const{width:t,height:n}=XH(e);return{width:t,height:n}}function nfe(e,t,n){const r=wu(t),a=Pu(t),c=n==="fixed",f=Im(e,!0,c,t);let i={scrollLeft:0,scrollTop:0};const v=If(0);if(r||!r&&!c)if((Sv(t)!=="body"||Sw(a))&&(i=BP(t)),r){const R=Im(t,!0,c,t);v.x=R.x+t.clientLeft,v.y=R.y+t.clientTop}else a&&(v.x=rD(a));let b=0,T=0;if(a&&!r&&!c){const R=a.getBoundingClientRect();T=R.top+i.scrollTop,b=R.left+i.scrollLeft-rD(a,R)}const A=f.left+i.scrollLeft-v.x-b,M=f.top+i.scrollTop-v.y-T;return{x:A,y:M,width:f.width,height:f.height}}function HO(e){return Lc(e).position==="static"}function IU(e,t){if(!wu(e)||Lc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Pu(e)===n&&(n=n.ownerDocument.body),n}function JH(e,t){const n=ml(e);if(FP(e))return n;if(!wu(e)){let a=Of(e);for(;a&&!A_(a);){if(Dc(a)&&!HO(a))return a;a=Of(a)}return n}let r=IU(e,t);for(;r&&Gde(r)&&HO(r);)r=IU(r,t);return r&&A_(r)&&HO(r)&&!x3(r)?n:r||Wde(e)||n}const rfe=async function(e){const t=this.getOffsetParent||JH,n=this.getDimensions,r=await n(e.floating);return{reference:nfe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function ife(e){return Lc(e).direction==="rtl"}const ofe={convertOffsetParentRelativeRectToViewportRelativeRect:Zde,getDocumentElement:Pu,getClippingRect:efe,getOffsetParent:JH,getElementRects:rfe,getClientRects:Xde,getDimensions:tfe,getScale:u_,isElement:Dc,isRTL:ife};function afe(e,t){let n=null,r;const a=Pu(e);function c(){var i;clearTimeout(r),(i=n)==null||i.disconnect(),n=null}function f(i,v){i===void 0&&(i=!1),v===void 0&&(v=1),c();const{left:b,top:T,width:A,height:M}=e.getBoundingClientRect();if(i||t(),!A||!M)return;const R=hE(T),B=hE(a.clientWidth-(b+A)),L=hE(a.clientHeight-(T+M)),j=hE(b),$={rootMargin:-R+"px "+-B+"px "+-L+"px "+-j+"px",threshold:hl(0,Cf(1,v))||1};let H=!0;function K(Y){const se=Y[0].intersectionRatio;if(se!==v){if(!H)return f();se?f(!1,se):r=setTimeout(()=>{f(!1,1e-7)},1e3)}H=!1}try{n=new IntersectionObserver(K,{...$,root:a.ownerDocument})}catch{n=new IntersectionObserver(K,$)}n.observe(e)}return f(!0),c}function sfe(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:c=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:v=!1}=r,b=w3(e),T=a||c?[...b?fb(b):[],...fb(t)]:[];T.forEach(V=>{a&&V.addEventListener("scroll",n,{passive:!0}),c&&V.addEventListener("resize",n)});const A=b&&i?afe(b,n):null;let M=-1,R=null;f&&(R=new ResizeObserver(V=>{let[$]=V;$&&$.target===b&&R&&(R.unobserve(t),cancelAnimationFrame(M),M=requestAnimationFrame(()=>{var H;(H=R)==null||H.observe(t)})),n()}),b&&!v&&R.observe(b),R.observe(t));let B,L=v?Im(e):null;v&&j();function j(){const V=Im(e);L&&(V.x!==L.x||V.y!==L.y||V.width!==L.width||V.height!==L.height)&&n(),L=V,B=requestAnimationFrame(j)}return n(),()=>{var V;T.forEach($=>{a&&$.removeEventListener("scroll",n),c&&$.removeEventListener("resize",n)}),A==null||A(),(V=R)==null||V.disconnect(),R=null,v&&cancelAnimationFrame(B)}}const lfe=jde,cfe=$de,ufe=Nde,hfe=Vde,dfe=Fde,MU=zde,ffe=Ude,pfe=(e,t,n)=>{const r=new Map,a={platform:ofe,...n},c={...a.platform,_c:r};return Lde(e,t,{...a,platform:c})};var KE=typeof document<"u"?X.useLayoutEffect:X.useEffect;function N2(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!N2(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const c=a[r];if(!(c==="_owner"&&e.$$typeof)&&!N2(e[c],t[c]))return!1}return!0}return e!==e&&t!==t}function QH(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function OU(e,t){const n=QH(e);return Math.round(t*n)/n}function qO(e){const t=X.useRef(e);return KE(()=>{t.current=e}),t}function mfe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:c,floating:f}={},transform:i=!0,whileElementsMounted:v,open:b}=e,[T,A]=X.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[M,R]=X.useState(r);N2(M,r)||R(r);const[B,L]=X.useState(null),[j,V]=X.useState(null),$=X.useCallback(Ne=>{Ne!==se.current&&(se.current=Ne,L(Ne))},[]),H=X.useCallback(Ne=>{Ne!==ce.current&&(ce.current=Ne,V(Ne))},[]),K=c||B,Y=f||j,se=X.useRef(null),ce=X.useRef(null),ye=X.useRef(T),ze=v!=null,Le=qO(v),je=qO(a),Re=qO(b),$e=X.useCallback(()=>{if(!se.current||!ce.current)return;const Ne={placement:t,strategy:n,middleware:M};je.current&&(Ne.platform=je.current),pfe(se.current,ce.current,Ne).then(Xe=>{const pt={...Xe,isPositioned:Re.current!==!1};Ge.current&&!N2(ye.current,pt)&&(ye.current=pt,Wm.flushSync(()=>{A(pt)}))})},[M,t,n,je,Re]);KE(()=>{b===!1&&ye.current.isPositioned&&(ye.current.isPositioned=!1,A(Ne=>({...Ne,isPositioned:!1})))},[b]);const Ge=X.useRef(!1);KE(()=>(Ge.current=!0,()=>{Ge.current=!1}),[]),KE(()=>{if(K&&(se.current=K),Y&&(ce.current=Y),K&&Y){if(Le.current)return Le.current(K,Y,$e);$e()}},[K,Y,$e,Le,ze]);const ht=X.useMemo(()=>({reference:se,floating:ce,setReference:$,setFloating:H}),[$,H]),ot=X.useMemo(()=>({reference:K,floating:Y}),[K,Y]),Je=X.useMemo(()=>{const Ne={position:n,left:0,top:0};if(!ot.floating)return Ne;const Xe=OU(ot.floating,T.x),pt=OU(ot.floating,T.y);return i?{...Ne,transform:"translate("+Xe+"px, "+pt+"px)",...QH(ot.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:Xe,top:pt}},[n,i,ot.floating,T.x,T.y]);return X.useMemo(()=>({...T,update:$e,refs:ht,elements:ot,floatingStyles:Je}),[T,$e,ht,ot,Je])}const gfe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?MU({element:r.current,padding:a}).fn(n):{}:r?MU({element:r,padding:a}).fn(n):{}}}},yfe=(e,t)=>({...lfe(e),options:[e,t]}),_fe=(e,t)=>({...cfe(e),options:[e,t]}),vfe=(e,t)=>({...ffe(e),options:[e,t]}),xfe=(e,t)=>({...ufe(e),options:[e,t]}),bfe=(e,t)=>({...hfe(e),options:[e,t]}),wfe=(e,t)=>({...dfe(e),options:[e,t]}),Sfe=(e,t)=>({...gfe(e),options:[e,t]});var Tfe="Arrow",eq=X.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...c}=e;return he.jsx(Qn.svg,{...c,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:he.jsx("polygon",{points:"0,0 30,0 15,10"})})});eq.displayName=Tfe;var Efe=eq;function Afe(e,t=[]){let n=[];function r(c,f){const i=X.createContext(f),v=n.length;n=[...n,f];function b(A){const{scope:M,children:R,...B}=A,L=(M==null?void 0:M[e][v])||i,j=X.useMemo(()=>B,Object.values(B));return he.jsx(L.Provider,{value:j,children:R})}function T(A,M){const R=(M==null?void 0:M[e][v])||i,B=X.useContext(R);if(B)return B;if(f!==void 0)return f;throw new Error(`\`${A}\` must be used within \`${c}\``)}return b.displayName=c+"Provider",[b,T]}const a=()=>{const c=n.map(f=>X.createContext(f));return function(i){const v=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:v}}),[i,v])}};return a.scopeName=e,[r,Pfe(a,...t)]}function Pfe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const f=r.reduce((i,{useScope:v,scopeName:b})=>{const A=v(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return n.scopeName=t.scopeName,n}function S3(e){const[t,n]=X.useState(void 0);return $o(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const c=a[0];let f,i;if("borderBoxSize"in c){const v=c.borderBoxSize,b=Array.isArray(v)?v[0]:v;f=b.inlineSize,i=b.blockSize}else f=e.offsetWidth,i=e.offsetHeight;n({width:f,height:i})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var T3="Popper",[tq,Vf]=Afe(T3),[Cfe,nq]=tq(T3),rq=e=>{const{__scopePopper:t,children:n}=e,[r,a]=X.useState(null);return he.jsx(Cfe,{scope:t,anchor:r,onAnchorChange:a,children:n})};rq.displayName=T3;var iq="PopperAnchor",oq=X.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,c=nq(iq,n),f=X.useRef(null),i=qr(t,f);return X.useEffect(()=>{c.onAnchorChange((r==null?void 0:r.current)||f.current)}),r?null:he.jsx(Qn.div,{...a,ref:i})});oq.displayName=iq;var E3="PopperContent",[Ife,Mfe]=tq(E3),aq=X.forwardRef((e,t)=>{var Vt,lr,Nt,gn,xn,kt;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:c="center",alignOffset:f=0,arrowPadding:i=0,avoidCollisions:v=!0,collisionBoundary:b=[],collisionPadding:T=0,sticky:A="partial",hideWhenDetached:M=!1,updatePositionStrategy:R="optimized",onPlaced:B,...L}=e,j=nq(E3,n),[V,$]=X.useState(null),H=qr(t,zn=>$(zn)),[K,Y]=X.useState(null),se=S3(K),ce=(se==null?void 0:se.width)??0,ye=(se==null?void 0:se.height)??0,ze=r+(c!=="center"?"-"+c:""),Le=typeof T=="number"?T:{top:0,right:0,bottom:0,left:0,...T},je=Array.isArray(b)?b:[b],Re=je.length>0,$e={padding:Le,boundary:je.filter(kfe),altBoundary:Re},{refs:Ge,floatingStyles:ht,placement:ot,isPositioned:Je,middlewareData:Ne}=mfe({strategy:"fixed",placement:ze,whileElementsMounted:(...zn)=>sfe(...zn,{animationFrame:R==="always"}),elements:{reference:j.anchor},middleware:[yfe({mainAxis:a+ye,alignmentAxis:f}),v&&_fe({mainAxis:!0,crossAxis:!1,limiter:A==="partial"?vfe():void 0,...$e}),v&&xfe({...$e}),bfe({...$e,apply:({elements:zn,rects:fr,availableWidth:hi,availableHeight:br})=>{const{width:Pi,height:Ye}=fr.reference,wt=zn.floating.style;wt.setProperty("--radix-popper-available-width",`${hi}px`),wt.setProperty("--radix-popper-available-height",`${br}px`),wt.setProperty("--radix-popper-anchor-width",`${Pi}px`),wt.setProperty("--radix-popper-anchor-height",`${Ye}px`)}}),K&&Sfe({element:K,padding:i}),Rfe({arrowWidth:ce,arrowHeight:ye}),M&&wfe({strategy:"referenceHidden",...$e})]}),[Xe,pt]=cq(ot),zt=Zo(B);$o(()=>{Je&&(zt==null||zt())},[Je,zt]);const Ft=(Vt=Ne.arrow)==null?void 0:Vt.x,un=(lr=Ne.arrow)==null?void 0:lr.y,Tn=((Nt=Ne.arrow)==null?void 0:Nt.centerOffset)!==0,[fn,Cn]=X.useState();return $o(()=>{V&&Cn(window.getComputedStyle(V).zIndex)},[V]),he.jsx("div",{ref:Ge.setFloating,"data-radix-popper-content-wrapper":"",style:{...ht,transform:Je?ht.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:fn,"--radix-popper-transform-origin":[(gn=Ne.transformOrigin)==null?void 0:gn.x,(xn=Ne.transformOrigin)==null?void 0:xn.y].join(" "),...((kt=Ne.hide)==null?void 0:kt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:he.jsx(Ife,{scope:n,placedSide:Xe,onArrowChange:Y,arrowX:Ft,arrowY:un,shouldHideArrow:Tn,children:he.jsx(Qn.div,{"data-side":Xe,"data-align":pt,...L,ref:H,style:{...L.style,animation:Je?void 0:"none"}})})})});aq.displayName=E3;var sq="PopperArrow",Ofe={top:"bottom",right:"left",bottom:"top",left:"right"},lq=X.forwardRef(function(t,n){const{__scopePopper:r,...a}=t,c=Mfe(sq,r),f=Ofe[c.placedSide];return he.jsx("span",{ref:c.onArrowChange,style:{position:"absolute",left:c.arrowX,top:c.arrowY,[f]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[c.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[c.placedSide],visibility:c.shouldHideArrow?"hidden":void 0},children:he.jsx(Efe,{...a,ref:n,style:{...a.style,display:"block"}})})});lq.displayName=sq;function kfe(e){return e!==null}var Rfe=e=>({name:"transformOrigin",options:e,fn(t){var j,V,$;const{placement:n,rects:r,middlewareData:a}=t,f=((j=a.arrow)==null?void 0:j.centerOffset)!==0,i=f?0:e.arrowWidth,v=f?0:e.arrowHeight,[b,T]=cq(n),A={start:"0%",center:"50%",end:"100%"}[T],M=(((V=a.arrow)==null?void 0:V.x)??0)+i/2,R=((($=a.arrow)==null?void 0:$.y)??0)+v/2;let B="",L="";return b==="bottom"?(B=f?A:`${M}px`,L=`${-v}px`):b==="top"?(B=f?A:`${M}px`,L=`${r.floating.height+v}px`):b==="right"?(B=`${-v}px`,L=f?A:`${R}px`):b==="left"&&(B=`${r.floating.width+v}px`,L=f?A:`${R}px`),{data:{x:B,y:L}}}});function cq(e){const[t,n="center"]=e.split("-");return[t,n]}var jP=rq,Tw=oq,$P=aq,UP=lq,Dfe="Portal",Ew=X.forwardRef((e,t)=>{var i;const{container:n,...r}=e,[a,c]=X.useState(!1);$o(()=>c(!0),[]);const f=n||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return f?PP.createPortal(he.jsx(Qn.div,{...r,ref:t}),f):null});Ew.displayName=Dfe;function Lfe(e,t){return X.useReducer((n,r)=>t[n][r]??n,e)}var wa=e=>{const{present:t,children:n}=e,r=zfe(t),a=typeof n=="function"?n({present:r.isPresent}):X.Children.only(n),c=qr(r.ref,Nfe(a));return typeof n=="function"||r.isPresent?X.cloneElement(a,{ref:c}):null};wa.displayName="Presence";function zfe(e){const[t,n]=X.useState(),r=X.useRef({}),a=X.useRef(e),c=X.useRef("none"),f=e?"mounted":"unmounted",[i,v]=Lfe(f,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return X.useEffect(()=>{const b=dE(r.current);c.current=i==="mounted"?b:"none"},[i]),$o(()=>{const b=r.current,T=a.current;if(T!==e){const M=c.current,R=dE(b);e?v("MOUNT"):R==="none"||(b==null?void 0:b.display)==="none"?v("UNMOUNT"):v(T&&M!==R?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,v]),$o(()=>{if(t){let b;const T=t.ownerDocument.defaultView??window,A=R=>{const L=dE(r.current).includes(R.animationName);if(R.target===t&&L&&(v("ANIMATION_END"),!a.current)){const j=t.style.animationFillMode;t.style.animationFillMode="forwards",b=T.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=j)})}},M=R=>{R.target===t&&(c.current=dE(r.current))};return t.addEventListener("animationstart",M),t.addEventListener("animationcancel",A),t.addEventListener("animationend",A),()=>{T.clearTimeout(b),t.removeEventListener("animationstart",M),t.removeEventListener("animationcancel",A),t.removeEventListener("animationend",A)}}else v("ANIMATION_END")},[t,v]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:X.useCallback(b=>{b&&(r.current=getComputedStyle(b)),n(b)},[])}}function dE(e){return(e==null?void 0:e.animationName)||"none"}function Nfe(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Ffe(e,t=[]){let n=[];function r(c,f){const i=X.createContext(f),v=n.length;n=[...n,f];function b(A){const{scope:M,children:R,...B}=A,L=(M==null?void 0:M[e][v])||i,j=X.useMemo(()=>B,Object.values(B));return he.jsx(L.Provider,{value:j,children:R})}function T(A,M){const R=(M==null?void 0:M[e][v])||i,B=X.useContext(R);if(B)return B;if(f!==void 0)return f;throw new Error(`\`${A}\` must be used within \`${c}\``)}return b.displayName=c+"Provider",[b,T]}const a=()=>{const c=n.map(f=>X.createContext(f));return function(i){const v=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:v}}),[i,v])}};return a.scopeName=e,[r,Bfe(a,...t)]}function Bfe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const f=r.reduce((i,{useScope:v,scopeName:b})=>{const A=v(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return n.scopeName=t.scopeName,n}var ZO="rovingFocusGroup.onEntryFocus",jfe={bubbles:!1,cancelable:!0},VP="RovingFocusGroup",[iD,uq,$fe]=xv(VP),[Ufe,GP]=Ffe(VP,[$fe]),[Vfe,Gfe]=Ufe(VP),hq=X.forwardRef((e,t)=>he.jsx(iD.Provider,{scope:e.__scopeRovingFocusGroup,children:he.jsx(iD.Slot,{scope:e.__scopeRovingFocusGroup,children:he.jsx(Wfe,{...e,ref:t})})}));hq.displayName=VP;var Wfe=X.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:c,currentTabStopId:f,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:v,onEntryFocus:b,preventScrollOnEntryFocus:T=!1,...A}=e,M=X.useRef(null),R=qr(t,M),B=bv(c),[L=null,j]=ys({prop:f,defaultProp:i,onChange:v}),[V,$]=X.useState(!1),H=Zo(b),K=uq(n),Y=X.useRef(!1),[se,ce]=X.useState(0);return X.useEffect(()=>{const ye=M.current;if(ye)return ye.addEventListener(ZO,H),()=>ye.removeEventListener(ZO,H)},[H]),he.jsx(Vfe,{scope:n,orientation:r,dir:B,loop:a,currentTabStopId:L,onItemFocus:X.useCallback(ye=>j(ye),[j]),onItemShiftTab:X.useCallback(()=>$(!0),[]),onFocusableItemAdd:X.useCallback(()=>ce(ye=>ye+1),[]),onFocusableItemRemove:X.useCallback(()=>ce(ye=>ye-1),[]),children:he.jsx(Qn.div,{tabIndex:V||se===0?-1:0,"data-orientation":r,...A,ref:R,style:{outline:"none",...e.style},onMouseDown:vn(e.onMouseDown,()=>{Y.current=!0}),onFocus:vn(e.onFocus,ye=>{const ze=!Y.current;if(ye.target===ye.currentTarget&&ze&&!V){const Le=new CustomEvent(ZO,jfe);if(ye.currentTarget.dispatchEvent(Le),!Le.defaultPrevented){const je=K().filter(ot=>ot.focusable),Re=je.find(ot=>ot.active),$e=je.find(ot=>ot.id===L),ht=[Re,$e,...je].filter(Boolean).map(ot=>ot.ref.current);pq(ht,T)}}Y.current=!1}),onBlur:vn(e.onBlur,()=>$(!1))})})}),dq="RovingFocusGroupItem",fq=X.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:c,...f}=e,i=Qa(),v=c||i,b=Gfe(dq,n),T=b.currentTabStopId===v,A=uq(n),{onFocusableItemAdd:M,onFocusableItemRemove:R}=b;return X.useEffect(()=>{if(r)return M(),()=>R()},[r,M,R]),he.jsx(iD.ItemSlot,{scope:n,id:v,focusable:r,active:a,children:he.jsx(Qn.span,{tabIndex:T?0:-1,"data-orientation":b.orientation,...f,ref:t,onMouseDown:vn(e.onMouseDown,B=>{r?b.onItemFocus(v):B.preventDefault()}),onFocus:vn(e.onFocus,()=>b.onItemFocus(v)),onKeyDown:vn(e.onKeyDown,B=>{if(B.key==="Tab"&&B.shiftKey){b.onItemShiftTab();return}if(B.target!==B.currentTarget)return;const L=Zfe(B,b.orientation,b.dir);if(L!==void 0){if(B.metaKey||B.ctrlKey||B.altKey||B.shiftKey)return;B.preventDefault();let V=A().filter($=>$.focusable).map($=>$.ref.current);if(L==="last")V.reverse();else if(L==="prev"||L==="next"){L==="prev"&&V.reverse();const $=V.indexOf(B.currentTarget);V=b.loop?Xfe(V,$+1):V.slice($+1)}setTimeout(()=>pq(V))}})})})});fq.displayName=dq;var Hfe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function qfe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Zfe(e,t,n){const r=qfe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Hfe[r]}function pq(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function Xfe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var mq=hq,gq=fq,Kfe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Ay=new WeakMap,fE=new WeakMap,pE={},XO=0,yq=function(e){return e&&(e.host||yq(e.parentNode))},Yfe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=yq(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},Jfe=function(e,t,n,r){var a=Yfe(t,Array.isArray(e)?e:[e]);pE[n]||(pE[n]=new WeakMap);var c=pE[n],f=[],i=new Set,v=new Set(a),b=function(A){!A||i.has(A)||(i.add(A),b(A.parentNode))};a.forEach(b);var T=function(A){!A||v.has(A)||Array.prototype.forEach.call(A.children,function(M){if(i.has(M))T(M);else try{var R=M.getAttribute(r),B=R!==null&&R!=="false",L=(Ay.get(M)||0)+1,j=(c.get(M)||0)+1;Ay.set(M,L),c.set(M,j),f.push(M),L===1&&B&&fE.set(M,!0),j===1&&M.setAttribute(n,"true"),B||M.setAttribute(r,"true")}catch(V){console.error("aria-hidden: cannot operate on ",M,V)}})};return T(t),i.clear(),XO++,function(){f.forEach(function(A){var M=Ay.get(A)-1,R=c.get(A)-1;Ay.set(A,M),c.set(A,R),M||(fE.has(A)||A.removeAttribute(r),fE.delete(A)),R||A.removeAttribute(n)}),XO--,XO||(Ay=new WeakMap,Ay=new WeakMap,fE=new WeakMap,pE={})}},Aw=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=Kfe(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),Jfe(r,a,n,"aria-hidden")):function(){return null}},Ja=function(){return Ja=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c])}return t},Ja.apply(this,arguments)};function A3(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function _q(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,c;r<a;r++)(c||!(r in t))&&(c||(c=Array.prototype.slice.call(t,0,r)),c[r]=t[r]);return e.concat(c||Array.prototype.slice.call(t))}var k1="right-scroll-bar-position",R1="width-before-scroll-bar",Qfe="with-scroll-bars-hidden",epe="--removed-body-scroll-bar-size";function KO(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function tpe(e,t){var n=X.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var npe=typeof window<"u"?X.useLayoutEffect:X.useEffect,kU=new WeakMap;function vq(e,t){var n=tpe(null,function(r){return e.forEach(function(a){return KO(a,r)})});return npe(function(){var r=kU.get(n);if(r){var a=new Set(r),c=new Set(e),f=n.current;a.forEach(function(i){c.has(i)||KO(i,null)}),c.forEach(function(i){a.has(i)||KO(i,f)})}kU.set(n,e)},[e]),n}function rpe(e){return e}function ipe(e,t){t===void 0&&(t=rpe);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(c){var f=t(c,r);return n.push(f),function(){n=n.filter(function(i){return i!==f})}},assignSyncMedium:function(c){for(r=!0;n.length;){var f=n;n=[],f.forEach(c)}n={push:function(i){return c(i)},filter:function(){return n}}},assignMedium:function(c){r=!0;var f=[];if(n.length){var i=n;n=[],i.forEach(c),f=n}var v=function(){var T=f;f=[],T.forEach(c)},b=function(){return Promise.resolve().then(v)};b(),n={push:function(T){f.push(T),b()},filter:function(T){return f=f.filter(T),n}}}};return a}function xq(e){e===void 0&&(e={});var t=ipe(null);return t.options=Ja({async:!0,ssr:!1},e),t}var bq=function(e){var t=e.sideCar,n=A3(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return X.createElement(r,Ja({},n))};bq.isSideCarExport=!0;function wq(e,t){return e.useMedium(t),bq}var Sq=xq(),YO=function(){},WP=X.forwardRef(function(e,t){var n=X.useRef(null),r=X.useState({onScrollCapture:YO,onWheelCapture:YO,onTouchMoveCapture:YO}),a=r[0],c=r[1],f=e.forwardProps,i=e.children,v=e.className,b=e.removeScrollBar,T=e.enabled,A=e.shards,M=e.sideCar,R=e.noIsolation,B=e.inert,L=e.allowPinchZoom,j=e.as,V=j===void 0?"div":j,$=e.gapMode,H=A3(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),K=M,Y=vq([n,t]),se=Ja(Ja({},H),a);return X.createElement(X.Fragment,null,T&&X.createElement(K,{sideCar:Sq,removeScrollBar:b,shards:A,noIsolation:R,inert:B,setCallbacks:c,allowPinchZoom:!!L,lockRef:n,gapMode:$}),f?X.cloneElement(X.Children.only(i),Ja(Ja({},se),{ref:Y})):X.createElement(V,Ja({},se,{className:v,ref:Y}),i))});WP.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};WP.classNames={fullWidth:R1,zeroRight:k1};var ope=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function ape(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=ope();return t&&e.setAttribute("nonce",t),e}function spe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function lpe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var cpe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=ape())&&(spe(t,n),lpe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},upe=function(){var e=cpe();return function(t,n){X.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},P3=function(){var e=upe(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},hpe={left:0,top:0,right:0,gap:0},JO=function(e){return parseInt(e||"",10)||0},dpe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[JO(n),JO(r),JO(a)]},fpe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return hpe;var t=dpe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},ppe=P3(),h_="data-scroll-locked",mpe=function(e,t,n,r){var a=e.left,c=e.top,f=e.right,i=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Qfe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(i,"px ").concat(r,`;
  }
  body[`).concat(h_,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(c,`px;
    padding-right: `).concat(f,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(i,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(k1,` {
    right: `).concat(i,"px ").concat(r,`;
  }
  
  .`).concat(R1,` {
    margin-right: `).concat(i,"px ").concat(r,`;
  }
  
  .`).concat(k1," .").concat(k1,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(R1," .").concat(R1,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(h_,`] {
    `).concat(epe,": ").concat(i,`px;
  }
`)},RU=function(){var e=parseInt(document.body.getAttribute(h_)||"0",10);return isFinite(e)?e:0},gpe=function(){X.useEffect(function(){return document.body.setAttribute(h_,(RU()+1).toString()),function(){var e=RU()-1;e<=0?document.body.removeAttribute(h_):document.body.setAttribute(h_,e.toString())}},[])},Tq=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;gpe();var c=X.useMemo(function(){return fpe(a)},[a]);return X.createElement(ppe,{styles:mpe(c,!t,a,n?"":"!important")})},oD=!1;if(typeof window<"u")try{var mE=Object.defineProperty({},"passive",{get:function(){return oD=!0,!0}});window.addEventListener("test",mE,mE),window.removeEventListener("test",mE,mE)}catch{oD=!1}var Py=oD?{passive:!1}:!1,ype=function(e){return e.tagName==="TEXTAREA"},Eq=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!ype(e)&&n[t]==="visible")},_pe=function(e){return Eq(e,"overflowY")},vpe=function(e){return Eq(e,"overflowX")},DU=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=Aq(e,r);if(a){var c=Pq(e,r),f=c[1],i=c[2];if(f>i)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},xpe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},bpe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Aq=function(e,t){return e==="v"?_pe(t):vpe(t)},Pq=function(e,t){return e==="v"?xpe(t):bpe(t)},wpe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Spe=function(e,t,n,r,a){var c=wpe(e,window.getComputedStyle(t).direction),f=c*r,i=n.target,v=t.contains(i),b=!1,T=f>0,A=0,M=0;do{var R=Pq(e,i),B=R[0],L=R[1],j=R[2],V=L-j-c*B;(B||V)&&Aq(e,i)&&(A+=V,M+=B),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!v&&i!==document.body||v&&(t.contains(i)||t===i));return(T&&(Math.abs(A)<1||!a)||!T&&(Math.abs(M)<1||!a))&&(b=!0),b},gE=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},LU=function(e){return[e.deltaX,e.deltaY]},zU=function(e){return e&&"current"in e?e.current:e},Tpe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Epe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Ape=0,Cy=[];function Ppe(e){var t=X.useRef([]),n=X.useRef([0,0]),r=X.useRef(),a=X.useState(Ape++)[0],c=X.useState(P3)[0],f=X.useRef(e);X.useEffect(function(){f.current=e},[e]),X.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var L=_q([e.lockRef.current],(e.shards||[]).map(zU),!0).filter(Boolean);return L.forEach(function(j){return j.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),L.forEach(function(j){return j.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=X.useCallback(function(L,j){if("touches"in L&&L.touches.length===2||L.type==="wheel"&&L.ctrlKey)return!f.current.allowPinchZoom;var V=gE(L),$=n.current,H="deltaX"in L?L.deltaX:$[0]-V[0],K="deltaY"in L?L.deltaY:$[1]-V[1],Y,se=L.target,ce=Math.abs(H)>Math.abs(K)?"h":"v";if("touches"in L&&ce==="h"&&se.type==="range")return!1;var ye=DU(ce,se);if(!ye)return!0;if(ye?Y=ce:(Y=ce==="v"?"h":"v",ye=DU(ce,se)),!ye)return!1;if(!r.current&&"changedTouches"in L&&(H||K)&&(r.current=Y),!Y)return!0;var ze=r.current||Y;return Spe(ze,j,L,ze==="h"?H:K,!0)},[]),v=X.useCallback(function(L){var j=L;if(!(!Cy.length||Cy[Cy.length-1]!==c)){var V="deltaY"in j?LU(j):gE(j),$=t.current.filter(function(Y){return Y.name===j.type&&(Y.target===j.target||j.target===Y.shadowParent)&&Tpe(Y.delta,V)})[0];if($&&$.should){j.cancelable&&j.preventDefault();return}if(!$){var H=(f.current.shards||[]).map(zU).filter(Boolean).filter(function(Y){return Y.contains(j.target)}),K=H.length>0?i(j,H[0]):!f.current.noIsolation;K&&j.cancelable&&j.preventDefault()}}},[]),b=X.useCallback(function(L,j,V,$){var H={name:L,delta:j,target:V,should:$,shadowParent:Cpe(V)};t.current.push(H),setTimeout(function(){t.current=t.current.filter(function(K){return K!==H})},1)},[]),T=X.useCallback(function(L){n.current=gE(L),r.current=void 0},[]),A=X.useCallback(function(L){b(L.type,LU(L),L.target,i(L,e.lockRef.current))},[]),M=X.useCallback(function(L){b(L.type,gE(L),L.target,i(L,e.lockRef.current))},[]);X.useEffect(function(){return Cy.push(c),e.setCallbacks({onScrollCapture:A,onWheelCapture:A,onTouchMoveCapture:M}),document.addEventListener("wheel",v,Py),document.addEventListener("touchmove",v,Py),document.addEventListener("touchstart",T,Py),function(){Cy=Cy.filter(function(L){return L!==c}),document.removeEventListener("wheel",v,Py),document.removeEventListener("touchmove",v,Py),document.removeEventListener("touchstart",T,Py)}},[]);var R=e.removeScrollBar,B=e.inert;return X.createElement(X.Fragment,null,B?X.createElement(c,{styles:Epe(a)}):null,R?X.createElement(Tq,{gapMode:e.gapMode}):null)}function Cpe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Ipe=wq(Sq,Ppe);var Pw=X.forwardRef(function(e,t){return X.createElement(WP,Ja({},e,{ref:t,sideCar:Ipe}))});Pw.classNames=WP.classNames;var aD=["Enter"," "],Mpe=["ArrowDown","PageUp","Home"],Cq=["ArrowUp","PageDown","End"],Ope=[...Mpe,...Cq],kpe={ltr:[...aD,"ArrowRight"],rtl:[...aD,"ArrowLeft"]},Rpe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Cw="Menu",[pb,Dpe,Lpe]=xv(Cw),[Km,Iq]=qs(Cw,[Lpe,Vf,GP]),HP=Vf(),Mq=GP(),[zpe,Ym]=Km(Cw),[Npe,Iw]=Km(Cw),Oq=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:c,modal:f=!0}=e,i=HP(t),[v,b]=X.useState(null),T=X.useRef(!1),A=Zo(c),M=bv(a);return X.useEffect(()=>{const R=()=>{T.current=!0,document.addEventListener("pointerdown",B,{capture:!0,once:!0}),document.addEventListener("pointermove",B,{capture:!0,once:!0})},B=()=>T.current=!1;return document.addEventListener("keydown",R,{capture:!0}),()=>{document.removeEventListener("keydown",R,{capture:!0}),document.removeEventListener("pointerdown",B,{capture:!0}),document.removeEventListener("pointermove",B,{capture:!0})}},[]),he.jsx(jP,{...i,children:he.jsx(zpe,{scope:t,open:n,onOpenChange:A,content:v,onContentChange:b,children:he.jsx(Npe,{scope:t,onClose:X.useCallback(()=>A(!1),[A]),isUsingKeyboardRef:T,dir:M,modal:f,children:r})})})};Oq.displayName=Cw;var Fpe="MenuAnchor",C3=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=HP(n);return he.jsx(Tw,{...a,...r,ref:t})});C3.displayName=Fpe;var I3="MenuPortal",[Bpe,kq]=Km(I3,{forceMount:void 0}),Rq=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,c=Ym(I3,t);return he.jsx(Bpe,{scope:t,forceMount:n,children:he.jsx(wa,{present:n||c.open,children:he.jsx(Ew,{asChild:!0,container:a,children:r})})})};Rq.displayName=I3;var $l="MenuContent",[jpe,M3]=Km($l),Dq=X.forwardRef((e,t)=>{const n=kq($l,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,c=Ym($l,e.__scopeMenu),f=Iw($l,e.__scopeMenu);return he.jsx(pb.Provider,{scope:e.__scopeMenu,children:he.jsx(wa,{present:r||c.open,children:he.jsx(pb.Slot,{scope:e.__scopeMenu,children:f.modal?he.jsx($pe,{...a,ref:t}):he.jsx(Upe,{...a,ref:t})})})})}),$pe=X.forwardRef((e,t)=>{const n=Ym($l,e.__scopeMenu),r=X.useRef(null),a=qr(t,r);return X.useEffect(()=>{const c=r.current;if(c)return Aw(c)},[]),he.jsx(O3,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:vn(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Upe=X.forwardRef((e,t)=>{const n=Ym($l,e.__scopeMenu);return he.jsx(O3,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),O3=X.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:c,onCloseAutoFocus:f,disableOutsidePointerEvents:i,onEntryFocus:v,onEscapeKeyDown:b,onPointerDownOutside:T,onFocusOutside:A,onInteractOutside:M,onDismiss:R,disableOutsideScroll:B,...L}=e,j=Ym($l,n),V=Iw($l,n),$=HP(n),H=Mq(n),K=Dpe(n),[Y,se]=X.useState(null),ce=X.useRef(null),ye=qr(t,ce,j.onContentChange),ze=X.useRef(0),Le=X.useRef(""),je=X.useRef(0),Re=X.useRef(null),$e=X.useRef("right"),Ge=X.useRef(0),ht=B?Pw:X.Fragment,ot=B?{as:Pf,allowPinchZoom:!0}:void 0,Je=Xe=>{var Vt,lr;const pt=Le.current+Xe,zt=K().filter(Nt=>!Nt.disabled),Ft=document.activeElement,un=(Vt=zt.find(Nt=>Nt.ref.current===Ft))==null?void 0:Vt.textValue,Tn=zt.map(Nt=>Nt.textValue),fn=eme(Tn,pt,un),Cn=(lr=zt.find(Nt=>Nt.textValue===fn))==null?void 0:lr.ref.current;(function Nt(gn){Le.current=gn,window.clearTimeout(ze.current),gn!==""&&(ze.current=window.setTimeout(()=>Nt(""),1e3))})(pt),Cn&&setTimeout(()=>Cn.focus())};X.useEffect(()=>()=>window.clearTimeout(ze.current),[]),zP();const Ne=X.useCallback(Xe=>{var zt,Ft;return $e.current===((zt=Re.current)==null?void 0:zt.side)&&nme(Xe,(Ft=Re.current)==null?void 0:Ft.area)},[]);return he.jsx(jpe,{scope:n,searchRef:Le,onItemEnter:X.useCallback(Xe=>{Ne(Xe)&&Xe.preventDefault()},[Ne]),onItemLeave:X.useCallback(Xe=>{var pt;Ne(Xe)||((pt=ce.current)==null||pt.focus(),se(null))},[Ne]),onTriggerLeave:X.useCallback(Xe=>{Ne(Xe)&&Xe.preventDefault()},[Ne]),pointerGraceTimerRef:je,onPointerGraceIntentChange:X.useCallback(Xe=>{Re.current=Xe},[]),children:he.jsx(ht,{...ot,children:he.jsx(ww,{asChild:!0,trapped:a,onMountAutoFocus:vn(c,Xe=>{var pt;Xe.preventDefault(),(pt=ce.current)==null||pt.focus({preventScroll:!0})}),onUnmountAutoFocus:f,children:he.jsx(Xm,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:b,onPointerDownOutside:T,onFocusOutside:A,onInteractOutside:M,onDismiss:R,children:he.jsx(mq,{asChild:!0,...H,dir:V.dir,orientation:"vertical",loop:r,currentTabStopId:Y,onCurrentTabStopIdChange:se,onEntryFocus:vn(v,Xe=>{V.isUsingKeyboardRef.current||Xe.preventDefault()}),preventScrollOnEntryFocus:!0,children:he.jsx($P,{role:"menu","aria-orientation":"vertical","data-state":Kq(j.open),"data-radix-menu-content":"",dir:V.dir,...$,...L,ref:ye,style:{outline:"none",...L.style},onKeyDown:vn(L.onKeyDown,Xe=>{const zt=Xe.target.closest("[data-radix-menu-content]")===Xe.currentTarget,Ft=Xe.ctrlKey||Xe.altKey||Xe.metaKey,un=Xe.key.length===1;zt&&(Xe.key==="Tab"&&Xe.preventDefault(),!Ft&&un&&Je(Xe.key));const Tn=ce.current;if(Xe.target!==Tn||!Ope.includes(Xe.key))return;Xe.preventDefault();const Cn=K().filter(Vt=>!Vt.disabled).map(Vt=>Vt.ref.current);Cq.includes(Xe.key)&&Cn.reverse(),Jpe(Cn)}),onBlur:vn(e.onBlur,Xe=>{Xe.currentTarget.contains(Xe.target)||(window.clearTimeout(ze.current),Le.current="")}),onPointerMove:vn(e.onPointerMove,mb(Xe=>{const pt=Xe.target,zt=Ge.current!==Xe.clientX;if(Xe.currentTarget.contains(pt)&&zt){const Ft=Xe.clientX>Ge.current?"right":"left";$e.current=Ft,Ge.current=Xe.clientX}}))})})})})})})});Dq.displayName=$l;var Vpe="MenuGroup",k3=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return he.jsx(Qn.div,{role:"group",...r,ref:t})});k3.displayName=Vpe;var Gpe="MenuLabel",Lq=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return he.jsx(Qn.div,{...r,ref:t})});Lq.displayName=Gpe;var F2="MenuItem",NU="menu.itemSelect",qP=X.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,c=X.useRef(null),f=Iw(F2,e.__scopeMenu),i=M3(F2,e.__scopeMenu),v=qr(t,c),b=X.useRef(!1),T=()=>{const A=c.current;if(!n&&A){const M=new CustomEvent(NU,{bubbles:!0,cancelable:!0});A.addEventListener(NU,R=>r==null?void 0:r(R),{once:!0}),R2(A,M),M.defaultPrevented?b.current=!1:f.onClose()}};return he.jsx(zq,{...a,ref:v,disabled:n,onClick:vn(e.onClick,T),onPointerDown:A=>{var M;(M=e.onPointerDown)==null||M.call(e,A),b.current=!0},onPointerUp:vn(e.onPointerUp,A=>{var M;b.current||(M=A.currentTarget)==null||M.click()}),onKeyDown:vn(e.onKeyDown,A=>{const M=i.searchRef.current!=="";n||M&&A.key===" "||aD.includes(A.key)&&(A.currentTarget.click(),A.preventDefault())})})});qP.displayName=F2;var zq=X.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...c}=e,f=M3(F2,n),i=Mq(n),v=X.useRef(null),b=qr(t,v),[T,A]=X.useState(!1),[M,R]=X.useState("");return X.useEffect(()=>{const B=v.current;B&&R((B.textContent??"").trim())},[c.children]),he.jsx(pb.ItemSlot,{scope:n,disabled:r,textValue:a??M,children:he.jsx(gq,{asChild:!0,...i,focusable:!r,children:he.jsx(Qn.div,{role:"menuitem","data-highlighted":T?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...c,ref:b,onPointerMove:vn(e.onPointerMove,mb(B=>{r?f.onItemLeave(B):(f.onItemEnter(B),B.defaultPrevented||B.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:vn(e.onPointerLeave,mb(B=>f.onItemLeave(B))),onFocus:vn(e.onFocus,()=>A(!0)),onBlur:vn(e.onBlur,()=>A(!1))})})})}),Wpe="MenuCheckboxItem",Nq=X.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return he.jsx(Uq,{scope:e.__scopeMenu,checked:n,children:he.jsx(qP,{role:"menuitemcheckbox","aria-checked":B2(n)?"mixed":n,...a,ref:t,"data-state":D3(n),onSelect:vn(a.onSelect,()=>r==null?void 0:r(B2(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Nq.displayName=Wpe;var Fq="MenuRadioGroup",[Hpe,qpe]=Km(Fq,{value:void 0,onValueChange:()=>{}}),Bq=X.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,c=Zo(r);return he.jsx(Hpe,{scope:e.__scopeMenu,value:n,onValueChange:c,children:he.jsx(k3,{...a,ref:t})})});Bq.displayName=Fq;var jq="MenuRadioItem",$q=X.forwardRef((e,t)=>{const{value:n,...r}=e,a=qpe(jq,e.__scopeMenu),c=n===a.value;return he.jsx(Uq,{scope:e.__scopeMenu,checked:c,children:he.jsx(qP,{role:"menuitemradio","aria-checked":c,...r,ref:t,"data-state":D3(c),onSelect:vn(r.onSelect,()=>{var f;return(f=a.onValueChange)==null?void 0:f.call(a,n)},{checkForDefaultPrevented:!1})})})});$q.displayName=jq;var R3="MenuItemIndicator",[Uq,Zpe]=Km(R3,{checked:!1}),Vq=X.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,c=Zpe(R3,n);return he.jsx(wa,{present:r||B2(c.checked)||c.checked===!0,children:he.jsx(Qn.span,{...a,ref:t,"data-state":D3(c.checked)})})});Vq.displayName=R3;var Xpe="MenuSeparator",Gq=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return he.jsx(Qn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});Gq.displayName=Xpe;var Kpe="MenuArrow",Wq=X.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=HP(n);return he.jsx(UP,{...a,...r,ref:t})});Wq.displayName=Kpe;var Ype="MenuSub",[lHe,Hq]=Km(Ype),d1="MenuSubTrigger",qq=X.forwardRef((e,t)=>{const n=Ym(d1,e.__scopeMenu),r=Iw(d1,e.__scopeMenu),a=Hq(d1,e.__scopeMenu),c=M3(d1,e.__scopeMenu),f=X.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:v}=c,b={__scopeMenu:e.__scopeMenu},T=X.useCallback(()=>{f.current&&window.clearTimeout(f.current),f.current=null},[]);return X.useEffect(()=>T,[T]),X.useEffect(()=>{const A=i.current;return()=>{window.clearTimeout(A),v(null)}},[i,v]),he.jsx(C3,{asChild:!0,...b,children:he.jsx(zq,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":Kq(n.open),...e,ref:vw(t,a.onTriggerChange),onClick:A=>{var M;(M=e.onClick)==null||M.call(e,A),!(e.disabled||A.defaultPrevented)&&(A.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:vn(e.onPointerMove,mb(A=>{c.onItemEnter(A),!A.defaultPrevented&&!e.disabled&&!n.open&&!f.current&&(c.onPointerGraceIntentChange(null),f.current=window.setTimeout(()=>{n.onOpenChange(!0),T()},100))})),onPointerLeave:vn(e.onPointerLeave,mb(A=>{var R,B;T();const M=(R=n.content)==null?void 0:R.getBoundingClientRect();if(M){const L=(B=n.content)==null?void 0:B.dataset.side,j=L==="right",V=j?-5:5,$=M[j?"left":"right"],H=M[j?"right":"left"];c.onPointerGraceIntentChange({area:[{x:A.clientX+V,y:A.clientY},{x:$,y:M.top},{x:H,y:M.top},{x:H,y:M.bottom},{x:$,y:M.bottom}],side:L}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>c.onPointerGraceIntentChange(null),300)}else{if(c.onTriggerLeave(A),A.defaultPrevented)return;c.onPointerGraceIntentChange(null)}})),onKeyDown:vn(e.onKeyDown,A=>{var R;const M=c.searchRef.current!=="";e.disabled||M&&A.key===" "||kpe[r.dir].includes(A.key)&&(n.onOpenChange(!0),(R=n.content)==null||R.focus(),A.preventDefault())})})})});qq.displayName=d1;var Zq="MenuSubContent",Xq=X.forwardRef((e,t)=>{const n=kq($l,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,c=Ym($l,e.__scopeMenu),f=Iw($l,e.__scopeMenu),i=Hq(Zq,e.__scopeMenu),v=X.useRef(null),b=qr(t,v);return he.jsx(pb.Provider,{scope:e.__scopeMenu,children:he.jsx(wa,{present:r||c.open,children:he.jsx(pb.Slot,{scope:e.__scopeMenu,children:he.jsx(O3,{id:i.contentId,"aria-labelledby":i.triggerId,...a,ref:b,align:"start",side:f.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:T=>{var A;f.isUsingKeyboardRef.current&&((A=v.current)==null||A.focus()),T.preventDefault()},onCloseAutoFocus:T=>T.preventDefault(),onFocusOutside:vn(e.onFocusOutside,T=>{T.target!==i.trigger&&c.onOpenChange(!1)}),onEscapeKeyDown:vn(e.onEscapeKeyDown,T=>{f.onClose(),T.preventDefault()}),onKeyDown:vn(e.onKeyDown,T=>{var R;const A=T.currentTarget.contains(T.target),M=Rpe[f.dir].includes(T.key);A&&M&&(c.onOpenChange(!1),(R=i.trigger)==null||R.focus(),T.preventDefault())})})})})})});Xq.displayName=Zq;function Kq(e){return e?"open":"closed"}function B2(e){return e==="indeterminate"}function D3(e){return B2(e)?"indeterminate":e?"checked":"unchecked"}function Jpe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Qpe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function eme(e,t,n){const a=t.length>1&&Array.from(t).every(b=>b===t[0])?t[0]:t,c=n?e.indexOf(n):-1;let f=Qpe(e,Math.max(c,0));a.length===1&&(f=f.filter(b=>b!==n));const v=f.find(b=>b.toLowerCase().startsWith(a.toLowerCase()));return v!==n?v:void 0}function tme(e,t){const{x:n,y:r}=e;let a=!1;for(let c=0,f=t.length-1;c<t.length;f=c++){const i=t[c].x,v=t[c].y,b=t[f].x,T=t[f].y;v>r!=T>r&&n<(b-i)*(r-v)/(T-v)+i&&(a=!a)}return a}function nme(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return tme(n,t)}function mb(e){return t=>t.pointerType==="mouse"?e(t):void 0}var rme=Oq,ime=C3,ome=Rq,ame=Dq,sme=k3,lme=Lq,cme=qP,ume=Nq,hme=Bq,dme=$q,fme=Vq,pme=Gq,mme=Wq,gme=qq,yme=Xq,L3="DropdownMenu",[_me,cHe]=qs(L3,[Iq]),bs=Iq(),[vme,Yq]=_me(L3),Jq=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:c,onOpenChange:f,modal:i=!0}=e,v=bs(t),b=X.useRef(null),[T=!1,A]=ys({prop:a,defaultProp:c,onChange:f});return he.jsx(vme,{scope:t,triggerId:Qa(),triggerRef:b,contentId:Qa(),open:T,onOpenChange:A,onOpenToggle:X.useCallback(()=>A(M=>!M),[A]),modal:i,children:he.jsx(rme,{...v,open:T,onOpenChange:A,dir:r,modal:i,children:n})})};Jq.displayName=L3;var Qq="DropdownMenuTrigger",eZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,c=Yq(Qq,n),f=bs(n);return he.jsx(ime,{asChild:!0,...f,children:he.jsx(Qn.button,{type:"button",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":c.open?c.contentId:void 0,"data-state":c.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:vw(t,c.triggerRef),onPointerDown:vn(e.onPointerDown,i=>{!r&&i.button===0&&i.ctrlKey===!1&&(c.onOpenToggle(),c.open||i.preventDefault())}),onKeyDown:vn(e.onKeyDown,i=>{r||(["Enter"," "].includes(i.key)&&c.onOpenToggle(),i.key==="ArrowDown"&&c.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});eZ.displayName=Qq;var xme="DropdownMenuPortal",tZ=e=>{const{__scopeDropdownMenu:t,...n}=e,r=bs(t);return he.jsx(ome,{...r,...n})};tZ.displayName=xme;var nZ="DropdownMenuContent",rZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Yq(nZ,n),c=bs(n),f=X.useRef(!1);return he.jsx(ame,{id:a.contentId,"aria-labelledby":a.triggerId,...c,...r,ref:t,onCloseAutoFocus:vn(e.onCloseAutoFocus,i=>{var v;f.current||(v=a.triggerRef.current)==null||v.focus(),f.current=!1,i.preventDefault()}),onInteractOutside:vn(e.onInteractOutside,i=>{const v=i.detail.originalEvent,b=v.button===0&&v.ctrlKey===!0,T=v.button===2||b;(!a.modal||T)&&(f.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});rZ.displayName=nZ;var bme="DropdownMenuGroup",wme=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(sme,{...a,...r,ref:t})});wme.displayName=bme;var Sme="DropdownMenuLabel",iZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(lme,{...a,...r,ref:t})});iZ.displayName=Sme;var Tme="DropdownMenuItem",oZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(cme,{...a,...r,ref:t})});oZ.displayName=Tme;var Eme="DropdownMenuCheckboxItem",aZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(ume,{...a,...r,ref:t})});aZ.displayName=Eme;var Ame="DropdownMenuRadioGroup",Pme=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(hme,{...a,...r,ref:t})});Pme.displayName=Ame;var Cme="DropdownMenuRadioItem",sZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(dme,{...a,...r,ref:t})});sZ.displayName=Cme;var Ime="DropdownMenuItemIndicator",lZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(fme,{...a,...r,ref:t})});lZ.displayName=Ime;var Mme="DropdownMenuSeparator",cZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(pme,{...a,...r,ref:t})});cZ.displayName=Mme;var Ome="DropdownMenuArrow",kme=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(mme,{...a,...r,ref:t})});kme.displayName=Ome;var Rme="DropdownMenuSubTrigger",uZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(gme,{...a,...r,ref:t})});uZ.displayName=Rme;var Dme="DropdownMenuSubContent",hZ=X.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=bs(n);return he.jsx(yme,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});hZ.displayName=Dme;var uHe=Jq,hHe=eZ,dHe=tZ,fHe=rZ,pHe=iZ,mHe=oZ,gHe=aZ,yHe=sZ,_He=lZ,vHe=cZ,xHe=uZ,bHe=hZ;/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lme=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),dZ=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zme={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nme=X.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:c,iconNode:f,...i},v)=>X.createElement("svg",{ref:v,...zme,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:dZ("lucide",a),...i},[...f.map(([b,T])=>X.createElement(b,T)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=(e,t)=>{const n=X.forwardRef(({className:r,...a},c)=>X.createElement(Nme,{ref:c,iconNode:t,className:dZ(`lucide-${Lme(e)}`,r),...a}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wHe=hn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SHe=hn("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const THe=hn("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EHe=hn("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AHe=hn("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PHe=hn("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CHe=hn("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IHe=hn("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MHe=hn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OHe=hn("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kHe=hn("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RHe=hn("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DHe=hn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LHe=hn("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zHe=hn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NHe=hn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FHe=hn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BHe=hn("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jHe=hn("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $He=hn("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UHe=hn("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VHe=hn("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GHe=hn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WHe=hn("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HHe=hn("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qHe=hn("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZHe=hn("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XHe=hn("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KHe=hn("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YHe=hn("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JHe=hn("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QHe=hn("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eqe=hn("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tqe=hn("FileCog",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3.2 12.9-.9-.4",key:"1i3dj5"}],["path",{d:"m3.2 15.1-.9.4",key:"1fvgj0"}],["path",{d:"M4.677 21.5a2 2 0 0 0 1.313.5H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v2.5",key:"1yo3oz"}],["path",{d:"m4.9 11.2-.4-.9",key:"otmhb9"}],["path",{d:"m4.9 16.8-.4.9",key:"1b8z07"}],["path",{d:"m7.5 10.3-.4.9",key:"11k65u"}],["path",{d:"m7.5 17.7-.4-.9",key:"431x55"}],["path",{d:"m9.7 12.5-.9.4",key:"87sjan"}],["path",{d:"m9.7 15.5-.9-.4",key:"khqm91"}],["circle",{cx:"6",cy:"14",r:"3",key:"a1xfv6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nqe=hn("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rqe=hn("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iqe=hn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oqe=hn("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aqe=hn("Gavel",[["path",{d:"m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8",key:"15492f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sqe=hn("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lqe=hn("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cqe=hn("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uqe=hn("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hqe=hn("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dqe=hn("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fqe=hn("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pqe=hn("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mqe=hn("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gqe=hn("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yqe=hn("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _qe=hn("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vqe=hn("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xqe=hn("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bqe=hn("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wqe=hn("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sqe=hn("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tqe=hn("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eqe=hn("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aqe=hn("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pqe=hn("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cqe=hn("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iqe=hn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mqe=hn("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oqe=hn("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kqe=hn("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rqe=hn("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dqe=hn("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lqe=hn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zqe=hn("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nqe=hn("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fqe=hn("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bqe=hn("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jqe=hn("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $qe=hn("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uqe=hn("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vqe=hn("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gqe=hn("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wqe=hn("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hqe=hn("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qqe=hn("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zqe=hn("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xqe=hn("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kqe=hn("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yqe=hn("Tractor",[["path",{d:"m10 11 11 .9a1 1 0 0 1 .8 1.1l-.665 4.158a1 1 0 0 1-.988.842H20",key:"she1j9"}],["path",{d:"M16 18h-5",key:"bq60fd"}],["path",{d:"M18 5a1 1 0 0 0-1 1v5.573",key:"1kv8ia"}],["path",{d:"M3 4h8.129a1 1 0 0 1 .99.863L13 11.246",key:"1q1ert"}],["path",{d:"M4 11V4",key:"9ft8pt"}],["path",{d:"M7 15h.01",key:"k5ht0j"}],["path",{d:"M8 10.1V4",key:"1jgyzo"}],["circle",{cx:"18",cy:"18",r:"2",key:"1emm8v"}],["circle",{cx:"7",cy:"15",r:"5",key:"ddtuc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jqe=hn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qqe=hn("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eZe=hn("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tZe=hn("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nZe=hn("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rZe=hn("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iZe=hn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oZe=hn("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aZe=hn("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sZe=hn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lZe=hn("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cZe=hn("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uZe=hn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hZe=hn("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ZP(e){const t=X.useRef({value:e,previous:e});return X.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Fme="VisuallyHidden",z3=X.forwardRef((e,t)=>he.jsx(Qn.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));z3.displayName=Fme;var fZ=z3,Tv="NavigationMenu",[N3,pZ,Bme]=xv(Tv),[sD,jme,$me]=xv(Tv),[F3,dZe]=qs(Tv,[Bme,$me]),[Ume,ql]=F3(Tv),[Vme,Gme]=F3(Tv),mZ=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,value:r,onValueChange:a,defaultValue:c,delayDuration:f=200,skipDelayDuration:i=300,orientation:v="horizontal",dir:b,...T}=e,[A,M]=X.useState(null),R=qr(t,ze=>M(ze)),B=bv(b),L=X.useRef(0),j=X.useRef(0),V=X.useRef(0),[$,H]=X.useState(!0),[K="",Y]=ys({prop:r,onChange:ze=>{const Le=ze!=="",je=i>0;Le?(window.clearTimeout(V.current),je&&H(!1)):(window.clearTimeout(V.current),V.current=window.setTimeout(()=>H(!0),i)),a==null||a(ze)},defaultProp:c}),se=X.useCallback(()=>{window.clearTimeout(j.current),j.current=window.setTimeout(()=>Y(""),150)},[Y]),ce=X.useCallback(ze=>{window.clearTimeout(j.current),Y(ze)},[Y]),ye=X.useCallback(ze=>{K===ze?window.clearTimeout(j.current):L.current=window.setTimeout(()=>{window.clearTimeout(j.current),Y(ze)},f)},[K,Y,f]);return X.useEffect(()=>()=>{window.clearTimeout(L.current),window.clearTimeout(j.current),window.clearTimeout(V.current)},[]),he.jsx(yZ,{scope:n,isRootMenu:!0,value:K,dir:B,orientation:v,rootNavigationMenu:A,onTriggerEnter:ze=>{window.clearTimeout(L.current),$?ye(ze):ce(ze)},onTriggerLeave:()=>{window.clearTimeout(L.current),se()},onContentEnter:()=>window.clearTimeout(j.current),onContentLeave:se,onItemSelect:ze=>{Y(Le=>Le===ze?"":ze)},onItemDismiss:()=>Y(""),children:he.jsx(Qn.nav,{"aria-label":"Main","data-orientation":v,dir:B,...T,ref:R})})});mZ.displayName=Tv;var gZ="NavigationMenuSub",Wme=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,value:r,onValueChange:a,defaultValue:c,orientation:f="horizontal",...i}=e,v=ql(gZ,n),[b="",T]=ys({prop:r,onChange:a,defaultProp:c});return he.jsx(yZ,{scope:n,isRootMenu:!1,value:b,dir:v.dir,orientation:f,rootNavigationMenu:v.rootNavigationMenu,onTriggerEnter:A=>T(A),onItemSelect:A=>T(A),onItemDismiss:()=>T(""),children:he.jsx(Qn.div,{"data-orientation":f,...i,ref:t})})});Wme.displayName=gZ;var yZ=e=>{const{scope:t,isRootMenu:n,rootNavigationMenu:r,dir:a,orientation:c,children:f,value:i,onItemSelect:v,onItemDismiss:b,onTriggerEnter:T,onTriggerLeave:A,onContentEnter:M,onContentLeave:R}=e,[B,L]=X.useState(null),[j,V]=X.useState(new Map),[$,H]=X.useState(null);return he.jsx(Ume,{scope:t,isRootMenu:n,rootNavigationMenu:r,value:i,previousValue:ZP(i),baseId:Qa(),dir:a,orientation:c,viewport:B,onViewportChange:L,indicatorTrack:$,onIndicatorTrackChange:H,onTriggerEnter:Zo(T),onTriggerLeave:Zo(A),onContentEnter:Zo(M),onContentLeave:Zo(R),onItemSelect:Zo(v),onItemDismiss:Zo(b),onViewportContentChange:X.useCallback((K,Y)=>{V(se=>(se.set(K,Y),new Map(se)))},[]),onViewportContentRemove:X.useCallback(K=>{V(Y=>Y.has(K)?(Y.delete(K),new Map(Y)):Y)},[]),children:he.jsx(N3.Provider,{scope:t,children:he.jsx(Vme,{scope:t,items:j,children:f})})})},_Z="NavigationMenuList",vZ=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,...r}=e,a=ql(_Z,n),c=he.jsx(Qn.ul,{"data-orientation":a.orientation,...r,ref:t});return he.jsx(Qn.div,{style:{position:"relative"},ref:a.onIndicatorTrackChange,children:he.jsx(N3.Slot,{scope:n,children:a.isRootMenu?he.jsx(IZ,{asChild:!0,children:c}):c})})});vZ.displayName=_Z;var xZ="NavigationMenuItem",[Hme,bZ]=F3(xZ),wZ=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,value:r,...a}=e,c=Qa(),f=r||c||"LEGACY_REACT_AUTO_VALUE",i=X.useRef(null),v=X.useRef(null),b=X.useRef(null),T=X.useRef(()=>{}),A=X.useRef(!1),M=X.useCallback((B="start")=>{if(i.current){T.current();const L=cD(i.current);L.length&&$3(B==="start"?L:L.reverse())}},[]),R=X.useCallback(()=>{if(i.current){const B=cD(i.current);B.length&&(T.current=Qme(B))}},[]);return he.jsx(Hme,{scope:n,value:f,triggerRef:v,contentRef:i,focusProxyRef:b,wasEscapeCloseRef:A,onEntryKeyDown:M,onFocusProxyEnter:M,onRootContentClose:R,onContentFocusOutside:R,children:he.jsx(Qn.li,{...a,ref:t})})});wZ.displayName=xZ;var lD="NavigationMenuTrigger",SZ=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,disabled:r,...a}=e,c=ql(lD,e.__scopeNavigationMenu),f=bZ(lD,e.__scopeNavigationMenu),i=X.useRef(null),v=qr(i,f.triggerRef,t),b=OZ(c.baseId,f.value),T=kZ(c.baseId,f.value),A=X.useRef(!1),M=X.useRef(!1),R=f.value===c.value;return he.jsxs(he.Fragment,{children:[he.jsx(N3.ItemSlot,{scope:n,value:f.value,children:he.jsx(MZ,{asChild:!0,children:he.jsx(Qn.button,{id:b,disabled:r,"data-disabled":r?"":void 0,"data-state":U3(R),"aria-expanded":R,"aria-controls":T,...a,ref:v,onPointerEnter:vn(e.onPointerEnter,()=>{M.current=!1,f.wasEscapeCloseRef.current=!1}),onPointerMove:vn(e.onPointerMove,j2(()=>{r||M.current||f.wasEscapeCloseRef.current||A.current||(c.onTriggerEnter(f.value),A.current=!0)})),onPointerLeave:vn(e.onPointerLeave,j2(()=>{r||(c.onTriggerLeave(),A.current=!1)})),onClick:vn(e.onClick,()=>{c.onItemSelect(f.value),M.current=R}),onKeyDown:vn(e.onKeyDown,B=>{const j={horizontal:"ArrowDown",vertical:c.dir==="rtl"?"ArrowLeft":"ArrowRight"}[c.orientation];R&&B.key===j&&(f.onEntryKeyDown(),B.preventDefault())})})})}),R&&he.jsxs(he.Fragment,{children:[he.jsx(fZ,{"aria-hidden":!0,tabIndex:0,ref:f.focusProxyRef,onFocus:B=>{const L=f.contentRef.current,j=B.relatedTarget,V=j===i.current,$=L==null?void 0:L.contains(j);(V||!$)&&f.onFocusProxyEnter(V?"start":"end")}}),c.viewport&&he.jsx("span",{"aria-owns":T})]})]})});SZ.displayName=lD;var qme="NavigationMenuLink",FU="navigationMenu.linkSelect",TZ=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,active:r,onSelect:a,...c}=e;return he.jsx(MZ,{asChild:!0,children:he.jsx(Qn.a,{"data-active":r?"":void 0,"aria-current":r?"page":void 0,...c,ref:t,onClick:vn(e.onClick,f=>{const i=f.target,v=new CustomEvent(FU,{bubbles:!0,cancelable:!0});if(i.addEventListener(FU,b=>a==null?void 0:a(b),{once:!0}),R2(i,v),!v.defaultPrevented&&!f.metaKey){const b=new CustomEvent(YE,{bubbles:!0,cancelable:!0});R2(i,b)}},{checkForDefaultPrevented:!1})})})});TZ.displayName=qme;var B3="NavigationMenuIndicator",EZ=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=ql(B3,e.__scopeNavigationMenu),c=!!a.value;return a.indicatorTrack?PP.createPortal(he.jsx(wa,{present:n||c,children:he.jsx(Zme,{...r,ref:t})}),a.indicatorTrack):null});EZ.displayName=B3;var Zme=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,...r}=e,a=ql(B3,n),c=pZ(n),[f,i]=X.useState(null),[v,b]=X.useState(null),T=a.orientation==="horizontal",A=!!a.value;X.useEffect(()=>{var L;const B=(L=c().find(j=>j.value===a.value))==null?void 0:L.ref.current;B&&i(B)},[c,a.value]);const M=()=>{f&&b({size:T?f.offsetWidth:f.offsetHeight,offset:T?f.offsetLeft:f.offsetTop})};return uD(f,M),uD(a.indicatorTrack,M),v?he.jsx(Qn.div,{"aria-hidden":!0,"data-state":A?"visible":"hidden","data-orientation":a.orientation,...r,ref:t,style:{position:"absolute",...T?{left:0,width:v.size+"px",transform:`translateX(${v.offset}px)`}:{top:0,height:v.size+"px",transform:`translateY(${v.offset}px)`},...r.style}}):null}),P_="NavigationMenuContent",AZ=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=ql(P_,e.__scopeNavigationMenu),c=bZ(P_,e.__scopeNavigationMenu),f=qr(c.contentRef,t),i=c.value===a.value,v={value:c.value,triggerRef:c.triggerRef,focusProxyRef:c.focusProxyRef,wasEscapeCloseRef:c.wasEscapeCloseRef,onContentFocusOutside:c.onContentFocusOutside,onRootContentClose:c.onRootContentClose,...r};return a.viewport?he.jsx(Xme,{forceMount:n,...v,ref:f}):he.jsx(wa,{present:n||i,children:he.jsx(PZ,{"data-state":U3(i),...v,ref:f,onPointerEnter:vn(e.onPointerEnter,a.onContentEnter),onPointerLeave:vn(e.onPointerLeave,j2(a.onContentLeave)),style:{pointerEvents:!i&&a.isRootMenu?"none":void 0,...v.style}})})});AZ.displayName=P_;var Xme=X.forwardRef((e,t)=>{const n=ql(P_,e.__scopeNavigationMenu),{onViewportContentChange:r,onViewportContentRemove:a}=n;return $o(()=>{r(e.value,{ref:t,...e})},[e,t,r]),$o(()=>()=>a(e.value),[e.value,a]),null}),YE="navigationMenu.rootContentDismiss",PZ=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,value:r,triggerRef:a,focusProxyRef:c,wasEscapeCloseRef:f,onRootContentClose:i,onContentFocusOutside:v,...b}=e,T=ql(P_,n),A=X.useRef(null),M=qr(A,t),R=OZ(T.baseId,r),B=kZ(T.baseId,r),L=pZ(n),j=X.useRef(null),{onItemDismiss:V}=T;X.useEffect(()=>{const H=A.current;if(T.isRootMenu&&H){const K=()=>{var Y;V(),i(),H.contains(document.activeElement)&&((Y=a.current)==null||Y.focus())};return H.addEventListener(YE,K),()=>H.removeEventListener(YE,K)}},[T.isRootMenu,e.value,a,V,i]);const $=X.useMemo(()=>{const K=L().map(Le=>Le.value);T.dir==="rtl"&&K.reverse();const Y=K.indexOf(T.value),se=K.indexOf(T.previousValue),ce=r===T.value,ye=se===K.indexOf(r);if(!ce&&!ye)return j.current;const ze=(()=>{if(Y!==se){if(ce&&se!==-1)return Y>se?"from-end":"from-start";if(ye&&Y!==-1)return Y>se?"to-start":"to-end"}return null})();return j.current=ze,ze},[T.previousValue,T.value,T.dir,L,r]);return he.jsx(IZ,{asChild:!0,children:he.jsx(Xm,{id:B,"aria-labelledby":R,"data-motion":$,"data-orientation":T.orientation,...b,ref:M,disableOutsidePointerEvents:!1,onDismiss:()=>{var K;const H=new Event(YE,{bubbles:!0,cancelable:!0});(K=A.current)==null||K.dispatchEvent(H)},onFocusOutside:vn(e.onFocusOutside,H=>{var Y;v();const K=H.target;(Y=T.rootNavigationMenu)!=null&&Y.contains(K)&&H.preventDefault()}),onPointerDownOutside:vn(e.onPointerDownOutside,H=>{var ce;const K=H.target,Y=L().some(ye=>{var ze;return(ze=ye.ref.current)==null?void 0:ze.contains(K)}),se=T.isRootMenu&&((ce=T.viewport)==null?void 0:ce.contains(K));(Y||se||!T.isRootMenu)&&H.preventDefault()}),onKeyDown:vn(e.onKeyDown,H=>{var se;const K=H.altKey||H.ctrlKey||H.metaKey;if(H.key==="Tab"&&!K){const ce=cD(H.currentTarget),ye=document.activeElement,ze=ce.findIndex(Re=>Re===ye),je=H.shiftKey?ce.slice(0,ze).reverse():ce.slice(ze+1,ce.length);$3(je)?H.preventDefault():(se=c.current)==null||se.focus()}}),onEscapeKeyDown:vn(e.onEscapeKeyDown,H=>{f.current=!0})})})}),j3="NavigationMenuViewport",CZ=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,c=!!ql(j3,e.__scopeNavigationMenu).value;return he.jsx(wa,{present:n||c,children:he.jsx(Kme,{...r,ref:t})})});CZ.displayName=j3;var Kme=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,children:r,...a}=e,c=ql(j3,n),f=qr(t,c.onViewportChange),i=Gme(P_,e.__scopeNavigationMenu),[v,b]=X.useState(null),[T,A]=X.useState(null),M=v?(v==null?void 0:v.width)+"px":void 0,R=v?(v==null?void 0:v.height)+"px":void 0,B=!!c.value,L=B?c.value:c.previousValue;return uD(T,()=>{T&&b({width:T.offsetWidth,height:T.offsetHeight})}),he.jsx(Qn.div,{"data-state":U3(B),"data-orientation":c.orientation,...a,ref:f,style:{pointerEvents:!B&&c.isRootMenu?"none":void 0,"--radix-navigation-menu-viewport-width":M,"--radix-navigation-menu-viewport-height":R,...a.style},onPointerEnter:vn(e.onPointerEnter,c.onContentEnter),onPointerLeave:vn(e.onPointerLeave,j2(c.onContentLeave)),children:Array.from(i.items).map(([V,{ref:$,forceMount:H,...K}])=>{const Y=L===V;return he.jsx(wa,{present:H||Y,children:he.jsx(PZ,{...K,ref:vw($,se=>{Y&&se&&A(se)})})},V)})})}),Yme="FocusGroup",IZ=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,...r}=e,a=ql(Yme,n);return he.jsx(sD.Provider,{scope:n,children:he.jsx(sD.Slot,{scope:n,children:he.jsx(Qn.div,{dir:a.dir,...r,ref:t})})})}),BU=["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"],Jme="FocusGroupItem",MZ=X.forwardRef((e,t)=>{const{__scopeNavigationMenu:n,...r}=e,a=jme(n),c=ql(Jme,n);return he.jsx(sD.ItemSlot,{scope:n,children:he.jsx(Qn.button,{...r,ref:t,onKeyDown:vn(e.onKeyDown,f=>{if(["Home","End",...BU].includes(f.key)){let v=a().map(A=>A.ref.current);if([c.dir==="rtl"?"ArrowRight":"ArrowLeft","ArrowUp","End"].includes(f.key)&&v.reverse(),BU.includes(f.key)){const A=v.indexOf(f.currentTarget);v=v.slice(A+1)}setTimeout(()=>$3(v)),f.preventDefault()}})})})});function cD(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function $3(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}function Qme(e){return e.forEach(t=>{t.dataset.tabindex=t.getAttribute("tabindex")||"",t.setAttribute("tabindex","-1")}),()=>{e.forEach(t=>{const n=t.dataset.tabindex;t.setAttribute("tabindex",n)})}}function uD(e,t){const n=Zo(t);$o(()=>{let r=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return a.observe(e),()=>{window.cancelAnimationFrame(r),a.unobserve(e)}}},[e,n])}function U3(e){return e?"open":"closed"}function OZ(e,t){return`${e}-trigger-${t}`}function kZ(e,t){return`${e}-content-${t}`}function j2(e){return t=>t.pointerType==="mouse"?e(t):void 0}var fZe=mZ,pZe=vZ,mZe=wZ,gZe=SZ,yZe=TZ,_Ze=EZ,vZe=AZ,xZe=CZ;function xf(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function jU(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function RZ(...e){return t=>{let n=!1;const r=e.map(a=>{const c=jU(a,t);return!n&&typeof c=="function"&&(n=!0),c});if(n)return()=>{for(let a=0;a<r.length;a++){const c=r[a];typeof c=="function"?c():jU(e[a],null)}}}}function Jm(...e){return X.useCallback(RZ(...e),e)}function ege(e,t){const n=X.createContext(t),r=c=>{const{children:f,...i}=c,v=X.useMemo(()=>i,Object.values(i));return he.jsx(n.Provider,{value:v,children:f})};r.displayName=e+"Provider";function a(c){const f=X.useContext(n);if(f)return f;if(t!==void 0)return t;throw new Error(`\`${c}\` must be used within \`${e}\``)}return[r,a]}function tge(e,t=[]){let n=[];function r(c,f){const i=X.createContext(f),v=n.length;n=[...n,f];const b=A=>{var V;const{scope:M,children:R,...B}=A,L=((V=M==null?void 0:M[e])==null?void 0:V[v])||i,j=X.useMemo(()=>B,Object.values(B));return he.jsx(L.Provider,{value:j,children:R})};b.displayName=c+"Provider";function T(A,M){var L;const R=((L=M==null?void 0:M[e])==null?void 0:L[v])||i,B=X.useContext(R);if(B)return B;if(f!==void 0)return f;throw new Error(`\`${A}\` must be used within \`${c}\``)}return[b,T]}const a=()=>{const c=n.map(f=>X.createContext(f));return function(i){const v=(i==null?void 0:i[e])||c;return X.useMemo(()=>({[`__scope${e}`]:{...i,[e]:v}}),[i,v])}};return a.scopeName=e,[r,nge(a,...t)]}function nge(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const f=r.reduce((i,{useScope:v,scopeName:b})=>{const A=v(c)[`__scope${b}`];return{...i,...A}},{});return X.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return n.scopeName=t.scopeName,n}var $2=globalThis!=null&&globalThis.document?X.useLayoutEffect:()=>{},rge=gz[" useId ".trim().toString()]||(()=>{}),ige=0;function QO(e){const[t,n]=X.useState(rge());return $2(()=>{e||n(r=>r??String(ige++))},[e]),e||(t?`radix-${t}`:"")}function Mm(e){const t=X.useRef(e);return X.useEffect(()=>{t.current=e}),X.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function oge({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,a]=age({defaultProp:t,onChange:n}),c=e!==void 0,f=c?e:r,i=Mm(n),v=X.useCallback(b=>{if(c){const A=typeof b=="function"?b(e):b;A!==e&&i(A)}else a(b)},[c,e,a,i]);return[f,v]}function age({defaultProp:e,onChange:t}){const n=X.useState(e),[r]=n,a=X.useRef(r),c=Mm(t);return X.useEffect(()=>{a.current!==r&&(c(r),a.current=r)},[r,a,c]),n}function DZ(e){const t=sge(e),n=X.forwardRef((r,a)=>{const{children:c,...f}=r,i=X.Children.toArray(c),v=i.find(cge);if(v){const b=v.props.children,T=i.map(A=>A===v?X.Children.count(b)>1?X.Children.only(null):X.isValidElement(b)?b.props.children:null:A);return he.jsx(t,{...f,ref:a,children:X.isValidElement(b)?X.cloneElement(b,void 0,T):null})}return he.jsx(t,{...f,ref:a,children:c})});return n.displayName=`${e}.Slot`,n}function sge(e){const t=X.forwardRef((n,r)=>{const{children:a,...c}=n;if(X.isValidElement(a)){const f=hge(a),i=uge(c,a.props);return a.type!==X.Fragment&&(i.ref=r?RZ(r,f):f),X.cloneElement(a,i)}return X.Children.count(a)>1?X.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var lge=Symbol("radix.slottable");function cge(e){return X.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===lge}function uge(e,t){const n={...t};for(const r in t){const a=e[r],c=t[r];/^on[A-Z]/.test(r)?a&&c?n[r]=(...i)=>{c(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...c}:r==="className"&&(n[r]=[a,c].filter(Boolean).join(" "))}return{...e,...n}}function hge(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var dge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Uh=dge.reduce((e,t)=>{const n=DZ(`Primitive.${t}`),r=X.forwardRef((a,c)=>{const{asChild:f,...i}=a,v=f?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),he.jsx(v,{...i,ref:c})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function fge(e,t){e&&Wm.flushSync(()=>e.dispatchEvent(t))}function pge(e,t=globalThis==null?void 0:globalThis.document){const n=Mm(e);X.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var mge="DismissableLayer",hD="dismissableLayer.update",gge="dismissableLayer.pointerDownOutside",yge="dismissableLayer.focusOutside",$U,LZ=X.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),zZ=X.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:c,onInteractOutside:f,onDismiss:i,...v}=e,b=X.useContext(LZ),[T,A]=X.useState(null),M=(T==null?void 0:T.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,R]=X.useState({}),B=Jm(t,ce=>A(ce)),L=Array.from(b.layers),[j]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),V=L.indexOf(j),$=T?L.indexOf(T):-1,H=b.layersWithOutsidePointerEventsDisabled.size>0,K=$>=V,Y=xge(ce=>{const ye=ce.target,ze=[...b.branches].some(Le=>Le.contains(ye));!K||ze||(a==null||a(ce),f==null||f(ce),ce.defaultPrevented||i==null||i())},M),se=bge(ce=>{const ye=ce.target;[...b.branches].some(Le=>Le.contains(ye))||(c==null||c(ce),f==null||f(ce),ce.defaultPrevented||i==null||i())},M);return pge(ce=>{$===b.layers.size-1&&(r==null||r(ce),!ce.defaultPrevented&&i&&(ce.preventDefault(),i()))},M),X.useEffect(()=>{if(T)return n&&(b.layersWithOutsidePointerEventsDisabled.size===0&&($U=M.body.style.pointerEvents,M.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(T)),b.layers.add(T),UU(),()=>{n&&b.layersWithOutsidePointerEventsDisabled.size===1&&(M.body.style.pointerEvents=$U)}},[T,M,n,b]),X.useEffect(()=>()=>{T&&(b.layers.delete(T),b.layersWithOutsidePointerEventsDisabled.delete(T),UU())},[T,b]),X.useEffect(()=>{const ce=()=>R({});return document.addEventListener(hD,ce),()=>document.removeEventListener(hD,ce)},[]),he.jsx(Uh.div,{...v,ref:B,style:{pointerEvents:H?K?"auto":"none":void 0,...e.style},onFocusCapture:xf(e.onFocusCapture,se.onFocusCapture),onBlurCapture:xf(e.onBlurCapture,se.onBlurCapture),onPointerDownCapture:xf(e.onPointerDownCapture,Y.onPointerDownCapture)})});zZ.displayName=mge;var _ge="DismissableLayerBranch",vge=X.forwardRef((e,t)=>{const n=X.useContext(LZ),r=X.useRef(null),a=Jm(t,r);return X.useEffect(()=>{const c=r.current;if(c)return n.branches.add(c),()=>{n.branches.delete(c)}},[n.branches]),he.jsx(Uh.div,{...e,ref:a})});vge.displayName=_ge;function xge(e,t=globalThis==null?void 0:globalThis.document){const n=Mm(e),r=X.useRef(!1),a=X.useRef(()=>{});return X.useEffect(()=>{const c=i=>{if(i.target&&!r.current){let v=function(){NZ(gge,n,b,{discrete:!0})};const b={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=v,t.addEventListener("click",a.current,{once:!0})):v()}else t.removeEventListener("click",a.current);r.current=!1},f=window.setTimeout(()=>{t.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(f),t.removeEventListener("pointerdown",c),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function bge(e,t=globalThis==null?void 0:globalThis.document){const n=Mm(e),r=X.useRef(!1);return X.useEffect(()=>{const a=c=>{c.target&&!r.current&&NZ(yge,n,{originalEvent:c},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function UU(){const e=new CustomEvent(hD);document.dispatchEvent(e)}function NZ(e,t,n,{discrete:r}){const a=n.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?fge(a,c):a.dispatchEvent(c)}var ek="focusScope.autoFocusOnMount",tk="focusScope.autoFocusOnUnmount",VU={bubbles:!1,cancelable:!0},wge="FocusScope",FZ=X.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:c,...f}=e,[i,v]=X.useState(null),b=Mm(a),T=Mm(c),A=X.useRef(null),M=Jm(t,L=>v(L)),R=X.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;X.useEffect(()=>{if(r){let L=function(H){if(R.paused||!i)return;const K=H.target;i.contains(K)?A.current=K:Hd(A.current,{select:!0})},j=function(H){if(R.paused||!i)return;const K=H.relatedTarget;K!==null&&(i.contains(K)||Hd(A.current,{select:!0}))},V=function(H){if(document.activeElement===document.body)for(const Y of H)Y.removedNodes.length>0&&Hd(i)};document.addEventListener("focusin",L),document.addEventListener("focusout",j);const $=new MutationObserver(V);return i&&$.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",L),document.removeEventListener("focusout",j),$.disconnect()}}},[r,i,R.paused]),X.useEffect(()=>{if(i){WU.add(R);const L=document.activeElement;if(!i.contains(L)){const V=new CustomEvent(ek,VU);i.addEventListener(ek,b),i.dispatchEvent(V),V.defaultPrevented||(Sge(Cge(BZ(i)),{select:!0}),document.activeElement===L&&Hd(i))}return()=>{i.removeEventListener(ek,b),setTimeout(()=>{const V=new CustomEvent(tk,VU);i.addEventListener(tk,T),i.dispatchEvent(V),V.defaultPrevented||Hd(L??document.body,{select:!0}),i.removeEventListener(tk,T),WU.remove(R)},0)}}},[i,b,T,R]);const B=X.useCallback(L=>{if(!n&&!r||R.paused)return;const j=L.key==="Tab"&&!L.altKey&&!L.ctrlKey&&!L.metaKey,V=document.activeElement;if(j&&V){const $=L.currentTarget,[H,K]=Tge($);H&&K?!L.shiftKey&&V===K?(L.preventDefault(),n&&Hd(H,{select:!0})):L.shiftKey&&V===H&&(L.preventDefault(),n&&Hd(K,{select:!0})):V===$&&L.preventDefault()}},[n,r,R.paused]);return he.jsx(Uh.div,{tabIndex:-1,...f,ref:M,onKeyDown:B})});FZ.displayName=wge;function Sge(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Hd(r,{select:t}),document.activeElement!==n)return}function Tge(e){const t=BZ(e),n=GU(t,e),r=GU(t.reverse(),e);return[n,r]}function BZ(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function GU(e,t){for(const n of e)if(!Ege(n,{upTo:t}))return n}function Ege(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Age(e){return e instanceof HTMLInputElement&&"select"in e}function Hd(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Age(e)&&t&&e.select()}}var WU=Pge();function Pge(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=HU(e,t),e.unshift(t)},remove(t){var n;e=HU(e,t),(n=e[0])==null||n.resume()}}}function HU(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Cge(e){return e.filter(t=>t.tagName!=="A")}var Ige="Portal",jZ=X.forwardRef((e,t)=>{var i;const{container:n,...r}=e,[a,c]=X.useState(!1);$2(()=>c(!0),[]);const f=n||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return f?PP.createPortal(he.jsx(Uh.div,{...r,ref:t}),f):null});jZ.displayName=Ige;function Mge(e,t){return X.useReducer((n,r)=>t[n][r]??n,e)}var XP=e=>{const{present:t,children:n}=e,r=Oge(t),a=typeof n=="function"?n({present:r.isPresent}):X.Children.only(n),c=Jm(r.ref,kge(a));return typeof n=="function"||r.isPresent?X.cloneElement(a,{ref:c}):null};XP.displayName="Presence";function Oge(e){const[t,n]=X.useState(),r=X.useRef({}),a=X.useRef(e),c=X.useRef("none"),f=e?"mounted":"unmounted",[i,v]=Mge(f,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return X.useEffect(()=>{const b=yE(r.current);c.current=i==="mounted"?b:"none"},[i]),$2(()=>{const b=r.current,T=a.current;if(T!==e){const M=c.current,R=yE(b);e?v("MOUNT"):R==="none"||(b==null?void 0:b.display)==="none"?v("UNMOUNT"):v(T&&M!==R?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,v]),$2(()=>{if(t){let b;const T=t.ownerDocument.defaultView??window,A=R=>{const L=yE(r.current).includes(R.animationName);if(R.target===t&&L&&(v("ANIMATION_END"),!a.current)){const j=t.style.animationFillMode;t.style.animationFillMode="forwards",b=T.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=j)})}},M=R=>{R.target===t&&(c.current=yE(r.current))};return t.addEventListener("animationstart",M),t.addEventListener("animationcancel",A),t.addEventListener("animationend",A),()=>{T.clearTimeout(b),t.removeEventListener("animationstart",M),t.removeEventListener("animationcancel",A),t.removeEventListener("animationend",A)}}else v("ANIMATION_END")},[t,v]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:X.useCallback(b=>{b&&(r.current=getComputedStyle(b)),n(b)},[])}}function yE(e){return(e==null?void 0:e.animationName)||"none"}function kge(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var nk=0;function Rge(){X.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??qU()),document.body.insertAdjacentElement("beforeend",e[1]??qU()),nk++,()=>{nk===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),nk--}},[])}function qU(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var $Z=xq(),rk=function(){},KP=X.forwardRef(function(e,t){var n=X.useRef(null),r=X.useState({onScrollCapture:rk,onWheelCapture:rk,onTouchMoveCapture:rk}),a=r[0],c=r[1],f=e.forwardProps,i=e.children,v=e.className,b=e.removeScrollBar,T=e.enabled,A=e.shards,M=e.sideCar,R=e.noIsolation,B=e.inert,L=e.allowPinchZoom,j=e.as,V=j===void 0?"div":j,$=e.gapMode,H=A3(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),K=M,Y=vq([n,t]),se=Ja(Ja({},H),a);return X.createElement(X.Fragment,null,T&&X.createElement(K,{sideCar:$Z,removeScrollBar:b,shards:A,noIsolation:R,inert:B,setCallbacks:c,allowPinchZoom:!!L,lockRef:n,gapMode:$}),f?X.cloneElement(X.Children.only(i),Ja(Ja({},se),{ref:Y})):X.createElement(V,Ja({},se,{className:v,ref:Y}),i))});KP.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};KP.classNames={fullWidth:R1,zeroRight:k1};var dD=!1;if(typeof window<"u")try{var _E=Object.defineProperty({},"passive",{get:function(){return dD=!0,!0}});window.addEventListener("test",_E,_E),window.removeEventListener("test",_E,_E)}catch{dD=!1}var Iy=dD?{passive:!1}:!1,Dge=function(e){return e.tagName==="TEXTAREA"},UZ=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Dge(e)&&n[t]==="visible")},Lge=function(e){return UZ(e,"overflowY")},zge=function(e){return UZ(e,"overflowX")},ZU=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=VZ(e,r);if(a){var c=GZ(e,r),f=c[1],i=c[2];if(f>i)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Nge=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Fge=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},VZ=function(e,t){return e==="v"?Lge(t):zge(t)},GZ=function(e,t){return e==="v"?Nge(t):Fge(t)},Bge=function(e,t){return e==="h"&&t==="rtl"?-1:1},jge=function(e,t,n,r,a){var c=Bge(e,window.getComputedStyle(t).direction),f=c*r,i=n.target,v=t.contains(i),b=!1,T=f>0,A=0,M=0;do{var R=GZ(e,i),B=R[0],L=R[1],j=R[2],V=L-j-c*B;(B||V)&&VZ(e,i)&&(A+=V,M+=B),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!v&&i!==document.body||v&&(t.contains(i)||t===i));return(T&&(Math.abs(A)<1||!a)||!T&&(Math.abs(M)<1||!a))&&(b=!0),b},vE=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},XU=function(e){return[e.deltaX,e.deltaY]},KU=function(e){return e&&"current"in e?e.current:e},$ge=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Uge=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Vge=0,My=[];function Gge(e){var t=X.useRef([]),n=X.useRef([0,0]),r=X.useRef(),a=X.useState(Vge++)[0],c=X.useState(P3)[0],f=X.useRef(e);X.useEffect(function(){f.current=e},[e]),X.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var L=_q([e.lockRef.current],(e.shards||[]).map(KU),!0).filter(Boolean);return L.forEach(function(j){return j.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),L.forEach(function(j){return j.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=X.useCallback(function(L,j){if("touches"in L&&L.touches.length===2||L.type==="wheel"&&L.ctrlKey)return!f.current.allowPinchZoom;var V=vE(L),$=n.current,H="deltaX"in L?L.deltaX:$[0]-V[0],K="deltaY"in L?L.deltaY:$[1]-V[1],Y,se=L.target,ce=Math.abs(H)>Math.abs(K)?"h":"v";if("touches"in L&&ce==="h"&&se.type==="range")return!1;var ye=ZU(ce,se);if(!ye)return!0;if(ye?Y=ce:(Y=ce==="v"?"h":"v",ye=ZU(ce,se)),!ye)return!1;if(!r.current&&"changedTouches"in L&&(H||K)&&(r.current=Y),!Y)return!0;var ze=r.current||Y;return jge(ze,j,L,ze==="h"?H:K,!0)},[]),v=X.useCallback(function(L){var j=L;if(!(!My.length||My[My.length-1]!==c)){var V="deltaY"in j?XU(j):vE(j),$=t.current.filter(function(Y){return Y.name===j.type&&(Y.target===j.target||j.target===Y.shadowParent)&&$ge(Y.delta,V)})[0];if($&&$.should){j.cancelable&&j.preventDefault();return}if(!$){var H=(f.current.shards||[]).map(KU).filter(Boolean).filter(function(Y){return Y.contains(j.target)}),K=H.length>0?i(j,H[0]):!f.current.noIsolation;K&&j.cancelable&&j.preventDefault()}}},[]),b=X.useCallback(function(L,j,V,$){var H={name:L,delta:j,target:V,should:$,shadowParent:Wge(V)};t.current.push(H),setTimeout(function(){t.current=t.current.filter(function(K){return K!==H})},1)},[]),T=X.useCallback(function(L){n.current=vE(L),r.current=void 0},[]),A=X.useCallback(function(L){b(L.type,XU(L),L.target,i(L,e.lockRef.current))},[]),M=X.useCallback(function(L){b(L.type,vE(L),L.target,i(L,e.lockRef.current))},[]);X.useEffect(function(){return My.push(c),e.setCallbacks({onScrollCapture:A,onWheelCapture:A,onTouchMoveCapture:M}),document.addEventListener("wheel",v,Iy),document.addEventListener("touchmove",v,Iy),document.addEventListener("touchstart",T,Iy),function(){My=My.filter(function(L){return L!==c}),document.removeEventListener("wheel",v,Iy),document.removeEventListener("touchmove",v,Iy),document.removeEventListener("touchstart",T,Iy)}},[]);var R=e.removeScrollBar,B=e.inert;return X.createElement(X.Fragment,null,B?X.createElement(c,{styles:Uge(a)}):null,R?X.createElement(Tq,{gapMode:e.gapMode}):null)}function Wge(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Hge=wq($Z,Gge);var WZ=X.forwardRef(function(e,t){return X.createElement(KP,Ja({},e,{ref:t,sideCar:Hge}))});WZ.classNames=KP.classNames;var V3="Dialog",[HZ,bZe]=tge(V3),[qge,Bc]=HZ(V3),qZ=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:c,modal:f=!0}=e,i=X.useRef(null),v=X.useRef(null),[b=!1,T]=oge({prop:r,defaultProp:a,onChange:c});return he.jsx(qge,{scope:t,triggerRef:i,contentRef:v,contentId:QO(),titleId:QO(),descriptionId:QO(),open:b,onOpenChange:T,onOpenToggle:X.useCallback(()=>T(A=>!A),[T]),modal:f,children:n})};qZ.displayName=V3;var ZZ="DialogTrigger",XZ=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Bc(ZZ,n),c=Jm(t,a.triggerRef);return he.jsx(Uh.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":H3(a.open),...r,ref:c,onClick:xf(e.onClick,a.onOpenToggle)})});XZ.displayName=ZZ;var G3="DialogPortal",[Zge,KZ]=HZ(G3,{forceMount:void 0}),YZ=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,c=Bc(G3,t);return he.jsx(Zge,{scope:t,forceMount:n,children:X.Children.map(r,f=>he.jsx(XP,{present:n||c.open,children:he.jsx(jZ,{asChild:!0,container:a,children:f})}))})};YZ.displayName=G3;var U2="DialogOverlay",JZ=X.forwardRef((e,t)=>{const n=KZ(U2,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,c=Bc(U2,e.__scopeDialog);return c.modal?he.jsx(XP,{present:r||c.open,children:he.jsx(Kge,{...a,ref:t})}):null});JZ.displayName=U2;var Xge=DZ("DialogOverlay.RemoveScroll"),Kge=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Bc(U2,n);return he.jsx(WZ,{as:Xge,allowPinchZoom:!0,shards:[a.contentRef],children:he.jsx(Uh.div,{"data-state":H3(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Om="DialogContent",QZ=X.forwardRef((e,t)=>{const n=KZ(Om,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,c=Bc(Om,e.__scopeDialog);return he.jsx(XP,{present:r||c.open,children:c.modal?he.jsx(Yge,{...a,ref:t}):he.jsx(Jge,{...a,ref:t})})});QZ.displayName=Om;var Yge=X.forwardRef((e,t)=>{const n=Bc(Om,e.__scopeDialog),r=X.useRef(null),a=Jm(t,n.contentRef,r);return X.useEffect(()=>{const c=r.current;if(c)return Aw(c)},[]),he.jsx(eX,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xf(e.onCloseAutoFocus,c=>{var f;c.preventDefault(),(f=n.triggerRef.current)==null||f.focus()}),onPointerDownOutside:xf(e.onPointerDownOutside,c=>{const f=c.detail.originalEvent,i=f.button===0&&f.ctrlKey===!0;(f.button===2||i)&&c.preventDefault()}),onFocusOutside:xf(e.onFocusOutside,c=>c.preventDefault())})}),Jge=X.forwardRef((e,t)=>{const n=Bc(Om,e.__scopeDialog),r=X.useRef(!1),a=X.useRef(!1);return he.jsx(eX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,c),c.defaultPrevented||(r.current||(i=n.triggerRef.current)==null||i.focus(),c.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:c=>{var v,b;(v=e.onInteractOutside)==null||v.call(e,c),c.defaultPrevented||(r.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=c.target;((b=n.triggerRef.current)==null?void 0:b.contains(f))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),eX=X.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:c,...f}=e,i=Bc(Om,n),v=X.useRef(null),b=Jm(t,v);return Rge(),he.jsxs(he.Fragment,{children:[he.jsx(FZ,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:c,children:he.jsx(zZ,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":H3(i.open),...f,ref:b,onDismiss:()=>i.onOpenChange(!1)})}),he.jsxs(he.Fragment,{children:[he.jsx(Qge,{titleId:i.titleId}),he.jsx(tye,{contentRef:v,descriptionId:i.descriptionId})]})]})}),W3="DialogTitle",tX=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Bc(W3,n);return he.jsx(Uh.h2,{id:a.titleId,...r,ref:t})});tX.displayName=W3;var nX="DialogDescription",rX=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Bc(nX,n);return he.jsx(Uh.p,{id:a.descriptionId,...r,ref:t})});rX.displayName=nX;var iX="DialogClose",oX=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Bc(iX,n);return he.jsx(Uh.button,{type:"button",...r,ref:t,onClick:xf(e.onClick,()=>a.onOpenChange(!1))})});oX.displayName=iX;function H3(e){return e?"open":"closed"}var aX="DialogTitleWarning",[wZe,sX]=ege(aX,{contentName:Om,titleName:W3,docsSlug:"dialog"}),Qge=({titleId:e})=>{const t=sX(aX),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return X.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},eye="DialogDescriptionWarning",tye=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${sX(eye).contentName}}.`;return X.useEffect(()=>{var c;const a=(c=e.current)==null?void 0:c.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},SZe=qZ,TZe=XZ,EZe=YZ,AZe=JZ,PZe=QZ,CZe=tX,IZe=rX,MZe=oX,nye="Label",lX=X.forwardRef((e,t)=>he.jsx(Qn.label,{...e,ref:t,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));lX.displayName=nye;var OZe=lX,q3="Tabs",[rye,kZe]=qs(q3,[GP]),cX=GP(),[iye,Z3]=rye(q3),uX=X.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:c,orientation:f="horizontal",dir:i,activationMode:v="automatic",...b}=e,T=bv(i),[A,M]=ys({prop:r,onChange:a,defaultProp:c});return he.jsx(iye,{scope:n,baseId:Qa(),value:A,onValueChange:M,orientation:f,dir:T,activationMode:v,children:he.jsx(Qn.div,{dir:T,"data-orientation":f,...b,ref:t})})});uX.displayName=q3;var hX="TabsList",dX=X.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,c=Z3(hX,n),f=cX(n);return he.jsx(mq,{asChild:!0,...f,orientation:c.orientation,dir:c.dir,loop:r,children:he.jsx(Qn.div,{role:"tablist","aria-orientation":c.orientation,...a,ref:t})})});dX.displayName=hX;var fX="TabsTrigger",pX=X.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...c}=e,f=Z3(fX,n),i=cX(n),v=yX(f.baseId,r),b=_X(f.baseId,r),T=r===f.value;return he.jsx(gq,{asChild:!0,...i,focusable:!a,active:T,children:he.jsx(Qn.button,{type:"button",role:"tab","aria-selected":T,"aria-controls":b,"data-state":T?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:v,...c,ref:t,onMouseDown:vn(e.onMouseDown,A=>{!a&&A.button===0&&A.ctrlKey===!1?f.onValueChange(r):A.preventDefault()}),onKeyDown:vn(e.onKeyDown,A=>{[" ","Enter"].includes(A.key)&&f.onValueChange(r)}),onFocus:vn(e.onFocus,()=>{const A=f.activationMode!=="manual";!T&&!a&&A&&f.onValueChange(r)})})})});pX.displayName=fX;var mX="TabsContent",gX=X.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:c,...f}=e,i=Z3(mX,n),v=yX(i.baseId,r),b=_X(i.baseId,r),T=r===i.value,A=X.useRef(T);return X.useEffect(()=>{const M=requestAnimationFrame(()=>A.current=!1);return()=>cancelAnimationFrame(M)},[]),he.jsx(wa,{present:a||T,children:({present:M})=>he.jsx(Qn.div,{"data-state":T?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":v,hidden:!M,id:b,tabIndex:0,...f,ref:t,style:{...e.style,animationDuration:A.current?"0s":void 0},children:M&&c})})});gX.displayName=mX;function yX(e,t){return`${e}-trigger-${t}`}function _X(e,t){return`${e}-content-${t}`}var RZe=uX,DZe=dX,LZe=pX,zZe=gX,oye="Separator",YU="horizontal",aye=["horizontal","vertical"],vX=X.forwardRef((e,t)=>{const{decorative:n,orientation:r=YU,...a}=e,c=sye(r)?r:YU,i=n?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return he.jsx(Qn.div,{"data-orientation":c,...i,...a,ref:t})});vX.displayName=oye;function sye(e){return aye.includes(e)}var NZe=vX,X3="Popover",[xX,FZe]=qs(X3,[Vf]),Mw=Vf(),[lye,Gf]=xX(X3),bX=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:c,modal:f=!1}=e,i=Mw(t),v=X.useRef(null),[b,T]=X.useState(!1),[A=!1,M]=ys({prop:r,defaultProp:a,onChange:c});return he.jsx(jP,{...i,children:he.jsx(lye,{scope:t,contentId:Qa(),triggerRef:v,open:A,onOpenChange:M,onOpenToggle:X.useCallback(()=>M(R=>!R),[M]),hasCustomAnchor:b,onCustomAnchorAdd:X.useCallback(()=>T(!0),[]),onCustomAnchorRemove:X.useCallback(()=>T(!1),[]),modal:f,children:n})})};bX.displayName=X3;var wX="PopoverAnchor",cye=X.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Gf(wX,n),c=Mw(n),{onCustomAnchorAdd:f,onCustomAnchorRemove:i}=a;return X.useEffect(()=>(f(),()=>i()),[f,i]),he.jsx(Tw,{...c,...r,ref:t})});cye.displayName=wX;var SX="PopoverTrigger",TX=X.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Gf(SX,n),c=Mw(n),f=qr(t,a.triggerRef),i=he.jsx(Qn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":IX(a.open),...r,ref:f,onClick:vn(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:he.jsx(Tw,{asChild:!0,...c,children:i})});TX.displayName=SX;var K3="PopoverPortal",[uye,hye]=xX(K3,{forceMount:void 0}),EX=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,c=Gf(K3,t);return he.jsx(uye,{scope:t,forceMount:n,children:he.jsx(wa,{present:n||c.open,children:he.jsx(Ew,{asChild:!0,container:a,children:r})})})};EX.displayName=K3;var C_="PopoverContent",AX=X.forwardRef((e,t)=>{const n=hye(C_,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,c=Gf(C_,e.__scopePopover);return he.jsx(wa,{present:r||c.open,children:c.modal?he.jsx(dye,{...a,ref:t}):he.jsx(fye,{...a,ref:t})})});AX.displayName=C_;var dye=X.forwardRef((e,t)=>{const n=Gf(C_,e.__scopePopover),r=X.useRef(null),a=qr(t,r),c=X.useRef(!1);return X.useEffect(()=>{const f=r.current;if(f)return Aw(f)},[]),he.jsx(Pw,{as:Pf,allowPinchZoom:!0,children:he.jsx(PX,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:vn(e.onCloseAutoFocus,f=>{var i;f.preventDefault(),c.current||(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:vn(e.onPointerDownOutside,f=>{const i=f.detail.originalEvent,v=i.button===0&&i.ctrlKey===!0,b=i.button===2||v;c.current=b},{checkForDefaultPrevented:!1}),onFocusOutside:vn(e.onFocusOutside,f=>f.preventDefault(),{checkForDefaultPrevented:!1})})})}),fye=X.forwardRef((e,t)=>{const n=Gf(C_,e.__scopePopover),r=X.useRef(!1),a=X.useRef(!1);return he.jsx(PX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,c),c.defaultPrevented||(r.current||(i=n.triggerRef.current)==null||i.focus(),c.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:c=>{var v,b;(v=e.onInteractOutside)==null||v.call(e,c),c.defaultPrevented||(r.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=c.target;((b=n.triggerRef.current)==null?void 0:b.contains(f))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),PX=X.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:c,disableOutsidePointerEvents:f,onEscapeKeyDown:i,onPointerDownOutside:v,onFocusOutside:b,onInteractOutside:T,...A}=e,M=Gf(C_,n),R=Mw(n);return zP(),he.jsx(ww,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:c,children:he.jsx(Xm,{asChild:!0,disableOutsidePointerEvents:f,onInteractOutside:T,onEscapeKeyDown:i,onPointerDownOutside:v,onFocusOutside:b,onDismiss:()=>M.onOpenChange(!1),children:he.jsx($P,{"data-state":IX(M.open),role:"dialog",id:M.contentId,...R,...A,ref:t,style:{...A.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),CX="PopoverClose",pye=X.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Gf(CX,n);return he.jsx(Qn.button,{type:"button",...r,ref:t,onClick:vn(e.onClick,()=>a.onOpenChange(!1))})});pye.displayName=CX;var mye="PopoverArrow",gye=X.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Mw(n);return he.jsx(UP,{...a,...r,ref:t})});gye.displayName=mye;function IX(e){return e?"open":"closed"}var BZe=bX,jZe=TX,$Ze=EX,UZe=AX;function Dr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Hs(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function us(e,t){const n=Dr(e);return isNaN(t)?Hs(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function zc(e,t){const n=Dr(e);if(isNaN(t))return Hs(e,NaN);if(!t)return n;const r=n.getDate(),a=Hs(e,n.getTime());a.setMonth(n.getMonth()+t+1,0);const c=a.getDate();return r>=c?a:(n.setFullYear(a.getFullYear(),a.getMonth(),r),n)}const Y3=6048e5,yye=864e5,xE=43200,JU=1440;let _ye={};function Ev(){return _ye}function Su(e,t){var i,v,b,T;const n=Ev(),r=(t==null?void 0:t.weekStartsOn)??((v=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:v.weekStartsOn)??n.weekStartsOn??((T=(b=n.locale)==null?void 0:b.options)==null?void 0:T.weekStartsOn)??0,a=Dr(e),c=a.getDay(),f=(c<r?7:0)+c-r;return a.setDate(a.getDate()-f),a.setHours(0,0,0,0),a}function km(e){return Su(e,{weekStartsOn:1})}function MX(e){const t=Dr(e),n=t.getFullYear(),r=Hs(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const a=km(r),c=Hs(e,0);c.setFullYear(n,0,4),c.setHours(0,0,0,0);const f=km(c);return t.getTime()>=a.getTime()?n+1:t.getTime()>=f.getTime()?n:n-1}function I_(e){const t=Dr(e);return t.setHours(0,0,0,0),t}function M_(e){const t=Dr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function fu(e,t){const n=I_(e),r=I_(t),a=+n-M_(n),c=+r-M_(r);return Math.round((a-c)/yye)}function vye(e){const t=MX(e),n=Hs(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),km(n)}function fD(e,t){const n=t*7;return us(e,n)}function xye(e,t){return zc(e,t*12)}function bye(e){let t;return e.forEach(function(n){const r=Dr(n);(t===void 0||t<r||isNaN(Number(r)))&&(t=r)}),t||new Date(NaN)}function wye(e){let t;return e.forEach(n=>{const r=Dr(n);(!t||t>r||isNaN(+r))&&(t=r)}),t||new Date(NaN)}function JE(e,t){const n=Dr(e),r=Dr(t),a=n.getTime()-r.getTime();return a<0?-1:a>0?1:a}function Sye(e){return Hs(e,Date.now())}function js(e,t){const n=I_(e),r=I_(t);return+n==+r}function J3(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Tye(e){if(!J3(e)&&typeof e!="number")return!1;const t=Dr(e);return!isNaN(Number(t))}function O_(e,t){const n=Dr(e),r=Dr(t),a=n.getFullYear()-r.getFullYear(),c=n.getMonth()-r.getMonth();return a*12+c}function Eye(e,t,n){const r=Su(e,n),a=Su(t,n),c=+r-M_(r),f=+a-M_(a);return Math.round((c-f)/Y3)}function Aye(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function Pye(e,t){return+Dr(e)-+Dr(t)}function Cye(e){const t=Dr(e);return t.setHours(23,59,59,999),t}function YP(e){const t=Dr(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Iye(e){const t=Dr(e);return+Cye(t)==+YP(t)}function Mye(e,t){const n=Dr(e),r=Dr(t),a=JE(n,r),c=Math.abs(O_(n,r));let f;if(c<1)f=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*c);let i=JE(n,r)===-a;Iye(Dr(e))&&c===1&&JE(e,r)===1&&(i=!1),f=a*(c-Number(i))}return f===0?0:f}function Oye(e,t,n){const r=Pye(e,t)/1e3;return Aye(n==null?void 0:n.roundingMethod)(r)}function Ws(e){const t=Dr(e);return t.setDate(1),t.setHours(0,0,0,0),t}function OX(e){const t=Dr(e),n=Hs(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Q3(e,t){var i,v,b,T;const n=Ev(),r=(t==null?void 0:t.weekStartsOn)??((v=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:v.weekStartsOn)??n.weekStartsOn??((T=(b=n.locale)==null?void 0:b.options)==null?void 0:T.weekStartsOn)??0,a=Dr(e),c=a.getDay(),f=(c<r?-7:0)+6-(c-r);return a.setDate(a.getDate()+f),a.setHours(23,59,59,999),a}function kX(e){return Q3(e,{weekStartsOn:1})}const kye={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Rye=(e,t,n)=>{let r;const a=kye[e];return typeof a=="string"?r=a:t===1?r=a.one:r=a.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function ik(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const Dye={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Lye={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},zye={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Nye={date:ik({formats:Dye,defaultWidth:"full"}),time:ik({formats:Lye,defaultWidth:"full"}),dateTime:ik({formats:zye,defaultWidth:"full"})},Fye={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Bye=(e,t,n,r)=>Fye[e];function Hx(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const f=e.defaultFormattingWidth||e.defaultWidth,i=n!=null&&n.width?String(n.width):f;a=e.formattingValues[i]||e.formattingValues[f]}else{const f=e.defaultWidth,i=n!=null&&n.width?String(n.width):e.defaultWidth;a=e.values[i]||e.values[f]}const c=e.argumentCallback?e.argumentCallback(t):t;return a[c]}}const jye={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},$ye={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Uye={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Vye={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Gye={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Wye={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Hye=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},qye={ordinalNumber:Hye,era:Hx({values:jye,defaultWidth:"wide"}),quarter:Hx({values:$ye,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Hx({values:Uye,defaultWidth:"wide"}),day:Hx({values:Vye,defaultWidth:"wide"}),dayPeriod:Hx({values:Gye,defaultWidth:"wide",formattingValues:Wye,defaultFormattingWidth:"wide"})};function qx(e){return(t,n={})=>{const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],c=t.match(a);if(!c)return null;const f=c[0],i=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],v=Array.isArray(i)?Xye(i,A=>A.test(f)):Zye(i,A=>A.test(f));let b;b=e.valueCallback?e.valueCallback(v):v,b=n.valueCallback?n.valueCallback(b):b;const T=t.slice(f.length);return{value:b,rest:T}}}function Zye(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Xye(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Kye(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const a=r[0],c=t.match(e.parsePattern);if(!c)return null;let f=e.valueCallback?e.valueCallback(c[0]):c[0];f=n.valueCallback?n.valueCallback(f):f;const i=t.slice(a.length);return{value:f,rest:i}}}const Yye=/^(\d+)(th|st|nd|rd)?/i,Jye=/\d+/i,Qye={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},e_e={any:[/^b/i,/^(a|c)/i]},t_e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},n_e={any:[/1/i,/2/i,/3/i,/4/i]},r_e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},i_e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},o_e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},a_e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},s_e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},l_e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},c_e={ordinalNumber:Kye({matchPattern:Yye,parsePattern:Jye,valueCallback:e=>parseInt(e,10)}),era:qx({matchPatterns:Qye,defaultMatchWidth:"wide",parsePatterns:e_e,defaultParseWidth:"any"}),quarter:qx({matchPatterns:t_e,defaultMatchWidth:"wide",parsePatterns:n_e,defaultParseWidth:"any",valueCallback:e=>e+1}),month:qx({matchPatterns:r_e,defaultMatchWidth:"wide",parsePatterns:i_e,defaultParseWidth:"any"}),day:qx({matchPatterns:o_e,defaultMatchWidth:"wide",parsePatterns:a_e,defaultParseWidth:"any"}),dayPeriod:qx({matchPatterns:s_e,defaultMatchWidth:"any",parsePatterns:l_e,defaultParseWidth:"any"})},eN={code:"en-US",formatDistance:Rye,formatLong:Nye,formatRelative:Bye,localize:qye,match:c_e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function u_e(e){const t=Dr(e);return fu(t,OX(t))+1}function RX(e){const t=Dr(e),n=+km(t)-+vye(t);return Math.round(n/Y3)+1}function DX(e,t){var T,A,M,R;const n=Dr(e),r=n.getFullYear(),a=Ev(),c=(t==null?void 0:t.firstWeekContainsDate)??((A=(T=t==null?void 0:t.locale)==null?void 0:T.options)==null?void 0:A.firstWeekContainsDate)??a.firstWeekContainsDate??((R=(M=a.locale)==null?void 0:M.options)==null?void 0:R.firstWeekContainsDate)??1,f=Hs(e,0);f.setFullYear(r+1,0,c),f.setHours(0,0,0,0);const i=Su(f,t),v=Hs(e,0);v.setFullYear(r,0,c),v.setHours(0,0,0,0);const b=Su(v,t);return n.getTime()>=i.getTime()?r+1:n.getTime()>=b.getTime()?r:r-1}function h_e(e,t){var i,v,b,T;const n=Ev(),r=(t==null?void 0:t.firstWeekContainsDate)??((v=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:v.firstWeekContainsDate)??n.firstWeekContainsDate??((T=(b=n.locale)==null?void 0:b.options)==null?void 0:T.firstWeekContainsDate)??1,a=DX(e,t),c=Hs(e,0);return c.setFullYear(a,0,r),c.setHours(0,0,0,0),Su(c,t)}function LX(e,t){const n=Dr(e),r=+Su(n,t)-+h_e(n,t);return Math.round(r/Y3)+1}function Vi(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Vd={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Vi(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Vi(n+1,2)},d(e,t){return Vi(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Vi(e.getHours()%12||12,t.length)},H(e,t){return Vi(e.getHours(),t.length)},m(e,t){return Vi(e.getMinutes(),t.length)},s(e,t){return Vi(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return Vi(a,t.length)}},Oy={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},QU={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return Vd.y(e,t)},Y:function(e,t,n,r){const a=DX(e,r),c=a>0?a:1-a;if(t==="YY"){const f=c%100;return Vi(f,2)}return t==="Yo"?n.ordinalNumber(c,{unit:"year"}):Vi(c,t.length)},R:function(e,t){const n=MX(e);return Vi(n,t.length)},u:function(e,t){const n=e.getFullYear();return Vi(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Vi(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Vi(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Vd.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Vi(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const a=LX(e,r);return t==="wo"?n.ordinalNumber(a,{unit:"week"}):Vi(a,t.length)},I:function(e,t,n){const r=RX(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):Vi(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Vd.d(e,t)},D:function(e,t,n){const r=u_e(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Vi(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const a=e.getDay(),c=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(c);case"ee":return Vi(c,2);case"eo":return n.ordinalNumber(c,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const a=e.getDay(),c=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(c);case"cc":return Vi(c,t.length);case"co":return n.ordinalNumber(c,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),a=r===0?7:r;switch(t){case"i":return String(a);case"ii":return Vi(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let a;switch(r===12?a=Oy.noon:r===0?a=Oy.midnight:a=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let a;switch(r>=17?a=Oy.evening:r>=12?a=Oy.afternoon:r>=4?a=Oy.morning:a=Oy.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Vd.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Vd.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Vi(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):Vi(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Vd.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Vd.s(e,t)},S:function(e,t){return Vd.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return tV(r);case"XXXX":case"XX":return im(r);case"XXXXX":case"XXX":default:return im(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return tV(r);case"xxxx":case"xx":return im(r);case"xxxxx":case"xxx":default:return im(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+eV(r,":");case"OOOO":default:return"GMT"+im(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+eV(r,":");case"zzzz":default:return"GMT"+im(r,":")}},t:function(e,t,n){const r=Math.trunc(e.getTime()/1e3);return Vi(r,t.length)},T:function(e,t,n){const r=e.getTime();return Vi(r,t.length)}};function eV(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),c=r%60;return c===0?n+String(a):n+String(a)+t+Vi(c,2)}function tV(e,t){return e%60===0?(e>0?"-":"+")+Vi(Math.abs(e)/60,2):im(e,t)}function im(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=Vi(Math.trunc(r/60),2),c=Vi(r%60,2);return n+a+t+c}const nV=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},zX=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},d_e=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return nV(e,t);let c;switch(r){case"P":c=t.dateTime({width:"short"});break;case"PP":c=t.dateTime({width:"medium"});break;case"PPP":c=t.dateTime({width:"long"});break;case"PPPP":default:c=t.dateTime({width:"full"});break}return c.replace("{{date}}",nV(r,t)).replace("{{time}}",zX(a,t))},f_e={p:zX,P:d_e},p_e=/^D+$/,m_e=/^Y+$/,g_e=["D","DD","YY","YYYY"];function y_e(e){return p_e.test(e)}function __e(e){return m_e.test(e)}function v_e(e,t,n){const r=x_e(e,t,n);if(console.warn(r),g_e.includes(e))throw new RangeError(r)}function x_e(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const b_e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,w_e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,S_e=/^'([^]*?)'?$/,T_e=/''/g,E_e=/[a-zA-Z]/;function Qm(e,t,n){var T,A,M,R,B,L,j,V;const r=Ev(),a=(n==null?void 0:n.locale)??r.locale??eN,c=(n==null?void 0:n.firstWeekContainsDate)??((A=(T=n==null?void 0:n.locale)==null?void 0:T.options)==null?void 0:A.firstWeekContainsDate)??r.firstWeekContainsDate??((R=(M=r.locale)==null?void 0:M.options)==null?void 0:R.firstWeekContainsDate)??1,f=(n==null?void 0:n.weekStartsOn)??((L=(B=n==null?void 0:n.locale)==null?void 0:B.options)==null?void 0:L.weekStartsOn)??r.weekStartsOn??((V=(j=r.locale)==null?void 0:j.options)==null?void 0:V.weekStartsOn)??0,i=Dr(e);if(!Tye(i))throw new RangeError("Invalid time value");let v=t.match(w_e).map($=>{const H=$[0];if(H==="p"||H==="P"){const K=f_e[H];return K($,a.formatLong)}return $}).join("").match(b_e).map($=>{if($==="''")return{isToken:!1,value:"'"};const H=$[0];if(H==="'")return{isToken:!1,value:A_e($)};if(QU[H])return{isToken:!0,value:$};if(H.match(E_e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+H+"`");return{isToken:!1,value:$}});a.localize.preprocessor&&(v=a.localize.preprocessor(i,v));const b={firstWeekContainsDate:c,weekStartsOn:f,locale:a};return v.map($=>{if(!$.isToken)return $.value;const H=$.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&__e(H)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&y_e(H))&&v_e(H,t,String(e));const K=QU[H[0]];return K(i,H,a.localize,b)}).join("")}function A_e(e){const t=e.match(S_e);return t?t[1].replace(T_e,"'"):e}function P_e(e,t,n){const r=Ev(),a=(n==null?void 0:n.locale)??r.locale??eN,c=2520,f=JE(e,t);if(isNaN(f))throw new RangeError("Invalid time value");const i=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:f});let v,b;f>0?(v=Dr(t),b=Dr(e)):(v=Dr(e),b=Dr(t));const T=Oye(b,v),A=(M_(b)-M_(v))/1e3,M=Math.round((T-A)/60);let R;if(M<2)return n!=null&&n.includeSeconds?T<5?a.formatDistance("lessThanXSeconds",5,i):T<10?a.formatDistance("lessThanXSeconds",10,i):T<20?a.formatDistance("lessThanXSeconds",20,i):T<40?a.formatDistance("halfAMinute",0,i):T<60?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",1,i):M===0?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",M,i);if(M<45)return a.formatDistance("xMinutes",M,i);if(M<90)return a.formatDistance("aboutXHours",1,i);if(M<JU){const B=Math.round(M/60);return a.formatDistance("aboutXHours",B,i)}else{if(M<c)return a.formatDistance("xDays",1,i);if(M<xE){const B=Math.round(M/JU);return a.formatDistance("xDays",B,i)}else if(M<xE*2)return R=Math.round(M/xE),a.formatDistance("aboutXMonths",R,i)}if(R=Mye(b,v),R<12){const B=Math.round(M/xE);return a.formatDistance("xMonths",B,i)}else{const B=R%12,L=Math.trunc(R/12);return B<3?a.formatDistance("aboutXYears",L,i):B<9?a.formatDistance("overXYears",L,i):a.formatDistance("almostXYears",L+1,i)}}function VZe(e,t){return P_e(e,Sye(e),t)}function C_e(e){const t=Dr(e),n=t.getFullYear(),r=t.getMonth(),a=Hs(e,0);return a.setFullYear(n,r+1,0),a.setHours(0,0,0,0),a.getDate()}function I_e(e){return Math.trunc(+Dr(e)/1e3)}function M_e(e){const t=Dr(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function O_e(e,t){return Eye(M_e(e),Ws(e),t)+1}function pD(e,t){const n=Dr(e),r=Dr(t);return n.getTime()>r.getTime()}function NX(e,t){const n=Dr(e),r=Dr(t);return+n<+r}function tN(e,t){const n=Dr(e),r=Dr(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function k_e(e,t){const n=Dr(e),r=Dr(t);return n.getFullYear()===r.getFullYear()}function ok(e,t){return us(e,-t)}function ak(e,t){const n=Dr(e),r=n.getFullYear(),a=n.getDate(),c=Hs(e,0);c.setFullYear(r,t,15),c.setHours(0,0,0,0);const f=C_e(c);return n.setMonth(t,Math.min(a,f)),n}function rV(e,t){const n=Dr(e);return isNaN(+n)?Hs(e,NaN):(n.setFullYear(t),n)}var Pr=function(){return Pr=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c])}return t},Pr.apply(this,arguments)};function R_e(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function FX(e,t,n){for(var r=0,a=t.length,c;r<a;r++)(c||!(r in t))&&(c||(c=Array.prototype.slice.call(t,0,r)),c[r]=t[r]);return e.concat(c||Array.prototype.slice.call(t))}function Ow(e){return e.mode==="multiple"}function kw(e){return e.mode==="range"}function JP(e){return e.mode==="single"}var D_e={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function L_e(e,t){return Qm(e,"LLLL y",t)}function z_e(e,t){return Qm(e,"d",t)}function N_e(e,t){return Qm(e,"LLLL",t)}function F_e(e){return"".concat(e)}function B_e(e,t){return Qm(e,"cccccc",t)}function j_e(e,t){return Qm(e,"yyyy",t)}var $_e=Object.freeze({__proto__:null,formatCaption:L_e,formatDay:z_e,formatMonthCaption:N_e,formatWeekNumber:F_e,formatWeekdayName:B_e,formatYearCaption:j_e}),U_e=function(e,t,n){return Qm(e,"do MMMM (EEEE)",n)},V_e=function(){return"Month: "},G_e=function(){return"Go to next month"},W_e=function(){return"Go to previous month"},H_e=function(e,t){return Qm(e,"cccc",t)},q_e=function(e){return"Week n. ".concat(e)},Z_e=function(){return"Year: "},X_e=Object.freeze({__proto__:null,labelDay:U_e,labelMonthDropdown:V_e,labelNext:G_e,labelPrevious:W_e,labelWeekNumber:q_e,labelWeekday:H_e,labelYearDropdown:Z_e});function K_e(){var e="buttons",t=D_e,n=eN,r={},a={},c=1,f={},i=new Date;return{captionLayout:e,classNames:t,formatters:$_e,labels:X_e,locale:n,modifiersClassNames:r,modifiers:a,numberOfMonths:c,styles:f,today:i,mode:"default"}}function Y_e(e){var t=e.fromYear,n=e.toYear,r=e.fromMonth,a=e.toMonth,c=e.fromDate,f=e.toDate;return r?c=Ws(r):t&&(c=new Date(t,0,1)),a?f=YP(a):n&&(f=new Date(n,11,31)),{fromDate:c?I_(c):void 0,toDate:f?I_(f):void 0}}var BX=X.createContext(void 0);function J_e(e){var t,n=e.initialProps,r=K_e(),a=Y_e(n),c=a.fromDate,f=a.toDate,i=(t=n.captionLayout)!==null&&t!==void 0?t:r.captionLayout;i!=="buttons"&&(!c||!f)&&(i="buttons");var v;(JP(n)||Ow(n)||kw(n))&&(v=n.onSelect);var b=Pr(Pr(Pr({},r),n),{captionLayout:i,classNames:Pr(Pr({},r.classNames),n.classNames),components:Pr({},n.components),formatters:Pr(Pr({},r.formatters),n.formatters),fromDate:c,labels:Pr(Pr({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:Pr(Pr({},r.modifiers),n.modifiers),modifiersClassNames:Pr(Pr({},r.modifiersClassNames),n.modifiersClassNames),onSelect:v,styles:Pr(Pr({},r.styles),n.styles),toDate:f});return he.jsx(BX.Provider,{value:b,children:e.children})}function ao(){var e=X.useContext(BX);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function jX(e){var t=ao(),n=t.locale,r=t.classNames,a=t.styles,c=t.formatters.formatCaption;return he.jsx("div",{className:r.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:c(e.displayMonth,{locale:n})})}function Q_e(e){return he.jsx("svg",Pr({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:he.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function $X(e){var t,n,r=e.onChange,a=e.value,c=e.children,f=e.caption,i=e.className,v=e.style,b=ao(),T=(n=(t=b.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:Q_e;return he.jsxs("div",{className:i,style:v,children:[he.jsx("span",{className:b.classNames.vhidden,children:e["aria-label"]}),he.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:b.classNames.dropdown,style:b.styles.dropdown,value:a,onChange:r,children:c}),he.jsxs("div",{className:b.classNames.caption_label,style:b.styles.caption_label,"aria-hidden":"true",children:[f,he.jsx(T,{className:b.classNames.dropdown_icon,style:b.styles.dropdown_icon})]})]})}function eve(e){var t,n=ao(),r=n.fromDate,a=n.toDate,c=n.styles,f=n.locale,i=n.formatters.formatMonthCaption,v=n.classNames,b=n.components,T=n.labels.labelMonthDropdown;if(!r)return he.jsx(he.Fragment,{});if(!a)return he.jsx(he.Fragment,{});var A=[];if(k_e(r,a))for(var M=Ws(r),R=r.getMonth();R<=a.getMonth();R++)A.push(ak(M,R));else for(var M=Ws(new Date),R=0;R<=11;R++)A.push(ak(M,R));var B=function(j){var V=Number(j.target.value),$=ak(Ws(e.displayMonth),V);e.onChange($)},L=(t=b==null?void 0:b.Dropdown)!==null&&t!==void 0?t:$X;return he.jsx(L,{name:"months","aria-label":T(),className:v.dropdown_month,style:c.dropdown_month,onChange:B,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:f}),children:A.map(function(j){return he.jsx("option",{value:j.getMonth(),children:i(j,{locale:f})},j.getMonth())})})}function tve(e){var t,n=e.displayMonth,r=ao(),a=r.fromDate,c=r.toDate,f=r.locale,i=r.styles,v=r.classNames,b=r.components,T=r.formatters.formatYearCaption,A=r.labels.labelYearDropdown,M=[];if(!a)return he.jsx(he.Fragment,{});if(!c)return he.jsx(he.Fragment,{});for(var R=a.getFullYear(),B=c.getFullYear(),L=R;L<=B;L++)M.push(rV(OX(new Date),L));var j=function($){var H=rV(Ws(n),Number($.target.value));e.onChange(H)},V=(t=b==null?void 0:b.Dropdown)!==null&&t!==void 0?t:$X;return he.jsx(V,{name:"years","aria-label":A(),className:v.dropdown_year,style:i.dropdown_year,onChange:j,value:n.getFullYear(),caption:T(n,{locale:f}),children:M.map(function($){return he.jsx("option",{value:$.getFullYear(),children:T($,{locale:f})},$.getFullYear())})})}function nve(e,t){var n=X.useState(e),r=n[0],a=n[1],c=t===void 0?r:t;return[c,a]}function rve(e){var t=e.month,n=e.defaultMonth,r=e.today,a=t||n||r||new Date,c=e.toDate,f=e.fromDate,i=e.numberOfMonths,v=i===void 0?1:i;if(c&&O_(c,a)<0){var b=-1*(v-1);a=zc(c,b)}return f&&O_(a,f)<0&&(a=f),Ws(a)}function ive(){var e=ao(),t=rve(e),n=nve(t,e.month),r=n[0],a=n[1],c=function(f){var i;if(!e.disableNavigation){var v=Ws(f);a(v),(i=e.onMonthChange)===null||i===void 0||i.call(e,v)}};return[r,c]}function ove(e,t){for(var n=t.reverseMonths,r=t.numberOfMonths,a=Ws(e),c=Ws(zc(a,r)),f=O_(c,a),i=[],v=0;v<f;v++){var b=zc(a,v);i.push(b)}return n&&(i=i.reverse()),i}function ave(e,t){if(!t.disableNavigation){var n=t.toDate,r=t.pagedNavigation,a=t.numberOfMonths,c=a===void 0?1:a,f=r?c:1,i=Ws(e);if(!n)return zc(i,f);var v=O_(n,e);if(!(v<c))return zc(i,f)}}function sve(e,t){if(!t.disableNavigation){var n=t.fromDate,r=t.pagedNavigation,a=t.numberOfMonths,c=a===void 0?1:a,f=r?c:1,i=Ws(e);if(!n)return zc(i,-f);var v=O_(i,n);if(!(v<=0))return zc(i,-f)}}var UX=X.createContext(void 0);function lve(e){var t=ao(),n=ive(),r=n[0],a=n[1],c=ove(r,t),f=ave(r,t),i=sve(r,t),v=function(A){return c.some(function(M){return tN(A,M)})},b=function(A,M){v(A)||(M&&NX(A,M)?a(zc(A,1+t.numberOfMonths*-1)):a(A))},T={currentMonth:r,displayMonths:c,goToMonth:a,goToDate:b,previousMonth:i,nextMonth:f,isDateDisplayed:v};return he.jsx(UX.Provider,{value:T,children:e.children})}function Rw(){var e=X.useContext(UX);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function iV(e){var t,n=ao(),r=n.classNames,a=n.styles,c=n.components,f=Rw().goToMonth,i=function(T){f(zc(T,e.displayIndex?-e.displayIndex:0))},v=(t=c==null?void 0:c.CaptionLabel)!==null&&t!==void 0?t:jX,b=he.jsx(v,{id:e.id,displayMonth:e.displayMonth});return he.jsxs("div",{className:r.caption_dropdowns,style:a.caption_dropdowns,children:[he.jsx("div",{className:r.vhidden,children:b}),he.jsx(eve,{onChange:i,displayMonth:e.displayMonth}),he.jsx(tve,{onChange:i,displayMonth:e.displayMonth})]})}function cve(e){return he.jsx("svg",Pr({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:he.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function uve(e){return he.jsx("svg",Pr({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:he.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var V2=X.forwardRef(function(e,t){var n=ao(),r=n.classNames,a=n.styles,c=[r.button_reset,r.button];e.className&&c.push(e.className);var f=c.join(" "),i=Pr(Pr({},a.button_reset),a.button);return e.style&&Object.assign(i,e.style),he.jsx("button",Pr({},e,{ref:t,type:"button",className:f,style:i}))});function hve(e){var t,n,r=ao(),a=r.dir,c=r.locale,f=r.classNames,i=r.styles,v=r.labels,b=v.labelPrevious,T=v.labelNext,A=r.components;if(!e.nextMonth&&!e.previousMonth)return he.jsx(he.Fragment,{});var M=b(e.previousMonth,{locale:c}),R=[f.nav_button,f.nav_button_previous].join(" "),B=T(e.nextMonth,{locale:c}),L=[f.nav_button,f.nav_button_next].join(" "),j=(t=A==null?void 0:A.IconRight)!==null&&t!==void 0?t:uve,V=(n=A==null?void 0:A.IconLeft)!==null&&n!==void 0?n:cve;return he.jsxs("div",{className:f.nav,style:i.nav,children:[!e.hidePrevious&&he.jsx(V2,{name:"previous-month","aria-label":M,className:R,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?he.jsx(j,{className:f.nav_icon,style:i.nav_icon}):he.jsx(V,{className:f.nav_icon,style:i.nav_icon})}),!e.hideNext&&he.jsx(V2,{name:"next-month","aria-label":B,className:L,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?he.jsx(V,{className:f.nav_icon,style:i.nav_icon}):he.jsx(j,{className:f.nav_icon,style:i.nav_icon})})]})}function oV(e){var t=ao().numberOfMonths,n=Rw(),r=n.previousMonth,a=n.nextMonth,c=n.goToMonth,f=n.displayMonths,i=f.findIndex(function(B){return tN(e.displayMonth,B)}),v=i===0,b=i===f.length-1,T=t>1&&(v||!b),A=t>1&&(b||!v),M=function(){r&&c(r)},R=function(){a&&c(a)};return he.jsx(hve,{displayMonth:e.displayMonth,hideNext:T,hidePrevious:A,nextMonth:a,previousMonth:r,onPreviousClick:M,onNextClick:R})}function dve(e){var t,n=ao(),r=n.classNames,a=n.disableNavigation,c=n.styles,f=n.captionLayout,i=n.components,v=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:jX,b;return a?b=he.jsx(v,{id:e.id,displayMonth:e.displayMonth}):f==="dropdown"?b=he.jsx(iV,{displayMonth:e.displayMonth,id:e.id}):f==="dropdown-buttons"?b=he.jsxs(he.Fragment,{children:[he.jsx(iV,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),he.jsx(oV,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):b=he.jsxs(he.Fragment,{children:[he.jsx(v,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),he.jsx(oV,{displayMonth:e.displayMonth,id:e.id})]}),he.jsx("div",{className:r.caption,style:c.caption,children:b})}function fve(e){var t=ao(),n=t.footer,r=t.styles,a=t.classNames.tfoot;return n?he.jsx("tfoot",{className:a,style:r.tfoot,children:he.jsx("tr",{children:he.jsx("td",{colSpan:8,children:n})})}):he.jsx(he.Fragment,{})}function pve(e,t,n){for(var r=n?km(new Date):Su(new Date,{locale:e,weekStartsOn:t}),a=[],c=0;c<7;c++){var f=us(r,c);a.push(f)}return a}function mve(){var e=ao(),t=e.classNames,n=e.styles,r=e.showWeekNumber,a=e.locale,c=e.weekStartsOn,f=e.ISOWeek,i=e.formatters.formatWeekdayName,v=e.labels.labelWeekday,b=pve(a,c,f);return he.jsxs("tr",{style:n.head_row,className:t.head_row,children:[r&&he.jsx("td",{style:n.head_cell,className:t.head_cell}),b.map(function(T,A){return he.jsx("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":v(T,{locale:a}),children:i(T,{locale:a})},A)})]})}function gve(){var e,t=ao(),n=t.classNames,r=t.styles,a=t.components,c=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:mve;return he.jsx("thead",{style:r.head,className:n.head,children:he.jsx(c,{})})}function yve(e){var t=ao(),n=t.locale,r=t.formatters.formatDay;return he.jsx(he.Fragment,{children:r(e.date,{locale:n})})}var nN=X.createContext(void 0);function _ve(e){if(!Ow(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return he.jsx(nN.Provider,{value:t,children:e.children})}return he.jsx(vve,{initialProps:e.initialProps,children:e.children})}function vve(e){var t=e.initialProps,n=e.children,r=t.selected,a=t.min,c=t.max,f=function(b,T,A){var M,R;(M=t.onDayClick)===null||M===void 0||M.call(t,b,T,A);var B=!!(T.selected&&a&&(r==null?void 0:r.length)===a);if(!B){var L=!!(!T.selected&&c&&(r==null?void 0:r.length)===c);if(!L){var j=r?FX([],r):[];if(T.selected){var V=j.findIndex(function($){return js(b,$)});j.splice(V,1)}else j.push(b);(R=t.onSelect)===null||R===void 0||R.call(t,j,b,T,A)}}},i={disabled:[]};r&&i.disabled.push(function(b){var T=c&&r.length>c-1,A=r.some(function(M){return js(M,b)});return!!(T&&!A)});var v={selected:r,onDayClick:f,modifiers:i};return he.jsx(nN.Provider,{value:v,children:n})}function rN(){var e=X.useContext(nN);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function xve(e,t){var n=t||{},r=n.from,a=n.to;return r&&a?js(a,e)&&js(r,e)?void 0:js(a,e)?{from:a,to:void 0}:js(r,e)?void 0:pD(r,e)?{from:e,to:a}:{from:r,to:e}:a?pD(e,a)?{from:a,to:e}:{from:e,to:a}:r?NX(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var iN=X.createContext(void 0);function bve(e){if(!kw(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return he.jsx(iN.Provider,{value:t,children:e.children})}return he.jsx(wve,{initialProps:e.initialProps,children:e.children})}function wve(e){var t=e.initialProps,n=e.children,r=t.selected,a=r||{},c=a.from,f=a.to,i=t.min,v=t.max,b=function(R,B,L){var j,V;(j=t.onDayClick)===null||j===void 0||j.call(t,R,B,L);var $=xve(R,r);(V=t.onSelect)===null||V===void 0||V.call(t,$,R,B,L)},T={range_start:[],range_end:[],range_middle:[],disabled:[]};if(c?(T.range_start=[c],f?(T.range_end=[f],js(c,f)||(T.range_middle=[{after:c,before:f}])):T.range_end=[c]):f&&(T.range_start=[f],T.range_end=[f]),i&&(c&&!f&&T.disabled.push({after:ok(c,i-1),before:us(c,i-1)}),c&&f&&T.disabled.push({after:c,before:us(c,i-1)}),!c&&f&&T.disabled.push({after:ok(f,i-1),before:us(f,i-1)})),v){if(c&&!f&&(T.disabled.push({before:us(c,-v+1)}),T.disabled.push({after:us(c,v-1)})),c&&f){var A=fu(f,c)+1,M=v-A;T.disabled.push({before:ok(c,M)}),T.disabled.push({after:us(f,M)})}!c&&f&&(T.disabled.push({before:us(f,-v+1)}),T.disabled.push({after:us(f,v-1)}))}return he.jsx(iN.Provider,{value:{selected:r,onDayClick:b,modifiers:T},children:n})}function oN(){var e=X.useContext(iN);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function QE(e){return Array.isArray(e)?FX([],e):e!==void 0?[e]:[]}function Sve(e){var t={};return Object.entries(e).forEach(function(n){var r=n[0],a=n[1];t[r]=QE(a)}),t}var Nc;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Nc||(Nc={}));var Tve=Nc.Selected,ch=Nc.Disabled,Eve=Nc.Hidden,Ave=Nc.Today,sk=Nc.RangeEnd,lk=Nc.RangeMiddle,ck=Nc.RangeStart,Pve=Nc.Outside;function Cve(e,t,n){var r,a=(r={},r[Tve]=QE(e.selected),r[ch]=QE(e.disabled),r[Eve]=QE(e.hidden),r[Ave]=[e.today],r[sk]=[],r[lk]=[],r[ck]=[],r[Pve]=[],r);return e.fromDate&&a[ch].push({before:e.fromDate}),e.toDate&&a[ch].push({after:e.toDate}),Ow(e)?a[ch]=a[ch].concat(t.modifiers[ch]):kw(e)&&(a[ch]=a[ch].concat(n.modifiers[ch]),a[ck]=n.modifiers[ck],a[lk]=n.modifiers[lk],a[sk]=n.modifiers[sk]),a}var VX=X.createContext(void 0);function Ive(e){var t=ao(),n=rN(),r=oN(),a=Cve(t,n,r),c=Sve(t.modifiers),f=Pr(Pr({},a),c);return he.jsx(VX.Provider,{value:f,children:e.children})}function GX(){var e=X.useContext(VX);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Mve(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Ove(e){return!!(e&&typeof e=="object"&&"from"in e)}function kve(e){return!!(e&&typeof e=="object"&&"after"in e)}function Rve(e){return!!(e&&typeof e=="object"&&"before"in e)}function Dve(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Lve(e,t){var n,r=t.from,a=t.to;if(r&&a){var c=fu(a,r)<0;c&&(n=[a,r],r=n[0],a=n[1]);var f=fu(e,r)>=0&&fu(a,e)>=0;return f}return a?js(a,e):r?js(r,e):!1}function zve(e){return J3(e)}function Nve(e){return Array.isArray(e)&&e.every(J3)}function Fve(e,t){return t.some(function(n){if(typeof n=="boolean")return n;if(zve(n))return js(e,n);if(Nve(n))return n.includes(e);if(Ove(n))return Lve(e,n);if(Dve(n))return n.dayOfWeek.includes(e.getDay());if(Mve(n)){var r=fu(n.before,e),a=fu(n.after,e),c=r>0,f=a<0,i=pD(n.before,n.after);return i?f&&c:c||f}return kve(n)?fu(e,n.after)>0:Rve(n)?fu(n.before,e)>0:typeof n=="function"?n(e):!1})}function aN(e,t,n){var r=Object.keys(t).reduce(function(c,f){var i=t[f];return Fve(e,i)&&c.push(f),c},[]),a={};return r.forEach(function(c){return a[c]=!0}),n&&!tN(e,n)&&(a.outside=!0),a}function Bve(e,t){for(var n=Ws(e[0]),r=YP(e[e.length-1]),a,c,f=n;f<=r;){var i=aN(f,t),v=!i.disabled&&!i.hidden;if(!v){f=us(f,1);continue}if(i.selected)return f;i.today&&!c&&(c=f),a||(a=f),f=us(f,1)}return c||a}var jve=365;function WX(e,t){var n=t.moveBy,r=t.direction,a=t.context,c=t.modifiers,f=t.retry,i=f===void 0?{count:0,lastFocused:e}:f,v=a.weekStartsOn,b=a.fromDate,T=a.toDate,A=a.locale,M={day:us,week:fD,month:zc,year:xye,startOfWeek:function(j){return a.ISOWeek?km(j):Su(j,{locale:A,weekStartsOn:v})},endOfWeek:function(j){return a.ISOWeek?kX(j):Q3(j,{locale:A,weekStartsOn:v})}},R=M[n](e,r==="after"?1:-1);r==="before"&&b?R=bye([b,R]):r==="after"&&T&&(R=wye([T,R]));var B=!0;if(c){var L=aN(R,c);B=!L.disabled&&!L.hidden}return B?R:i.count>jve?i.lastFocused:WX(R,{moveBy:n,direction:r,context:a,modifiers:c,retry:Pr(Pr({},i),{count:i.count+1})})}var HX=X.createContext(void 0);function $ve(e){var t=Rw(),n=GX(),r=X.useState(),a=r[0],c=r[1],f=X.useState(),i=f[0],v=f[1],b=Bve(t.displayMonths,n),T=a??(i&&t.isDateDisplayed(i))?i:b,A=function(){v(a),c(void 0)},M=function(j){c(j)},R=ao(),B=function(j,V){if(a){var $=WX(a,{moveBy:j,direction:V,context:R,modifiers:n});js(a,$)||(t.goToDate($,a),M($))}},L={focusedDay:a,focusTarget:T,blur:A,focus:M,focusDayAfter:function(){return B("day","after")},focusDayBefore:function(){return B("day","before")},focusWeekAfter:function(){return B("week","after")},focusWeekBefore:function(){return B("week","before")},focusMonthBefore:function(){return B("month","before")},focusMonthAfter:function(){return B("month","after")},focusYearBefore:function(){return B("year","before")},focusYearAfter:function(){return B("year","after")},focusStartOfWeek:function(){return B("startOfWeek","before")},focusEndOfWeek:function(){return B("endOfWeek","after")}};return he.jsx(HX.Provider,{value:L,children:e.children})}function sN(){var e=X.useContext(HX);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function Uve(e,t){var n=GX(),r=aN(e,n,t);return r}var lN=X.createContext(void 0);function Vve(e){if(!JP(e.initialProps)){var t={selected:void 0};return he.jsx(lN.Provider,{value:t,children:e.children})}return he.jsx(Gve,{initialProps:e.initialProps,children:e.children})}function Gve(e){var t=e.initialProps,n=e.children,r=function(c,f,i){var v,b,T;if((v=t.onDayClick)===null||v===void 0||v.call(t,c,f,i),f.selected&&!t.required){(b=t.onSelect)===null||b===void 0||b.call(t,void 0,c,f,i);return}(T=t.onSelect)===null||T===void 0||T.call(t,c,c,f,i)},a={selected:t.selected,onDayClick:r};return he.jsx(lN.Provider,{value:a,children:n})}function qX(){var e=X.useContext(lN);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function Wve(e,t){var n=ao(),r=qX(),a=rN(),c=oN(),f=sN(),i=f.focusDayAfter,v=f.focusDayBefore,b=f.focusWeekAfter,T=f.focusWeekBefore,A=f.blur,M=f.focus,R=f.focusMonthBefore,B=f.focusMonthAfter,L=f.focusYearBefore,j=f.focusYearAfter,V=f.focusStartOfWeek,$=f.focusEndOfWeek,H=function(Je){var Ne,Xe,pt,zt;JP(n)?(Ne=r.onDayClick)===null||Ne===void 0||Ne.call(r,e,t,Je):Ow(n)?(Xe=a.onDayClick)===null||Xe===void 0||Xe.call(a,e,t,Je):kw(n)?(pt=c.onDayClick)===null||pt===void 0||pt.call(c,e,t,Je):(zt=n.onDayClick)===null||zt===void 0||zt.call(n,e,t,Je)},K=function(Je){var Ne;M(e),(Ne=n.onDayFocus)===null||Ne===void 0||Ne.call(n,e,t,Je)},Y=function(Je){var Ne;A(),(Ne=n.onDayBlur)===null||Ne===void 0||Ne.call(n,e,t,Je)},se=function(Je){var Ne;(Ne=n.onDayMouseEnter)===null||Ne===void 0||Ne.call(n,e,t,Je)},ce=function(Je){var Ne;(Ne=n.onDayMouseLeave)===null||Ne===void 0||Ne.call(n,e,t,Je)},ye=function(Je){var Ne;(Ne=n.onDayPointerEnter)===null||Ne===void 0||Ne.call(n,e,t,Je)},ze=function(Je){var Ne;(Ne=n.onDayPointerLeave)===null||Ne===void 0||Ne.call(n,e,t,Je)},Le=function(Je){var Ne;(Ne=n.onDayTouchCancel)===null||Ne===void 0||Ne.call(n,e,t,Je)},je=function(Je){var Ne;(Ne=n.onDayTouchEnd)===null||Ne===void 0||Ne.call(n,e,t,Je)},Re=function(Je){var Ne;(Ne=n.onDayTouchMove)===null||Ne===void 0||Ne.call(n,e,t,Je)},$e=function(Je){var Ne;(Ne=n.onDayTouchStart)===null||Ne===void 0||Ne.call(n,e,t,Je)},Ge=function(Je){var Ne;(Ne=n.onDayKeyUp)===null||Ne===void 0||Ne.call(n,e,t,Je)},ht=function(Je){var Ne;switch(Je.key){case"ArrowLeft":Je.preventDefault(),Je.stopPropagation(),n.dir==="rtl"?i():v();break;case"ArrowRight":Je.preventDefault(),Je.stopPropagation(),n.dir==="rtl"?v():i();break;case"ArrowDown":Je.preventDefault(),Je.stopPropagation(),b();break;case"ArrowUp":Je.preventDefault(),Je.stopPropagation(),T();break;case"PageUp":Je.preventDefault(),Je.stopPropagation(),Je.shiftKey?L():R();break;case"PageDown":Je.preventDefault(),Je.stopPropagation(),Je.shiftKey?j():B();break;case"Home":Je.preventDefault(),Je.stopPropagation(),V();break;case"End":Je.preventDefault(),Je.stopPropagation(),$();break}(Ne=n.onDayKeyDown)===null||Ne===void 0||Ne.call(n,e,t,Je)},ot={onClick:H,onFocus:K,onBlur:Y,onKeyDown:ht,onKeyUp:Ge,onMouseEnter:se,onMouseLeave:ce,onPointerEnter:ye,onPointerLeave:ze,onTouchCancel:Le,onTouchEnd:je,onTouchMove:Re,onTouchStart:$e};return ot}function Hve(){var e=ao(),t=qX(),n=rN(),r=oN(),a=JP(e)?t.selected:Ow(e)?n.selected:kw(e)?r.selected:void 0;return a}function qve(e){return Object.values(Nc).includes(e)}function Zve(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(r){var a=e.modifiersClassNames[r];if(a)n.push(a);else if(qve(r)){var c=e.classNames["day_".concat(r)];c&&n.push(c)}}),n}function Xve(e,t){var n=Pr({},e.styles.day);return Object.keys(t).forEach(function(r){var a;n=Pr(Pr({},n),(a=e.modifiersStyles)===null||a===void 0?void 0:a[r])}),n}function Kve(e,t,n){var r,a,c,f=ao(),i=sN(),v=Uve(e,t),b=Wve(e,v),T=Hve(),A=!!(f.onDayClick||f.mode!=="default");X.useEffect(function(){var se;v.outside||i.focusedDay&&A&&js(i.focusedDay,e)&&((se=n.current)===null||se===void 0||se.focus())},[i.focusedDay,e,n,A,v.outside]);var M=Zve(f,v).join(" "),R=Xve(f,v),B=!!(v.outside&&!f.showOutsideDays||v.hidden),L=(c=(a=f.components)===null||a===void 0?void 0:a.DayContent)!==null&&c!==void 0?c:yve,j=he.jsx(L,{date:e,displayMonth:t,activeModifiers:v}),V={style:R,className:M,children:j,role:"gridcell"},$=i.focusTarget&&js(i.focusTarget,e)&&!v.outside,H=i.focusedDay&&js(i.focusedDay,e),K=Pr(Pr(Pr({},V),(r={disabled:v.disabled,role:"gridcell"},r["aria-selected"]=v.selected,r.tabIndex=H||$?0:-1,r)),b),Y={isButton:A,isHidden:B,activeModifiers:v,selectedDays:T,buttonProps:K,divProps:V};return Y}function Yve(e){var t=X.useRef(null),n=Kve(e.date,e.displayMonth,t);return n.isHidden?he.jsx("div",{role:"gridcell"}):n.isButton?he.jsx(V2,Pr({name:"day",ref:t},n.buttonProps)):he.jsx("div",Pr({},n.divProps))}function Jve(e){var t=e.number,n=e.dates,r=ao(),a=r.onWeekNumberClick,c=r.styles,f=r.classNames,i=r.locale,v=r.labels.labelWeekNumber,b=r.formatters.formatWeekNumber,T=b(Number(t),{locale:i});if(!a)return he.jsx("span",{className:f.weeknumber,style:c.weeknumber,children:T});var A=v(Number(t),{locale:i}),M=function(R){a(t,n,R)};return he.jsx(V2,{name:"week-number","aria-label":A,className:f.weeknumber,style:c.weeknumber,onClick:M,children:T})}function Qve(e){var t,n,r=ao(),a=r.styles,c=r.classNames,f=r.showWeekNumber,i=r.components,v=(t=i==null?void 0:i.Day)!==null&&t!==void 0?t:Yve,b=(n=i==null?void 0:i.WeekNumber)!==null&&n!==void 0?n:Jve,T;return f&&(T=he.jsx("td",{className:c.cell,style:a.cell,children:he.jsx(b,{number:e.weekNumber,dates:e.dates})})),he.jsxs("tr",{className:c.row,style:a.row,children:[T,e.dates.map(function(A){return he.jsx("td",{className:c.cell,style:a.cell,role:"presentation",children:he.jsx(v,{displayMonth:e.displayMonth,date:A})},I_e(A))})]})}function aV(e,t,n){for(var r=n!=null&&n.ISOWeek?kX(t):Q3(t,n),a=n!=null&&n.ISOWeek?km(e):Su(e,n),c=fu(r,a),f=[],i=0;i<=c;i++)f.push(us(a,i));var v=f.reduce(function(b,T){var A=n!=null&&n.ISOWeek?RX(T):LX(T,n),M=b.find(function(R){return R.weekNumber===A});return M?(M.dates.push(T),b):(b.push({weekNumber:A,dates:[T]}),b)},[]);return v}function e0e(e,t){var n=aV(Ws(e),YP(e),t);if(t!=null&&t.useFixedWeeks){var r=O_e(e,t);if(r<6){var a=n[n.length-1],c=a.dates[a.dates.length-1],f=fD(c,6-r),i=aV(fD(c,1),f,t);n.push.apply(n,i)}}return n}function t0e(e){var t,n,r,a=ao(),c=a.locale,f=a.classNames,i=a.styles,v=a.hideHead,b=a.fixedWeeks,T=a.components,A=a.weekStartsOn,M=a.firstWeekContainsDate,R=a.ISOWeek,B=e0e(e.displayMonth,{useFixedWeeks:!!b,ISOWeek:R,locale:c,weekStartsOn:A,firstWeekContainsDate:M}),L=(t=T==null?void 0:T.Head)!==null&&t!==void 0?t:gve,j=(n=T==null?void 0:T.Row)!==null&&n!==void 0?n:Qve,V=(r=T==null?void 0:T.Footer)!==null&&r!==void 0?r:fve;return he.jsxs("table",{id:e.id,className:f.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!v&&he.jsx(L,{}),he.jsx("tbody",{className:f.tbody,style:i.tbody,children:B.map(function($){return he.jsx(j,{displayMonth:e.displayMonth,dates:$.dates,weekNumber:$.weekNumber},$.weekNumber)})}),he.jsx(V,{displayMonth:e.displayMonth})]})}function n0e(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var r0e=n0e()?X.useLayoutEffect:X.useEffect,uk=!1,i0e=0;function sV(){return"react-day-picker-".concat(++i0e)}function o0e(e){var t,n=e??(uk?sV():null),r=X.useState(n),a=r[0],c=r[1];return r0e(function(){a===null&&c(sV())},[]),X.useEffect(function(){uk===!1&&(uk=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function a0e(e){var t,n,r=ao(),a=r.dir,c=r.classNames,f=r.styles,i=r.components,v=Rw().displayMonths,b=o0e(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),T=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,A=[c.month],M=f.month,R=e.displayIndex===0,B=e.displayIndex===v.length-1,L=!R&&!B;a==="rtl"&&(t=[R,B],B=t[0],R=t[1]),R&&(A.push(c.caption_start),M=Pr(Pr({},M),f.caption_start)),B&&(A.push(c.caption_end),M=Pr(Pr({},M),f.caption_end)),L&&(A.push(c.caption_between),M=Pr(Pr({},M),f.caption_between));var j=(n=i==null?void 0:i.Caption)!==null&&n!==void 0?n:dve;return he.jsxs("div",{className:A.join(" "),style:M,children:[he.jsx(j,{id:b,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),he.jsx(t0e,{id:T,"aria-labelledby":b,displayMonth:e.displayMonth})]},e.displayIndex)}function s0e(e){var t=ao(),n=t.classNames,r=t.styles;return he.jsx("div",{className:n.months,style:r.months,children:e.children})}function l0e(e){var t,n,r=e.initialProps,a=ao(),c=sN(),f=Rw(),i=X.useState(!1),v=i[0],b=i[1];X.useEffect(function(){a.initialFocus&&c.focusTarget&&(v||(c.focus(c.focusTarget),b(!0)))},[a.initialFocus,v,c.focus,c.focusTarget,c]);var T=[a.classNames.root,a.className];a.numberOfMonths>1&&T.push(a.classNames.multiple_months),a.showWeekNumber&&T.push(a.classNames.with_weeknumber);var A=Pr(Pr({},a.styles.root),a.style),M=Object.keys(r).filter(function(B){return B.startsWith("data-")}).reduce(function(B,L){var j;return Pr(Pr({},B),(j={},j[L]=r[L],j))},{}),R=(n=(t=r.components)===null||t===void 0?void 0:t.Months)!==null&&n!==void 0?n:s0e;return he.jsx("div",Pr({className:T.join(" "),style:A,dir:a.dir,id:a.id,nonce:r.nonce,title:r.title,lang:r.lang},M,{children:he.jsx(R,{children:f.displayMonths.map(function(B,L){return he.jsx(a0e,{displayIndex:L,displayMonth:B},L)})})}))}function c0e(e){var t=e.children,n=R_e(e,["children"]);return he.jsx(J_e,{initialProps:n,children:he.jsx(lve,{children:he.jsx(Vve,{initialProps:n,children:he.jsx(_ve,{initialProps:n,children:he.jsx(bve,{initialProps:n,children:he.jsx(Ive,{children:he.jsx($ve,{children:t})})})})})})})}function GZe(e){return he.jsx(c0e,Pr({},e,{children:he.jsx(l0e,{initialProps:e})}))}function lV(e,[t,n]){return Math.min(n,Math.max(t,e))}var u0e=[" ","Enter","ArrowUp","ArrowDown"],h0e=[" ","Enter"],Dw="Select",[QP,eC,d0e]=xv(Dw),[Av,WZe]=qs(Dw,[d0e,Vf]),tC=Vf(),[f0e,Wf]=Av(Dw),[p0e,m0e]=Av(Dw),ZX=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:c,value:f,defaultValue:i,onValueChange:v,dir:b,name:T,autoComplete:A,disabled:M,required:R,form:B}=e,L=tC(t),[j,V]=X.useState(null),[$,H]=X.useState(null),[K,Y]=X.useState(!1),se=bv(b),[ce=!1,ye]=ys({prop:r,defaultProp:a,onChange:c}),[ze,Le]=ys({prop:f,defaultProp:i,onChange:v}),je=X.useRef(null),Re=j?B||!!j.closest("form"):!0,[$e,Ge]=X.useState(new Set),ht=Array.from($e).map(ot=>ot.props.value).join(";");return he.jsx(jP,{...L,children:he.jsxs(f0e,{required:R,scope:t,trigger:j,onTriggerChange:V,valueNode:$,onValueNodeChange:H,valueNodeHasChildren:K,onValueNodeHasChildrenChange:Y,contentId:Qa(),value:ze,onValueChange:Le,open:ce,onOpenChange:ye,dir:se,triggerPointerDownPosRef:je,disabled:M,children:[he.jsx(QP.Provider,{scope:t,children:he.jsx(p0e,{scope:e.__scopeSelect,onNativeOptionAdd:X.useCallback(ot=>{Ge(Je=>new Set(Je).add(ot))},[]),onNativeOptionRemove:X.useCallback(ot=>{Ge(Je=>{const Ne=new Set(Je);return Ne.delete(ot),Ne})},[]),children:n})}),Re?he.jsxs(vK,{"aria-hidden":!0,required:R,tabIndex:-1,name:T,autoComplete:A,value:ze,onChange:ot=>Le(ot.target.value),disabled:M,form:B,children:[ze===void 0?he.jsx("option",{value:""}):null,Array.from($e)]},ht):null]})})};ZX.displayName=Dw;var XX="SelectTrigger",KX=X.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,c=tC(n),f=Wf(XX,n),i=f.disabled||r,v=qr(t,f.onTriggerChange),b=eC(n),T=X.useRef("touch"),[A,M,R]=xK(L=>{const j=b().filter(H=>!H.disabled),V=j.find(H=>H.value===f.value),$=bK(j,L,V);$!==void 0&&f.onValueChange($.value)}),B=L=>{i||(f.onOpenChange(!0),R()),L&&(f.triggerPointerDownPosRef.current={x:Math.round(L.pageX),y:Math.round(L.pageY)})};return he.jsx(Tw,{asChild:!0,...c,children:he.jsx(Qn.button,{type:"button",role:"combobox","aria-controls":f.contentId,"aria-expanded":f.open,"aria-required":f.required,"aria-autocomplete":"none",dir:f.dir,"data-state":f.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":_K(f.value)?"":void 0,...a,ref:v,onClick:vn(a.onClick,L=>{L.currentTarget.focus(),T.current!=="mouse"&&B(L)}),onPointerDown:vn(a.onPointerDown,L=>{T.current=L.pointerType;const j=L.target;j.hasPointerCapture(L.pointerId)&&j.releasePointerCapture(L.pointerId),L.button===0&&L.ctrlKey===!1&&L.pointerType==="mouse"&&(B(L),L.preventDefault())}),onKeyDown:vn(a.onKeyDown,L=>{const j=A.current!=="";!(L.ctrlKey||L.altKey||L.metaKey)&&L.key.length===1&&M(L.key),!(j&&L.key===" ")&&u0e.includes(L.key)&&(B(),L.preventDefault())})})})});KX.displayName=XX;var YX="SelectValue",JX=X.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:c,placeholder:f="",...i}=e,v=Wf(YX,n),{onValueNodeHasChildrenChange:b}=v,T=c!==void 0,A=qr(t,v.onValueNodeChange);return $o(()=>{b(T)},[b,T]),he.jsx(Qn.span,{...i,ref:A,style:{pointerEvents:"none"},children:_K(v.value)?he.jsx(he.Fragment,{children:f}):c})});JX.displayName=YX;var g0e="SelectIcon",QX=X.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return he.jsx(Qn.span,{"aria-hidden":!0,...a,ref:t,children:r||"▼"})});QX.displayName=g0e;var y0e="SelectPortal",eK=e=>he.jsx(Ew,{asChild:!0,...e});eK.displayName=y0e;var Rm="SelectContent",tK=X.forwardRef((e,t)=>{const n=Wf(Rm,e.__scopeSelect),[r,a]=X.useState();if($o(()=>{a(new DocumentFragment)},[]),!n.open){const c=r;return c?Wm.createPortal(he.jsx(nK,{scope:e.__scopeSelect,children:he.jsx(QP.Slot,{scope:e.__scopeSelect,children:he.jsx("div",{children:e.children})})}),c):null}return he.jsx(rK,{...e,ref:t})});tK.displayName=Rm;var yc=10,[nK,Hf]=Av(Rm),_0e="SelectContentImpl",rK=X.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:c,onPointerDownOutside:f,side:i,sideOffset:v,align:b,alignOffset:T,arrowPadding:A,collisionBoundary:M,collisionPadding:R,sticky:B,hideWhenDetached:L,avoidCollisions:j,...V}=e,$=Wf(Rm,n),[H,K]=X.useState(null),[Y,se]=X.useState(null),ce=qr(t,Vt=>K(Vt)),[ye,ze]=X.useState(null),[Le,je]=X.useState(null),Re=eC(n),[$e,Ge]=X.useState(!1),ht=X.useRef(!1);X.useEffect(()=>{if(H)return Aw(H)},[H]),zP();const ot=X.useCallback(Vt=>{const[lr,...Nt]=Re().map(kt=>kt.ref.current),[gn]=Nt.slice(-1),xn=document.activeElement;for(const kt of Vt)if(kt===xn||(kt==null||kt.scrollIntoView({block:"nearest"}),kt===lr&&Y&&(Y.scrollTop=0),kt===gn&&Y&&(Y.scrollTop=Y.scrollHeight),kt==null||kt.focus(),document.activeElement!==xn))return},[Re,Y]),Je=X.useCallback(()=>ot([ye,H]),[ot,ye,H]);X.useEffect(()=>{$e&&Je()},[$e,Je]);const{onOpenChange:Ne,triggerPointerDownPosRef:Xe}=$;X.useEffect(()=>{if(H){let Vt={x:0,y:0};const lr=gn=>{var xn,kt;Vt={x:Math.abs(Math.round(gn.pageX)-(((xn=Xe.current)==null?void 0:xn.x)??0)),y:Math.abs(Math.round(gn.pageY)-(((kt=Xe.current)==null?void 0:kt.y)??0))}},Nt=gn=>{Vt.x<=10&&Vt.y<=10?gn.preventDefault():H.contains(gn.target)||Ne(!1),document.removeEventListener("pointermove",lr),Xe.current=null};return Xe.current!==null&&(document.addEventListener("pointermove",lr),document.addEventListener("pointerup",Nt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",lr),document.removeEventListener("pointerup",Nt,{capture:!0})}}},[H,Ne,Xe]),X.useEffect(()=>{const Vt=()=>Ne(!1);return window.addEventListener("blur",Vt),window.addEventListener("resize",Vt),()=>{window.removeEventListener("blur",Vt),window.removeEventListener("resize",Vt)}},[Ne]);const[pt,zt]=xK(Vt=>{const lr=Re().filter(xn=>!xn.disabled),Nt=lr.find(xn=>xn.ref.current===document.activeElement),gn=bK(lr,Vt,Nt);gn&&setTimeout(()=>gn.ref.current.focus())}),Ft=X.useCallback((Vt,lr,Nt)=>{const gn=!ht.current&&!Nt;($.value!==void 0&&$.value===lr||gn)&&(ze(Vt),gn&&(ht.current=!0))},[$.value]),un=X.useCallback(()=>H==null?void 0:H.focus(),[H]),Tn=X.useCallback((Vt,lr,Nt)=>{const gn=!ht.current&&!Nt;($.value!==void 0&&$.value===lr||gn)&&je(Vt)},[$.value]),fn=r==="popper"?mD:iK,Cn=fn===mD?{side:i,sideOffset:v,align:b,alignOffset:T,arrowPadding:A,collisionBoundary:M,collisionPadding:R,sticky:B,hideWhenDetached:L,avoidCollisions:j}:{};return he.jsx(nK,{scope:n,content:H,viewport:Y,onViewportChange:se,itemRefCallback:Ft,selectedItem:ye,onItemLeave:un,itemTextRefCallback:Tn,focusSelectedItem:Je,selectedItemText:Le,position:r,isPositioned:$e,searchRef:pt,children:he.jsx(Pw,{as:Pf,allowPinchZoom:!0,children:he.jsx(ww,{asChild:!0,trapped:$.open,onMountAutoFocus:Vt=>{Vt.preventDefault()},onUnmountAutoFocus:vn(a,Vt=>{var lr;(lr=$.trigger)==null||lr.focus({preventScroll:!0}),Vt.preventDefault()}),children:he.jsx(Xm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:Vt=>Vt.preventDefault(),onDismiss:()=>$.onOpenChange(!1),children:he.jsx(fn,{role:"listbox",id:$.contentId,"data-state":$.open?"open":"closed",dir:$.dir,onContextMenu:Vt=>Vt.preventDefault(),...V,...Cn,onPlaced:()=>Ge(!0),ref:ce,style:{display:"flex",flexDirection:"column",outline:"none",...V.style},onKeyDown:vn(V.onKeyDown,Vt=>{const lr=Vt.ctrlKey||Vt.altKey||Vt.metaKey;if(Vt.key==="Tab"&&Vt.preventDefault(),!lr&&Vt.key.length===1&&zt(Vt.key),["ArrowUp","ArrowDown","Home","End"].includes(Vt.key)){let gn=Re().filter(xn=>!xn.disabled).map(xn=>xn.ref.current);if(["ArrowUp","End"].includes(Vt.key)&&(gn=gn.slice().reverse()),["ArrowUp","ArrowDown"].includes(Vt.key)){const xn=Vt.target,kt=gn.indexOf(xn);gn=gn.slice(kt+1)}setTimeout(()=>ot(gn)),Vt.preventDefault()}})})})})})})});rK.displayName=_0e;var v0e="SelectItemAlignedPosition",iK=X.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,c=Wf(Rm,n),f=Hf(Rm,n),[i,v]=X.useState(null),[b,T]=X.useState(null),A=qr(t,ce=>T(ce)),M=eC(n),R=X.useRef(!1),B=X.useRef(!0),{viewport:L,selectedItem:j,selectedItemText:V,focusSelectedItem:$}=f,H=X.useCallback(()=>{if(c.trigger&&c.valueNode&&i&&b&&L&&j&&V){const ce=c.trigger.getBoundingClientRect(),ye=b.getBoundingClientRect(),ze=c.valueNode.getBoundingClientRect(),Le=V.getBoundingClientRect();if(c.dir!=="rtl"){const xn=Le.left-ye.left,kt=ze.left-xn,zn=ce.left-kt,fr=ce.width+zn,hi=Math.max(fr,ye.width),br=window.innerWidth-yc,Pi=lV(kt,[yc,Math.max(yc,br-hi)]);i.style.minWidth=fr+"px",i.style.left=Pi+"px"}else{const xn=ye.right-Le.right,kt=window.innerWidth-ze.right-xn,zn=window.innerWidth-ce.right-kt,fr=ce.width+zn,hi=Math.max(fr,ye.width),br=window.innerWidth-yc,Pi=lV(kt,[yc,Math.max(yc,br-hi)]);i.style.minWidth=fr+"px",i.style.right=Pi+"px"}const je=M(),Re=window.innerHeight-yc*2,$e=L.scrollHeight,Ge=window.getComputedStyle(b),ht=parseInt(Ge.borderTopWidth,10),ot=parseInt(Ge.paddingTop,10),Je=parseInt(Ge.borderBottomWidth,10),Ne=parseInt(Ge.paddingBottom,10),Xe=ht+ot+$e+Ne+Je,pt=Math.min(j.offsetHeight*5,Xe),zt=window.getComputedStyle(L),Ft=parseInt(zt.paddingTop,10),un=parseInt(zt.paddingBottom,10),Tn=ce.top+ce.height/2-yc,fn=Re-Tn,Cn=j.offsetHeight/2,Vt=j.offsetTop+Cn,lr=ht+ot+Vt,Nt=Xe-lr;if(lr<=Tn){const xn=je.length>0&&j===je[je.length-1].ref.current;i.style.bottom="0px";const kt=b.clientHeight-L.offsetTop-L.offsetHeight,zn=Math.max(fn,Cn+(xn?un:0)+kt+Je),fr=lr+zn;i.style.height=fr+"px"}else{const xn=je.length>0&&j===je[0].ref.current;i.style.top="0px";const zn=Math.max(Tn,ht+L.offsetTop+(xn?Ft:0)+Cn)+Nt;i.style.height=zn+"px",L.scrollTop=lr-Tn+L.offsetTop}i.style.margin=`${yc}px 0`,i.style.minHeight=pt+"px",i.style.maxHeight=Re+"px",r==null||r(),requestAnimationFrame(()=>R.current=!0)}},[M,c.trigger,c.valueNode,i,b,L,j,V,c.dir,r]);$o(()=>H(),[H]);const[K,Y]=X.useState();$o(()=>{b&&Y(window.getComputedStyle(b).zIndex)},[b]);const se=X.useCallback(ce=>{ce&&B.current===!0&&(H(),$==null||$(),B.current=!1)},[H,$]);return he.jsx(b0e,{scope:n,contentWrapper:i,shouldExpandOnScrollRef:R,onScrollButtonChange:se,children:he.jsx("div",{ref:v,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:K},children:he.jsx(Qn.div,{...a,ref:A,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});iK.displayName=v0e;var x0e="SelectPopperPosition",mD=X.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=yc,...c}=e,f=tC(n);return he.jsx($P,{...f,...c,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...c.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});mD.displayName=x0e;var[b0e,cN]=Av(Rm,{}),gD="SelectViewport",oK=X.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,c=Hf(gD,n),f=cN(gD,n),i=qr(t,c.onViewportChange),v=X.useRef(0);return he.jsxs(he.Fragment,{children:[he.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),he.jsx(QP.Slot,{scope:n,children:he.jsx(Qn.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:vn(a.onScroll,b=>{const T=b.currentTarget,{contentWrapper:A,shouldExpandOnScrollRef:M}=f;if(M!=null&&M.current&&A){const R=Math.abs(v.current-T.scrollTop);if(R>0){const B=window.innerHeight-yc*2,L=parseFloat(A.style.minHeight),j=parseFloat(A.style.height),V=Math.max(L,j);if(V<B){const $=V+R,H=Math.min(B,$),K=$-H;A.style.height=H+"px",A.style.bottom==="0px"&&(T.scrollTop=K>0?K:0,A.style.justifyContent="flex-end")}}}v.current=T.scrollTop})})})]})});oK.displayName=gD;var aK="SelectGroup",[w0e,S0e]=Av(aK),T0e=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Qa();return he.jsx(w0e,{scope:n,id:a,children:he.jsx(Qn.div,{role:"group","aria-labelledby":a,...r,ref:t})})});T0e.displayName=aK;var sK="SelectLabel",lK=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=S0e(sK,n);return he.jsx(Qn.div,{id:a.id,...r,ref:t})});lK.displayName=sK;var G2="SelectItem",[E0e,cK]=Av(G2),uK=X.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:c,...f}=e,i=Wf(G2,n),v=Hf(G2,n),b=i.value===r,[T,A]=X.useState(c??""),[M,R]=X.useState(!1),B=qr(t,$=>{var H;return(H=v.itemRefCallback)==null?void 0:H.call(v,$,r,a)}),L=Qa(),j=X.useRef("touch"),V=()=>{a||(i.onValueChange(r),i.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return he.jsx(E0e,{scope:n,value:r,disabled:a,textId:L,isSelected:b,onItemTextChange:X.useCallback($=>{A(H=>H||(($==null?void 0:$.textContent)??"").trim())},[]),children:he.jsx(QP.ItemSlot,{scope:n,value:r,disabled:a,textValue:T,children:he.jsx(Qn.div,{role:"option","aria-labelledby":L,"data-highlighted":M?"":void 0,"aria-selected":b&&M,"data-state":b?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...f,ref:B,onFocus:vn(f.onFocus,()=>R(!0)),onBlur:vn(f.onBlur,()=>R(!1)),onClick:vn(f.onClick,()=>{j.current!=="mouse"&&V()}),onPointerUp:vn(f.onPointerUp,()=>{j.current==="mouse"&&V()}),onPointerDown:vn(f.onPointerDown,$=>{j.current=$.pointerType}),onPointerMove:vn(f.onPointerMove,$=>{var H;j.current=$.pointerType,a?(H=v.onItemLeave)==null||H.call(v):j.current==="mouse"&&$.currentTarget.focus({preventScroll:!0})}),onPointerLeave:vn(f.onPointerLeave,$=>{var H;$.currentTarget===document.activeElement&&((H=v.onItemLeave)==null||H.call(v))}),onKeyDown:vn(f.onKeyDown,$=>{var K;((K=v.searchRef)==null?void 0:K.current)!==""&&$.key===" "||(h0e.includes($.key)&&V(),$.key===" "&&$.preventDefault())})})})})});uK.displayName=G2;var f1="SelectItemText",hK=X.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...c}=e,f=Wf(f1,n),i=Hf(f1,n),v=cK(f1,n),b=m0e(f1,n),[T,A]=X.useState(null),M=qr(t,V=>A(V),v.onItemTextChange,V=>{var $;return($=i.itemTextRefCallback)==null?void 0:$.call(i,V,v.value,v.disabled)}),R=T==null?void 0:T.textContent,B=X.useMemo(()=>he.jsx("option",{value:v.value,disabled:v.disabled,children:R},v.value),[v.disabled,v.value,R]),{onNativeOptionAdd:L,onNativeOptionRemove:j}=b;return $o(()=>(L(B),()=>j(B)),[L,j,B]),he.jsxs(he.Fragment,{children:[he.jsx(Qn.span,{id:v.textId,...c,ref:M}),v.isSelected&&f.valueNode&&!f.valueNodeHasChildren?Wm.createPortal(c.children,f.valueNode):null]})});hK.displayName=f1;var dK="SelectItemIndicator",fK=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return cK(dK,n).isSelected?he.jsx(Qn.span,{"aria-hidden":!0,...r,ref:t}):null});fK.displayName=dK;var yD="SelectScrollUpButton",pK=X.forwardRef((e,t)=>{const n=Hf(yD,e.__scopeSelect),r=cN(yD,e.__scopeSelect),[a,c]=X.useState(!1),f=qr(t,r.onScrollButtonChange);return $o(()=>{if(n.viewport&&n.isPositioned){let i=function(){const b=v.scrollTop>0;c(b)};const v=n.viewport;return i(),v.addEventListener("scroll",i),()=>v.removeEventListener("scroll",i)}},[n.viewport,n.isPositioned]),a?he.jsx(gK,{...e,ref:f,onAutoScroll:()=>{const{viewport:i,selectedItem:v}=n;i&&v&&(i.scrollTop=i.scrollTop-v.offsetHeight)}}):null});pK.displayName=yD;var _D="SelectScrollDownButton",mK=X.forwardRef((e,t)=>{const n=Hf(_D,e.__scopeSelect),r=cN(_D,e.__scopeSelect),[a,c]=X.useState(!1),f=qr(t,r.onScrollButtonChange);return $o(()=>{if(n.viewport&&n.isPositioned){let i=function(){const b=v.scrollHeight-v.clientHeight,T=Math.ceil(v.scrollTop)<b;c(T)};const v=n.viewport;return i(),v.addEventListener("scroll",i),()=>v.removeEventListener("scroll",i)}},[n.viewport,n.isPositioned]),a?he.jsx(gK,{...e,ref:f,onAutoScroll:()=>{const{viewport:i,selectedItem:v}=n;i&&v&&(i.scrollTop=i.scrollTop+v.offsetHeight)}}):null});mK.displayName=_D;var gK=X.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,c=Hf("SelectScrollButton",n),f=X.useRef(null),i=eC(n),v=X.useCallback(()=>{f.current!==null&&(window.clearInterval(f.current),f.current=null)},[]);return X.useEffect(()=>()=>v(),[v]),$o(()=>{var T;const b=i().find(A=>A.ref.current===document.activeElement);(T=b==null?void 0:b.ref.current)==null||T.scrollIntoView({block:"nearest"})},[i]),he.jsx(Qn.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:vn(a.onPointerDown,()=>{f.current===null&&(f.current=window.setInterval(r,50))}),onPointerMove:vn(a.onPointerMove,()=>{var b;(b=c.onItemLeave)==null||b.call(c),f.current===null&&(f.current=window.setInterval(r,50))}),onPointerLeave:vn(a.onPointerLeave,()=>{v()})})}),A0e="SelectSeparator",yK=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return he.jsx(Qn.div,{"aria-hidden":!0,...r,ref:t})});yK.displayName=A0e;var vD="SelectArrow",P0e=X.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=tC(n),c=Wf(vD,n),f=Hf(vD,n);return c.open&&f.position==="popper"?he.jsx(UP,{...a,...r,ref:t}):null});P0e.displayName=vD;function _K(e){return e===""||e===void 0}var vK=X.forwardRef((e,t)=>{const{value:n,...r}=e,a=X.useRef(null),c=qr(t,a),f=ZP(n);return X.useEffect(()=>{const i=a.current,v=window.HTMLSelectElement.prototype,T=Object.getOwnPropertyDescriptor(v,"value").set;if(f!==n&&T){const A=new Event("change",{bubbles:!0});T.call(i,n),i.dispatchEvent(A)}},[f,n]),he.jsx(z3,{asChild:!0,children:he.jsx("select",{...r,ref:c,defaultValue:n})})});vK.displayName="BubbleSelect";function xK(e){const t=Zo(e),n=X.useRef(""),r=X.useRef(0),a=X.useCallback(f=>{const i=n.current+f;t(i),function v(b){n.current=b,window.clearTimeout(r.current),b!==""&&(r.current=window.setTimeout(()=>v(""),1e3))}(i)},[t]),c=X.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return X.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,c]}function bK(e,t,n){const a=t.length>1&&Array.from(t).every(b=>b===t[0])?t[0]:t,c=n?e.indexOf(n):-1;let f=C0e(e,Math.max(c,0));a.length===1&&(f=f.filter(b=>b!==n));const v=f.find(b=>b.textValue.toLowerCase().startsWith(a.toLowerCase()));return v!==n?v:void 0}function C0e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var HZe=ZX,qZe=KX,ZZe=JX,XZe=QX,KZe=eK,YZe=tK,JZe=oK,QZe=lK,eXe=uK,tXe=hK,nXe=fK,rXe=pK,iXe=mK,oXe=yK,Mi;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function n(a){throw new Error}e.assertNever=n,e.arrayToEnum=a=>{const c={};for(const f of a)c[f]=f;return c},e.getValidEnumValues=a=>{const c=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),f={};for(const i of c)f[i]=a[i];return e.objectValues(f)},e.objectValues=a=>e.objectKeys(a).map(function(c){return a[c]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const c=[];for(const f in a)Object.prototype.hasOwnProperty.call(a,f)&&c.push(f);return c},e.find=(a,c)=>{for(const f of a)if(c(f))return f},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function r(a,c=" | "){return a.map(f=>typeof f=="string"?`'${f}'`:f).join(c)}e.joinValues=r,e.jsonStringifyReplacer=(a,c)=>typeof c=="bigint"?c.toString():c})(Mi||(Mi={}));var xD;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(xD||(xD={}));const Un=Mi.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),tf=e=>{switch(typeof e){case"undefined":return Un.undefined;case"string":return Un.string;case"number":return isNaN(e)?Un.nan:Un.number;case"boolean":return Un.boolean;case"function":return Un.function;case"bigint":return Un.bigint;case"symbol":return Un.symbol;case"object":return Array.isArray(e)?Un.array:e===null?Un.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Un.promise:typeof Map<"u"&&e instanceof Map?Un.map:typeof Set<"u"&&e instanceof Set?Un.set:typeof Date<"u"&&e instanceof Date?Un.date:Un.object;default:return Un.unknown}},_n=Mi.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I0e=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class gl extends Error{constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const n=t||function(c){return c.message},r={_errors:[]},a=c=>{for(const f of c.issues)if(f.code==="invalid_union")f.unionErrors.map(a);else if(f.code==="invalid_return_type")a(f.returnTypeError);else if(f.code==="invalid_arguments")a(f.argumentsError);else if(f.path.length===0)r._errors.push(n(f));else{let i=r,v=0;for(;v<f.path.length;){const b=f.path[v];v===f.path.length-1?(i[b]=i[b]||{_errors:[]},i[b]._errors.push(n(f))):i[b]=i[b]||{_errors:[]},i=i[b],v++}}};return a(this),r}static assert(t){if(!(t instanceof gl))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Mi.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const a of this.issues)a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(t(a))):r.push(t(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}gl.create=e=>new gl(e);const k_=(e,t)=>{let n;switch(e.code){case _n.invalid_type:e.received===Un.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case _n.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Mi.jsonStringifyReplacer)}`;break;case _n.unrecognized_keys:n=`Unrecognized key(s) in object: ${Mi.joinValues(e.keys,", ")}`;break;case _n.invalid_union:n="Invalid input";break;case _n.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Mi.joinValues(e.options)}`;break;case _n.invalid_enum_value:n=`Invalid enum value. Expected ${Mi.joinValues(e.options)}, received '${e.received}'`;break;case _n.invalid_arguments:n="Invalid function arguments";break;case _n.invalid_return_type:n="Invalid function return type";break;case _n.invalid_date:n="Invalid date";break;case _n.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Mi.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case _n.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case _n.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case _n.custom:n="Invalid input";break;case _n.invalid_intersection_types:n="Intersection results could not be merged";break;case _n.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case _n.not_finite:n="Number must be finite";break;default:n=t.defaultError,Mi.assertNever(e)}return{message:n}};let wK=k_;function M0e(e){wK=e}function W2(){return wK}const H2=e=>{const{data:t,path:n,errorMaps:r,issueData:a}=e,c=[...n,...a.path||[]],f={...a,path:c};if(a.message!==void 0)return{...a,path:c,message:a.message};let i="";const v=r.filter(b=>!!b).slice().reverse();for(const b of v)i=b(f,{data:t,defaultError:i}).message;return{...a,path:c,message:i}},O0e=[];function Nn(e,t){const n=W2(),r=H2({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===k_?void 0:k_].filter(a=>!!a)});e.common.issues.push(r)}class ts{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const a of n){if(a.status==="aborted")return Cr;a.status==="dirty"&&t.dirty(),r.push(a.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const a of n){const c=await a.key,f=await a.value;r.push({key:c,value:f})}return ts.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const a of n){const{key:c,value:f}=a;if(c.status==="aborted"||f.status==="aborted")return Cr;c.status==="dirty"&&t.dirty(),f.status==="dirty"&&t.dirty(),c.value!=="__proto__"&&(typeof f.value<"u"||a.alwaysSet)&&(r[c.value]=f.value)}return{status:t.value,value:r}}}const Cr=Object.freeze({status:"aborted"}),Jy=e=>({status:"dirty",value:e}),_s=e=>({status:"valid",value:e}),bD=e=>e.status==="aborted",wD=e=>e.status==="dirty",gb=e=>e.status==="valid",yb=e=>typeof Promise<"u"&&e instanceof Promise;function q2(e,t,n,r){if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function SK(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var cr;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(cr||(cr={}));var p1,m1;class Tu{constructor(t,n,r,a){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const cV=(e,t)=>{if(gb(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new gl(e.common.issues);return this._error=n,this._error}}};function Hr(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(f,i)=>{var v,b;const{message:T}=e;return f.code==="invalid_enum_value"?{message:T??i.defaultError}:typeof i.data>"u"?{message:(v=T??r)!==null&&v!==void 0?v:i.defaultError}:f.code!=="invalid_type"?{message:i.defaultError}:{message:(b=T??n)!==null&&b!==void 0?b:i.defaultError}},description:a}}class si{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return tf(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:tf(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ts,ctx:{common:t.parent.common,data:t.data,parsedType:tf(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(yb(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){var r;const a={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:tf(t)},c=this._parseSync({data:t,path:a.path,parent:a});return cV(a,c)}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:tf(t)},a=this._parse({data:t,path:r.path,parent:r}),c=await(yb(a)?a:Promise.resolve(a));return cV(r,c)}refine(t,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,c)=>{const f=t(a),i=()=>c.addIssue({code:_n.custom,...r(a)});return typeof Promise<"u"&&f instanceof Promise?f.then(v=>v?!0:(i(),!1)):f?!0:(i(),!1)})}refinement(t,n){return this._refinement((r,a)=>t(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(t){return new Fc({schema:this,typeName:Er.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return vu.create(this,this._def)}nullable(){return Lf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Mc.create(this,this._def)}promise(){return D_.create(this,this._def)}or(t){return bb.create([this,t],this._def)}and(t){return wb.create(this,t,this._def)}transform(t){return new Fc({...Hr(this._def),schema:this,typeName:Er.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Pb({...Hr(this._def),innerType:this,defaultValue:n,typeName:Er.ZodDefault})}brand(){return new uN({typeName:Er.ZodBranded,type:this,...Hr(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Cb({...Hr(this._def),innerType:this,catchValue:n,typeName:Er.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Lw.create(this,t)}readonly(){return Ib.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const k0e=/^c[^\s-]{8,}$/i,R0e=/^[0-9a-z]+$/,D0e=/^[0-9A-HJKMNP-TV-Z]{26}$/,L0e=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,z0e=/^[a-z0-9_-]{21}$/i,N0e=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,F0e=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,B0e="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let hk;const j0e=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$0e=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,U0e=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,TK="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",V0e=new RegExp(`^${TK}$`);function EK(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function G0e(e){return new RegExp(`^${EK(e)}$`)}function AK(e){let t=`${TK}T${EK(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function W0e(e,t){return!!((t==="v4"||!t)&&j0e.test(e)||(t==="v6"||!t)&&$0e.test(e))}class Pc extends si{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Un.string){const c=this._getOrReturnCtx(t);return Nn(c,{code:_n.invalid_type,expected:Un.string,received:c.parsedType}),Cr}const r=new ts;let a;for(const c of this._def.checks)if(c.kind==="min")t.data.length<c.value&&(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),r.dirty());else if(c.kind==="max")t.data.length>c.value&&(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),r.dirty());else if(c.kind==="length"){const f=t.data.length>c.value,i=t.data.length<c.value;(f||i)&&(a=this._getOrReturnCtx(t,a),f?Nn(a,{code:_n.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}):i&&Nn(a,{code:_n.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}),r.dirty())}else if(c.kind==="email")F0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"email",code:_n.invalid_string,message:c.message}),r.dirty());else if(c.kind==="emoji")hk||(hk=new RegExp(B0e,"u")),hk.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"emoji",code:_n.invalid_string,message:c.message}),r.dirty());else if(c.kind==="uuid")L0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"uuid",code:_n.invalid_string,message:c.message}),r.dirty());else if(c.kind==="nanoid")z0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"nanoid",code:_n.invalid_string,message:c.message}),r.dirty());else if(c.kind==="cuid")k0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"cuid",code:_n.invalid_string,message:c.message}),r.dirty());else if(c.kind==="cuid2")R0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"cuid2",code:_n.invalid_string,message:c.message}),r.dirty());else if(c.kind==="ulid")D0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"ulid",code:_n.invalid_string,message:c.message}),r.dirty());else if(c.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Nn(a,{validation:"url",code:_n.invalid_string,message:c.message}),r.dirty()}else c.kind==="regex"?(c.regex.lastIndex=0,c.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"regex",code:_n.invalid_string,message:c.message}),r.dirty())):c.kind==="trim"?t.data=t.data.trim():c.kind==="includes"?t.data.includes(c.value,c.position)||(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.invalid_string,validation:{includes:c.value,position:c.position},message:c.message}),r.dirty()):c.kind==="toLowerCase"?t.data=t.data.toLowerCase():c.kind==="toUpperCase"?t.data=t.data.toUpperCase():c.kind==="startsWith"?t.data.startsWith(c.value)||(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.invalid_string,validation:{startsWith:c.value},message:c.message}),r.dirty()):c.kind==="endsWith"?t.data.endsWith(c.value)||(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.invalid_string,validation:{endsWith:c.value},message:c.message}),r.dirty()):c.kind==="datetime"?AK(c).test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.invalid_string,validation:"datetime",message:c.message}),r.dirty()):c.kind==="date"?V0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.invalid_string,validation:"date",message:c.message}),r.dirty()):c.kind==="time"?G0e(c).test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.invalid_string,validation:"time",message:c.message}),r.dirty()):c.kind==="duration"?N0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"duration",code:_n.invalid_string,message:c.message}),r.dirty()):c.kind==="ip"?W0e(t.data,c.version)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"ip",code:_n.invalid_string,message:c.message}),r.dirty()):c.kind==="base64"?U0e.test(t.data)||(a=this._getOrReturnCtx(t,a),Nn(a,{validation:"base64",code:_n.invalid_string,message:c.message}),r.dirty()):Mi.assertNever(c);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(a=>t.test(a),{validation:n,code:_n.invalid_string,...cr.errToObj(r)})}_addCheck(t){return new Pc({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...cr.errToObj(t)})}url(t){return this._addCheck({kind:"url",...cr.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...cr.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...cr.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...cr.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...cr.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...cr.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...cr.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...cr.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...cr.errToObj(t)})}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!==null&&n!==void 0?n:!1,local:(r=t==null?void 0:t.local)!==null&&r!==void 0?r:!1,...cr.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...cr.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...cr.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...cr.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...cr.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...cr.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...cr.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...cr.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...cr.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...cr.errToObj(n)})}nonempty(t){return this.min(1,cr.errToObj(t))}trim(){return new Pc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Pc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Pc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Pc.create=e=>{var t;return new Pc({checks:[],typeName:Er.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Hr(e)})};function H0e(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r,c=parseInt(e.toFixed(a).replace(".","")),f=parseInt(t.toFixed(a).replace(".",""));return c%f/Math.pow(10,a)}class kf extends si{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Un.number){const c=this._getOrReturnCtx(t);return Nn(c,{code:_n.invalid_type,expected:Un.number,received:c.parsedType}),Cr}let r;const a=new ts;for(const c of this._def.checks)c.kind==="int"?Mi.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Nn(r,{code:_n.invalid_type,expected:"integer",received:"float",message:c.message}),a.dirty()):c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(r=this._getOrReturnCtx(t,r),Nn(r,{code:_n.too_small,minimum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),a.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(r=this._getOrReturnCtx(t,r),Nn(r,{code:_n.too_big,maximum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),a.dirty()):c.kind==="multipleOf"?H0e(t.data,c.value)!==0&&(r=this._getOrReturnCtx(t,r),Nn(r,{code:_n.not_multiple_of,multipleOf:c.value,message:c.message}),a.dirty()):c.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Nn(r,{code:_n.not_finite,message:c.message}),a.dirty()):Mi.assertNever(c);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,cr.toString(n))}gt(t,n){return this.setLimit("min",t,!1,cr.toString(n))}lte(t,n){return this.setLimit("max",t,!0,cr.toString(n))}lt(t,n){return this.setLimit("max",t,!1,cr.toString(n))}setLimit(t,n,r,a){return new kf({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:cr.toString(a)}]})}_addCheck(t){return new kf({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:cr.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:cr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:cr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:cr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:cr.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:cr.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:cr.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:cr.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:cr.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Mi.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}kf.create=e=>new kf({checks:[],typeName:Er.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Hr(e)});class Rf extends si{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==Un.bigint){const c=this._getOrReturnCtx(t);return Nn(c,{code:_n.invalid_type,expected:Un.bigint,received:c.parsedType}),Cr}let r;const a=new ts;for(const c of this._def.checks)c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(r=this._getOrReturnCtx(t,r),Nn(r,{code:_n.too_small,type:"bigint",minimum:c.value,inclusive:c.inclusive,message:c.message}),a.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(r=this._getOrReturnCtx(t,r),Nn(r,{code:_n.too_big,type:"bigint",maximum:c.value,inclusive:c.inclusive,message:c.message}),a.dirty()):c.kind==="multipleOf"?t.data%c.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Nn(r,{code:_n.not_multiple_of,multipleOf:c.value,message:c.message}),a.dirty()):Mi.assertNever(c);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,cr.toString(n))}gt(t,n){return this.setLimit("min",t,!1,cr.toString(n))}lte(t,n){return this.setLimit("max",t,!0,cr.toString(n))}lt(t,n){return this.setLimit("max",t,!1,cr.toString(n))}setLimit(t,n,r,a){return new Rf({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:cr.toString(a)}]})}_addCheck(t){return new Rf({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:cr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:cr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:cr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:cr.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:cr.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Rf.create=e=>{var t;return new Rf({checks:[],typeName:Er.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Hr(e)})};class _b extends si{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Un.boolean){const r=this._getOrReturnCtx(t);return Nn(r,{code:_n.invalid_type,expected:Un.boolean,received:r.parsedType}),Cr}return _s(t.data)}}_b.create=e=>new _b({typeName:Er.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Hr(e)});class Dm extends si{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Un.date){const c=this._getOrReturnCtx(t);return Nn(c,{code:_n.invalid_type,expected:Un.date,received:c.parsedType}),Cr}if(isNaN(t.data.getTime())){const c=this._getOrReturnCtx(t);return Nn(c,{code:_n.invalid_date}),Cr}const r=new ts;let a;for(const c of this._def.checks)c.kind==="min"?t.data.getTime()<c.value&&(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.too_small,message:c.message,inclusive:!0,exact:!1,minimum:c.value,type:"date"}),r.dirty()):c.kind==="max"?t.data.getTime()>c.value&&(a=this._getOrReturnCtx(t,a),Nn(a,{code:_n.too_big,message:c.message,inclusive:!0,exact:!1,maximum:c.value,type:"date"}),r.dirty()):Mi.assertNever(c);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Dm({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:cr.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:cr.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Dm.create=e=>new Dm({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Er.ZodDate,...Hr(e)});class Z2 extends si{_parse(t){if(this._getType(t)!==Un.symbol){const r=this._getOrReturnCtx(t);return Nn(r,{code:_n.invalid_type,expected:Un.symbol,received:r.parsedType}),Cr}return _s(t.data)}}Z2.create=e=>new Z2({typeName:Er.ZodSymbol,...Hr(e)});class vb extends si{_parse(t){if(this._getType(t)!==Un.undefined){const r=this._getOrReturnCtx(t);return Nn(r,{code:_n.invalid_type,expected:Un.undefined,received:r.parsedType}),Cr}return _s(t.data)}}vb.create=e=>new vb({typeName:Er.ZodUndefined,...Hr(e)});class xb extends si{_parse(t){if(this._getType(t)!==Un.null){const r=this._getOrReturnCtx(t);return Nn(r,{code:_n.invalid_type,expected:Un.null,received:r.parsedType}),Cr}return _s(t.data)}}xb.create=e=>new xb({typeName:Er.ZodNull,...Hr(e)});class R_ extends si{constructor(){super(...arguments),this._any=!0}_parse(t){return _s(t.data)}}R_.create=e=>new R_({typeName:Er.ZodAny,...Hr(e)});class bm extends si{constructor(){super(...arguments),this._unknown=!0}_parse(t){return _s(t.data)}}bm.create=e=>new bm({typeName:Er.ZodUnknown,...Hr(e)});class zh extends si{_parse(t){const n=this._getOrReturnCtx(t);return Nn(n,{code:_n.invalid_type,expected:Un.never,received:n.parsedType}),Cr}}zh.create=e=>new zh({typeName:Er.ZodNever,...Hr(e)});class X2 extends si{_parse(t){if(this._getType(t)!==Un.undefined){const r=this._getOrReturnCtx(t);return Nn(r,{code:_n.invalid_type,expected:Un.void,received:r.parsedType}),Cr}return _s(t.data)}}X2.create=e=>new X2({typeName:Er.ZodVoid,...Hr(e)});class Mc extends si{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),a=this._def;if(n.parsedType!==Un.array)return Nn(n,{code:_n.invalid_type,expected:Un.array,received:n.parsedType}),Cr;if(a.exactLength!==null){const f=n.data.length>a.exactLength.value,i=n.data.length<a.exactLength.value;(f||i)&&(Nn(n,{code:f?_n.too_big:_n.too_small,minimum:i?a.exactLength.value:void 0,maximum:f?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Nn(n,{code:_n.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Nn(n,{code:_n.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((f,i)=>a.type._parseAsync(new Tu(n,f,n.path,i)))).then(f=>ts.mergeArray(r,f));const c=[...n.data].map((f,i)=>a.type._parseSync(new Tu(n,f,n.path,i)));return ts.mergeArray(r,c)}get element(){return this._def.type}min(t,n){return new Mc({...this._def,minLength:{value:t,message:cr.toString(n)}})}max(t,n){return new Mc({...this._def,maxLength:{value:t,message:cr.toString(n)}})}length(t,n){return new Mc({...this._def,exactLength:{value:t,message:cr.toString(n)}})}nonempty(t){return this.min(1,t)}}Mc.create=(e,t)=>new Mc({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Er.ZodArray,...Hr(t)});function By(e){if(e instanceof To){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=vu.create(By(r))}return new To({...e._def,shape:()=>t})}else return e instanceof Mc?new Mc({...e._def,type:By(e.element)}):e instanceof vu?vu.create(By(e.unwrap())):e instanceof Lf?Lf.create(By(e.unwrap())):e instanceof Eu?Eu.create(e.items.map(t=>By(t))):e}class To extends si{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Mi.objectKeys(t);return this._cached={shape:t,keys:n}}_parse(t){if(this._getType(t)!==Un.object){const b=this._getOrReturnCtx(t);return Nn(b,{code:_n.invalid_type,expected:Un.object,received:b.parsedType}),Cr}const{status:r,ctx:a}=this._processInputParams(t),{shape:c,keys:f}=this._getCached(),i=[];if(!(this._def.catchall instanceof zh&&this._def.unknownKeys==="strip"))for(const b in a.data)f.includes(b)||i.push(b);const v=[];for(const b of f){const T=c[b],A=a.data[b];v.push({key:{status:"valid",value:b},value:T._parse(new Tu(a,A,a.path,b)),alwaysSet:b in a.data})}if(this._def.catchall instanceof zh){const b=this._def.unknownKeys;if(b==="passthrough")for(const T of i)v.push({key:{status:"valid",value:T},value:{status:"valid",value:a.data[T]}});else if(b==="strict")i.length>0&&(Nn(a,{code:_n.unrecognized_keys,keys:i}),r.dirty());else if(b!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const b=this._def.catchall;for(const T of i){const A=a.data[T];v.push({key:{status:"valid",value:T},value:b._parse(new Tu(a,A,a.path,T)),alwaysSet:T in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const b=[];for(const T of v){const A=await T.key,M=await T.value;b.push({key:A,value:M,alwaysSet:T.alwaysSet})}return b}).then(b=>ts.mergeObjectSync(r,b)):ts.mergeObjectSync(r,v)}get shape(){return this._def.shape()}strict(t){return cr.errToObj,new To({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var a,c,f,i;const v=(f=(c=(a=this._def).errorMap)===null||c===void 0?void 0:c.call(a,n,r).message)!==null&&f!==void 0?f:r.defaultError;return n.code==="unrecognized_keys"?{message:(i=cr.errToObj(t).message)!==null&&i!==void 0?i:v}:{message:v}}}:{}})}strip(){return new To({...this._def,unknownKeys:"strip"})}passthrough(){return new To({...this._def,unknownKeys:"passthrough"})}extend(t){return new To({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new To({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Er.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new To({...this._def,catchall:t})}pick(t){const n={};return Mi.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new To({...this._def,shape:()=>n})}omit(t){const n={};return Mi.objectKeys(this.shape).forEach(r=>{t[r]||(n[r]=this.shape[r])}),new To({...this._def,shape:()=>n})}deepPartial(){return By(this)}partial(t){const n={};return Mi.objectKeys(this.shape).forEach(r=>{const a=this.shape[r];t&&!t[r]?n[r]=a:n[r]=a.optional()}),new To({...this._def,shape:()=>n})}required(t){const n={};return Mi.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])n[r]=this.shape[r];else{let c=this.shape[r];for(;c instanceof vu;)c=c._def.innerType;n[r]=c}}),new To({...this._def,shape:()=>n})}keyof(){return PK(Mi.objectKeys(this.shape))}}To.create=(e,t)=>new To({shape:()=>e,unknownKeys:"strip",catchall:zh.create(),typeName:Er.ZodObject,...Hr(t)});To.strictCreate=(e,t)=>new To({shape:()=>e,unknownKeys:"strict",catchall:zh.create(),typeName:Er.ZodObject,...Hr(t)});To.lazycreate=(e,t)=>new To({shape:e,unknownKeys:"strip",catchall:zh.create(),typeName:Er.ZodObject,...Hr(t)});class bb extends si{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function a(c){for(const i of c)if(i.result.status==="valid")return i.result;for(const i of c)if(i.result.status==="dirty")return n.common.issues.push(...i.ctx.common.issues),i.result;const f=c.map(i=>new gl(i.ctx.common.issues));return Nn(n,{code:_n.invalid_union,unionErrors:f}),Cr}if(n.common.async)return Promise.all(r.map(async c=>{const f={...n,common:{...n.common,issues:[]},parent:null};return{result:await c._parseAsync({data:n.data,path:n.path,parent:f}),ctx:f}})).then(a);{let c;const f=[];for(const v of r){const b={...n,common:{...n.common,issues:[]},parent:null},T=v._parseSync({data:n.data,path:n.path,parent:b});if(T.status==="valid")return T;T.status==="dirty"&&!c&&(c={result:T,ctx:b}),b.common.issues.length&&f.push(b.common.issues)}if(c)return n.common.issues.push(...c.ctx.common.issues),c.result;const i=f.map(v=>new gl(v));return Nn(n,{code:_n.invalid_union,unionErrors:i}),Cr}}get options(){return this._def.options}}bb.create=(e,t)=>new bb({options:e,typeName:Er.ZodUnion,...Hr(t)});const ph=e=>e instanceof Tb?ph(e.schema):e instanceof Fc?ph(e.innerType()):e instanceof Eb?[e.value]:e instanceof Df?e.options:e instanceof Ab?Mi.objectValues(e.enum):e instanceof Pb?ph(e._def.innerType):e instanceof vb?[void 0]:e instanceof xb?[null]:e instanceof vu?[void 0,...ph(e.unwrap())]:e instanceof Lf?[null,...ph(e.unwrap())]:e instanceof uN||e instanceof Ib?ph(e.unwrap()):e instanceof Cb?ph(e._def.innerType):[];class nC extends si{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Un.object)return Nn(n,{code:_n.invalid_type,expected:Un.object,received:n.parsedType}),Cr;const r=this.discriminator,a=n.data[r],c=this.optionsMap.get(a);return c?n.common.async?c._parseAsync({data:n.data,path:n.path,parent:n}):c._parseSync({data:n.data,path:n.path,parent:n}):(Nn(n,{code:_n.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Cr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const a=new Map;for(const c of n){const f=ph(c.shape[t]);if(!f.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const i of f){if(a.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);a.set(i,c)}}return new nC({typeName:Er.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:a,...Hr(r)})}}function SD(e,t){const n=tf(e),r=tf(t);if(e===t)return{valid:!0,data:e};if(n===Un.object&&r===Un.object){const a=Mi.objectKeys(t),c=Mi.objectKeys(e).filter(i=>a.indexOf(i)!==-1),f={...e,...t};for(const i of c){const v=SD(e[i],t[i]);if(!v.valid)return{valid:!1};f[i]=v.data}return{valid:!0,data:f}}else if(n===Un.array&&r===Un.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let c=0;c<e.length;c++){const f=e[c],i=t[c],v=SD(f,i);if(!v.valid)return{valid:!1};a.push(v.data)}return{valid:!0,data:a}}else return n===Un.date&&r===Un.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class wb extends si{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=(c,f)=>{if(bD(c)||bD(f))return Cr;const i=SD(c.value,f.value);return i.valid?((wD(c)||wD(f))&&n.dirty(),{status:n.value,value:i.data}):(Nn(r,{code:_n.invalid_intersection_types}),Cr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([c,f])=>a(c,f)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}wb.create=(e,t,n)=>new wb({left:e,right:t,typeName:Er.ZodIntersection,...Hr(n)});class Eu extends si{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Un.array)return Nn(r,{code:_n.invalid_type,expected:Un.array,received:r.parsedType}),Cr;if(r.data.length<this._def.items.length)return Nn(r,{code:_n.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Cr;!this._def.rest&&r.data.length>this._def.items.length&&(Nn(r,{code:_n.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const c=[...r.data].map((f,i)=>{const v=this._def.items[i]||this._def.rest;return v?v._parse(new Tu(r,f,r.path,i)):null}).filter(f=>!!f);return r.common.async?Promise.all(c).then(f=>ts.mergeArray(n,f)):ts.mergeArray(n,c)}get items(){return this._def.items}rest(t){return new Eu({...this._def,rest:t})}}Eu.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Eu({items:e,typeName:Er.ZodTuple,rest:null,...Hr(t)})};class Sb extends si{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Un.object)return Nn(r,{code:_n.invalid_type,expected:Un.object,received:r.parsedType}),Cr;const a=[],c=this._def.keyType,f=this._def.valueType;for(const i in r.data)a.push({key:c._parse(new Tu(r,i,r.path,i)),value:f._parse(new Tu(r,r.data[i],r.path,i)),alwaysSet:i in r.data});return r.common.async?ts.mergeObjectAsync(n,a):ts.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof si?new Sb({keyType:t,valueType:n,typeName:Er.ZodRecord,...Hr(r)}):new Sb({keyType:Pc.create(),valueType:t,typeName:Er.ZodRecord,...Hr(n)})}}class K2 extends si{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Un.map)return Nn(r,{code:_n.invalid_type,expected:Un.map,received:r.parsedType}),Cr;const a=this._def.keyType,c=this._def.valueType,f=[...r.data.entries()].map(([i,v],b)=>({key:a._parse(new Tu(r,i,r.path,[b,"key"])),value:c._parse(new Tu(r,v,r.path,[b,"value"]))}));if(r.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const v of f){const b=await v.key,T=await v.value;if(b.status==="aborted"||T.status==="aborted")return Cr;(b.status==="dirty"||T.status==="dirty")&&n.dirty(),i.set(b.value,T.value)}return{status:n.value,value:i}})}else{const i=new Map;for(const v of f){const b=v.key,T=v.value;if(b.status==="aborted"||T.status==="aborted")return Cr;(b.status==="dirty"||T.status==="dirty")&&n.dirty(),i.set(b.value,T.value)}return{status:n.value,value:i}}}}K2.create=(e,t,n)=>new K2({valueType:t,keyType:e,typeName:Er.ZodMap,...Hr(n)});class Lm extends si{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Un.set)return Nn(r,{code:_n.invalid_type,expected:Un.set,received:r.parsedType}),Cr;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Nn(r,{code:_n.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Nn(r,{code:_n.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const c=this._def.valueType;function f(v){const b=new Set;for(const T of v){if(T.status==="aborted")return Cr;T.status==="dirty"&&n.dirty(),b.add(T.value)}return{status:n.value,value:b}}const i=[...r.data.values()].map((v,b)=>c._parse(new Tu(r,v,r.path,b)));return r.common.async?Promise.all(i).then(v=>f(v)):f(i)}min(t,n){return new Lm({...this._def,minSize:{value:t,message:cr.toString(n)}})}max(t,n){return new Lm({...this._def,maxSize:{value:t,message:cr.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Lm.create=(e,t)=>new Lm({valueType:e,minSize:null,maxSize:null,typeName:Er.ZodSet,...Hr(t)});class d_ extends si{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Un.function)return Nn(n,{code:_n.invalid_type,expected:Un.function,received:n.parsedType}),Cr;function r(i,v){return H2({data:i,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,W2(),k_].filter(b=>!!b),issueData:{code:_n.invalid_arguments,argumentsError:v}})}function a(i,v){return H2({data:i,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,W2(),k_].filter(b=>!!b),issueData:{code:_n.invalid_return_type,returnTypeError:v}})}const c={errorMap:n.common.contextualErrorMap},f=n.data;if(this._def.returns instanceof D_){const i=this;return _s(async function(...v){const b=new gl([]),T=await i._def.args.parseAsync(v,c).catch(R=>{throw b.addIssue(r(v,R)),b}),A=await Reflect.apply(f,this,T);return await i._def.returns._def.type.parseAsync(A,c).catch(R=>{throw b.addIssue(a(A,R)),b})})}else{const i=this;return _s(function(...v){const b=i._def.args.safeParse(v,c);if(!b.success)throw new gl([r(v,b.error)]);const T=Reflect.apply(f,this,b.data),A=i._def.returns.safeParse(T,c);if(!A.success)throw new gl([a(T,A.error)]);return A.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new d_({...this._def,args:Eu.create(t).rest(bm.create())})}returns(t){return new d_({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new d_({args:t||Eu.create([]).rest(bm.create()),returns:n||bm.create(),typeName:Er.ZodFunction,...Hr(r)})}}class Tb extends si{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Tb.create=(e,t)=>new Tb({getter:e,typeName:Er.ZodLazy,...Hr(t)});class Eb extends si{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Nn(n,{received:n.data,code:_n.invalid_literal,expected:this._def.value}),Cr}return{status:"valid",value:t.data}}get value(){return this._def.value}}Eb.create=(e,t)=>new Eb({value:e,typeName:Er.ZodLiteral,...Hr(t)});function PK(e,t){return new Df({values:e,typeName:Er.ZodEnum,...Hr(t)})}class Df extends si{constructor(){super(...arguments),p1.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Nn(n,{expected:Mi.joinValues(r),received:n.parsedType,code:_n.invalid_type}),Cr}if(q2(this,p1)||SK(this,p1,new Set(this._def.values)),!q2(this,p1).has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Nn(n,{received:n.data,code:_n.invalid_enum_value,options:r}),Cr}return _s(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Df.create(t,{...this._def,...n})}exclude(t,n=this._def){return Df.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}p1=new WeakMap;Df.create=PK;class Ab extends si{constructor(){super(...arguments),m1.set(this,void 0)}_parse(t){const n=Mi.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==Un.string&&r.parsedType!==Un.number){const a=Mi.objectValues(n);return Nn(r,{expected:Mi.joinValues(a),received:r.parsedType,code:_n.invalid_type}),Cr}if(q2(this,m1)||SK(this,m1,new Set(Mi.getValidEnumValues(this._def.values))),!q2(this,m1).has(t.data)){const a=Mi.objectValues(n);return Nn(r,{received:r.data,code:_n.invalid_enum_value,options:a}),Cr}return _s(t.data)}get enum(){return this._def.values}}m1=new WeakMap;Ab.create=(e,t)=>new Ab({values:e,typeName:Er.ZodNativeEnum,...Hr(t)});class D_ extends si{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Un.promise&&n.common.async===!1)return Nn(n,{code:_n.invalid_type,expected:Un.promise,received:n.parsedType}),Cr;const r=n.parsedType===Un.promise?n.data:Promise.resolve(n.data);return _s(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}D_.create=(e,t)=>new D_({type:e,typeName:Er.ZodPromise,...Hr(t)});class Fc extends si{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Er.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=this._def.effect||null,c={addIssue:f=>{Nn(r,f),f.fatal?n.abort():n.dirty()},get path(){return r.path}};if(c.addIssue=c.addIssue.bind(c),a.type==="preprocess"){const f=a.transform(r.data,c);if(r.common.async)return Promise.resolve(f).then(async i=>{if(n.value==="aborted")return Cr;const v=await this._def.schema._parseAsync({data:i,path:r.path,parent:r});return v.status==="aborted"?Cr:v.status==="dirty"||n.value==="dirty"?Jy(v.value):v});{if(n.value==="aborted")return Cr;const i=this._def.schema._parseSync({data:f,path:r.path,parent:r});return i.status==="aborted"?Cr:i.status==="dirty"||n.value==="dirty"?Jy(i.value):i}}if(a.type==="refinement"){const f=i=>{const v=a.refinement(i,c);if(r.common.async)return Promise.resolve(v);if(v instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Cr:(i.status==="dirty"&&n.dirty(),f(i.value),{status:n.value,value:i.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>i.status==="aborted"?Cr:(i.status==="dirty"&&n.dirty(),f(i.value).then(()=>({status:n.value,value:i.value}))))}if(a.type==="transform")if(r.common.async===!1){const f=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!gb(f))return f;const i=a.transform(f.value,c);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:i}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(f=>gb(f)?Promise.resolve(a.transform(f.value,c)).then(i=>({status:n.value,value:i})):f);Mi.assertNever(a)}}Fc.create=(e,t,n)=>new Fc({schema:e,typeName:Er.ZodEffects,effect:t,...Hr(n)});Fc.createWithPreprocess=(e,t,n)=>new Fc({schema:t,effect:{type:"preprocess",transform:e},typeName:Er.ZodEffects,...Hr(n)});class vu extends si{_parse(t){return this._getType(t)===Un.undefined?_s(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}vu.create=(e,t)=>new vu({innerType:e,typeName:Er.ZodOptional,...Hr(t)});class Lf extends si{_parse(t){return this._getType(t)===Un.null?_s(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Lf.create=(e,t)=>new Lf({innerType:e,typeName:Er.ZodNullable,...Hr(t)});class Pb extends si{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===Un.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Pb.create=(e,t)=>new Pb({innerType:e,typeName:Er.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Hr(t)});class Cb extends si{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return yb(a)?a.then(c=>({status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new gl(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new gl(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Cb.create=(e,t)=>new Cb({innerType:e,typeName:Er.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Hr(t)});class Y2 extends si{_parse(t){if(this._getType(t)!==Un.nan){const r=this._getOrReturnCtx(t);return Nn(r,{code:_n.invalid_type,expected:Un.nan,received:r.parsedType}),Cr}return{status:"valid",value:t.data}}}Y2.create=e=>new Y2({typeName:Er.ZodNaN,...Hr(e)});const q0e=Symbol("zod_brand");class uN extends si{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Lw extends si{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const c=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?Cr:c.status==="dirty"?(n.dirty(),Jy(c.value)):this._def.out._parseAsync({data:c.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Cr:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(t,n){return new Lw({in:t,out:n,typeName:Er.ZodPipeline})}}class Ib extends si{_parse(t){const n=this._def.innerType._parse(t),r=a=>(gb(a)&&(a.value=Object.freeze(a.value)),a);return yb(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}Ib.create=(e,t)=>new Ib({innerType:e,typeName:Er.ZodReadonly,...Hr(t)});function CK(e,t={},n){return e?R_.create().superRefine((r,a)=>{var c,f;if(!e(r)){const i=typeof t=="function"?t(r):typeof t=="string"?{message:t}:t,v=(f=(c=i.fatal)!==null&&c!==void 0?c:n)!==null&&f!==void 0?f:!0,b=typeof i=="string"?{message:i}:i;a.addIssue({code:"custom",...b,fatal:v})}}):R_.create()}const Z0e={object:To.lazycreate};var Er;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Er||(Er={}));const X0e=(e,t={message:`Input not instance of ${e.name}`})=>CK(n=>n instanceof e,t),IK=Pc.create,MK=kf.create,K0e=Y2.create,Y0e=Rf.create,OK=_b.create,J0e=Dm.create,Q0e=Z2.create,exe=vb.create,txe=xb.create,nxe=R_.create,rxe=bm.create,ixe=zh.create,oxe=X2.create,axe=Mc.create,sxe=To.create,lxe=To.strictCreate,cxe=bb.create,uxe=nC.create,hxe=wb.create,dxe=Eu.create,fxe=Sb.create,pxe=K2.create,mxe=Lm.create,gxe=d_.create,yxe=Tb.create,_xe=Eb.create,vxe=Df.create,xxe=Ab.create,bxe=D_.create,uV=Fc.create,wxe=vu.create,Sxe=Lf.create,Txe=Fc.createWithPreprocess,Exe=Lw.create,Axe=()=>IK().optional(),Pxe=()=>MK().optional(),Cxe=()=>OK().optional(),Ixe={string:e=>Pc.create({...e,coerce:!0}),number:e=>kf.create({...e,coerce:!0}),boolean:e=>_b.create({...e,coerce:!0}),bigint:e=>Rf.create({...e,coerce:!0}),date:e=>Dm.create({...e,coerce:!0})},Mxe=Cr;var aXe=Object.freeze({__proto__:null,defaultErrorMap:k_,setErrorMap:M0e,getErrorMap:W2,makeIssue:H2,EMPTY_PATH:O0e,addIssueToContext:Nn,ParseStatus:ts,INVALID:Cr,DIRTY:Jy,OK:_s,isAborted:bD,isDirty:wD,isValid:gb,isAsync:yb,get util(){return Mi},get objectUtil(){return xD},ZodParsedType:Un,getParsedType:tf,ZodType:si,datetimeRegex:AK,ZodString:Pc,ZodNumber:kf,ZodBigInt:Rf,ZodBoolean:_b,ZodDate:Dm,ZodSymbol:Z2,ZodUndefined:vb,ZodNull:xb,ZodAny:R_,ZodUnknown:bm,ZodNever:zh,ZodVoid:X2,ZodArray:Mc,ZodObject:To,ZodUnion:bb,ZodDiscriminatedUnion:nC,ZodIntersection:wb,ZodTuple:Eu,ZodRecord:Sb,ZodMap:K2,ZodSet:Lm,ZodFunction:d_,ZodLazy:Tb,ZodLiteral:Eb,ZodEnum:Df,ZodNativeEnum:Ab,ZodPromise:D_,ZodEffects:Fc,ZodTransformer:Fc,ZodOptional:vu,ZodNullable:Lf,ZodDefault:Pb,ZodCatch:Cb,ZodNaN:Y2,BRAND:q0e,ZodBranded:uN,ZodPipeline:Lw,ZodReadonly:Ib,custom:CK,Schema:si,ZodSchema:si,late:Z0e,get ZodFirstPartyTypeKind(){return Er},coerce:Ixe,any:nxe,array:axe,bigint:Y0e,boolean:OK,date:J0e,discriminatedUnion:uxe,effect:uV,enum:vxe,function:gxe,instanceof:X0e,intersection:hxe,lazy:yxe,literal:_xe,map:pxe,nan:K0e,nativeEnum:xxe,never:ixe,null:txe,nullable:Sxe,number:MK,object:sxe,oboolean:Cxe,onumber:Pxe,optional:wxe,ostring:Axe,pipeline:Exe,preprocess:Txe,promise:bxe,record:fxe,set:mxe,strictObject:lxe,string:IK,symbol:Q0e,transformer:uV,tuple:dxe,undefined:exe,union:cxe,unknown:rxe,void:oxe,NEVER:Mxe,ZodIssueCode:_n,quotelessJson:I0e,ZodError:gl}),zw=e=>e.type==="checkbox",fm=e=>e instanceof Date,hs=e=>e==null;const kK=e=>typeof e=="object";var jo=e=>!hs(e)&&!Array.isArray(e)&&kK(e)&&!fm(e),RK=e=>jo(e)&&e.target?zw(e.target)?e.target.checked:e.target.value:e,Oxe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,DK=(e,t)=>e.has(Oxe(t)),kxe=e=>{const t=e.constructor&&e.constructor.prototype;return jo(t)&&t.hasOwnProperty("isPrototypeOf")},hN=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Rs(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(hN&&(e instanceof Blob||e instanceof FileList))&&(n||jo(e)))if(t=n?[]:{},!n&&!kxe(e))t=e;else for(const r in e)e.hasOwnProperty(r)&&(t[r]=Rs(e[r]));else return e;return t}var rC=e=>Array.isArray(e)?e.filter(Boolean):[],Ro=e=>e===void 0,On=(e,t,n)=>{if(!t||!jo(e))return n;const r=rC(t.split(/[,[\].]+?/)).reduce((a,c)=>hs(a)?a:a[c],e);return Ro(r)||r===e?Ro(e[t])?n:e[t]:r},Dl=e=>typeof e=="boolean",dN=e=>/^\w*$/.test(e),LK=e=>rC(e.replace(/["|']|\]/g,"").split(/\.|\[/)),$i=(e,t,n)=>{let r=-1;const a=dN(t)?[t]:LK(t),c=a.length,f=c-1;for(;++r<c;){const i=a[r];let v=n;if(r!==f){const b=e[i];v=jo(b)||Array.isArray(b)?b:isNaN(+a[r+1])?{}:[]}if(i==="__proto__")return;e[i]=v,e=e[i]}return e};const J2={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ec={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},uh={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},zK=Se.createContext(null),fN=()=>Se.useContext(zK),sXe=e=>{const{children:t,...n}=e;return Se.createElement(zK.Provider,{value:n},t)};var NK=(e,t,n,r=!0)=>{const a={defaultValues:t._defaultValues};for(const c in e)Object.defineProperty(a,c,{get:()=>{const f=c;return t._proxyFormState[f]!==Ec.all&&(t._proxyFormState[f]=!r||Ec.all),n&&(n[f]=!0),e[f]}});return a},Ds=e=>jo(e)&&!Object.keys(e).length,FK=(e,t,n,r)=>{n(e);const{name:a,...c}=e;return Ds(c)||Object.keys(c).length>=Object.keys(t).length||Object.keys(c).find(f=>t[f]===(!r||Ec.all))},D1=e=>Array.isArray(e)?e:[e],BK=(e,t,n)=>!e||!t||e===t||D1(e).some(r=>r&&(n?r===t:r.startsWith(t)||t.startsWith(r)));function pN(e){const t=Se.useRef(e);t.current=e,Se.useEffect(()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}},[e.disabled])}function Rxe(e){const t=fN(),{control:n=t.control,disabled:r,name:a,exact:c}=e||{},[f,i]=Se.useState(n._formState),v=Se.useRef(!0),b=Se.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),T=Se.useRef(a);return T.current=a,pN({disabled:r,next:A=>v.current&&BK(T.current,A.name,c)&&FK(A,b.current,n._updateFormState)&&i({...n._formState,...A}),subject:n._subjects.state}),Se.useEffect(()=>(v.current=!0,b.current.isValid&&n._updateValid(!0),()=>{v.current=!1}),[n]),NK(f,n,b.current,!1)}var pu=e=>typeof e=="string",jK=(e,t,n,r,a)=>pu(e)?(r&&t.watch.add(e),On(n,e,a)):Array.isArray(e)?e.map(c=>(r&&t.watch.add(c),On(n,c))):(r&&(t.watchAll=!0),n);function Dxe(e){const t=fN(),{control:n=t.control,name:r,defaultValue:a,disabled:c,exact:f}=e||{},i=Se.useRef(r);i.current=r,pN({disabled:c,subject:n._subjects.values,next:T=>{BK(i.current,T.name,f)&&b(Rs(jK(i.current,n._names,T.values||n._formValues,!1,a)))}});const[v,b]=Se.useState(n._getWatch(r,a));return Se.useEffect(()=>n._removeUnmounted()),v}function Lxe(e){const t=fN(),{name:n,disabled:r,control:a=t.control,shouldUnregister:c}=e,f=DK(a._names.array,n),i=Dxe({control:a,name:n,defaultValue:On(a._formValues,n,On(a._defaultValues,n,e.defaultValue)),exact:!0}),v=Rxe({control:a,name:n,exact:!0}),b=Se.useRef(a.register(n,{...e.rules,value:i,...Dl(e.disabled)?{disabled:e.disabled}:{}}));return Se.useEffect(()=>{const T=a._options.shouldUnregister||c,A=(M,R)=>{const B=On(a._fields,M);B&&B._f&&(B._f.mount=R)};if(A(n,!0),T){const M=Rs(On(a._options.defaultValues,n));$i(a._defaultValues,n,M),Ro(On(a._formValues,n))&&$i(a._formValues,n,M)}return()=>{(f?T&&!a._state.action:T)?a.unregister(n):A(n,!1)}},[n,a,f,c]),Se.useEffect(()=>{On(a._fields,n)&&a._updateDisabledField({disabled:r,fields:a._fields,name:n,value:On(a._fields,n)._f.value})},[r,n,a]),{field:{name:n,value:i,...Dl(r)||v.disabled?{disabled:v.disabled||r}:{},onChange:Se.useCallback(T=>b.current.onChange({target:{value:RK(T),name:n},type:J2.CHANGE}),[n]),onBlur:Se.useCallback(()=>b.current.onBlur({target:{value:On(a._formValues,n),name:n},type:J2.BLUR}),[n,a]),ref:Se.useCallback(T=>{const A=On(a._fields,n);A&&T&&(A._f.ref={focus:()=>T.focus(),select:()=>T.select(),setCustomValidity:M=>T.setCustomValidity(M),reportValidity:()=>T.reportValidity()})},[a._fields,n])},formState:v,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!On(v.errors,n)},isDirty:{enumerable:!0,get:()=>!!On(v.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!On(v.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!On(v.validatingFields,n)},error:{enumerable:!0,get:()=>On(v.errors,n)}})}}const lXe=e=>e.render(Lxe(e));var $K=(e,t,n,r,a)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:a||!0}}:{},hV=e=>({isOnSubmit:!e||e===Ec.onSubmit,isOnBlur:e===Ec.onBlur,isOnChange:e===Ec.onChange,isOnAll:e===Ec.all,isOnTouch:e===Ec.onTouched}),dV=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length))));const L1=(e,t,n,r)=>{for(const a of n||Object.keys(e)){const c=On(e,a);if(c){const{_f:f,...i}=c;if(f){if(f.refs&&f.refs[0]&&t(f.refs[0],a)&&!r)return!0;if(f.ref&&t(f.ref,f.name)&&!r)return!0;if(L1(i,t))break}else if(jo(i)&&L1(i,t))break}}};var zxe=(e,t,n)=>{const r=D1(On(e,n));return $i(r,"root",t[n]),$i(e,n,r),e},mN=e=>e.type==="file",Sh=e=>typeof e=="function",Q2=e=>{if(!hN)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},e2=e=>pu(e),gN=e=>e.type==="radio",eA=e=>e instanceof RegExp;const fV={value:!1,isValid:!1},pV={value:!0,isValid:!0};var UK=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Ro(e[0].attributes.value)?Ro(e[0].value)||e[0].value===""?pV:{value:e[0].value,isValid:!0}:pV:fV}return fV};const mV={isValid:!1,value:null};var VK=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,mV):mV;function gV(e,t,n="validate"){if(e2(e)||Array.isArray(e)&&e.every(e2)||Dl(e)&&!e)return{type:n,message:e2(e)?e:"",ref:t}}var ky=e=>jo(e)&&!eA(e)?e:{value:e,message:""},yV=async(e,t,n,r,a)=>{const{ref:c,refs:f,required:i,maxLength:v,minLength:b,min:T,max:A,pattern:M,validate:R,name:B,valueAsNumber:L,mount:j,disabled:V}=e._f,$=On(t,B);if(!j||V)return{};const H=f?f[0]:c,K=Re=>{r&&H.reportValidity&&(H.setCustomValidity(Dl(Re)?"":Re||""),H.reportValidity())},Y={},se=gN(c),ce=zw(c),ye=se||ce,ze=(L||mN(c))&&Ro(c.value)&&Ro($)||Q2(c)&&c.value===""||$===""||Array.isArray($)&&!$.length,Le=$K.bind(null,B,n,Y),je=(Re,$e,Ge,ht=uh.maxLength,ot=uh.minLength)=>{const Je=Re?$e:Ge;Y[B]={type:Re?ht:ot,message:Je,ref:c,...Le(Re?ht:ot,Je)}};if(a?!Array.isArray($)||!$.length:i&&(!ye&&(ze||hs($))||Dl($)&&!$||ce&&!UK(f).isValid||se&&!VK(f).isValid)){const{value:Re,message:$e}=e2(i)?{value:!!i,message:i}:ky(i);if(Re&&(Y[B]={type:uh.required,message:$e,ref:H,...Le(uh.required,$e)},!n))return K($e),Y}if(!ze&&(!hs(T)||!hs(A))){let Re,$e;const Ge=ky(A),ht=ky(T);if(!hs($)&&!isNaN($)){const ot=c.valueAsNumber||$&&+$;hs(Ge.value)||(Re=ot>Ge.value),hs(ht.value)||($e=ot<ht.value)}else{const ot=c.valueAsDate||new Date($),Je=pt=>new Date(new Date().toDateString()+" "+pt),Ne=c.type=="time",Xe=c.type=="week";pu(Ge.value)&&$&&(Re=Ne?Je($)>Je(Ge.value):Xe?$>Ge.value:ot>new Date(Ge.value)),pu(ht.value)&&$&&($e=Ne?Je($)<Je(ht.value):Xe?$<ht.value:ot<new Date(ht.value))}if((Re||$e)&&(je(!!Re,Ge.message,ht.message,uh.max,uh.min),!n))return K(Y[B].message),Y}if((v||b)&&!ze&&(pu($)||a&&Array.isArray($))){const Re=ky(v),$e=ky(b),Ge=!hs(Re.value)&&$.length>+Re.value,ht=!hs($e.value)&&$.length<+$e.value;if((Ge||ht)&&(je(Ge,Re.message,$e.message),!n))return K(Y[B].message),Y}if(M&&!ze&&pu($)){const{value:Re,message:$e}=ky(M);if(eA(Re)&&!$.match(Re)&&(Y[B]={type:uh.pattern,message:$e,ref:c,...Le(uh.pattern,$e)},!n))return K($e),Y}if(R){if(Sh(R)){const Re=await R($,t),$e=gV(Re,H);if($e&&(Y[B]={...$e,...Le(uh.validate,$e.message)},!n))return K($e.message),Y}else if(jo(R)){let Re={};for(const $e in R){if(!Ds(Re)&&!n)break;const Ge=gV(await R[$e]($,t),H,$e);Ge&&(Re={...Ge,...Le($e,Ge.message)},K(Ge.message),n&&(Y[B]=Re))}if(!Ds(Re)&&(Y[B]={ref:H,...Re},!n))return Y}}return K(!0),Y};function Nxe(e,t){const n=t.slice(0,-1).length;let r=0;for(;r<n;)e=Ro(e)?r++:e[t[r++]];return e}function Fxe(e){for(const t in e)if(e.hasOwnProperty(t)&&!Ro(e[t]))return!1;return!0}function ra(e,t){const n=Array.isArray(t)?t:dN(t)?[t]:LK(t),r=n.length===1?e:Nxe(e,n),a=n.length-1,c=n[a];return r&&delete r[c],a!==0&&(jo(r)&&Ds(r)||Array.isArray(r)&&Fxe(r))&&ra(e,n.slice(0,-1)),e}var dk=()=>{let e=[];return{get observers(){return e},next:a=>{for(const c of e)c.next&&c.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(c=>c!==a)}}),unsubscribe:()=>{e=[]}}},TD=e=>hs(e)||!kK(e);function nf(e,t){if(TD(e)||TD(t))return e===t;if(fm(e)&&fm(t))return e.getTime()===t.getTime();const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const a of n){const c=e[a];if(!r.includes(a))return!1;if(a!=="ref"){const f=t[a];if(fm(c)&&fm(f)||jo(c)&&jo(f)||Array.isArray(c)&&Array.isArray(f)?!nf(c,f):c!==f)return!1}}return!0}var GK=e=>e.type==="select-multiple",Bxe=e=>gN(e)||zw(e),fk=e=>Q2(e)&&e.isConnected,WK=e=>{for(const t in e)if(Sh(e[t]))return!0;return!1};function tA(e,t={}){const n=Array.isArray(e);if(jo(e)||n)for(const r in e)Array.isArray(e[r])||jo(e[r])&&!WK(e[r])?(t[r]=Array.isArray(e[r])?[]:{},tA(e[r],t[r])):hs(e[r])||(t[r]=!0);return t}function HK(e,t,n){const r=Array.isArray(e);if(jo(e)||r)for(const a in e)Array.isArray(e[a])||jo(e[a])&&!WK(e[a])?Ro(t)||TD(n[a])?n[a]=Array.isArray(e[a])?tA(e[a],[]):{...tA(e[a])}:HK(e[a],hs(t)?{}:t[a],n[a]):n[a]=!nf(e[a],t[a]);return n}var Zx=(e,t)=>HK(e,t,tA(t)),qK=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>Ro(e)?e:t?e===""?NaN:e&&+e:n&&pu(e)?new Date(e):r?r(e):e;function pk(e){const t=e.ref;if(!(e.refs?e.refs.every(n=>n.disabled):t.disabled))return mN(t)?t.files:gN(t)?VK(e.refs).value:GK(t)?[...t.selectedOptions].map(({value:n})=>n):zw(t)?UK(e.refs).value:qK(Ro(t.value)?e.ref.value:t.value,e)}var jxe=(e,t,n,r)=>{const a={};for(const c of e){const f=On(t,c);f&&$i(a,c,f._f)}return{criteriaMode:n,names:[...e],fields:a,shouldUseNativeValidation:r}},Xx=e=>Ro(e)?e:eA(e)?e.source:jo(e)?eA(e.value)?e.value.source:e.value:e;const _V="AsyncFunction";var $xe=e=>(!e||!e.validate)&&!!(Sh(e.validate)&&e.validate.constructor.name===_V||jo(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===_V)),Uxe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function vV(e,t,n){const r=On(e,n);if(r||dN(n))return{error:r,name:n};const a=n.split(".");for(;a.length;){const c=a.join("."),f=On(t,c),i=On(e,c);if(f&&!Array.isArray(f)&&n!==c)return{name:n};if(i&&i.type)return{name:c,error:i};a.pop()}return{name:n}}var Vxe=(e,t,n,r,a)=>a.isOnAll?!1:!n&&a.isOnTouch?!(t||e):(n?r.isOnBlur:a.isOnBlur)?!e:(n?r.isOnChange:a.isOnChange)?e:!0,Gxe=(e,t)=>!rC(On(e,t)).length&&ra(e,t);const Wxe={mode:Ec.onSubmit,reValidateMode:Ec.onChange,shouldFocusError:!0};function Hxe(e={}){let t={...Wxe,...e},n={submitCount:0,isDirty:!1,isLoading:Sh(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},a=jo(t.defaultValues)||jo(t.values)?Rs(t.defaultValues||t.values)||{}:{},c=t.shouldUnregister?{}:Rs(a),f={action:!1,mount:!1,watch:!1},i={mount:new Set,unMount:new Set,array:new Set,watch:new Set},v,b=0;const T={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},A={values:dk(),array:dk(),state:dk()},M=hV(t.mode),R=hV(t.reValidateMode),B=t.criteriaMode===Ec.all,L=Ye=>wt=>{clearTimeout(b),b=setTimeout(Ye,wt)},j=async Ye=>{if(!e.disabled&&(T.isValid||Ye)){const wt=t.resolver?Ds((await ye()).errors):await Le(r,!0);wt!==n.isValid&&A.state.next({isValid:wt})}},V=(Ye,wt)=>{!e.disabled&&(T.isValidating||T.validatingFields)&&((Ye||Array.from(i.mount)).forEach(Rt=>{Rt&&(wt?$i(n.validatingFields,Rt,wt):ra(n.validatingFields,Rt))}),A.state.next({validatingFields:n.validatingFields,isValidating:!Ds(n.validatingFields)}))},$=(Ye,wt=[],Rt,pn,dn=!0,sn=!0)=>{if(pn&&Rt&&!e.disabled){if(f.action=!0,sn&&Array.isArray(On(r,Ye))){const Ln=Rt(On(r,Ye),pn.argA,pn.argB);dn&&$i(r,Ye,Ln)}if(sn&&Array.isArray(On(n.errors,Ye))){const Ln=Rt(On(n.errors,Ye),pn.argA,pn.argB);dn&&$i(n.errors,Ye,Ln),Gxe(n.errors,Ye)}if(T.touchedFields&&sn&&Array.isArray(On(n.touchedFields,Ye))){const Ln=Rt(On(n.touchedFields,Ye),pn.argA,pn.argB);dn&&$i(n.touchedFields,Ye,Ln)}T.dirtyFields&&(n.dirtyFields=Zx(a,c)),A.state.next({name:Ye,isDirty:Re(Ye,wt),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else $i(c,Ye,wt)},H=(Ye,wt)=>{$i(n.errors,Ye,wt),A.state.next({errors:n.errors})},K=Ye=>{n.errors=Ye,A.state.next({errors:n.errors,isValid:!1})},Y=(Ye,wt,Rt,pn)=>{const dn=On(r,Ye);if(dn){const sn=On(c,Ye,Ro(Rt)?On(a,Ye):Rt);Ro(sn)||pn&&pn.defaultChecked||wt?$i(c,Ye,wt?sn:pk(dn._f)):ht(Ye,sn),f.mount&&j()}},se=(Ye,wt,Rt,pn,dn)=>{let sn=!1,Ln=!1;const ur={name:Ye};if(!e.disabled){const li=!!(On(r,Ye)&&On(r,Ye)._f&&On(r,Ye)._f.disabled);if(!Rt||pn){T.isDirty&&(Ln=n.isDirty,n.isDirty=ur.isDirty=Re(),sn=Ln!==ur.isDirty);const Si=li||nf(On(a,Ye),wt);Ln=!!(!li&&On(n.dirtyFields,Ye)),Si||li?ra(n.dirtyFields,Ye):$i(n.dirtyFields,Ye,!0),ur.dirtyFields=n.dirtyFields,sn=sn||T.dirtyFields&&Ln!==!Si}if(Rt){const Si=On(n.touchedFields,Ye);Si||($i(n.touchedFields,Ye,Rt),ur.touchedFields=n.touchedFields,sn=sn||T.touchedFields&&Si!==Rt)}sn&&dn&&A.state.next(ur)}return sn?ur:{}},ce=(Ye,wt,Rt,pn)=>{const dn=On(n.errors,Ye),sn=T.isValid&&Dl(wt)&&n.isValid!==wt;if(e.delayError&&Rt?(v=L(()=>H(Ye,Rt)),v(e.delayError)):(clearTimeout(b),v=null,Rt?$i(n.errors,Ye,Rt):ra(n.errors,Ye)),(Rt?!nf(dn,Rt):dn)||!Ds(pn)||sn){const Ln={...pn,...sn&&Dl(wt)?{isValid:wt}:{},errors:n.errors,name:Ye};n={...n,...Ln},A.state.next(Ln)}},ye=async Ye=>{V(Ye,!0);const wt=await t.resolver(c,t.context,jxe(Ye||i.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return V(Ye),wt},ze=async Ye=>{const{errors:wt}=await ye(Ye);if(Ye)for(const Rt of Ye){const pn=On(wt,Rt);pn?$i(n.errors,Rt,pn):ra(n.errors,Rt)}else n.errors=wt;return wt},Le=async(Ye,wt,Rt={valid:!0})=>{for(const pn in Ye){const dn=Ye[pn];if(dn){const{_f:sn,...Ln}=dn;if(sn){const ur=i.array.has(sn.name),li=dn._f&&$xe(dn._f);li&&T.validatingFields&&V([pn],!0);const Si=await yV(dn,c,B,t.shouldUseNativeValidation&&!wt,ur);if(li&&T.validatingFields&&V([pn]),Si[sn.name]&&(Rt.valid=!1,wt))break;!wt&&(On(Si,sn.name)?ur?zxe(n.errors,Si,sn.name):$i(n.errors,sn.name,Si[sn.name]):ra(n.errors,sn.name))}!Ds(Ln)&&await Le(Ln,wt,Rt)}}return Rt.valid},je=()=>{for(const Ye of i.unMount){const wt=On(r,Ye);wt&&(wt._f.refs?wt._f.refs.every(Rt=>!fk(Rt)):!fk(wt._f.ref))&&Cn(Ye)}i.unMount=new Set},Re=(Ye,wt)=>!e.disabled&&(Ye&&wt&&$i(c,Ye,wt),!nf(zt(),a)),$e=(Ye,wt,Rt)=>jK(Ye,i,{...f.mount?c:Ro(wt)?a:pu(Ye)?{[Ye]:wt}:wt},Rt,wt),Ge=Ye=>rC(On(f.mount?c:a,Ye,e.shouldUnregister?On(a,Ye,[]):[])),ht=(Ye,wt,Rt={})=>{const pn=On(r,Ye);let dn=wt;if(pn){const sn=pn._f;sn&&(!sn.disabled&&$i(c,Ye,qK(wt,sn)),dn=Q2(sn.ref)&&hs(wt)?"":wt,GK(sn.ref)?[...sn.ref.options].forEach(Ln=>Ln.selected=dn.includes(Ln.value)):sn.refs?zw(sn.ref)?sn.refs.length>1?sn.refs.forEach(Ln=>(!Ln.defaultChecked||!Ln.disabled)&&(Ln.checked=Array.isArray(dn)?!!dn.find(ur=>ur===Ln.value):dn===Ln.value)):sn.refs[0]&&(sn.refs[0].checked=!!dn):sn.refs.forEach(Ln=>Ln.checked=Ln.value===dn):mN(sn.ref)?sn.ref.value="":(sn.ref.value=dn,sn.ref.type||A.values.next({name:Ye,values:{...c}})))}(Rt.shouldDirty||Rt.shouldTouch)&&se(Ye,dn,Rt.shouldTouch,Rt.shouldDirty,!0),Rt.shouldValidate&&pt(Ye)},ot=(Ye,wt,Rt)=>{for(const pn in wt){const dn=wt[pn],sn=`${Ye}.${pn}`,Ln=On(r,sn);(i.array.has(Ye)||jo(dn)||Ln&&!Ln._f)&&!fm(dn)?ot(sn,dn,Rt):ht(sn,dn,Rt)}},Je=(Ye,wt,Rt={})=>{const pn=On(r,Ye),dn=i.array.has(Ye),sn=Rs(wt);$i(c,Ye,sn),dn?(A.array.next({name:Ye,values:{...c}}),(T.isDirty||T.dirtyFields)&&Rt.shouldDirty&&A.state.next({name:Ye,dirtyFields:Zx(a,c),isDirty:Re(Ye,sn)})):pn&&!pn._f&&!hs(sn)?ot(Ye,sn,Rt):ht(Ye,sn,Rt),dV(Ye,i)&&A.state.next({...n}),A.values.next({name:f.mount?Ye:void 0,values:{...c}})},Ne=async Ye=>{f.mount=!0;const wt=Ye.target;let Rt=wt.name,pn=!0;const dn=On(r,Rt),sn=()=>wt.type?pk(dn._f):RK(Ye),Ln=ur=>{pn=Number.isNaN(ur)||fm(ur)&&isNaN(ur.getTime())||nf(ur,On(c,Rt,ur))};if(dn){let ur,li;const Si=sn(),la=Ye.type===J2.BLUR||Ye.type===J2.FOCUS_OUT,La=!Uxe(dn._f)&&!t.resolver&&!On(n.errors,Rt)&&!dn._f.deps||Vxe(la,On(n.touchedFields,Rt),n.isSubmitted,R,M),Uo=dV(Rt,i,la);$i(c,Rt,Si),la?(dn._f.onBlur&&dn._f.onBlur(Ye),v&&v(0)):dn._f.onChange&&dn._f.onChange(Ye);const vo=se(Rt,Si,la,!1),ws=!Ds(vo)||Uo;if(!la&&A.values.next({name:Rt,type:Ye.type,values:{...c}}),La)return T.isValid&&(e.mode==="onBlur"?la&&j():j()),ws&&A.state.next({name:Rt,...Uo?{}:vo});if(!la&&Uo&&A.state.next({...n}),t.resolver){const{errors:Ta}=await ye([Rt]);if(Ln(Si),pn){const Lo=vV(n.errors,r,Rt),ns=vV(Ta,r,Lo.name||Rt);ur=ns.error,Rt=ns.name,li=Ds(Ta)}}else V([Rt],!0),ur=(await yV(dn,c,B,t.shouldUseNativeValidation))[Rt],V([Rt]),Ln(Si),pn&&(ur?li=!1:T.isValid&&(li=await Le(r,!0)));pn&&(dn._f.deps&&pt(dn._f.deps),ce(Rt,li,ur,vo))}},Xe=(Ye,wt)=>{if(On(n.errors,wt)&&Ye.focus)return Ye.focus(),1},pt=async(Ye,wt={})=>{let Rt,pn;const dn=D1(Ye);if(t.resolver){const sn=await ze(Ro(Ye)?Ye:dn);Rt=Ds(sn),pn=Ye?!dn.some(Ln=>On(sn,Ln)):Rt}else Ye?(pn=(await Promise.all(dn.map(async sn=>{const Ln=On(r,sn);return await Le(Ln&&Ln._f?{[sn]:Ln}:Ln)}))).every(Boolean),!(!pn&&!n.isValid)&&j()):pn=Rt=await Le(r);return A.state.next({...!pu(Ye)||T.isValid&&Rt!==n.isValid?{}:{name:Ye},...t.resolver||!Ye?{isValid:Rt}:{},errors:n.errors}),wt.shouldFocus&&!pn&&L1(r,Xe,Ye?dn:i.mount),pn},zt=Ye=>{const wt={...f.mount?c:a};return Ro(Ye)?wt:pu(Ye)?On(wt,Ye):Ye.map(Rt=>On(wt,Rt))},Ft=(Ye,wt)=>({invalid:!!On((wt||n).errors,Ye),isDirty:!!On((wt||n).dirtyFields,Ye),error:On((wt||n).errors,Ye),isValidating:!!On(n.validatingFields,Ye),isTouched:!!On((wt||n).touchedFields,Ye)}),un=Ye=>{Ye&&D1(Ye).forEach(wt=>ra(n.errors,wt)),A.state.next({errors:Ye?n.errors:{}})},Tn=(Ye,wt,Rt)=>{const pn=(On(r,Ye,{_f:{}})._f||{}).ref,dn=On(n.errors,Ye)||{},{ref:sn,message:Ln,type:ur,...li}=dn;$i(n.errors,Ye,{...li,...wt,ref:pn}),A.state.next({name:Ye,errors:n.errors,isValid:!1}),Rt&&Rt.shouldFocus&&pn&&pn.focus&&pn.focus()},fn=(Ye,wt)=>Sh(Ye)?A.values.subscribe({next:Rt=>Ye($e(void 0,wt),Rt)}):$e(Ye,wt,!0),Cn=(Ye,wt={})=>{for(const Rt of Ye?D1(Ye):i.mount)i.mount.delete(Rt),i.array.delete(Rt),wt.keepValue||(ra(r,Rt),ra(c,Rt)),!wt.keepError&&ra(n.errors,Rt),!wt.keepDirty&&ra(n.dirtyFields,Rt),!wt.keepTouched&&ra(n.touchedFields,Rt),!wt.keepIsValidating&&ra(n.validatingFields,Rt),!t.shouldUnregister&&!wt.keepDefaultValue&&ra(a,Rt);A.values.next({values:{...c}}),A.state.next({...n,...wt.keepDirty?{isDirty:Re()}:{}}),!wt.keepIsValid&&j()},Vt=({disabled:Ye,name:wt,field:Rt,fields:pn,value:dn})=>{if(Dl(Ye)&&f.mount||Ye){const sn=Ye?void 0:Ro(dn)?pk(Rt?Rt._f:On(pn,wt)._f):dn;$i(c,wt,sn),se(wt,sn,!1,!1,!0)}},lr=(Ye,wt={})=>{let Rt=On(r,Ye);const pn=Dl(wt.disabled)||Dl(e.disabled);return $i(r,Ye,{...Rt||{},_f:{...Rt&&Rt._f?Rt._f:{ref:{name:Ye}},name:Ye,mount:!0,...wt}}),i.mount.add(Ye),Rt?Vt({field:Rt,disabled:Dl(wt.disabled)?wt.disabled:e.disabled,name:Ye,value:wt.value}):Y(Ye,!0,wt.value),{...pn?{disabled:wt.disabled||e.disabled}:{},...t.progressive?{required:!!wt.required,min:Xx(wt.min),max:Xx(wt.max),minLength:Xx(wt.minLength),maxLength:Xx(wt.maxLength),pattern:Xx(wt.pattern)}:{},name:Ye,onChange:Ne,onBlur:Ne,ref:dn=>{if(dn){lr(Ye,wt),Rt=On(r,Ye);const sn=Ro(dn.value)&&dn.querySelectorAll&&dn.querySelectorAll("input,select,textarea")[0]||dn,Ln=Bxe(sn),ur=Rt._f.refs||[];if(Ln?ur.find(li=>li===sn):sn===Rt._f.ref)return;$i(r,Ye,{_f:{...Rt._f,...Ln?{refs:[...ur.filter(fk),sn,...Array.isArray(On(a,Ye))?[{}]:[]],ref:{type:sn.type,name:Ye}}:{ref:sn}}}),Y(Ye,!1,void 0,sn)}else Rt=On(r,Ye,{}),Rt._f&&(Rt._f.mount=!1),(t.shouldUnregister||wt.shouldUnregister)&&!(DK(i.array,Ye)&&f.action)&&i.unMount.add(Ye)}}},Nt=()=>t.shouldFocusError&&L1(r,Xe,i.mount),gn=Ye=>{Dl(Ye)&&(A.state.next({disabled:Ye}),L1(r,(wt,Rt)=>{const pn=On(r,Rt);pn&&(wt.disabled=pn._f.disabled||Ye,Array.isArray(pn._f.refs)&&pn._f.refs.forEach(dn=>{dn.disabled=pn._f.disabled||Ye}))},0,!1))},xn=(Ye,wt)=>async Rt=>{let pn;Rt&&(Rt.preventDefault&&Rt.preventDefault(),Rt.persist&&Rt.persist());let dn=Rs(c);if(A.state.next({isSubmitting:!0}),t.resolver){const{errors:sn,values:Ln}=await ye();n.errors=sn,dn=Ln}else await Le(r);if(ra(n.errors,"root"),Ds(n.errors)){A.state.next({errors:{}});try{await Ye(dn,Rt)}catch(sn){pn=sn}}else wt&&await wt({...n.errors},Rt),Nt(),setTimeout(Nt);if(A.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ds(n.errors)&&!pn,submitCount:n.submitCount+1,errors:n.errors}),pn)throw pn},kt=(Ye,wt={})=>{On(r,Ye)&&(Ro(wt.defaultValue)?Je(Ye,Rs(On(a,Ye))):(Je(Ye,wt.defaultValue),$i(a,Ye,Rs(wt.defaultValue))),wt.keepTouched||ra(n.touchedFields,Ye),wt.keepDirty||(ra(n.dirtyFields,Ye),n.isDirty=wt.defaultValue?Re(Ye,Rs(On(a,Ye))):Re()),wt.keepError||(ra(n.errors,Ye),T.isValid&&j()),A.state.next({...n}))},zn=(Ye,wt={})=>{const Rt=Ye?Rs(Ye):a,pn=Rs(Rt),dn=Ds(Ye),sn=dn?a:pn;if(wt.keepDefaultValues||(a=Rt),!wt.keepValues){if(wt.keepDirtyValues){const Ln=new Set([...i.mount,...Object.keys(Zx(a,c))]);for(const ur of Array.from(Ln))On(n.dirtyFields,ur)?$i(sn,ur,On(c,ur)):Je(ur,On(sn,ur))}else{if(hN&&Ro(Ye))for(const Ln of i.mount){const ur=On(r,Ln);if(ur&&ur._f){const li=Array.isArray(ur._f.refs)?ur._f.refs[0]:ur._f.ref;if(Q2(li)){const Si=li.closest("form");if(Si){Si.reset();break}}}}r={}}c=e.shouldUnregister?wt.keepDefaultValues?Rs(a):{}:Rs(sn),A.array.next({values:{...sn}}),A.values.next({values:{...sn}})}i={mount:wt.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},f.mount=!T.isValid||!!wt.keepIsValid||!!wt.keepDirtyValues,f.watch=!!e.shouldUnregister,A.state.next({submitCount:wt.keepSubmitCount?n.submitCount:0,isDirty:dn?!1:wt.keepDirty?n.isDirty:!!(wt.keepDefaultValues&&!nf(Ye,a)),isSubmitted:wt.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:dn?{}:wt.keepDirtyValues?wt.keepDefaultValues&&c?Zx(a,c):n.dirtyFields:wt.keepDefaultValues&&Ye?Zx(a,Ye):wt.keepDirty?n.dirtyFields:{},touchedFields:wt.keepTouched?n.touchedFields:{},errors:wt.keepErrors?n.errors:{},isSubmitSuccessful:wt.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},fr=(Ye,wt)=>zn(Sh(Ye)?Ye(c):Ye,wt);return{control:{register:lr,unregister:Cn,getFieldState:Ft,handleSubmit:xn,setError:Tn,_executeSchema:ye,_getWatch:$e,_getDirty:Re,_updateValid:j,_removeUnmounted:je,_updateFieldArray:$,_updateDisabledField:Vt,_getFieldArray:Ge,_reset:zn,_resetDefaultValues:()=>Sh(t.defaultValues)&&t.defaultValues().then(Ye=>{fr(Ye,t.resetOptions),A.state.next({isLoading:!1})}),_updateFormState:Ye=>{n={...n,...Ye}},_disableForm:gn,_subjects:A,_proxyFormState:T,_setErrors:K,get _fields(){return r},get _formValues(){return c},get _state(){return f},set _state(Ye){f=Ye},get _defaultValues(){return a},get _names(){return i},set _names(Ye){i=Ye},get _formState(){return n},set _formState(Ye){n=Ye},get _options(){return t},set _options(Ye){t={...t,...Ye}}},trigger:pt,register:lr,handleSubmit:xn,watch:fn,setValue:Je,getValues:zt,reset:fr,resetField:kt,clearErrors:un,unregister:Cn,setError:Tn,setFocus:(Ye,wt={})=>{const Rt=On(r,Ye),pn=Rt&&Rt._f;if(pn){const dn=pn.refs?pn.refs[0]:pn.ref;dn.focus&&(dn.focus(),wt.shouldSelect&&dn.select())}},getFieldState:Ft}}function cXe(e={}){const t=Se.useRef(),n=Se.useRef(),[r,a]=Se.useState({isDirty:!1,isValidating:!1,isLoading:Sh(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Sh(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...Hxe(e),formState:r});const c=t.current.control;return c._options=e,pN({subject:c._subjects.state,next:f=>{FK(f,c._proxyFormState,c._updateFormState,!0)&&a({...c._formState})}}),Se.useEffect(()=>c._disableForm(e.disabled),[c,e.disabled]),Se.useEffect(()=>{if(c._proxyFormState.isDirty){const f=c._getDirty();f!==r.isDirty&&c._subjects.state.next({isDirty:f})}},[c,r.isDirty]),Se.useEffect(()=>{e.values&&!nf(e.values,n.current)?(c._reset(e.values,c._options.resetOptions),n.current=e.values,a(f=>({...f}))):c._resetDefaultValues()},[e.values,c]),Se.useEffect(()=>{e.errors&&c._setErrors(e.errors)},[e.errors,c]),Se.useEffect(()=>{c._state.mount||(c._updateValid(),c._state.mount=!0),c._state.watch&&(c._state.watch=!1,c._subjects.state.next({...c._formState})),c._removeUnmounted()}),Se.useEffect(()=>{e.shouldUnregister&&c._subjects.values.next({values:c._getWatch()})},[e.shouldUnregister,c]),Se.useEffect(()=>{t.current&&(t.current.watch=t.current.watch.bind({}))},[r]),t.current.formState=NK(r,c),t.current}const xV=(e,t,n)=>{if(e&&"reportValidity"in e){const r=On(n,t);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},ZK=(e,t)=>{for(const n in t.fields){const r=t.fields[n];r&&r.ref&&"reportValidity"in r.ref?xV(r.ref,n,e):r.refs&&r.refs.forEach(a=>xV(a,n,e))}},qxe=(e,t)=>{t.shouldUseNativeValidation&&ZK(e,t);const n={};for(const r in e){const a=On(t.fields,r),c=Object.assign(e[r]||{},{ref:a&&a.ref});if(Zxe(t.names||Object.keys(e),r)){const f=Object.assign({},On(n,r));$i(f,"root",c),$i(n,r,f)}else $i(n,r,c)}return n},Zxe=(e,t)=>e.some(n=>n.startsWith(t+"."));var Xxe=function(e,t){for(var n={};e.length;){var r=e[0],a=r.code,c=r.message,f=r.path.join(".");if(!n[f])if("unionErrors"in r){var i=r.unionErrors[0].errors[0];n[f]={message:i.message,type:i.code}}else n[f]={message:c,type:a};if("unionErrors"in r&&r.unionErrors.forEach(function(T){return T.errors.forEach(function(A){return e.push(A)})}),t){var v=n[f].types,b=v&&v[r.code];n[f]=$K(f,t,n,a,b?[].concat(b,r.message):r.message)}e.shift()}return n},uXe=function(e,t,n){return n===void 0&&(n={}),function(r,a,c){try{return Promise.resolve(function(f,i){try{var v=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(b){return c.shouldUseNativeValidation&&ZK({},c),{errors:{},values:n.raw?r:b}})}catch(b){return i(b)}return v&&v.then?v.then(void 0,i):v}(0,function(f){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(f))return{values:{},errors:qxe(Xxe(f.errors,!c.shouldUseNativeValidation&&c.criteriaMode==="all"),c)};throw f}))}catch(f){return Promise.reject(f)}}},yN="Checkbox",[Kxe,hXe]=qs(yN),[Yxe,Jxe]=Kxe(yN),XK=X.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:c,required:f,disabled:i,value:v="on",onCheckedChange:b,form:T,...A}=e,[M,R]=X.useState(null),B=qr(t,K=>R(K)),L=X.useRef(!1),j=M?T||!!M.closest("form"):!0,[V=!1,$]=ys({prop:a,defaultProp:c,onChange:b}),H=X.useRef(V);return X.useEffect(()=>{const K=M==null?void 0:M.form;if(K){const Y=()=>$(H.current);return K.addEventListener("reset",Y),()=>K.removeEventListener("reset",Y)}},[M,$]),he.jsxs(Yxe,{scope:n,state:V,disabled:i,children:[he.jsx(Qn.button,{type:"button",role:"checkbox","aria-checked":bf(V)?"mixed":V,"aria-required":f,"data-state":JK(V),"data-disabled":i?"":void 0,disabled:i,value:v,...A,ref:B,onKeyDown:vn(e.onKeyDown,K=>{K.key==="Enter"&&K.preventDefault()}),onClick:vn(e.onClick,K=>{$(Y=>bf(Y)?!0:!Y),j&&(L.current=K.isPropagationStopped(),L.current||K.stopPropagation())})}),j&&he.jsx(Qxe,{control:M,bubbles:!L.current,name:r,value:v,checked:V,required:f,disabled:i,form:T,style:{transform:"translateX(-100%)"},defaultChecked:bf(c)?!1:c})]})});XK.displayName=yN;var KK="CheckboxIndicator",YK=X.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,c=Jxe(KK,n);return he.jsx(wa,{present:r||bf(c.state)||c.state===!0,children:he.jsx(Qn.span,{"data-state":JK(c.state),"data-disabled":c.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});YK.displayName=KK;var Qxe=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...c}=e,f=X.useRef(null),i=ZP(n),v=S3(t);X.useEffect(()=>{const T=f.current,A=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(A,"checked").set;if(i!==n&&R){const B=new Event("click",{bubbles:r});T.indeterminate=bf(n),R.call(T,bf(n)?!1:n),T.dispatchEvent(B)}},[i,n,r]);const b=X.useRef(bf(n)?!1:n);return he.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??b.current,...c,tabIndex:-1,ref:f,style:{...e.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function bf(e){return e==="indeterminate"}function JK(e){return bf(e)?"indeterminate":e?"checked":"unchecked"}var dXe=XK,fXe=YK,e1e=Array.isArray,Zs=e1e,t1e=typeof Oa=="object"&&Oa&&Oa.Object===Object&&Oa,QK=t1e,n1e=QK,r1e=typeof self=="object"&&self&&self.Object===Object&&self,i1e=n1e||r1e||Function("return this")(),Cu=i1e,o1e=Cu,a1e=o1e.Symbol,Nw=a1e,bV=Nw,eY=Object.prototype,s1e=eY.hasOwnProperty,l1e=eY.toString,Kx=bV?bV.toStringTag:void 0;function c1e(e){var t=s1e.call(e,Kx),n=e[Kx];try{e[Kx]=void 0;var r=!0}catch{}var a=l1e.call(e);return r&&(t?e[Kx]=n:delete e[Kx]),a}var u1e=c1e,h1e=Object.prototype,d1e=h1e.toString;function f1e(e){return d1e.call(e)}var p1e=f1e,wV=Nw,m1e=u1e,g1e=p1e,y1e="[object Null]",_1e="[object Undefined]",SV=wV?wV.toStringTag:void 0;function v1e(e){return e==null?e===void 0?_1e:y1e:SV&&SV in Object(e)?m1e(e):g1e(e)}var Vh=v1e;function x1e(e){return e!=null&&typeof e=="object"}var Gh=x1e,b1e=Vh,w1e=Gh,S1e="[object Symbol]";function T1e(e){return typeof e=="symbol"||w1e(e)&&b1e(e)==S1e}var Pv=T1e,E1e=Zs,A1e=Pv,P1e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,C1e=/^\w*$/;function I1e(e,t){if(E1e(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||A1e(e)?!0:C1e.test(e)||!P1e.test(e)||t!=null&&e in Object(t)}var _N=I1e;function M1e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var qf=M1e;const Cv=Bi(qf);var O1e=Vh,k1e=qf,R1e="[object AsyncFunction]",D1e="[object Function]",L1e="[object GeneratorFunction]",z1e="[object Proxy]";function N1e(e){if(!k1e(e))return!1;var t=O1e(e);return t==D1e||t==L1e||t==R1e||t==z1e}var vN=N1e;const Tr=Bi(vN);var F1e=Cu,B1e=F1e["__core-js_shared__"],j1e=B1e,mk=j1e,TV=function(){var e=/[^.]+$/.exec(mk&&mk.keys&&mk.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function $1e(e){return!!TV&&TV in e}var U1e=$1e,V1e=Function.prototype,G1e=V1e.toString;function W1e(e){if(e!=null){try{return G1e.call(e)}catch{}try{return e+""}catch{}}return""}var tY=W1e,H1e=vN,q1e=U1e,Z1e=qf,X1e=tY,K1e=/[\\^$.*+?()[\]{}|]/g,Y1e=/^\[object .+?Constructor\]$/,J1e=Function.prototype,Q1e=Object.prototype,ebe=J1e.toString,tbe=Q1e.hasOwnProperty,nbe=RegExp("^"+ebe.call(tbe).replace(K1e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function rbe(e){if(!Z1e(e)||q1e(e))return!1;var t=H1e(e)?nbe:Y1e;return t.test(X1e(e))}var ibe=rbe;function obe(e,t){return e==null?void 0:e[t]}var abe=obe,sbe=ibe,lbe=abe;function cbe(e,t){var n=lbe(e,t);return sbe(n)?n:void 0}var eg=cbe,ube=eg,hbe=ube(Object,"create"),iC=hbe,EV=iC;function dbe(){this.__data__=EV?EV(null):{},this.size=0}var fbe=dbe;function pbe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var mbe=pbe,gbe=iC,ybe="__lodash_hash_undefined__",_be=Object.prototype,vbe=_be.hasOwnProperty;function xbe(e){var t=this.__data__;if(gbe){var n=t[e];return n===ybe?void 0:n}return vbe.call(t,e)?t[e]:void 0}var bbe=xbe,wbe=iC,Sbe=Object.prototype,Tbe=Sbe.hasOwnProperty;function Ebe(e){var t=this.__data__;return wbe?t[e]!==void 0:Tbe.call(t,e)}var Abe=Ebe,Pbe=iC,Cbe="__lodash_hash_undefined__";function Ibe(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Pbe&&t===void 0?Cbe:t,this}var Mbe=Ibe,Obe=fbe,kbe=mbe,Rbe=bbe,Dbe=Abe,Lbe=Mbe;function Iv(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Iv.prototype.clear=Obe;Iv.prototype.delete=kbe;Iv.prototype.get=Rbe;Iv.prototype.has=Dbe;Iv.prototype.set=Lbe;var zbe=Iv;function Nbe(){this.__data__=[],this.size=0}var Fbe=Nbe;function Bbe(e,t){return e===t||e!==e&&t!==t}var xN=Bbe,jbe=xN;function $be(e,t){for(var n=e.length;n--;)if(jbe(e[n][0],t))return n;return-1}var oC=$be,Ube=oC,Vbe=Array.prototype,Gbe=Vbe.splice;function Wbe(e){var t=this.__data__,n=Ube(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Gbe.call(t,n,1),--this.size,!0}var Hbe=Wbe,qbe=oC;function Zbe(e){var t=this.__data__,n=qbe(t,e);return n<0?void 0:t[n][1]}var Xbe=Zbe,Kbe=oC;function Ybe(e){return Kbe(this.__data__,e)>-1}var Jbe=Ybe,Qbe=oC;function ewe(e,t){var n=this.__data__,r=Qbe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var twe=ewe,nwe=Fbe,rwe=Hbe,iwe=Xbe,owe=Jbe,awe=twe;function Mv(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Mv.prototype.clear=nwe;Mv.prototype.delete=rwe;Mv.prototype.get=iwe;Mv.prototype.has=owe;Mv.prototype.set=awe;var aC=Mv,swe=eg,lwe=Cu,cwe=swe(lwe,"Map"),bN=cwe,AV=zbe,uwe=aC,hwe=bN;function dwe(){this.size=0,this.__data__={hash:new AV,map:new(hwe||uwe),string:new AV}}var fwe=dwe;function pwe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var mwe=pwe,gwe=mwe;function ywe(e,t){var n=e.__data__;return gwe(t)?n[typeof t=="string"?"string":"hash"]:n.map}var sC=ywe,_we=sC;function vwe(e){var t=_we(this,e).delete(e);return this.size-=t?1:0,t}var xwe=vwe,bwe=sC;function wwe(e){return bwe(this,e).get(e)}var Swe=wwe,Twe=sC;function Ewe(e){return Twe(this,e).has(e)}var Awe=Ewe,Pwe=sC;function Cwe(e,t){var n=Pwe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var Iwe=Cwe,Mwe=fwe,Owe=xwe,kwe=Swe,Rwe=Awe,Dwe=Iwe;function Ov(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ov.prototype.clear=Mwe;Ov.prototype.delete=Owe;Ov.prototype.get=kwe;Ov.prototype.has=Rwe;Ov.prototype.set=Dwe;var wN=Ov,nY=wN,Lwe="Expected a function";function SN(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Lwe);var n=function(){var r=arguments,a=t?t.apply(this,r):r[0],c=n.cache;if(c.has(a))return c.get(a);var f=e.apply(this,r);return n.cache=c.set(a,f)||c,f};return n.cache=new(SN.Cache||nY),n}SN.Cache=nY;var rY=SN;const zwe=Bi(rY);var Nwe=rY,Fwe=500;function Bwe(e){var t=Nwe(e,function(r){return n.size===Fwe&&n.clear(),r}),n=t.cache;return t}var jwe=Bwe,$we=jwe,Uwe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vwe=/\\(\\)?/g,Gwe=$we(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Uwe,function(n,r,a,c){t.push(a?c.replace(Vwe,"$1"):r||n)}),t}),Wwe=Gwe;function Hwe(e,t){for(var n=-1,r=e==null?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}var TN=Hwe,PV=Nw,qwe=TN,Zwe=Zs,Xwe=Pv,Kwe=1/0,CV=PV?PV.prototype:void 0,IV=CV?CV.toString:void 0;function iY(e){if(typeof e=="string")return e;if(Zwe(e))return qwe(e,iY)+"";if(Xwe(e))return IV?IV.call(e):"";var t=e+"";return t=="0"&&1/e==-Kwe?"-0":t}var Ywe=iY,Jwe=Ywe;function Qwe(e){return e==null?"":Jwe(e)}var oY=Qwe,eSe=Zs,tSe=_N,nSe=Wwe,rSe=oY;function iSe(e,t){return eSe(e)?e:tSe(e,t)?[e]:nSe(rSe(e))}var aY=iSe,oSe=Pv,aSe=1/0;function sSe(e){if(typeof e=="string"||oSe(e))return e;var t=e+"";return t=="0"&&1/e==-aSe?"-0":t}var lC=sSe,lSe=aY,cSe=lC;function uSe(e,t){t=lSe(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[cSe(t[n++])];return n&&n==r?e:void 0}var EN=uSe,hSe=EN;function dSe(e,t,n){var r=e==null?void 0:hSe(e,t);return r===void 0?n:r}var sY=dSe;const yl=Bi(sY);function fSe(e){return e==null}var pSe=fSe;const xr=Bi(pSe);var mSe=Vh,gSe=Zs,ySe=Gh,_Se="[object String]";function vSe(e){return typeof e=="string"||!gSe(e)&&ySe(e)&&mSe(e)==_Se}var xSe=vSe;const Fw=Bi(xSe);var lY={exports:{}},Wi={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AN=Symbol.for("react.element"),PN=Symbol.for("react.portal"),cC=Symbol.for("react.fragment"),uC=Symbol.for("react.strict_mode"),hC=Symbol.for("react.profiler"),dC=Symbol.for("react.provider"),fC=Symbol.for("react.context"),bSe=Symbol.for("react.server_context"),pC=Symbol.for("react.forward_ref"),mC=Symbol.for("react.suspense"),gC=Symbol.for("react.suspense_list"),yC=Symbol.for("react.memo"),_C=Symbol.for("react.lazy"),wSe=Symbol.for("react.offscreen"),cY;cY=Symbol.for("react.module.reference");function Zl(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case AN:switch(e=e.type,e){case cC:case hC:case uC:case mC:case gC:return e;default:switch(e=e&&e.$$typeof,e){case bSe:case fC:case pC:case _C:case yC:case dC:return e;default:return t}}case PN:return t}}}Wi.ContextConsumer=fC;Wi.ContextProvider=dC;Wi.Element=AN;Wi.ForwardRef=pC;Wi.Fragment=cC;Wi.Lazy=_C;Wi.Memo=yC;Wi.Portal=PN;Wi.Profiler=hC;Wi.StrictMode=uC;Wi.Suspense=mC;Wi.SuspenseList=gC;Wi.isAsyncMode=function(){return!1};Wi.isConcurrentMode=function(){return!1};Wi.isContextConsumer=function(e){return Zl(e)===fC};Wi.isContextProvider=function(e){return Zl(e)===dC};Wi.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===AN};Wi.isForwardRef=function(e){return Zl(e)===pC};Wi.isFragment=function(e){return Zl(e)===cC};Wi.isLazy=function(e){return Zl(e)===_C};Wi.isMemo=function(e){return Zl(e)===yC};Wi.isPortal=function(e){return Zl(e)===PN};Wi.isProfiler=function(e){return Zl(e)===hC};Wi.isStrictMode=function(e){return Zl(e)===uC};Wi.isSuspense=function(e){return Zl(e)===mC};Wi.isSuspenseList=function(e){return Zl(e)===gC};Wi.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===cC||e===hC||e===uC||e===mC||e===gC||e===wSe||typeof e=="object"&&e!==null&&(e.$$typeof===_C||e.$$typeof===yC||e.$$typeof===dC||e.$$typeof===fC||e.$$typeof===pC||e.$$typeof===cY||e.getModuleId!==void 0)};Wi.typeOf=Zl;lY.exports=Wi;var uY=lY.exports,SSe=Vh,TSe=Gh,ESe="[object Number]";function ASe(e){return typeof e=="number"||TSe(e)&&SSe(e)==ESe}var hY=ASe;const PSe=Bi(hY);var CSe=hY;function ISe(e){return CSe(e)&&e!=+e}var MSe=ISe;const kv=Bi(MSe);var ds=function(t){return t===0?0:t>0?1:-1},pm=function(t){return Fw(t)&&t.indexOf("%")===t.length-1},wn=function(t){return PSe(t)&&!kv(t)},aa=function(t){return wn(t)||Fw(t)},OSe=0,Zf=function(t){var n=++OSe;return"".concat(t||"").concat(n)},fs=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!wn(t)&&!Fw(t))return r;var c;if(pm(t)){var f=t.indexOf("%");c=n*parseFloat(t.slice(0,f))/100}else c=+t;return kv(c)&&(c=r),a&&c>n&&(c=n),c},rf=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},kSe=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,r={},a=0;a<n;a++)if(!r[t[a]])r[t[a]]=!0;else return!0;return!1},Ao=function(t,n){return wn(t)&&wn(n)?function(r){return t+r*(n-t)}:function(){return n}};function nA(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):yl(r,t))===n})}var RSe=function(t){if(!t||!t.length)return null;for(var n=t.length,r=0,a=0,c=0,f=0,i=1/0,v=-1/0,b=0,T=0,A=0;A<n;A++)b=t[A].cx||0,T=t[A].cy||0,r+=b,a+=T,c+=b*T,f+=b*b,i=Math.min(i,b),v=Math.max(v,b);var M=n*f!==r*r?(n*c-r*a)/(n*f-r*r):0;return{xmin:i,xmax:v,a:M,b:(a-M*r)/n}};function f_(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function ED(e){"@babel/helpers - typeof";return ED=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ED(e)}var DSe=["viewBox","children"],LSe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],MV=["points","pathLength"],gk={svg:DSe,polygon:MV,polyline:MV},CN=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],rA=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(X.isValidElement(t)&&(r=t.props),!Cv(r))return null;var a={};return Object.keys(r).forEach(function(c){CN.includes(c)&&(a[c]=n||function(f){return r[c](r,f)})}),a},zSe=function(t,n,r){return function(a){return t(n,r,a),null}},zf=function(t,n,r){if(!Cv(t)||ED(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(c){var f=t[c];CN.includes(c)&&typeof f=="function"&&(a||(a={}),a[c]=zSe(f,n,r))}),a},NSe=["children"],FSe=["children"];function OV(e,t){if(e==null)return{};var n=BSe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function BSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function AD(e){"@babel/helpers - typeof";return AD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AD(e)}var kV={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Ch=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},RV=null,yk=null,IN=function e(t){if(t===RV&&Array.isArray(yk))return yk;var n=[];return X.Children.forEach(t,function(r){xr(r)||(uY.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),yk=n,RV=t,n};function gs(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return Ch(a)}):r=[Ch(t)],IN(e).forEach(function(a){var c=yl(a,"type.displayName")||yl(a,"type.name");r.indexOf(c)!==-1&&n.push(a)}),n}function ul(e,t){var n=gs(e,t);return n&&n[0]}var DV=function(t){if(!t||!t.props)return!1;var n=t.props,r=n.width,a=n.height;return!(!wn(r)||r<=0||!wn(a)||a<=0)},jSe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],$Se=function(t){return t&&t.type&&Fw(t.type)&&jSe.indexOf(t.type)>=0},dY=function(t){return t&&AD(t)==="object"&&"clipDot"in t},USe=function(t,n,r,a){var c,f=(c=gk==null?void 0:gk[a])!==null&&c!==void 0?c:[];return!Tr(t)&&(a&&f.includes(n)||LSe.includes(n))||r&&CN.includes(n)},ir=function(t,n,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(X.isValidElement(t)&&(a=t.props),!Cv(a))return null;var c={};return Object.keys(a).forEach(function(f){var i;USe((i=a)===null||i===void 0?void 0:i[f],f,n,r)&&(c[f]=a[f])}),c},PD=function e(t,n){if(t===n)return!0;var r=X.Children.count(t);if(r!==X.Children.count(n))return!1;if(r===0)return!0;if(r===1)return LV(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var c=t[a],f=n[a];if(Array.isArray(c)||Array.isArray(f)){if(!e(c,f))return!1}else if(!LV(c,f))return!1}return!0},LV=function(t,n){if(xr(t)&&xr(n))return!0;if(!xr(t)&&!xr(n)){var r=t.props||{},a=r.children,c=OV(r,NSe),f=n.props||{},i=f.children,v=OV(f,FSe);return a&&i?f_(c,v)&&PD(a,i):!a&&!i?f_(c,v):!1}return!1},zV=function(t,n){var r=[],a={};return IN(t).forEach(function(c,f){if($Se(c))r.push(c);else if(c){var i=Ch(c.type),v=n[i]||{},b=v.handler,T=v.once;if(b&&(!T||!a[i])){var A=b(c,i,f);r.push(A),a[i]=!0}}}),r},VSe=function(t){var n=t&&t.type;return n&&kV[n]?kV[n]:null},GSe=function(t,n){return IN(n).indexOf(t)},WSe=["children","width","height","viewBox","className","style","title","desc"];function CD(){return CD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CD.apply(this,arguments)}function HSe(e,t){if(e==null)return{};var n=qSe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function ID(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,c=e.className,f=e.style,i=e.title,v=e.desc,b=HSe(e,WSe),T=a||{width:n,height:r,x:0,y:0},A=jr("recharts-surface",c);return Se.createElement("svg",CD({},ir(b,!0,"svg"),{className:A,width:n,height:r,style:f,viewBox:"".concat(T.x," ").concat(T.y," ").concat(T.width," ").concat(T.height)}),Se.createElement("title",null,i),Se.createElement("desc",null,v),t)}var ZSe=["children","className"];function MD(){return MD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},MD.apply(this,arguments)}function XSe(e,t){if(e==null)return{};var n=KSe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function KSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var Wr=Se.forwardRef(function(e,t){var n=e.children,r=e.className,a=XSe(e,ZSe),c=jr("recharts-layer",r);return Se.createElement("g",MD({className:c},ir(a,!0),{ref:t}),n)}),Oc=function(t,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),c=2;c<r;c++)a[c-2]=arguments[c]};function YSe(e,t,n){var r=-1,a=e.length;t<0&&(t=-t>a?0:a+t),n=n>a?a:n,n<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var c=Array(a);++r<a;)c[r]=e[r+t];return c}var JSe=YSe,QSe=JSe;function eTe(e,t,n){var r=e.length;return n=n===void 0?r:n,!t&&n>=r?e:QSe(e,t,n)}var tTe=eTe,nTe="\\ud800-\\udfff",rTe="\\u0300-\\u036f",iTe="\\ufe20-\\ufe2f",oTe="\\u20d0-\\u20ff",aTe=rTe+iTe+oTe,sTe="\\ufe0e\\ufe0f",lTe="\\u200d",cTe=RegExp("["+lTe+nTe+aTe+sTe+"]");function uTe(e){return cTe.test(e)}var fY=uTe;function hTe(e){return e.split("")}var dTe=hTe,pY="\\ud800-\\udfff",fTe="\\u0300-\\u036f",pTe="\\ufe20-\\ufe2f",mTe="\\u20d0-\\u20ff",gTe=fTe+pTe+mTe,yTe="\\ufe0e\\ufe0f",_Te="["+pY+"]",OD="["+gTe+"]",kD="\\ud83c[\\udffb-\\udfff]",vTe="(?:"+OD+"|"+kD+")",mY="[^"+pY+"]",gY="(?:\\ud83c[\\udde6-\\uddff]){2}",yY="[\\ud800-\\udbff][\\udc00-\\udfff]",xTe="\\u200d",_Y=vTe+"?",vY="["+yTe+"]?",bTe="(?:"+xTe+"(?:"+[mY,gY,yY].join("|")+")"+vY+_Y+")*",wTe=vY+_Y+bTe,STe="(?:"+[mY+OD+"?",OD,gY,yY,_Te].join("|")+")",TTe=RegExp(kD+"(?="+kD+")|"+STe+wTe,"g");function ETe(e){return e.match(TTe)||[]}var ATe=ETe,PTe=dTe,CTe=fY,ITe=ATe;function MTe(e){return CTe(e)?ITe(e):PTe(e)}var OTe=MTe,kTe=tTe,RTe=fY,DTe=OTe,LTe=oY;function zTe(e){return function(t){t=LTe(t);var n=RTe(t)?DTe(t):void 0,r=n?n[0]:t.charAt(0),a=n?kTe(n,1).join(""):t.slice(1);return r[e]()+a}}var NTe=zTe,FTe=NTe,BTe=FTe("toUpperCase"),jTe=BTe;const vC=Bi(jTe);function ei(e){return function(){return e}}const NV=Math.abs,qa=Math.atan2,yh=Math.cos,$Te=Math.max,_k=Math.min,Ls=Math.sin,ka=Math.sqrt,ks=1e-12,Nf=Math.PI,iA=Nf/2,wf=2*Nf;function UTe(e){return e>1?0:e<-1?Nf:Math.acos(e)}function FV(e){return e>=1?iA:e<=-1?-iA:Math.asin(e)}const RD=Math.PI,DD=2*RD,om=1e-6,VTe=DD-om;function xY(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function GTe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return xY;const n=10**t;return function(r){this._+=r[0];for(let a=1,c=r.length;a<c;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class WTe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?xY:GTe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,c,f){this._append`C${+t},${+n},${+r},${+a},${this._x1=+c},${this._y1=+f}`}arcTo(t,n,r,a,c){if(t=+t,n=+n,r=+r,a=+a,c=+c,c<0)throw new Error(`negative radius: ${c}`);let f=this._x1,i=this._y1,v=r-t,b=a-n,T=f-t,A=i-n,M=T*T+A*A;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(M>om)if(!(Math.abs(A*v-b*T)>om)||!c)this._append`L${this._x1=t},${this._y1=n}`;else{let R=r-f,B=a-i,L=v*v+b*b,j=R*R+B*B,V=Math.sqrt(L),$=Math.sqrt(M),H=c*Math.tan((RD-Math.acos((L+M-j)/(2*V*$)))/2),K=H/$,Y=H/V;Math.abs(K-1)>om&&this._append`L${t+K*T},${n+K*A}`,this._append`A${c},${c},0,0,${+(A*R>T*B)},${this._x1=t+Y*v},${this._y1=n+Y*b}`}}arc(t,n,r,a,c,f){if(t=+t,n=+n,r=+r,f=!!f,r<0)throw new Error(`negative radius: ${r}`);let i=r*Math.cos(a),v=r*Math.sin(a),b=t+i,T=n+v,A=1^f,M=f?a-c:c-a;this._x1===null?this._append`M${b},${T}`:(Math.abs(this._x1-b)>om||Math.abs(this._y1-T)>om)&&this._append`L${b},${T}`,r&&(M<0&&(M=M%DD+DD),M>VTe?this._append`A${r},${r},0,1,${A},${t-i},${n-v}A${r},${r},0,1,${A},${this._x1=b},${this._y1=T}`:M>om&&this._append`A${r},${r},0,${+(M>=RD)},${A},${this._x1=t+r*Math.cos(c)},${this._y1=n+r*Math.sin(c)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function xC(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new WTe(t)}function HTe(e){return e.innerRadius}function qTe(e){return e.outerRadius}function ZTe(e){return e.startAngle}function XTe(e){return e.endAngle}function KTe(e){return e&&e.padAngle}function YTe(e,t,n,r,a,c,f,i){var v=n-e,b=r-t,T=f-a,A=i-c,M=A*v-T*b;if(!(M*M<ks))return M=(T*(t-c)-A*(e-a))/M,[e+M*v,t+M*b]}function bE(e,t,n,r,a,c,f){var i=e-n,v=t-r,b=(f?c:-c)/ka(i*i+v*v),T=b*v,A=-b*i,M=e+T,R=t+A,B=n+T,L=r+A,j=(M+B)/2,V=(R+L)/2,$=B-M,H=L-R,K=$*$+H*H,Y=a-c,se=M*L-B*R,ce=(H<0?-1:1)*ka($Te(0,Y*Y*K-se*se)),ye=(se*H-$*ce)/K,ze=(-se*$-H*ce)/K,Le=(se*H+$*ce)/K,je=(-se*$+H*ce)/K,Re=ye-j,$e=ze-V,Ge=Le-j,ht=je-V;return Re*Re+$e*$e>Ge*Ge+ht*ht&&(ye=Le,ze=je),{cx:ye,cy:ze,x01:-T,y01:-A,x11:ye*(a/Y-1),y11:ze*(a/Y-1)}}function pXe(){var e=HTe,t=qTe,n=ei(0),r=null,a=ZTe,c=XTe,f=KTe,i=null,v=xC(b);function b(){var T,A,M=+e.apply(this,arguments),R=+t.apply(this,arguments),B=a.apply(this,arguments)-iA,L=c.apply(this,arguments)-iA,j=NV(L-B),V=L>B;if(i||(i=T=v()),R<M&&(A=R,R=M,M=A),!(R>ks))i.moveTo(0,0);else if(j>wf-ks)i.moveTo(R*yh(B),R*Ls(B)),i.arc(0,0,R,B,L,!V),M>ks&&(i.moveTo(M*yh(L),M*Ls(L)),i.arc(0,0,M,L,B,V));else{var $=B,H=L,K=B,Y=L,se=j,ce=j,ye=f.apply(this,arguments)/2,ze=ye>ks&&(r?+r.apply(this,arguments):ka(M*M+R*R)),Le=_k(NV(R-M)/2,+n.apply(this,arguments)),je=Le,Re=Le,$e,Ge;if(ze>ks){var ht=FV(ze/M*Ls(ye)),ot=FV(ze/R*Ls(ye));(se-=ht*2)>ks?(ht*=V?1:-1,K+=ht,Y-=ht):(se=0,K=Y=(B+L)/2),(ce-=ot*2)>ks?(ot*=V?1:-1,$+=ot,H-=ot):(ce=0,$=H=(B+L)/2)}var Je=R*yh($),Ne=R*Ls($),Xe=M*yh(Y),pt=M*Ls(Y);if(Le>ks){var zt=R*yh(H),Ft=R*Ls(H),un=M*yh(K),Tn=M*Ls(K),fn;if(j<Nf)if(fn=YTe(Je,Ne,un,Tn,zt,Ft,Xe,pt)){var Cn=Je-fn[0],Vt=Ne-fn[1],lr=zt-fn[0],Nt=Ft-fn[1],gn=1/Ls(UTe((Cn*lr+Vt*Nt)/(ka(Cn*Cn+Vt*Vt)*ka(lr*lr+Nt*Nt)))/2),xn=ka(fn[0]*fn[0]+fn[1]*fn[1]);je=_k(Le,(M-xn)/(gn-1)),Re=_k(Le,(R-xn)/(gn+1))}else je=Re=0}ce>ks?Re>ks?($e=bE(un,Tn,Je,Ne,R,Re,V),Ge=bE(zt,Ft,Xe,pt,R,Re,V),i.moveTo($e.cx+$e.x01,$e.cy+$e.y01),Re<Le?i.arc($e.cx,$e.cy,Re,qa($e.y01,$e.x01),qa(Ge.y01,Ge.x01),!V):(i.arc($e.cx,$e.cy,Re,qa($e.y01,$e.x01),qa($e.y11,$e.x11),!V),i.arc(0,0,R,qa($e.cy+$e.y11,$e.cx+$e.x11),qa(Ge.cy+Ge.y11,Ge.cx+Ge.x11),!V),i.arc(Ge.cx,Ge.cy,Re,qa(Ge.y11,Ge.x11),qa(Ge.y01,Ge.x01),!V))):(i.moveTo(Je,Ne),i.arc(0,0,R,$,H,!V)):i.moveTo(Je,Ne),!(M>ks)||!(se>ks)?i.lineTo(Xe,pt):je>ks?($e=bE(Xe,pt,zt,Ft,M,-je,V),Ge=bE(Je,Ne,un,Tn,M,-je,V),i.lineTo($e.cx+$e.x01,$e.cy+$e.y01),je<Le?i.arc($e.cx,$e.cy,je,qa($e.y01,$e.x01),qa(Ge.y01,Ge.x01),!V):(i.arc($e.cx,$e.cy,je,qa($e.y01,$e.x01),qa($e.y11,$e.x11),!V),i.arc(0,0,M,qa($e.cy+$e.y11,$e.cx+$e.x11),qa(Ge.cy+Ge.y11,Ge.cx+Ge.x11),V),i.arc(Ge.cx,Ge.cy,je,qa(Ge.y11,Ge.x11),qa(Ge.y01,Ge.x01),!V))):i.arc(0,0,M,Y,K,V)}if(i.closePath(),T)return i=null,T+""||null}return b.centroid=function(){var T=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,A=(+a.apply(this,arguments)+ +c.apply(this,arguments))/2-Nf/2;return[yh(A)*T,Ls(A)*T]},b.innerRadius=function(T){return arguments.length?(e=typeof T=="function"?T:ei(+T),b):e},b.outerRadius=function(T){return arguments.length?(t=typeof T=="function"?T:ei(+T),b):t},b.cornerRadius=function(T){return arguments.length?(n=typeof T=="function"?T:ei(+T),b):n},b.padRadius=function(T){return arguments.length?(r=T==null?null:typeof T=="function"?T:ei(+T),b):r},b.startAngle=function(T){return arguments.length?(a=typeof T=="function"?T:ei(+T),b):a},b.endAngle=function(T){return arguments.length?(c=typeof T=="function"?T:ei(+T),b):c},b.padAngle=function(T){return arguments.length?(f=typeof T=="function"?T:ei(+T),b):f},b.context=function(T){return arguments.length?(i=T??null,b):i},b}function bC(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function bY(e){this._context=e}bY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function wC(e){return new bY(e)}function wY(e){return e[0]}function SY(e){return e[1]}function TY(e,t){var n=ei(!0),r=null,a=wC,c=null,f=xC(i);e=typeof e=="function"?e:e===void 0?wY:ei(e),t=typeof t=="function"?t:t===void 0?SY:ei(t);function i(v){var b,T=(v=bC(v)).length,A,M=!1,R;for(r==null&&(c=a(R=f())),b=0;b<=T;++b)!(b<T&&n(A=v[b],b,v))===M&&((M=!M)?c.lineStart():c.lineEnd()),M&&c.point(+e(A,b,v),+t(A,b,v));if(R)return c=null,R+""||null}return i.x=function(v){return arguments.length?(e=typeof v=="function"?v:ei(+v),i):e},i.y=function(v){return arguments.length?(t=typeof v=="function"?v:ei(+v),i):t},i.defined=function(v){return arguments.length?(n=typeof v=="function"?v:ei(!!v),i):n},i.curve=function(v){return arguments.length?(a=v,r!=null&&(c=a(r)),i):a},i.context=function(v){return arguments.length?(v==null?r=c=null:c=a(r=v),i):r},i}function wE(e,t,n){var r=null,a=ei(!0),c=null,f=wC,i=null,v=xC(b);e=typeof e=="function"?e:e===void 0?wY:ei(+e),t=typeof t=="function"?t:ei(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?SY:ei(+n);function b(A){var M,R,B,L=(A=bC(A)).length,j,V=!1,$,H=new Array(L),K=new Array(L);for(c==null&&(i=f($=v())),M=0;M<=L;++M){if(!(M<L&&a(j=A[M],M,A))===V)if(V=!V)R=M,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),B=M-1;B>=R;--B)i.point(H[B],K[B]);i.lineEnd(),i.areaEnd()}V&&(H[M]=+e(j,M,A),K[M]=+t(j,M,A),i.point(r?+r(j,M,A):H[M],n?+n(j,M,A):K[M]))}if($)return i=null,$+""||null}function T(){return TY().defined(a).curve(f).context(c)}return b.x=function(A){return arguments.length?(e=typeof A=="function"?A:ei(+A),r=null,b):e},b.x0=function(A){return arguments.length?(e=typeof A=="function"?A:ei(+A),b):e},b.x1=function(A){return arguments.length?(r=A==null?null:typeof A=="function"?A:ei(+A),b):r},b.y=function(A){return arguments.length?(t=typeof A=="function"?A:ei(+A),n=null,b):t},b.y0=function(A){return arguments.length?(t=typeof A=="function"?A:ei(+A),b):t},b.y1=function(A){return arguments.length?(n=A==null?null:typeof A=="function"?A:ei(+A),b):n},b.lineX0=b.lineY0=function(){return T().x(e).y(t)},b.lineY1=function(){return T().x(e).y(n)},b.lineX1=function(){return T().x(r).y(t)},b.defined=function(A){return arguments.length?(a=typeof A=="function"?A:ei(!!A),b):a},b.curve=function(A){return arguments.length?(f=A,c!=null&&(i=f(c)),b):f},b.context=function(A){return arguments.length?(A==null?c=i=null:i=f(c=A),b):c},b}function JTe(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function QTe(e){return e}function mXe(){var e=QTe,t=JTe,n=null,r=ei(0),a=ei(wf),c=ei(0);function f(i){var v,b=(i=bC(i)).length,T,A,M=0,R=new Array(b),B=new Array(b),L=+r.apply(this,arguments),j=Math.min(wf,Math.max(-wf,a.apply(this,arguments)-L)),V,$=Math.min(Math.abs(j)/b,c.apply(this,arguments)),H=$*(j<0?-1:1),K;for(v=0;v<b;++v)(K=B[R[v]=v]=+e(i[v],v,i))>0&&(M+=K);for(t!=null?R.sort(function(Y,se){return t(B[Y],B[se])}):n!=null&&R.sort(function(Y,se){return n(i[Y],i[se])}),v=0,A=M?(j-b*H)/M:0;v<b;++v,L=V)T=R[v],K=B[T],V=L+(K>0?K*A:0)+H,B[T]={data:i[T],index:v,value:K,startAngle:L,endAngle:V,padAngle:$};return B}return f.value=function(i){return arguments.length?(e=typeof i=="function"?i:ei(+i),f):e},f.sortValues=function(i){return arguments.length?(t=i,n=null,f):t},f.sort=function(i){return arguments.length?(n=i,t=null,f):n},f.startAngle=function(i){return arguments.length?(r=typeof i=="function"?i:ei(+i),f):r},f.endAngle=function(i){return arguments.length?(a=typeof i=="function"?i:ei(+i),f):a},f.padAngle=function(i){return arguments.length?(c=typeof i=="function"?i:ei(+i),f):c},f}class EY{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function eEe(e){return new EY(e,!0)}function tEe(e){return new EY(e,!1)}const MN={draw(e,t){const n=ka(t/Nf);e.moveTo(n,0),e.arc(0,0,n,0,wf)}},nEe={draw(e,t){const n=ka(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},AY=ka(1/3),rEe=AY*2,iEe={draw(e,t){const n=ka(t/rEe),r=n*AY;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},oEe={draw(e,t){const n=ka(t),r=-n/2;e.rect(r,r,n,n)}},aEe=.8908130915292852,PY=Ls(Nf/10)/Ls(7*Nf/10),sEe=Ls(wf/10)*PY,lEe=-yh(wf/10)*PY,cEe={draw(e,t){const n=ka(t*aEe),r=sEe*n,a=lEe*n;e.moveTo(0,-n),e.lineTo(r,a);for(let c=1;c<5;++c){const f=wf*c/5,i=yh(f),v=Ls(f);e.lineTo(v*n,-i*n),e.lineTo(i*r-v*a,v*r+i*a)}e.closePath()}},vk=ka(3),uEe={draw(e,t){const n=-ka(t/(vk*3));e.moveTo(0,n*2),e.lineTo(-vk*n,-n),e.lineTo(vk*n,-n),e.closePath()}},Ml=-.5,Ol=ka(3)/2,LD=1/ka(12),hEe=(LD/2+1)*3,dEe={draw(e,t){const n=ka(t/hEe),r=n/2,a=n*LD,c=r,f=n*LD+n,i=-c,v=f;e.moveTo(r,a),e.lineTo(c,f),e.lineTo(i,v),e.lineTo(Ml*r-Ol*a,Ol*r+Ml*a),e.lineTo(Ml*c-Ol*f,Ol*c+Ml*f),e.lineTo(Ml*i-Ol*v,Ol*i+Ml*v),e.lineTo(Ml*r+Ol*a,Ml*a-Ol*r),e.lineTo(Ml*c+Ol*f,Ml*f-Ol*c),e.lineTo(Ml*i+Ol*v,Ml*v-Ol*i),e.closePath()}};function fEe(e,t){let n=null,r=xC(a);e=typeof e=="function"?e:ei(e||MN),t=typeof t=="function"?t:ei(t===void 0?64:+t);function a(){let c;if(n||(n=c=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),c)return n=null,c+""||null}return a.type=function(c){return arguments.length?(e=typeof c=="function"?c:ei(c),a):e},a.size=function(c){return arguments.length?(t=typeof c=="function"?c:ei(+c),a):t},a.context=function(c){return arguments.length?(n=c??null,a):n},a}function oA(){}function aA(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function CY(e){this._context=e}CY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:aA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:aA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pEe(e){return new CY(e)}function IY(e){this._context=e}IY.prototype={areaStart:oA,areaEnd:oA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:aA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mEe(e){return new IY(e)}function MY(e){this._context=e}MY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:aA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gEe(e){return new MY(e)}function OY(e){this._context=e}OY.prototype={areaStart:oA,areaEnd:oA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function yEe(e){return new OY(e)}function BV(e){return e<0?-1:1}function jV(e,t,n){var r=e._x1-e._x0,a=t-e._x1,c=(e._y1-e._y0)/(r||a<0&&-0),f=(n-e._y1)/(a||r<0&&-0),i=(c*a+f*r)/(r+a);return(BV(c)+BV(f))*Math.min(Math.abs(c),Math.abs(f),.5*Math.abs(i))||0}function $V(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function xk(e,t,n){var r=e._x0,a=e._y0,c=e._x1,f=e._y1,i=(c-r)/3;e._context.bezierCurveTo(r+i,a+i*t,c-i,f-i*n,c,f)}function sA(e){this._context=e}sA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:xk(this,this._t0,$V(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,xk(this,$V(this,n=jV(this,e,t)),n);break;default:xk(this,this._t0,n=jV(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function kY(e){this._context=new RY(e)}(kY.prototype=Object.create(sA.prototype)).point=function(e,t){sA.prototype.point.call(this,t,e)};function RY(e){this._context=e}RY.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,c){this._context.bezierCurveTo(t,e,r,n,c,a)}};function _Ee(e){return new sA(e)}function vEe(e){return new kY(e)}function DY(e){this._context=e}DY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=UV(e),a=UV(t),c=0,f=1;f<n;++c,++f)this._context.bezierCurveTo(r[0][c],a[0][c],r[1][c],a[1][c],e[f],t[f]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function UV(e){var t,n=e.length-1,r,a=new Array(n),c=new Array(n),f=new Array(n);for(a[0]=0,c[0]=2,f[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,c[t]=4,f[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,c[n-1]=7,f[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/c[t-1],c[t]-=r,f[t]-=r*f[t-1];for(a[n-1]=f[n-1]/c[n-1],t=n-2;t>=0;--t)a[t]=(f[t]-a[t+1])/c[t];for(c[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)c[t]=2*e[t+1]-a[t+1];return[a,c]}function xEe(e){return new DY(e)}function SC(e,t){this._context=e,this._t=t}SC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function bEe(e){return new SC(e,.5)}function wEe(e){return new SC(e,0)}function SEe(e){return new SC(e,1)}function L_(e,t){if((f=e.length)>1)for(var n=1,r,a,c=e[t[0]],f,i=c.length;n<f;++n)for(a=c,c=e[t[n]],r=0;r<i;++r)c[r][1]+=c[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function zD(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function TEe(e,t){return e[t]}function EEe(e){const t=[];return t.key=e,t}function AEe(){var e=ei([]),t=zD,n=L_,r=TEe;function a(c){var f=Array.from(e.apply(this,arguments),EEe),i,v=f.length,b=-1,T;for(const A of c)for(i=0,++b;i<v;++i)(f[i][b]=[0,+r(A,f[i].key,b,c)]).data=A;for(i=0,T=bC(t(f));i<v;++i)f[T[i]].index=i;return n(f,T),f}return a.keys=function(c){return arguments.length?(e=typeof c=="function"?c:ei(Array.from(c)),a):e},a.value=function(c){return arguments.length?(r=typeof c=="function"?c:ei(+c),a):r},a.order=function(c){return arguments.length?(t=c==null?zD:typeof c=="function"?c:ei(Array.from(c)),a):t},a.offset=function(c){return arguments.length?(n=c??L_,a):n},a}function PEe(e,t){if((r=e.length)>0){for(var n,r,a=0,c=e[0].length,f;a<c;++a){for(f=n=0;n<r;++n)f+=e[n][a][1]||0;if(f)for(n=0;n<r;++n)e[n][a][1]/=f}L_(e,t)}}function CEe(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,c=r.length;n<c;++n){for(var f=0,i=0;f<a;++f)i+=e[f][n][1]||0;r[n][1]+=r[n][0]=-i/2}L_(e,t)}}function IEe(e,t){if(!(!((f=e.length)>0)||!((c=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,c,f;r<c;++r){for(var i=0,v=0,b=0;i<f;++i){for(var T=e[t[i]],A=T[r][1]||0,M=T[r-1][1]||0,R=(A-M)/2,B=0;B<i;++B){var L=e[t[B]],j=L[r][1]||0,V=L[r-1][1]||0;R+=j-V}v+=A,b+=R*A}a[r-1][1]+=a[r-1][0]=n,v&&(n-=b/v)}a[r-1][1]+=a[r-1][0]=n,L_(e,t)}}function Mb(e){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(e)}var MEe=["type","size","sizeType"];function ND(){return ND=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ND.apply(this,arguments)}function VV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function GV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VV(Object(n),!0).forEach(function(r){OEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function OEe(e,t,n){return t=kEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kEe(e){var t=REe(e,"string");return Mb(t)=="symbol"?t:t+""}function REe(e,t){if(Mb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Mb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DEe(e,t){if(e==null)return{};var n=LEe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LEe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var LY={symbolCircle:MN,symbolCross:nEe,symbolDiamond:iEe,symbolSquare:oEe,symbolStar:cEe,symbolTriangle:uEe,symbolWye:dEe},zEe=Math.PI/180,NEe=function(t){var n="symbol".concat(vC(t));return LY[n]||MN},FEe=function(t,n,r){if(n==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*zEe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},BEe=function(t,n){LY["symbol".concat(vC(t))]=n},TC=function(t){var n=t.type,r=n===void 0?"circle":n,a=t.size,c=a===void 0?64:a,f=t.sizeType,i=f===void 0?"area":f,v=DEe(t,MEe),b=GV(GV({},v),{},{type:r,size:c,sizeType:i}),T=function(){var j=NEe(r),V=fEe().type(j).size(FEe(c,i,r));return V()},A=b.className,M=b.cx,R=b.cy,B=ir(b,!0);return M===+M&&R===+R&&c===+c?Se.createElement("path",ND({},B,{className:jr("recharts-symbols",A),transform:"translate(".concat(M,", ").concat(R,")"),d:T()})):null};TC.registerSymbol=BEe;function z_(e){"@babel/helpers - typeof";return z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z_(e)}function FD(){return FD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FD.apply(this,arguments)}function WV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function jEe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WV(Object(n),!0).forEach(function(r){Ob(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $Ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UEe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,NY(r.key),r)}}function VEe(e,t,n){return t&&UEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GEe(e,t,n){return t=lA(t),WEe(e,zY()?Reflect.construct(t,n||[],lA(e).constructor):t.apply(e,n))}function WEe(e,t){if(t&&(z_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HEe(e)}function HEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zY=function(){return!!e})()}function lA(e){return lA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},lA(e)}function qEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BD(e,t)}function BD(e,t){return BD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},BD(e,t)}function Ob(e,t,n){return t=NY(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NY(e){var t=ZEe(e,"string");return z_(t)=="symbol"?t:t+""}function ZEe(e,t){if(z_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(z_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kl=32,ON=function(e){function t(){return $Ee(this,t),GEe(this,t,arguments)}return qEe(t,e),VEe(t,[{key:"renderIcon",value:function(r){var a=this.props.inactiveColor,c=kl/2,f=kl/6,i=kl/3,v=r.inactive?a:r.color;if(r.type==="plainline")return Se.createElement("line",{strokeWidth:4,fill:"none",stroke:v,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:c,x2:kl,y2:c,className:"recharts-legend-icon"});if(r.type==="line")return Se.createElement("path",{strokeWidth:4,fill:"none",stroke:v,d:"M0,".concat(c,"h").concat(i,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(2*i,",").concat(c,`
            H`).concat(kl,"M").concat(2*i,",").concat(c,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(i,",").concat(c),className:"recharts-legend-icon"});if(r.type==="rect")return Se.createElement("path",{stroke:"none",fill:v,d:"M0,".concat(kl/8,"h").concat(kl,"v").concat(kl*3/4,"h").concat(-kl,"z"),className:"recharts-legend-icon"});if(Se.isValidElement(r.legendIcon)){var b=jEe({},r);return delete b.legendIcon,Se.cloneElement(r.legendIcon,b)}return Se.createElement(TC,{fill:v,cx:c,cy:c,size:kl,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,a=this.props,c=a.payload,f=a.iconSize,i=a.layout,v=a.formatter,b=a.inactiveColor,T={x:0,y:0,width:kl,height:kl},A={display:i==="horizontal"?"inline-block":"block",marginRight:10},M={display:"inline-block",verticalAlign:"middle",marginRight:4};return c.map(function(R,B){var L=R.formatter||v,j=jr(Ob(Ob({"recharts-legend-item":!0},"legend-item-".concat(B),!0),"inactive",R.inactive));if(R.type==="none")return null;var V=Tr(R.value)?null:R.value;Oc(!Tr(R.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var $=R.inactive?b:R.color;return Se.createElement("li",FD({className:j,style:A,key:"legend-item-".concat(B)},zf(r.props,R,B)),Se.createElement(ID,{width:f,height:f,viewBox:T,style:M},r.renderIcon(R)),Se.createElement("span",{className:"recharts-legend-item-text",style:{color:$}},L?L(V,R,B):V))})}},{key:"render",value:function(){var r=this.props,a=r.payload,c=r.layout,f=r.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:c==="horizontal"?f:"left"};return Se.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(X.PureComponent);Ob(ON,"displayName","Legend");Ob(ON,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var XEe=aC;function KEe(){this.__data__=new XEe,this.size=0}var YEe=KEe;function JEe(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var QEe=JEe;function e2e(e){return this.__data__.get(e)}var t2e=e2e;function n2e(e){return this.__data__.has(e)}var r2e=n2e,i2e=aC,o2e=bN,a2e=wN,s2e=200;function l2e(e,t){var n=this.__data__;if(n instanceof i2e){var r=n.__data__;if(!o2e||r.length<s2e-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new a2e(r)}return n.set(e,t),this.size=n.size,this}var c2e=l2e,u2e=aC,h2e=YEe,d2e=QEe,f2e=t2e,p2e=r2e,m2e=c2e;function Rv(e){var t=this.__data__=new u2e(e);this.size=t.size}Rv.prototype.clear=h2e;Rv.prototype.delete=d2e;Rv.prototype.get=f2e;Rv.prototype.has=p2e;Rv.prototype.set=m2e;var FY=Rv,g2e="__lodash_hash_undefined__";function y2e(e){return this.__data__.set(e,g2e),this}var _2e=y2e;function v2e(e){return this.__data__.has(e)}var x2e=v2e,b2e=wN,w2e=_2e,S2e=x2e;function cA(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new b2e;++t<n;)this.add(e[t])}cA.prototype.add=cA.prototype.push=w2e;cA.prototype.has=S2e;var BY=cA;function T2e(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var jY=T2e;function E2e(e,t){return e.has(t)}var $Y=E2e,A2e=BY,P2e=jY,C2e=$Y,I2e=1,M2e=2;function O2e(e,t,n,r,a,c){var f=n&I2e,i=e.length,v=t.length;if(i!=v&&!(f&&v>i))return!1;var b=c.get(e),T=c.get(t);if(b&&T)return b==t&&T==e;var A=-1,M=!0,R=n&M2e?new A2e:void 0;for(c.set(e,t),c.set(t,e);++A<i;){var B=e[A],L=t[A];if(r)var j=f?r(L,B,A,t,e,c):r(B,L,A,e,t,c);if(j!==void 0){if(j)continue;M=!1;break}if(R){if(!P2e(t,function(V,$){if(!C2e(R,$)&&(B===V||a(B,V,n,r,c)))return R.push($)})){M=!1;break}}else if(!(B===L||a(B,L,n,r,c))){M=!1;break}}return c.delete(e),c.delete(t),M}var UY=O2e,k2e=Cu,R2e=k2e.Uint8Array,D2e=R2e;function L2e(e){var t=-1,n=Array(e.size);return e.forEach(function(r,a){n[++t]=[a,r]}),n}var z2e=L2e;function N2e(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var kN=N2e,HV=Nw,qV=D2e,F2e=xN,B2e=UY,j2e=z2e,$2e=kN,U2e=1,V2e=2,G2e="[object Boolean]",W2e="[object Date]",H2e="[object Error]",q2e="[object Map]",Z2e="[object Number]",X2e="[object RegExp]",K2e="[object Set]",Y2e="[object String]",J2e="[object Symbol]",Q2e="[object ArrayBuffer]",eAe="[object DataView]",ZV=HV?HV.prototype:void 0,bk=ZV?ZV.valueOf:void 0;function tAe(e,t,n,r,a,c,f){switch(n){case eAe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Q2e:return!(e.byteLength!=t.byteLength||!c(new qV(e),new qV(t)));case G2e:case W2e:case Z2e:return F2e(+e,+t);case H2e:return e.name==t.name&&e.message==t.message;case X2e:case Y2e:return e==t+"";case q2e:var i=j2e;case K2e:var v=r&U2e;if(i||(i=$2e),e.size!=t.size&&!v)return!1;var b=f.get(e);if(b)return b==t;r|=V2e,f.set(e,t);var T=B2e(i(e),i(t),r,a,c,f);return f.delete(e),T;case J2e:if(bk)return bk.call(e)==bk.call(t)}return!1}var nAe=tAe;function rAe(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}var VY=rAe,iAe=VY,oAe=Zs;function aAe(e,t,n){var r=t(e);return oAe(e)?r:iAe(r,n(e))}var sAe=aAe;function lAe(e,t){for(var n=-1,r=e==null?0:e.length,a=0,c=[];++n<r;){var f=e[n];t(f,n,e)&&(c[a++]=f)}return c}var cAe=lAe;function uAe(){return[]}var hAe=uAe,dAe=cAe,fAe=hAe,pAe=Object.prototype,mAe=pAe.propertyIsEnumerable,XV=Object.getOwnPropertySymbols,gAe=XV?function(e){return e==null?[]:(e=Object(e),dAe(XV(e),function(t){return mAe.call(e,t)}))}:fAe,yAe=gAe;function _Ae(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var vAe=_Ae,xAe=Vh,bAe=Gh,wAe="[object Arguments]";function SAe(e){return bAe(e)&&xAe(e)==wAe}var TAe=SAe,KV=TAe,EAe=Gh,GY=Object.prototype,AAe=GY.hasOwnProperty,PAe=GY.propertyIsEnumerable,CAe=KV(function(){return arguments}())?KV:function(e){return EAe(e)&&AAe.call(e,"callee")&&!PAe.call(e,"callee")},RN=CAe,uA={exports:{}};function IAe(){return!1}var MAe=IAe;uA.exports;(function(e,t){var n=Cu,r=MAe,a=t&&!t.nodeType&&t,c=a&&!0&&e&&!e.nodeType&&e,f=c&&c.exports===a,i=f?n.Buffer:void 0,v=i?i.isBuffer:void 0,b=v||r;e.exports=b})(uA,uA.exports);var WY=uA.exports,OAe=9007199254740991,kAe=/^(?:0|[1-9]\d*)$/;function RAe(e,t){var n=typeof e;return t=t??OAe,!!t&&(n=="number"||n!="symbol"&&kAe.test(e))&&e>-1&&e%1==0&&e<t}var DN=RAe,DAe=9007199254740991;function LAe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=DAe}var LN=LAe,zAe=Vh,NAe=LN,FAe=Gh,BAe="[object Arguments]",jAe="[object Array]",$Ae="[object Boolean]",UAe="[object Date]",VAe="[object Error]",GAe="[object Function]",WAe="[object Map]",HAe="[object Number]",qAe="[object Object]",ZAe="[object RegExp]",XAe="[object Set]",KAe="[object String]",YAe="[object WeakMap]",JAe="[object ArrayBuffer]",QAe="[object DataView]",ePe="[object Float32Array]",tPe="[object Float64Array]",nPe="[object Int8Array]",rPe="[object Int16Array]",iPe="[object Int32Array]",oPe="[object Uint8Array]",aPe="[object Uint8ClampedArray]",sPe="[object Uint16Array]",lPe="[object Uint32Array]",uo={};uo[ePe]=uo[tPe]=uo[nPe]=uo[rPe]=uo[iPe]=uo[oPe]=uo[aPe]=uo[sPe]=uo[lPe]=!0;uo[BAe]=uo[jAe]=uo[JAe]=uo[$Ae]=uo[QAe]=uo[UAe]=uo[VAe]=uo[GAe]=uo[WAe]=uo[HAe]=uo[qAe]=uo[ZAe]=uo[XAe]=uo[KAe]=uo[YAe]=!1;function cPe(e){return FAe(e)&&NAe(e.length)&&!!uo[zAe(e)]}var uPe=cPe;function hPe(e){return function(t){return e(t)}}var HY=hPe,hA={exports:{}};hA.exports;(function(e,t){var n=QK,r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,c=a&&a.exports===r,f=c&&n.process,i=function(){try{var v=a&&a.require&&a.require("util").types;return v||f&&f.binding&&f.binding("util")}catch{}}();e.exports=i})(hA,hA.exports);var dPe=hA.exports,fPe=uPe,pPe=HY,YV=dPe,JV=YV&&YV.isTypedArray,mPe=JV?pPe(JV):fPe,qY=mPe,gPe=vAe,yPe=RN,_Pe=Zs,vPe=WY,xPe=DN,bPe=qY,wPe=Object.prototype,SPe=wPe.hasOwnProperty;function TPe(e,t){var n=_Pe(e),r=!n&&yPe(e),a=!n&&!r&&vPe(e),c=!n&&!r&&!a&&bPe(e),f=n||r||a||c,i=f?gPe(e.length,String):[],v=i.length;for(var b in e)(t||SPe.call(e,b))&&!(f&&(b=="length"||a&&(b=="offset"||b=="parent")||c&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||xPe(b,v)))&&i.push(b);return i}var EPe=TPe,APe=Object.prototype;function PPe(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||APe;return e===n}var CPe=PPe;function IPe(e,t){return function(n){return e(t(n))}}var ZY=IPe,MPe=ZY,OPe=MPe(Object.keys,Object),kPe=OPe,RPe=CPe,DPe=kPe,LPe=Object.prototype,zPe=LPe.hasOwnProperty;function NPe(e){if(!RPe(e))return DPe(e);var t=[];for(var n in Object(e))zPe.call(e,n)&&n!="constructor"&&t.push(n);return t}var FPe=NPe,BPe=vN,jPe=LN;function $Pe(e){return e!=null&&jPe(e.length)&&!BPe(e)}var Bw=$Pe,UPe=EPe,VPe=FPe,GPe=Bw;function WPe(e){return GPe(e)?UPe(e):VPe(e)}var EC=WPe,HPe=sAe,qPe=yAe,ZPe=EC;function XPe(e){return HPe(e,ZPe,qPe)}var KPe=XPe,QV=KPe,YPe=1,JPe=Object.prototype,QPe=JPe.hasOwnProperty;function eCe(e,t,n,r,a,c){var f=n&YPe,i=QV(e),v=i.length,b=QV(t),T=b.length;if(v!=T&&!f)return!1;for(var A=v;A--;){var M=i[A];if(!(f?M in t:QPe.call(t,M)))return!1}var R=c.get(e),B=c.get(t);if(R&&B)return R==t&&B==e;var L=!0;c.set(e,t),c.set(t,e);for(var j=f;++A<v;){M=i[A];var V=e[M],$=t[M];if(r)var H=f?r($,V,M,t,e,c):r(V,$,M,e,t,c);if(!(H===void 0?V===$||a(V,$,n,r,c):H)){L=!1;break}j||(j=M=="constructor")}if(L&&!j){var K=e.constructor,Y=t.constructor;K!=Y&&"constructor"in e&&"constructor"in t&&!(typeof K=="function"&&K instanceof K&&typeof Y=="function"&&Y instanceof Y)&&(L=!1)}return c.delete(e),c.delete(t),L}var tCe=eCe,nCe=eg,rCe=Cu,iCe=nCe(rCe,"DataView"),oCe=iCe,aCe=eg,sCe=Cu,lCe=aCe(sCe,"Promise"),cCe=lCe,uCe=eg,hCe=Cu,dCe=uCe(hCe,"Set"),XY=dCe,fCe=eg,pCe=Cu,mCe=fCe(pCe,"WeakMap"),gCe=mCe,jD=oCe,$D=bN,UD=cCe,VD=XY,GD=gCe,KY=Vh,Dv=tY,e6="[object Map]",yCe="[object Object]",t6="[object Promise]",n6="[object Set]",r6="[object WeakMap]",i6="[object DataView]",_Ce=Dv(jD),vCe=Dv($D),xCe=Dv(UD),bCe=Dv(VD),wCe=Dv(GD),am=KY;(jD&&am(new jD(new ArrayBuffer(1)))!=i6||$D&&am(new $D)!=e6||UD&&am(UD.resolve())!=t6||VD&&am(new VD)!=n6||GD&&am(new GD)!=r6)&&(am=function(e){var t=KY(e),n=t==yCe?e.constructor:void 0,r=n?Dv(n):"";if(r)switch(r){case _Ce:return i6;case vCe:return e6;case xCe:return t6;case bCe:return n6;case wCe:return r6}return t});var SCe=am,wk=FY,TCe=UY,ECe=nAe,ACe=tCe,o6=SCe,a6=Zs,s6=WY,PCe=qY,CCe=1,l6="[object Arguments]",c6="[object Array]",SE="[object Object]",ICe=Object.prototype,u6=ICe.hasOwnProperty;function MCe(e,t,n,r,a,c){var f=a6(e),i=a6(t),v=f?c6:o6(e),b=i?c6:o6(t);v=v==l6?SE:v,b=b==l6?SE:b;var T=v==SE,A=b==SE,M=v==b;if(M&&s6(e)){if(!s6(t))return!1;f=!0,T=!1}if(M&&!T)return c||(c=new wk),f||PCe(e)?TCe(e,t,n,r,a,c):ECe(e,t,v,n,r,a,c);if(!(n&CCe)){var R=T&&u6.call(e,"__wrapped__"),B=A&&u6.call(t,"__wrapped__");if(R||B){var L=R?e.value():e,j=B?t.value():t;return c||(c=new wk),a(L,j,n,r,c)}}return M?(c||(c=new wk),ACe(e,t,n,r,a,c)):!1}var OCe=MCe,kCe=OCe,h6=Gh;function YY(e,t,n,r,a){return e===t?!0:e==null||t==null||!h6(e)&&!h6(t)?e!==e&&t!==t:kCe(e,t,n,r,YY,a)}var zN=YY,RCe=FY,DCe=zN,LCe=1,zCe=2;function NCe(e,t,n,r){var a=n.length,c=a,f=!r;if(e==null)return!c;for(e=Object(e);a--;){var i=n[a];if(f&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++a<c;){i=n[a];var v=i[0],b=e[v],T=i[1];if(f&&i[2]){if(b===void 0&&!(v in e))return!1}else{var A=new RCe;if(r)var M=r(b,T,v,e,t,A);if(!(M===void 0?DCe(T,b,LCe|zCe,r,A):M))return!1}}return!0}var FCe=NCe,BCe=qf;function jCe(e){return e===e&&!BCe(e)}var JY=jCe,$Ce=JY,UCe=EC;function VCe(e){for(var t=UCe(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,$Ce(a)]}return t}var GCe=VCe;function WCe(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var QY=WCe,HCe=FCe,qCe=GCe,ZCe=QY;function XCe(e){var t=qCe(e);return t.length==1&&t[0][2]?ZCe(t[0][0],t[0][1]):function(n){return n===e||HCe(n,e,t)}}var KCe=XCe;function YCe(e,t){return e!=null&&t in Object(e)}var JCe=YCe,QCe=aY,eIe=RN,tIe=Zs,nIe=DN,rIe=LN,iIe=lC;function oIe(e,t,n){t=QCe(t,e);for(var r=-1,a=t.length,c=!1;++r<a;){var f=iIe(t[r]);if(!(c=e!=null&&n(e,f)))break;e=e[f]}return c||++r!=a?c:(a=e==null?0:e.length,!!a&&rIe(a)&&nIe(f,a)&&(tIe(e)||eIe(e)))}var aIe=oIe,sIe=JCe,lIe=aIe;function cIe(e,t){return e!=null&&lIe(e,t,sIe)}var uIe=cIe,hIe=zN,dIe=sY,fIe=uIe,pIe=_N,mIe=JY,gIe=QY,yIe=lC,_Ie=1,vIe=2;function xIe(e,t){return pIe(e)&&mIe(t)?gIe(yIe(e),t):function(n){var r=dIe(n,e);return r===void 0&&r===t?fIe(n,e):hIe(t,r,_Ie|vIe)}}var bIe=xIe;function wIe(e){return e}var Lv=wIe;function SIe(e){return function(t){return t==null?void 0:t[e]}}var TIe=SIe,EIe=EN;function AIe(e){return function(t){return EIe(t,e)}}var PIe=AIe,CIe=TIe,IIe=PIe,MIe=_N,OIe=lC;function kIe(e){return MIe(e)?CIe(OIe(e)):IIe(e)}var RIe=kIe,DIe=KCe,LIe=bIe,zIe=Lv,NIe=Zs,FIe=RIe;function BIe(e){return typeof e=="function"?e:e==null?zIe:typeof e=="object"?NIe(e)?LIe(e[0],e[1]):DIe(e):FIe(e)}var Iu=BIe;function jIe(e,t,n,r){for(var a=e.length,c=n+(r?1:-1);r?c--:++c<a;)if(t(e[c],c,e))return c;return-1}var eJ=jIe;function $Ie(e){return e!==e}var UIe=$Ie;function VIe(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}var GIe=VIe,WIe=eJ,HIe=UIe,qIe=GIe;function ZIe(e,t,n){return t===t?qIe(e,t,n):WIe(e,HIe,n)}var XIe=ZIe,KIe=XIe;function YIe(e,t){var n=e==null?0:e.length;return!!n&&KIe(e,t,0)>-1}var JIe=YIe;function QIe(e,t,n){for(var r=-1,a=e==null?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}var eMe=QIe;function tMe(){}var nMe=tMe,Sk=XY,rMe=nMe,iMe=kN,oMe=1/0,aMe=Sk&&1/iMe(new Sk([,-0]))[1]==oMe?function(e){return new Sk(e)}:rMe,sMe=aMe,lMe=BY,cMe=JIe,uMe=eMe,hMe=$Y,dMe=sMe,fMe=kN,pMe=200;function mMe(e,t,n){var r=-1,a=cMe,c=e.length,f=!0,i=[],v=i;if(n)f=!1,a=uMe;else if(c>=pMe){var b=t?null:dMe(e);if(b)return fMe(b);f=!1,a=hMe,v=new lMe}else v=t?[]:i;e:for(;++r<c;){var T=e[r],A=t?t(T):T;if(T=n||T!==0?T:0,f&&A===A){for(var M=v.length;M--;)if(v[M]===A)continue e;t&&v.push(A),i.push(T)}else a(v,A,n)||(v!==i&&v.push(A),i.push(T))}return i}var gMe=mMe,yMe=Iu,_Me=gMe;function vMe(e,t){return e&&e.length?_Me(e,yMe(t)):[]}var xMe=vMe;const d6=Bi(xMe);function tJ(e,t,n){return t===!0?d6(e,n):Tr(t)?d6(e,t):e}function N_(e){"@babel/helpers - typeof";return N_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N_(e)}var bMe=["ref"];function f6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function hh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f6(Object(n),!0).forEach(function(r){AC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function wMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rJ(r.key),r)}}function SMe(e,t,n){return t&&p6(e.prototype,t),n&&p6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function TMe(e,t,n){return t=dA(t),EMe(e,nJ()?Reflect.construct(t,n||[],dA(e).constructor):t.apply(e,n))}function EMe(e,t){if(t&&(N_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AMe(e)}function AMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nJ=function(){return!!e})()}function dA(e){return dA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dA(e)}function PMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WD(e,t)}function WD(e,t){return WD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},WD(e,t)}function AC(e,t,n){return t=rJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rJ(e){var t=CMe(e,"string");return N_(t)=="symbol"?t:t+""}function CMe(e,t){if(N_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(N_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IMe(e,t){if(e==null)return{};var n=MMe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function MMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function OMe(e){return e.value}function kMe(e,t){if(Se.isValidElement(e))return Se.cloneElement(e,t);if(typeof e=="function")return Se.createElement(e,t);t.ref;var n=IMe(t,bMe);return Se.createElement(ON,n)}var m6=1,p_=function(e){function t(){var n;wMe(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=TMe(this,t,[].concat(a)),AC(n,"lastBoundingBox",{width:-1,height:-1}),n}return PMe(t,e),SMe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>m6||Math.abs(a.height-this.lastBoundingBox.height)>m6)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,r&&r(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?hh({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var a=this.props,c=a.layout,f=a.align,i=a.verticalAlign,v=a.margin,b=a.chartWidth,T=a.chartHeight,A,M;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(f==="center"&&c==="vertical"){var R=this.getBBoxSnapshot();A={left:((b||0)-R.width)/2}}else A=f==="right"?{right:v&&v.right||0}:{left:v&&v.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(i==="middle"){var B=this.getBBoxSnapshot();M={top:((T||0)-B.height)/2}}else M=i==="bottom"?{bottom:v&&v.bottom||0}:{top:v&&v.top||0};return hh(hh({},A),M)}},{key:"render",value:function(){var r=this,a=this.props,c=a.content,f=a.width,i=a.height,v=a.wrapperStyle,b=a.payloadUniqBy,T=a.payload,A=hh(hh({position:"absolute",width:f||"auto",height:i||"auto"},this.getDefaultPosition(v)),v);return Se.createElement("div",{className:"recharts-legend-wrapper",style:A,ref:function(R){r.wrapperNode=R}},kMe(c,hh(hh({},this.props),{},{payload:tJ(T,b,OMe)})))}}],[{key:"getWithHeight",value:function(r,a){var c=hh(hh({},this.defaultProps),r.props),f=c.layout;return f==="vertical"&&wn(r.props.height)?{height:r.props.height}:f==="horizontal"?{width:r.props.width||a}:null}}])}(X.PureComponent);AC(p_,"displayName","Legend");AC(p_,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var g6=Nw,RMe=RN,DMe=Zs,y6=g6?g6.isConcatSpreadable:void 0;function LMe(e){return DMe(e)||RMe(e)||!!(y6&&e&&e[y6])}var zMe=LMe,NMe=VY,FMe=zMe;function iJ(e,t,n,r,a){var c=-1,f=e.length;for(n||(n=FMe),a||(a=[]);++c<f;){var i=e[c];t>0&&n(i)?t>1?iJ(i,t-1,n,r,a):NMe(a,i):r||(a[a.length]=i)}return a}var oJ=iJ;function BMe(e){return function(t,n,r){for(var a=-1,c=Object(t),f=r(t),i=f.length;i--;){var v=f[e?i:++a];if(n(c[v],v,c)===!1)break}return t}}var jMe=BMe,$Me=jMe,UMe=$Me(),VMe=UMe,GMe=VMe,WMe=EC;function HMe(e,t){return e&&GMe(e,t,WMe)}var aJ=HMe,qMe=Bw;function ZMe(e,t){return function(n,r){if(n==null)return n;if(!qMe(n))return e(n,r);for(var a=n.length,c=t?a:-1,f=Object(n);(t?c--:++c<a)&&r(f[c],c,f)!==!1;);return n}}var XMe=ZMe,KMe=aJ,YMe=XMe,JMe=YMe(KMe),NN=JMe,QMe=NN,eOe=Bw;function tOe(e,t){var n=-1,r=eOe(e)?Array(e.length):[];return QMe(e,function(a,c,f){r[++n]=t(a,c,f)}),r}var sJ=tOe;function nOe(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var rOe=nOe,_6=Pv;function iOe(e,t){if(e!==t){var n=e!==void 0,r=e===null,a=e===e,c=_6(e),f=t!==void 0,i=t===null,v=t===t,b=_6(t);if(!i&&!b&&!c&&e>t||c&&f&&v&&!i&&!b||r&&f&&v||!n&&v||!a)return 1;if(!r&&!c&&!b&&e<t||b&&n&&a&&!r&&!c||i&&n&&a||!f&&a||!v)return-1}return 0}var oOe=iOe,aOe=oOe;function sOe(e,t,n){for(var r=-1,a=e.criteria,c=t.criteria,f=a.length,i=n.length;++r<f;){var v=aOe(a[r],c[r]);if(v){if(r>=i)return v;var b=n[r];return v*(b=="desc"?-1:1)}}return e.index-t.index}var lOe=sOe,Tk=TN,cOe=EN,uOe=Iu,hOe=sJ,dOe=rOe,fOe=HY,pOe=lOe,mOe=Lv,gOe=Zs;function yOe(e,t,n){t.length?t=Tk(t,function(c){return gOe(c)?function(f){return cOe(f,c.length===1?c[0]:c)}:c}):t=[mOe];var r=-1;t=Tk(t,fOe(uOe));var a=hOe(e,function(c,f,i){var v=Tk(t,function(b){return b(c)});return{criteria:v,index:++r,value:c}});return dOe(a,function(c,f){return pOe(c,f,n)})}var _Oe=yOe;function vOe(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var xOe=vOe,bOe=xOe,v6=Math.max;function wOe(e,t,n){return t=v6(t===void 0?e.length-1:t,0),function(){for(var r=arguments,a=-1,c=v6(r.length-t,0),f=Array(c);++a<c;)f[a]=r[t+a];a=-1;for(var i=Array(t+1);++a<t;)i[a]=r[a];return i[t]=n(f),bOe(e,this,i)}}var SOe=wOe;function TOe(e){return function(){return e}}var EOe=TOe,AOe=eg,POe=function(){try{var e=AOe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),lJ=POe,COe=EOe,x6=lJ,IOe=Lv,MOe=x6?function(e,t){return x6(e,"toString",{configurable:!0,enumerable:!1,value:COe(t),writable:!0})}:IOe,OOe=MOe,kOe=800,ROe=16,DOe=Date.now;function LOe(e){var t=0,n=0;return function(){var r=DOe(),a=ROe-(r-n);if(n=r,a>0){if(++t>=kOe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var zOe=LOe,NOe=OOe,FOe=zOe,BOe=FOe(NOe),jOe=BOe,$Oe=Lv,UOe=SOe,VOe=jOe;function GOe(e,t){return VOe(UOe(e,t,$Oe),e+"")}var WOe=GOe,HOe=xN,qOe=Bw,ZOe=DN,XOe=qf;function KOe(e,t,n){if(!XOe(n))return!1;var r=typeof t;return(r=="number"?qOe(n)&&ZOe(t,n.length):r=="string"&&t in n)?HOe(n[t],e):!1}var PC=KOe,YOe=oJ,JOe=_Oe,QOe=WOe,b6=PC,eke=QOe(function(e,t){if(e==null)return[];var n=t.length;return n>1&&b6(e,t[0],t[1])?t=[]:n>2&&b6(t[0],t[1],t[2])&&(t=[t[0]]),JOe(e,YOe(t,1),[])}),tke=eke;const FN=Bi(tke);function kb(e){"@babel/helpers - typeof";return kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kb(e)}function HD(){return HD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HD.apply(this,arguments)}function nke(e,t){return ake(e)||oke(e,t)||ike(e,t)||rke()}function rke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ike(e,t){if(e){if(typeof e=="string")return w6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w6(e,t)}}function w6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oke(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function ake(e){if(Array.isArray(e))return e}function S6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ek(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S6(Object(n),!0).forEach(function(r){ske(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ske(e,t,n){return t=lke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lke(e){var t=cke(e,"string");return kb(t)=="symbol"?t:t+""}function cke(e,t){if(kb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(kb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uke(e){return Array.isArray(e)&&aa(e[0])&&aa(e[1])?e.join(" ~ "):e}var hke=function(t){var n=t.separator,r=n===void 0?" : ":n,a=t.contentStyle,c=a===void 0?{}:a,f=t.itemStyle,i=f===void 0?{}:f,v=t.labelStyle,b=v===void 0?{}:v,T=t.payload,A=t.formatter,M=t.itemSorter,R=t.wrapperClassName,B=t.labelClassName,L=t.label,j=t.labelFormatter,V=t.accessibilityLayer,$=V===void 0?!1:V,H=function(){if(T&&T.length){var Re={padding:0,margin:0},$e=(M?FN(T,M):T).map(function(Ge,ht){if(Ge.type==="none")return null;var ot=Ek({display:"block",paddingTop:4,paddingBottom:4,color:Ge.color||"#000"},i),Je=Ge.formatter||A||uke,Ne=Ge.value,Xe=Ge.name,pt=Ne,zt=Xe;if(Je&&pt!=null&&zt!=null){var Ft=Je(Ne,Xe,Ge,ht,T);if(Array.isArray(Ft)){var un=nke(Ft,2);pt=un[0],zt=un[1]}else pt=Ft}return Se.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ht),style:ot},aa(zt)?Se.createElement("span",{className:"recharts-tooltip-item-name"},zt):null,aa(zt)?Se.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,Se.createElement("span",{className:"recharts-tooltip-item-value"},pt),Se.createElement("span",{className:"recharts-tooltip-item-unit"},Ge.unit||""))});return Se.createElement("ul",{className:"recharts-tooltip-item-list",style:Re},$e)}return null},K=Ek({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},c),Y=Ek({margin:0},b),se=!xr(L),ce=se?L:"",ye=jr("recharts-default-tooltip",R),ze=jr("recharts-tooltip-label",B);se&&j&&T!==void 0&&T!==null&&(ce=j(L,T));var Le=$?{role:"status","aria-live":"assertive"}:{};return Se.createElement("div",HD({className:ye,style:K},Le),Se.createElement("p",{className:ze,style:Y},Se.isValidElement(ce)?ce:"".concat(ce)),H())};function Rb(e){"@babel/helpers - typeof";return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(e)}function TE(e,t,n){return t=dke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dke(e){var t=fke(e,"string");return Rb(t)=="symbol"?t:t+""}function fke(e,t){if(Rb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Rb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yx="recharts-tooltip-wrapper",pke={visibility:"hidden"};function mke(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return jr(Yx,TE(TE(TE(TE({},"".concat(Yx,"-right"),wn(n)&&t&&wn(t.x)&&n>=t.x),"".concat(Yx,"-left"),wn(n)&&t&&wn(t.x)&&n<t.x),"".concat(Yx,"-bottom"),wn(r)&&t&&wn(t.y)&&r>=t.y),"".concat(Yx,"-top"),wn(r)&&t&&wn(t.y)&&r<t.y))}function T6(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,c=e.position,f=e.reverseDirection,i=e.tooltipDimension,v=e.viewBox,b=e.viewBoxDimension;if(c&&wn(c[r]))return c[r];var T=n[r]-i-a,A=n[r]+a;if(t[r])return f[r]?T:A;if(f[r]){var M=T,R=v[r];return M<R?Math.max(A,v[r]):Math.max(T,v[r])}var B=A+i,L=v[r]+b;return B>L?Math.max(T,v[r]):Math.max(A,v[r])}function gke(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function yke(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,c=e.reverseDirection,f=e.tooltipBox,i=e.useTranslate3d,v=e.viewBox,b,T,A;return f.height>0&&f.width>0&&n?(T=T6({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:c,tooltipDimension:f.width,viewBox:v,viewBoxDimension:v.width}),A=T6({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:c,tooltipDimension:f.height,viewBox:v,viewBoxDimension:v.height}),b=gke({translateX:T,translateY:A,useTranslate3d:i})):b=pke,{cssProperties:b,cssClasses:mke({translateX:T,translateY:A,coordinate:n})}}function F_(e){"@babel/helpers - typeof";return F_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F_(e)}function E6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function A6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?E6(Object(n),!0).forEach(function(r){ZD(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uJ(r.key),r)}}function xke(e,t,n){return t&&vke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function bke(e,t,n){return t=fA(t),wke(e,cJ()?Reflect.construct(t,n||[],fA(e).constructor):t.apply(e,n))}function wke(e,t){if(t&&(F_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ske(e)}function Ske(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cJ=function(){return!!e})()}function fA(e){return fA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fA(e)}function Tke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qD(e,t)}function qD(e,t){return qD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},qD(e,t)}function ZD(e,t,n){return t=uJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uJ(e){var t=Eke(e,"string");return F_(t)=="symbol"?t:t+""}function Eke(e,t){if(F_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(F_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P6=1,Ake=function(e){function t(){var n;_ke(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=bke(this,t,[].concat(a)),ZD(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),ZD(n,"handleKeyDown",function(f){if(f.key==="Escape"){var i,v,b,T;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(v=n.props.coordinate)===null||v===void 0?void 0:v.x)!==null&&i!==void 0?i:0,y:(b=(T=n.props.coordinate)===null||T===void 0?void 0:T.y)!==null&&b!==void 0?b:0}})}}),n}return Tke(t,e),xke(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>P6||Math.abs(r.height-this.state.lastBoundingBox.height)>P6)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,a=this.props,c=a.active,f=a.allowEscapeViewBox,i=a.animationDuration,v=a.animationEasing,b=a.children,T=a.coordinate,A=a.hasPayload,M=a.isAnimationActive,R=a.offset,B=a.position,L=a.reverseDirection,j=a.useTranslate3d,V=a.viewBox,$=a.wrapperStyle,H=yke({allowEscapeViewBox:f,coordinate:T,offsetTopLeft:R,position:B,reverseDirection:L,tooltipBox:this.state.lastBoundingBox,useTranslate3d:j,viewBox:V}),K=H.cssClasses,Y=H.cssProperties,se=A6(A6({transition:M&&c?"transform ".concat(i,"ms ").concat(v):void 0},Y),{},{pointerEvents:"none",visibility:!this.state.dismissed&&c&&A?"visible":"hidden",position:"absolute",top:0,left:0},$);return Se.createElement("div",{tabIndex:-1,className:K,style:se,ref:function(ye){r.wrapperNode=ye}},b)}}])}(X.PureComponent),Pke=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ul={isSsr:Pke(),get:function(t){return Ul[t]},set:function(t,n){if(typeof t=="string")Ul[t]=n;else{var r=Object.keys(t);r&&r.length&&r.forEach(function(a){Ul[a]=t[a]})}}};function B_(e){"@babel/helpers - typeof";return B_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B_(e)}function C6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function I6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C6(Object(n),!0).forEach(function(r){BN(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Cke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ike(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dJ(r.key),r)}}function Mke(e,t,n){return t&&Ike(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oke(e,t,n){return t=pA(t),kke(e,hJ()?Reflect.construct(t,n||[],pA(e).constructor):t.apply(e,n))}function kke(e,t){if(t&&(B_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rke(e)}function Rke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hJ=function(){return!!e})()}function pA(e){return pA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},pA(e)}function Dke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XD(e,t)}function XD(e,t){return XD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},XD(e,t)}function BN(e,t,n){return t=dJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dJ(e){var t=Lke(e,"string");return B_(t)=="symbol"?t:t+""}function Lke(e,t){if(B_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(B_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zke(e){return e.dataKey}function Nke(e,t){return Se.isValidElement(e)?Se.cloneElement(e,t):typeof e=="function"?Se.createElement(e,t):Se.createElement(hke,t)}var _h=function(e){function t(){return Cke(this,t),Oke(this,t,arguments)}return Dke(t,e),Mke(t,[{key:"render",value:function(){var r=this,a=this.props,c=a.active,f=a.allowEscapeViewBox,i=a.animationDuration,v=a.animationEasing,b=a.content,T=a.coordinate,A=a.filterNull,M=a.isAnimationActive,R=a.offset,B=a.payload,L=a.payloadUniqBy,j=a.position,V=a.reverseDirection,$=a.useTranslate3d,H=a.viewBox,K=a.wrapperStyle,Y=B??[];A&&Y.length&&(Y=tJ(B.filter(function(ce){return ce.value!=null&&(ce.hide!==!0||r.props.includeHidden)}),L,zke));var se=Y.length>0;return Se.createElement(Ake,{allowEscapeViewBox:f,animationDuration:i,animationEasing:v,isAnimationActive:M,active:c,coordinate:T,hasPayload:se,offset:R,position:j,reverseDirection:V,useTranslate3d:$,viewBox:H,wrapperStyle:K},Nke(b,I6(I6({},this.props),{},{payload:Y})))}}])}(X.PureComponent);BN(_h,"displayName","Tooltip");BN(_h,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ul.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Fke=Cu,Bke=function(){return Fke.Date.now()},jke=Bke,$ke=/\s/;function Uke(e){for(var t=e.length;t--&&$ke.test(e.charAt(t)););return t}var Vke=Uke,Gke=Vke,Wke=/^\s+/;function Hke(e){return e&&e.slice(0,Gke(e)+1).replace(Wke,"")}var qke=Hke,Zke=qke,M6=qf,Xke=Pv,O6=NaN,Kke=/^[-+]0x[0-9a-f]+$/i,Yke=/^0b[01]+$/i,Jke=/^0o[0-7]+$/i,Qke=parseInt;function eRe(e){if(typeof e=="number")return e;if(Xke(e))return O6;if(M6(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=M6(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Zke(e);var n=Yke.test(e);return n||Jke.test(e)?Qke(e.slice(2),n?2:8):Kke.test(e)?O6:+e}var fJ=eRe,tRe=qf,Ak=jke,k6=fJ,nRe="Expected a function",rRe=Math.max,iRe=Math.min;function oRe(e,t,n){var r,a,c,f,i,v,b=0,T=!1,A=!1,M=!0;if(typeof e!="function")throw new TypeError(nRe);t=k6(t)||0,tRe(n)&&(T=!!n.leading,A="maxWait"in n,c=A?rRe(k6(n.maxWait)||0,t):c,M="trailing"in n?!!n.trailing:M);function R(se){var ce=r,ye=a;return r=a=void 0,b=se,f=e.apply(ye,ce),f}function B(se){return b=se,i=setTimeout(V,t),T?R(se):f}function L(se){var ce=se-v,ye=se-b,ze=t-ce;return A?iRe(ze,c-ye):ze}function j(se){var ce=se-v,ye=se-b;return v===void 0||ce>=t||ce<0||A&&ye>=c}function V(){var se=Ak();if(j(se))return $(se);i=setTimeout(V,L(se))}function $(se){return i=void 0,M&&r?R(se):(r=a=void 0,f)}function H(){i!==void 0&&clearTimeout(i),b=0,r=v=a=i=void 0}function K(){return i===void 0?f:$(Ak())}function Y(){var se=Ak(),ce=j(se);if(r=arguments,a=this,v=se,ce){if(i===void 0)return B(v);if(A)return clearTimeout(i),i=setTimeout(V,t),R(v)}return i===void 0&&(i=setTimeout(V,t)),f}return Y.cancel=H,Y.flush=K,Y}var aRe=oRe,sRe=aRe,lRe=qf,cRe="Expected a function";function uRe(e,t,n){var r=!0,a=!0;if(typeof e!="function")throw new TypeError(cRe);return lRe(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),sRe(e,t,{leading:r,maxWait:t,trailing:a})}var hRe=uRe;const pJ=Bi(hRe);function Db(e){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Db(e)}function R6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function EE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R6(Object(n),!0).forEach(function(r){dRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dRe(e,t,n){return t=fRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fRe(e){var t=pRe(e,"string");return Db(t)=="symbol"?t:t+""}function pRe(e,t){if(Db(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Db(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mRe(e,t){return vRe(e)||_Re(e,t)||yRe(e,t)||gRe()}function gRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yRe(e,t){if(e){if(typeof e=="string")return D6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D6(e,t)}}function D6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _Re(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function vRe(e){if(Array.isArray(e))return e}var gXe=X.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,c=e.width,f=c===void 0?"100%":c,i=e.height,v=i===void 0?"100%":i,b=e.minWidth,T=b===void 0?0:b,A=e.minHeight,M=e.maxHeight,R=e.children,B=e.debounce,L=B===void 0?0:B,j=e.id,V=e.className,$=e.onResize,H=e.style,K=H===void 0?{}:H,Y=X.useRef(null),se=X.useRef();se.current=$,X.useImperativeHandle(t,function(){return Object.defineProperty(Y.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),Y.current},configurable:!0})});var ce=X.useState({containerWidth:a.width,containerHeight:a.height}),ye=mRe(ce,2),ze=ye[0],Le=ye[1],je=X.useCallback(function($e,Ge){Le(function(ht){var ot=Math.round($e),Je=Math.round(Ge);return ht.containerWidth===ot&&ht.containerHeight===Je?ht:{containerWidth:ot,containerHeight:Je}})},[]);X.useEffect(function(){var $e=function(Xe){var pt,zt=Xe[0].contentRect,Ft=zt.width,un=zt.height;je(Ft,un),(pt=se.current)===null||pt===void 0||pt.call(se,Ft,un)};L>0&&($e=pJ($e,L,{trailing:!0,leading:!1}));var Ge=new ResizeObserver($e),ht=Y.current.getBoundingClientRect(),ot=ht.width,Je=ht.height;return je(ot,Je),Ge.observe(Y.current),function(){Ge.disconnect()}},[je,L]);var Re=X.useMemo(function(){var $e=ze.containerWidth,Ge=ze.containerHeight;if($e<0||Ge<0)return null;Oc(pm(f)||pm(v),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,f,v),Oc(!n||n>0,"The aspect(%s) must be greater than zero.",n);var ht=pm(f)?$e:f,ot=pm(v)?Ge:v;n&&n>0&&(ht?ot=ht/n:ot&&(ht=ot*n),M&&ot>M&&(ot=M)),Oc(ht>0||ot>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,ht,ot,f,v,T,A,n);var Je=!Array.isArray(R)&&Ch(R.type).endsWith("Chart");return Se.Children.map(R,function(Ne){return uY.isElement(Ne)?X.cloneElement(Ne,EE({width:ht,height:ot},Je?{style:EE({height:"100%",width:"100%",maxHeight:ot,maxWidth:ht},Ne.props.style)}:{})):Ne})},[n,R,v,M,A,T,ze,f]);return Se.createElement("div",{id:j?"".concat(j):void 0,className:jr("recharts-responsive-container",V),style:EE(EE({},K),{},{width:f,height:v,minWidth:T,minHeight:A,maxHeight:M}),ref:Y},Re)}),CC=function(t){return null};CC.displayName="Cell";function Lb(e){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function L6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function KD(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L6(Object(n),!0).forEach(function(r){xRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xRe(e,t,n){return t=bRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bRe(e){var t=wRe(e,"string");return Lb(t)=="symbol"?t:t+""}function wRe(e,t){if(Lb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Lb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ry={widthCache:{},cacheCount:0},SRe=2e3,TRe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},z6="recharts_measurement_span";function ERe(e){var t=KD({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var z1=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ul.isSsr)return{width:0,height:0};var r=ERe(n),a=JSON.stringify({text:t,copyStyle:r});if(Ry.widthCache[a])return Ry.widthCache[a];try{var c=document.getElementById(z6);c||(c=document.createElement("span"),c.setAttribute("id",z6),c.setAttribute("aria-hidden","true"),document.body.appendChild(c));var f=KD(KD({},TRe),r);Object.assign(c.style,f),c.textContent="".concat(t);var i=c.getBoundingClientRect(),v={width:i.width,height:i.height};return Ry.widthCache[a]=v,++Ry.cacheCount>SRe&&(Ry.cacheCount=0,Ry.widthCache={}),v}catch{return{width:0,height:0}}},ARe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function zb(e){"@babel/helpers - typeof";return zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zb(e)}function mA(e,t){return MRe(e)||IRe(e,t)||CRe(e,t)||PRe()}function PRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CRe(e,t){if(e){if(typeof e=="string")return N6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N6(e,t)}}function N6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function IRe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;v=!1}else for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function MRe(e){if(Array.isArray(e))return e}function ORe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,RRe(r.key),r)}}function kRe(e,t,n){return t&&F6(e.prototype,t),n&&F6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function RRe(e){var t=DRe(e,"string");return zb(t)=="symbol"?t:t+""}function DRe(e,t){if(zb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(zb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var B6=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,j6=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,LRe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,zRe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,mJ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},NRe=Object.keys(mJ),Qy="NaN";function FRe(e,t){return e*mJ[t]}var AE=function(){function e(t,n){ORe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!LRe.test(n)&&(this.num=NaN,this.unit=""),NRe.includes(n)&&(this.num=FRe(t,n),this.unit="px")}return kRe(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,a=(r=zRe.exec(n))!==null&&r!==void 0?r:[],c=mA(a,3),f=c[1],i=c[2];return new e(parseFloat(f),i??"")}}])}();function gJ(e){if(e.includes(Qy))return Qy;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=B6.exec(t))!==null&&n!==void 0?n:[],a=mA(r,4),c=a[1],f=a[2],i=a[3],v=AE.parse(c??""),b=AE.parse(i??""),T=f==="*"?v.multiply(b):v.divide(b);if(T.isNaN())return Qy;t=t.replace(B6,T.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var A,M=(A=j6.exec(t))!==null&&A!==void 0?A:[],R=mA(M,4),B=R[1],L=R[2],j=R[3],V=AE.parse(B??""),$=AE.parse(j??""),H=L==="+"?V.add($):V.subtract($);if(H.isNaN())return Qy;t=t.replace(j6,H.toString())}return t}var $6=/\(([^()]*)\)/;function BRe(e){for(var t=e;t.includes("(");){var n=$6.exec(t),r=mA(n,2),a=r[1];t=t.replace($6,gJ(a))}return t}function jRe(e){var t=e.replace(/\s+/g,"");return t=BRe(t),t=gJ(t),t}function $Re(e){try{return jRe(e)}catch{return Qy}}function Pk(e){var t=$Re(e.slice(5,-1));return t===Qy?"":t}var URe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],VRe=["dx","dy","angle","className","breakAll"];function YD(){return YD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YD.apply(this,arguments)}function U6(e,t){if(e==null)return{};var n=GRe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GRe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function V6(e,t){return ZRe(e)||qRe(e,t)||HRe(e,t)||WRe()}function WRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HRe(e,t){if(e){if(typeof e=="string")return G6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G6(e,t)}}function G6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qRe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;v=!1}else for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function ZRe(e){if(Array.isArray(e))return e}var yJ=/[ \f\n\r\t\v\u2028\u2029]+/,_J=function(t){var n=t.children,r=t.breakAll,a=t.style;try{var c=[];xr(n)||(r?c=n.toString().split(""):c=n.toString().split(yJ));var f=c.map(function(v){return{word:v,width:z1(v,a).width}}),i=r?0:z1(" ",a).width;return{wordsWithComputedWidth:f,spaceWidth:i}}catch{return null}},XRe=function(t,n,r,a,c){var f=t.maxLines,i=t.children,v=t.style,b=t.breakAll,T=wn(f),A=i,M=function(){var ht=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ht.reduce(function(ot,Je){var Ne=Je.word,Xe=Je.width,pt=ot[ot.length-1];if(pt&&(a==null||c||pt.width+Xe+r<Number(a)))pt.words.push(Ne),pt.width+=Xe+r;else{var zt={words:[Ne],width:Xe};ot.push(zt)}return ot},[])},R=M(n),B=function(ht){return ht.reduce(function(ot,Je){return ot.width>Je.width?ot:Je})};if(!T)return R;for(var L="…",j=function(ht){var ot=A.slice(0,ht),Je=_J({breakAll:b,style:v,children:ot+L}).wordsWithComputedWidth,Ne=M(Je),Xe=Ne.length>f||B(Ne).width>Number(a);return[Xe,Ne]},V=0,$=A.length-1,H=0,K;V<=$&&H<=A.length-1;){var Y=Math.floor((V+$)/2),se=Y-1,ce=j(se),ye=V6(ce,2),ze=ye[0],Le=ye[1],je=j(Y),Re=V6(je,1),$e=Re[0];if(!ze&&!$e&&(V=Y+1),ze&&$e&&($=Y-1),!ze&&$e){K=Le;break}H++}return K||R},W6=function(t){var n=xr(t)?[]:t.toString().split(yJ);return[{words:n}]},KRe=function(t){var n=t.width,r=t.scaleToFit,a=t.children,c=t.style,f=t.breakAll,i=t.maxLines;if((n||r)&&!Ul.isSsr){var v,b,T=_J({breakAll:f,children:a,style:c});if(T){var A=T.wordsWithComputedWidth,M=T.spaceWidth;v=A,b=M}else return W6(a);return XRe({breakAll:f,children:a,maxLines:i,style:c},v,b,n,r)}return W6(a)},H6="#808080",zm=function(t){var n=t.x,r=n===void 0?0:n,a=t.y,c=a===void 0?0:a,f=t.lineHeight,i=f===void 0?"1em":f,v=t.capHeight,b=v===void 0?"0.71em":v,T=t.scaleToFit,A=T===void 0?!1:T,M=t.textAnchor,R=M===void 0?"start":M,B=t.verticalAnchor,L=B===void 0?"end":B,j=t.fill,V=j===void 0?H6:j,$=U6(t,URe),H=X.useMemo(function(){return KRe({breakAll:$.breakAll,children:$.children,maxLines:$.maxLines,scaleToFit:A,style:$.style,width:$.width})},[$.breakAll,$.children,$.maxLines,A,$.style,$.width]),K=$.dx,Y=$.dy,se=$.angle,ce=$.className,ye=$.breakAll,ze=U6($,VRe);if(!aa(r)||!aa(c))return null;var Le=r+(wn(K)?K:0),je=c+(wn(Y)?Y:0),Re;switch(L){case"start":Re=Pk("calc(".concat(b,")"));break;case"middle":Re=Pk("calc(".concat((H.length-1)/2," * -").concat(i," + (").concat(b," / 2))"));break;default:Re=Pk("calc(".concat(H.length-1," * -").concat(i,")"));break}var $e=[];if(A){var Ge=H[0].width,ht=$.width;$e.push("scale(".concat((wn(ht)?ht/Ge:1)/Ge,")"))}return se&&$e.push("rotate(".concat(se,", ").concat(Le,", ").concat(je,")")),$e.length&&(ze.transform=$e.join(" ")),Se.createElement("text",YD({},ir(ze,!0),{x:Le,y:je,className:jr("recharts-text",ce),textAnchor:R,fill:V.includes("url")?H6:V}),H.map(function(ot,Je){var Ne=ot.words.join(ye?"":" ");return Se.createElement("tspan",{x:Le,dy:Je===0?Re:i,key:"".concat(Ne,"-").concat(Je)},Ne)}))};function Sf(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function YRe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function jN(e){let t,n,r;e.length!==2?(t=Sf,n=(i,v)=>Sf(e(i),v),r=(i,v)=>e(i)-v):(t=e===Sf||e===YRe?e:JRe,n=e,r=e);function a(i,v,b=0,T=i.length){if(b<T){if(t(v,v)!==0)return T;do{const A=b+T>>>1;n(i[A],v)<0?b=A+1:T=A}while(b<T)}return b}function c(i,v,b=0,T=i.length){if(b<T){if(t(v,v)!==0)return T;do{const A=b+T>>>1;n(i[A],v)<=0?b=A+1:T=A}while(b<T)}return b}function f(i,v,b=0,T=i.length){const A=a(i,v,b,T-1);return A>b&&r(i[A-1],v)>-r(i[A],v)?A-1:A}return{left:a,center:f,right:c}}function JRe(){return 0}function vJ(e){return e===null?NaN:+e}function*QRe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const eDe=jN(Sf),jw=eDe.right;jN(vJ).center;function yXe(e,t){let n,r;if(t===void 0)for(const a of e)a!=null&&(n===void 0?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)));else{let a=-1;for(let c of e)(c=t(c,++a,e))!=null&&(n===void 0?c>=c&&(n=r=c):(n>c&&(n=c),r<c&&(r=c)))}return[n,r]}class q6 extends Map{constructor(t,n=rDe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(Z6(this,t))}has(t){return super.has(Z6(this,t))}set(t,n){return super.set(tDe(this,t),n)}delete(t){return super.delete(nDe(this,t))}}function Z6({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function tDe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function nDe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function rDe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function iDe(e=Sf){if(e===Sf)return xJ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function xJ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const oDe=Math.sqrt(50),aDe=Math.sqrt(10),sDe=Math.sqrt(2);function gA(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),c=r/Math.pow(10,a),f=c>=oDe?10:c>=aDe?5:c>=sDe?2:1;let i,v,b;return a<0?(b=Math.pow(10,-a)/f,i=Math.round(e*b),v=Math.round(t*b),i/b<e&&++i,v/b>t&&--v,b=-b):(b=Math.pow(10,a)*f,i=Math.round(e/b),v=Math.round(t/b),i*b<e&&++i,v*b>t&&--v),v<i&&.5<=n&&n<2?gA(e,t,n*2):[i,v,b]}function JD(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,c,f]=r?gA(t,e,n):gA(e,t,n);if(!(c>=a))return[];const i=c-a+1,v=new Array(i);if(r)if(f<0)for(let b=0;b<i;++b)v[b]=(c-b)/-f;else for(let b=0;b<i;++b)v[b]=(c-b)*f;else if(f<0)for(let b=0;b<i;++b)v[b]=(a+b)/-f;else for(let b=0;b<i;++b)v[b]=(a+b)*f;return v}function QD(e,t,n){return t=+t,e=+e,n=+n,gA(e,t,n)[2]}function eL(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?QD(t,e,n):QD(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function X6(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let a of e)(a=t(a,++r,e))!=null&&(n<a||n===void 0&&a>=a)&&(n=a)}return n}function K6(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function bJ(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?xJ:iDe(a);r>n;){if(r-n>600){const v=r-n+1,b=t-n+1,T=Math.log(v),A=.5*Math.exp(2*T/3),M=.5*Math.sqrt(T*A*(v-A)/v)*(b-v/2<0?-1:1),R=Math.max(n,Math.floor(t-b*A/v+M)),B=Math.min(r,Math.floor(t+(v-b)*A/v+M));bJ(e,t,R,B,a)}const c=e[t];let f=n,i=r;for(Jx(e,n,t),a(e[r],c)>0&&Jx(e,n,r);f<i;){for(Jx(e,f,i),++f,--i;a(e[f],c)<0;)++f;for(;a(e[i],c)>0;)--i}a(e[n],c)===0?Jx(e,n,i):(++i,Jx(e,i,r)),i<=t&&(n=i+1),t<=i&&(r=i-1)}return e}function Jx(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function lDe(e,t,n){if(e=Float64Array.from(QRe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return K6(e);if(t>=1)return X6(e);var r,a=(r-1)*t,c=Math.floor(a),f=X6(bJ(e,c).subarray(0,c+1)),i=K6(e.subarray(c+1));return f+(i-f)*(a-c)}}function cDe(e,t,n=vJ){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,c=Math.floor(a),f=+n(e[c],c,e),i=+n(e[c+1],c+1,e);return f+(i-f)*(a-c)}}function uDe(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,c=new Array(a);++r<a;)c[r]=e+r*n;return c}function Xl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Wh(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const tL=Symbol("implicit");function $N(){var e=new q6,t=[],n=[],r=tL;function a(c){let f=e.get(c);if(f===void 0){if(r!==tL)return r;e.set(c,f=t.push(c)-1)}return n[f%n.length]}return a.domain=function(c){if(!arguments.length)return t.slice();t=[],e=new q6;for(const f of c)e.has(f)||e.set(f,t.push(f)-1);return a},a.range=function(c){return arguments.length?(n=Array.from(c),a):n.slice()},a.unknown=function(c){return arguments.length?(r=c,a):r},a.copy=function(){return $N(t,n).unknown(r)},Xl.apply(a,arguments),a}function Nb(){var e=$N().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,c,f,i=!1,v=0,b=0,T=.5;delete e.unknown;function A(){var M=t().length,R=a<r,B=R?a:r,L=R?r:a;c=(L-B)/Math.max(1,M-v+b*2),i&&(c=Math.floor(c)),B+=(L-B-c*(M-v))*T,f=c*(1-v),i&&(B=Math.round(B),f=Math.round(f));var j=uDe(M).map(function(V){return B+c*V});return n(R?j.reverse():j)}return e.domain=function(M){return arguments.length?(t(M),A()):t()},e.range=function(M){return arguments.length?([r,a]=M,r=+r,a=+a,A()):[r,a]},e.rangeRound=function(M){return[r,a]=M,r=+r,a=+a,i=!0,A()},e.bandwidth=function(){return f},e.step=function(){return c},e.round=function(M){return arguments.length?(i=!!M,A()):i},e.padding=function(M){return arguments.length?(v=Math.min(1,b=+M),A()):v},e.paddingInner=function(M){return arguments.length?(v=Math.min(1,M),A()):v},e.paddingOuter=function(M){return arguments.length?(b=+M,A()):b},e.align=function(M){return arguments.length?(T=Math.max(0,Math.min(1,M)),A()):T},e.copy=function(){return Nb(t(),[r,a]).round(i).paddingInner(v).paddingOuter(b).align(T)},Xl.apply(A(),arguments)}function wJ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return wJ(t())},e}function N1(){return wJ(Nb.apply(null,arguments).paddingInner(1))}function UN(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function SJ(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function $w(){}var Fb=.7,yA=1/Fb,m_="\\s*([+-]?\\d+)\\s*",Bb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hDe=/^#([0-9a-f]{3,8})$/,dDe=new RegExp(`^rgb\\(${m_},${m_},${m_}\\)$`),fDe=new RegExp(`^rgb\\(${xu},${xu},${xu}\\)$`),pDe=new RegExp(`^rgba\\(${m_},${m_},${m_},${Bb}\\)$`),mDe=new RegExp(`^rgba\\(${xu},${xu},${xu},${Bb}\\)$`),gDe=new RegExp(`^hsl\\(${Bb},${xu},${xu}\\)$`),yDe=new RegExp(`^hsla\\(${Bb},${xu},${xu},${Bb}\\)$`),Y6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};UN($w,Nm,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:J6,formatHex:J6,formatHex8:_De,formatHsl:vDe,formatRgb:Q6,toString:Q6});function J6(){return this.rgb().formatHex()}function _De(){return this.rgb().formatHex8()}function vDe(){return TJ(this).formatHsl()}function Q6(){return this.rgb().formatRgb()}function Nm(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=hDe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?e8(t):n===3?new $s(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?PE(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?PE(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=dDe.exec(e))?new $s(t[1],t[2],t[3],1):(t=fDe.exec(e))?new $s(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=pDe.exec(e))?PE(t[1],t[2],t[3],t[4]):(t=mDe.exec(e))?PE(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=gDe.exec(e))?r8(t[1],t[2]/100,t[3]/100,1):(t=yDe.exec(e))?r8(t[1],t[2]/100,t[3]/100,t[4]):Y6.hasOwnProperty(e)?e8(Y6[e]):e==="transparent"?new $s(NaN,NaN,NaN,0):null}function e8(e){return new $s(e>>16&255,e>>8&255,e&255,1)}function PE(e,t,n,r){return r<=0&&(e=t=n=NaN),new $s(e,t,n,r)}function xDe(e){return e instanceof $w||(e=Nm(e)),e?(e=e.rgb(),new $s(e.r,e.g,e.b,e.opacity)):new $s}function nL(e,t,n,r){return arguments.length===1?xDe(e):new $s(e,t,n,r??1)}function $s(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}UN($s,nL,SJ($w,{brighter(e){return e=e==null?yA:Math.pow(yA,e),new $s(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Fb:Math.pow(Fb,e),new $s(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new $s(wm(this.r),wm(this.g),wm(this.b),_A(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:t8,formatHex:t8,formatHex8:bDe,formatRgb:n8,toString:n8}));function t8(){return`#${mm(this.r)}${mm(this.g)}${mm(this.b)}`}function bDe(){return`#${mm(this.r)}${mm(this.g)}${mm(this.b)}${mm((isNaN(this.opacity)?1:this.opacity)*255)}`}function n8(){const e=_A(this.opacity);return`${e===1?"rgb(":"rgba("}${wm(this.r)}, ${wm(this.g)}, ${wm(this.b)}${e===1?")":`, ${e})`}`}function _A(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function wm(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function mm(e){return e=wm(e),(e<16?"0":"")+e.toString(16)}function r8(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ac(e,t,n,r)}function TJ(e){if(e instanceof Ac)return new Ac(e.h,e.s,e.l,e.opacity);if(e instanceof $w||(e=Nm(e)),!e)return new Ac;if(e instanceof Ac)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),c=Math.max(t,n,r),f=NaN,i=c-a,v=(c+a)/2;return i?(t===c?f=(n-r)/i+(n<r)*6:n===c?f=(r-t)/i+2:f=(t-n)/i+4,i/=v<.5?c+a:2-c-a,f*=60):i=v>0&&v<1?0:f,new Ac(f,i,v,e.opacity)}function wDe(e,t,n,r){return arguments.length===1?TJ(e):new Ac(e,t,n,r??1)}function Ac(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}UN(Ac,wDe,SJ($w,{brighter(e){return e=e==null?yA:Math.pow(yA,e),new Ac(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Fb:Math.pow(Fb,e),new Ac(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new $s(Ck(e>=240?e-240:e+120,a,r),Ck(e,a,r),Ck(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new Ac(i8(this.h),CE(this.s),CE(this.l),_A(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=_A(this.opacity);return`${e===1?"hsl(":"hsla("}${i8(this.h)}, ${CE(this.s)*100}%, ${CE(this.l)*100}%${e===1?")":`, ${e})`}`}}));function i8(e){return e=(e||0)%360,e<0?e+360:e}function CE(e){return Math.max(0,Math.min(1,e||0))}function Ck(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const VN=e=>()=>e;function SDe(e,t){return function(n){return e+n*t}}function TDe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function EDe(e){return(e=+e)==1?EJ:function(t,n){return n-t?TDe(t,n,e):VN(isNaN(t)?n:t)}}function EJ(e,t){var n=t-e;return n?SDe(e,n):VN(isNaN(e)?t:e)}const vA=function e(t){var n=EDe(t);function r(a,c){var f=n((a=nL(a)).r,(c=nL(c)).r),i=n(a.g,c.g),v=n(a.b,c.b),b=EJ(a.opacity,c.opacity);return function(T){return a.r=f(T),a.g=i(T),a.b=v(T),a.opacity=b(T),a+""}}return r.gamma=e,r}(1);function ADe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(c){for(a=0;a<n;++a)r[a]=e[a]*(1-c)+t[a]*c;return r}}function PDe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function CDe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),c=new Array(n),f;for(f=0;f<r;++f)a[f]=zv(e[f],t[f]);for(;f<n;++f)c[f]=t[f];return function(i){for(f=0;f<r;++f)c[f]=a[f](i);return c}}function IDe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Tc(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function MDe(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=zv(e[a],t[a]):r[a]=t[a];return function(c){for(a in n)r[a]=n[a](c);return r}}var rL=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ik=new RegExp(rL.source,"g");function ODe(e){return function(){return e}}function kDe(e){return function(t){return e(t)+""}}function AJ(e,t){var n=rL.lastIndex=Ik.lastIndex=0,r,a,c,f=-1,i=[],v=[];for(e=e+"",t=t+"";(r=rL.exec(e))&&(a=Ik.exec(t));)(c=a.index)>n&&(c=t.slice(n,c),i[f]?i[f]+=c:i[++f]=c),(r=r[0])===(a=a[0])?i[f]?i[f]+=a:i[++f]=a:(i[++f]=null,v.push({i:f,x:Tc(r,a)})),n=Ik.lastIndex;return n<t.length&&(c=t.slice(n),i[f]?i[f]+=c:i[++f]=c),i.length<2?v[0]?kDe(v[0].x):ODe(t):(t=v.length,function(b){for(var T=0,A;T<t;++T)i[(A=v[T]).i]=A.x(b);return i.join("")})}function zv(e,t){var n=typeof t,r;return t==null||n==="boolean"?VN(t):(n==="number"?Tc:n==="string"?(r=Nm(t))?(t=r,vA):AJ:t instanceof Nm?vA:t instanceof Date?IDe:PDe(t)?ADe:Array.isArray(t)?CDe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?MDe:Tc)(e,t)}function GN(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var o8=180/Math.PI,iL={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function PJ(e,t,n,r,a,c){var f,i,v;return(f=Math.sqrt(e*e+t*t))&&(e/=f,t/=f),(v=e*n+t*r)&&(n-=e*v,r-=t*v),(i=Math.sqrt(n*n+r*r))&&(n/=i,r/=i,v/=i),e*r<t*n&&(e=-e,t=-t,v=-v,f=-f),{translateX:a,translateY:c,rotate:Math.atan2(t,e)*o8,skewX:Math.atan(v)*o8,scaleX:f,scaleY:i}}var IE;function RDe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?iL:PJ(t.a,t.b,t.c,t.d,t.e,t.f)}function DDe(e){return e==null||(IE||(IE=document.createElementNS("http://www.w3.org/2000/svg","g")),IE.setAttribute("transform",e),!(e=IE.transform.baseVal.consolidate()))?iL:(e=e.matrix,PJ(e.a,e.b,e.c,e.d,e.e,e.f))}function CJ(e,t,n,r){function a(b){return b.length?b.pop()+" ":""}function c(b,T,A,M,R,B){if(b!==A||T!==M){var L=R.push("translate(",null,t,null,n);B.push({i:L-4,x:Tc(b,A)},{i:L-2,x:Tc(T,M)})}else(A||M)&&R.push("translate("+A+t+M+n)}function f(b,T,A,M){b!==T?(b-T>180?T+=360:T-b>180&&(b+=360),M.push({i:A.push(a(A)+"rotate(",null,r)-2,x:Tc(b,T)})):T&&A.push(a(A)+"rotate("+T+r)}function i(b,T,A,M){b!==T?M.push({i:A.push(a(A)+"skewX(",null,r)-2,x:Tc(b,T)}):T&&A.push(a(A)+"skewX("+T+r)}function v(b,T,A,M,R,B){if(b!==A||T!==M){var L=R.push(a(R)+"scale(",null,",",null,")");B.push({i:L-4,x:Tc(b,A)},{i:L-2,x:Tc(T,M)})}else(A!==1||M!==1)&&R.push(a(R)+"scale("+A+","+M+")")}return function(b,T){var A=[],M=[];return b=e(b),T=e(T),c(b.translateX,b.translateY,T.translateX,T.translateY,A,M),f(b.rotate,T.rotate,A,M),i(b.skewX,T.skewX,A,M),v(b.scaleX,b.scaleY,T.scaleX,T.scaleY,A,M),b=T=null,function(R){for(var B=-1,L=M.length,j;++B<L;)A[(j=M[B]).i]=j.x(R);return A.join("")}}}var LDe=CJ(RDe,"px, ","px)","deg)"),zDe=CJ(DDe,", ",")",")");function NDe(e,t){t===void 0&&(t=e,e=zv);for(var n=0,r=t.length-1,a=t[0],c=new Array(r<0?0:r);n<r;)c[n]=e(a,a=t[++n]);return function(f){var i=Math.max(0,Math.min(r-1,Math.floor(f*=r)));return c[i](f-i)}}function FDe(e){return function(){return e}}function xA(e){return+e}var a8=[0,1];function ps(e){return e}function oL(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:FDe(isNaN(t)?NaN:.5)}function BDe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function jDe(e,t,n){var r=e[0],a=e[1],c=t[0],f=t[1];return a<r?(r=oL(a,r),c=n(f,c)):(r=oL(r,a),c=n(c,f)),function(i){return c(r(i))}}function $De(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),c=new Array(r),f=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++f<r;)a[f]=oL(e[f],e[f+1]),c[f]=n(t[f],t[f+1]);return function(i){var v=jw(e,i,1,r)-1;return c[v](a[v](i))}}function Uw(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function IC(){var e=a8,t=a8,n=zv,r,a,c,f=ps,i,v,b;function T(){var M=Math.min(e.length,t.length);return f!==ps&&(f=BDe(e[0],e[M-1])),i=M>2?$De:jDe,v=b=null,A}function A(M){return M==null||isNaN(M=+M)?c:(v||(v=i(e.map(r),t,n)))(r(f(M)))}return A.invert=function(M){return f(a((b||(b=i(t,e.map(r),Tc)))(M)))},A.domain=function(M){return arguments.length?(e=Array.from(M,xA),T()):e.slice()},A.range=function(M){return arguments.length?(t=Array.from(M),T()):t.slice()},A.rangeRound=function(M){return t=Array.from(M),n=GN,T()},A.clamp=function(M){return arguments.length?(f=M?!0:ps,T()):f!==ps},A.interpolate=function(M){return arguments.length?(n=M,T()):n},A.unknown=function(M){return arguments.length?(c=M,A):c},function(M,R){return r=M,a=R,T()}}function WN(){return IC()(ps,ps)}function UDe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function bA(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function j_(e){return e=bA(Math.abs(e)),e?e[1]:NaN}function VDe(e,t){return function(n,r){for(var a=n.length,c=[],f=0,i=e[0],v=0;a>0&&i>0&&(v+i+1>r&&(i=Math.max(1,r-v)),c.push(n.substring(a-=i,a+i)),!((v+=i+1)>r));)i=e[f=(f+1)%e.length];return c.reverse().join(t)}}function GDe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var WDe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jb(e){if(!(t=WDe.exec(e)))throw new Error("invalid format: "+e);var t;return new HN({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}jb.prototype=HN.prototype;function HN(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}HN.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function HDe(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var IJ;function qDe(e,t){var n=bA(e,t);if(!n)return e+"";var r=n[0],a=n[1],c=a-(IJ=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,f=r.length;return c===f?r:c>f?r+new Array(c-f+1).join("0"):c>0?r.slice(0,c)+"."+r.slice(c):"0."+new Array(1-c).join("0")+bA(e,Math.max(0,t+c-1))[0]}function s8(e,t){var n=bA(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const l8={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:UDe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>s8(e*100,t),r:s8,s:qDe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c8(e){return e}var u8=Array.prototype.map,h8=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ZDe(e){var t=e.grouping===void 0||e.thousands===void 0?c8:VDe(u8.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",c=e.numerals===void 0?c8:GDe(u8.call(e.numerals,String)),f=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"−":e.minus+"",v=e.nan===void 0?"NaN":e.nan+"";function b(A){A=jb(A);var M=A.fill,R=A.align,B=A.sign,L=A.symbol,j=A.zero,V=A.width,$=A.comma,H=A.precision,K=A.trim,Y=A.type;Y==="n"?($=!0,Y="g"):l8[Y]||(H===void 0&&(H=12),K=!0,Y="g"),(j||M==="0"&&R==="=")&&(j=!0,M="0",R="=");var se=L==="$"?n:L==="#"&&/[boxX]/.test(Y)?"0"+Y.toLowerCase():"",ce=L==="$"?r:/[%p]/.test(Y)?f:"",ye=l8[Y],ze=/[defgprs%]/.test(Y);H=H===void 0?6:/[gprs]/.test(Y)?Math.max(1,Math.min(21,H)):Math.max(0,Math.min(20,H));function Le(je){var Re=se,$e=ce,Ge,ht,ot;if(Y==="c")$e=ye(je)+$e,je="";else{je=+je;var Je=je<0||1/je<0;if(je=isNaN(je)?v:ye(Math.abs(je),H),K&&(je=HDe(je)),Je&&+je==0&&B!=="+"&&(Je=!1),Re=(Je?B==="("?B:i:B==="-"||B==="("?"":B)+Re,$e=(Y==="s"?h8[8+IJ/3]:"")+$e+(Je&&B==="("?")":""),ze){for(Ge=-1,ht=je.length;++Ge<ht;)if(ot=je.charCodeAt(Ge),48>ot||ot>57){$e=(ot===46?a+je.slice(Ge+1):je.slice(Ge))+$e,je=je.slice(0,Ge);break}}}$&&!j&&(je=t(je,1/0));var Ne=Re.length+je.length+$e.length,Xe=Ne<V?new Array(V-Ne+1).join(M):"";switch($&&j&&(je=t(Xe+je,Xe.length?V-$e.length:1/0),Xe=""),R){case"<":je=Re+je+$e+Xe;break;case"=":je=Re+Xe+je+$e;break;case"^":je=Xe.slice(0,Ne=Xe.length>>1)+Re+je+$e+Xe.slice(Ne);break;default:je=Xe+Re+je+$e;break}return c(je)}return Le.toString=function(){return A+""},Le}function T(A,M){var R=b((A=jb(A),A.type="f",A)),B=Math.max(-8,Math.min(8,Math.floor(j_(M)/3)))*3,L=Math.pow(10,-B),j=h8[8+B/3];return function(V){return R(L*V)+j}}return{format:b,formatPrefix:T}}var ME,qN,MJ;XDe({thousands:",",grouping:[3],currency:["$",""]});function XDe(e){return ME=ZDe(e),qN=ME.format,MJ=ME.formatPrefix,ME}function KDe(e){return Math.max(0,-j_(Math.abs(e)))}function YDe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(j_(t)/3)))*3-j_(Math.abs(e)))}function JDe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,j_(t)-j_(e))+1}function OJ(e,t,n,r){var a=eL(e,t,n),c;switch(r=jb(r??",f"),r.type){case"s":{var f=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(c=YDe(a,f))&&(r.precision=c),MJ(r,f)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(c=JDe(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=c-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(c=KDe(a))&&(r.precision=c-(r.type==="%")*2);break}}return qN(r)}function Xf(e){var t=e.domain;return e.ticks=function(n){var r=t();return JD(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return OJ(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,c=r.length-1,f=r[a],i=r[c],v,b,T=10;for(i<f&&(b=f,f=i,i=b,b=a,a=c,c=b);T-- >0;){if(b=QD(f,i,n),b===v)return r[a]=f,r[c]=i,t(r);if(b>0)f=Math.floor(f/b)*b,i=Math.ceil(i/b)*b;else if(b<0)f=Math.ceil(f*b)/b,i=Math.floor(i*b)/b;else break;v=b}return e},e}function wA(){var e=WN();return e.copy=function(){return Uw(e,wA())},Xl.apply(e,arguments),Xf(e)}function kJ(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,xA),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return kJ(e).unknown(t)},e=arguments.length?Array.from(e,xA):[0,1],Xf(n)}function RJ(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],c=e[r],f;return c<a&&(f=n,n=r,r=f,f=a,a=c,c=f),e[n]=t.floor(a),e[r]=t.ceil(c),e}function d8(e){return Math.log(e)}function f8(e){return Math.exp(e)}function QDe(e){return-Math.log(-e)}function eLe(e){return-Math.exp(-e)}function tLe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function nLe(e){return e===10?tLe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function rLe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function p8(e){return(t,n)=>-e(-t,n)}function ZN(e){const t=e(d8,f8),n=t.domain;let r=10,a,c;function f(){return a=rLe(r),c=nLe(r),n()[0]<0?(a=p8(a),c=p8(c),e(QDe,eLe)):e(d8,f8),t}return t.base=function(i){return arguments.length?(r=+i,f()):r},t.domain=function(i){return arguments.length?(n(i),f()):n()},t.ticks=i=>{const v=n();let b=v[0],T=v[v.length-1];const A=T<b;A&&([b,T]=[T,b]);let M=a(b),R=a(T),B,L;const j=i==null?10:+i;let V=[];if(!(r%1)&&R-M<j){if(M=Math.floor(M),R=Math.ceil(R),b>0){for(;M<=R;++M)for(B=1;B<r;++B)if(L=M<0?B/c(-M):B*c(M),!(L<b)){if(L>T)break;V.push(L)}}else for(;M<=R;++M)for(B=r-1;B>=1;--B)if(L=M>0?B/c(-M):B*c(M),!(L<b)){if(L>T)break;V.push(L)}V.length*2<j&&(V=JD(b,T,j))}else V=JD(M,R,Math.min(R-M,j)).map(c);return A?V.reverse():V},t.tickFormat=(i,v)=>{if(i==null&&(i=10),v==null&&(v=r===10?"s":","),typeof v!="function"&&(!(r%1)&&(v=jb(v)).precision==null&&(v.trim=!0),v=qN(v)),i===1/0)return v;const b=Math.max(1,r*i/t.ticks().length);return T=>{let A=T/c(Math.round(a(T)));return A*r<r-.5&&(A*=r),A<=b?v(T):""}},t.nice=()=>n(RJ(n(),{floor:i=>c(Math.floor(a(i))),ceil:i=>c(Math.ceil(a(i)))})),t}function DJ(){const e=ZN(IC()).domain([1,10]);return e.copy=()=>Uw(e,DJ()).base(e.base()),Xl.apply(e,arguments),e}function m8(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function g8(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function XN(e){var t=1,n=e(m8(t),g8(t));return n.constant=function(r){return arguments.length?e(m8(t=+r),g8(t)):t},Xf(n)}function LJ(){var e=XN(IC());return e.copy=function(){return Uw(e,LJ()).constant(e.constant())},Xl.apply(e,arguments)}function y8(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function iLe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function oLe(e){return e<0?-e*e:e*e}function KN(e){var t=e(ps,ps),n=1;function r(){return n===1?e(ps,ps):n===.5?e(iLe,oLe):e(y8(n),y8(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},Xf(t)}function YN(){var e=KN(IC());return e.copy=function(){return Uw(e,YN()).exponent(e.exponent())},Xl.apply(e,arguments),e}function aLe(){return YN.apply(null,arguments).exponent(.5)}function _8(e){return Math.sign(e)*e*e}function sLe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function zJ(){var e=WN(),t=[0,1],n=!1,r;function a(c){var f=sLe(e(c));return isNaN(f)?r:n?Math.round(f):f}return a.invert=function(c){return e.invert(_8(c))},a.domain=function(c){return arguments.length?(e.domain(c),a):e.domain()},a.range=function(c){return arguments.length?(e.range((t=Array.from(c,xA)).map(_8)),a):t.slice()},a.rangeRound=function(c){return a.range(c).round(!0)},a.round=function(c){return arguments.length?(n=!!c,a):n},a.clamp=function(c){return arguments.length?(e.clamp(c),a):e.clamp()},a.unknown=function(c){return arguments.length?(r=c,a):r},a.copy=function(){return zJ(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},Xl.apply(a,arguments),Xf(a)}function NJ(){var e=[],t=[],n=[],r;function a(){var f=0,i=Math.max(1,t.length);for(n=new Array(i-1);++f<i;)n[f-1]=cDe(e,f/i);return c}function c(f){return f==null||isNaN(f=+f)?r:t[jw(n,f)]}return c.invertExtent=function(f){var i=t.indexOf(f);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]},c.domain=function(f){if(!arguments.length)return e.slice();e=[];for(let i of f)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Sf),a()},c.range=function(f){return arguments.length?(t=Array.from(f),a()):t.slice()},c.unknown=function(f){return arguments.length?(r=f,c):r},c.quantiles=function(){return n.slice()},c.copy=function(){return NJ().domain(e).range(t).unknown(r)},Xl.apply(c,arguments)}function FJ(){var e=0,t=1,n=1,r=[.5],a=[0,1],c;function f(v){return v!=null&&v<=v?a[jw(r,v,0,n)]:c}function i(){var v=-1;for(r=new Array(n);++v<n;)r[v]=((v+1)*t-(v-n)*e)/(n+1);return f}return f.domain=function(v){return arguments.length?([e,t]=v,e=+e,t=+t,i()):[e,t]},f.range=function(v){return arguments.length?(n=(a=Array.from(v)).length-1,i()):a.slice()},f.invertExtent=function(v){var b=a.indexOf(v);return b<0?[NaN,NaN]:b<1?[e,r[0]]:b>=n?[r[n-1],t]:[r[b-1],r[b]]},f.unknown=function(v){return arguments.length&&(c=v),f},f.thresholds=function(){return r.slice()},f.copy=function(){return FJ().domain([e,t]).range(a).unknown(c)},Xl.apply(Xf(f),arguments)}function BJ(){var e=[.5],t=[0,1],n,r=1;function a(c){return c!=null&&c<=c?t[jw(e,c,0,r)]:n}return a.domain=function(c){return arguments.length?(e=Array.from(c),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(c){return arguments.length?(t=Array.from(c),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(c){var f=t.indexOf(c);return[e[f-1],e[f]]},a.unknown=function(c){return arguments.length?(n=c,a):n},a.copy=function(){return BJ().domain(e).range(t).unknown(n)},Xl.apply(a,arguments)}const Mk=new Date,Ok=new Date;function sa(e,t,n,r){function a(c){return e(c=arguments.length===0?new Date:new Date(+c)),c}return a.floor=c=>(e(c=new Date(+c)),c),a.ceil=c=>(e(c=new Date(c-1)),t(c,1),e(c),c),a.round=c=>{const f=a(c),i=a.ceil(c);return c-f<i-c?f:i},a.offset=(c,f)=>(t(c=new Date(+c),f==null?1:Math.floor(f)),c),a.range=(c,f,i)=>{const v=[];if(c=a.ceil(c),i=i==null?1:Math.floor(i),!(c<f)||!(i>0))return v;let b;do v.push(b=new Date(+c)),t(c,i),e(c);while(b<c&&c<f);return v},a.filter=c=>sa(f=>{if(f>=f)for(;e(f),!c(f);)f.setTime(f-1)},(f,i)=>{if(f>=f)if(i<0)for(;++i<=0;)for(;t(f,-1),!c(f););else for(;--i>=0;)for(;t(f,1),!c(f););}),n&&(a.count=(c,f)=>(Mk.setTime(+c),Ok.setTime(+f),e(Mk),e(Ok),Math.floor(n(Mk,Ok))),a.every=c=>(c=Math.floor(c),!isFinite(c)||!(c>0)?null:c>1?a.filter(r?f=>r(f)%c===0:f=>a.count(0,f)%c===0):a)),a}const SA=sa(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);SA.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?sa(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):SA);SA.range;const Th=1e3,Bl=Th*60,Eh=Bl*60,Nh=Eh*24,JN=Nh*7,v8=Nh*30,kk=Nh*365,gm=sa(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Th)},(e,t)=>(t-e)/Th,e=>e.getUTCSeconds());gm.range;const QN=sa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Th)},(e,t)=>{e.setTime(+e+t*Bl)},(e,t)=>(t-e)/Bl,e=>e.getMinutes());QN.range;const eF=sa(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Bl)},(e,t)=>(t-e)/Bl,e=>e.getUTCMinutes());eF.range;const tF=sa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Th-e.getMinutes()*Bl)},(e,t)=>{e.setTime(+e+t*Eh)},(e,t)=>(t-e)/Eh,e=>e.getHours());tF.range;const nF=sa(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Eh)},(e,t)=>(t-e)/Eh,e=>e.getUTCHours());nF.range;const Vw=sa(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Bl)/Nh,e=>e.getDate()-1);Vw.range;const MC=sa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Nh,e=>e.getUTCDate()-1);MC.range;const jJ=sa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Nh,e=>Math.floor(e/Nh));jJ.range;function tg(e){return sa(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Bl)/JN)}const OC=tg(0),TA=tg(1),lLe=tg(2),cLe=tg(3),$_=tg(4),uLe=tg(5),hLe=tg(6);OC.range;TA.range;lLe.range;cLe.range;$_.range;uLe.range;hLe.range;function ng(e){return sa(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/JN)}const kC=ng(0),EA=ng(1),dLe=ng(2),fLe=ng(3),U_=ng(4),pLe=ng(5),mLe=ng(6);kC.range;EA.range;dLe.range;fLe.range;U_.range;pLe.range;mLe.range;const rF=sa(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());rF.range;const iF=sa(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());iF.range;const Fh=sa(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Fh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:sa(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Fh.range;const Bh=sa(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Bh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:sa(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Bh.range;function $J(e,t,n,r,a,c){const f=[[gm,1,Th],[gm,5,5*Th],[gm,15,15*Th],[gm,30,30*Th],[c,1,Bl],[c,5,5*Bl],[c,15,15*Bl],[c,30,30*Bl],[a,1,Eh],[a,3,3*Eh],[a,6,6*Eh],[a,12,12*Eh],[r,1,Nh],[r,2,2*Nh],[n,1,JN],[t,1,v8],[t,3,3*v8],[e,1,kk]];function i(b,T,A){const M=T<b;M&&([b,T]=[T,b]);const R=A&&typeof A.range=="function"?A:v(b,T,A),B=R?R.range(b,+T+1):[];return M?B.reverse():B}function v(b,T,A){const M=Math.abs(T-b)/A,R=jN(([,,j])=>j).right(f,M);if(R===f.length)return e.every(eL(b/kk,T/kk,A));if(R===0)return SA.every(Math.max(eL(b,T,A),1));const[B,L]=f[M/f[R-1][2]<f[R][2]/M?R-1:R];return B.every(L)}return[i,v]}const[gLe,yLe]=$J(Bh,iF,kC,jJ,nF,eF),[_Le,vLe]=$J(Fh,rF,OC,Vw,tF,QN);function Rk(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Dk(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Qx(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function xLe(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,c=e.days,f=e.shortDays,i=e.months,v=e.shortMonths,b=e1(a),T=t1(a),A=e1(c),M=t1(c),R=e1(f),B=t1(f),L=e1(i),j=t1(i),V=e1(v),$=t1(v),H={a:Je,A:Ne,b:Xe,B:pt,c:null,d:E8,e:E8,f:VLe,g:QLe,G:tze,H:jLe,I:$Le,j:ULe,L:UJ,m:GLe,M:WLe,p:zt,q:Ft,Q:C8,s:I8,S:HLe,u:qLe,U:ZLe,V:XLe,w:KLe,W:YLe,x:null,X:null,y:JLe,Y:eze,Z:nze,"%":P8},K={a:un,A:Tn,b:fn,B:Cn,c:null,d:A8,e:A8,f:aze,g:gze,G:_ze,H:rze,I:ize,j:oze,L:GJ,m:sze,M:lze,p:Vt,q:lr,Q:C8,s:I8,S:cze,u:uze,U:hze,V:dze,w:fze,W:pze,x:null,X:null,y:mze,Y:yze,Z:vze,"%":P8},Y={a:Le,A:je,b:Re,B:$e,c:Ge,d:S8,e:S8,f:zLe,g:w8,G:b8,H:T8,I:T8,j:kLe,L:LLe,m:OLe,M:RLe,p:ze,q:MLe,Q:FLe,s:BLe,S:DLe,u:ELe,U:ALe,V:PLe,w:TLe,W:CLe,x:ht,X:ot,y:w8,Y:b8,Z:ILe,"%":NLe};H.x=se(n,H),H.X=se(r,H),H.c=se(t,H),K.x=se(n,K),K.X=se(r,K),K.c=se(t,K);function se(Nt,gn){return function(xn){var kt=[],zn=-1,fr=0,hi=Nt.length,br,Pi,Ye;for(xn instanceof Date||(xn=new Date(+xn));++zn<hi;)Nt.charCodeAt(zn)===37&&(kt.push(Nt.slice(fr,zn)),(Pi=x8[br=Nt.charAt(++zn)])!=null?br=Nt.charAt(++zn):Pi=br==="e"?" ":"0",(Ye=gn[br])&&(br=Ye(xn,Pi)),kt.push(br),fr=zn+1);return kt.push(Nt.slice(fr,zn)),kt.join("")}}function ce(Nt,gn){return function(xn){var kt=Qx(1900,void 0,1),zn=ye(kt,Nt,xn+="",0),fr,hi;if(zn!=xn.length)return null;if("Q"in kt)return new Date(kt.Q);if("s"in kt)return new Date(kt.s*1e3+("L"in kt?kt.L:0));if(gn&&!("Z"in kt)&&(kt.Z=0),"p"in kt&&(kt.H=kt.H%12+kt.p*12),kt.m===void 0&&(kt.m="q"in kt?kt.q:0),"V"in kt){if(kt.V<1||kt.V>53)return null;"w"in kt||(kt.w=1),"Z"in kt?(fr=Dk(Qx(kt.y,0,1)),hi=fr.getUTCDay(),fr=hi>4||hi===0?EA.ceil(fr):EA(fr),fr=MC.offset(fr,(kt.V-1)*7),kt.y=fr.getUTCFullYear(),kt.m=fr.getUTCMonth(),kt.d=fr.getUTCDate()+(kt.w+6)%7):(fr=Rk(Qx(kt.y,0,1)),hi=fr.getDay(),fr=hi>4||hi===0?TA.ceil(fr):TA(fr),fr=Vw.offset(fr,(kt.V-1)*7),kt.y=fr.getFullYear(),kt.m=fr.getMonth(),kt.d=fr.getDate()+(kt.w+6)%7)}else("W"in kt||"U"in kt)&&("w"in kt||(kt.w="u"in kt?kt.u%7:"W"in kt?1:0),hi="Z"in kt?Dk(Qx(kt.y,0,1)).getUTCDay():Rk(Qx(kt.y,0,1)).getDay(),kt.m=0,kt.d="W"in kt?(kt.w+6)%7+kt.W*7-(hi+5)%7:kt.w+kt.U*7-(hi+6)%7);return"Z"in kt?(kt.H+=kt.Z/100|0,kt.M+=kt.Z%100,Dk(kt)):Rk(kt)}}function ye(Nt,gn,xn,kt){for(var zn=0,fr=gn.length,hi=xn.length,br,Pi;zn<fr;){if(kt>=hi)return-1;if(br=gn.charCodeAt(zn++),br===37){if(br=gn.charAt(zn++),Pi=Y[br in x8?gn.charAt(zn++):br],!Pi||(kt=Pi(Nt,xn,kt))<0)return-1}else if(br!=xn.charCodeAt(kt++))return-1}return kt}function ze(Nt,gn,xn){var kt=b.exec(gn.slice(xn));return kt?(Nt.p=T.get(kt[0].toLowerCase()),xn+kt[0].length):-1}function Le(Nt,gn,xn){var kt=R.exec(gn.slice(xn));return kt?(Nt.w=B.get(kt[0].toLowerCase()),xn+kt[0].length):-1}function je(Nt,gn,xn){var kt=A.exec(gn.slice(xn));return kt?(Nt.w=M.get(kt[0].toLowerCase()),xn+kt[0].length):-1}function Re(Nt,gn,xn){var kt=V.exec(gn.slice(xn));return kt?(Nt.m=$.get(kt[0].toLowerCase()),xn+kt[0].length):-1}function $e(Nt,gn,xn){var kt=L.exec(gn.slice(xn));return kt?(Nt.m=j.get(kt[0].toLowerCase()),xn+kt[0].length):-1}function Ge(Nt,gn,xn){return ye(Nt,t,gn,xn)}function ht(Nt,gn,xn){return ye(Nt,n,gn,xn)}function ot(Nt,gn,xn){return ye(Nt,r,gn,xn)}function Je(Nt){return f[Nt.getDay()]}function Ne(Nt){return c[Nt.getDay()]}function Xe(Nt){return v[Nt.getMonth()]}function pt(Nt){return i[Nt.getMonth()]}function zt(Nt){return a[+(Nt.getHours()>=12)]}function Ft(Nt){return 1+~~(Nt.getMonth()/3)}function un(Nt){return f[Nt.getUTCDay()]}function Tn(Nt){return c[Nt.getUTCDay()]}function fn(Nt){return v[Nt.getUTCMonth()]}function Cn(Nt){return i[Nt.getUTCMonth()]}function Vt(Nt){return a[+(Nt.getUTCHours()>=12)]}function lr(Nt){return 1+~~(Nt.getUTCMonth()/3)}return{format:function(Nt){var gn=se(Nt+="",H);return gn.toString=function(){return Nt},gn},parse:function(Nt){var gn=ce(Nt+="",!1);return gn.toString=function(){return Nt},gn},utcFormat:function(Nt){var gn=se(Nt+="",K);return gn.toString=function(){return Nt},gn},utcParse:function(Nt){var gn=ce(Nt+="",!0);return gn.toString=function(){return Nt},gn}}}var x8={"-":"",_:" ",0:"0"},Sa=/^\s*\d+/,bLe=/^%/,wLe=/[\\^$*+?|[\]().{}]/g;function Ni(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",c=a.length;return r+(c<n?new Array(n-c+1).join(t)+a:a)}function SLe(e){return e.replace(wLe,"\\$&")}function e1(e){return new RegExp("^(?:"+e.map(SLe).join("|")+")","i")}function t1(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function TLe(e,t,n){var r=Sa.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function ELe(e,t,n){var r=Sa.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ALe(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function PLe(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function CLe(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function b8(e,t,n){var r=Sa.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function w8(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ILe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function MLe(e,t,n){var r=Sa.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function OLe(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function S8(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function kLe(e,t,n){var r=Sa.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function T8(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function RLe(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function DLe(e,t,n){var r=Sa.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function LLe(e,t,n){var r=Sa.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function zLe(e,t,n){var r=Sa.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function NLe(e,t,n){var r=bLe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function FLe(e,t,n){var r=Sa.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function BLe(e,t,n){var r=Sa.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function E8(e,t){return Ni(e.getDate(),t,2)}function jLe(e,t){return Ni(e.getHours(),t,2)}function $Le(e,t){return Ni(e.getHours()%12||12,t,2)}function ULe(e,t){return Ni(1+Vw.count(Fh(e),e),t,3)}function UJ(e,t){return Ni(e.getMilliseconds(),t,3)}function VLe(e,t){return UJ(e,t)+"000"}function GLe(e,t){return Ni(e.getMonth()+1,t,2)}function WLe(e,t){return Ni(e.getMinutes(),t,2)}function HLe(e,t){return Ni(e.getSeconds(),t,2)}function qLe(e){var t=e.getDay();return t===0?7:t}function ZLe(e,t){return Ni(OC.count(Fh(e)-1,e),t,2)}function VJ(e){var t=e.getDay();return t>=4||t===0?$_(e):$_.ceil(e)}function XLe(e,t){return e=VJ(e),Ni($_.count(Fh(e),e)+(Fh(e).getDay()===4),t,2)}function KLe(e){return e.getDay()}function YLe(e,t){return Ni(TA.count(Fh(e)-1,e),t,2)}function JLe(e,t){return Ni(e.getFullYear()%100,t,2)}function QLe(e,t){return e=VJ(e),Ni(e.getFullYear()%100,t,2)}function eze(e,t){return Ni(e.getFullYear()%1e4,t,4)}function tze(e,t){var n=e.getDay();return e=n>=4||n===0?$_(e):$_.ceil(e),Ni(e.getFullYear()%1e4,t,4)}function nze(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ni(t/60|0,"0",2)+Ni(t%60,"0",2)}function A8(e,t){return Ni(e.getUTCDate(),t,2)}function rze(e,t){return Ni(e.getUTCHours(),t,2)}function ize(e,t){return Ni(e.getUTCHours()%12||12,t,2)}function oze(e,t){return Ni(1+MC.count(Bh(e),e),t,3)}function GJ(e,t){return Ni(e.getUTCMilliseconds(),t,3)}function aze(e,t){return GJ(e,t)+"000"}function sze(e,t){return Ni(e.getUTCMonth()+1,t,2)}function lze(e,t){return Ni(e.getUTCMinutes(),t,2)}function cze(e,t){return Ni(e.getUTCSeconds(),t,2)}function uze(e){var t=e.getUTCDay();return t===0?7:t}function hze(e,t){return Ni(kC.count(Bh(e)-1,e),t,2)}function WJ(e){var t=e.getUTCDay();return t>=4||t===0?U_(e):U_.ceil(e)}function dze(e,t){return e=WJ(e),Ni(U_.count(Bh(e),e)+(Bh(e).getUTCDay()===4),t,2)}function fze(e){return e.getUTCDay()}function pze(e,t){return Ni(EA.count(Bh(e)-1,e),t,2)}function mze(e,t){return Ni(e.getUTCFullYear()%100,t,2)}function gze(e,t){return e=WJ(e),Ni(e.getUTCFullYear()%100,t,2)}function yze(e,t){return Ni(e.getUTCFullYear()%1e4,t,4)}function _ze(e,t){var n=e.getUTCDay();return e=n>=4||n===0?U_(e):U_.ceil(e),Ni(e.getUTCFullYear()%1e4,t,4)}function vze(){return"+0000"}function P8(){return"%"}function C8(e){return+e}function I8(e){return Math.floor(+e/1e3)}var Dy,HJ,qJ;xze({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function xze(e){return Dy=xLe(e),HJ=Dy.format,Dy.parse,qJ=Dy.utcFormat,Dy.utcParse,Dy}function bze(e){return new Date(e)}function wze(e){return e instanceof Date?+e:+new Date(+e)}function oF(e,t,n,r,a,c,f,i,v,b){var T=WN(),A=T.invert,M=T.domain,R=b(".%L"),B=b(":%S"),L=b("%I:%M"),j=b("%I %p"),V=b("%a %d"),$=b("%b %d"),H=b("%B"),K=b("%Y");function Y(se){return(v(se)<se?R:i(se)<se?B:f(se)<se?L:c(se)<se?j:r(se)<se?a(se)<se?V:$:n(se)<se?H:K)(se)}return T.invert=function(se){return new Date(A(se))},T.domain=function(se){return arguments.length?M(Array.from(se,wze)):M().map(bze)},T.ticks=function(se){var ce=M();return e(ce[0],ce[ce.length-1],se??10)},T.tickFormat=function(se,ce){return ce==null?Y:b(ce)},T.nice=function(se){var ce=M();return(!se||typeof se.range!="function")&&(se=t(ce[0],ce[ce.length-1],se??10)),se?M(RJ(ce,se)):T},T.copy=function(){return Uw(T,oF(e,t,n,r,a,c,f,i,v,b))},T}function Sze(){return Xl.apply(oF(_Le,vLe,Fh,rF,OC,Vw,tF,QN,gm,HJ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Tze(){return Xl.apply(oF(gLe,yLe,Bh,iF,kC,MC,nF,eF,gm,qJ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function RC(){var e=0,t=1,n,r,a,c,f=ps,i=!1,v;function b(A){return A==null||isNaN(A=+A)?v:f(a===0?.5:(A=(c(A)-n)*a,i?Math.max(0,Math.min(1,A)):A))}b.domain=function(A){return arguments.length?([e,t]=A,n=c(e=+e),r=c(t=+t),a=n===r?0:1/(r-n),b):[e,t]},b.clamp=function(A){return arguments.length?(i=!!A,b):i},b.interpolator=function(A){return arguments.length?(f=A,b):f};function T(A){return function(M){var R,B;return arguments.length?([R,B]=M,f=A(R,B),b):[f(0),f(1)]}}return b.range=T(zv),b.rangeRound=T(GN),b.unknown=function(A){return arguments.length?(v=A,b):v},function(A){return c=A,n=A(e),r=A(t),a=n===r?0:1/(r-n),b}}function Kf(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ZJ(){var e=Xf(RC()(ps));return e.copy=function(){return Kf(e,ZJ())},Wh.apply(e,arguments)}function XJ(){var e=ZN(RC()).domain([1,10]);return e.copy=function(){return Kf(e,XJ()).base(e.base())},Wh.apply(e,arguments)}function KJ(){var e=XN(RC());return e.copy=function(){return Kf(e,KJ()).constant(e.constant())},Wh.apply(e,arguments)}function aF(){var e=KN(RC());return e.copy=function(){return Kf(e,aF()).exponent(e.exponent())},Wh.apply(e,arguments)}function Eze(){return aF.apply(null,arguments).exponent(.5)}function YJ(){var e=[],t=ps;function n(r){if(r!=null&&!isNaN(r=+r))return t((jw(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Sf),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,c)=>lDe(e,c/r))},n.copy=function(){return YJ(t).domain(e)},Wh.apply(n,arguments)}function DC(){var e=0,t=.5,n=1,r=1,a,c,f,i,v,b=ps,T,A=!1,M;function R(L){return isNaN(L=+L)?M:(L=.5+((L=+T(L))-c)*(r*L<r*c?i:v),b(A?Math.max(0,Math.min(1,L)):L))}R.domain=function(L){return arguments.length?([e,t,n]=L,a=T(e=+e),c=T(t=+t),f=T(n=+n),i=a===c?0:.5/(c-a),v=c===f?0:.5/(f-c),r=c<a?-1:1,R):[e,t,n]},R.clamp=function(L){return arguments.length?(A=!!L,R):A},R.interpolator=function(L){return arguments.length?(b=L,R):b};function B(L){return function(j){var V,$,H;return arguments.length?([V,$,H]=j,b=NDe(L,[V,$,H]),R):[b(0),b(.5),b(1)]}}return R.range=B(zv),R.rangeRound=B(GN),R.unknown=function(L){return arguments.length?(M=L,R):M},function(L){return T=L,a=L(e),c=L(t),f=L(n),i=a===c?0:.5/(c-a),v=c===f?0:.5/(f-c),r=c<a?-1:1,R}}function JJ(){var e=Xf(DC()(ps));return e.copy=function(){return Kf(e,JJ())},Wh.apply(e,arguments)}function QJ(){var e=ZN(DC()).domain([.1,1,10]);return e.copy=function(){return Kf(e,QJ()).base(e.base())},Wh.apply(e,arguments)}function eQ(){var e=XN(DC());return e.copy=function(){return Kf(e,eQ()).constant(e.constant())},Wh.apply(e,arguments)}function sF(){var e=KN(DC());return e.copy=function(){return Kf(e,sF()).exponent(e.exponent())},Wh.apply(e,arguments)}function Aze(){return sF.apply(null,arguments).exponent(.5)}const M8=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Nb,scaleDiverging:JJ,scaleDivergingLog:QJ,scaleDivergingPow:sF,scaleDivergingSqrt:Aze,scaleDivergingSymlog:eQ,scaleIdentity:kJ,scaleImplicit:tL,scaleLinear:wA,scaleLog:DJ,scaleOrdinal:$N,scalePoint:N1,scalePow:YN,scaleQuantile:NJ,scaleQuantize:FJ,scaleRadial:zJ,scaleSequential:ZJ,scaleSequentialLog:XJ,scaleSequentialPow:aF,scaleSequentialQuantile:YJ,scaleSequentialSqrt:Eze,scaleSequentialSymlog:KJ,scaleSqrt:aLe,scaleSymlog:LJ,scaleThreshold:BJ,scaleTime:Sze,scaleUtc:Tze,tickFormat:OJ},Symbol.toStringTag,{value:"Module"}));var Pze=Pv;function Cze(e,t,n){for(var r=-1,a=e.length;++r<a;){var c=e[r],f=t(c);if(f!=null&&(i===void 0?f===f&&!Pze(f):n(f,i)))var i=f,v=c}return v}var LC=Cze;function Ize(e,t){return e>t}var tQ=Ize,Mze=LC,Oze=tQ,kze=Lv;function Rze(e){return e&&e.length?Mze(e,kze,Oze):void 0}var Dze=Rze;const lf=Bi(Dze);function Lze(e,t){return e<t}var nQ=Lze,zze=LC,Nze=nQ,Fze=Lv;function Bze(e){return e&&e.length?zze(e,Fze,Nze):void 0}var jze=Bze;const zC=Bi(jze);var $ze=TN,Uze=Iu,Vze=sJ,Gze=Zs;function Wze(e,t){var n=Gze(e)?$ze:Vze;return n(e,Uze(t))}var Hze=Wze,qze=oJ,Zze=Hze;function Xze(e,t){return qze(Zze(e,t),1)}var Kze=Xze;const Yze=Bi(Kze);var Jze=zN;function Qze(e,t){return Jze(e,t)}var e3e=Qze;const Ff=Bi(e3e);var Nv=1e9,t3e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},cF,_o=!0,Wl="[DecimalError] ",Sm=Wl+"Invalid argument: ",lF=Wl+"Exponent out of range: ",Fv=Math.floor,sm=Math.pow,n3e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,dl,_a=1e7,ho=7,rQ=9007199254740991,AA=Fv(rQ/ho),Yn={};Yn.absoluteValue=Yn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Yn.comparedTo=Yn.cmp=function(e){var t,n,r,a,c=this;if(e=new c.constructor(e),c.s!==e.s)return c.s||-e.s;if(c.e!==e.e)return c.e>e.e^c.s<0?1:-1;for(r=c.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(c.d[t]!==e.d[t])return c.d[t]>e.d[t]^c.s<0?1:-1;return r===a?0:r>a^c.s<0?1:-1};Yn.decimalPlaces=Yn.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*ho;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};Yn.dividedBy=Yn.div=function(e){return Ih(this,new this.constructor(e))};Yn.dividedToIntegerBy=Yn.idiv=function(e){var t=this,n=t.constructor;return Yi(Ih(t,new n(e),0,1),n.precision)};Yn.equals=Yn.eq=function(e){return!this.cmp(e)};Yn.exponent=function(){return Yo(this)};Yn.greaterThan=Yn.gt=function(e){return this.cmp(e)>0};Yn.greaterThanOrEqualTo=Yn.gte=function(e){return this.cmp(e)>=0};Yn.isInteger=Yn.isint=function(){return this.e>this.d.length-2};Yn.isNegative=Yn.isneg=function(){return this.s<0};Yn.isPositive=Yn.ispos=function(){return this.s>0};Yn.isZero=function(){return this.s===0};Yn.lessThan=Yn.lt=function(e){return this.cmp(e)<0};Yn.lessThanOrEqualTo=Yn.lte=function(e){return this.cmp(e)<1};Yn.logarithm=Yn.log=function(e){var t,n=this,r=n.constructor,a=r.precision,c=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(dl))throw Error(Wl+"NaN");if(n.s<1)throw Error(Wl+(n.s?"NaN":"-Infinity"));return n.eq(dl)?new r(0):(_o=!1,t=Ih($b(n,c),$b(e,c),c),_o=!0,Yi(t,a))};Yn.minus=Yn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aQ(t,e):iQ(t,(e.s=-e.s,e))};Yn.modulo=Yn.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(Wl+"NaN");return n.s?(_o=!1,t=Ih(n,e,0,1).times(e),_o=!0,n.minus(t)):Yi(new r(n),a)};Yn.naturalExponential=Yn.exp=function(){return oQ(this)};Yn.naturalLogarithm=Yn.ln=function(){return $b(this)};Yn.negated=Yn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Yn.plus=Yn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?iQ(t,e):aQ(t,(e.s=-e.s,e))};Yn.precision=Yn.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Sm+e);if(t=Yo(a)+1,r=a.d.length-1,n=r*ho+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};Yn.squareRoot=Yn.sqrt=function(){var e,t,n,r,a,c,f,i=this,v=i.constructor;if(i.s<1){if(!i.s)return new v(0);throw Error(Wl+"NaN")}for(e=Yo(i),_o=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=mu(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Fv((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new v(t)):r=new v(a.toString()),n=v.precision,a=f=n+3;;)if(c=r,r=c.plus(Ih(i,c,f+2)).times(.5),mu(c.d).slice(0,f)===(t=mu(r.d)).slice(0,f)){if(t=t.slice(f-3,f+1),a==f&&t=="4999"){if(Yi(c,n+1,0),c.times(c).eq(i)){r=c;break}}else if(t!="9999")break;f+=4}return _o=!0,Yi(r,n)};Yn.times=Yn.mul=function(e){var t,n,r,a,c,f,i,v,b,T=this,A=T.constructor,M=T.d,R=(e=new A(e)).d;if(!T.s||!e.s)return new A(0);for(e.s*=T.s,n=T.e+e.e,v=M.length,b=R.length,v<b&&(c=M,M=R,R=c,f=v,v=b,b=f),c=[],f=v+b,r=f;r--;)c.push(0);for(r=b;--r>=0;){for(t=0,a=v+r;a>r;)i=c[a]+R[r]*M[a-r-1]+t,c[a--]=i%_a|0,t=i/_a|0;c[a]=(c[a]+t)%_a|0}for(;!c[--f];)c.pop();return t?++n:c.shift(),e.d=c,e.e=n,_o?Yi(e,A.precision):e};Yn.toDecimalPlaces=Yn.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(Au(e,0,Nv),t===void 0?t=r.rounding:Au(t,0,8),Yi(n,e+Yo(n)+1,t))};Yn.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=Fm(r,!0):(Au(e,0,Nv),t===void 0?t=a.rounding:Au(t,0,8),r=Yi(new a(r),e+1,t),n=Fm(r,!0,e+1)),n};Yn.toFixed=function(e,t){var n,r,a=this,c=a.constructor;return e===void 0?Fm(a):(Au(e,0,Nv),t===void 0?t=c.rounding:Au(t,0,8),r=Yi(new c(a),e+Yo(a)+1,t),n=Fm(r.abs(),!1,e+Yo(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)};Yn.toInteger=Yn.toint=function(){var e=this,t=e.constructor;return Yi(new t(e),Yo(e)+1,t.rounding)};Yn.toNumber=function(){return+this};Yn.toPower=Yn.pow=function(e){var t,n,r,a,c,f,i=this,v=i.constructor,b=12,T=+(e=new v(e));if(!e.s)return new v(dl);if(i=new v(i),!i.s){if(e.s<1)throw Error(Wl+"Infinity");return i}if(i.eq(dl))return i;if(r=v.precision,e.eq(dl))return Yi(i,r);if(t=e.e,n=e.d.length-1,f=t>=n,c=i.s,f){if((n=T<0?-T:T)<=rQ){for(a=new v(dl),t=Math.ceil(r/ho+4),_o=!1;n%2&&(a=a.times(i),k8(a.d,t)),n=Fv(n/2),n!==0;)i=i.times(i),k8(i.d,t);return _o=!0,e.s<0?new v(dl).div(a):Yi(a,r)}}else if(c<0)throw Error(Wl+"NaN");return c=c<0&&e.d[Math.max(t,n)]&1?-1:1,i.s=1,_o=!1,a=e.times($b(i,r+b)),_o=!0,a=oQ(a),a.s=c,a};Yn.toPrecision=function(e,t){var n,r,a=this,c=a.constructor;return e===void 0?(n=Yo(a),r=Fm(a,n<=c.toExpNeg||n>=c.toExpPos)):(Au(e,1,Nv),t===void 0?t=c.rounding:Au(t,0,8),a=Yi(new c(a),e,t),n=Yo(a),r=Fm(a,e<=n||n<=c.toExpNeg,e)),r};Yn.toSignificantDigits=Yn.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Au(e,1,Nv),t===void 0?t=r.rounding:Au(t,0,8)),Yi(new r(n),e,t)};Yn.toString=Yn.valueOf=Yn.val=Yn.toJSON=Yn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Yo(e),n=e.constructor;return Fm(e,t<=n.toExpNeg||t>=n.toExpPos)};function iQ(e,t){var n,r,a,c,f,i,v,b,T=e.constructor,A=T.precision;if(!e.s||!t.s)return t.s||(t=new T(e)),_o?Yi(t,A):t;if(v=e.d,b=t.d,f=e.e,a=t.e,v=v.slice(),c=f-a,c){for(c<0?(r=v,c=-c,i=b.length):(r=b,a=f,i=v.length),f=Math.ceil(A/ho),i=f>i?f+1:i+1,c>i&&(c=i,r.length=1),r.reverse();c--;)r.push(0);r.reverse()}for(i=v.length,c=b.length,i-c<0&&(c=i,r=b,b=v,v=r),n=0;c;)n=(v[--c]=v[c]+b[c]+n)/_a|0,v[c]%=_a;for(n&&(v.unshift(n),++a),i=v.length;v[--i]==0;)v.pop();return t.d=v,t.e=a,_o?Yi(t,A):t}function Au(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Sm+e)}function mu(e){var t,n,r,a=e.length-1,c="",f=e[0];if(a>0){for(c+=f,t=1;t<a;t++)r=e[t]+"",n=ho-r.length,n&&(c+=Yd(n)),c+=r;f=e[t],r=f+"",n=ho-r.length,n&&(c+=Yd(n))}else if(f===0)return"0";for(;f%10===0;)f/=10;return c+f}var Ih=function(){function e(r,a){var c,f=0,i=r.length;for(r=r.slice();i--;)c=r[i]*a+f,r[i]=c%_a|0,f=c/_a|0;return f&&r.unshift(f),r}function t(r,a,c,f){var i,v;if(c!=f)v=c>f?1:-1;else for(i=v=0;i<c;i++)if(r[i]!=a[i]){v=r[i]>a[i]?1:-1;break}return v}function n(r,a,c){for(var f=0;c--;)r[c]-=f,f=r[c]<a[c]?1:0,r[c]=f*_a+r[c]-a[c];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,c,f){var i,v,b,T,A,M,R,B,L,j,V,$,H,K,Y,se,ce,ye,ze=r.constructor,Le=r.s==a.s?1:-1,je=r.d,Re=a.d;if(!r.s)return new ze(r);if(!a.s)throw Error(Wl+"Division by zero");for(v=r.e-a.e,ce=Re.length,Y=je.length,R=new ze(Le),B=R.d=[],b=0;Re[b]==(je[b]||0);)++b;if(Re[b]>(je[b]||0)&&--v,c==null?$=c=ze.precision:f?$=c+(Yo(r)-Yo(a))+1:$=c,$<0)return new ze(0);if($=$/ho+2|0,b=0,ce==1)for(T=0,Re=Re[0],$++;(b<Y||T)&&$--;b++)H=T*_a+(je[b]||0),B[b]=H/Re|0,T=H%Re|0;else{for(T=_a/(Re[0]+1)|0,T>1&&(Re=e(Re,T),je=e(je,T),ce=Re.length,Y=je.length),K=ce,L=je.slice(0,ce),j=L.length;j<ce;)L[j++]=0;ye=Re.slice(),ye.unshift(0),se=Re[0],Re[1]>=_a/2&&++se;do T=0,i=t(Re,L,ce,j),i<0?(V=L[0],ce!=j&&(V=V*_a+(L[1]||0)),T=V/se|0,T>1?(T>=_a&&(T=_a-1),A=e(Re,T),M=A.length,j=L.length,i=t(A,L,M,j),i==1&&(T--,n(A,ce<M?ye:Re,M))):(T==0&&(i=T=1),A=Re.slice()),M=A.length,M<j&&A.unshift(0),n(L,A,j),i==-1&&(j=L.length,i=t(Re,L,ce,j),i<1&&(T++,n(L,ce<j?ye:Re,j))),j=L.length):i===0&&(T++,L=[0]),B[b++]=T,i&&L[0]?L[j++]=je[K]||0:(L=[je[K]],j=1);while((K++<Y||L[0]!==void 0)&&$--)}return B[0]||B.shift(),R.e=v,Yi(R,f?c+Yo(R)+1:c)}}();function oQ(e,t){var n,r,a,c,f,i,v=0,b=0,T=e.constructor,A=T.precision;if(Yo(e)>16)throw Error(lF+Yo(e));if(!e.s)return new T(dl);for(t==null?(_o=!1,i=A):i=t,f=new T(.03125);e.abs().gte(.1);)e=e.times(f),b+=5;for(r=Math.log(sm(2,b))/Math.LN10*2+5|0,i+=r,n=a=c=new T(dl),T.precision=i;;){if(a=Yi(a.times(e),i),n=n.times(++v),f=c.plus(Ih(a,n,i)),mu(f.d).slice(0,i)===mu(c.d).slice(0,i)){for(;b--;)c=Yi(c.times(c),i);return T.precision=A,t==null?(_o=!0,Yi(c,A)):c}c=f}}function Yo(e){for(var t=e.e*ho,n=e.d[0];n>=10;n/=10)t++;return t}function Lk(e,t,n){if(t>e.LN10.sd())throw _o=!0,n&&(e.precision=n),Error(Wl+"LN10 precision limit exceeded");return Yi(new e(e.LN10),t)}function Yd(e){for(var t="";e--;)t+="0";return t}function $b(e,t){var n,r,a,c,f,i,v,b,T,A=1,M=10,R=e,B=R.d,L=R.constructor,j=L.precision;if(R.s<1)throw Error(Wl+(R.s?"NaN":"-Infinity"));if(R.eq(dl))return new L(0);if(t==null?(_o=!1,b=j):b=t,R.eq(10))return t==null&&(_o=!0),Lk(L,b);if(b+=M,L.precision=b,n=mu(B),r=n.charAt(0),c=Yo(R),Math.abs(c)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)R=R.times(e),n=mu(R.d),r=n.charAt(0),A++;c=Yo(R),r>1?(R=new L("0."+n),c++):R=new L(r+"."+n.slice(1))}else return v=Lk(L,b+2,j).times(c+""),R=$b(new L(r+"."+n.slice(1)),b-M).plus(v),L.precision=j,t==null?(_o=!0,Yi(R,j)):R;for(i=f=R=Ih(R.minus(dl),R.plus(dl),b),T=Yi(R.times(R),b),a=3;;){if(f=Yi(f.times(T),b),v=i.plus(Ih(f,new L(a),b)),mu(v.d).slice(0,b)===mu(i.d).slice(0,b))return i=i.times(2),c!==0&&(i=i.plus(Lk(L,b+2,j).times(c+""))),i=Ih(i,new L(A),b),L.precision=j,t==null?(_o=!0,Yi(i,j)):i;i=v,a+=2}}function O8(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=Fv(n/ho),e.d=[],r=(n+1)%ho,n<0&&(r+=ho),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=ho;r<a;)e.d.push(+t.slice(r,r+=ho));t=t.slice(r),r=ho-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),_o&&(e.e>AA||e.e<-AA))throw Error(lF+n)}else e.s=0,e.e=0,e.d=[0];return e}function Yi(e,t,n){var r,a,c,f,i,v,b,T,A=e.d;for(f=1,c=A[0];c>=10;c/=10)f++;if(r=t-f,r<0)r+=ho,a=t,b=A[T=0];else{if(T=Math.ceil((r+1)/ho),c=A.length,T>=c)return e;for(b=c=A[T],f=1;c>=10;c/=10)f++;r%=ho,a=r-ho+f}if(n!==void 0&&(c=sm(10,f-a-1),i=b/c%10|0,v=t<0||A[T+1]!==void 0||b%c,v=n<4?(i||v)&&(n==0||n==(e.s<0?3:2)):i>5||i==5&&(n==4||v||n==6&&(r>0?a>0?b/sm(10,f-a):0:A[T-1])%10&1||n==(e.s<0?8:7))),t<1||!A[0])return v?(c=Yo(e),A.length=1,t=t-c-1,A[0]=sm(10,(ho-t%ho)%ho),e.e=Fv(-t/ho)||0):(A.length=1,A[0]=e.e=e.s=0),e;if(r==0?(A.length=T,c=1,T--):(A.length=T+1,c=sm(10,ho-r),A[T]=a>0?(b/sm(10,f-a)%sm(10,a)|0)*c:0),v)for(;;)if(T==0){(A[0]+=c)==_a&&(A[0]=1,++e.e);break}else{if(A[T]+=c,A[T]!=_a)break;A[T--]=0,c=1}for(r=A.length;A[--r]===0;)A.pop();if(_o&&(e.e>AA||e.e<-AA))throw Error(lF+Yo(e));return e}function aQ(e,t){var n,r,a,c,f,i,v,b,T,A,M=e.constructor,R=M.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new M(e),_o?Yi(t,R):t;if(v=e.d,A=t.d,r=t.e,b=e.e,v=v.slice(),f=b-r,f){for(T=f<0,T?(n=v,f=-f,i=A.length):(n=A,r=b,i=v.length),a=Math.max(Math.ceil(R/ho),i)+2,f>a&&(f=a,n.length=1),n.reverse(),a=f;a--;)n.push(0);n.reverse()}else{for(a=v.length,i=A.length,T=a<i,T&&(i=a),a=0;a<i;a++)if(v[a]!=A[a]){T=v[a]<A[a];break}f=0}for(T&&(n=v,v=A,A=n,t.s=-t.s),i=v.length,a=A.length-i;a>0;--a)v[i++]=0;for(a=A.length;a>f;){if(v[--a]<A[a]){for(c=a;c&&v[--c]===0;)v[c]=_a-1;--v[c],v[a]+=_a}v[a]-=A[a]}for(;v[--i]===0;)v.pop();for(;v[0]===0;v.shift())--r;return v[0]?(t.d=v,t.e=r,_o?Yi(t,R):t):new M(0)}function Fm(e,t,n){var r,a=Yo(e),c=mu(e.d),f=c.length;return t?(n&&(r=n-f)>0?c=c.charAt(0)+"."+c.slice(1)+Yd(r):f>1&&(c=c.charAt(0)+"."+c.slice(1)),c=c+(a<0?"e":"e+")+a):a<0?(c="0."+Yd(-a-1)+c,n&&(r=n-f)>0&&(c+=Yd(r))):a>=f?(c+=Yd(a+1-f),n&&(r=n-a-1)>0&&(c=c+"."+Yd(r))):((r=a+1)<f&&(c=c.slice(0,r)+"."+c.slice(r)),n&&(r=n-f)>0&&(a+1===f&&(c+="."),c+=Yd(r))),e.s<0?"-"+c:c}function k8(e,t){if(e.length>t)return e.length=t,!0}function sQ(e){var t,n,r;function a(c){var f=this;if(!(f instanceof a))return new a(c);if(f.constructor=a,c instanceof a){f.s=c.s,f.e=c.e,f.d=(c=c.d)?c.slice():c;return}if(typeof c=="number"){if(c*0!==0)throw Error(Sm+c);if(c>0)f.s=1;else if(c<0)c=-c,f.s=-1;else{f.s=0,f.e=0,f.d=[0];return}if(c===~~c&&c<1e7){f.e=0,f.d=[c];return}return O8(f,c.toString())}else if(typeof c!="string")throw Error(Sm+c);if(c.charCodeAt(0)===45?(c=c.slice(1),f.s=-1):f.s=1,n3e.test(c))O8(f,c);else throw Error(Sm+c)}if(a.prototype=Yn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=sQ,a.config=a.set=r3e,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function r3e(e){if(!e||typeof e!="object")throw Error(Wl+"Object expected");var t,n,r,a=["precision",1,Nv,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(Fv(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(Sm+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Sm+n+": "+r);return this}var cF=sQ(t3e);dl=new cF(1);const Zi=cF;function i3e(e){return l3e(e)||s3e(e)||a3e(e)||o3e()}function o3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a3e(e,t){if(e){if(typeof e=="string")return aL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aL(e,t)}}function s3e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function l3e(e){if(Array.isArray(e))return aL(e)}function aL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c3e=function(t){return t},lQ={"@@functional/placeholder":!0},cQ=function(t){return t===lQ},R8=function(t){return function n(){return arguments.length===0||arguments.length===1&&cQ(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},u3e=function e(t,n){return t===1?n:R8(function(){for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];var f=a.filter(function(i){return i!==lQ}).length;return f>=t?n.apply(void 0,a):e(t-f,R8(function(){for(var i=arguments.length,v=new Array(i),b=0;b<i;b++)v[b]=arguments[b];var T=a.map(function(A){return cQ(A)?v.shift():A});return n.apply(void 0,i3e(T).concat(v))}))})},NC=function(t){return u3e(t.length,t)},sL=function(t,n){for(var r=[],a=t;a<n;++a)r[a-t]=a;return r},h3e=NC(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),d3e=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return c3e;var a=n.reverse(),c=a[0],f=a.slice(1);return function(){return f.reduce(function(i,v){return v(i)},c.apply(void 0,arguments))}},lL=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},uQ=function(t){var n=null,r=null;return function(){for(var a=arguments.length,c=new Array(a),f=0;f<a;f++)c[f]=arguments[f];return n&&c.every(function(i,v){return i===n[v]})||(n=c,r=t.apply(void 0,c)),r}};function f3e(e){var t;return e===0?t=1:t=Math.floor(new Zi(e).abs().log(10).toNumber())+1,t}function p3e(e,t,n){for(var r=new Zi(e),a=0,c=[];r.lt(t)&&a<1e5;)c.push(r.toNumber()),r=r.add(n),a++;return c}var m3e=NC(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),g3e=NC(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),y3e=NC(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const FC={rangeStep:p3e,getDigitCount:f3e,interpolateNumber:m3e,uninterpolateNumber:g3e,uninterpolateTruncation:y3e};function cL(e){return x3e(e)||v3e(e)||hQ(e)||_3e()}function _3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v3e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function x3e(e){if(Array.isArray(e))return uL(e)}function Ub(e,t){return S3e(e)||w3e(e,t)||hQ(e,t)||b3e()}function b3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hQ(e,t){if(e){if(typeof e=="string")return uL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uL(e,t)}}function uL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w3e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,c=void 0;try{for(var f=e[Symbol.iterator](),i;!(r=(i=f.next()).done)&&(n.push(i.value),!(t&&n.length===t));r=!0);}catch(v){a=!0,c=v}finally{try{!r&&f.return!=null&&f.return()}finally{if(a)throw c}}return n}}function S3e(e){if(Array.isArray(e))return e}function dQ(e){var t=Ub(e,2),n=t[0],r=t[1],a=n,c=r;return n>r&&(a=r,c=n),[a,c]}function fQ(e,t,n){if(e.lte(0))return new Zi(0);var r=FC.getDigitCount(e.toNumber()),a=new Zi(10).pow(r),c=e.div(a),f=r!==1?.05:.1,i=new Zi(Math.ceil(c.div(f).toNumber())).add(n).mul(f),v=i.mul(a);return t?v:new Zi(Math.ceil(v))}function T3e(e,t,n){var r=1,a=new Zi(e);if(!a.isint()&&n){var c=Math.abs(e);c<1?(r=new Zi(10).pow(FC.getDigitCount(e)-1),a=new Zi(Math.floor(a.div(r).toNumber())).mul(r)):c>1&&(a=new Zi(Math.floor(e)))}else e===0?a=new Zi(Math.floor((t-1)/2)):n||(a=new Zi(Math.floor(e)));var f=Math.floor((t-1)/2),i=d3e(h3e(function(v){return a.add(new Zi(v-f).mul(r)).toNumber()}),sL);return i(0,t)}function pQ(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Zi(0),tickMin:new Zi(0),tickMax:new Zi(0)};var c=fQ(new Zi(t).sub(e).div(n-1),r,a),f;e<=0&&t>=0?f=new Zi(0):(f=new Zi(e).add(t).div(2),f=f.sub(new Zi(f).mod(c)));var i=Math.ceil(f.sub(e).div(c).toNumber()),v=Math.ceil(new Zi(t).sub(f).div(c).toNumber()),b=i+v+1;return b>n?pQ(e,t,n,r,a+1):(b<n&&(v=t>0?v+(n-b):v,i=t>0?i:i+(n-b)),{step:c,tickMin:f.sub(new Zi(i).mul(c)),tickMax:f.add(new Zi(v).mul(c))})}function E3e(e){var t=Ub(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=Math.max(a,2),i=dQ([n,r]),v=Ub(i,2),b=v[0],T=v[1];if(b===-1/0||T===1/0){var A=T===1/0?[b].concat(cL(sL(0,a-1).map(function(){return 1/0}))):[].concat(cL(sL(0,a-1).map(function(){return-1/0})),[T]);return n>r?lL(A):A}if(b===T)return T3e(b,a,c);var M=pQ(b,T,f,c),R=M.step,B=M.tickMin,L=M.tickMax,j=FC.rangeStep(B,L.add(new Zi(.1).mul(R)),R);return n>r?lL(j):j}function A3e(e,t){var n=Ub(e,2),r=n[0],a=n[1],c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=dQ([r,a]),i=Ub(f,2),v=i[0],b=i[1];if(v===-1/0||b===1/0)return[r,a];if(v===b)return[v];var T=Math.max(t,2),A=fQ(new Zi(b).sub(v).div(T-1),c,0),M=[].concat(cL(FC.rangeStep(new Zi(v),new Zi(b).sub(new Zi(.99).mul(A)),A)),[b]);return r>a?lL(M):M}var P3e=uQ(E3e),C3e=uQ(A3e),I3e="Invariant failed";function Bm(e,t){throw new Error(I3e)}var M3e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function V_(e){"@babel/helpers - typeof";return V_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V_(e)}function PA(){return PA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PA.apply(this,arguments)}function O3e(e,t){return L3e(e)||D3e(e,t)||R3e(e,t)||k3e()}function k3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R3e(e,t){if(e){if(typeof e=="string")return D8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D8(e,t)}}function D8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D3e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function L3e(e){if(Array.isArray(e))return e}function z3e(e,t){if(e==null)return{};var n=N3e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function N3e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function F3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B3e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yQ(r.key),r)}}function j3e(e,t,n){return t&&B3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $3e(e,t,n){return t=CA(t),U3e(e,mQ()?Reflect.construct(t,n||[],CA(e).constructor):t.apply(e,n))}function U3e(e,t){if(t&&(V_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V3e(e)}function V3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mQ=function(){return!!e})()}function CA(e){return CA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},CA(e)}function G3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hL(e,t)}function hL(e,t){return hL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},hL(e,t)}function gQ(e,t,n){return t=yQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yQ(e){var t=W3e(e,"string");return V_(t)=="symbol"?t:t+""}function W3e(e,t){if(V_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(V_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bv=function(e){function t(){return F3e(this,t),$3e(this,t,arguments)}return G3e(t,e),j3e(t,[{key:"render",value:function(){var r=this.props,a=r.offset,c=r.layout,f=r.width,i=r.dataKey,v=r.data,b=r.dataPointFormatter,T=r.xAxis,A=r.yAxis,M=z3e(r,M3e),R=ir(M,!1);this.props.direction==="x"&&T.type!=="number"&&Bm();var B=v.map(function(L){var j=b(L,i),V=j.x,$=j.y,H=j.value,K=j.errorVal;if(!K)return null;var Y=[],se,ce;if(Array.isArray(K)){var ye=O3e(K,2);se=ye[0],ce=ye[1]}else se=ce=K;if(c==="vertical"){var ze=T.scale,Le=$+a,je=Le+f,Re=Le-f,$e=ze(H-se),Ge=ze(H+ce);Y.push({x1:Ge,y1:je,x2:Ge,y2:Re}),Y.push({x1:$e,y1:Le,x2:Ge,y2:Le}),Y.push({x1:$e,y1:je,x2:$e,y2:Re})}else if(c==="horizontal"){var ht=A.scale,ot=V+a,Je=ot-f,Ne=ot+f,Xe=ht(H-se),pt=ht(H+ce);Y.push({x1:Je,y1:pt,x2:Ne,y2:pt}),Y.push({x1:ot,y1:Xe,x2:ot,y2:pt}),Y.push({x1:Je,y1:Xe,x2:Ne,y2:Xe})}return Se.createElement(Wr,PA({className:"recharts-errorBar",key:"bar-".concat(Y.map(function(zt){return"".concat(zt.x1,"-").concat(zt.x2,"-").concat(zt.y1,"-").concat(zt.y2)}))},R),Y.map(function(zt){return Se.createElement("line",PA({},zt,{key:"line-".concat(zt.x1,"-").concat(zt.x2,"-").concat(zt.y1,"-").concat(zt.y2)}))}))});return Se.createElement(Wr,{className:"recharts-errorBars"},B)}}])}(Se.Component);gQ(Bv,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});gQ(Bv,"displayName","ErrorBar");function Vb(e){"@babel/helpers - typeof";return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vb(e)}function L8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Jp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L8(Object(n),!0).forEach(function(r){H3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function H3e(e,t,n){return t=q3e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q3e(e){var t=Z3e(e,"string");return Vb(t)=="symbol"?t:t+""}function Z3e(e,t){if(Vb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _Q=function(t){var n=t.children,r=t.formattedGraphicalItems,a=t.legendWidth,c=t.legendContent,f=ul(n,p_);if(!f)return null;var i=p_.defaultProps,v=i!==void 0?Jp(Jp({},i),f.props):{},b;return f.props&&f.props.payload?b=f.props&&f.props.payload:c==="children"?b=(r||[]).reduce(function(T,A){var M=A.item,R=A.props,B=R.sectors||R.data||[];return T.concat(B.map(function(L){return{type:f.props.iconType||M.props.legendType,value:L.name,color:L.fill,payload:L}}))},[]):b=(r||[]).map(function(T){var A=T.item,M=A.type.defaultProps,R=M!==void 0?Jp(Jp({},M),A.props):{},B=R.dataKey,L=R.name,j=R.legendType,V=R.hide;return{inactive:V,dataKey:B,type:v.iconType||j||"square",color:uF(A),value:L||B,payload:R}}),Jp(Jp(Jp({},v),p_.getWithHeight(f,a)),{},{payload:b,item:f})};function Gb(e){"@babel/helpers - typeof";return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gb(e)}function z8(e){return J3e(e)||Y3e(e)||K3e(e)||X3e()}function X3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K3e(e,t){if(e){if(typeof e=="string")return dL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dL(e,t)}}function Y3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function J3e(e){if(Array.isArray(e))return dL(e)}function dL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Do(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?N8(Object(n),!0).forEach(function(r){g_(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function g_(e,t,n){return t=Q3e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q3e(e){var t=eNe(e,"string");return Gb(t)=="symbol"?t:t+""}function eNe(e,t){if(Gb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fo(e,t,n){return xr(e)||xr(t)?n:aa(t)?yl(e,t,n):Tr(t)?t(e):n}function F1(e,t,n,r){var a=Yze(e,function(i){return fo(i,t)});if(n==="number"){var c=a.filter(function(i){return wn(i)||parseFloat(i)});return c.length?[zC(c),lf(c)]:[1/0,-1/0]}var f=r?a.filter(function(i){return!xr(i)}):a;return f.map(function(i){return aa(i)||i instanceof Date?i:""})}var tNe=function(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,f=-1,i=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(i<=1)return 0;if(c&&c.axisType==="angleAxis"&&Math.abs(Math.abs(c.range[1]-c.range[0])-360)<=1e-6)for(var v=c.range,b=0;b<i;b++){var T=b>0?a[b-1].coordinate:a[i-1].coordinate,A=a[b].coordinate,M=b>=i-1?a[0].coordinate:a[b+1].coordinate,R=void 0;if(ds(A-T)!==ds(M-A)){var B=[];if(ds(M-A)===ds(v[1]-v[0])){R=M;var L=A+v[1]-v[0];B[0]=Math.min(L,(L+T)/2),B[1]=Math.max(L,(L+T)/2)}else{R=T;var j=M+v[1]-v[0];B[0]=Math.min(A,(j+A)/2),B[1]=Math.max(A,(j+A)/2)}var V=[Math.min(A,(R+A)/2),Math.max(A,(R+A)/2)];if(t>V[0]&&t<=V[1]||t>=B[0]&&t<=B[1]){f=a[b].index;break}}else{var $=Math.min(T,M),H=Math.max(T,M);if(t>($+A)/2&&t<=(H+A)/2){f=a[b].index;break}}}else for(var K=0;K<i;K++)if(K===0&&t<=(r[K].coordinate+r[K+1].coordinate)/2||K>0&&K<i-1&&t>(r[K].coordinate+r[K-1].coordinate)/2&&t<=(r[K].coordinate+r[K+1].coordinate)/2||K===i-1&&t>(r[K].coordinate+r[K-1].coordinate)/2){f=r[K].index;break}return f},uF=function(t){var n,r=t,a=r.type.displayName,c=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Do(Do({},t.type.defaultProps),t.props):t.props,f=c.stroke,i=c.fill,v;switch(a){case"Line":v=f;break;case"Area":case"Radar":v=f&&f!=="none"?f:i;break;default:v=i;break}return v},nNe=function(t){var n=t.barSize,r=t.totalSize,a=t.stackGroups,c=a===void 0?{}:a;if(!c)return{};for(var f={},i=Object.keys(c),v=0,b=i.length;v<b;v++)for(var T=c[i[v]].stackGroups,A=Object.keys(T),M=0,R=A.length;M<R;M++){var B=T[A[M]],L=B.items,j=B.cateAxisId,V=L.filter(function(ce){return Ch(ce.type).indexOf("Bar")>=0});if(V&&V.length){var $=V[0].type.defaultProps,H=$!==void 0?Do(Do({},$),V[0].props):V[0].props,K=H.barSize,Y=H[j];f[Y]||(f[Y]=[]);var se=xr(K)?n:K;f[Y].push({item:V[0],stackList:V.slice(1),barSize:xr(se)?void 0:fs(se,r,0)})}}return f},rNe=function(t){var n=t.barGap,r=t.barCategoryGap,a=t.bandSize,c=t.sizeList,f=c===void 0?[]:c,i=t.maxBarSize,v=f.length;if(v<1)return null;var b=fs(n,a,0,!0),T,A=[];if(f[0].barSize===+f[0].barSize){var M=!1,R=a/v,B=f.reduce(function(K,Y){return K+Y.barSize||0},0);B+=(v-1)*b,B>=a&&(B-=(v-1)*b,b=0),B>=a&&R>0&&(M=!0,R*=.9,B=v*R);var L=(a-B)/2>>0,j={offset:L-b,size:0};T=f.reduce(function(K,Y){var se={item:Y.item,position:{offset:j.offset+j.size+b,size:M?R:Y.barSize}},ce=[].concat(z8(K),[se]);return j=ce[ce.length-1].position,Y.stackList&&Y.stackList.length&&Y.stackList.forEach(function(ye){ce.push({item:ye,position:j})}),ce},A)}else{var V=fs(r,a,0,!0);a-2*V-(v-1)*b<=0&&(b=0);var $=(a-2*V-(v-1)*b)/v;$>1&&($>>=0);var H=i===+i?Math.min($,i):$;T=f.reduce(function(K,Y,se){var ce=[].concat(z8(K),[{item:Y.item,position:{offset:V+($+b)*se+($-H)/2,size:H}}]);return Y.stackList&&Y.stackList.length&&Y.stackList.forEach(function(ye){ce.push({item:ye,position:ce[ce.length-1].position})}),ce},A)}return T},iNe=function(t,n,r,a){var c=r.children,f=r.width,i=r.margin,v=f-(i.left||0)-(i.right||0),b=_Q({children:c,legendWidth:v});if(b){var T=a||{},A=T.width,M=T.height,R=b.align,B=b.verticalAlign,L=b.layout;if((L==="vertical"||L==="horizontal"&&B==="middle")&&R!=="center"&&wn(t[R]))return Do(Do({},t),{},g_({},R,t[R]+(A||0)));if((L==="horizontal"||L==="vertical"&&R==="center")&&B!=="middle"&&wn(t[B]))return Do(Do({},t),{},g_({},B,t[B]+(M||0)))}return t},oNe=function(t,n,r){return xr(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},vQ=function(t,n,r,a,c){var f=n.props.children,i=gs(f,Bv).filter(function(b){return oNe(a,c,b.props.direction)});if(i&&i.length){var v=i.map(function(b){return b.props.dataKey});return t.reduce(function(b,T){var A=fo(T,r);if(xr(A))return b;var M=Array.isArray(A)?[zC(A),lf(A)]:[A,A],R=v.reduce(function(B,L){var j=fo(T,L,0),V=M[0]-Math.abs(Array.isArray(j)?j[0]:j),$=M[1]+Math.abs(Array.isArray(j)?j[1]:j);return[Math.min(V,B[0]),Math.max($,B[1])]},[1/0,-1/0]);return[Math.min(R[0],b[0]),Math.max(R[1],b[1])]},[1/0,-1/0])}return null},aNe=function(t,n,r,a,c){var f=n.map(function(i){return vQ(t,i,r,c,a)}).filter(function(i){return!xr(i)});return f&&f.length?f.reduce(function(i,v){return[Math.min(i[0],v[0]),Math.max(i[1],v[1])]},[1/0,-1/0]):null},xQ=function(t,n,r,a,c){var f=n.map(function(v){var b=v.props.dataKey;return r==="number"&&b&&vQ(t,v,b,a)||F1(t,b,r,c)});if(r==="number")return f.reduce(function(v,b){return[Math.min(v[0],b[0]),Math.max(v[1],b[1])]},[1/0,-1/0]);var i={};return f.reduce(function(v,b){for(var T=0,A=b.length;T<A;T++)i[b[T]]||(i[b[T]]=!0,v.push(b[T]));return v},[])},bQ=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},wQ=function(t,n,r,a){if(a)return t.map(function(v){return v.coordinate});var c,f,i=t.map(function(v){return v.coordinate===n&&(c=!0),v.coordinate===r&&(f=!0),v.coordinate});return c||i.push(n),f||i.push(r),i},Ah=function(t,n,r){if(!t)return null;var a=t.scale,c=t.duplicateDomain,f=t.type,i=t.range,v=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,b=(n||r)&&f==="category"&&a.bandwidth?a.bandwidth()/v:0;if(b=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?ds(i[0]-i[1])*2*b:b,n&&(t.ticks||t.niceTicks)){var T=(t.ticks||t.niceTicks).map(function(A){var M=c?c.indexOf(A):A;return{coordinate:a(M)+b,value:A,offset:b}});return T.filter(function(A){return!kv(A.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(A,M){return{coordinate:a(A)+b,value:A,index:M,offset:b}}):a.ticks&&!r?a.ticks(t.tickCount).map(function(A){return{coordinate:a(A)+b,value:A,offset:b}}):a.domain().map(function(A,M){return{coordinate:a(A)+b,value:c?c[A]:A,index:M,offset:b}})},zk=new WeakMap,OE=function(t,n){if(typeof n!="function")return t;zk.has(t)||zk.set(t,new WeakMap);var r=zk.get(t);if(r.has(n))return r.get(n);var a=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,a),a},SQ=function(t,n,r){var a=t.scale,c=t.type,f=t.layout,i=t.axisType;if(a==="auto")return f==="radial"&&i==="radiusAxis"?{scale:Nb(),realScaleType:"band"}:f==="radial"&&i==="angleAxis"?{scale:wA(),realScaleType:"linear"}:c==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:N1(),realScaleType:"point"}:c==="category"?{scale:Nb(),realScaleType:"band"}:{scale:wA(),realScaleType:"linear"};if(Fw(a)){var v="scale".concat(vC(a));return{scale:(M8[v]||N1)(),realScaleType:M8[v]?v:"point"}}return Tr(a)?{scale:a}:{scale:N1(),realScaleType:"point"}},F8=1e-4,TQ=function(t){var n=t.domain();if(!(!n||n.length<=2)){var r=n.length,a=t.range(),c=Math.min(a[0],a[1])-F8,f=Math.max(a[0],a[1])+F8,i=t(n[0]),v=t(n[r-1]);(i<c||i>f||v<c||v>f)&&t.domain([n[0],n[r-1]])}},sNe=function(t,n){if(!t)return null;for(var r=0,a=t.length;r<a;r++)if(t[r].item===n)return t[r].position;return null},lNe=function(t,n){if(!n||n.length!==2||!wn(n[0])||!wn(n[1]))return t;var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]),c=[t[0],t[1]];return(!wn(t[0])||t[0]<r)&&(c[0]=r),(!wn(t[1])||t[1]>a)&&(c[1]=a),c[0]>a&&(c[0]=a),c[1]<r&&(c[1]=r),c},cNe=function(t){var n=t.length;if(!(n<=0))for(var r=0,a=t[0].length;r<a;++r)for(var c=0,f=0,i=0;i<n;++i){var v=kv(t[i][r][1])?t[i][r][0]:t[i][r][1];v>=0?(t[i][r][0]=c,t[i][r][1]=c+v,c=t[i][r][1]):(t[i][r][0]=f,t[i][r][1]=f+v,f=t[i][r][1])}},uNe=function(t){var n=t.length;if(!(n<=0))for(var r=0,a=t[0].length;r<a;++r)for(var c=0,f=0;f<n;++f){var i=kv(t[f][r][1])?t[f][r][0]:t[f][r][1];i>=0?(t[f][r][0]=c,t[f][r][1]=c+i,c=t[f][r][1]):(t[f][r][0]=0,t[f][r][1]=0)}},hNe={sign:cNe,expand:PEe,none:L_,silhouette:CEe,wiggle:IEe,positive:uNe},dNe=function(t,n,r){var a=n.map(function(i){return i.props.dataKey}),c=hNe[r],f=AEe().keys(a).value(function(i,v){return+fo(i,v,0)}).order(zD).offset(c);return f(t)},fNe=function(t,n,r,a,c,f){if(!t)return null;var i=f?n.reverse():n,v={},b=i.reduce(function(A,M){var R,B=(R=M.type)!==null&&R!==void 0&&R.defaultProps?Do(Do({},M.type.defaultProps),M.props):M.props,L=B.stackId,j=B.hide;if(j)return A;var V=B[r],$=A[V]||{hasStack:!1,stackGroups:{}};if(aa(L)){var H=$.stackGroups[L]||{numericAxisId:r,cateAxisId:a,items:[]};H.items.push(M),$.hasStack=!0,$.stackGroups[L]=H}else $.stackGroups[Zf("_stackId_")]={numericAxisId:r,cateAxisId:a,items:[M]};return Do(Do({},A),{},g_({},V,$))},v),T={};return Object.keys(b).reduce(function(A,M){var R=b[M];if(R.hasStack){var B={};R.stackGroups=Object.keys(R.stackGroups).reduce(function(L,j){var V=R.stackGroups[j];return Do(Do({},L),{},g_({},j,{numericAxisId:r,cateAxisId:a,items:V.items,stackedData:dNe(t,V.items,c)}))},B)}return Do(Do({},A),{},g_({},M,R))},T)},EQ=function(t,n){var r=n.realScaleType,a=n.type,c=n.tickCount,f=n.originalDomain,i=n.allowDecimals,v=r||n.scale;if(v!=="auto"&&v!=="linear")return null;if(c&&a==="number"&&f&&(f[0]==="auto"||f[1]==="auto")){var b=t.domain();if(!b.length)return null;var T=P3e(b,c,i);return t.domain([zC(T),lf(T)]),{niceTicks:T}}if(c&&a==="number"){var A=t.domain(),M=C3e(A,c,i);return{niceTicks:M}}return null};function G_(e){var t=e.axis,n=e.ticks,r=e.bandSize,a=e.entry,c=e.index,f=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!xr(a[t.dataKey])){var i=nA(n,"value",a[t.dataKey]);if(i)return i.coordinate+r/2}return n[c]?n[c].coordinate+r/2:null}var v=fo(a,xr(f)?t.dataKey:f);return xr(v)?null:t.scale(v)}var B8=function(t){var n=t.axis,r=t.ticks,a=t.offset,c=t.bandSize,f=t.entry,i=t.index;if(n.type==="category")return r[i]?r[i].coordinate+a:null;var v=fo(f,n.dataKey,n.domain[i]);return xr(v)?null:n.scale(v)-c/2+a},pNe=function(t){var n=t.numericAxis,r=n.scale.domain();if(n.type==="number"){var a=Math.min(r[0],r[1]),c=Math.max(r[0],r[1]);return a<=0&&c>=0?0:c<0?c:a}return r[0]},mNe=function(t,n){var r,a=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Do(Do({},t.type.defaultProps),t.props):t.props,c=a.stackId;if(aa(c)){var f=n[c];if(f){var i=f.items.indexOf(t);return i>=0?f.stackedData[i]:null}}return null},gNe=function(t){return t.reduce(function(n,r){return[zC(r.concat([n[0]]).filter(wn)),lf(r.concat([n[1]]).filter(wn))]},[1/0,-1/0])},AQ=function(t,n,r){return Object.keys(t).reduce(function(a,c){var f=t[c],i=f.stackedData,v=i.reduce(function(b,T){var A=gNe(T.slice(n,r+1));return[Math.min(b[0],A[0]),Math.max(b[1],A[1])]},[1/0,-1/0]);return[Math.min(v[0],a[0]),Math.max(v[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},j8=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,$8=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,fL=function(t,n,r){if(Tr(t))return t(n,r);if(!Array.isArray(t))return n;var a=[];if(wn(t[0]))a[0]=r?t[0]:Math.min(t[0],n[0]);else if(j8.test(t[0])){var c=+j8.exec(t[0])[1];a[0]=n[0]-c}else Tr(t[0])?a[0]=t[0](n[0]):a[0]=n[0];if(wn(t[1]))a[1]=r?t[1]:Math.max(t[1],n[1]);else if($8.test(t[1])){var f=+$8.exec(t[1])[1];a[1]=n[1]+f}else Tr(t[1])?a[1]=t[1](n[1]):a[1]=n[1];return a},IA=function(t,n,r){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!r||a>0)return a}if(t&&n&&n.length>=2){for(var c=FN(n,function(A){return A.coordinate}),f=1/0,i=1,v=c.length;i<v;i++){var b=c[i],T=c[i-1];f=Math.min((b.coordinate||0)-(T.coordinate||0),f)}return f===1/0?0:f}return r?void 0:0},U8=function(t,n,r){return!t||!t.length||Ff(t,yl(r,"type.defaultProps.domain"))?n:t},PQ=function(t,n){var r=t.type.defaultProps?Do(Do({},t.type.defaultProps),t.props):t.props,a=r.dataKey,c=r.name,f=r.unit,i=r.formatter,v=r.tooltipType,b=r.chartType,T=r.hide;return Do(Do({},ir(t,!1)),{},{dataKey:a,unit:f,formatter:i,name:c||a,color:uF(t),value:fo(n,a),type:v,payload:n,chartType:b,hide:T})};function Wb(e){"@babel/helpers - typeof";return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(e)}function V8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function vh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?V8(Object(n),!0).forEach(function(r){CQ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function CQ(e,t,n){return t=yNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yNe(e){var t=_Ne(e,"string");return Wb(t)=="symbol"?t:t+""}function _Ne(e,t){if(Wb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Wb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vNe(e,t){return SNe(e)||wNe(e,t)||bNe(e,t)||xNe()}function xNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bNe(e,t){if(e){if(typeof e=="string")return G8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G8(e,t)}}function G8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function SNe(e){if(Array.isArray(e))return e}var MA=Math.PI/180,TNe=function(t){return t*180/Math.PI},oo=function(t,n,r,a){return{x:t+Math.cos(-MA*a)*r,y:n+Math.sin(-MA*a)*r}},IQ=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},ENe=function(t,n,r,a,c){var f=t.width,i=t.height,v=t.startAngle,b=t.endAngle,T=fs(t.cx,f,f/2),A=fs(t.cy,i,i/2),M=IQ(f,i,r),R=fs(t.innerRadius,M,0),B=fs(t.outerRadius,M,M*.8),L=Object.keys(n);return L.reduce(function(j,V){var $=n[V],H=$.domain,K=$.reversed,Y;if(xr($.range))a==="angleAxis"?Y=[v,b]:a==="radiusAxis"&&(Y=[R,B]),K&&(Y=[Y[1],Y[0]]);else{Y=$.range;var se=Y,ce=vNe(se,2);v=ce[0],b=ce[1]}var ye=SQ($,c),ze=ye.realScaleType,Le=ye.scale;Le.domain(H).range(Y),TQ(Le);var je=EQ(Le,vh(vh({},$),{},{realScaleType:ze})),Re=vh(vh(vh({},$),je),{},{range:Y,radius:B,realScaleType:ze,scale:Le,cx:T,cy:A,innerRadius:R,outerRadius:B,startAngle:v,endAngle:b});return vh(vh({},j),{},CQ({},V,Re))},{})},ANe=function(t,n){var r=t.x,a=t.y,c=n.x,f=n.y;return Math.sqrt(Math.pow(r-c,2)+Math.pow(a-f,2))},PNe=function(t,n){var r=t.x,a=t.y,c=n.cx,f=n.cy,i=ANe({x:r,y:a},{x:c,y:f});if(i<=0)return{radius:i};var v=(r-c)/i,b=Math.acos(v);return a>f&&(b=2*Math.PI-b),{radius:i,angle:TNe(b),angleInRadian:b}},CNe=function(t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),c=Math.floor(r/360),f=Math.min(a,c);return{startAngle:n-f*360,endAngle:r-f*360}},INe=function(t,n){var r=n.startAngle,a=n.endAngle,c=Math.floor(r/360),f=Math.floor(a/360),i=Math.min(c,f);return t+i*360},W8=function(t,n){var r=t.x,a=t.y,c=PNe({x:r,y:a},n),f=c.radius,i=c.angle,v=n.innerRadius,b=n.outerRadius;if(f<v||f>b)return!1;if(f===0)return!0;var T=CNe(n),A=T.startAngle,M=T.endAngle,R=i,B;if(A<=M){for(;R>M;)R-=360;for(;R<A;)R+=360;B=R>=A&&R<=M}else{for(;R>A;)R-=360;for(;R<M;)R+=360;B=R>=M&&R<=A}return B?vh(vh({},n),{},{radius:f,angle:INe(R,n)}):null},MQ=function(t){return!X.isValidElement(t)&&!Tr(t)&&typeof t!="boolean"?t.className:""};function Hb(e){"@babel/helpers - typeof";return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hb(e)}var MNe=["offset"];function ONe(e){return LNe(e)||DNe(e)||RNe(e)||kNe()}function kNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RNe(e,t){if(e){if(typeof e=="string")return pL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pL(e,t)}}function DNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function LNe(e){if(Array.isArray(e))return pL(e)}function pL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zNe(e,t){if(e==null)return{};var n=NNe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function NNe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function H8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function na(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?H8(Object(n),!0).forEach(function(r){FNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function FNe(e,t,n){return t=BNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BNe(e){var t=jNe(e,"string");return Hb(t)=="symbol"?t:t+""}function jNe(e,t){if(Hb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qb(){return qb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qb.apply(this,arguments)}var $Ne=function(t){var n=t.value,r=t.formatter,a=xr(t.children)?n:t.children;return Tr(r)?r(a):a},UNe=function(t,n){var r=ds(n-t),a=Math.min(Math.abs(n-t),360);return r*a},VNe=function(t,n,r){var a=t.position,c=t.viewBox,f=t.offset,i=t.className,v=c,b=v.cx,T=v.cy,A=v.innerRadius,M=v.outerRadius,R=v.startAngle,B=v.endAngle,L=v.clockWise,j=(A+M)/2,V=UNe(R,B),$=V>=0?1:-1,H,K;a==="insideStart"?(H=R+$*f,K=L):a==="insideEnd"?(H=B-$*f,K=!L):a==="end"&&(H=B+$*f,K=L),K=V<=0?K:!K;var Y=oo(b,T,j,H),se=oo(b,T,j,H+(K?1:-1)*359),ce="M".concat(Y.x,",").concat(Y.y,`
    A`).concat(j,",").concat(j,",0,1,").concat(K?0:1,`,
    `).concat(se.x,",").concat(se.y),ye=xr(t.id)?Zf("recharts-radial-line-"):t.id;return Se.createElement("text",qb({},r,{dominantBaseline:"central",className:jr("recharts-radial-bar-label",i)}),Se.createElement("defs",null,Se.createElement("path",{id:ye,d:ce})),Se.createElement("textPath",{xlinkHref:"#".concat(ye)},n))},GNe=function(t){var n=t.viewBox,r=t.offset,a=t.position,c=n,f=c.cx,i=c.cy,v=c.innerRadius,b=c.outerRadius,T=c.startAngle,A=c.endAngle,M=(T+A)/2;if(a==="outside"){var R=oo(f,i,b+r,M),B=R.x,L=R.y;return{x:B,y:L,textAnchor:B>=f?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"end"};var j=(v+b)/2,V=oo(f,i,j,M),$=V.x,H=V.y;return{x:$,y:H,textAnchor:"middle",verticalAnchor:"middle"}},WNe=function(t){var n=t.viewBox,r=t.parentViewBox,a=t.offset,c=t.position,f=n,i=f.x,v=f.y,b=f.width,T=f.height,A=T>=0?1:-1,M=A*a,R=A>0?"end":"start",B=A>0?"start":"end",L=b>=0?1:-1,j=L*a,V=L>0?"end":"start",$=L>0?"start":"end";if(c==="top"){var H={x:i+b/2,y:v-A*a,textAnchor:"middle",verticalAnchor:R};return na(na({},H),r?{height:Math.max(v-r.y,0),width:b}:{})}if(c==="bottom"){var K={x:i+b/2,y:v+T+M,textAnchor:"middle",verticalAnchor:B};return na(na({},K),r?{height:Math.max(r.y+r.height-(v+T),0),width:b}:{})}if(c==="left"){var Y={x:i-j,y:v+T/2,textAnchor:V,verticalAnchor:"middle"};return na(na({},Y),r?{width:Math.max(Y.x-r.x,0),height:T}:{})}if(c==="right"){var se={x:i+b+j,y:v+T/2,textAnchor:$,verticalAnchor:"middle"};return na(na({},se),r?{width:Math.max(r.x+r.width-se.x,0),height:T}:{})}var ce=r?{width:b,height:T}:{};return c==="insideLeft"?na({x:i+j,y:v+T/2,textAnchor:$,verticalAnchor:"middle"},ce):c==="insideRight"?na({x:i+b-j,y:v+T/2,textAnchor:V,verticalAnchor:"middle"},ce):c==="insideTop"?na({x:i+b/2,y:v+M,textAnchor:"middle",verticalAnchor:B},ce):c==="insideBottom"?na({x:i+b/2,y:v+T-M,textAnchor:"middle",verticalAnchor:R},ce):c==="insideTopLeft"?na({x:i+j,y:v+M,textAnchor:$,verticalAnchor:B},ce):c==="insideTopRight"?na({x:i+b-j,y:v+M,textAnchor:V,verticalAnchor:B},ce):c==="insideBottomLeft"?na({x:i+j,y:v+T-M,textAnchor:$,verticalAnchor:R},ce):c==="insideBottomRight"?na({x:i+b-j,y:v+T-M,textAnchor:V,verticalAnchor:R},ce):Cv(c)&&(wn(c.x)||pm(c.x))&&(wn(c.y)||pm(c.y))?na({x:i+fs(c.x,b),y:v+fs(c.y,T),textAnchor:"end",verticalAnchor:"end"},ce):na({x:i+b/2,y:v+T/2,textAnchor:"middle",verticalAnchor:"middle"},ce)},HNe=function(t){return"cx"in t&&wn(t.cx)};function xa(e){var t=e.offset,n=t===void 0?5:t,r=zNe(e,MNe),a=na({offset:n},r),c=a.viewBox,f=a.position,i=a.value,v=a.children,b=a.content,T=a.className,A=T===void 0?"":T,M=a.textBreakAll;if(!c||xr(i)&&xr(v)&&!X.isValidElement(b)&&!Tr(b))return null;if(X.isValidElement(b))return X.cloneElement(b,a);var R;if(Tr(b)){if(R=X.createElement(b,a),X.isValidElement(R))return R}else R=$Ne(a);var B=HNe(c),L=ir(a,!0);if(B&&(f==="insideStart"||f==="insideEnd"||f==="end"))return VNe(a,R,L);var j=B?GNe(a):WNe(a);return Se.createElement(zm,qb({className:jr("recharts-label",A)},L,j,{breakAll:M}),R)}xa.displayName="Label";var OQ=function(t){var n=t.cx,r=t.cy,a=t.angle,c=t.startAngle,f=t.endAngle,i=t.r,v=t.radius,b=t.innerRadius,T=t.outerRadius,A=t.x,M=t.y,R=t.top,B=t.left,L=t.width,j=t.height,V=t.clockWise,$=t.labelViewBox;if($)return $;if(wn(L)&&wn(j)){if(wn(A)&&wn(M))return{x:A,y:M,width:L,height:j};if(wn(R)&&wn(B))return{x:R,y:B,width:L,height:j}}return wn(A)&&wn(M)?{x:A,y:M,width:0,height:0}:wn(n)&&wn(r)?{cx:n,cy:r,startAngle:c||a||0,endAngle:f||a||0,innerRadius:b||0,outerRadius:T||v||i||0,clockWise:V}:t.viewBox?t.viewBox:{}},qNe=function(t,n){return t?t===!0?Se.createElement(xa,{key:"label-implicit",viewBox:n}):aa(t)?Se.createElement(xa,{key:"label-implicit",viewBox:n,value:t}):X.isValidElement(t)?t.type===xa?X.cloneElement(t,{key:"label-implicit",viewBox:n}):Se.createElement(xa,{key:"label-implicit",content:t,viewBox:n}):Tr(t)?Se.createElement(xa,{key:"label-implicit",content:t,viewBox:n}):Cv(t)?Se.createElement(xa,qb({viewBox:n},t,{key:"label-implicit"})):null:null},ZNe=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var a=t.children,c=OQ(t),f=gs(a,xa).map(function(v,b){return X.cloneElement(v,{viewBox:n||c,key:"label-".concat(b)})});if(!r)return f;var i=qNe(t.label,n||c);return[i].concat(ONe(f))};xa.parseViewBox=OQ;xa.renderCallByParent=ZNe;function XNe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var KNe=XNe;const YNe=Bi(KNe);function Zb(e){"@babel/helpers - typeof";return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(e)}var JNe=["valueAccessor"],QNe=["data","dataKey","clockWise","id","textBreakAll"];function eFe(e){return iFe(e)||rFe(e)||nFe(e)||tFe()}function tFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nFe(e,t){if(e){if(typeof e=="string")return mL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mL(e,t)}}function rFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iFe(e){if(Array.isArray(e))return mL(e)}function mL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function OA(){return OA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OA.apply(this,arguments)}function q8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Z8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?q8(Object(n),!0).forEach(function(r){oFe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oFe(e,t,n){return t=aFe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aFe(e){var t=sFe(e,"string");return Zb(t)=="symbol"?t:t+""}function sFe(e,t){if(Zb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Zb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X8(e,t){if(e==null)return{};var n=lFe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lFe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var cFe=function(t){return Array.isArray(t.value)?YNe(t.value):t.value};function kc(e){var t=e.valueAccessor,n=t===void 0?cFe:t,r=X8(e,JNe),a=r.data,c=r.dataKey,f=r.clockWise,i=r.id,v=r.textBreakAll,b=X8(r,QNe);return!a||!a.length?null:Se.createElement(Wr,{className:"recharts-label-list"},a.map(function(T,A){var M=xr(c)?n(T,A):fo(T&&T.payload,c),R=xr(i)?{}:{id:"".concat(i,"-").concat(A)};return Se.createElement(xa,OA({},ir(T,!0),b,R,{parentViewBox:T.parentViewBox,value:M,textBreakAll:v,viewBox:xa.parseViewBox(xr(f)?T:Z8(Z8({},T),{},{clockWise:f})),key:"label-".concat(A),index:A}))}))}kc.displayName="LabelList";function uFe(e,t){return e?e===!0?Se.createElement(kc,{key:"labelList-implicit",data:t}):Se.isValidElement(e)||Tr(e)?Se.createElement(kc,{key:"labelList-implicit",data:t,content:e}):Cv(e)?Se.createElement(kc,OA({data:t},e,{key:"labelList-implicit"})):null:null}function hFe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=gs(r,kc).map(function(f,i){return X.cloneElement(f,{data:t,key:"labelList-".concat(i)})});if(!n)return a;var c=uFe(e.label,t);return[c].concat(eFe(a))}kc.renderCallByParent=hFe;function Xb(e){"@babel/helpers - typeof";return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(e)}function gL(){return gL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gL.apply(this,arguments)}function K8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Y8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K8(Object(n),!0).forEach(function(r){dFe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dFe(e,t,n){return t=fFe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fFe(e){var t=pFe(e,"string");return Xb(t)=="symbol"?t:t+""}function pFe(e,t){if(Xb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Xb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mFe=function(t,n){var r=ds(n-t),a=Math.min(Math.abs(n-t),359.999);return r*a},kE=function(t){var n=t.cx,r=t.cy,a=t.radius,c=t.angle,f=t.sign,i=t.isExternal,v=t.cornerRadius,b=t.cornerIsExternal,T=v*(i?1:-1)+a,A=Math.asin(v/T)/MA,M=b?c:c+f*A,R=oo(n,r,T,M),B=oo(n,r,a,M),L=b?c-f*A:c,j=oo(n,r,T*Math.cos(A*MA),L);return{center:R,circleTangency:B,lineTangency:j,theta:A}},kQ=function(t){var n=t.cx,r=t.cy,a=t.innerRadius,c=t.outerRadius,f=t.startAngle,i=t.endAngle,v=mFe(f,i),b=f+v,T=oo(n,r,c,f),A=oo(n,r,c,b),M="M ".concat(T.x,",").concat(T.y,`
    A `).concat(c,",").concat(c,`,0,
    `).concat(+(Math.abs(v)>180),",").concat(+(f>b),`,
    `).concat(A.x,",").concat(A.y,`
  `);if(a>0){var R=oo(n,r,a,f),B=oo(n,r,a,b);M+="L ".concat(B.x,",").concat(B.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(v)>180),",").concat(+(f<=b),`,
            `).concat(R.x,",").concat(R.y," Z")}else M+="L ".concat(n,",").concat(r," Z");return M},gFe=function(t){var n=t.cx,r=t.cy,a=t.innerRadius,c=t.outerRadius,f=t.cornerRadius,i=t.forceCornerRadius,v=t.cornerIsExternal,b=t.startAngle,T=t.endAngle,A=ds(T-b),M=kE({cx:n,cy:r,radius:c,angle:b,sign:A,cornerRadius:f,cornerIsExternal:v}),R=M.circleTangency,B=M.lineTangency,L=M.theta,j=kE({cx:n,cy:r,radius:c,angle:T,sign:-A,cornerRadius:f,cornerIsExternal:v}),V=j.circleTangency,$=j.lineTangency,H=j.theta,K=v?Math.abs(b-T):Math.abs(b-T)-L-H;if(K<0)return i?"M ".concat(B.x,",").concat(B.y,`
        a`).concat(f,",").concat(f,",0,0,1,").concat(f*2,`,0
        a`).concat(f,",").concat(f,",0,0,1,").concat(-f*2,`,0
      `):kQ({cx:n,cy:r,innerRadius:a,outerRadius:c,startAngle:b,endAngle:T});var Y="M ".concat(B.x,",").concat(B.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(A<0),",").concat(R.x,",").concat(R.y,`
    A`).concat(c,",").concat(c,",0,").concat(+(K>180),",").concat(+(A<0),",").concat(V.x,",").concat(V.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(A<0),",").concat($.x,",").concat($.y,`
  `);if(a>0){var se=kE({cx:n,cy:r,radius:a,angle:b,sign:A,isExternal:!0,cornerRadius:f,cornerIsExternal:v}),ce=se.circleTangency,ye=se.lineTangency,ze=se.theta,Le=kE({cx:n,cy:r,radius:a,angle:T,sign:-A,isExternal:!0,cornerRadius:f,cornerIsExternal:v}),je=Le.circleTangency,Re=Le.lineTangency,$e=Le.theta,Ge=v?Math.abs(b-T):Math.abs(b-T)-ze-$e;if(Ge<0&&f===0)return"".concat(Y,"L").concat(n,",").concat(r,"Z");Y+="L".concat(Re.x,",").concat(Re.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(A<0),",").concat(je.x,",").concat(je.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(Ge>180),",").concat(+(A>0),",").concat(ce.x,",").concat(ce.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(A<0),",").concat(ye.x,",").concat(ye.y,"Z")}else Y+="L".concat(n,",").concat(r,"Z");return Y},yFe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},RQ=function(t){var n=Y8(Y8({},yFe),t),r=n.cx,a=n.cy,c=n.innerRadius,f=n.outerRadius,i=n.cornerRadius,v=n.forceCornerRadius,b=n.cornerIsExternal,T=n.startAngle,A=n.endAngle,M=n.className;if(f<c||T===A)return null;var R=jr("recharts-sector",M),B=f-c,L=fs(i,B,0,!0),j;return L>0&&Math.abs(T-A)<360?j=gFe({cx:r,cy:a,innerRadius:c,outerRadius:f,cornerRadius:Math.min(L,B/2),forceCornerRadius:v,cornerIsExternal:b,startAngle:T,endAngle:A}):j=kQ({cx:r,cy:a,innerRadius:c,outerRadius:f,startAngle:T,endAngle:A}),Se.createElement("path",gL({},ir(n,!0),{className:R,d:j,role:"img"}))};function Kb(e){"@babel/helpers - typeof";return Kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kb(e)}function yL(){return yL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yL.apply(this,arguments)}function J8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Q8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?J8(Object(n),!0).forEach(function(r){_Fe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _Fe(e,t,n){return t=vFe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vFe(e){var t=xFe(e,"string");return Kb(t)=="symbol"?t:t+""}function xFe(e,t){if(Kb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Kb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eG={curveBasisClosed:mEe,curveBasisOpen:gEe,curveBasis:pEe,curveBumpX:eEe,curveBumpY:tEe,curveLinearClosed:yEe,curveLinear:wC,curveMonotoneX:_Ee,curveMonotoneY:vEe,curveNatural:xEe,curveStep:bEe,curveStepAfter:SEe,curveStepBefore:wEe},RE=function(t){return t.x===+t.x&&t.y===+t.y},n1=function(t){return t.x},r1=function(t){return t.y},bFe=function(t,n){if(Tr(t))return t;var r="curve".concat(vC(t));return(r==="curveMonotone"||r==="curveBump")&&n?eG["".concat(r).concat(n==="vertical"?"Y":"X")]:eG[r]||wC},wFe=function(t){var n=t.type,r=n===void 0?"linear":n,a=t.points,c=a===void 0?[]:a,f=t.baseLine,i=t.layout,v=t.connectNulls,b=v===void 0?!1:v,T=bFe(r,i),A=b?c.filter(function(L){return RE(L)}):c,M;if(Array.isArray(f)){var R=b?f.filter(function(L){return RE(L)}):f,B=A.map(function(L,j){return Q8(Q8({},L),{},{base:R[j]})});return i==="vertical"?M=wE().y(r1).x1(n1).x0(function(L){return L.base.x}):M=wE().x(n1).y1(r1).y0(function(L){return L.base.y}),M.defined(RE).curve(T),M(B)}return i==="vertical"&&wn(f)?M=wE().y(r1).x1(n1).x0(f):wn(f)?M=wE().x(n1).y1(r1).y0(f):M=TY().x(n1).y(r1),M.defined(RE).curve(T),M(A)},Tf=function(t){var n=t.className,r=t.points,a=t.path,c=t.pathRef;if((!r||!r.length)&&!a)return null;var f=r&&r.length?wFe(t):a;return Se.createElement("path",yL({},ir(t,!1),rA(t),{className:jr("recharts-curve",n),d:f,ref:c}))},DQ={exports:{}},SFe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",TFe=SFe,EFe=TFe;function LQ(){}function zQ(){}zQ.resetWarningCache=LQ;var AFe=function(){function e(r,a,c,f,i,v){if(v!==EFe){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:zQ,resetWarningCache:LQ};return n.PropTypes=n,n};DQ.exports=AFe();var PFe=DQ.exports;const Qr=Bi(PFe);var CFe=Object.getOwnPropertyNames,IFe=Object.getOwnPropertySymbols,MFe=Object.prototype.hasOwnProperty;function tG(e,t){return function(r,a,c){return e(r,a,c)&&t(r,a,c)}}function DE(e){return function(n,r,a){if(!n||!r||typeof n!="object"||typeof r!="object")return e(n,r,a);var c=a.cache,f=c.get(n),i=c.get(r);if(f&&i)return f===r&&i===n;c.set(n,r),c.set(r,n);var v=e(n,r,a);return c.delete(n),c.delete(r),v}}function nG(e){return CFe(e).concat(IFe(e))}var NQ=Object.hasOwn||function(e,t){return MFe.call(e,t)};function jv(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var FQ="_owner",rG=Object.getOwnPropertyDescriptor,iG=Object.keys;function OFe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function kFe(e,t){return jv(e.getTime(),t.getTime())}function oG(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),c=0,f,i;(f=a.next())&&!f.done;){for(var v=t.entries(),b=!1,T=0;(i=v.next())&&!i.done;){var A=f.value,M=A[0],R=A[1],B=i.value,L=B[0],j=B[1];!b&&!r[T]&&(b=n.equals(M,L,c,T,e,t,n)&&n.equals(R,j,M,L,e,t,n))&&(r[T]=!0),T++}if(!b)return!1;c++}return!0}function RFe(e,t,n){var r=iG(e),a=r.length;if(iG(t).length!==a)return!1;for(var c;a-- >0;)if(c=r[a],c===FQ&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!NQ(t,c)||!n.equals(e[c],t[c],c,c,e,t,n))return!1;return!0}function i1(e,t,n){var r=nG(e),a=r.length;if(nG(t).length!==a)return!1;for(var c,f,i;a-- >0;)if(c=r[a],c===FQ&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!NQ(t,c)||!n.equals(e[c],t[c],c,c,e,t,n)||(f=rG(e,c),i=rG(t,c),(f||i)&&(!f||!i||f.configurable!==i.configurable||f.enumerable!==i.enumerable||f.writable!==i.writable)))return!1;return!0}function DFe(e,t){return jv(e.valueOf(),t.valueOf())}function LFe(e,t){return e.source===t.source&&e.flags===t.flags}function aG(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),c,f;(c=a.next())&&!c.done;){for(var i=t.values(),v=!1,b=0;(f=i.next())&&!f.done;)!v&&!r[b]&&(v=n.equals(c.value,f.value,c.value,f.value,e,t,n))&&(r[b]=!0),b++;if(!v)return!1}return!0}function zFe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var NFe="[object Arguments]",FFe="[object Boolean]",BFe="[object Date]",jFe="[object Map]",$Fe="[object Number]",UFe="[object Object]",VFe="[object RegExp]",GFe="[object Set]",WFe="[object String]",HFe=Array.isArray,sG=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,lG=Object.assign,qFe=Object.prototype.toString.call.bind(Object.prototype.toString);function ZFe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,f=e.areRegExpsEqual,i=e.areSetsEqual,v=e.areTypedArraysEqual;return function(T,A,M){if(T===A)return!0;if(T==null||A==null||typeof T!="object"||typeof A!="object")return T!==T&&A!==A;var R=T.constructor;if(R!==A.constructor)return!1;if(R===Object)return a(T,A,M);if(HFe(T))return t(T,A,M);if(sG!=null&&sG(T))return v(T,A,M);if(R===Date)return n(T,A,M);if(R===RegExp)return f(T,A,M);if(R===Map)return r(T,A,M);if(R===Set)return i(T,A,M);var B=qFe(T);return B===BFe?n(T,A,M):B===VFe?f(T,A,M):B===jFe?r(T,A,M):B===GFe?i(T,A,M):B===UFe?typeof T.then!="function"&&typeof A.then!="function"&&a(T,A,M):B===NFe?a(T,A,M):B===FFe||B===$Fe||B===WFe?c(T,A,M):!1}}function XFe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?i1:OFe,areDatesEqual:kFe,areMapsEqual:r?tG(oG,i1):oG,areObjectsEqual:r?i1:RFe,arePrimitiveWrappersEqual:DFe,areRegExpsEqual:LFe,areSetsEqual:r?tG(aG,i1):aG,areTypedArraysEqual:r?i1:zFe};if(n&&(a=lG({},a,n(a))),t){var c=DE(a.areArraysEqual),f=DE(a.areMapsEqual),i=DE(a.areObjectsEqual),v=DE(a.areSetsEqual);a=lG({},a,{areArraysEqual:c,areMapsEqual:f,areObjectsEqual:i,areSetsEqual:v})}return a}function KFe(e){return function(t,n,r,a,c,f,i){return e(t,n,i)}}function YFe(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,c=e.strict;if(r)return function(v,b){var T=r(),A=T.cache,M=A===void 0?t?new WeakMap:void 0:A,R=T.meta;return n(v,b,{cache:M,equals:a,meta:R,strict:c})};if(t)return function(v,b){return n(v,b,{cache:new WeakMap,equals:a,meta:void 0,strict:c})};var f={cache:void 0,equals:a,meta:void 0,strict:c};return function(v,b){return n(v,b,f)}}var JFe=Yf();Yf({strict:!0});Yf({circular:!0});Yf({circular:!0,strict:!0});Yf({createInternalComparator:function(){return jv}});Yf({strict:!0,createInternalComparator:function(){return jv}});Yf({circular:!0,createInternalComparator:function(){return jv}});Yf({circular:!0,createInternalComparator:function(){return jv},strict:!0});function Yf(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,c=e.strict,f=c===void 0?!1:c,i=XFe(e),v=ZFe(i),b=r?r(v):KFe(v);return YFe({circular:n,comparator:v,createState:a,equals:b,strict:f})}function QFe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function cG(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(c){n<0&&(n=c),c-n>t?(e(c),n=-1):QFe(a)};requestAnimationFrame(r)}function _L(e){"@babel/helpers - typeof";return _L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_L(e)}function eBe(e){return iBe(e)||rBe(e)||nBe(e)||tBe()}function tBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nBe(e,t){if(e){if(typeof e=="string")return uG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uG(e,t)}}function uG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iBe(e){if(Array.isArray(e))return e}function oBe(){var e={},t=function(){return null},n=!1,r=function a(c){if(!n){if(Array.isArray(c)){if(!c.length)return;var f=c,i=eBe(f),v=i[0],b=i.slice(1);if(typeof v=="number"){cG(a.bind(null,b),v);return}a(v),cG(a.bind(null,b));return}_L(c)==="object"&&(e=c,t(e)),typeof c=="function"&&c()}};return{stop:function(){n=!0},start:function(c){n=!1,r(c)},subscribe:function(c){return t=c,function(){t=function(){return null}}}}}function Yb(e){"@babel/helpers - typeof";return Yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yb(e)}function hG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hG(Object(n),!0).forEach(function(r){BQ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function BQ(e,t,n){return t=aBe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aBe(e){var t=sBe(e,"string");return Yb(t)==="symbol"?t:String(t)}function sBe(e,t){if(Yb(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Yb(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lBe=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(r,a){return r.filter(function(c){return a.includes(c)})})},cBe=function(t){return t},uBe=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},B1=function(t,n){return Object.keys(n).reduce(function(r,a){return dG(dG({},r),{},BQ({},a,t(a,n[a])))},{})},fG=function(t,n,r){return t.map(function(a){return"".concat(uBe(a)," ").concat(n,"ms ").concat(r)}).join(",")};function hBe(e,t){return pBe(e)||fBe(e,t)||jQ(e,t)||dBe()}function dBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fBe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function pBe(e){if(Array.isArray(e))return e}function mBe(e){return _Be(e)||yBe(e)||jQ(e)||gBe()}function gBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jQ(e,t){if(e){if(typeof e=="string")return vL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vL(e,t)}}function yBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Be(e){if(Array.isArray(e))return vL(e)}function vL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var kA=1e-4,$Q=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},UQ=function(t,n){return t.map(function(r,a){return r*Math.pow(n,a)}).reduce(function(r,a){return r+a})},pG=function(t,n){return function(r){var a=$Q(t,n);return UQ(a,r)}},vBe=function(t,n){return function(r){var a=$Q(t,n),c=[].concat(mBe(a.map(function(f,i){return f*i}).slice(1)),[0]);return UQ(c,r)}},mG=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[0],c=n[1],f=n[2],i=n[3];if(n.length===1)switch(n[0]){case"linear":a=0,c=0,f=1,i=1;break;case"ease":a=.25,c=.1,f=.25,i=1;break;case"ease-in":a=.42,c=0,f=1,i=1;break;case"ease-out":a=.42,c=0,f=.58,i=1;break;case"ease-in-out":a=0,c=0,f=.58,i=1;break;default:{var v=n[0].split("(");if(v[0]==="cubic-bezier"&&v[1].split(")")[0].split(",").length===4){var b=v[1].split(")")[0].split(",").map(function(j){return parseFloat(j)}),T=hBe(b,4);a=T[0],c=T[1],f=T[2],i=T[3]}}}var A=pG(a,f),M=pG(c,i),R=vBe(a,f),B=function(V){return V>1?1:V<0?0:V},L=function(V){for(var $=V>1?1:V,H=$,K=0;K<8;++K){var Y=A(H)-$,se=R(H);if(Math.abs(Y-$)<kA||se<kA)return M(H);H=B(H-Y/se)}return M(H)};return L.isStepper=!1,L},xBe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,r=n===void 0?100:n,a=t.damping,c=a===void 0?8:a,f=t.dt,i=f===void 0?17:f,v=function(T,A,M){var R=-(T-A)*r,B=M*c,L=M+(R-B)*i/1e3,j=M*i/1e3+T;return Math.abs(j-A)<kA&&Math.abs(L)<kA?[A,0]:[j,L]};return v.isStepper=!0,v.dt=i,v},bBe=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return mG(a);case"spring":return xBe();default:if(a.split("(")[0]==="cubic-bezier")return mG(a)}return typeof a=="function"?a:null};function Jb(e){"@babel/helpers - typeof";return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jb(e)}function gG(e){return TBe(e)||SBe(e)||VQ(e)||wBe()}function wBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TBe(e){if(Array.isArray(e))return bL(e)}function yG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ia(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yG(Object(n),!0).forEach(function(r){xL(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xL(e,t,n){return t=EBe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EBe(e){var t=ABe(e,"string");return Jb(t)==="symbol"?t:String(t)}function ABe(e,t){if(Jb(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Jb(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PBe(e,t){return MBe(e)||IBe(e,t)||VQ(e,t)||CBe()}function CBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VQ(e,t){if(e){if(typeof e=="string")return bL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bL(e,t)}}function bL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function IBe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function MBe(e){if(Array.isArray(e))return e}var RA=function(t,n,r){return t+(n-t)*r},wL=function(t){var n=t.from,r=t.to;return n!==r},OBe=function e(t,n,r){var a=B1(function(c,f){if(wL(f)){var i=t(f.from,f.to,f.velocity),v=PBe(i,2),b=v[0],T=v[1];return Ia(Ia({},f),{},{from:b,velocity:T})}return f},n);return r<1?B1(function(c,f){return wL(f)?Ia(Ia({},f),{},{velocity:RA(f.velocity,a[c].velocity,r),from:RA(f.from,a[c].from,r)}):f},n):e(t,a,r-1)};const kBe=function(e,t,n,r,a){var c=lBe(e,t),f=c.reduce(function(j,V){return Ia(Ia({},j),{},xL({},V,[e[V],t[V]]))},{}),i=c.reduce(function(j,V){return Ia(Ia({},j),{},xL({},V,{from:e[V],velocity:0,to:t[V]}))},{}),v=-1,b,T,A=function(){return null},M=function(){return B1(function(V,$){return $.from},i)},R=function(){return!Object.values(i).filter(wL).length},B=function(V){b||(b=V);var $=V-b,H=$/n.dt;i=OBe(n,i,H),a(Ia(Ia(Ia({},e),t),M())),b=V,R()||(v=requestAnimationFrame(A))},L=function(V){T||(T=V);var $=(V-T)/r,H=B1(function(Y,se){return RA.apply(void 0,gG(se).concat([n($)]))},f);if(a(Ia(Ia(Ia({},e),t),H)),$<1)v=requestAnimationFrame(A);else{var K=B1(function(Y,se){return RA.apply(void 0,gG(se).concat([n(1)]))},f);a(Ia(Ia(Ia({},e),t),K))}};return A=n.isStepper?B:L,function(){return requestAnimationFrame(A),function(){cancelAnimationFrame(v)}}};function W_(e){"@babel/helpers - typeof";return W_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W_(e)}var RBe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function DBe(e,t){if(e==null)return{};var n=LBe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LBe(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,c;for(c=0;c<r.length;c++)a=r[c],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function Nk(e){return BBe(e)||FBe(e)||NBe(e)||zBe()}function zBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NBe(e,t){if(e){if(typeof e=="string")return SL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SL(e,t)}}function FBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BBe(e){if(Array.isArray(e))return SL(e)}function SL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function pc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_G(Object(n),!0).forEach(function(r){g1(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_G(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function g1(e,t,n){return t=GQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,GQ(r.key),r)}}function UBe(e,t,n){return t&&$Be(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GQ(e){var t=VBe(e,"string");return W_(t)==="symbol"?t:String(t)}function VBe(e,t){if(W_(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(W_(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TL(e,t)}function TL(e,t){return TL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},TL(e,t)}function WBe(e){var t=HBe();return function(){var r=DA(e),a;if(t){var c=DA(this).constructor;a=Reflect.construct(r,arguments,c)}else a=r.apply(this,arguments);return EL(this,a)}}function EL(e,t){if(t&&(W_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AL(e)}function AL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function DA(e){return DA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},DA(e)}var Hl=function(e){GBe(n,e);var t=WBe(n);function n(r,a){var c;jBe(this,n),c=t.call(this,r,a);var f=c.props,i=f.isActive,v=f.attributeName,b=f.from,T=f.to,A=f.steps,M=f.children,R=f.duration;if(c.handleStyleChange=c.handleStyleChange.bind(AL(c)),c.changeStyle=c.changeStyle.bind(AL(c)),!i||R<=0)return c.state={style:{}},typeof M=="function"&&(c.state={style:T}),EL(c);if(A&&A.length)c.state={style:A[0].style};else if(b){if(typeof M=="function")return c.state={style:b},EL(c);c.state={style:v?g1({},v,b):b}}else c.state={style:{}};return c}return UBe(n,[{key:"componentDidMount",value:function(){var a=this.props,c=a.isActive,f=a.canBegin;this.mounted=!0,!(!c||!f)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var c=this.props,f=c.isActive,i=c.canBegin,v=c.attributeName,b=c.shouldReAnimate,T=c.to,A=c.from,M=this.state.style;if(i){if(!f){var R={style:v?g1({},v,T):T};this.state&&M&&(v&&M[v]!==T||!v&&M!==T)&&this.setState(R);return}if(!(JFe(a.to,T)&&a.canBegin&&a.isActive)){var B=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var L=B||b?A:a.to;if(this.state&&M){var j={style:v?g1({},v,L):L};(v&&M[v]!==L||!v&&M!==L)&&this.setState(j)}this.runAnimation(pc(pc({},this.props),{},{from:L,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var c=this,f=a.from,i=a.to,v=a.duration,b=a.easing,T=a.begin,A=a.onAnimationEnd,M=a.onAnimationStart,R=kBe(f,i,bBe(b),v,this.changeStyle),B=function(){c.stopJSAnimation=R()};this.manager.start([M,T,B,v,A])}},{key:"runStepAnimation",value:function(a){var c=this,f=a.steps,i=a.begin,v=a.onAnimationStart,b=f[0],T=b.style,A=b.duration,M=A===void 0?0:A,R=function(L,j,V){if(V===0)return L;var $=j.duration,H=j.easing,K=H===void 0?"ease":H,Y=j.style,se=j.properties,ce=j.onAnimationEnd,ye=V>0?f[V-1]:j,ze=se||Object.keys(Y);if(typeof K=="function"||K==="spring")return[].concat(Nk(L),[c.runJSAnimation.bind(c,{from:ye.style,to:Y,duration:$,easing:K}),$]);var Le=fG(ze,$,K),je=pc(pc(pc({},ye.style),Y),{},{transition:Le});return[].concat(Nk(L),[je,$,ce]).filter(cBe)};return this.manager.start([v].concat(Nk(f.reduce(R,[T,Math.max(M,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=oBe());var c=a.begin,f=a.duration,i=a.attributeName,v=a.to,b=a.easing,T=a.onAnimationStart,A=a.onAnimationEnd,M=a.steps,R=a.children,B=this.manager;if(this.unSubscribe=B.subscribe(this.handleStyleChange),typeof b=="function"||typeof R=="function"||b==="spring"){this.runJSAnimation(a);return}if(M.length>1){this.runStepAnimation(a);return}var L=i?g1({},i,v):v,j=fG(Object.keys(L),f,b);B.start([T,c,pc(pc({},L),{},{transition:j}),f,A])}},{key:"render",value:function(){var a=this.props,c=a.children;a.begin;var f=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var v=DBe(a,RBe),b=X.Children.count(c),T=this.state.style;if(typeof c=="function")return c(T);if(!i||b===0||f<=0)return c;var A=function(R){var B=R.props,L=B.style,j=L===void 0?{}:L,V=B.className,$=X.cloneElement(R,pc(pc({},v),{},{style:pc(pc({},j),T),className:V}));return $};return b===1?A(X.Children.only(c)):Se.createElement("div",null,X.Children.map(c,function(M){return A(M)}))}}]),n}(X.PureComponent);Hl.displayName="Animate";Hl.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Hl.propTypes={from:Qr.oneOfType([Qr.object,Qr.string]),to:Qr.oneOfType([Qr.object,Qr.string]),attributeName:Qr.string,duration:Qr.number,begin:Qr.number,easing:Qr.oneOfType([Qr.string,Qr.func]),steps:Qr.arrayOf(Qr.shape({duration:Qr.number.isRequired,style:Qr.object.isRequired,easing:Qr.oneOfType([Qr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Qr.func]),properties:Qr.arrayOf("string"),onAnimationEnd:Qr.func})),children:Qr.oneOfType([Qr.node,Qr.func]),isActive:Qr.bool,canBegin:Qr.bool,onAnimationEnd:Qr.func,shouldReAnimate:Qr.bool,onAnimationStart:Qr.func,onAnimationReStart:Qr.func};Qr.object,Qr.object,Qr.object,Qr.element;Qr.object,Qr.object,Qr.object,Qr.oneOfType([Qr.array,Qr.element]),Qr.any;function Qb(e){"@babel/helpers - typeof";return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}function LA(){return LA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},LA.apply(this,arguments)}function qBe(e,t){return YBe(e)||KBe(e,t)||XBe(e,t)||ZBe()}function ZBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XBe(e,t){if(e){if(typeof e=="string")return vG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vG(e,t)}}function vG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function KBe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function YBe(e){if(Array.isArray(e))return e}function xG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function bG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xG(Object(n),!0).forEach(function(r){JBe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function JBe(e,t,n){return t=QBe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QBe(e){var t=eje(e,"string");return Qb(t)=="symbol"?t:t+""}function eje(e,t){if(Qb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Qb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wG=function(t,n,r,a,c){var f=Math.min(Math.abs(r)/2,Math.abs(a)/2),i=a>=0?1:-1,v=r>=0?1:-1,b=a>=0&&r>=0||a<0&&r<0?1:0,T;if(f>0&&c instanceof Array){for(var A=[0,0,0,0],M=0,R=4;M<R;M++)A[M]=c[M]>f?f:c[M];T="M".concat(t,",").concat(n+i*A[0]),A[0]>0&&(T+="A ".concat(A[0],",").concat(A[0],",0,0,").concat(b,",").concat(t+v*A[0],",").concat(n)),T+="L ".concat(t+r-v*A[1],",").concat(n),A[1]>0&&(T+="A ".concat(A[1],",").concat(A[1],",0,0,").concat(b,`,
        `).concat(t+r,",").concat(n+i*A[1])),T+="L ".concat(t+r,",").concat(n+a-i*A[2]),A[2]>0&&(T+="A ".concat(A[2],",").concat(A[2],",0,0,").concat(b,`,
        `).concat(t+r-v*A[2],",").concat(n+a)),T+="L ".concat(t+v*A[3],",").concat(n+a),A[3]>0&&(T+="A ".concat(A[3],",").concat(A[3],",0,0,").concat(b,`,
        `).concat(t,",").concat(n+a-i*A[3])),T+="Z"}else if(f>0&&c===+c&&c>0){var B=Math.min(f,c);T="M ".concat(t,",").concat(n+i*B,`
            A `).concat(B,",").concat(B,",0,0,").concat(b,",").concat(t+v*B,",").concat(n,`
            L `).concat(t+r-v*B,",").concat(n,`
            A `).concat(B,",").concat(B,",0,0,").concat(b,",").concat(t+r,",").concat(n+i*B,`
            L `).concat(t+r,",").concat(n+a-i*B,`
            A `).concat(B,",").concat(B,",0,0,").concat(b,",").concat(t+r-v*B,",").concat(n+a,`
            L `).concat(t+v*B,",").concat(n+a,`
            A `).concat(B,",").concat(B,",0,0,").concat(b,",").concat(t,",").concat(n+a-i*B," Z")}else T="M ".concat(t,",").concat(n," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return T},tje=function(t,n){if(!t||!n)return!1;var r=t.x,a=t.y,c=n.x,f=n.y,i=n.width,v=n.height;if(Math.abs(i)>0&&Math.abs(v)>0){var b=Math.min(c,c+i),T=Math.max(c,c+i),A=Math.min(f,f+v),M=Math.max(f,f+v);return r>=b&&r<=T&&a>=A&&a<=M}return!1},nje={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hF=function(t){var n=bG(bG({},nje),t),r=X.useRef(),a=X.useState(-1),c=qBe(a,2),f=c[0],i=c[1];X.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var K=r.current.getTotalLength();K&&i(K)}catch{}},[]);var v=n.x,b=n.y,T=n.width,A=n.height,M=n.radius,R=n.className,B=n.animationEasing,L=n.animationDuration,j=n.animationBegin,V=n.isAnimationActive,$=n.isUpdateAnimationActive;if(v!==+v||b!==+b||T!==+T||A!==+A||T===0||A===0)return null;var H=jr("recharts-rectangle",R);return $?Se.createElement(Hl,{canBegin:f>0,from:{width:T,height:A,x:v,y:b},to:{width:T,height:A,x:v,y:b},duration:L,animationEasing:B,isActive:$},function(K){var Y=K.width,se=K.height,ce=K.x,ye=K.y;return Se.createElement(Hl,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:j,duration:L,isActive:V,easing:B},Se.createElement("path",LA({},ir(n,!0),{className:H,d:wG(ce,ye,Y,se,M),ref:r})))}):Se.createElement("path",LA({},ir(n,!0),{className:H,d:wG(v,b,T,A,M)}))},rje=["points","className","baseLinePoints","connectNulls"];function e_(){return e_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e_.apply(this,arguments)}function ije(e,t){if(e==null)return{};var n=oje(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function SG(e){return cje(e)||lje(e)||sje(e)||aje()}function aje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sje(e,t){if(e){if(typeof e=="string")return PL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PL(e,t)}}function lje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cje(e){if(Array.isArray(e))return PL(e)}function PL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var TG=function(t){return t&&t.x===+t.x&&t.y===+t.y},uje=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return t.forEach(function(r){TG(r)?n[n.length-1].push(r):n[n.length-1].length>0&&n.push([])}),TG(t[0])&&n[n.length-1].push(t[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},j1=function(t,n){var r=uje(t);n&&(r=[r.reduce(function(c,f){return[].concat(SG(c),SG(f))},[])]);var a=r.map(function(c){return c.reduce(function(f,i,v){return"".concat(f).concat(v===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return r.length===1?"".concat(a,"Z"):a},hje=function(t,n,r){var a=j1(t,r);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(j1(n.reverse(),r).slice(1))},dje=function(t){var n=t.points,r=t.className,a=t.baseLinePoints,c=t.connectNulls,f=ije(t,rje);if(!n||!n.length)return null;var i=jr("recharts-polygon",r);if(a&&a.length){var v=f.stroke&&f.stroke!=="none",b=hje(n,a,c);return Se.createElement("g",{className:i},Se.createElement("path",e_({},ir(f,!0),{fill:b.slice(-1)==="Z"?f.fill:"none",stroke:"none",d:b})),v?Se.createElement("path",e_({},ir(f,!0),{fill:"none",d:j1(n,c)})):null,v?Se.createElement("path",e_({},ir(f,!0),{fill:"none",d:j1(a,c)})):null)}var T=j1(n,c);return Se.createElement("path",e_({},ir(f,!0),{fill:T.slice(-1)==="Z"?f.fill:"none",className:i,d:T}))};function CL(){return CL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CL.apply(this,arguments)}var Gw=function(t){var n=t.cx,r=t.cy,a=t.r,c=t.className,f=jr("recharts-dot",c);return n===+n&&r===+r&&a===+a?Se.createElement("circle",CL({},ir(t,!1),rA(t),{className:f,cx:n,cy:r,r:a})):null};function ew(e){"@babel/helpers - typeof";return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(e)}var fje=["x","y","top","left","width","height","className"];function IL(){return IL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},IL.apply(this,arguments)}function EG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function pje(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EG(Object(n),!0).forEach(function(r){mje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mje(e,t,n){return t=gje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gje(e){var t=yje(e,"string");return ew(t)=="symbol"?t:t+""}function yje(e,t){if(ew(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ew(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _je(e,t){if(e==null)return{};var n=vje(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var xje=function(t,n,r,a,c,f){return"M".concat(t,",").concat(c,"v").concat(a,"M").concat(f,",").concat(n,"h").concat(r)},bje=function(t){var n=t.x,r=n===void 0?0:n,a=t.y,c=a===void 0?0:a,f=t.top,i=f===void 0?0:f,v=t.left,b=v===void 0?0:v,T=t.width,A=T===void 0?0:T,M=t.height,R=M===void 0?0:M,B=t.className,L=_je(t,fje),j=pje({x:r,y:c,top:i,left:b,width:A,height:R},L);return!wn(r)||!wn(c)||!wn(A)||!wn(R)||!wn(i)||!wn(b)?null:Se.createElement("path",IL({},ir(j,!0),{className:jr("recharts-cross",B),d:xje(r,c,A,R,i,b)}))},wje=LC,Sje=tQ,Tje=Iu;function Eje(e,t){return e&&e.length?wje(e,Tje(t),Sje):void 0}var Aje=Eje;const Pje=Bi(Aje);var Cje=LC,Ije=Iu,Mje=nQ;function Oje(e,t){return e&&e.length?Cje(e,Ije(t),Mje):void 0}var kje=Oje;const Rje=Bi(kje);var Dje=["cx","cy","angle","ticks","axisLine"],Lje=["ticks","tick","angle","tickFormatter","stroke"];function H_(e){"@babel/helpers - typeof";return H_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H_(e)}function $1(){return $1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$1.apply(this,arguments)}function AG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Qp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AG(Object(n),!0).forEach(function(r){BC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PG(e,t){if(e==null)return{};var n=zje(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Nje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,HQ(r.key),r)}}function Fje(e,t,n){return t&&CG(e.prototype,t),n&&CG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bje(e,t,n){return t=zA(t),jje(e,WQ()?Reflect.construct(t,n||[],zA(e).constructor):t.apply(e,n))}function jje(e,t){if(t&&(H_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $je(e)}function $je(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WQ=function(){return!!e})()}function zA(e){return zA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},zA(e)}function Uje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ML(e,t)}function ML(e,t){return ML=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},ML(e,t)}function BC(e,t,n){return t=HQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HQ(e){var t=Vje(e,"string");return H_(t)=="symbol"?t:t+""}function Vje(e,t){if(H_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(H_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jC=function(e){function t(){return Nje(this,t),Bje(this,t,arguments)}return Uje(t,e),Fje(t,[{key:"getTickValueCoord",value:function(r){var a=r.coordinate,c=this.props,f=c.angle,i=c.cx,v=c.cy;return oo(i,v,a,f)}},{key:"getTickTextAnchor",value:function(){var r=this.props.orientation,a;switch(r){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var r=this.props,a=r.cx,c=r.cy,f=r.angle,i=r.ticks,v=Pje(i,function(T){return T.coordinate||0}),b=Rje(i,function(T){return T.coordinate||0});return{cx:a,cy:c,startAngle:f,endAngle:f,innerRadius:b.coordinate||0,outerRadius:v.coordinate||0}}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.cx,c=r.cy,f=r.angle,i=r.ticks,v=r.axisLine,b=PG(r,Dje),T=i.reduce(function(B,L){return[Math.min(B[0],L.coordinate),Math.max(B[1],L.coordinate)]},[1/0,-1/0]),A=oo(a,c,T[0],f),M=oo(a,c,T[1],f),R=Qp(Qp(Qp({},ir(b,!1)),{},{fill:"none"},ir(v,!1)),{},{x1:A.x,y1:A.y,x2:M.x,y2:M.y});return Se.createElement("line",$1({className:"recharts-polar-radius-axis-line"},R))}},{key:"renderTicks",value:function(){var r=this,a=this.props,c=a.ticks,f=a.tick,i=a.angle,v=a.tickFormatter,b=a.stroke,T=PG(a,Lje),A=this.getTickTextAnchor(),M=ir(T,!1),R=ir(f,!1),B=c.map(function(L,j){var V=r.getTickValueCoord(L),$=Qp(Qp(Qp(Qp({textAnchor:A,transform:"rotate(".concat(90-i,", ").concat(V.x,", ").concat(V.y,")")},M),{},{stroke:"none",fill:b},R),{},{index:j},V),{},{payload:L});return Se.createElement(Wr,$1({className:jr("recharts-polar-radius-axis-tick",MQ(f)),key:"tick-".concat(L.coordinate)},zf(r.props,L,j)),t.renderTickItem(f,$,v?v(L.value,j):L.value))});return Se.createElement(Wr,{className:"recharts-polar-radius-axis-ticks"},B)}},{key:"render",value:function(){var r=this.props,a=r.ticks,c=r.axisLine,f=r.tick;return!a||!a.length?null:Se.createElement(Wr,{className:jr("recharts-polar-radius-axis",this.props.className)},c&&this.renderAxisLine(),f&&this.renderTicks(),xa.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(r,a,c){var f;return Se.isValidElement(r)?f=Se.cloneElement(r,a):Tr(r)?f=r(a):f=Se.createElement(zm,$1({},a,{className:"recharts-polar-radius-axis-tick-value"}),c),f}}])}(X.PureComponent);BC(jC,"displayName","PolarRadiusAxis");BC(jC,"axisType","radiusAxis");BC(jC,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function q_(e){"@babel/helpers - typeof";return q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q_(e)}function cm(){return cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cm.apply(this,arguments)}function IG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function em(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IG(Object(n),!0).forEach(function(r){$C(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Gje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ZQ(r.key),r)}}function Wje(e,t,n){return t&&MG(e.prototype,t),n&&MG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hje(e,t,n){return t=NA(t),qje(e,qQ()?Reflect.construct(t,n||[],NA(e).constructor):t.apply(e,n))}function qje(e,t){if(t&&(q_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zje(e)}function Zje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qQ=function(){return!!e})()}function NA(e){return NA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},NA(e)}function Xje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OL(e,t)}function OL(e,t){return OL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},OL(e,t)}function $C(e,t,n){return t=ZQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZQ(e){var t=Kje(e,"string");return q_(t)=="symbol"?t:t+""}function Kje(e,t){if(q_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(q_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yje=Math.PI/180,OG=1e-5,UC=function(e){function t(){return Gje(this,t),Hje(this,t,arguments)}return Xje(t,e),Wje(t,[{key:"getTickLineCoord",value:function(r){var a=this.props,c=a.cx,f=a.cy,i=a.radius,v=a.orientation,b=a.tickSize,T=b||8,A=oo(c,f,i,r.coordinate),M=oo(c,f,i+(v==="inner"?-1:1)*T,r.coordinate);return{x1:A.x,y1:A.y,x2:M.x,y2:M.y}}},{key:"getTickTextAnchor",value:function(r){var a=this.props.orientation,c=Math.cos(-r.coordinate*Yje),f;return c>OG?f=a==="outer"?"start":"end":c<-OG?f=a==="outer"?"end":"start":f="middle",f}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.cx,c=r.cy,f=r.radius,i=r.axisLine,v=r.axisLineType,b=em(em({},ir(this.props,!1)),{},{fill:"none"},ir(i,!1));if(v==="circle")return Se.createElement(Gw,cm({className:"recharts-polar-angle-axis-line"},b,{cx:a,cy:c,r:f}));var T=this.props.ticks,A=T.map(function(M){return oo(a,c,f,M.coordinate)});return Se.createElement(dje,cm({className:"recharts-polar-angle-axis-line"},b,{points:A}))}},{key:"renderTicks",value:function(){var r=this,a=this.props,c=a.ticks,f=a.tick,i=a.tickLine,v=a.tickFormatter,b=a.stroke,T=ir(this.props,!1),A=ir(f,!1),M=em(em({},T),{},{fill:"none"},ir(i,!1)),R=c.map(function(B,L){var j=r.getTickLineCoord(B),V=r.getTickTextAnchor(B),$=em(em(em({textAnchor:V},T),{},{stroke:"none",fill:b},A),{},{index:L,payload:B,x:j.x2,y:j.y2});return Se.createElement(Wr,cm({className:jr("recharts-polar-angle-axis-tick",MQ(f)),key:"tick-".concat(B.coordinate)},zf(r.props,B,L)),i&&Se.createElement("line",cm({className:"recharts-polar-angle-axis-tick-line"},M,j)),f&&t.renderTickItem(f,$,v?v(B.value,L):B.value))});return Se.createElement(Wr,{className:"recharts-polar-angle-axis-ticks"},R)}},{key:"render",value:function(){var r=this.props,a=r.ticks,c=r.radius,f=r.axisLine;return c<=0||!a||!a.length?null:Se.createElement(Wr,{className:jr("recharts-polar-angle-axis",this.props.className)},f&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(r,a,c){var f;return Se.isValidElement(r)?f=Se.cloneElement(r,a):Tr(r)?f=r(a):f=Se.createElement(zm,cm({},a,{className:"recharts-polar-angle-axis-tick-value"}),c),f}}])}(X.PureComponent);$C(UC,"displayName","PolarAngleAxis");$C(UC,"axisType","angleAxis");$C(UC,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var Jje=ZY,Qje=Jje(Object.getPrototypeOf,Object),e4e=Qje,t4e=Vh,n4e=e4e,r4e=Gh,i4e="[object Object]",o4e=Function.prototype,a4e=Object.prototype,XQ=o4e.toString,s4e=a4e.hasOwnProperty,l4e=XQ.call(Object);function c4e(e){if(!r4e(e)||t4e(e)!=i4e)return!1;var t=n4e(e);if(t===null)return!0;var n=s4e.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&XQ.call(n)==l4e}var u4e=c4e;const h4e=Bi(u4e);var d4e=Vh,f4e=Gh,p4e="[object Boolean]";function m4e(e){return e===!0||e===!1||f4e(e)&&d4e(e)==p4e}var g4e=m4e;const y4e=Bi(g4e);function tw(e){"@babel/helpers - typeof";return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}function FA(){return FA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FA.apply(this,arguments)}function _4e(e,t){return w4e(e)||b4e(e,t)||x4e(e,t)||v4e()}function v4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x4e(e,t){if(e){if(typeof e=="string")return kG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kG(e,t)}}function kG(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b4e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function w4e(e){if(Array.isArray(e))return e}function RG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function DG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RG(Object(n),!0).forEach(function(r){S4e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function S4e(e,t,n){return t=T4e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T4e(e){var t=E4e(e,"string");return tw(t)=="symbol"?t:t+""}function E4e(e,t){if(tw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(tw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LG=function(t,n,r,a,c){var f=r-a,i;return i="M ".concat(t,",").concat(n),i+="L ".concat(t+r,",").concat(n),i+="L ".concat(t+r-f/2,",").concat(n+c),i+="L ".concat(t+r-f/2-a,",").concat(n+c),i+="L ".concat(t,",").concat(n," Z"),i},A4e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},P4e=function(t){var n=DG(DG({},A4e),t),r=X.useRef(),a=X.useState(-1),c=_4e(a,2),f=c[0],i=c[1];X.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var H=r.current.getTotalLength();H&&i(H)}catch{}},[]);var v=n.x,b=n.y,T=n.upperWidth,A=n.lowerWidth,M=n.height,R=n.className,B=n.animationEasing,L=n.animationDuration,j=n.animationBegin,V=n.isUpdateAnimationActive;if(v!==+v||b!==+b||T!==+T||A!==+A||M!==+M||T===0&&A===0||M===0)return null;var $=jr("recharts-trapezoid",R);return V?Se.createElement(Hl,{canBegin:f>0,from:{upperWidth:0,lowerWidth:0,height:M,x:v,y:b},to:{upperWidth:T,lowerWidth:A,height:M,x:v,y:b},duration:L,animationEasing:B,isActive:V},function(H){var K=H.upperWidth,Y=H.lowerWidth,se=H.height,ce=H.x,ye=H.y;return Se.createElement(Hl,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:j,duration:L,easing:B},Se.createElement("path",FA({},ir(n,!0),{className:$,d:LG(ce,ye,K,Y,se),ref:r})))}):Se.createElement("g",null,Se.createElement("path",FA({},ir(n,!0),{className:$,d:LG(v,b,T,A,M)})))},C4e=["option","shapeType","propTransformer","activeClassName","isActive"];function nw(e){"@babel/helpers - typeof";return nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nw(e)}function I4e(e,t){if(e==null)return{};var n=M4e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function M4e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function zG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function BA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zG(Object(n),!0).forEach(function(r){O4e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function O4e(e,t,n){return t=k4e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k4e(e){var t=R4e(e,"string");return nw(t)=="symbol"?t:t+""}function R4e(e,t){if(nw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(nw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D4e(e,t){return BA(BA({},t),e)}function L4e(e,t){return e==="symbols"}function NG(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return Se.createElement(hF,n);case"trapezoid":return Se.createElement(P4e,n);case"sector":return Se.createElement(RQ,n);case"symbols":if(L4e(t))return Se.createElement(TC,n);break;default:return null}}function z4e(e){return X.isValidElement(e)?e.props:e}function jA(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?D4e:r,c=e.activeClassName,f=c===void 0?"recharts-active-shape":c,i=e.isActive,v=I4e(e,C4e),b;if(X.isValidElement(t))b=X.cloneElement(t,BA(BA({},v),z4e(t)));else if(Tr(t))b=t(v);else if(h4e(t)&&!y4e(t)){var T=a(t,v);b=Se.createElement(NG,{shapeType:n,elementProps:T})}else{var A=v;b=Se.createElement(NG,{shapeType:n,elementProps:A})}return i?Se.createElement(Wr,{className:f},b):b}function VC(e,t){return t!=null&&"trapezoids"in e.props}function GC(e,t){return t!=null&&"sectors"in e.props}function rw(e,t){return t!=null&&"points"in e.props}function N4e(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,c=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&c}function F4e(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function B4e(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function j4e(e,t){var n;return VC(e,t)?n=N4e:GC(e,t)?n=F4e:rw(e,t)&&(n=B4e),n}function $4e(e,t){var n;return VC(e,t)?n="trapezoids":GC(e,t)?n="sectors":rw(e,t)&&(n="points"),n}function U4e(e,t){if(VC(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(GC(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return rw(e,t)?t.payload:{}}function V4e(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=$4e(n,t),c=U4e(n,t),f=r.filter(function(v,b){var T=Ff(c,v),A=n.props[a].filter(function(B){var L=j4e(n,t);return L(B,t)}),M=n.props[a].indexOf(A[A.length-1]),R=b===M;return T&&R}),i=r.indexOf(f[f.length-1]);return i}var t2;function Z_(e){"@babel/helpers - typeof";return Z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z_(e)}function t_(){return t_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t_.apply(this,arguments)}function FG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ro(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FG(Object(n),!0).forEach(function(r){Nl(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function G4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,YQ(r.key),r)}}function W4e(e,t,n){return t&&BG(e.prototype,t),n&&BG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function H4e(e,t,n){return t=$A(t),q4e(e,KQ()?Reflect.construct(t,n||[],$A(e).constructor):t.apply(e,n))}function q4e(e,t){if(t&&(Z_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z4e(e)}function Z4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KQ=function(){return!!e})()}function $A(e){return $A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},$A(e)}function X4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kL(e,t)}function kL(e,t){return kL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},kL(e,t)}function Nl(e,t,n){return t=YQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YQ(e){var t=K4e(e,"string");return Z_(t)=="symbol"?t:t+""}function K4e(e,t){if(Z_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Z_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jf=function(e){function t(n){var r;return G4e(this,t),r=H4e(this,t,[n]),Nl(r,"pieRef",null),Nl(r,"sectorRefs",[]),Nl(r,"id",Zf("recharts-pie-")),Nl(r,"handleAnimationEnd",function(){var a=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Tr(a)&&a()}),Nl(r,"handleAnimationStart",function(){var a=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Tr(a)&&a()}),r.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},r}return X4e(t,e),W4e(t,[{key:"isActiveIndex",value:function(r){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(r)!==-1:r===a}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var c=this.props,f=c.label,i=c.labelLine,v=c.dataKey,b=c.valueKey,T=ir(this.props,!1),A=ir(f,!1),M=ir(i,!1),R=f&&f.offsetRadius||20,B=r.map(function(L,j){var V=(L.startAngle+L.endAngle)/2,$=oo(L.cx,L.cy,L.outerRadius+R,V),H=ro(ro(ro(ro({},T),L),{},{stroke:"none"},A),{},{index:j,textAnchor:t.getTextAnchor($.x,L.cx)},$),K=ro(ro(ro(ro({},T),L),{},{fill:"none",stroke:L.fill},M),{},{index:j,points:[oo(L.cx,L.cy,L.outerRadius,V),$]}),Y=v;return xr(v)&&xr(b)?Y="value":xr(v)&&(Y=b),Se.createElement(Wr,{key:"label-".concat(L.startAngle,"-").concat(L.endAngle,"-").concat(L.midAngle,"-").concat(j)},i&&t.renderLabelLineItem(i,K,"line"),t.renderLabelItem(f,H,fo(L,Y)))});return Se.createElement(Wr,{className:"recharts-pie-labels"},B)}},{key:"renderSectorsStatically",value:function(r){var a=this,c=this.props,f=c.activeShape,i=c.blendStroke,v=c.inactiveShape;return r.map(function(b,T){if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&r.length!==1)return null;var A=a.isActiveIndex(T),M=v&&a.hasActiveIndex()?v:null,R=A?f:M,B=ro(ro({},b),{},{stroke:i?b.fill:b.stroke,tabIndex:-1});return Se.createElement(Wr,t_({ref:function(j){j&&!a.sectorRefs.includes(j)&&a.sectorRefs.push(j)},tabIndex:-1,className:"recharts-pie-sector"},zf(a.props,b,T),{key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(T)}),Se.createElement(jA,t_({option:R,isActive:A,shapeType:"sector"},B)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,a=this.props,c=a.sectors,f=a.isAnimationActive,i=a.animationBegin,v=a.animationDuration,b=a.animationEasing,T=a.animationId,A=this.state,M=A.prevSectors,R=A.prevIsAnimationActive;return Se.createElement(Hl,{begin:i,duration:v,isActive:f,easing:b,from:{t:0},to:{t:1},key:"pie-".concat(T,"-").concat(R),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(B){var L=B.t,j=[],V=c&&c[0],$=V.startAngle;return c.forEach(function(H,K){var Y=M&&M[K],se=K>0?yl(H,"paddingAngle",0):0;if(Y){var ce=Ao(Y.endAngle-Y.startAngle,H.endAngle-H.startAngle),ye=ro(ro({},H),{},{startAngle:$+se,endAngle:$+ce(L)+se});j.push(ye),$=ye.endAngle}else{var ze=H.endAngle,Le=H.startAngle,je=Ao(0,ze-Le),Re=je(L),$e=ro(ro({},H),{},{startAngle:$+se,endAngle:$+Re+se});j.push($e),$=$e.endAngle}}),Se.createElement(Wr,null,r.renderSectorsStatically(j))})}},{key:"attachKeyboardHandlers",value:function(r){var a=this;r.onkeydown=function(c){if(!c.altKey)switch(c.key){case"ArrowLeft":{var f=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[f].focus(),a.setState({sectorToFocus:f});break}case"ArrowRight":{var i=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,a=r.sectors,c=r.isAnimationActive,f=this.state.prevSectors;return c&&a&&a.length&&(!f||!Ff(f,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,a=this.props,c=a.hide,f=a.sectors,i=a.className,v=a.label,b=a.cx,T=a.cy,A=a.innerRadius,M=a.outerRadius,R=a.isAnimationActive,B=this.state.isAnimationFinished;if(c||!f||!f.length||!wn(b)||!wn(T)||!wn(A)||!wn(M))return null;var L=jr("recharts-pie",i);return Se.createElement(Wr,{tabIndex:this.props.rootTabIndex,className:L,ref:function(V){r.pieRef=V}},this.renderSectors(),v&&this.renderLabels(f),xa.renderCallByParent(this.props,null,!1),(!R||B)&&kc.renderCallByParent(this.props,f,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return a.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:r.sectors!==a.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,a){return r>a?"start":r<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,a,c){if(Se.isValidElement(r))return Se.cloneElement(r,a);if(Tr(r))return r(a);var f=jr("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return Se.createElement(Tf,t_({},a,{key:c,type:"linear",className:f}))}},{key:"renderLabelItem",value:function(r,a,c){if(Se.isValidElement(r))return Se.cloneElement(r,a);var f=c;if(Tr(r)&&(f=r(a),Se.isValidElement(f)))return f;var i=jr("recharts-pie-label-text",typeof r!="boolean"&&!Tr(r)?r.className:"");return Se.createElement(zm,t_({},a,{alignmentBaseline:"middle",className:i}),f)}}])}(X.PureComponent);t2=Jf;Nl(Jf,"displayName","Pie");Nl(Jf,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Ul.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Nl(Jf,"parseDeltaAngle",function(e,t){var n=ds(t-e),r=Math.min(Math.abs(t-e),360);return n*r});Nl(Jf,"getRealPieData",function(e){var t=e.data,n=e.children,r=ir(e,!1),a=gs(n,CC);return t&&t.length?t.map(function(c,f){return ro(ro(ro({payload:c},r),c),a&&a[f]&&a[f].props)}):a&&a.length?a.map(function(c){return ro(ro({},r),c.props)}):[]});Nl(Jf,"parseCoordinateOfPie",function(e,t){var n=t.top,r=t.left,a=t.width,c=t.height,f=IQ(a,c),i=r+fs(e.cx,a,a/2),v=n+fs(e.cy,c,c/2),b=fs(e.innerRadius,f,0),T=fs(e.outerRadius,f,f*.8),A=e.maxRadius||Math.sqrt(a*a+c*c)/2;return{cx:i,cy:v,innerRadius:b,outerRadius:T,maxRadius:A}});Nl(Jf,"getComposedData",function(e){var t=e.item,n=e.offset,r=t.type.defaultProps!==void 0?ro(ro({},t.type.defaultProps),t.props):t.props,a=t2.getRealPieData(r);if(!a||!a.length)return null;var c=r.cornerRadius,f=r.startAngle,i=r.endAngle,v=r.paddingAngle,b=r.dataKey,T=r.nameKey,A=r.valueKey,M=r.tooltipType,R=Math.abs(r.minAngle),B=t2.parseCoordinateOfPie(r,n),L=t2.parseDeltaAngle(f,i),j=Math.abs(L),V=b;xr(b)&&xr(A)?(Oc(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),V="value"):xr(b)&&(Oc(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),V=A);var $=a.filter(function(ye){return fo(ye,V,0)!==0}).length,H=(j>=360?$:$-1)*v,K=j-$*R-H,Y=a.reduce(function(ye,ze){var Le=fo(ze,V,0);return ye+(wn(Le)?Le:0)},0),se;if(Y>0){var ce;se=a.map(function(ye,ze){var Le=fo(ye,V,0),je=fo(ye,T,ze),Re=(wn(Le)?Le:0)/Y,$e;ze?$e=ce.endAngle+ds(L)*v*(Le!==0?1:0):$e=f;var Ge=$e+ds(L)*((Le!==0?R:0)+Re*K),ht=($e+Ge)/2,ot=(B.innerRadius+B.outerRadius)/2,Je=[{name:je,value:Le,payload:ye,dataKey:V,type:M}],Ne=oo(B.cx,B.cy,ot,ht);return ce=ro(ro(ro({percent:Re,cornerRadius:c,name:je,tooltipPayload:Je,midAngle:ht,middleRadius:ot,tooltipPosition:Ne},ye),B),{},{value:fo(ye,V),startAngle:$e,endAngle:Ge,payload:ye,paddingAngle:ds(L)*v}),ce})}return ro(ro({},B),{},{sectors:se,data:a})});var Y4e=Math.ceil,J4e=Math.max;function Q4e(e,t,n,r){for(var a=-1,c=J4e(Y4e((t-e)/(n||1)),0),f=Array(c);c--;)f[r?c:++a]=e,e+=n;return f}var e$e=Q4e,t$e=fJ,jG=1/0,n$e=17976931348623157e292;function r$e(e){if(!e)return e===0?e:0;if(e=t$e(e),e===jG||e===-jG){var t=e<0?-1:1;return t*n$e}return e===e?e:0}var JQ=r$e,i$e=e$e,o$e=PC,Fk=JQ;function a$e(e){return function(t,n,r){return r&&typeof r!="number"&&o$e(t,n,r)&&(n=r=void 0),t=Fk(t),n===void 0?(n=t,t=0):n=Fk(n),r=r===void 0?t<n?1:-1:Fk(r),i$e(t,n,r,e)}}var s$e=a$e,l$e=s$e,c$e=l$e(),u$e=c$e;const UA=Bi(u$e);function iw(e){"@babel/helpers - typeof";return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(e)}function $G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function UG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$G(Object(n),!0).forEach(function(r){QQ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$G(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function QQ(e,t,n){return t=h$e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h$e(e){var t=d$e(e,"string");return iw(t)=="symbol"?t:t+""}function d$e(e,t){if(iw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(iw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f$e=["Webkit","Moz","O","ms"],p$e=function(t,n){var r=t.replace(/(\w)/,function(c){return c.toUpperCase()}),a=f$e.reduce(function(c,f){return UG(UG({},c),{},QQ({},f+r,n))},{});return a[t]=n,a};function X_(e){"@babel/helpers - typeof";return X_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X_(e)}function VA(){return VA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VA.apply(this,arguments)}function VG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Bk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VG(Object(n),!0).forEach(function(r){ll(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function m$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tee(r.key),r)}}function g$e(e,t,n){return t&&GG(e.prototype,t),n&&GG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function y$e(e,t,n){return t=GA(t),_$e(e,eee()?Reflect.construct(t,n||[],GA(e).constructor):t.apply(e,n))}function _$e(e,t){if(t&&(X_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v$e(e)}function v$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eee=function(){return!!e})()}function GA(e){return GA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},GA(e)}function x$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RL(e,t)}function RL(e,t){return RL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},RL(e,t)}function ll(e,t,n){return t=tee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tee(e){var t=b$e(e,"string");return X_(t)=="symbol"?t:t+""}function b$e(e,t){if(X_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(X_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w$e=function(t){var n=t.data,r=t.startIndex,a=t.endIndex,c=t.x,f=t.width,i=t.travellerWidth;if(!n||!n.length)return{};var v=n.length,b=N1().domain(UA(0,v)).range([c,c+f-i]),T=b.domain().map(function(A){return b(A)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:b(r),endX:b(a),scale:b,scaleValues:T}},WG=function(t){return t.changedTouches&&!!t.changedTouches.length},K_=function(e){function t(n){var r;return m$e(this,t),r=y$e(this,t,[n]),ll(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),ll(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),ll(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,c=a.endIndex,f=a.onDragEnd,i=a.startIndex;f==null||f({endIndex:c,startIndex:i})}),r.detachDragEndListener()}),ll(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),ll(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),ll(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),ll(r,"handleSlideDragStart",function(a){var c=WG(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:c.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return x$e(t,e),g$e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var a=r.startX,c=r.endX,f=this.state.scaleValues,i=this.props,v=i.gap,b=i.data,T=b.length-1,A=Math.min(a,c),M=Math.max(a,c),R=t.getIndexInRange(f,A),B=t.getIndexInRange(f,M);return{startIndex:R-R%v,endIndex:B===T?T:B-B%v}}},{key:"getTextOfTick",value:function(r){var a=this.props,c=a.data,f=a.tickFormatter,i=a.dataKey,v=fo(c[r],i,r);return Tr(f)?f(v,r):v}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var a=this.state,c=a.slideMoveStartX,f=a.startX,i=a.endX,v=this.props,b=v.x,T=v.width,A=v.travellerWidth,M=v.startIndex,R=v.endIndex,B=v.onChange,L=r.pageX-c;L>0?L=Math.min(L,b+T-A-i,b+T-A-f):L<0&&(L=Math.max(L,b-f,b-i));var j=this.getIndex({startX:f+L,endX:i+L});(j.startIndex!==M||j.endIndex!==R)&&B&&B(j),this.setState({startX:f+L,endX:i+L,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,a){var c=WG(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:c.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var a=this.state,c=a.brushMoveStartX,f=a.movingTravellerId,i=a.endX,v=a.startX,b=this.state[f],T=this.props,A=T.x,M=T.width,R=T.travellerWidth,B=T.onChange,L=T.gap,j=T.data,V={startX:this.state.startX,endX:this.state.endX},$=r.pageX-c;$>0?$=Math.min($,A+M-R-b):$<0&&($=Math.max($,A-b)),V[f]=b+$;var H=this.getIndex(V),K=H.startIndex,Y=H.endIndex,se=function(){var ye=j.length-1;return f==="startX"&&(i>v?K%L===0:Y%L===0)||i<v&&Y===ye||f==="endX"&&(i>v?Y%L===0:K%L===0)||i>v&&Y===ye};this.setState(ll(ll({},f,b+$),"brushMoveStartX",r.pageX),function(){B&&se()&&B(H)})}},{key:"handleTravellerMoveKeyboard",value:function(r,a){var c=this,f=this.state,i=f.scaleValues,v=f.startX,b=f.endX,T=this.state[a],A=i.indexOf(T);if(A!==-1){var M=A+r;if(!(M===-1||M>=i.length)){var R=i[M];a==="startX"&&R>=b||a==="endX"&&R<=v||this.setState(ll({},a,R),function(){c.props.onChange(c.getIndex({startX:c.state.startX,endX:c.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,a=r.x,c=r.y,f=r.width,i=r.height,v=r.fill,b=r.stroke;return Se.createElement("rect",{stroke:b,fill:v,x:a,y:c,width:f,height:i})}},{key:"renderPanorama",value:function(){var r=this.props,a=r.x,c=r.y,f=r.width,i=r.height,v=r.data,b=r.children,T=r.padding,A=X.Children.only(b);return A?Se.cloneElement(A,{x:a,y:c,width:f,height:i,margin:T,compact:!0,data:v}):null}},{key:"renderTravellerLayer",value:function(r,a){var c,f,i=this,v=this.props,b=v.y,T=v.travellerWidth,A=v.height,M=v.traveller,R=v.ariaLabel,B=v.data,L=v.startIndex,j=v.endIndex,V=Math.max(r,this.props.x),$=Bk(Bk({},ir(this.props,!1)),{},{x:V,y:b,width:T,height:A}),H=R||"Min value: ".concat((c=B[L])===null||c===void 0?void 0:c.name,", Max value: ").concat((f=B[j])===null||f===void 0?void 0:f.name);return Se.createElement(Wr,{tabIndex:0,role:"slider","aria-label":H,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(Y){["ArrowLeft","ArrowRight"].includes(Y.key)&&(Y.preventDefault(),Y.stopPropagation(),i.handleTravellerMoveKeyboard(Y.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(M,$))}},{key:"renderSlide",value:function(r,a){var c=this.props,f=c.y,i=c.height,v=c.stroke,b=c.travellerWidth,T=Math.min(r,a)+b,A=Math.max(Math.abs(a-r)-b,0);return Se.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:v,fillOpacity:.2,x:T,y:f,width:A,height:i})}},{key:"renderText",value:function(){var r=this.props,a=r.startIndex,c=r.endIndex,f=r.y,i=r.height,v=r.travellerWidth,b=r.stroke,T=this.state,A=T.startX,M=T.endX,R=5,B={pointerEvents:"none",fill:b};return Se.createElement(Wr,{className:"recharts-brush-texts"},Se.createElement(zm,VA({textAnchor:"end",verticalAnchor:"middle",x:Math.min(A,M)-R,y:f+i/2},B),this.getTextOfTick(a)),Se.createElement(zm,VA({textAnchor:"start",verticalAnchor:"middle",x:Math.max(A,M)+v+R,y:f+i/2},B),this.getTextOfTick(c)))}},{key:"render",value:function(){var r=this.props,a=r.data,c=r.className,f=r.children,i=r.x,v=r.y,b=r.width,T=r.height,A=r.alwaysShowText,M=this.state,R=M.startX,B=M.endX,L=M.isTextActive,j=M.isSlideMoving,V=M.isTravellerMoving,$=M.isTravellerFocused;if(!a||!a.length||!wn(i)||!wn(v)||!wn(b)||!wn(T)||b<=0||T<=0)return null;var H=jr("recharts-brush",c),K=Se.Children.count(f)===1,Y=p$e("userSelect","none");return Se.createElement(Wr,{className:H,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:Y},this.renderBackground(),K&&this.renderPanorama(),this.renderSlide(R,B),this.renderTravellerLayer(R,"startX"),this.renderTravellerLayer(B,"endX"),(L||j||V||$||A)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var a=r.x,c=r.y,f=r.width,i=r.height,v=r.stroke,b=Math.floor(c+i/2)-1;return Se.createElement(Se.Fragment,null,Se.createElement("rect",{x:a,y:c,width:f,height:i,fill:v,stroke:"none"}),Se.createElement("line",{x1:a+1,y1:b,x2:a+f-1,y2:b,fill:"none",stroke:"#fff"}),Se.createElement("line",{x1:a+1,y1:b+2,x2:a+f-1,y2:b+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,a){var c;return Se.isValidElement(r)?c=Se.cloneElement(r,a):Tr(r)?c=r(a):c=t.renderDefaultTraveller(a),c}},{key:"getDerivedStateFromProps",value:function(r,a){var c=r.data,f=r.width,i=r.x,v=r.travellerWidth,b=r.updateId,T=r.startIndex,A=r.endIndex;if(c!==a.prevData||b!==a.prevUpdateId)return Bk({prevData:c,prevTravellerWidth:v,prevUpdateId:b,prevX:i,prevWidth:f},c&&c.length?w$e({data:c,width:f,x:i,travellerWidth:v,startIndex:T,endIndex:A}):{scale:null,scaleValues:null});if(a.scale&&(f!==a.prevWidth||i!==a.prevX||v!==a.prevTravellerWidth)){a.scale.range([i,i+f-v]);var M=a.scale.domain().map(function(R){return a.scale(R)});return{prevData:c,prevTravellerWidth:v,prevUpdateId:b,prevX:i,prevWidth:f,startX:a.scale(r.startIndex),endX:a.scale(r.endIndex),scaleValues:M}}return null}},{key:"getIndexInRange",value:function(r,a){for(var c=r.length,f=0,i=c-1;i-f>1;){var v=Math.floor((f+i)/2);r[v]>a?i=v:f=v}return a>=r[i]?i:f}}])}(X.PureComponent);ll(K_,"displayName","Brush");ll(K_,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var S$e=NN;function T$e(e,t){var n;return S$e(e,function(r,a,c){return n=t(r,a,c),!n}),!!n}var E$e=T$e,A$e=jY,P$e=Iu,C$e=E$e,I$e=Zs,M$e=PC;function O$e(e,t,n){var r=I$e(e)?A$e:C$e;return n&&M$e(e,t,n)&&(t=void 0),r(e,P$e(t))}var k$e=O$e;const R$e=Bi(k$e);var bu=function(t,n){var r=t.alwaysShow,a=t.ifOverflow;return r&&(a="extendDomain"),a===n},HG=lJ;function D$e(e,t,n){t=="__proto__"&&HG?HG(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var L$e=D$e,z$e=L$e,N$e=aJ,F$e=Iu;function B$e(e,t){var n={};return t=F$e(t),N$e(e,function(r,a,c){z$e(n,a,t(r,a,c))}),n}var j$e=B$e;const $$e=Bi(j$e);function U$e(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}var V$e=U$e,G$e=NN;function W$e(e,t){var n=!0;return G$e(e,function(r,a,c){return n=!!t(r,a,c),n}),n}var H$e=W$e,q$e=V$e,Z$e=H$e,X$e=Iu,K$e=Zs,Y$e=PC;function J$e(e,t,n){var r=K$e(e)?q$e:Z$e;return n&&Y$e(e,t,n)&&(t=void 0),r(e,X$e(t))}var Q$e=J$e;const nee=Bi(Q$e);var e5e=["x","y"];function ow(e){"@babel/helpers - typeof";return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(e)}function DL(){return DL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},DL.apply(this,arguments)}function qG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function o1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qG(Object(n),!0).forEach(function(r){t5e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function t5e(e,t,n){return t=n5e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n5e(e){var t=r5e(e,"string");return ow(t)=="symbol"?t:t+""}function r5e(e,t){if(ow(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ow(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i5e(e,t){if(e==null)return{};var n=o5e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function o5e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function a5e(e,t){var n=e.x,r=e.y,a=i5e(e,e5e),c="".concat(n),f=parseInt(c,10),i="".concat(r),v=parseInt(i,10),b="".concat(t.height||a.height),T=parseInt(b,10),A="".concat(t.width||a.width),M=parseInt(A,10);return o1(o1(o1(o1(o1({},t),a),f?{x:f}:{}),v?{y:v}:{}),{},{height:T,width:M,name:t.name,radius:t.radius})}function ZG(e){return Se.createElement(jA,DL({shapeType:"rectangle",propTransformer:a5e,activeClassName:"recharts-active-bar"},e))}var s5e=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,a){if(typeof t=="number")return t;var c=typeof r=="number";return c?t(r,a):(c||Bm(),n)}},l5e=["value","background"],ree;function Y_(e){"@babel/helpers - typeof";return Y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y_(e)}function c5e(e,t){if(e==null)return{};var n=u5e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function u5e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function WA(){return WA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},WA.apply(this,arguments)}function XG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XG(Object(n),!0).forEach(function(r){cf(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function h5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oee(r.key),r)}}function d5e(e,t,n){return t&&KG(e.prototype,t),n&&KG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f5e(e,t,n){return t=HA(t),p5e(e,iee()?Reflect.construct(t,n||[],HA(e).constructor):t.apply(e,n))}function p5e(e,t){if(t&&(Y_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m5e(e)}function m5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iee=function(){return!!e})()}function HA(e){return HA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},HA(e)}function g5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LL(e,t)}function LL(e,t){return LL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},LL(e,t)}function cf(e,t,n){return t=oee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oee(e){var t=y5e(e,"string");return Y_(t)=="symbol"?t:t+""}function y5e(e,t){if(Y_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Y_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $v=function(e){function t(){var n;h5e(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=f5e(this,t,[].concat(a)),cf(n,"state",{isAnimationFinished:!1}),cf(n,"id",Zf("recharts-bar-")),cf(n,"handleAnimationEnd",function(){var f=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),f&&f()}),cf(n,"handleAnimationStart",function(){var f=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),f&&f()}),n}return g5e(t,e),d5e(t,[{key:"renderRectanglesStatically",value:function(r){var a=this,c=this.props,f=c.shape,i=c.dataKey,v=c.activeIndex,b=c.activeBar,T=ir(this.props,!1);return r&&r.map(function(A,M){var R=M===v,B=R?b:f,L=qo(qo(qo({},T),A),{},{isActive:R,option:B,index:M,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Se.createElement(Wr,WA({className:"recharts-bar-rectangle"},zf(a.props,A,M),{key:"rectangle-".concat(A==null?void 0:A.x,"-").concat(A==null?void 0:A.y,"-").concat(A==null?void 0:A.value)}),Se.createElement(ZG,L))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,a=this.props,c=a.data,f=a.layout,i=a.isAnimationActive,v=a.animationBegin,b=a.animationDuration,T=a.animationEasing,A=a.animationId,M=this.state.prevData;return Se.createElement(Hl,{begin:v,duration:b,isActive:i,easing:T,from:{t:0},to:{t:1},key:"bar-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(R){var B=R.t,L=c.map(function(j,V){var $=M&&M[V];if($){var H=Ao($.x,j.x),K=Ao($.y,j.y),Y=Ao($.width,j.width),se=Ao($.height,j.height);return qo(qo({},j),{},{x:H(B),y:K(B),width:Y(B),height:se(B)})}if(f==="horizontal"){var ce=Ao(0,j.height),ye=ce(B);return qo(qo({},j),{},{y:j.y+j.height-ye,height:ye})}var ze=Ao(0,j.width),Le=ze(B);return qo(qo({},j),{},{width:Le})});return Se.createElement(Wr,null,r.renderRectanglesStatically(L))})}},{key:"renderRectangles",value:function(){var r=this.props,a=r.data,c=r.isAnimationActive,f=this.state.prevData;return c&&a&&a.length&&(!f||!Ff(f,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var r=this,a=this.props,c=a.data,f=a.dataKey,i=a.activeIndex,v=ir(this.props.background,!1);return c.map(function(b,T){b.value;var A=b.background,M=c5e(b,l5e);if(!A)return null;var R=qo(qo(qo(qo(qo({},M),{},{fill:"#eee"},A),v),zf(r.props,b,T)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:f,index:T,className:"recharts-bar-background-rectangle"});return Se.createElement(ZG,WA({key:"background-bar-".concat(T),option:r.props.background,isActive:T===i},R))})}},{key:"renderErrorBar",value:function(r,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,f=c.data,i=c.xAxis,v=c.yAxis,b=c.layout,T=c.children,A=gs(T,Bv);if(!A)return null;var M=b==="vertical"?f[0].height/2:f[0].width/2,R=function(j,V){var $=Array.isArray(j.value)?j.value[1]:j.value;return{x:j.x,y:j.y,value:$,errorVal:fo(j,V)}},B={clipPath:r?"url(#clipPath-".concat(a,")"):null};return Se.createElement(Wr,B,A.map(function(L){return Se.cloneElement(L,{key:"error-bar-".concat(a,"-").concat(L.props.dataKey),data:f,xAxis:i,yAxis:v,layout:b,offset:M,dataPointFormatter:R})}))}},{key:"render",value:function(){var r=this.props,a=r.hide,c=r.data,f=r.className,i=r.xAxis,v=r.yAxis,b=r.left,T=r.top,A=r.width,M=r.height,R=r.isAnimationActive,B=r.background,L=r.id;if(a||!c||!c.length)return null;var j=this.state.isAnimationFinished,V=jr("recharts-bar",f),$=i&&i.allowDataOverflow,H=v&&v.allowDataOverflow,K=$||H,Y=xr(L)?this.id:L;return Se.createElement(Wr,{className:V},$||H?Se.createElement("defs",null,Se.createElement("clipPath",{id:"clipPath-".concat(Y)},Se.createElement("rect",{x:$?b:b-A/2,y:H?T:T-M/2,width:$?A:A*2,height:H?M:M*2}))):null,Se.createElement(Wr,{className:"recharts-bar-rectangles",clipPath:K?"url(#clipPath-".concat(Y,")"):null},B?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(K,Y),(!R||j)&&kc.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:a.curData}:r.data!==a.curData?{curData:r.data}:null}}])}(X.PureComponent);ree=$v;cf($v,"displayName","Bar");cf($v,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ul.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});cf($v,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,c=e.xAxis,f=e.yAxis,i=e.xAxisTicks,v=e.yAxisTicks,b=e.stackedData,T=e.dataStartIndex,A=e.displayedData,M=e.offset,R=sNe(r,n);if(!R)return null;var B=t.layout,L=n.type.defaultProps,j=L!==void 0?qo(qo({},L),n.props):n.props,V=j.dataKey,$=j.children,H=j.minPointSize,K=B==="horizontal"?f:c,Y=b?K.scale.domain():null,se=pNe({numericAxis:K}),ce=gs($,CC),ye=A.map(function(ze,Le){var je,Re,$e,Ge,ht,ot;b?je=lNe(b[T+Le],Y):(je=fo(ze,V),Array.isArray(je)||(je=[se,je]));var Je=s5e(H,ree.defaultProps.minPointSize)(je[1],Le);if(B==="horizontal"){var Ne,Xe=[f.scale(je[0]),f.scale(je[1])],pt=Xe[0],zt=Xe[1];Re=B8({axis:c,ticks:i,bandSize:a,offset:R.offset,entry:ze,index:Le}),$e=(Ne=zt??pt)!==null&&Ne!==void 0?Ne:void 0,Ge=R.size;var Ft=pt-zt;if(ht=Number.isNaN(Ft)?0:Ft,ot={x:Re,y:f.y,width:Ge,height:f.height},Math.abs(Je)>0&&Math.abs(ht)<Math.abs(Je)){var un=ds(ht||Je)*(Math.abs(Je)-Math.abs(ht));$e-=un,ht+=un}}else{var Tn=[c.scale(je[0]),c.scale(je[1])],fn=Tn[0],Cn=Tn[1];if(Re=fn,$e=B8({axis:f,ticks:v,bandSize:a,offset:R.offset,entry:ze,index:Le}),Ge=Cn-fn,ht=R.size,ot={x:c.x,y:$e,width:c.width,height:ht},Math.abs(Je)>0&&Math.abs(Ge)<Math.abs(Je)){var Vt=ds(Ge||Je)*(Math.abs(Je)-Math.abs(Ge));Ge+=Vt}}return qo(qo(qo({},ze),{},{x:Re,y:$e,width:Ge,height:ht,value:b?je:je[1],payload:ze,background:ot},ce&&ce[Le]&&ce[Le].props),{},{tooltipPayload:[PQ(n,ze)],tooltipPosition:{x:Re+Ge/2,y:$e+ht/2}})});return qo({data:ye,layout:B},M)});function aw(e){"@babel/helpers - typeof";return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(e)}function _5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,aee(r.key),r)}}function v5e(e,t,n){return t&&YG(e.prototype,t),n&&YG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function JG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function bc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JG(Object(n),!0).forEach(function(r){WC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JG(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WC(e,t,n){return t=aee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aee(e){var t=x5e(e,"string");return aw(t)=="symbol"?t:t+""}function x5e(e,t){if(aw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(aw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HC=function(t,n,r,a,c){var f=t.width,i=t.height,v=t.layout,b=t.children,T=Object.keys(n),A={left:r.left,leftMirror:r.left,right:f-r.right,rightMirror:f-r.right,top:r.top,topMirror:r.top,bottom:i-r.bottom,bottomMirror:i-r.bottom},M=!!ul(b,$v);return T.reduce(function(R,B){var L=n[B],j=L.orientation,V=L.domain,$=L.padding,H=$===void 0?{}:$,K=L.mirror,Y=L.reversed,se="".concat(j).concat(K?"Mirror":""),ce,ye,ze,Le,je;if(L.type==="number"&&(L.padding==="gap"||L.padding==="no-gap")){var Re=V[1]-V[0],$e=1/0,Ge=L.categoricalDomain.sort();if(Ge.forEach(function(Tn,fn){fn>0&&($e=Math.min((Tn||0)-(Ge[fn-1]||0),$e))}),Number.isFinite($e)){var ht=$e/Re,ot=L.layout==="vertical"?r.height:r.width;if(L.padding==="gap"&&(ce=ht*ot/2),L.padding==="no-gap"){var Je=fs(t.barCategoryGap,ht*ot),Ne=ht*ot/2;ce=Ne-Je-(Ne-Je)/ot*Je}}}a==="xAxis"?ye=[r.left+(H.left||0)+(ce||0),r.left+r.width-(H.right||0)-(ce||0)]:a==="yAxis"?ye=v==="horizontal"?[r.top+r.height-(H.bottom||0),r.top+(H.top||0)]:[r.top+(H.top||0)+(ce||0),r.top+r.height-(H.bottom||0)-(ce||0)]:ye=L.range,Y&&(ye=[ye[1],ye[0]]);var Xe=SQ(L,c,M),pt=Xe.scale,zt=Xe.realScaleType;pt.domain(V).range(ye),TQ(pt);var Ft=EQ(pt,bc(bc({},L),{},{realScaleType:zt}));a==="xAxis"?(je=j==="top"&&!K||j==="bottom"&&K,ze=r.left,Le=A[se]-je*L.height):a==="yAxis"&&(je=j==="left"&&!K||j==="right"&&K,ze=A[se]-je*L.width,Le=r.top);var un=bc(bc(bc({},L),Ft),{},{realScaleType:zt,x:ze,y:Le,scale:pt,width:a==="xAxis"?r.width:L.width,height:a==="yAxis"?r.height:L.height});return un.bandSize=IA(un,Ft),!L.hide&&a==="xAxis"?A[se]+=(je?-1:1)*un.height:L.hide||(A[se]+=(je?-1:1)*un.width),bc(bc({},R),{},WC({},B,un))},{})},see=function(t,n){var r=t.x,a=t.y,c=n.x,f=n.y;return{x:Math.min(r,c),y:Math.min(a,f),width:Math.abs(c-r),height:Math.abs(f-a)}},b5e=function(t){var n=t.x1,r=t.y1,a=t.x2,c=t.y2;return see({x:n,y:r},{x:a,y:c})},lee=function(){function e(t){_5e(this,e),this.scale=t}return v5e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,c=r.position;if(n!==void 0){if(c)switch(c){case"start":return this.scale(n);case"middle":{var f=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+f}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(n)+i}default:return this.scale(n)}if(a){var v=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+v}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),a=r[0],c=r[r.length-1];return a<=c?n>=a&&n<=c:n>=c&&n<=a}}],[{key:"create",value:function(n){return new e(n)}}])}();WC(lee,"EPS",1e-4);var dF=function(t){var n=Object.keys(t).reduce(function(r,a){return bc(bc({},r),{},WC({},a,lee.create(t[a])))},{});return bc(bc({},n),{},{apply:function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=c.bandAware,i=c.position;return $$e(a,function(v,b){return n[b].apply(v,{bandAware:f,position:i})})},isInRange:function(a){return nee(a,function(c,f){return n[f].isInRange(c)})}})};function w5e(e){return(e%180+180)%180}var S5e=function(t){var n=t.width,r=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=w5e(a),f=c*Math.PI/180,i=Math.atan(r/n),v=f>i&&f<Math.PI-i?r/Math.sin(f):n/Math.cos(f);return Math.abs(v)},T5e=Iu,E5e=Bw,A5e=EC;function P5e(e){return function(t,n,r){var a=Object(t);if(!E5e(t)){var c=T5e(n);t=A5e(t),n=function(i){return c(a[i],i,a)}}var f=e(t,n,r);return f>-1?a[c?t[f]:f]:void 0}}var C5e=P5e,I5e=JQ;function M5e(e){var t=I5e(e),n=t%1;return t===t?n?t-n:t:0}var O5e=M5e,k5e=eJ,R5e=Iu,D5e=O5e,L5e=Math.max;function z5e(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var a=n==null?0:D5e(n);return a<0&&(a=L5e(r+a,0)),k5e(e,R5e(t),a)}var N5e=z5e,F5e=C5e,B5e=N5e,j5e=F5e(B5e),$5e=j5e;const U5e=Bi($5e);var V5e=zwe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),fF=X.createContext(void 0),pF=X.createContext(void 0),cee=X.createContext(void 0),uee=X.createContext({}),hee=X.createContext(void 0),dee=X.createContext(0),fee=X.createContext(0),QG=function(t){var n=t.state,r=n.xAxisMap,a=n.yAxisMap,c=n.offset,f=t.clipPathId,i=t.children,v=t.width,b=t.height,T=V5e(c);return Se.createElement(fF.Provider,{value:r},Se.createElement(pF.Provider,{value:a},Se.createElement(uee.Provider,{value:c},Se.createElement(cee.Provider,{value:T},Se.createElement(hee.Provider,{value:f},Se.createElement(dee.Provider,{value:b},Se.createElement(fee.Provider,{value:v},i)))))))},G5e=function(){return X.useContext(hee)},pee=function(t){var n=X.useContext(fF);n==null&&Bm();var r=n[t];return r==null&&Bm(),r},W5e=function(){var t=X.useContext(fF);return rf(t)},H5e=function(){var t=X.useContext(pF),n=U5e(t,function(r){return nee(r.domain,Number.isFinite)});return n||rf(t)},mee=function(t){var n=X.useContext(pF);n==null&&Bm();var r=n[t];return r==null&&Bm(),r},q5e=function(){var t=X.useContext(cee);return t},Z5e=function(){return X.useContext(uee)},mF=function(){return X.useContext(fee)},gF=function(){return X.useContext(dee)};function J_(e){"@babel/helpers - typeof";return J_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J_(e)}function X5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K5e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yee(r.key),r)}}function Y5e(e,t,n){return t&&K5e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function J5e(e,t,n){return t=qA(t),Q5e(e,gee()?Reflect.construct(t,n||[],qA(e).constructor):t.apply(e,n))}function Q5e(e,t){if(t&&(J_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eUe(e)}function eUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gee=function(){return!!e})()}function qA(e){return qA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qA(e)}function tUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zL(e,t)}function zL(e,t){return zL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},zL(e,t)}function eW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function tW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eW(Object(n),!0).forEach(function(r){yF(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yF(e,t,n){return t=yee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yee(e){var t=nUe(e,"string");return J_(t)=="symbol"?t:t+""}function nUe(e,t){if(J_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(J_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rUe(e,t){return sUe(e)||aUe(e,t)||oUe(e,t)||iUe()}function iUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oUe(e,t){if(e){if(typeof e=="string")return nW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nW(e,t)}}function nW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aUe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function sUe(e){if(Array.isArray(e))return e}function NL(){return NL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NL.apply(this,arguments)}var lUe=function(t,n){var r;return Se.isValidElement(t)?r=Se.cloneElement(t,n):Tr(t)?r=t(n):r=Se.createElement("line",NL({},n,{className:"recharts-reference-line-line"})),r},cUe=function(t,n,r,a,c,f,i,v,b){var T=c.x,A=c.y,M=c.width,R=c.height;if(r){var B=b.y,L=t.y.apply(B,{position:f});if(bu(b,"discard")&&!t.y.isInRange(L))return null;var j=[{x:T+M,y:L},{x:T,y:L}];return v==="left"?j.reverse():j}if(n){var V=b.x,$=t.x.apply(V,{position:f});if(bu(b,"discard")&&!t.x.isInRange($))return null;var H=[{x:$,y:A+R},{x:$,y:A}];return i==="top"?H.reverse():H}if(a){var K=b.segment,Y=K.map(function(se){return t.apply(se,{position:f})});return bu(b,"discard")&&R$e(Y,function(se){return!t.isInRange(se)})?null:Y}return null};function uUe(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,c=e.yAxisId,f=e.shape,i=e.className,v=e.alwaysShow,b=G5e(),T=pee(a),A=mee(c),M=q5e();if(!b||!M)return null;Oc(v===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var R=dF({x:T.scale,y:A.scale}),B=aa(t),L=aa(n),j=r&&r.length===2,V=cUe(R,B,L,j,M,e.position,T.orientation,A.orientation,e);if(!V)return null;var $=rUe(V,2),H=$[0],K=H.x,Y=H.y,se=$[1],ce=se.x,ye=se.y,ze=bu(e,"hidden")?"url(#".concat(b,")"):void 0,Le=tW(tW({clipPath:ze},ir(e,!0)),{},{x1:K,y1:Y,x2:ce,y2:ye});return Se.createElement(Wr,{className:jr("recharts-reference-line",i)},lUe(f,Le),xa.renderCallByParent(e,b5e({x1:K,y1:Y,x2:ce,y2:ye})))}var _F=function(e){function t(){return X5e(this,t),J5e(this,t,arguments)}return tUe(t,e),Y5e(t,[{key:"render",value:function(){return Se.createElement(uUe,this.props)}}])}(Se.Component);yF(_F,"displayName","ReferenceLine");yF(_F,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function FL(){return FL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FL.apply(this,arguments)}function Q_(e){"@babel/helpers - typeof";return Q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q_(e)}function rW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function iW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rW(Object(n),!0).forEach(function(r){qC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dUe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vee(r.key),r)}}function fUe(e,t,n){return t&&dUe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pUe(e,t,n){return t=ZA(t),mUe(e,_ee()?Reflect.construct(t,n||[],ZA(e).constructor):t.apply(e,n))}function mUe(e,t){if(t&&(Q_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gUe(e)}function gUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_ee=function(){return!!e})()}function ZA(e){return ZA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ZA(e)}function yUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BL(e,t)}function BL(e,t){return BL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},BL(e,t)}function qC(e,t,n){return t=vee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vee(e){var t=_Ue(e,"string");return Q_(t)=="symbol"?t:t+""}function _Ue(e,t){if(Q_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Q_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vUe=function(t){var n=t.x,r=t.y,a=t.xAxis,c=t.yAxis,f=dF({x:a.scale,y:c.scale}),i=f.apply({x:n,y:r},{bandAware:!0});return bu(t,"discard")&&!f.isInRange(i)?null:i},ZC=function(e){function t(){return hUe(this,t),pUe(this,t,arguments)}return yUe(t,e),fUe(t,[{key:"render",value:function(){var r=this.props,a=r.x,c=r.y,f=r.r,i=r.alwaysShow,v=r.clipPathId,b=aa(a),T=aa(c);if(Oc(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!b||!T)return null;var A=vUe(this.props);if(!A)return null;var M=A.x,R=A.y,B=this.props,L=B.shape,j=B.className,V=bu(this.props,"hidden")?"url(#".concat(v,")"):void 0,$=iW(iW({clipPath:V},ir(this.props,!0)),{},{cx:M,cy:R});return Se.createElement(Wr,{className:jr("recharts-reference-dot",j)},t.renderDot(L,$),xa.renderCallByParent(this.props,{x:M-f,y:R-f,width:2*f,height:2*f}))}}])}(Se.Component);qC(ZC,"displayName","ReferenceDot");qC(ZC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});qC(ZC,"renderDot",function(e,t){var n;return Se.isValidElement(e)?n=Se.cloneElement(e,t):Tr(e)?n=e(t):n=Se.createElement(Gw,FL({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function jL(){return jL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jL.apply(this,arguments)}function ev(e){"@babel/helpers - typeof";return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ev(e)}function oW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function aW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oW(Object(n),!0).forEach(function(r){XC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bUe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bee(r.key),r)}}function wUe(e,t,n){return t&&bUe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function SUe(e,t,n){return t=XA(t),TUe(e,xee()?Reflect.construct(t,n||[],XA(e).constructor):t.apply(e,n))}function TUe(e,t){if(t&&(ev(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EUe(e)}function EUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xee=function(){return!!e})()}function XA(e){return XA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},XA(e)}function AUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$L(e,t)}function $L(e,t){return $L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},$L(e,t)}function XC(e,t,n){return t=bee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bee(e){var t=PUe(e,"string");return ev(t)=="symbol"?t:t+""}function PUe(e,t){if(ev(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ev(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CUe=function(t,n,r,a,c){var f=c.x1,i=c.x2,v=c.y1,b=c.y2,T=c.xAxis,A=c.yAxis;if(!T||!A)return null;var M=dF({x:T.scale,y:A.scale}),R={x:t?M.x.apply(f,{position:"start"}):M.x.rangeMin,y:r?M.y.apply(v,{position:"start"}):M.y.rangeMin},B={x:n?M.x.apply(i,{position:"end"}):M.x.rangeMax,y:a?M.y.apply(b,{position:"end"}):M.y.rangeMax};return bu(c,"discard")&&(!M.isInRange(R)||!M.isInRange(B))?null:see(R,B)},KC=function(e){function t(){return xUe(this,t),SUe(this,t,arguments)}return AUe(t,e),wUe(t,[{key:"render",value:function(){var r=this.props,a=r.x1,c=r.x2,f=r.y1,i=r.y2,v=r.className,b=r.alwaysShow,T=r.clipPathId;Oc(b===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var A=aa(a),M=aa(c),R=aa(f),B=aa(i),L=this.props.shape;if(!A&&!M&&!R&&!B&&!L)return null;var j=CUe(A,M,R,B,this.props);if(!j&&!L)return null;var V=bu(this.props,"hidden")?"url(#".concat(T,")"):void 0;return Se.createElement(Wr,{className:jr("recharts-reference-area",v)},t.renderRect(L,aW(aW({clipPath:V},ir(this.props,!0)),j)),xa.renderCallByParent(this.props,j))}}])}(Se.Component);XC(KC,"displayName","ReferenceArea");XC(KC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});XC(KC,"renderRect",function(e,t){var n;return Se.isValidElement(e)?n=Se.cloneElement(e,t):Tr(e)?n=e(t):n=Se.createElement(hF,jL({},t,{className:"recharts-reference-area-rect"})),n});function wee(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function IUe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return S5e(r,n)}function MUe(e,t,n){var r=n==="width",a=e.x,c=e.y,f=e.width,i=e.height;return t===1?{start:r?a:c,end:r?a+f:c+i}:{start:r?a+f:c+i,end:r?a:c}}function KA(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var c=n();return e*(t-e*c/2-r)>=0&&e*(t+e*c/2-a)<=0}function OUe(e,t){return wee(e,t+1)}function kUe(e,t,n,r,a){for(var c=(r||[]).slice(),f=t.start,i=t.end,v=0,b=1,T=f,A=function(){var B=r==null?void 0:r[v];if(B===void 0)return{v:wee(r,b)};var L=v,j,V=function(){return j===void 0&&(j=n(B,L)),j},$=B.coordinate,H=v===0||KA(e,$,V,T,i);H||(v=0,T=f,b+=1),H&&(T=$+e*(V()/2+a),v+=b)},M;b<=c.length;)if(M=A(),M)return M.v;return[]}function sw(e){"@babel/helpers - typeof";return sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sw(e)}function sW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Xa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sW(Object(n),!0).forEach(function(r){RUe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function RUe(e,t,n){return t=DUe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DUe(e){var t=LUe(e,"string");return sw(t)=="symbol"?t:t+""}function LUe(e,t){if(sw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zUe(e,t,n,r,a){for(var c=(r||[]).slice(),f=c.length,i=t.start,v=t.end,b=function(M){var R=c[M],B,L=function(){return B===void 0&&(B=n(R,M)),B};if(M===f-1){var j=e*(R.coordinate+e*L()/2-v);c[M]=R=Xa(Xa({},R),{},{tickCoord:j>0?R.coordinate-j*e:R.coordinate})}else c[M]=R=Xa(Xa({},R),{},{tickCoord:R.coordinate});var V=KA(e,R.tickCoord,L,i,v);V&&(v=R.tickCoord-e*(L()/2+a),c[M]=Xa(Xa({},R),{},{isShow:!0}))},T=f-1;T>=0;T--)b(T);return c}function NUe(e,t,n,r,a,c){var f=(r||[]).slice(),i=f.length,v=t.start,b=t.end;if(c){var T=r[i-1],A=n(T,i-1),M=e*(T.coordinate+e*A/2-b);f[i-1]=T=Xa(Xa({},T),{},{tickCoord:M>0?T.coordinate-M*e:T.coordinate});var R=KA(e,T.tickCoord,function(){return A},v,b);R&&(b=T.tickCoord-e*(A/2+a),f[i-1]=Xa(Xa({},T),{},{isShow:!0}))}for(var B=c?i-1:i,L=function($){var H=f[$],K,Y=function(){return K===void 0&&(K=n(H,$)),K};if($===0){var se=e*(H.coordinate-e*Y()/2-v);f[$]=H=Xa(Xa({},H),{},{tickCoord:se<0?H.coordinate-se*e:H.coordinate})}else f[$]=H=Xa(Xa({},H),{},{tickCoord:H.coordinate});var ce=KA(e,H.tickCoord,Y,v,b);ce&&(v=H.tickCoord+e*(Y()/2+a),f[$]=Xa(Xa({},H),{},{isShow:!0}))},j=0;j<B;j++)L(j);return f}function vF(e,t,n){var r=e.tick,a=e.ticks,c=e.viewBox,f=e.minTickGap,i=e.orientation,v=e.interval,b=e.tickFormatter,T=e.unit,A=e.angle;if(!a||!a.length||!r)return[];if(wn(v)||Ul.isSsr)return OUe(a,typeof v=="number"&&wn(v)?v:0);var M=[],R=i==="top"||i==="bottom"?"width":"height",B=T&&R==="width"?z1(T,{fontSize:t,letterSpacing:n}):{width:0,height:0},L=function(H,K){var Y=Tr(b)?b(H.value,K):H.value;return R==="width"?IUe(z1(Y,{fontSize:t,letterSpacing:n}),B,A):z1(Y,{fontSize:t,letterSpacing:n})[R]},j=a.length>=2?ds(a[1].coordinate-a[0].coordinate):1,V=MUe(c,j,R);return v==="equidistantPreserveStart"?kUe(j,V,L,a,f):(v==="preserveStart"||v==="preserveStartEnd"?M=NUe(j,V,L,a,f,v==="preserveStartEnd"):M=zUe(j,V,L,a,f),M.filter(function($){return $.isShow}))}var FUe=["viewBox"],BUe=["viewBox"],jUe=["ticks"];function tv(e){"@babel/helpers - typeof";return tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tv(e)}function n_(){return n_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n_.apply(this,arguments)}function lW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ls(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lW(Object(n),!0).forEach(function(r){xF(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function jk(e,t){if(e==null)return{};var n=$Ue(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function $Ue(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function UUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tee(r.key),r)}}function VUe(e,t,n){return t&&cW(e.prototype,t),n&&cW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function GUe(e,t,n){return t=YA(t),WUe(e,See()?Reflect.construct(t,n||[],YA(e).constructor):t.apply(e,n))}function WUe(e,t){if(t&&(tv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HUe(e)}function HUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function See(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(See=function(){return!!e})()}function YA(e){return YA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},YA(e)}function qUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UL(e,t)}function UL(e,t){return UL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},UL(e,t)}function xF(e,t,n){return t=Tee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tee(e){var t=ZUe(e,"string");return tv(t)=="symbol"?t:t+""}function ZUe(e,t){if(tv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(tv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uv=function(e){function t(n){var r;return UUe(this,t),r=GUe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return qUe(t,e),VUe(t,[{key:"shouldComponentUpdate",value:function(r,a){var c=r.viewBox,f=jk(r,FUe),i=this.props,v=i.viewBox,b=jk(i,BUe);return!f_(c,v)||!f_(f,b)||!f_(a,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var a=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var a=this.props,c=a.x,f=a.y,i=a.width,v=a.height,b=a.orientation,T=a.tickSize,A=a.mirror,M=a.tickMargin,R,B,L,j,V,$,H=A?-1:1,K=r.tickSize||T,Y=wn(r.tickCoord)?r.tickCoord:r.coordinate;switch(b){case"top":R=B=r.coordinate,j=f+ +!A*v,L=j-H*K,$=L-H*M,V=Y;break;case"left":L=j=r.coordinate,B=c+ +!A*i,R=B-H*K,V=R-H*M,$=Y;break;case"right":L=j=r.coordinate,B=c+ +A*i,R=B+H*K,V=R+H*M,$=Y;break;default:R=B=r.coordinate,j=f+ +A*v,L=j+H*K,$=L+H*M,V=Y;break}return{line:{x1:R,y1:L,x2:B,y2:j},tick:{x:V,y:$}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,a=r.orientation,c=r.mirror,f;switch(a){case"left":f=c?"start":"end";break;case"right":f=c?"end":"start";break;default:f="middle";break}return f}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,a=r.orientation,c=r.mirror,f="end";switch(a){case"left":case"right":f="middle";break;case"top":f=c?"start":"end";break;default:f=c?"end":"start";break}return f}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.x,c=r.y,f=r.width,i=r.height,v=r.orientation,b=r.mirror,T=r.axisLine,A=ls(ls(ls({},ir(this.props,!1)),ir(T,!1)),{},{fill:"none"});if(v==="top"||v==="bottom"){var M=+(v==="top"&&!b||v==="bottom"&&b);A=ls(ls({},A),{},{x1:a,y1:c+M*i,x2:a+f,y2:c+M*i})}else{var R=+(v==="left"&&!b||v==="right"&&b);A=ls(ls({},A),{},{x1:a+R*f,y1:c,x2:a+R*f,y2:c+i})}return Se.createElement("line",n_({},A,{className:jr("recharts-cartesian-axis-line",yl(T,"className"))}))}},{key:"renderTicks",value:function(r,a,c){var f=this,i=this.props,v=i.tickLine,b=i.stroke,T=i.tick,A=i.tickFormatter,M=i.unit,R=vF(ls(ls({},this.props),{},{ticks:r}),a,c),B=this.getTickTextAnchor(),L=this.getTickVerticalAnchor(),j=ir(this.props,!1),V=ir(T,!1),$=ls(ls({},j),{},{fill:"none"},ir(v,!1)),H=R.map(function(K,Y){var se=f.getTickLineCoord(K),ce=se.line,ye=se.tick,ze=ls(ls(ls(ls({textAnchor:B,verticalAnchor:L},j),{},{stroke:"none",fill:b},V),ye),{},{index:Y,payload:K,visibleTicksCount:R.length,tickFormatter:A});return Se.createElement(Wr,n_({className:"recharts-cartesian-axis-tick",key:"tick-".concat(K.value,"-").concat(K.coordinate,"-").concat(K.tickCoord)},zf(f.props,K,Y)),v&&Se.createElement("line",n_({},$,ce,{className:jr("recharts-cartesian-axis-tick-line",yl(v,"className"))})),T&&t.renderTickItem(T,ze,"".concat(Tr(A)?A(K.value,Y):K.value).concat(M||"")))});return Se.createElement("g",{className:"recharts-cartesian-axis-ticks"},H)}},{key:"render",value:function(){var r=this,a=this.props,c=a.axisLine,f=a.width,i=a.height,v=a.ticksGenerator,b=a.className,T=a.hide;if(T)return null;var A=this.props,M=A.ticks,R=jk(A,jUe),B=M;return Tr(v)&&(B=M&&M.length>0?v(this.props):v(R)),f<=0||i<=0||!B||!B.length?null:Se.createElement(Wr,{className:jr("recharts-cartesian-axis",b),ref:function(j){r.layerReference=j}},c&&this.renderAxisLine(),this.renderTicks(B,this.state.fontSize,this.state.letterSpacing),xa.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,a,c){var f;return Se.isValidElement(r)?f=Se.cloneElement(r,a):Tr(r)?f=r(a):f=Se.createElement(zm,n_({},a,{className:"recharts-cartesian-axis-tick-value"}),c),f}}])}(X.Component);xF(Uv,"displayName","CartesianAxis");xF(Uv,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var XUe=["x1","y1","x2","y2","key"],KUe=["offset"];function jm(e){"@babel/helpers - typeof";return jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jm(e)}function uW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ya(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uW(Object(n),!0).forEach(function(r){YUe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function YUe(e,t,n){return t=JUe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JUe(e){var t=QUe(e,"string");return jm(t)=="symbol"?t:t+""}function QUe(e,t){if(jm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(jm(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ym(){return ym=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ym.apply(this,arguments)}function hW(e,t){if(e==null)return{};var n=eVe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function eVe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var tVe=function(t){var n=t.fill;if(!n||n==="none")return null;var r=t.fillOpacity,a=t.x,c=t.y,f=t.width,i=t.height,v=t.ry;return Se.createElement("rect",{x:a,y:c,ry:v,width:f,height:i,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function Eee(e,t){var n;if(Se.isValidElement(e))n=Se.cloneElement(e,t);else if(Tr(e))n=e(t);else{var r=t.x1,a=t.y1,c=t.x2,f=t.y2,i=t.key,v=hW(t,XUe),b=ir(v,!1);b.offset;var T=hW(b,KUe);n=Se.createElement("line",ym({},T,{x1:r,y1:a,x2:c,y2:f,fill:"none",key:i}))}return n}function nVe(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,c=e.horizontalPoints;if(!a||!c||!c.length)return null;var f=c.map(function(i,v){var b=Ya(Ya({},e),{},{x1:t,y1:i,x2:t+n,y2:i,key:"line-".concat(v),index:v});return Eee(a,b)});return Se.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function rVe(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,c=e.verticalPoints;if(!a||!c||!c.length)return null;var f=c.map(function(i,v){var b=Ya(Ya({},e),{},{x1:i,y1:t,x2:i,y2:t+n,key:"line-".concat(v),index:v});return Eee(a,b)});return Se.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function iVe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,c=e.width,f=e.height,i=e.horizontalPoints,v=e.horizontal,b=v===void 0?!0:v;if(!b||!t||!t.length)return null;var T=i.map(function(M){return Math.round(M+a-a)}).sort(function(M,R){return M-R});a!==T[0]&&T.unshift(0);var A=T.map(function(M,R){var B=!T[R+1],L=B?a+f-M:T[R+1]-M;if(L<=0)return null;var j=R%t.length;return Se.createElement("rect",{key:"react-".concat(R),y:M,x:r,height:L,width:c,stroke:"none",fill:t[j],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return Se.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},A)}function oVe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,c=e.x,f=e.y,i=e.width,v=e.height,b=e.verticalPoints;if(!n||!r||!r.length)return null;var T=b.map(function(M){return Math.round(M+c-c)}).sort(function(M,R){return M-R});c!==T[0]&&T.unshift(0);var A=T.map(function(M,R){var B=!T[R+1],L=B?c+i-M:T[R+1]-M;if(L<=0)return null;var j=R%r.length;return Se.createElement("rect",{key:"react-".concat(R),x:M,y:f,width:L,height:v,stroke:"none",fill:r[j],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Se.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},A)}var aVe=function(t,n){var r=t.xAxis,a=t.width,c=t.height,f=t.offset;return wQ(vF(Ya(Ya(Ya({},Uv.defaultProps),r),{},{ticks:Ah(r,!0),viewBox:{x:0,y:0,width:a,height:c}})),f.left,f.left+f.width,n)},sVe=function(t,n){var r=t.yAxis,a=t.width,c=t.height,f=t.offset;return wQ(vF(Ya(Ya(Ya({},Uv.defaultProps),r),{},{ticks:Ah(r,!0),viewBox:{x:0,y:0,width:a,height:c}})),f.top,f.top+f.height,n)},Ly={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function lVe(e){var t,n,r,a,c,f,i=mF(),v=gF(),b=Z5e(),T=Ya(Ya({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Ly.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Ly.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Ly.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Ly.horizontalFill,vertical:(c=e.vertical)!==null&&c!==void 0?c:Ly.vertical,verticalFill:(f=e.verticalFill)!==null&&f!==void 0?f:Ly.verticalFill,x:wn(e.x)?e.x:b.left,y:wn(e.y)?e.y:b.top,width:wn(e.width)?e.width:b.width,height:wn(e.height)?e.height:b.height}),A=T.x,M=T.y,R=T.width,B=T.height,L=T.syncWithTicks,j=T.horizontalValues,V=T.verticalValues,$=W5e(),H=H5e();if(!wn(R)||R<=0||!wn(B)||B<=0||!wn(A)||A!==+A||!wn(M)||M!==+M)return null;var K=T.verticalCoordinatesGenerator||aVe,Y=T.horizontalCoordinatesGenerator||sVe,se=T.horizontalPoints,ce=T.verticalPoints;if((!se||!se.length)&&Tr(Y)){var ye=j&&j.length,ze=Y({yAxis:H?Ya(Ya({},H),{},{ticks:ye?j:H.ticks}):void 0,width:i,height:v,offset:b},ye?!0:L);Oc(Array.isArray(ze),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(jm(ze),"]")),Array.isArray(ze)&&(se=ze)}if((!ce||!ce.length)&&Tr(K)){var Le=V&&V.length,je=K({xAxis:$?Ya(Ya({},$),{},{ticks:Le?V:$.ticks}):void 0,width:i,height:v,offset:b},Le?!0:L);Oc(Array.isArray(je),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(jm(je),"]")),Array.isArray(je)&&(ce=je)}return Se.createElement("g",{className:"recharts-cartesian-grid"},Se.createElement(tVe,{fill:T.fill,fillOpacity:T.fillOpacity,x:T.x,y:T.y,width:T.width,height:T.height,ry:T.ry}),Se.createElement(nVe,ym({},T,{offset:b,horizontalPoints:se,xAxis:$,yAxis:H})),Se.createElement(rVe,ym({},T,{offset:b,verticalPoints:ce,xAxis:$,yAxis:H})),Se.createElement(iVe,ym({},T,{horizontalPoints:se})),Se.createElement(oVe,ym({},T,{verticalPoints:ce})))}lVe.displayName="CartesianGrid";var cVe=["type","layout","connectNulls","ref"],uVe=["key"];function nv(e){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nv(e)}function dW(e,t){if(e==null)return{};var n=hVe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function hVe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function U1(){return U1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},U1.apply(this,arguments)}function fW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function sl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fW(Object(n),!0).forEach(function(r){wc(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function zy(e){return mVe(e)||pVe(e)||fVe(e)||dVe()}function dVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fVe(e,t){if(e){if(typeof e=="string")return VL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VL(e,t)}}function pVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mVe(e){if(Array.isArray(e))return VL(e)}function VL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pee(r.key),r)}}function yVe(e,t,n){return t&&pW(e.prototype,t),n&&pW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ve(e,t,n){return t=JA(t),vVe(e,Aee()?Reflect.construct(t,n||[],JA(e).constructor):t.apply(e,n))}function vVe(e,t){if(t&&(nv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xVe(e)}function xVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Aee=function(){return!!e})()}function JA(e){return JA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},JA(e)}function bVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GL(e,t)}function GL(e,t){return GL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},GL(e,t)}function wc(e,t,n){return t=Pee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pee(e){var t=wVe(e,"string");return nv(t)=="symbol"?t:t+""}function wVe(e,t){if(nv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(nv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YC=function(e){function t(){var n;gVe(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=_Ve(this,t,[].concat(a)),wc(n,"state",{isAnimationFinished:!0,totalLength:0}),wc(n,"generateSimpleStrokeDasharray",function(f,i){return"".concat(i,"px ").concat(f-i,"px")}),wc(n,"getStrokeDasharray",function(f,i,v){var b=v.reduce(function(V,$){return V+$});if(!b)return n.generateSimpleStrokeDasharray(i,f);for(var T=Math.floor(f/b),A=f%b,M=i-f,R=[],B=0,L=0;B<v.length;L+=v[B],++B)if(L+v[B]>A){R=[].concat(zy(v.slice(0,B)),[A-L]);break}var j=R.length%2===0?[0,M]:[M];return[].concat(zy(t.repeat(v,T)),zy(R),j).map(function(V){return"".concat(V,"px")}).join(", ")}),wc(n,"id",Zf("recharts-line-")),wc(n,"pathRef",function(f){n.mainCurve=f}),wc(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),wc(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return bVe(t,e),yVe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,f=c.points,i=c.xAxis,v=c.yAxis,b=c.layout,T=c.children,A=gs(T,Bv);if(!A)return null;var M=function(L,j){return{x:L.x,y:L.y,value:L.value,errorVal:fo(L.payload,j)}},R={clipPath:r?"url(#clipPath-".concat(a,")"):null};return Se.createElement(Wr,R,A.map(function(B){return Se.cloneElement(B,{key:"bar-".concat(B.props.dataKey),data:f,xAxis:i,yAxis:v,layout:b,dataPointFormatter:M})}))}},{key:"renderDots",value:function(r,a,c){var f=this.props.isAnimationActive;if(f&&!this.state.isAnimationFinished)return null;var i=this.props,v=i.dot,b=i.points,T=i.dataKey,A=ir(this.props,!1),M=ir(v,!0),R=b.map(function(L,j){var V=sl(sl(sl({key:"dot-".concat(j),r:3},A),M),{},{value:L.value,dataKey:T,cx:L.x,cy:L.y,index:j,payload:L.payload});return t.renderDotItem(v,V)}),B={clipPath:r?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return Se.createElement(Wr,U1({className:"recharts-line-dots",key:"dots"},B),R)}},{key:"renderCurveStatically",value:function(r,a,c,f){var i=this.props,v=i.type,b=i.layout,T=i.connectNulls;i.ref;var A=dW(i,cVe),M=sl(sl(sl({},ir(A,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(c,")"):null,points:r},f),{},{type:v,layout:b,connectNulls:T});return Se.createElement(Tf,U1({},M,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,a){var c=this,f=this.props,i=f.points,v=f.strokeDasharray,b=f.isAnimationActive,T=f.animationBegin,A=f.animationDuration,M=f.animationEasing,R=f.animationId,B=f.animateNewValues,L=f.width,j=f.height,V=this.state,$=V.prevPoints,H=V.totalLength;return Se.createElement(Hl,{begin:T,duration:A,isActive:b,easing:M,from:{t:0},to:{t:1},key:"line-".concat(R),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(K){var Y=K.t;if($){var se=$.length/i.length,ce=i.map(function(Re,$e){var Ge=Math.floor($e*se);if($[Ge]){var ht=$[Ge],ot=Ao(ht.x,Re.x),Je=Ao(ht.y,Re.y);return sl(sl({},Re),{},{x:ot(Y),y:Je(Y)})}if(B){var Ne=Ao(L*2,Re.x),Xe=Ao(j/2,Re.y);return sl(sl({},Re),{},{x:Ne(Y),y:Xe(Y)})}return sl(sl({},Re),{},{x:Re.x,y:Re.y})});return c.renderCurveStatically(ce,r,a)}var ye=Ao(0,H),ze=ye(Y),Le;if(v){var je="".concat(v).split(/[,\s]+/gim).map(function(Re){return parseFloat(Re)});Le=c.getStrokeDasharray(ze,H,je)}else Le=c.generateSimpleStrokeDasharray(H,ze);return c.renderCurveStatically(i,r,a,{strokeDasharray:Le})})}},{key:"renderCurve",value:function(r,a){var c=this.props,f=c.points,i=c.isAnimationActive,v=this.state,b=v.prevPoints,T=v.totalLength;return i&&f&&f.length&&(!b&&T>0||!Ff(b,f))?this.renderCurveWithAnimation(r,a):this.renderCurveStatically(f,r,a)}},{key:"render",value:function(){var r,a=this.props,c=a.hide,f=a.dot,i=a.points,v=a.className,b=a.xAxis,T=a.yAxis,A=a.top,M=a.left,R=a.width,B=a.height,L=a.isAnimationActive,j=a.id;if(c||!i||!i.length)return null;var V=this.state.isAnimationFinished,$=i.length===1,H=jr("recharts-line",v),K=b&&b.allowDataOverflow,Y=T&&T.allowDataOverflow,se=K||Y,ce=xr(j)?this.id:j,ye=(r=ir(f,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},ze=ye.r,Le=ze===void 0?3:ze,je=ye.strokeWidth,Re=je===void 0?2:je,$e=dY(f)?f:{},Ge=$e.clipDot,ht=Ge===void 0?!0:Ge,ot=Le*2+Re;return Se.createElement(Wr,{className:H},K||Y?Se.createElement("defs",null,Se.createElement("clipPath",{id:"clipPath-".concat(ce)},Se.createElement("rect",{x:K?M:M-R/2,y:Y?A:A-B/2,width:K?R:R*2,height:Y?B:B*2})),!ht&&Se.createElement("clipPath",{id:"clipPath-dots-".concat(ce)},Se.createElement("rect",{x:M-ot/2,y:A-ot/2,width:R+ot,height:B+ot}))):null,!$&&this.renderCurve(se,ce),this.renderErrorBar(se,ce),($||f)&&this.renderDots(se,ht,ce),(!L||V)&&kc.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:a.curPoints}:r.points!==a.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,a){for(var c=r.length%2!==0?[].concat(zy(r),[0]):r,f=[],i=0;i<a;++i)f=[].concat(zy(f),zy(c));return f}},{key:"renderDotItem",value:function(r,a){var c;if(Se.isValidElement(r))c=Se.cloneElement(r,a);else if(Tr(r))c=r(a);else{var f=a.key,i=dW(a,uVe),v=jr("recharts-line-dot",typeof r!="boolean"?r.className:"");c=Se.createElement(Gw,U1({key:f},i,{className:v}))}return c}}])}(X.PureComponent);wc(YC,"displayName","Line");wc(YC,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ul.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});wc(YC,"getComposedData",function(e){var t=e.props,n=e.xAxis,r=e.yAxis,a=e.xAxisTicks,c=e.yAxisTicks,f=e.dataKey,i=e.bandSize,v=e.displayedData,b=e.offset,T=t.layout,A=v.map(function(M,R){var B=fo(M,f);return T==="horizontal"?{x:G_({axis:n,ticks:a,bandSize:i,entry:M,index:R}),y:xr(B)?null:r.scale(B),value:B,payload:M}:{x:xr(B)?null:n.scale(B),y:G_({axis:r,ticks:c,bandSize:i,entry:M,index:R}),value:B,payload:M}});return sl({points:A,layout:T},b)});var SVe=["layout","type","stroke","connectNulls","isRange","ref"],TVe=["key"],Cee;function rv(e){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rv(e)}function Iee(e,t){if(e==null)return{};var n=EVe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function EVe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function _m(){return _m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_m.apply(this,arguments)}function mW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mW(Object(n),!0).forEach(function(r){gu(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function AVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Oee(r.key),r)}}function PVe(e,t,n){return t&&gW(e.prototype,t),n&&gW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function CVe(e,t,n){return t=QA(t),IVe(e,Mee()?Reflect.construct(t,n||[],QA(e).constructor):t.apply(e,n))}function IVe(e,t){if(t&&(rv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MVe(e)}function MVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mee=function(){return!!e})()}function QA(e){return QA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},QA(e)}function OVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WL(e,t)}function WL(e,t){return WL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},WL(e,t)}function gu(e,t,n){return t=Oee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oee(e){var t=kVe(e,"string");return rv(t)=="symbol"?t:t+""}function kVe(e,t){if(rv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(rv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rg=function(e){function t(){var n;AVe(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=CVe(this,t,[].concat(a)),gu(n,"state",{isAnimationFinished:!0}),gu(n,"id",Zf("recharts-area-")),gu(n,"handleAnimationEnd",function(){var f=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Tr(f)&&f()}),gu(n,"handleAnimationStart",function(){var f=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Tr(f)&&f()}),n}return OVe(t,e),PVe(t,[{key:"renderDots",value:function(r,a,c){var f=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(f&&!i)return null;var v=this.props,b=v.dot,T=v.points,A=v.dataKey,M=ir(this.props,!1),R=ir(b,!0),B=T.map(function(j,V){var $=qd(qd(qd({key:"dot-".concat(V),r:3},M),R),{},{index:V,cx:j.x,cy:j.y,dataKey:A,value:j.value,payload:j.payload,points:T});return t.renderDotItem(b,$)}),L={clipPath:r?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return Se.createElement(Wr,_m({className:"recharts-area-dots"},L),B)}},{key:"renderHorizontalRect",value:function(r){var a=this.props,c=a.baseLine,f=a.points,i=a.strokeWidth,v=f[0].x,b=f[f.length-1].x,T=r*Math.abs(v-b),A=lf(f.map(function(M){return M.y||0}));return wn(c)&&typeof c=="number"?A=Math.max(c,A):c&&Array.isArray(c)&&c.length&&(A=Math.max(lf(c.map(function(M){return M.y||0})),A)),wn(A)?Se.createElement("rect",{x:v<b?v:v-T,y:0,width:T,height:Math.floor(A+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var a=this.props,c=a.baseLine,f=a.points,i=a.strokeWidth,v=f[0].y,b=f[f.length-1].y,T=r*Math.abs(v-b),A=lf(f.map(function(M){return M.x||0}));return wn(c)&&typeof c=="number"?A=Math.max(c,A):c&&Array.isArray(c)&&c.length&&(A=Math.max(lf(c.map(function(M){return M.x||0})),A)),wn(A)?Se.createElement("rect",{x:0,y:v<b?v:v-T,width:A+(i?parseInt("".concat(i),10):1),height:Math.floor(T)}):null}},{key:"renderClipRect",value:function(r){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,a,c,f){var i=this.props,v=i.layout,b=i.type,T=i.stroke,A=i.connectNulls,M=i.isRange;i.ref;var R=Iee(i,SVe);return Se.createElement(Wr,{clipPath:c?"url(#clipPath-".concat(f,")"):null},Se.createElement(Tf,_m({},ir(R,!0),{points:r,connectNulls:A,type:b,baseLine:a,layout:v,stroke:"none",className:"recharts-area-area"})),T!=="none"&&Se.createElement(Tf,_m({},ir(this.props,!1),{className:"recharts-area-curve",layout:v,type:b,connectNulls:A,fill:"none",points:r})),T!=="none"&&M&&Se.createElement(Tf,_m({},ir(this.props,!1),{className:"recharts-area-curve",layout:v,type:b,connectNulls:A,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(r,a){var c=this,f=this.props,i=f.points,v=f.baseLine,b=f.isAnimationActive,T=f.animationBegin,A=f.animationDuration,M=f.animationEasing,R=f.animationId,B=this.state,L=B.prevPoints,j=B.prevBaseLine;return Se.createElement(Hl,{begin:T,duration:A,isActive:b,easing:M,from:{t:0},to:{t:1},key:"area-".concat(R),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(V){var $=V.t;if(L){var H=L.length/i.length,K=i.map(function(ye,ze){var Le=Math.floor(ze*H);if(L[Le]){var je=L[Le],Re=Ao(je.x,ye.x),$e=Ao(je.y,ye.y);return qd(qd({},ye),{},{x:Re($),y:$e($)})}return ye}),Y;if(wn(v)&&typeof v=="number"){var se=Ao(j,v);Y=se($)}else if(xr(v)||kv(v)){var ce=Ao(j,0);Y=ce($)}else Y=v.map(function(ye,ze){var Le=Math.floor(ze*H);if(j[Le]){var je=j[Le],Re=Ao(je.x,ye.x),$e=Ao(je.y,ye.y);return qd(qd({},ye),{},{x:Re($),y:$e($)})}return ye});return c.renderAreaStatically(K,Y,r,a)}return Se.createElement(Wr,null,Se.createElement("defs",null,Se.createElement("clipPath",{id:"animationClipPath-".concat(a)},c.renderClipRect($))),Se.createElement(Wr,{clipPath:"url(#animationClipPath-".concat(a,")")},c.renderAreaStatically(i,v,r,a)))})}},{key:"renderArea",value:function(r,a){var c=this.props,f=c.points,i=c.baseLine,v=c.isAnimationActive,b=this.state,T=b.prevPoints,A=b.prevBaseLine,M=b.totalLength;return v&&f&&f.length&&(!T&&M>0||!Ff(T,f)||!Ff(A,i))?this.renderAreaWithAnimation(r,a):this.renderAreaStatically(f,i,r,a)}},{key:"render",value:function(){var r,a=this.props,c=a.hide,f=a.dot,i=a.points,v=a.className,b=a.top,T=a.left,A=a.xAxis,M=a.yAxis,R=a.width,B=a.height,L=a.isAnimationActive,j=a.id;if(c||!i||!i.length)return null;var V=this.state.isAnimationFinished,$=i.length===1,H=jr("recharts-area",v),K=A&&A.allowDataOverflow,Y=M&&M.allowDataOverflow,se=K||Y,ce=xr(j)?this.id:j,ye=(r=ir(f,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},ze=ye.r,Le=ze===void 0?3:ze,je=ye.strokeWidth,Re=je===void 0?2:je,$e=dY(f)?f:{},Ge=$e.clipDot,ht=Ge===void 0?!0:Ge,ot=Le*2+Re;return Se.createElement(Wr,{className:H},K||Y?Se.createElement("defs",null,Se.createElement("clipPath",{id:"clipPath-".concat(ce)},Se.createElement("rect",{x:K?T:T-R/2,y:Y?b:b-B/2,width:K?R:R*2,height:Y?B:B*2})),!ht&&Se.createElement("clipPath",{id:"clipPath-dots-".concat(ce)},Se.createElement("rect",{x:T-ot/2,y:b-ot/2,width:R+ot,height:B+ot}))):null,$?null:this.renderArea(se,ce),(f||$)&&this.renderDots(se,ht,ce),(!L||V)&&kc.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:r.points!==a.curPoints||r.baseLine!==a.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])}(X.PureComponent);Cee=rg;gu(rg,"displayName","Area");gu(rg,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Ul.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});gu(rg,"getBaseValue",function(e,t,n,r){var a=e.layout,c=e.baseValue,f=t.props.baseValue,i=f??c;if(wn(i)&&typeof i=="number")return i;var v=a==="horizontal"?r:n,b=v.scale.domain();if(v.type==="number"){var T=Math.max(b[0],b[1]),A=Math.min(b[0],b[1]);return i==="dataMin"?A:i==="dataMax"||T<0?T:Math.max(Math.min(b[0],b[1]),0)}return i==="dataMin"?b[0]:i==="dataMax"?b[1]:b[0]});gu(rg,"getComposedData",function(e){var t=e.props,n=e.item,r=e.xAxis,a=e.yAxis,c=e.xAxisTicks,f=e.yAxisTicks,i=e.bandSize,v=e.dataKey,b=e.stackedData,T=e.dataStartIndex,A=e.displayedData,M=e.offset,R=t.layout,B=b&&b.length,L=Cee.getBaseValue(t,n,r,a),j=R==="horizontal",V=!1,$=A.map(function(K,Y){var se;B?se=b[T+Y]:(se=fo(K,v),Array.isArray(se)?V=!0:se=[L,se]);var ce=se[1]==null||B&&fo(K,v)==null;return j?{x:G_({axis:r,ticks:c,bandSize:i,entry:K,index:Y}),y:ce?null:a.scale(se[1]),value:se,payload:K}:{x:ce?null:r.scale(se[1]),y:G_({axis:a,ticks:f,bandSize:i,entry:K,index:Y}),value:se,payload:K}}),H;return B||V?H=$.map(function(K){var Y=Array.isArray(K.value)?K.value[0]:null;return j?{x:K.x,y:Y!=null&&K.y!=null?a.scale(Y):null}:{x:Y!=null?r.scale(Y):null,y:K.y}}):H=j?a.scale(L):r.scale(L),qd({points:$,baseLine:H,layout:R,isRange:V},M)});gu(rg,"renderDotItem",function(e,t){var n;if(Se.isValidElement(e))n=Se.cloneElement(e,t);else if(Tr(e))n=e(t);else{var r=jr("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,c=Iee(t,TVe);n=Se.createElement(Gw,_m({},c,{key:a,className:r}))}return n});function iv(e){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iv(e)}function RVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DVe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Dee(r.key),r)}}function LVe(e,t,n){return t&&DVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zVe(e,t,n){return t=eP(t),NVe(e,kee()?Reflect.construct(t,n||[],eP(e).constructor):t.apply(e,n))}function NVe(e,t){if(t&&(iv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FVe(e)}function FVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kee=function(){return!!e})()}function eP(e){return eP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},eP(e)}function BVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HL(e,t)}function HL(e,t){return HL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},HL(e,t)}function Ree(e,t,n){return t=Dee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dee(e){var t=jVe(e,"string");return iv(t)=="symbol"?t:t+""}function jVe(e,t){if(iv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(iv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JC=function(e){function t(){return RVe(this,t),zVe(this,t,arguments)}return BVe(t,e),LVe(t,[{key:"render",value:function(){return null}}])}(Se.Component);Ree(JC,"displayName","ZAxis");Ree(JC,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var $Ve=["option","isActive"];function V1(){return V1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},V1.apply(this,arguments)}function UVe(e,t){if(e==null)return{};var n=VVe(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function VVe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function GVe(e){var t=e.option,n=e.isActive,r=UVe(e,$Ve);return typeof t=="string"?Se.createElement(jA,V1({option:Se.createElement(TC,V1({type:t},r)),isActive:n,shapeType:"symbols"},r)):Se.createElement(jA,V1({option:t,isActive:n,shapeType:"symbols"},r))}function ov(e){"@babel/helpers - typeof";return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ov(e)}function G1(){return G1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},G1.apply(this,arguments)}function yW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Rl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yW(Object(n),!0).forEach(function(r){uf(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zee(r.key),r)}}function HVe(e,t,n){return t&&_W(e.prototype,t),n&&_W(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qVe(e,t,n){return t=tP(t),ZVe(e,Lee()?Reflect.construct(t,n||[],tP(e).constructor):t.apply(e,n))}function ZVe(e,t){if(t&&(ov(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XVe(e)}function XVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lee=function(){return!!e})()}function tP(e){return tP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},tP(e)}function KVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qL(e,t)}function qL(e,t){return qL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},qL(e,t)}function uf(e,t,n){return t=zee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zee(e){var t=YVe(e,"string");return ov(t)=="symbol"?t:t+""}function YVe(e,t){if(ov(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ov(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QC=function(e){function t(){var n;WVe(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=qVe(this,t,[].concat(a)),uf(n,"state",{isAnimationFinished:!1}),uf(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0})}),uf(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1})}),uf(n,"id",Zf("recharts-scatter-")),n}return KVe(t,e),HVe(t,[{key:"renderSymbolsStatically",value:function(r){var a=this,c=this.props,f=c.shape,i=c.activeShape,v=c.activeIndex,b=ir(this.props,!1);return r.map(function(T,A){var M=v===A,R=M?i:f,B=Rl(Rl({},b),T);return Se.createElement(Wr,G1({className:"recharts-scatter-symbol",key:"symbol-".concat(T==null?void 0:T.cx,"-").concat(T==null?void 0:T.cy,"-").concat(T==null?void 0:T.size,"-").concat(A)},zf(a.props,T,A),{role:"img"}),Se.createElement(GVe,G1({option:R,isActive:M,key:"symbol-".concat(A)},B)))})}},{key:"renderSymbolsWithAnimation",value:function(){var r=this,a=this.props,c=a.points,f=a.isAnimationActive,i=a.animationBegin,v=a.animationDuration,b=a.animationEasing,T=a.animationId,A=this.state.prevPoints;return Se.createElement(Hl,{begin:i,duration:v,isActive:f,easing:b,from:{t:0},to:{t:1},key:"pie-".concat(T),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(M){var R=M.t,B=c.map(function(L,j){var V=A&&A[j];if(V){var $=Ao(V.cx,L.cx),H=Ao(V.cy,L.cy),K=Ao(V.size,L.size);return Rl(Rl({},L),{},{cx:$(R),cy:H(R),size:K(R)})}var Y=Ao(0,L.size);return Rl(Rl({},L),{},{size:Y(R)})});return Se.createElement(Wr,null,r.renderSymbolsStatically(B))})}},{key:"renderSymbols",value:function(){var r=this.props,a=r.points,c=r.isAnimationActive,f=this.state.prevPoints;return c&&a&&a.length&&(!f||!Ff(f,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var r=this.props.isAnimationActive;if(r&&!this.state.isAnimationFinished)return null;var a=this.props,c=a.points,f=a.xAxis,i=a.yAxis,v=a.children,b=gs(v,Bv);return b?b.map(function(T,A){var M=T.props,R=M.direction,B=M.dataKey;return Se.cloneElement(T,{key:"".concat(R,"-").concat(B,"-").concat(c[A]),data:c,xAxis:f,yAxis:i,layout:R==="x"?"vertical":"horizontal",dataPointFormatter:function(j,V){return{x:j.cx,y:j.cy,value:R==="x"?+j.node.x:+j.node.y,errorVal:fo(j,V)}}})}):null}},{key:"renderLine",value:function(){var r=this.props,a=r.points,c=r.line,f=r.lineType,i=r.lineJointType,v=ir(this.props,!1),b=ir(c,!1),T,A;if(f==="joint")T=a.map(function(H){return{x:H.cx,y:H.cy}});else if(f==="fitting"){var M=RSe(a),R=M.xmin,B=M.xmax,L=M.a,j=M.b,V=function(K){return L*K+j};T=[{x:R,y:V(R)},{x:B,y:V(B)}]}var $=Rl(Rl(Rl({},v),{},{fill:"none",stroke:v&&v.fill},b),{},{points:T});return Se.isValidElement(c)?A=Se.cloneElement(c,$):Tr(c)?A=c($):A=Se.createElement(Tf,G1({},$,{type:i})),Se.createElement(Wr,{className:"recharts-scatter-line",key:"recharts-scatter-line"},A)}},{key:"render",value:function(){var r=this.props,a=r.hide,c=r.points,f=r.line,i=r.className,v=r.xAxis,b=r.yAxis,T=r.left,A=r.top,M=r.width,R=r.height,B=r.id,L=r.isAnimationActive;if(a||!c||!c.length)return null;var j=this.state.isAnimationFinished,V=jr("recharts-scatter",i),$=v&&v.allowDataOverflow,H=b&&b.allowDataOverflow,K=$||H,Y=xr(B)?this.id:B;return Se.createElement(Wr,{className:V,clipPath:K?"url(#clipPath-".concat(Y,")"):null},$||H?Se.createElement("defs",null,Se.createElement("clipPath",{id:"clipPath-".concat(Y)},Se.createElement("rect",{x:$?T:T-M/2,y:H?A:A-R/2,width:$?M:M*2,height:H?R:R*2}))):null,f&&this.renderLine(),this.renderErrorBar(),Se.createElement(Wr,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!L||j)&&kc.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:a.curPoints}:r.points!==a.curPoints?{curPoints:r.points}:null}}])}(X.PureComponent);uf(QC,"displayName","Scatter");uf(QC,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Ul.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});uf(QC,"getComposedData",function(e){var t=e.xAxis,n=e.yAxis,r=e.zAxis,a=e.item,c=e.displayedData,f=e.xAxisTicks,i=e.yAxisTicks,v=e.offset,b=a.props.tooltipType,T=gs(a.props.children,CC),A=xr(t.dataKey)?a.props.dataKey:t.dataKey,M=xr(n.dataKey)?a.props.dataKey:n.dataKey,R=r&&r.dataKey,B=r?r.range:JC.defaultProps.range,L=B&&B[0],j=t.scale.bandwidth?t.scale.bandwidth():0,V=n.scale.bandwidth?n.scale.bandwidth():0,$=c.map(function(H,K){var Y=fo(H,A),se=fo(H,M),ce=!xr(R)&&fo(H,R)||"-",ye=[{name:xr(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:Y,payload:H,dataKey:A,type:b},{name:xr(n.dataKey)?a.props.name:n.name||n.dataKey,unit:n.unit||"",value:se,payload:H,dataKey:M,type:b}];ce!=="-"&&ye.push({name:r.name||r.dataKey,unit:r.unit||"",value:ce,payload:H,dataKey:R,type:b});var ze=G_({axis:t,ticks:f,bandSize:j,entry:H,index:K,dataKey:A}),Le=G_({axis:n,ticks:i,bandSize:V,entry:H,index:K,dataKey:M}),je=ce!=="-"?r.scale(ce):L,Re=Math.sqrt(Math.max(je,0)/Math.PI);return Rl(Rl({},H),{},{cx:ze,cy:Le,x:ze-Re,y:Le-Re,xAxis:t,yAxis:n,zAxis:r,width:2*Re,height:2*Re,size:je,node:{x:Y,y:se,z:ce},tooltipPayload:ye,tooltipPosition:{x:ze,y:Le},payload:H},T&&T[K]&&T[K].props)});return Rl({points:$},v)});function av(e){"@babel/helpers - typeof";return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},av(e)}function JVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QVe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bee(r.key),r)}}function e6e(e,t,n){return t&&QVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function t6e(e,t,n){return t=nP(t),n6e(e,Nee()?Reflect.construct(t,n||[],nP(e).constructor):t.apply(e,n))}function n6e(e,t){if(t&&(av(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r6e(e)}function r6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nee=function(){return!!e})()}function nP(e){return nP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},nP(e)}function i6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZL(e,t)}function ZL(e,t){return ZL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},ZL(e,t)}function Fee(e,t,n){return t=Bee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bee(e){var t=o6e(e,"string");return av(t)=="symbol"?t:t+""}function o6e(e,t){if(av(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(av(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XL(){return XL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XL.apply(this,arguments)}function a6e(e){var t=e.xAxisId,n=mF(),r=gF(),a=pee(t);return a==null?null:Se.createElement(Uv,XL({},a,{className:jr("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(f){return Ah(f,!0)}}))}var Vv=function(e){function t(){return JVe(this,t),t6e(this,t,arguments)}return i6e(t,e),e6e(t,[{key:"render",value:function(){return Se.createElement(a6e,this.props)}}])}(Se.Component);Fee(Vv,"displayName","XAxis");Fee(Vv,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function sv(e){"@babel/helpers - typeof";return sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sv(e)}function s6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l6e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Uee(r.key),r)}}function c6e(e,t,n){return t&&l6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function u6e(e,t,n){return t=rP(t),h6e(e,jee()?Reflect.construct(t,n||[],rP(e).constructor):t.apply(e,n))}function h6e(e,t){if(t&&(sv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d6e(e)}function d6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jee=function(){return!!e})()}function rP(e){return rP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},rP(e)}function f6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KL(e,t)}function KL(e,t){return KL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},KL(e,t)}function $ee(e,t,n){return t=Uee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uee(e){var t=p6e(e,"string");return sv(t)=="symbol"?t:t+""}function p6e(e,t){if(sv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YL(){return YL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YL.apply(this,arguments)}var m6e=function(t){var n=t.yAxisId,r=mF(),a=gF(),c=mee(n);return c==null?null:Se.createElement(Uv,YL({},c,{className:jr("recharts-".concat(c.axisType," ").concat(c.axisType),c.className),viewBox:{x:0,y:0,width:r,height:a},ticksGenerator:function(i){return Ah(i,!0)}}))},Gv=function(e){function t(){return s6e(this,t),u6e(this,t,arguments)}return f6e(t,e),c6e(t,[{key:"render",value:function(){return Se.createElement(m6e,this.props)}}])}(Se.Component);$ee(Gv,"displayName","YAxis");$ee(Gv,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function vW(e){return v6e(e)||_6e(e)||y6e(e)||g6e()}function g6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y6e(e,t){if(e){if(typeof e=="string")return JL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JL(e,t)}}function _6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function v6e(e){if(Array.isArray(e))return JL(e)}function JL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var QL=function(t,n,r,a,c){var f=gs(t,_F),i=gs(t,ZC),v=[].concat(vW(f),vW(i)),b=gs(t,KC),T="".concat(a,"Id"),A=a[0],M=n;if(v.length&&(M=v.reduce(function(L,j){if(j.props[T]===r&&bu(j.props,"extendDomain")&&wn(j.props[A])){var V=j.props[A];return[Math.min(L[0],V),Math.max(L[1],V)]}return L},M)),b.length){var R="".concat(A,"1"),B="".concat(A,"2");M=b.reduce(function(L,j){if(j.props[T]===r&&bu(j.props,"extendDomain")&&wn(j.props[R])&&wn(j.props[B])){var V=j.props[R],$=j.props[B];return[Math.min(L[0],V,$),Math.max(L[1],V,$)]}return L},M)}return c&&c.length&&(M=c.reduce(function(L,j){return wn(j)?[Math.min(L[0],j),Math.max(L[1],j)]:L},M)),M},Vee={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(v,b,T){this.fn=v,this.context=b,this.once=T||!1}function c(v,b,T,A,M){if(typeof T!="function")throw new TypeError("The listener must be a function");var R=new a(T,A||v,M),B=n?n+b:b;return v._events[B]?v._events[B].fn?v._events[B]=[v._events[B],R]:v._events[B].push(R):(v._events[B]=R,v._eventsCount++),v}function f(v,b){--v._eventsCount===0?v._events=new r:delete v._events[b]}function i(){this._events=new r,this._eventsCount=0}i.prototype.eventNames=function(){var b=[],T,A;if(this._eventsCount===0)return b;for(A in T=this._events)t.call(T,A)&&b.push(n?A.slice(1):A);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(T)):b},i.prototype.listeners=function(b){var T=n?n+b:b,A=this._events[T];if(!A)return[];if(A.fn)return[A.fn];for(var M=0,R=A.length,B=new Array(R);M<R;M++)B[M]=A[M].fn;return B},i.prototype.listenerCount=function(b){var T=n?n+b:b,A=this._events[T];return A?A.fn?1:A.length:0},i.prototype.emit=function(b,T,A,M,R,B){var L=n?n+b:b;if(!this._events[L])return!1;var j=this._events[L],V=arguments.length,$,H;if(j.fn){switch(j.once&&this.removeListener(b,j.fn,void 0,!0),V){case 1:return j.fn.call(j.context),!0;case 2:return j.fn.call(j.context,T),!0;case 3:return j.fn.call(j.context,T,A),!0;case 4:return j.fn.call(j.context,T,A,M),!0;case 5:return j.fn.call(j.context,T,A,M,R),!0;case 6:return j.fn.call(j.context,T,A,M,R,B),!0}for(H=1,$=new Array(V-1);H<V;H++)$[H-1]=arguments[H];j.fn.apply(j.context,$)}else{var K=j.length,Y;for(H=0;H<K;H++)switch(j[H].once&&this.removeListener(b,j[H].fn,void 0,!0),V){case 1:j[H].fn.call(j[H].context);break;case 2:j[H].fn.call(j[H].context,T);break;case 3:j[H].fn.call(j[H].context,T,A);break;case 4:j[H].fn.call(j[H].context,T,A,M);break;default:if(!$)for(Y=1,$=new Array(V-1);Y<V;Y++)$[Y-1]=arguments[Y];j[H].fn.apply(j[H].context,$)}}return!0},i.prototype.on=function(b,T,A){return c(this,b,T,A,!1)},i.prototype.once=function(b,T,A){return c(this,b,T,A,!0)},i.prototype.removeListener=function(b,T,A,M){var R=n?n+b:b;if(!this._events[R])return this;if(!T)return f(this,R),this;var B=this._events[R];if(B.fn)B.fn===T&&(!M||B.once)&&(!A||B.context===A)&&f(this,R);else{for(var L=0,j=[],V=B.length;L<V;L++)(B[L].fn!==T||M&&!B[L].once||A&&B[L].context!==A)&&j.push(B[L]);j.length?this._events[R]=j.length===1?j[0]:j:f(this,R)}return this},i.prototype.removeAllListeners=function(b){var T;return b?(T=n?n+b:b,this._events[T]&&f(this,T)):(this._events=new r,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=n,i.EventEmitter=i,e.exports=i})(Vee);var x6e=Vee.exports;const b6e=Bi(x6e);var $k=new b6e,Uk="recharts.syncMouseEvents";function lw(e){"@babel/helpers - typeof";return lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lw(e)}function w6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S6e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gee(r.key),r)}}function T6e(e,t,n){return t&&S6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vk(e,t,n){return t=Gee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gee(e){var t=E6e(e,"string");return lw(t)=="symbol"?t:t+""}function E6e(e,t){if(lw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(lw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var A6e=function(){function e(){w6e(this,e),Vk(this,"activeIndex",0),Vk(this,"coordinateList",[]),Vk(this,"layout","horizontal")}return T6e(e,[{key:"setDetails",value:function(n){var r,a=n.coordinateList,c=a===void 0?null:a,f=n.container,i=f===void 0?null:f,v=n.layout,b=v===void 0?null:v,T=n.offset,A=T===void 0?null:T,M=n.mouseHandlerCallback,R=M===void 0?null:M;this.coordinateList=(r=c??this.coordinateList)!==null&&r!==void 0?r:[],this.container=i??this.container,this.layout=b??this.layout,this.offset=A??this.offset,this.mouseHandlerCallback=R??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),c=a.x,f=a.y,i=a.height,v=this.coordinateList[this.activeIndex].coordinate,b=((n=window)===null||n===void 0?void 0:n.scrollX)||0,T=((r=window)===null||r===void 0?void 0:r.scrollY)||0,A=c+v+b,M=f+this.offset.top+i/2+T;this.mouseHandlerCallback({pageX:A,pageY:M})}}}])}();function P6e(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&wn(r)&&wn(a))return!0}return!1}function C6e(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function Wee(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,c=e.endAngle,f=oo(t,n,r,a),i=oo(t,n,r,c);return{points:[f,i],cx:t,cy:n,radius:r,startAngle:a,endAngle:c}}function I6e(e,t,n){var r,a,c,f;if(e==="horizontal")r=t.x,c=r,a=n.top,f=n.top+n.height;else if(e==="vertical")a=t.y,f=a,r=n.left,c=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,v=t.cy,b=t.innerRadius,T=t.outerRadius,A=t.angle,M=oo(i,v,b,A),R=oo(i,v,T,A);r=M.x,a=M.y,c=R.x,f=R.y}else return Wee(t);return[{x:r,y:a},{x:c,y:f}]}function cw(e){"@babel/helpers - typeof";return cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cw(e)}function xW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function LE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xW(Object(n),!0).forEach(function(r){M6e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function M6e(e,t,n){return t=O6e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O6e(e){var t=k6e(e,"string");return cw(t)=="symbol"?t:t+""}function k6e(e,t){if(cw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R6e(e){var t,n,r=e.element,a=e.tooltipEventType,c=e.isActive,f=e.activeCoordinate,i=e.activePayload,v=e.offset,b=e.activeTooltipIndex,T=e.tooltipAxisBandSize,A=e.layout,M=e.chartName,R=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!R||!c||!f||M!=="ScatterChart"&&a!=="axis")return null;var B,L=Tf;if(M==="ScatterChart")B=f,L=bje;else if(M==="BarChart")B=C6e(A,f,v,T),L=hF;else if(A==="radial"){var j=Wee(f),V=j.cx,$=j.cy,H=j.radius,K=j.startAngle,Y=j.endAngle;B={cx:V,cy:$,startAngle:K,endAngle:Y,innerRadius:H,outerRadius:H},L=RQ}else B={points:I6e(A,f,v)},L=Tf;var se=LE(LE(LE(LE({stroke:"#ccc",pointerEvents:"none"},v),B),ir(R,!1)),{},{payload:i,payloadIndex:b,className:jr("recharts-tooltip-cursor",R.className)});return X.isValidElement(R)?X.cloneElement(R,se):X.createElement(L,se)}var D6e=["item"],L6e=["children","className","width","height","style","compact","title","desc"];function lv(e){"@babel/helpers - typeof";return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lv(e)}function W1(){return W1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W1.apply(this,arguments)}function bW(e,t){return F6e(e)||N6e(e,t)||qee(e,t)||z6e()}function z6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N6e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,c,f,i=[],v=!0,b=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(v=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);v=!0);}catch(T){b=!0,a=T}finally{try{if(!v&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function F6e(e){if(Array.isArray(e))return e}function wW(e,t){if(e==null)return{};var n=B6e(e,t),r,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function B6e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function j6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $6e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Zee(r.key),r)}}function U6e(e,t,n){return t&&$6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function V6e(e,t,n){return t=iP(t),G6e(e,Hee()?Reflect.construct(t,n||[],iP(e).constructor):t.apply(e,n))}function G6e(e,t){if(t&&(lv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W6e(e)}function W6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hee=function(){return!!e})()}function iP(e){return iP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},iP(e)}function H6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ez(e,t)}function ez(e,t){return ez=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},ez(e,t)}function cv(e){return X6e(e)||Z6e(e)||qee(e)||q6e()}function q6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qee(e,t){if(e){if(typeof e=="string")return tz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tz(e,t)}}function Z6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function X6e(e){if(Array.isArray(e))return tz(e)}function tz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function SW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Wt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SW(Object(n),!0).forEach(function(r){Ar(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Ar(e,t,n){return t=Zee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zee(e){var t=K6e(e,"string");return lv(t)=="symbol"?t:t+""}function K6e(e,t){if(lv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(lv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y6e={xAxis:["bottom","top"],yAxis:["left","right"]},J6e={width:"100%",height:"100%"},Xee={x:0,y:0};function zE(e){return e}var Q6e=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},e8e=function(t,n,r,a){var c=n.find(function(T){return T&&T.index===r});if(c){if(t==="horizontal")return{x:c.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:c.coordinate};if(t==="centric"){var f=c.coordinate,i=a.radius;return Wt(Wt(Wt({},a),oo(a.cx,a.cy,i,f)),{},{angle:f,radius:i})}var v=c.coordinate,b=a.angle;return Wt(Wt(Wt({},a),oo(a.cx,a.cy,v,b)),{},{angle:b,radius:v})}return Xee},eI=function(t,n){var r=n.graphicalItems,a=n.dataStartIndex,c=n.dataEndIndex,f=(r??[]).reduce(function(i,v){var b=v.props.data;return b&&b.length?[].concat(cv(i),cv(b)):i},[]);return f.length>0?f:t&&t.length&&wn(a)&&wn(c)?t.slice(a,c+1):[]};function Kee(e){return e==="number"?[0,"auto"]:void 0}var nz=function(t,n,r,a){var c=t.graphicalItems,f=t.tooltipAxis,i=eI(n,t);return r<0||!c||!c.length||r>=i.length?null:c.reduce(function(v,b){var T,A=(T=b.props.data)!==null&&T!==void 0?T:n;A&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=r&&(A=A.slice(t.dataStartIndex,t.dataEndIndex+1));var M;if(f.dataKey&&!f.allowDuplicatedCategory){var R=A===void 0?i:A;M=nA(R,f.dataKey,a)}else M=A&&A[r]||i[r];return M?[].concat(cv(v),[PQ(b,M)]):v},[])},TW=function(t,n,r,a){var c=a||{x:t.chartX,y:t.chartY},f=Q6e(c,r),i=t.orderedTooltipTicks,v=t.tooltipAxis,b=t.tooltipTicks,T=tNe(f,i,b,v);if(T>=0&&b){var A=b[T]&&b[T].value,M=nz(t,n,T,A),R=e8e(r,i,T,c);return{activeTooltipIndex:T,activeLabel:A,activePayload:M,activeCoordinate:R}}return null},t8e=function(t,n){var r=n.axes,a=n.graphicalItems,c=n.axisType,f=n.axisIdKey,i=n.stackGroups,v=n.dataStartIndex,b=n.dataEndIndex,T=t.layout,A=t.children,M=t.stackOffset,R=bQ(T,c);return r.reduce(function(B,L){var j,V=L.type.defaultProps!==void 0?Wt(Wt({},L.type.defaultProps),L.props):L.props,$=V.type,H=V.dataKey,K=V.allowDataOverflow,Y=V.allowDuplicatedCategory,se=V.scale,ce=V.ticks,ye=V.includeHidden,ze=V[f];if(B[ze])return B;var Le=eI(t.data,{graphicalItems:a.filter(function(Ft){var un,Tn=f in Ft.props?Ft.props[f]:(un=Ft.type.defaultProps)===null||un===void 0?void 0:un[f];return Tn===ze}),dataStartIndex:v,dataEndIndex:b}),je=Le.length,Re,$e,Ge;P6e(V.domain,K,$)&&(Re=fL(V.domain,null,K),R&&($==="number"||se!=="auto")&&(Ge=F1(Le,H,"category")));var ht=Kee($);if(!Re||Re.length===0){var ot,Je=(ot=V.domain)!==null&&ot!==void 0?ot:ht;if(H){if(Re=F1(Le,H,$),$==="category"&&R){var Ne=kSe(Re);Y&&Ne?($e=Re,Re=UA(0,je)):Y||(Re=U8(Je,Re,L).reduce(function(Ft,un){return Ft.indexOf(un)>=0?Ft:[].concat(cv(Ft),[un])},[]))}else if($==="category")Y?Re=Re.filter(function(Ft){return Ft!==""&&!xr(Ft)}):Re=U8(Je,Re,L).reduce(function(Ft,un){return Ft.indexOf(un)>=0||un===""||xr(un)?Ft:[].concat(cv(Ft),[un])},[]);else if($==="number"){var Xe=aNe(Le,a.filter(function(Ft){var un,Tn,fn=f in Ft.props?Ft.props[f]:(un=Ft.type.defaultProps)===null||un===void 0?void 0:un[f],Cn="hide"in Ft.props?Ft.props.hide:(Tn=Ft.type.defaultProps)===null||Tn===void 0?void 0:Tn.hide;return fn===ze&&(ye||!Cn)}),H,c,T);Xe&&(Re=Xe)}R&&($==="number"||se!=="auto")&&(Ge=F1(Le,H,"category"))}else R?Re=UA(0,je):i&&i[ze]&&i[ze].hasStack&&$==="number"?Re=M==="expand"?[0,1]:AQ(i[ze].stackGroups,v,b):Re=xQ(Le,a.filter(function(Ft){var un=f in Ft.props?Ft.props[f]:Ft.type.defaultProps[f],Tn="hide"in Ft.props?Ft.props.hide:Ft.type.defaultProps.hide;return un===ze&&(ye||!Tn)}),$,T,!0);if($==="number")Re=QL(A,Re,ze,c,ce),Je&&(Re=fL(Je,Re,K));else if($==="category"&&Je){var pt=Je,zt=Re.every(function(Ft){return pt.indexOf(Ft)>=0});zt&&(Re=pt)}}return Wt(Wt({},B),{},Ar({},ze,Wt(Wt({},V),{},{axisType:c,domain:Re,categoricalDomain:Ge,duplicateDomain:$e,originalDomain:(j=V.domain)!==null&&j!==void 0?j:ht,isCategorical:R,layout:T})))},{})},n8e=function(t,n){var r=n.graphicalItems,a=n.Axis,c=n.axisType,f=n.axisIdKey,i=n.stackGroups,v=n.dataStartIndex,b=n.dataEndIndex,T=t.layout,A=t.children,M=eI(t.data,{graphicalItems:r,dataStartIndex:v,dataEndIndex:b}),R=M.length,B=bQ(T,c),L=-1;return r.reduce(function(j,V){var $=V.type.defaultProps!==void 0?Wt(Wt({},V.type.defaultProps),V.props):V.props,H=$[f],K=Kee("number");if(!j[H]){L++;var Y;return B?Y=UA(0,R):i&&i[H]&&i[H].hasStack?(Y=AQ(i[H].stackGroups,v,b),Y=QL(A,Y,H,c)):(Y=fL(K,xQ(M,r.filter(function(se){var ce,ye,ze=f in se.props?se.props[f]:(ce=se.type.defaultProps)===null||ce===void 0?void 0:ce[f],Le="hide"in se.props?se.props.hide:(ye=se.type.defaultProps)===null||ye===void 0?void 0:ye.hide;return ze===H&&!Le}),"number",T),a.defaultProps.allowDataOverflow),Y=QL(A,Y,H,c)),Wt(Wt({},j),{},Ar({},H,Wt(Wt({axisType:c},a.defaultProps),{},{hide:!0,orientation:yl(Y6e,"".concat(c,".").concat(L%2),null),domain:Y,originalDomain:K,isCategorical:B,layout:T})))}return j},{})},r8e=function(t,n){var r=n.axisType,a=r===void 0?"xAxis":r,c=n.AxisComp,f=n.graphicalItems,i=n.stackGroups,v=n.dataStartIndex,b=n.dataEndIndex,T=t.children,A="".concat(a,"Id"),M=gs(T,c),R={};return M&&M.length?R=t8e(t,{axes:M,graphicalItems:f,axisType:a,axisIdKey:A,stackGroups:i,dataStartIndex:v,dataEndIndex:b}):f&&f.length&&(R=n8e(t,{Axis:c,graphicalItems:f,axisType:a,axisIdKey:A,stackGroups:i,dataStartIndex:v,dataEndIndex:b})),R},i8e=function(t){var n=rf(t),r=Ah(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:FN(r,function(a){return a.coordinate}),tooltipAxis:n,tooltipAxisBandSize:IA(n,r)}},EW=function(t){var n=t.children,r=t.defaultShowTooltip,a=ul(n,K_),c=0,f=0;return t.data&&t.data.length!==0&&(f=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(c=a.props.startIndex),a.props.endIndex>=0&&(f=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:c,dataEndIndex:f,activeTooltipIndex:-1,isTooltipActive:!!r}},o8e=function(t){return!t||!t.length?!1:t.some(function(n){var r=Ch(n&&n.type);return r&&r.indexOf("Bar")>=0})},AW=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},a8e=function(t,n){var r=t.props,a=t.graphicalItems,c=t.xAxisMap,f=c===void 0?{}:c,i=t.yAxisMap,v=i===void 0?{}:i,b=r.width,T=r.height,A=r.children,M=r.margin||{},R=ul(A,K_),B=ul(A,p_),L=Object.keys(v).reduce(function(Y,se){var ce=v[se],ye=ce.orientation;return!ce.mirror&&!ce.hide?Wt(Wt({},Y),{},Ar({},ye,Y[ye]+ce.width)):Y},{left:M.left||0,right:M.right||0}),j=Object.keys(f).reduce(function(Y,se){var ce=f[se],ye=ce.orientation;return!ce.mirror&&!ce.hide?Wt(Wt({},Y),{},Ar({},ye,yl(Y,"".concat(ye))+ce.height)):Y},{top:M.top||0,bottom:M.bottom||0}),V=Wt(Wt({},j),L),$=V.bottom;R&&(V.bottom+=R.props.height||K_.defaultProps.height),B&&n&&(V=iNe(V,a,r,n));var H=b-V.left-V.right,K=T-V.top-V.bottom;return Wt(Wt({brushBottom:$},V),{},{width:Math.max(H,0),height:Math.max(K,0)})},s8e=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},Ww=function(t){var n=t.chartName,r=t.GraphicalChild,a=t.defaultTooltipEventType,c=a===void 0?"axis":a,f=t.validateTooltipEventTypes,i=f===void 0?["axis"]:f,v=t.axisComponents,b=t.legendContent,T=t.formatAxisMap,A=t.defaultProps,M=function(j,V){var $=V.graphicalItems,H=V.stackGroups,K=V.offset,Y=V.updateId,se=V.dataStartIndex,ce=V.dataEndIndex,ye=j.barSize,ze=j.layout,Le=j.barGap,je=j.barCategoryGap,Re=j.maxBarSize,$e=AW(ze),Ge=$e.numericAxisName,ht=$e.cateAxisName,ot=o8e($),Je=[];return $.forEach(function(Ne,Xe){var pt=eI(j.data,{graphicalItems:[Ne],dataStartIndex:se,dataEndIndex:ce}),zt=Ne.type.defaultProps!==void 0?Wt(Wt({},Ne.type.defaultProps),Ne.props):Ne.props,Ft=zt.dataKey,un=zt.maxBarSize,Tn=zt["".concat(Ge,"Id")],fn=zt["".concat(ht,"Id")],Cn={},Vt=v.reduce(function(Rt,pn){var dn=V["".concat(pn.axisType,"Map")],sn=zt["".concat(pn.axisType,"Id")];dn&&dn[sn]||pn.axisType==="zAxis"||Bm();var Ln=dn[sn];return Wt(Wt({},Rt),{},Ar(Ar({},pn.axisType,Ln),"".concat(pn.axisType,"Ticks"),Ah(Ln)))},Cn),lr=Vt[ht],Nt=Vt["".concat(ht,"Ticks")],gn=H&&H[Tn]&&H[Tn].hasStack&&mNe(Ne,H[Tn].stackGroups),xn=Ch(Ne.type).indexOf("Bar")>=0,kt=IA(lr,Nt),zn=[],fr=ot&&nNe({barSize:ye,stackGroups:H,totalSize:s8e(Vt,ht)});if(xn){var hi,br,Pi=xr(un)?Re:un,Ye=(hi=(br=IA(lr,Nt,!0))!==null&&br!==void 0?br:Pi)!==null&&hi!==void 0?hi:0;zn=rNe({barGap:Le,barCategoryGap:je,bandSize:Ye!==kt?Ye:kt,sizeList:fr[fn],maxBarSize:Pi}),Ye!==kt&&(zn=zn.map(function(Rt){return Wt(Wt({},Rt),{},{position:Wt(Wt({},Rt.position),{},{offset:Rt.position.offset-Ye/2})})}))}var wt=Ne&&Ne.type&&Ne.type.getComposedData;wt&&Je.push({props:Wt(Wt({},wt(Wt(Wt({},Vt),{},{displayedData:pt,props:j,dataKey:Ft,item:Ne,bandSize:kt,barPosition:zn,offset:K,stackedData:gn,layout:ze,dataStartIndex:se,dataEndIndex:ce}))),{},Ar(Ar(Ar({key:Ne.key||"item-".concat(Xe)},Ge,Vt[Ge]),ht,Vt[ht]),"animationId",Y)),childIndex:GSe(Ne,j.children),item:Ne})}),Je},R=function(j,V){var $=j.props,H=j.dataStartIndex,K=j.dataEndIndex,Y=j.updateId;if(!DV({props:$}))return null;var se=$.children,ce=$.layout,ye=$.stackOffset,ze=$.data,Le=$.reverseStackOrder,je=AW(ce),Re=je.numericAxisName,$e=je.cateAxisName,Ge=gs(se,r),ht=fNe(ze,Ge,"".concat(Re,"Id"),"".concat($e,"Id"),ye,Le),ot=v.reduce(function(zt,Ft){var un="".concat(Ft.axisType,"Map");return Wt(Wt({},zt),{},Ar({},un,r8e($,Wt(Wt({},Ft),{},{graphicalItems:Ge,stackGroups:Ft.axisType===Re&&ht,dataStartIndex:H,dataEndIndex:K}))))},{}),Je=a8e(Wt(Wt({},ot),{},{props:$,graphicalItems:Ge}),V==null?void 0:V.legendBBox);Object.keys(ot).forEach(function(zt){ot[zt]=T($,ot[zt],Je,zt.replace("Map",""),n)});var Ne=ot["".concat($e,"Map")],Xe=i8e(Ne),pt=M($,Wt(Wt({},ot),{},{dataStartIndex:H,dataEndIndex:K,updateId:Y,graphicalItems:Ge,stackGroups:ht,offset:Je}));return Wt(Wt({formattedGraphicalItems:pt,graphicalItems:Ge,offset:Je,stackGroups:ht},Xe),ot)},B=function(L){function j(V){var $,H,K;return j6e(this,j),K=V6e(this,j,[V]),Ar(K,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Ar(K,"accessibilityManager",new A6e),Ar(K,"handleLegendBBoxUpdate",function(Y){if(Y){var se=K.state,ce=se.dataStartIndex,ye=se.dataEndIndex,ze=se.updateId;K.setState(Wt({legendBBox:Y},R({props:K.props,dataStartIndex:ce,dataEndIndex:ye,updateId:ze},Wt(Wt({},K.state),{},{legendBBox:Y}))))}}),Ar(K,"handleReceiveSyncEvent",function(Y,se,ce){if(K.props.syncId===Y){if(ce===K.eventEmitterSymbol&&typeof K.props.syncMethod!="function")return;K.applySyncEvent(se)}}),Ar(K,"handleBrushChange",function(Y){var se=Y.startIndex,ce=Y.endIndex;if(se!==K.state.dataStartIndex||ce!==K.state.dataEndIndex){var ye=K.state.updateId;K.setState(function(){return Wt({dataStartIndex:se,dataEndIndex:ce},R({props:K.props,dataStartIndex:se,dataEndIndex:ce,updateId:ye},K.state))}),K.triggerSyncEvent({dataStartIndex:se,dataEndIndex:ce})}}),Ar(K,"handleMouseEnter",function(Y){var se=K.getMouseInfo(Y);if(se){var ce=Wt(Wt({},se),{},{isTooltipActive:!0});K.setState(ce),K.triggerSyncEvent(ce);var ye=K.props.onMouseEnter;Tr(ye)&&ye(ce,Y)}}),Ar(K,"triggeredAfterMouseMove",function(Y){var se=K.getMouseInfo(Y),ce=se?Wt(Wt({},se),{},{isTooltipActive:!0}):{isTooltipActive:!1};K.setState(ce),K.triggerSyncEvent(ce);var ye=K.props.onMouseMove;Tr(ye)&&ye(ce,Y)}),Ar(K,"handleItemMouseEnter",function(Y){K.setState(function(){return{isTooltipActive:!0,activeItem:Y,activePayload:Y.tooltipPayload,activeCoordinate:Y.tooltipPosition||{x:Y.cx,y:Y.cy}}})}),Ar(K,"handleItemMouseLeave",function(){K.setState(function(){return{isTooltipActive:!1}})}),Ar(K,"handleMouseMove",function(Y){Y.persist(),K.throttleTriggeredAfterMouseMove(Y)}),Ar(K,"handleMouseLeave",function(Y){K.throttleTriggeredAfterMouseMove.cancel();var se={isTooltipActive:!1};K.setState(se),K.triggerSyncEvent(se);var ce=K.props.onMouseLeave;Tr(ce)&&ce(se,Y)}),Ar(K,"handleOuterEvent",function(Y){var se=VSe(Y),ce=yl(K.props,"".concat(se));if(se&&Tr(ce)){var ye,ze;/.*touch.*/i.test(se)?ze=K.getMouseInfo(Y.changedTouches[0]):ze=K.getMouseInfo(Y),ce((ye=ze)!==null&&ye!==void 0?ye:{},Y)}}),Ar(K,"handleClick",function(Y){var se=K.getMouseInfo(Y);if(se){var ce=Wt(Wt({},se),{},{isTooltipActive:!0});K.setState(ce),K.triggerSyncEvent(ce);var ye=K.props.onClick;Tr(ye)&&ye(ce,Y)}}),Ar(K,"handleMouseDown",function(Y){var se=K.props.onMouseDown;if(Tr(se)){var ce=K.getMouseInfo(Y);se(ce,Y)}}),Ar(K,"handleMouseUp",function(Y){var se=K.props.onMouseUp;if(Tr(se)){var ce=K.getMouseInfo(Y);se(ce,Y)}}),Ar(K,"handleTouchMove",function(Y){Y.changedTouches!=null&&Y.changedTouches.length>0&&K.throttleTriggeredAfterMouseMove(Y.changedTouches[0])}),Ar(K,"handleTouchStart",function(Y){Y.changedTouches!=null&&Y.changedTouches.length>0&&K.handleMouseDown(Y.changedTouches[0])}),Ar(K,"handleTouchEnd",function(Y){Y.changedTouches!=null&&Y.changedTouches.length>0&&K.handleMouseUp(Y.changedTouches[0])}),Ar(K,"triggerSyncEvent",function(Y){K.props.syncId!==void 0&&$k.emit(Uk,K.props.syncId,Y,K.eventEmitterSymbol)}),Ar(K,"applySyncEvent",function(Y){var se=K.props,ce=se.layout,ye=se.syncMethod,ze=K.state.updateId,Le=Y.dataStartIndex,je=Y.dataEndIndex;if(Y.dataStartIndex!==void 0||Y.dataEndIndex!==void 0)K.setState(Wt({dataStartIndex:Le,dataEndIndex:je},R({props:K.props,dataStartIndex:Le,dataEndIndex:je,updateId:ze},K.state)));else if(Y.activeTooltipIndex!==void 0){var Re=Y.chartX,$e=Y.chartY,Ge=Y.activeTooltipIndex,ht=K.state,ot=ht.offset,Je=ht.tooltipTicks;if(!ot)return;if(typeof ye=="function")Ge=ye(Je,Y);else if(ye==="value"){Ge=-1;for(var Ne=0;Ne<Je.length;Ne++)if(Je[Ne].value===Y.activeLabel){Ge=Ne;break}}var Xe=Wt(Wt({},ot),{},{x:ot.left,y:ot.top}),pt=Math.min(Re,Xe.x+Xe.width),zt=Math.min($e,Xe.y+Xe.height),Ft=Je[Ge]&&Je[Ge].value,un=nz(K.state,K.props.data,Ge),Tn=Je[Ge]?{x:ce==="horizontal"?Je[Ge].coordinate:pt,y:ce==="horizontal"?zt:Je[Ge].coordinate}:Xee;K.setState(Wt(Wt({},Y),{},{activeLabel:Ft,activeCoordinate:Tn,activePayload:un,activeTooltipIndex:Ge}))}else K.setState(Y)}),Ar(K,"renderCursor",function(Y){var se,ce=K.state,ye=ce.isTooltipActive,ze=ce.activeCoordinate,Le=ce.activePayload,je=ce.offset,Re=ce.activeTooltipIndex,$e=ce.tooltipAxisBandSize,Ge=K.getTooltipEventType(),ht=(se=Y.props.active)!==null&&se!==void 0?se:ye,ot=K.props.layout,Je=Y.key||"_recharts-cursor";return Se.createElement(R6e,{key:Je,activeCoordinate:ze,activePayload:Le,activeTooltipIndex:Re,chartName:n,element:Y,isActive:ht,layout:ot,offset:je,tooltipAxisBandSize:$e,tooltipEventType:Ge})}),Ar(K,"renderPolarAxis",function(Y,se,ce){var ye=yl(Y,"type.axisType"),ze=yl(K.state,"".concat(ye,"Map")),Le=Y.type.defaultProps,je=Le!==void 0?Wt(Wt({},Le),Y.props):Y.props,Re=ze&&ze[je["".concat(ye,"Id")]];return X.cloneElement(Y,Wt(Wt({},Re),{},{className:jr(ye,Re.className),key:Y.key||"".concat(se,"-").concat(ce),ticks:Ah(Re,!0)}))}),Ar(K,"renderPolarGrid",function(Y){var se=Y.props,ce=se.radialLines,ye=se.polarAngles,ze=se.polarRadius,Le=K.state,je=Le.radiusAxisMap,Re=Le.angleAxisMap,$e=rf(je),Ge=rf(Re),ht=Ge.cx,ot=Ge.cy,Je=Ge.innerRadius,Ne=Ge.outerRadius;return X.cloneElement(Y,{polarAngles:Array.isArray(ye)?ye:Ah(Ge,!0).map(function(Xe){return Xe.coordinate}),polarRadius:Array.isArray(ze)?ze:Ah($e,!0).map(function(Xe){return Xe.coordinate}),cx:ht,cy:ot,innerRadius:Je,outerRadius:Ne,key:Y.key||"polar-grid",radialLines:ce})}),Ar(K,"renderLegend",function(){var Y=K.state.formattedGraphicalItems,se=K.props,ce=se.children,ye=se.width,ze=se.height,Le=K.props.margin||{},je=ye-(Le.left||0)-(Le.right||0),Re=_Q({children:ce,formattedGraphicalItems:Y,legendWidth:je,legendContent:b});if(!Re)return null;var $e=Re.item,Ge=wW(Re,D6e);return X.cloneElement($e,Wt(Wt({},Ge),{},{chartWidth:ye,chartHeight:ze,margin:Le,onBBoxUpdate:K.handleLegendBBoxUpdate}))}),Ar(K,"renderTooltip",function(){var Y,se=K.props,ce=se.children,ye=se.accessibilityLayer,ze=ul(ce,_h);if(!ze)return null;var Le=K.state,je=Le.isTooltipActive,Re=Le.activeCoordinate,$e=Le.activePayload,Ge=Le.activeLabel,ht=Le.offset,ot=(Y=ze.props.active)!==null&&Y!==void 0?Y:je;return X.cloneElement(ze,{viewBox:Wt(Wt({},ht),{},{x:ht.left,y:ht.top}),active:ot,label:Ge,payload:ot?$e:[],coordinate:Re,accessibilityLayer:ye})}),Ar(K,"renderBrush",function(Y){var se=K.props,ce=se.margin,ye=se.data,ze=K.state,Le=ze.offset,je=ze.dataStartIndex,Re=ze.dataEndIndex,$e=ze.updateId;return X.cloneElement(Y,{key:Y.key||"_recharts-brush",onChange:OE(K.handleBrushChange,Y.props.onChange),data:ye,x:wn(Y.props.x)?Y.props.x:Le.left,y:wn(Y.props.y)?Y.props.y:Le.top+Le.height+Le.brushBottom-(ce.bottom||0),width:wn(Y.props.width)?Y.props.width:Le.width,startIndex:je,endIndex:Re,updateId:"brush-".concat($e)})}),Ar(K,"renderReferenceElement",function(Y,se,ce){if(!Y)return null;var ye=K,ze=ye.clipPathId,Le=K.state,je=Le.xAxisMap,Re=Le.yAxisMap,$e=Le.offset,Ge=Y.type.defaultProps||{},ht=Y.props,ot=ht.xAxisId,Je=ot===void 0?Ge.xAxisId:ot,Ne=ht.yAxisId,Xe=Ne===void 0?Ge.yAxisId:Ne;return X.cloneElement(Y,{key:Y.key||"".concat(se,"-").concat(ce),xAxis:je[Je],yAxis:Re[Xe],viewBox:{x:$e.left,y:$e.top,width:$e.width,height:$e.height},clipPathId:ze})}),Ar(K,"renderActivePoints",function(Y){var se=Y.item,ce=Y.activePoint,ye=Y.basePoint,ze=Y.childIndex,Le=Y.isRange,je=[],Re=se.props.key,$e=se.item.type.defaultProps!==void 0?Wt(Wt({},se.item.type.defaultProps),se.item.props):se.item.props,Ge=$e.activeDot,ht=$e.dataKey,ot=Wt(Wt({index:ze,dataKey:ht,cx:ce.x,cy:ce.y,r:4,fill:uF(se.item),strokeWidth:2,stroke:"#fff",payload:ce.payload,value:ce.value},ir(Ge,!1)),rA(Ge));return je.push(j.renderActiveDot(Ge,ot,"".concat(Re,"-activePoint-").concat(ze))),ye?je.push(j.renderActiveDot(Ge,Wt(Wt({},ot),{},{cx:ye.x,cy:ye.y}),"".concat(Re,"-basePoint-").concat(ze))):Le&&je.push(null),je}),Ar(K,"renderGraphicChild",function(Y,se,ce){var ye=K.filterFormatItem(Y,se,ce);if(!ye)return null;var ze=K.getTooltipEventType(),Le=K.state,je=Le.isTooltipActive,Re=Le.tooltipAxis,$e=Le.activeTooltipIndex,Ge=Le.activeLabel,ht=K.props.children,ot=ul(ht,_h),Je=ye.props,Ne=Je.points,Xe=Je.isRange,pt=Je.baseLine,zt=ye.item.type.defaultProps!==void 0?Wt(Wt({},ye.item.type.defaultProps),ye.item.props):ye.item.props,Ft=zt.activeDot,un=zt.hide,Tn=zt.activeBar,fn=zt.activeShape,Cn=!!(!un&&je&&ot&&(Ft||Tn||fn)),Vt={};ze!=="axis"&&ot&&ot.props.trigger==="click"?Vt={onClick:OE(K.handleItemMouseEnter,Y.props.onClick)}:ze!=="axis"&&(Vt={onMouseLeave:OE(K.handleItemMouseLeave,Y.props.onMouseLeave),onMouseEnter:OE(K.handleItemMouseEnter,Y.props.onMouseEnter)});var lr=X.cloneElement(Y,Wt(Wt({},ye.props),Vt));function Nt(pn){return typeof Re.dataKey=="function"?Re.dataKey(pn.payload):null}if(Cn)if($e>=0){var gn,xn;if(Re.dataKey&&!Re.allowDuplicatedCategory){var kt=typeof Re.dataKey=="function"?Nt:"payload.".concat(Re.dataKey.toString());gn=nA(Ne,kt,Ge),xn=Xe&&pt&&nA(pt,kt,Ge)}else gn=Ne==null?void 0:Ne[$e],xn=Xe&&pt&&pt[$e];if(fn||Tn){var zn=Y.props.activeIndex!==void 0?Y.props.activeIndex:$e;return[X.cloneElement(Y,Wt(Wt(Wt({},ye.props),Vt),{},{activeIndex:zn})),null,null]}if(!xr(gn))return[lr].concat(cv(K.renderActivePoints({item:ye,activePoint:gn,basePoint:xn,childIndex:$e,isRange:Xe})))}else{var fr,hi=(fr=K.getItemByXY(K.state.activeCoordinate))!==null&&fr!==void 0?fr:{graphicalItem:lr},br=hi.graphicalItem,Pi=br.item,Ye=Pi===void 0?Y:Pi,wt=br.childIndex,Rt=Wt(Wt(Wt({},ye.props),Vt),{},{activeIndex:wt});return[X.cloneElement(Ye,Rt),null,null]}return Xe?[lr,null,null]:[lr,null]}),Ar(K,"renderCustomized",function(Y,se,ce){return X.cloneElement(Y,Wt(Wt({key:"recharts-customized-".concat(ce)},K.props),K.state))}),Ar(K,"renderMap",{CartesianGrid:{handler:zE,once:!0},ReferenceArea:{handler:K.renderReferenceElement},ReferenceLine:{handler:zE},ReferenceDot:{handler:K.renderReferenceElement},XAxis:{handler:zE},YAxis:{handler:zE},Brush:{handler:K.renderBrush,once:!0},Bar:{handler:K.renderGraphicChild},Line:{handler:K.renderGraphicChild},Area:{handler:K.renderGraphicChild},Radar:{handler:K.renderGraphicChild},RadialBar:{handler:K.renderGraphicChild},Scatter:{handler:K.renderGraphicChild},Pie:{handler:K.renderGraphicChild},Funnel:{handler:K.renderGraphicChild},Tooltip:{handler:K.renderCursor,once:!0},PolarGrid:{handler:K.renderPolarGrid,once:!0},PolarAngleAxis:{handler:K.renderPolarAxis},PolarRadiusAxis:{handler:K.renderPolarAxis},Customized:{handler:K.renderCustomized}}),K.clipPathId="".concat(($=V.id)!==null&&$!==void 0?$:Zf("recharts"),"-clip"),K.throttleTriggeredAfterMouseMove=pJ(K.triggeredAfterMouseMove,(H=V.throttleDelay)!==null&&H!==void 0?H:1e3/60),K.state={},K}return H6e(j,L),U6e(j,[{key:"componentDidMount",value:function(){var $,H;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:($=this.props.margin.left)!==null&&$!==void 0?$:0,top:(H=this.props.margin.top)!==null&&H!==void 0?H:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var $=this.props,H=$.children,K=$.data,Y=$.height,se=$.layout,ce=ul(H,_h);if(ce){var ye=ce.props.defaultIndex;if(!(typeof ye!="number"||ye<0||ye>this.state.tooltipTicks.length-1)){var ze=this.state.tooltipTicks[ye]&&this.state.tooltipTicks[ye].value,Le=nz(this.state,K,ye,ze),je=this.state.tooltipTicks[ye].coordinate,Re=(this.state.offset.top+Y)/2,$e=se==="horizontal",Ge=$e?{x:je,y:Re}:{y:je,x:Re},ht=this.state.formattedGraphicalItems.find(function(Je){var Ne=Je.item;return Ne.type.name==="Scatter"});ht&&(Ge=Wt(Wt({},Ge),ht.props.points[ye].tooltipPosition),Le=ht.props.points[ye].tooltipPayload);var ot={activeTooltipIndex:ye,isTooltipActive:!0,activeLabel:ze,activePayload:Le,activeCoordinate:Ge};this.setState(ot),this.renderCursor(ce),this.accessibilityManager.setIndex(ye)}}}},{key:"getSnapshotBeforeUpdate",value:function($,H){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==H.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==$.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==$.margin){var K,Y;this.accessibilityManager.setDetails({offset:{left:(K=this.props.margin.left)!==null&&K!==void 0?K:0,top:(Y=this.props.margin.top)!==null&&Y!==void 0?Y:0}})}return null}},{key:"componentDidUpdate",value:function($){PD([ul($.children,_h)],[ul(this.props.children,_h)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var $=ul(this.props.children,_h);if($&&typeof $.props.shared=="boolean"){var H=$.props.shared?"axis":"item";return i.indexOf(H)>=0?H:c}return c}},{key:"getMouseInfo",value:function($){if(!this.container)return null;var H=this.container,K=H.getBoundingClientRect(),Y=ARe(K),se={chartX:Math.round($.pageX-Y.left),chartY:Math.round($.pageY-Y.top)},ce=K.width/H.offsetWidth||1,ye=this.inRange(se.chartX,se.chartY,ce);if(!ye)return null;var ze=this.state,Le=ze.xAxisMap,je=ze.yAxisMap,Re=this.getTooltipEventType();if(Re!=="axis"&&Le&&je){var $e=rf(Le).scale,Ge=rf(je).scale,ht=$e&&$e.invert?$e.invert(se.chartX):null,ot=Ge&&Ge.invert?Ge.invert(se.chartY):null;return Wt(Wt({},se),{},{xValue:ht,yValue:ot})}var Je=TW(this.state,this.props.data,this.props.layout,ye);return Je?Wt(Wt({},se),Je):null}},{key:"inRange",value:function($,H){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Y=this.props.layout,se=$/K,ce=H/K;if(Y==="horizontal"||Y==="vertical"){var ye=this.state.offset,ze=se>=ye.left&&se<=ye.left+ye.width&&ce>=ye.top&&ce<=ye.top+ye.height;return ze?{x:se,y:ce}:null}var Le=this.state,je=Le.angleAxisMap,Re=Le.radiusAxisMap;if(je&&Re){var $e=rf(je);return W8({x:se,y:ce},$e)}return null}},{key:"parseEventsOfWrapper",value:function(){var $=this.props.children,H=this.getTooltipEventType(),K=ul($,_h),Y={};K&&H==="axis"&&(K.props.trigger==="click"?Y={onClick:this.handleClick}:Y={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var se=rA(this.props,this.handleOuterEvent);return Wt(Wt({},se),Y)}},{key:"addListener",value:function(){$k.on(Uk,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){$k.removeListener(Uk,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function($,H,K){for(var Y=this.state.formattedGraphicalItems,se=0,ce=Y.length;se<ce;se++){var ye=Y[se];if(ye.item===$||ye.props.key===$.key||H===Ch(ye.item.type)&&K===ye.childIndex)return ye}return null}},{key:"renderClipPath",value:function(){var $=this.clipPathId,H=this.state.offset,K=H.left,Y=H.top,se=H.height,ce=H.width;return Se.createElement("defs",null,Se.createElement("clipPath",{id:$},Se.createElement("rect",{x:K,y:Y,height:se,width:ce})))}},{key:"getXScales",value:function(){var $=this.state.xAxisMap;return $?Object.entries($).reduce(function(H,K){var Y=bW(K,2),se=Y[0],ce=Y[1];return Wt(Wt({},H),{},Ar({},se,ce.scale))},{}):null}},{key:"getYScales",value:function(){var $=this.state.yAxisMap;return $?Object.entries($).reduce(function(H,K){var Y=bW(K,2),se=Y[0],ce=Y[1];return Wt(Wt({},H),{},Ar({},se,ce.scale))},{}):null}},{key:"getXScaleByAxisId",value:function($){var H;return(H=this.state.xAxisMap)===null||H===void 0||(H=H[$])===null||H===void 0?void 0:H.scale}},{key:"getYScaleByAxisId",value:function($){var H;return(H=this.state.yAxisMap)===null||H===void 0||(H=H[$])===null||H===void 0?void 0:H.scale}},{key:"getItemByXY",value:function($){var H=this.state,K=H.formattedGraphicalItems,Y=H.activeItem;if(K&&K.length)for(var se=0,ce=K.length;se<ce;se++){var ye=K[se],ze=ye.props,Le=ye.item,je=Le.type.defaultProps!==void 0?Wt(Wt({},Le.type.defaultProps),Le.props):Le.props,Re=Ch(Le.type);if(Re==="Bar"){var $e=(ze.data||[]).find(function(Je){return tje($,Je)});if($e)return{graphicalItem:ye,payload:$e}}else if(Re==="RadialBar"){var Ge=(ze.data||[]).find(function(Je){return W8($,Je)});if(Ge)return{graphicalItem:ye,payload:Ge}}else if(VC(ye,Y)||GC(ye,Y)||rw(ye,Y)){var ht=V4e({graphicalItem:ye,activeTooltipItem:Y,itemData:je.data}),ot=je.activeIndex===void 0?ht:je.activeIndex;return{graphicalItem:Wt(Wt({},ye),{},{childIndex:ot}),payload:rw(ye,Y)?je.data[ht]:ye.props.data[ht]}}}return null}},{key:"render",value:function(){var $=this;if(!DV(this))return null;var H=this.props,K=H.children,Y=H.className,se=H.width,ce=H.height,ye=H.style,ze=H.compact,Le=H.title,je=H.desc,Re=wW(H,L6e),$e=ir(Re,!1);if(ze)return Se.createElement(QG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Se.createElement(ID,W1({},$e,{width:se,height:ce,title:Le,desc:je}),this.renderClipPath(),zV(K,this.renderMap)));if(this.props.accessibilityLayer){var Ge,ht;$e.tabIndex=(Ge=this.props.tabIndex)!==null&&Ge!==void 0?Ge:0,$e.role=(ht=this.props.role)!==null&&ht!==void 0?ht:"application",$e.onKeyDown=function(Je){$.accessibilityManager.keyboardEvent(Je)},$e.onFocus=function(){$.accessibilityManager.focus()}}var ot=this.parseEventsOfWrapper();return Se.createElement(QG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Se.createElement("div",W1({className:jr("recharts-wrapper",Y),style:Wt({position:"relative",cursor:"default",width:se,height:ce},ye)},ot,{ref:function(Ne){$.container=Ne}}),Se.createElement(ID,W1({},$e,{width:se,height:ce,title:Le,desc:je,style:J6e}),this.renderClipPath(),zV(K,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(X.Component);return Ar(B,"displayName",n),Ar(B,"defaultProps",Wt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},A)),Ar(B,"getDerivedStateFromProps",function(L,j){var V=L.dataKey,$=L.data,H=L.children,K=L.width,Y=L.height,se=L.layout,ce=L.stackOffset,ye=L.margin,ze=j.dataStartIndex,Le=j.dataEndIndex;if(j.updateId===void 0){var je=EW(L);return Wt(Wt(Wt({},je),{},{updateId:0},R(Wt(Wt({props:L},je),{},{updateId:0}),j)),{},{prevDataKey:V,prevData:$,prevWidth:K,prevHeight:Y,prevLayout:se,prevStackOffset:ce,prevMargin:ye,prevChildren:H})}if(V!==j.prevDataKey||$!==j.prevData||K!==j.prevWidth||Y!==j.prevHeight||se!==j.prevLayout||ce!==j.prevStackOffset||!f_(ye,j.prevMargin)){var Re=EW(L),$e={chartX:j.chartX,chartY:j.chartY,isTooltipActive:j.isTooltipActive},Ge=Wt(Wt({},TW(j,$,se)),{},{updateId:j.updateId+1}),ht=Wt(Wt(Wt({},Re),$e),Ge);return Wt(Wt(Wt({},ht),R(Wt({props:L},ht),j)),{},{prevDataKey:V,prevData:$,prevWidth:K,prevHeight:Y,prevLayout:se,prevStackOffset:ce,prevMargin:ye,prevChildren:H})}if(!PD(H,j.prevChildren)){var ot,Je,Ne,Xe,pt=ul(H,K_),zt=pt&&(ot=(Je=pt.props)===null||Je===void 0?void 0:Je.startIndex)!==null&&ot!==void 0?ot:ze,Ft=pt&&(Ne=(Xe=pt.props)===null||Xe===void 0?void 0:Xe.endIndex)!==null&&Ne!==void 0?Ne:Le,un=zt!==ze||Ft!==Le,Tn=!xr($),fn=Tn&&!un?j.updateId:j.updateId+1;return Wt(Wt({updateId:fn},R(Wt(Wt({props:L},j),{},{updateId:fn,dataStartIndex:zt,dataEndIndex:Ft}),j)),{},{prevChildren:H,dataStartIndex:zt,dataEndIndex:Ft})}return null}),Ar(B,"renderActiveDot",function(L,j,V){var $;return X.isValidElement(L)?$=X.cloneElement(L,j):Tr(L)?$=L(j):$=Se.createElement(Gw,j),Se.createElement(Wr,{className:"recharts-active-dot",key:V},$)}),function(j){return Se.createElement(B,j)}},_Xe=Ww({chartName:"LineChart",GraphicalChild:YC,axisComponents:[{axisType:"xAxis",AxisComp:Vv},{axisType:"yAxis",AxisComp:Gv}],formatAxisMap:HC}),vXe=Ww({chartName:"BarChart",GraphicalChild:$v,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Vv},{axisType:"yAxis",AxisComp:Gv}],formatAxisMap:HC}),xXe=Ww({chartName:"PieChart",GraphicalChild:Jf,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:UC},{axisType:"radiusAxis",AxisComp:jC}],formatAxisMap:ENe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),bXe=Ww({chartName:"ScatterChart",GraphicalChild:QC,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:Vv},{axisType:"yAxis",AxisComp:Gv},{axisType:"zAxis",AxisComp:JC}],formatAxisMap:HC}),wXe=Ww({chartName:"AreaChart",GraphicalChild:rg,axisComponents:[{axisType:"xAxis",AxisComp:Vv},{axisType:"yAxis",AxisComp:Gv}],formatAxisMap:HC}),[tI,SXe]=qs("Tooltip",[Vf]),nI=Vf(),Yee="TooltipProvider",l8e=700,rz="tooltip.open",[c8e,bF]=tI(Yee),Jee=e=>{const{__scopeTooltip:t,delayDuration:n=l8e,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:c}=e,[f,i]=X.useState(!0),v=X.useRef(!1),b=X.useRef(0);return X.useEffect(()=>{const T=b.current;return()=>window.clearTimeout(T)},[]),he.jsx(c8e,{scope:t,isOpenDelayed:f,delayDuration:n,onOpen:X.useCallback(()=>{window.clearTimeout(b.current),i(!1)},[]),onClose:X.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>i(!0),r)},[r]),isPointerInTransitRef:v,onPointerInTransitChange:X.useCallback(T=>{v.current=T},[]),disableHoverableContent:a,children:c})};Jee.displayName=Yee;var rI="Tooltip",[u8e,iI]=tI(rI),Qee=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:c,disableHoverableContent:f,delayDuration:i}=e,v=bF(rI,e.__scopeTooltip),b=nI(t),[T,A]=X.useState(null),M=Qa(),R=X.useRef(0),B=f??v.disableHoverableContent,L=i??v.delayDuration,j=X.useRef(!1),[V=!1,$]=ys({prop:r,defaultProp:a,onChange:ce=>{ce?(v.onOpen(),document.dispatchEvent(new CustomEvent(rz))):v.onClose(),c==null||c(ce)}}),H=X.useMemo(()=>V?j.current?"delayed-open":"instant-open":"closed",[V]),K=X.useCallback(()=>{window.clearTimeout(R.current),R.current=0,j.current=!1,$(!0)},[$]),Y=X.useCallback(()=>{window.clearTimeout(R.current),R.current=0,$(!1)},[$]),se=X.useCallback(()=>{window.clearTimeout(R.current),R.current=window.setTimeout(()=>{j.current=!0,$(!0),R.current=0},L)},[L,$]);return X.useEffect(()=>()=>{R.current&&(window.clearTimeout(R.current),R.current=0)},[]),he.jsx(jP,{...b,children:he.jsx(u8e,{scope:t,contentId:M,open:V,stateAttribute:H,trigger:T,onTriggerChange:A,onTriggerEnter:X.useCallback(()=>{v.isOpenDelayed?se():K()},[v.isOpenDelayed,se,K]),onTriggerLeave:X.useCallback(()=>{B?Y():(window.clearTimeout(R.current),R.current=0)},[Y,B]),onOpen:K,onClose:Y,disableHoverableContent:B,children:n})})};Qee.displayName=rI;var iz="TooltipTrigger",ete=X.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=iI(iz,n),c=bF(iz,n),f=nI(n),i=X.useRef(null),v=qr(t,i,a.onTriggerChange),b=X.useRef(!1),T=X.useRef(!1),A=X.useCallback(()=>b.current=!1,[]);return X.useEffect(()=>()=>document.removeEventListener("pointerup",A),[A]),he.jsx(Tw,{asChild:!0,...f,children:he.jsx(Qn.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:v,onPointerMove:vn(e.onPointerMove,M=>{M.pointerType!=="touch"&&!T.current&&!c.isPointerInTransitRef.current&&(a.onTriggerEnter(),T.current=!0)}),onPointerLeave:vn(e.onPointerLeave,()=>{a.onTriggerLeave(),T.current=!1}),onPointerDown:vn(e.onPointerDown,()=>{b.current=!0,document.addEventListener("pointerup",A,{once:!0})}),onFocus:vn(e.onFocus,()=>{b.current||a.onOpen()}),onBlur:vn(e.onBlur,a.onClose),onClick:vn(e.onClick,a.onClose)})})});ete.displayName=iz;var h8e="TooltipPortal",[TXe,d8e]=tI(h8e,{forceMount:void 0}),uv="TooltipContent",tte=X.forwardRef((e,t)=>{const n=d8e(uv,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...c}=e,f=iI(uv,e.__scopeTooltip);return he.jsx(wa,{present:r||f.open,children:f.disableHoverableContent?he.jsx(nte,{side:a,...c,ref:t}):he.jsx(f8e,{side:a,...c,ref:t})})}),f8e=X.forwardRef((e,t)=>{const n=iI(uv,e.__scopeTooltip),r=bF(uv,e.__scopeTooltip),a=X.useRef(null),c=qr(t,a),[f,i]=X.useState(null),{trigger:v,onClose:b}=n,T=a.current,{onPointerInTransitChange:A}=r,M=X.useCallback(()=>{i(null),A(!1)},[A]),R=X.useCallback((B,L)=>{const j=B.currentTarget,V={x:B.clientX,y:B.clientY},$=y8e(V,j.getBoundingClientRect()),H=_8e(V,$),K=v8e(L.getBoundingClientRect()),Y=b8e([...H,...K]);i(Y),A(!0)},[A]);return X.useEffect(()=>()=>M(),[M]),X.useEffect(()=>{if(v&&T){const B=j=>R(j,T),L=j=>R(j,v);return v.addEventListener("pointerleave",B),T.addEventListener("pointerleave",L),()=>{v.removeEventListener("pointerleave",B),T.removeEventListener("pointerleave",L)}}},[v,T,R,M]),X.useEffect(()=>{if(f){const B=L=>{const j=L.target,V={x:L.clientX,y:L.clientY},$=(v==null?void 0:v.contains(j))||(T==null?void 0:T.contains(j)),H=!x8e(V,f);$?M():H&&(M(),b())};return document.addEventListener("pointermove",B),()=>document.removeEventListener("pointermove",B)}},[v,T,f,b,M]),he.jsx(nte,{...e,ref:c})}),[p8e,m8e]=tI(rI,{isInside:!1}),nte=X.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:c,onPointerDownOutside:f,...i}=e,v=iI(uv,n),b=nI(n),{onClose:T}=v;return X.useEffect(()=>(document.addEventListener(rz,T),()=>document.removeEventListener(rz,T)),[T]),X.useEffect(()=>{if(v.trigger){const A=M=>{const R=M.target;R!=null&&R.contains(v.trigger)&&T()};return window.addEventListener("scroll",A,{capture:!0}),()=>window.removeEventListener("scroll",A,{capture:!0})}},[v.trigger,T]),he.jsx(Xm,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:A=>A.preventDefault(),onDismiss:T,children:he.jsxs($P,{"data-state":v.stateAttribute,...b,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[he.jsx(c3,{children:r}),he.jsx(p8e,{scope:n,isInside:!0,children:he.jsx(fZ,{id:v.contentId,role:"tooltip",children:a||r})})]})})});tte.displayName=uv;var rte="TooltipArrow",g8e=X.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=nI(n);return m8e(rte,n).isInside?null:he.jsx(UP,{...a,...r,ref:t})});g8e.displayName=rte;function y8e(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),c=Math.abs(t.left-e.x);switch(Math.min(n,r,a,c)){case c:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function _8e(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function v8e(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function x8e(e,t){const{x:n,y:r}=e;let a=!1;for(let c=0,f=t.length-1;c<t.length;f=c++){const i=t[c].x,v=t[c].y,b=t[f].x,T=t[f].y;v>r!=T>r&&n<(b-i)*(r-v)/(T-v)+i&&(a=!a)}return a}function b8e(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),w8e(t)}function w8e(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const c=t[t.length-1],f=t[t.length-2];if((c.x-f.x)*(a.y-f.y)>=(c.y-f.y)*(a.x-f.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const c=n[n.length-1],f=n[n.length-2];if((c.x-f.x)*(a.y-f.y)>=(c.y-f.y)*(a.x-f.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var EXe=Jee,AXe=Qee,PXe=ete,CXe=tte,wF="Dialog",[ite,ote]=qs(wF),[S8e,jc]=ite(wF),ate=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:c,modal:f=!0}=e,i=X.useRef(null),v=X.useRef(null),[b=!1,T]=ys({prop:r,defaultProp:a,onChange:c});return he.jsx(S8e,{scope:t,triggerRef:i,contentRef:v,contentId:Qa(),titleId:Qa(),descriptionId:Qa(),open:b,onOpenChange:T,onOpenToggle:X.useCallback(()=>T(A=>!A),[T]),modal:f,children:n})};ate.displayName=wF;var ste="DialogTrigger",lte=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=jc(ste,n),c=qr(t,a.triggerRef);return he.jsx(Qn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":EF(a.open),...r,ref:c,onClick:vn(e.onClick,a.onOpenToggle)})});lte.displayName=ste;var SF="DialogPortal",[T8e,cte]=ite(SF,{forceMount:void 0}),ute=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,c=jc(SF,t);return he.jsx(T8e,{scope:t,forceMount:n,children:X.Children.map(r,f=>he.jsx(wa,{present:n||c.open,children:he.jsx(Ew,{asChild:!0,container:a,children:f})}))})};ute.displayName=SF;var oP="DialogOverlay",hte=X.forwardRef((e,t)=>{const n=cte(oP,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,c=jc(oP,e.__scopeDialog);return c.modal?he.jsx(wa,{present:r||c.open,children:he.jsx(E8e,{...a,ref:t})}):null});hte.displayName=oP;var E8e=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=jc(oP,n);return he.jsx(Pw,{as:Pf,allowPinchZoom:!0,shards:[a.contentRef],children:he.jsx(Qn.div,{"data-state":EF(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),$m="DialogContent",dte=X.forwardRef((e,t)=>{const n=cte($m,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,c=jc($m,e.__scopeDialog);return he.jsx(wa,{present:r||c.open,children:c.modal?he.jsx(A8e,{...a,ref:t}):he.jsx(P8e,{...a,ref:t})})});dte.displayName=$m;var A8e=X.forwardRef((e,t)=>{const n=jc($m,e.__scopeDialog),r=X.useRef(null),a=qr(t,n.contentRef,r);return X.useEffect(()=>{const c=r.current;if(c)return Aw(c)},[]),he.jsx(fte,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:vn(e.onCloseAutoFocus,c=>{var f;c.preventDefault(),(f=n.triggerRef.current)==null||f.focus()}),onPointerDownOutside:vn(e.onPointerDownOutside,c=>{const f=c.detail.originalEvent,i=f.button===0&&f.ctrlKey===!0;(f.button===2||i)&&c.preventDefault()}),onFocusOutside:vn(e.onFocusOutside,c=>c.preventDefault())})}),P8e=X.forwardRef((e,t)=>{const n=jc($m,e.__scopeDialog),r=X.useRef(!1),a=X.useRef(!1);return he.jsx(fte,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,c),c.defaultPrevented||(r.current||(i=n.triggerRef.current)==null||i.focus(),c.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:c=>{var v,b;(v=e.onInteractOutside)==null||v.call(e,c),c.defaultPrevented||(r.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=c.target;((b=n.triggerRef.current)==null?void 0:b.contains(f))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),fte=X.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:c,...f}=e,i=jc($m,n),v=X.useRef(null),b=qr(t,v);return zP(),he.jsxs(he.Fragment,{children:[he.jsx(ww,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:c,children:he.jsx(Xm,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":EF(i.open),...f,ref:b,onDismiss:()=>i.onOpenChange(!1)})}),he.jsxs(he.Fragment,{children:[he.jsx(I8e,{titleId:i.titleId}),he.jsx(O8e,{contentRef:v,descriptionId:i.descriptionId})]})]})}),TF="DialogTitle",pte=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=jc(TF,n);return he.jsx(Qn.h2,{id:a.titleId,...r,ref:t})});pte.displayName=TF;var mte="DialogDescription",gte=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=jc(mte,n);return he.jsx(Qn.p,{id:a.descriptionId,...r,ref:t})});gte.displayName=mte;var yte="DialogClose",_te=X.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=jc(yte,n);return he.jsx(Qn.button,{type:"button",...r,ref:t,onClick:vn(e.onClick,()=>a.onOpenChange(!1))})});_te.displayName=yte;function EF(e){return e?"open":"closed"}var vte="DialogTitleWarning",[C8e,xte]=ede(vte,{contentName:$m,titleName:TF,docsSlug:"dialog"}),I8e=({titleId:e})=>{const t=xte(vte),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return X.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},M8e="DialogDescriptionWarning",O8e=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${xte(M8e).contentName}}.`;return X.useEffect(()=>{var c;const a=(c=e.current)==null?void 0:c.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},k8e=ate,R8e=lte,D8e=ute,L8e=hte,z8e=dte,N8e=pte,F8e=gte,bte=_te,wte="AlertDialog",[B8e,IXe]=qs(wte,[ote]),Hh=ote(),Ste=e=>{const{__scopeAlertDialog:t,...n}=e,r=Hh(t);return he.jsx(k8e,{...r,...n,modal:!0})};Ste.displayName=wte;var j8e="AlertDialogTrigger",Tte=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Hh(n);return he.jsx(R8e,{...a,...r,ref:t})});Tte.displayName=j8e;var $8e="AlertDialogPortal",Ete=e=>{const{__scopeAlertDialog:t,...n}=e,r=Hh(t);return he.jsx(D8e,{...r,...n})};Ete.displayName=$8e;var U8e="AlertDialogOverlay",Ate=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Hh(n);return he.jsx(L8e,{...a,...r,ref:t})});Ate.displayName=U8e;var y_="AlertDialogContent",[V8e,G8e]=B8e(y_),Pte=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,c=Hh(n),f=X.useRef(null),i=qr(t,f),v=X.useRef(null);return he.jsx(C8e,{contentName:y_,titleName:Cte,docsSlug:"alert-dialog",children:he.jsx(V8e,{scope:n,cancelRef:v,children:he.jsxs(z8e,{role:"alertdialog",...c,...a,ref:i,onOpenAutoFocus:vn(a.onOpenAutoFocus,b=>{var T;b.preventDefault(),(T=v.current)==null||T.focus({preventScroll:!0})}),onPointerDownOutside:b=>b.preventDefault(),onInteractOutside:b=>b.preventDefault(),children:[he.jsx(c3,{children:r}),he.jsx(H8e,{contentRef:f})]})})})});Pte.displayName=y_;var Cte="AlertDialogTitle",Ite=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Hh(n);return he.jsx(N8e,{...a,...r,ref:t})});Ite.displayName=Cte;var Mte="AlertDialogDescription",Ote=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Hh(n);return he.jsx(F8e,{...a,...r,ref:t})});Ote.displayName=Mte;var W8e="AlertDialogAction",kte=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Hh(n);return he.jsx(bte,{...a,...r,ref:t})});kte.displayName=W8e;var Rte="AlertDialogCancel",Dte=X.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=G8e(Rte,n),c=Hh(n),f=qr(t,a);return he.jsx(bte,{...c,...r,ref:f})});Dte.displayName=Rte;var H8e=({contentRef:e})=>{const t=`\`${y_}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${y_}\` by passing a \`${Mte}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${y_}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return X.useEffect(()=>{var r;document.getElementById((r=e.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},MXe=Ste,OXe=Tte,kXe=Ete,RXe=Ate,DXe=Pte,LXe=kte,zXe=Dte,NXe=Ite,FXe=Ote,AF="Switch",[q8e,BXe]=qs(AF),[Z8e,X8e]=q8e(AF),Lte=X.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:a,defaultChecked:c,required:f,disabled:i,value:v="on",onCheckedChange:b,form:T,...A}=e,[M,R]=X.useState(null),B=qr(t,H=>R(H)),L=X.useRef(!1),j=M?T||!!M.closest("form"):!0,[V=!1,$]=ys({prop:a,defaultProp:c,onChange:b});return he.jsxs(Z8e,{scope:n,checked:V,disabled:i,children:[he.jsx(Qn.button,{type:"button",role:"switch","aria-checked":V,"aria-required":f,"data-state":Fte(V),"data-disabled":i?"":void 0,disabled:i,value:v,...A,ref:B,onClick:vn(e.onClick,H=>{$(K=>!K),j&&(L.current=H.isPropagationStopped(),L.current||H.stopPropagation())})}),j&&he.jsx(K8e,{control:M,bubbles:!L.current,name:r,value:v,checked:V,required:f,disabled:i,form:T,style:{transform:"translateX(-100%)"}})]})});Lte.displayName=AF;var zte="SwitchThumb",Nte=X.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,a=X8e(zte,n);return he.jsx(Qn.span,{"data-state":Fte(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:t})});Nte.displayName=zte;var K8e=e=>{const{control:t,checked:n,bubbles:r=!0,...a}=e,c=X.useRef(null),f=ZP(n),i=S3(t);return X.useEffect(()=>{const v=c.current,b=window.HTMLInputElement.prototype,A=Object.getOwnPropertyDescriptor(b,"checked").set;if(f!==n&&A){const M=new Event("click",{bubbles:r});A.call(v,n),v.dispatchEvent(M)}},[f,n,r]),he.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:c,style:{...e.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Fte(e){return e?"checked":"unchecked"}var jXe=Lte,$Xe=Nte;function Y8e(e){return e}var Gk=1,Wk=2,oz=3,y1=4,PW=1e-6;function J8e(e){return"translate("+e+",0)"}function Q8e(e){return"translate(0,"+e+")"}function eGe(e){return t=>+e(t)}function tGe(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function nGe(){return!this.__axis}function Bte(e,t){var n=[],r=null,a=null,c=6,f=6,i=3,v=typeof window<"u"&&window.devicePixelRatio>1?0:.5,b=e===Gk||e===y1?-1:1,T=e===y1||e===Wk?"x":"y",A=e===Gk||e===oz?J8e:Q8e;function M(R){var B=r??(t.ticks?t.ticks.apply(t,n):t.domain()),L=a??(t.tickFormat?t.tickFormat.apply(t,n):Y8e),j=Math.max(c,0)+i,V=t.range(),$=+V[0]+v,H=+V[V.length-1]+v,K=(t.bandwidth?tGe:eGe)(t.copy(),v),Y=R.selection?R.selection():R,se=Y.selectAll(".domain").data([null]),ce=Y.selectAll(".tick").data(B,t).order(),ye=ce.exit(),ze=ce.enter().append("g").attr("class","tick"),Le=ce.select("line"),je=ce.select("text");se=se.merge(se.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ce=ce.merge(ze),Le=Le.merge(ze.append("line").attr("stroke","currentColor").attr(T+"2",b*c)),je=je.merge(ze.append("text").attr("fill","currentColor").attr(T,b*j).attr("dy",e===Gk?"0em":e===oz?"0.71em":"0.32em")),R!==Y&&(se=se.transition(R),ce=ce.transition(R),Le=Le.transition(R),je=je.transition(R),ye=ye.transition(R).attr("opacity",PW).attr("transform",function(Re){return isFinite(Re=K(Re))?A(Re+v):this.getAttribute("transform")}),ze.attr("opacity",PW).attr("transform",function(Re){var $e=this.parentNode.__axis;return A(($e&&isFinite($e=$e(Re))?$e:K(Re))+v)})),ye.remove(),se.attr("d",e===y1||e===Wk?f?"M"+b*f+","+$+"H"+v+"V"+H+"H"+b*f:"M"+v+","+$+"V"+H:f?"M"+$+","+b*f+"V"+v+"H"+H+"V"+b*f:"M"+$+","+v+"H"+H),ce.attr("opacity",1).attr("transform",function(Re){return A(K(Re)+v)}),Le.attr(T+"2",b*c),je.attr(T,b*j).text(L),Y.filter(nGe).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===Wk?"start":e===y1?"end":"middle"),Y.each(function(){this.__axis=K})}return M.scale=function(R){return arguments.length?(t=R,M):t},M.ticks=function(){return n=Array.from(arguments),M},M.tickArguments=function(R){return arguments.length?(n=R==null?[]:Array.from(R),M):n.slice()},M.tickValues=function(R){return arguments.length?(r=R==null?null:Array.from(R),M):r&&r.slice()},M.tickFormat=function(R){return arguments.length?(a=R,M):a},M.tickSize=function(R){return arguments.length?(c=f=+R,M):c},M.tickSizeInner=function(R){return arguments.length?(c=+R,M):c},M.tickSizeOuter=function(R){return arguments.length?(f=+R,M):f},M.tickPadding=function(R){return arguments.length?(i=+R,M):i},M.offset=function(R){return arguments.length?(v=+R,M):v},M}function UXe(e){return Bte(oz,e)}function VXe(e){return Bte(y1,e)}var rGe={value:()=>{}};function jte(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new n2(n)}function n2(e){this._=e}function iGe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}n2.prototype=jte.prototype={constructor:n2,on:function(e,t){var n=this._,r=iGe(e+"",n),a,c=-1,f=r.length;if(arguments.length<2){for(;++c<f;)if((a=(e=r[c]).type)&&(a=oGe(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++c<f;)if(a=(e=r[c]).type)n[a]=CW(n[a],e.name,t);else if(t==null)for(a in n)n[a]=CW(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new n2(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,c;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(c=this._[e],r=0,a=c.length;r<a;++r)c[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,c=r.length;a<c;++a)r[a].value.apply(t,n)}};function oGe(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function CW(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=rGe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var az="http://www.w3.org/1999/xhtml";const IW={svg:"http://www.w3.org/2000/svg",xhtml:az,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function oI(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),IW.hasOwnProperty(t)?{space:IW[t],local:e}:e}function aGe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===az&&t.documentElement.namespaceURI===az?t.createElement(e):t.createElementNS(n,e)}}function sGe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function $te(e){var t=oI(e);return(t.local?sGe:aGe)(t)}function lGe(){}function PF(e){return e==null?lGe:function(){return this.querySelector(e)}}function cGe(e){typeof e!="function"&&(e=PF(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var c=t[a],f=c.length,i=r[a]=new Array(f),v,b,T=0;T<f;++T)(v=c[T])&&(b=e.call(v,v.__data__,T,c))&&("__data__"in v&&(b.__data__=v.__data__),i[T]=b);return new vl(r,this._parents)}function uGe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function hGe(){return[]}function Ute(e){return e==null?hGe:function(){return this.querySelectorAll(e)}}function dGe(e){return function(){return uGe(e.apply(this,arguments))}}function fGe(e){typeof e=="function"?e=dGe(e):e=Ute(e);for(var t=this._groups,n=t.length,r=[],a=[],c=0;c<n;++c)for(var f=t[c],i=f.length,v,b=0;b<i;++b)(v=f[b])&&(r.push(e.call(v,v.__data__,b,f)),a.push(v));return new vl(r,a)}function Vte(e){return function(){return this.matches(e)}}function Gte(e){return function(t){return t.matches(e)}}var pGe=Array.prototype.find;function mGe(e){return function(){return pGe.call(this.children,e)}}function gGe(){return this.firstElementChild}function yGe(e){return this.select(e==null?gGe:mGe(typeof e=="function"?e:Gte(e)))}var _Ge=Array.prototype.filter;function vGe(){return Array.from(this.children)}function xGe(e){return function(){return _Ge.call(this.children,e)}}function bGe(e){return this.selectAll(e==null?vGe:xGe(typeof e=="function"?e:Gte(e)))}function wGe(e){typeof e!="function"&&(e=Vte(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var c=t[a],f=c.length,i=r[a]=[],v,b=0;b<f;++b)(v=c[b])&&e.call(v,v.__data__,b,c)&&i.push(v);return new vl(r,this._parents)}function Wte(e){return new Array(e.length)}function SGe(){return new vl(this._enter||this._groups.map(Wte),this._parents)}function aP(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}aP.prototype={constructor:aP,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function TGe(e){return function(){return e}}function EGe(e,t,n,r,a,c){for(var f=0,i,v=t.length,b=c.length;f<b;++f)(i=t[f])?(i.__data__=c[f],r[f]=i):n[f]=new aP(e,c[f]);for(;f<v;++f)(i=t[f])&&(a[f]=i)}function AGe(e,t,n,r,a,c,f){var i,v,b=new Map,T=t.length,A=c.length,M=new Array(T),R;for(i=0;i<T;++i)(v=t[i])&&(M[i]=R=f.call(v,v.__data__,i,t)+"",b.has(R)?a[i]=v:b.set(R,v));for(i=0;i<A;++i)R=f.call(e,c[i],i,c)+"",(v=b.get(R))?(r[i]=v,v.__data__=c[i],b.delete(R)):n[i]=new aP(e,c[i]);for(i=0;i<T;++i)(v=t[i])&&b.get(M[i])===v&&(a[i]=v)}function PGe(e){return e.__data__}function CGe(e,t){if(!arguments.length)return Array.from(this,PGe);var n=t?AGe:EGe,r=this._parents,a=this._groups;typeof e!="function"&&(e=TGe(e));for(var c=a.length,f=new Array(c),i=new Array(c),v=new Array(c),b=0;b<c;++b){var T=r[b],A=a[b],M=A.length,R=IGe(e.call(T,T&&T.__data__,b,r)),B=R.length,L=i[b]=new Array(B),j=f[b]=new Array(B),V=v[b]=new Array(M);n(T,A,L,j,V,R,t);for(var $=0,H=0,K,Y;$<B;++$)if(K=L[$]){for($>=H&&(H=$+1);!(Y=j[H])&&++H<B;);K._next=Y||null}}return f=new vl(f,r),f._enter=i,f._exit=v,f}function IGe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function MGe(){return new vl(this._exit||this._groups.map(Wte),this._parents)}function OGe(e,t,n){var r=this.enter(),a=this,c=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?c.remove():n(c),r&&a?r.merge(a).order():a}function kGe(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,c=r.length,f=Math.min(a,c),i=new Array(a),v=0;v<f;++v)for(var b=n[v],T=r[v],A=b.length,M=i[v]=new Array(A),R,B=0;B<A;++B)(R=b[B]||T[B])&&(M[B]=R);for(;v<a;++v)i[v]=n[v];return new vl(i,this._parents)}function RGe(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,c=r[a],f;--a>=0;)(f=r[a])&&(c&&f.compareDocumentPosition(c)^4&&c.parentNode.insertBefore(f,c),c=f);return this}function DGe(e){e||(e=LGe);function t(A,M){return A&&M?e(A.__data__,M.__data__):!A-!M}for(var n=this._groups,r=n.length,a=new Array(r),c=0;c<r;++c){for(var f=n[c],i=f.length,v=a[c]=new Array(i),b,T=0;T<i;++T)(b=f[T])&&(v[T]=b);v.sort(t)}return new vl(a,this._parents).order()}function LGe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function zGe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function NGe(){return Array.from(this)}function FGe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,c=r.length;a<c;++a){var f=r[a];if(f)return f}return null}function BGe(){let e=0;for(const t of this)++e;return e}function jGe(){return!this.node()}function $Ge(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],c=0,f=a.length,i;c<f;++c)(i=a[c])&&e.call(i,i.__data__,c,a);return this}function UGe(e){return function(){this.removeAttribute(e)}}function VGe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function GGe(e,t){return function(){this.setAttribute(e,t)}}function WGe(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function HGe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function qGe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ZGe(e,t){var n=oI(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?VGe:UGe:typeof t=="function"?n.local?qGe:HGe:n.local?WGe:GGe)(n,t))}function Hte(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function XGe(e){return function(){this.style.removeProperty(e)}}function KGe(e,t,n){return function(){this.style.setProperty(e,t,n)}}function YGe(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function JGe(e,t,n){return arguments.length>1?this.each((t==null?XGe:typeof t=="function"?YGe:KGe)(e,t,n??"")):hv(this.node(),e)}function hv(e,t){return e.style.getPropertyValue(t)||Hte(e).getComputedStyle(e,null).getPropertyValue(t)}function QGe(e){return function(){delete this[e]}}function eWe(e,t){return function(){this[e]=t}}function tWe(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function nWe(e,t){return arguments.length>1?this.each((t==null?QGe:typeof t=="function"?tWe:eWe)(e,t)):this.node()[e]}function qte(e){return e.trim().split(/^|\s+/)}function CF(e){return e.classList||new Zte(e)}function Zte(e){this._node=e,this._names=qte(e.getAttribute("class")||"")}Zte.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Xte(e,t){for(var n=CF(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function Kte(e,t){for(var n=CF(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function rWe(e){return function(){Xte(this,e)}}function iWe(e){return function(){Kte(this,e)}}function oWe(e,t){return function(){(t.apply(this,arguments)?Xte:Kte)(this,e)}}function aWe(e,t){var n=qte(e+"");if(arguments.length<2){for(var r=CF(this.node()),a=-1,c=n.length;++a<c;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?oWe:t?rWe:iWe)(n,t))}function sWe(){this.textContent=""}function lWe(e){return function(){this.textContent=e}}function cWe(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function uWe(e){return arguments.length?this.each(e==null?sWe:(typeof e=="function"?cWe:lWe)(e)):this.node().textContent}function hWe(){this.innerHTML=""}function dWe(e){return function(){this.innerHTML=e}}function fWe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function pWe(e){return arguments.length?this.each(e==null?hWe:(typeof e=="function"?fWe:dWe)(e)):this.node().innerHTML}function mWe(){this.nextSibling&&this.parentNode.appendChild(this)}function gWe(){return this.each(mWe)}function yWe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _We(){return this.each(yWe)}function vWe(e){var t=typeof e=="function"?e:$te(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function xWe(){return null}function bWe(e,t){var n=typeof e=="function"?e:$te(e),r=t==null?xWe:typeof t=="function"?t:PF(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function wWe(){var e=this.parentNode;e&&e.removeChild(this)}function SWe(){return this.each(wWe)}function TWe(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function EWe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function AWe(e){return this.select(e?EWe:TWe)}function PWe(e){return arguments.length?this.property("__data__",e):this.node().__data__}function CWe(e){return function(t){e.call(this,t,this.__data__)}}function IWe(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function MWe(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,c;n<a;++n)c=t[n],(!e.type||c.type===e.type)&&c.name===e.name?this.removeEventListener(c.type,c.listener,c.options):t[++r]=c;++r?t.length=r:delete this.__on}}}function OWe(e,t,n){return function(){var r=this.__on,a,c=CWe(t);if(r){for(var f=0,i=r.length;f<i;++f)if((a=r[f]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=c,a.options=n),a.value=t;return}}this.addEventListener(e.type,c,n),a={type:e.type,name:e.name,value:t,listener:c,options:n},r?r.push(a):this.__on=[a]}}function kWe(e,t,n){var r=IWe(e+""),a,c=r.length,f;if(arguments.length<2){var i=this.node().__on;if(i){for(var v=0,b=i.length,T;v<b;++v)for(a=0,T=i[v];a<c;++a)if((f=r[a]).type===T.type&&f.name===T.name)return T.value}return}for(i=t?OWe:MWe,a=0;a<c;++a)this.each(i(r[a],t,n));return this}function Yte(e,t,n){var r=Hte(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function RWe(e,t){return function(){return Yte(this,e,t)}}function DWe(e,t){return function(){return Yte(this,e,t.apply(this,arguments))}}function LWe(e,t){return this.each((typeof t=="function"?DWe:RWe)(e,t))}function*zWe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,c=r.length,f;a<c;++a)(f=r[a])&&(yield f)}var Jte=[null];function vl(e,t){this._groups=e,this._parents=t}function Hw(){return new vl([[document.documentElement]],Jte)}function NWe(){return this}vl.prototype=Hw.prototype={constructor:vl,select:cGe,selectAll:fGe,selectChild:yGe,selectChildren:bGe,filter:wGe,data:CGe,enter:SGe,exit:MGe,join:OGe,merge:kGe,selection:NWe,order:RGe,sort:DGe,call:zGe,nodes:NGe,node:FGe,size:BGe,empty:jGe,each:$Ge,attr:ZGe,style:JGe,property:nWe,classed:aWe,text:uWe,html:pWe,raise:gWe,lower:_We,append:vWe,insert:bWe,remove:SWe,clone:AWe,datum:PWe,on:kWe,dispatch:LWe,[Symbol.iterator]:zWe};function GXe(e){return typeof e=="string"?new vl([[document.querySelector(e)]],[document.documentElement]):new vl([[e]],Jte)}var dv=0,_1=0,a1=0,Qte=1e3,sP,v1,lP=0,Um=0,aI=0,uw=typeof performance=="object"&&performance.now?performance:Date,ene=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function IF(){return Um||(ene(FWe),Um=uw.now()+aI)}function FWe(){Um=0}function cP(){this._call=this._time=this._next=null}cP.prototype=tne.prototype={constructor:cP,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?IF():+n)+(t==null?0:+t),!this._next&&v1!==this&&(v1?v1._next=this:sP=this,v1=this),this._call=e,this._time=n,sz()},stop:function(){this._call&&(this._call=null,this._time=1/0,sz())}};function tne(e,t,n){var r=new cP;return r.restart(e,t,n),r}function BWe(){IF(),++dv;for(var e=sP,t;e;)(t=Um-e._time)>=0&&e._call.call(void 0,t),e=e._next;--dv}function MW(){Um=(lP=uw.now())+aI,dv=_1=0;try{BWe()}finally{dv=0,$We(),Um=0}}function jWe(){var e=uw.now(),t=e-lP;t>Qte&&(aI-=t,lP=e)}function $We(){for(var e,t=sP,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:sP=n);v1=e,sz(r)}function sz(e){if(!dv){_1&&(_1=clearTimeout(_1));var t=e-Um;t>24?(e<1/0&&(_1=setTimeout(MW,e-uw.now()-aI)),a1&&(a1=clearInterval(a1))):(a1||(lP=uw.now(),a1=setInterval(jWe,Qte)),dv=1,ene(MW))}}function OW(e,t,n){var r=new cP;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var UWe=jte("start","end","cancel","interrupt"),VWe=[],nne=0,kW=1,lz=2,r2=3,RW=4,cz=5,i2=6;function sI(e,t,n,r,a,c){var f=e.__transition;if(!f)e.__transition={};else if(n in f)return;GWe(e,n,{name:t,index:r,group:a,on:UWe,tween:VWe,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:nne})}function MF(e,t){var n=$c(e,t);if(n.state>nne)throw new Error("too late; already scheduled");return n}function Mu(e,t){var n=$c(e,t);if(n.state>r2)throw new Error("too late; already running");return n}function $c(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function GWe(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=tne(c,0,n.time);function c(b){n.state=kW,n.timer.restart(f,n.delay,n.time),n.delay<=b&&f(b-n.delay)}function f(b){var T,A,M,R;if(n.state!==kW)return v();for(T in r)if(R=r[T],R.name===n.name){if(R.state===r2)return OW(f);R.state===RW?(R.state=i2,R.timer.stop(),R.on.call("interrupt",e,e.__data__,R.index,R.group),delete r[T]):+T<t&&(R.state=i2,R.timer.stop(),R.on.call("cancel",e,e.__data__,R.index,R.group),delete r[T])}if(OW(function(){n.state===r2&&(n.state=RW,n.timer.restart(i,n.delay,n.time),i(b))}),n.state=lz,n.on.call("start",e,e.__data__,n.index,n.group),n.state===lz){for(n.state=r2,a=new Array(M=n.tween.length),T=0,A=-1;T<M;++T)(R=n.tween[T].value.call(e,e.__data__,n.index,n.group))&&(a[++A]=R);a.length=A+1}}function i(b){for(var T=b<n.duration?n.ease.call(null,b/n.duration):(n.timer.restart(v),n.state=cz,1),A=-1,M=a.length;++A<M;)a[A].call(e,T);n.state===cz&&(n.on.call("end",e,e.__data__,n.index,n.group),v())}function v(){n.state=i2,n.timer.stop(),delete r[t];for(var b in r)return;delete e.__transition}}function WWe(e,t){var n=e.__transition,r,a,c=!0,f;if(n){t=t==null?null:t+"";for(f in n){if((r=n[f]).name!==t){c=!1;continue}a=r.state>lz&&r.state<cz,r.state=i2,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[f]}c&&delete e.__transition}}function HWe(e){return this.each(function(){WWe(this,e)})}function qWe(e,t){var n,r;return function(){var a=Mu(this,e),c=a.tween;if(c!==n){r=n=c;for(var f=0,i=r.length;f<i;++f)if(r[f].name===t){r=r.slice(),r.splice(f,1);break}}a.tween=r}}function ZWe(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var c=Mu(this,e),f=c.tween;if(f!==r){a=(r=f).slice();for(var i={name:t,value:n},v=0,b=a.length;v<b;++v)if(a[v].name===t){a[v]=i;break}v===b&&a.push(i)}c.tween=a}}function XWe(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=$c(this.node(),n).tween,a=0,c=r.length,f;a<c;++a)if((f=r[a]).name===e)return f.value;return null}return this.each((t==null?qWe:ZWe)(n,e,t))}function OF(e,t,n){var r=e._id;return e.each(function(){var a=Mu(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return $c(a,r).value[t]}}function rne(e,t){var n;return(typeof t=="number"?Tc:t instanceof Nm?vA:(n=Nm(t))?(t=n,vA):AJ)(e,t)}function KWe(e){return function(){this.removeAttribute(e)}}function YWe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function JWe(e,t,n){var r,a=n+"",c;return function(){var f=this.getAttribute(e);return f===a?null:f===r?c:c=t(r=f,n)}}function QWe(e,t,n){var r,a=n+"",c;return function(){var f=this.getAttributeNS(e.space,e.local);return f===a?null:f===r?c:c=t(r=f,n)}}function e9e(e,t,n){var r,a,c;return function(){var f,i=n(this),v;return i==null?void this.removeAttribute(e):(f=this.getAttribute(e),v=i+"",f===v?null:f===r&&v===a?c:(a=v,c=t(r=f,i)))}}function t9e(e,t,n){var r,a,c;return function(){var f,i=n(this),v;return i==null?void this.removeAttributeNS(e.space,e.local):(f=this.getAttributeNS(e.space,e.local),v=i+"",f===v?null:f===r&&v===a?c:(a=v,c=t(r=f,i)))}}function n9e(e,t){var n=oI(e),r=n==="transform"?zDe:rne;return this.attrTween(e,typeof t=="function"?(n.local?t9e:e9e)(n,r,OF(this,"attr."+e,t)):t==null?(n.local?YWe:KWe)(n):(n.local?QWe:JWe)(n,r,t))}function r9e(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function i9e(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function o9e(e,t){var n,r;function a(){var c=t.apply(this,arguments);return c!==r&&(n=(r=c)&&i9e(e,c)),n}return a._value=t,a}function a9e(e,t){var n,r;function a(){var c=t.apply(this,arguments);return c!==r&&(n=(r=c)&&r9e(e,c)),n}return a._value=t,a}function s9e(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=oI(e);return this.tween(n,(r.local?o9e:a9e)(r,t))}function l9e(e,t){return function(){MF(this,e).delay=+t.apply(this,arguments)}}function c9e(e,t){return t=+t,function(){MF(this,e).delay=t}}function u9e(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?l9e:c9e)(t,e)):$c(this.node(),t).delay}function h9e(e,t){return function(){Mu(this,e).duration=+t.apply(this,arguments)}}function d9e(e,t){return t=+t,function(){Mu(this,e).duration=t}}function f9e(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?h9e:d9e)(t,e)):$c(this.node(),t).duration}function p9e(e,t){if(typeof t!="function")throw new Error;return function(){Mu(this,e).ease=t}}function m9e(e){var t=this._id;return arguments.length?this.each(p9e(t,e)):$c(this.node(),t).ease}function g9e(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Mu(this,e).ease=n}}function y9e(e){if(typeof e!="function")throw new Error;return this.each(g9e(this._id,e))}function _9e(e){typeof e!="function"&&(e=Vte(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var c=t[a],f=c.length,i=r[a]=[],v,b=0;b<f;++b)(v=c[b])&&e.call(v,v.__data__,b,c)&&i.push(v);return new jh(r,this._parents,this._name,this._id)}function v9e(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,c=Math.min(r,a),f=new Array(r),i=0;i<c;++i)for(var v=t[i],b=n[i],T=v.length,A=f[i]=new Array(T),M,R=0;R<T;++R)(M=v[R]||b[R])&&(A[R]=M);for(;i<r;++i)f[i]=t[i];return new jh(f,this._parents,this._name,this._id)}function x9e(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function b9e(e,t,n){var r,a,c=x9e(t)?MF:Mu;return function(){var f=c(this,e),i=f.on;i!==r&&(a=(r=i).copy()).on(t,n),f.on=a}}function w9e(e,t){var n=this._id;return arguments.length<2?$c(this.node(),n).on.on(e):this.each(b9e(n,e,t))}function S9e(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function T9e(){return this.on("end.remove",S9e(this._id))}function E9e(e){var t=this._name,n=this._id;typeof e!="function"&&(e=PF(e));for(var r=this._groups,a=r.length,c=new Array(a),f=0;f<a;++f)for(var i=r[f],v=i.length,b=c[f]=new Array(v),T,A,M=0;M<v;++M)(T=i[M])&&(A=e.call(T,T.__data__,M,i))&&("__data__"in T&&(A.__data__=T.__data__),b[M]=A,sI(b[M],t,n,M,b,$c(T,n)));return new jh(c,this._parents,t,n)}function A9e(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ute(e));for(var r=this._groups,a=r.length,c=[],f=[],i=0;i<a;++i)for(var v=r[i],b=v.length,T,A=0;A<b;++A)if(T=v[A]){for(var M=e.call(T,T.__data__,A,v),R,B=$c(T,n),L=0,j=M.length;L<j;++L)(R=M[L])&&sI(R,t,n,L,M,B);c.push(M),f.push(T)}return new jh(c,f,t,n)}var P9e=Hw.prototype.constructor;function C9e(){return new P9e(this._groups,this._parents)}function I9e(e,t){var n,r,a;return function(){var c=hv(this,e),f=(this.style.removeProperty(e),hv(this,e));return c===f?null:c===n&&f===r?a:a=t(n=c,r=f)}}function ine(e){return function(){this.style.removeProperty(e)}}function M9e(e,t,n){var r,a=n+"",c;return function(){var f=hv(this,e);return f===a?null:f===r?c:c=t(r=f,n)}}function O9e(e,t,n){var r,a,c;return function(){var f=hv(this,e),i=n(this),v=i+"";return i==null&&(v=i=(this.style.removeProperty(e),hv(this,e))),f===v?null:f===r&&v===a?c:(a=v,c=t(r=f,i))}}function k9e(e,t){var n,r,a,c="style."+t,f="end."+c,i;return function(){var v=Mu(this,e),b=v.on,T=v.value[c]==null?i||(i=ine(t)):void 0;(b!==n||a!==T)&&(r=(n=b).copy()).on(f,a=T),v.on=r}}function R9e(e,t,n){var r=(e+="")=="transform"?LDe:rne;return t==null?this.styleTween(e,I9e(e,r)).on("end.style."+e,ine(e)):typeof t=="function"?this.styleTween(e,O9e(e,r,OF(this,"style."+e,t))).each(k9e(this._id,e)):this.styleTween(e,M9e(e,r,t),n).on("end.style."+e,null)}function D9e(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function L9e(e,t,n){var r,a;function c(){var f=t.apply(this,arguments);return f!==a&&(r=(a=f)&&D9e(e,f,n)),r}return c._value=t,c}function z9e(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,L9e(e,t,n??""))}function N9e(e){return function(){this.textContent=e}}function F9e(e){return function(){var t=e(this);this.textContent=t??""}}function B9e(e){return this.tween("text",typeof e=="function"?F9e(OF(this,"text",e)):N9e(e==null?"":e+""))}function j9e(e){return function(t){this.textContent=e.call(this,t)}}function $9e(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&j9e(a)),t}return r._value=e,r}function U9e(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,$9e(e))}function V9e(){for(var e=this._name,t=this._id,n=one(),r=this._groups,a=r.length,c=0;c<a;++c)for(var f=r[c],i=f.length,v,b=0;b<i;++b)if(v=f[b]){var T=$c(v,t);sI(v,e,n,b,f,{time:T.time+T.delay+T.duration,delay:0,duration:T.duration,ease:T.ease})}return new jh(r,this._parents,e,n)}function G9e(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(c,f){var i={value:f},v={value:function(){--a===0&&c()}};n.each(function(){var b=Mu(this,r),T=b.on;T!==e&&(t=(e=T).copy(),t._.cancel.push(i),t._.interrupt.push(i),t._.end.push(v)),b.on=t}),a===0&&c()})}var W9e=0;function jh(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function one(){return++W9e}var dh=Hw.prototype;jh.prototype={constructor:jh,select:E9e,selectAll:A9e,selectChild:dh.selectChild,selectChildren:dh.selectChildren,filter:_9e,merge:v9e,selection:C9e,transition:V9e,call:dh.call,nodes:dh.nodes,node:dh.node,size:dh.size,empty:dh.empty,each:dh.each,on:w9e,attr:n9e,attrTween:s9e,style:R9e,styleTween:z9e,text:B9e,textTween:U9e,remove:T9e,tween:XWe,delay:u9e,duration:f9e,ease:m9e,easeVarying:y9e,end:G9e,[Symbol.iterator]:dh[Symbol.iterator]};function H9e(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var q9e={time:null,delay:0,duration:250,ease:H9e};function Z9e(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function X9e(e){var t,n;e instanceof jh?(t=e._id,e=e._name):(t=one(),(n=q9e).time=IF(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,c=0;c<a;++c)for(var f=r[c],i=f.length,v,b=0;b<i;++b)(v=f[b])&&sI(v,e,t,b,f,n||Z9e(v,t));return new jh(r,this._parents,e,t)}Hw.prototype.interrupt=HWe;Hw.prototype.transition=X9e;function K9e(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const WXe=K9e("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function x1(e,t,n){this.k=e,this.x=t,this.y=n}x1.prototype={constructor:x1,scale:function(e){return e===1?this:new x1(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new x1(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};x1.prototype;var Y9e=e=>{switch(e){case"success":return e7e;case"info":return n7e;case"warning":return t7e;case"error":return r7e;default:return null}},J9e=Array(12).fill(0),Q9e=({visible:e,className:t})=>Se.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Se.createElement("div",{className:"sonner-spinner"},J9e.map((n,r)=>Se.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),e7e=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Se.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),t7e=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Se.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),n7e=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Se.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),r7e=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Se.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),i7e=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Se.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),o7e=()=>{let[e,t]=Se.useState(document.hidden);return Se.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},uz=1,a7e=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...r}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:uz++,c=this.toasts.find(i=>i.id===a),f=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),c?this.toasts=this.toasts.map(i=>i.id===a?(this.publish({...i,...e,id:a,title:n}),{...i,...e,id:a,dismissible:f,title:n}):i):this.addToast({title:n,...r,dismissible:f,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let r=e instanceof Promise?e:e(),a=n!==void 0,c,f=r.then(async v=>{if(c=["resolve",v],Se.isValidElement(v))a=!1,this.create({id:n,type:"default",message:v});else if(l7e(v)&&!v.ok){a=!1;let b=typeof t.error=="function"?await t.error(`HTTP error! status: ${v.status}`):t.error,T=typeof t.description=="function"?await t.description(`HTTP error! status: ${v.status}`):t.description;this.create({id:n,type:"error",message:b,description:T})}else if(t.success!==void 0){a=!1;let b=typeof t.success=="function"?await t.success(v):t.success,T=typeof t.description=="function"?await t.description(v):t.description;this.create({id:n,type:"success",message:b,description:T})}}).catch(async v=>{if(c=["reject",v],t.error!==void 0){a=!1;let b=typeof t.error=="function"?await t.error(v):t.error,T=typeof t.description=="function"?await t.description(v):t.description;this.create({id:n,type:"error",message:b,description:T})}}).finally(()=>{var v;a&&(this.dismiss(n),n=void 0),(v=t.finally)==null||v.call(t)}),i=()=>new Promise((v,b)=>f.then(()=>c[0]==="reject"?b(c[1]):v(c[1])).catch(b));return typeof n!="string"&&typeof n!="number"?{unwrap:i}:Object.assign(n,{unwrap:i})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||uz++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},zs=new a7e,s7e=(e,t)=>{let n=(t==null?void 0:t.id)||uz++;return zs.addToast({title:e,...t,id:n}),n},l7e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",c7e=s7e,u7e=()=>zs.toasts,h7e=()=>zs.getActiveToasts(),HXe=Object.assign(c7e,{success:zs.success,info:zs.info,warning:zs.warning,error:zs.error,custom:zs.custom,message:zs.message,promise:zs.promise,dismiss:zs.dismiss,loading:zs.loading},{getHistory:u7e,getToasts:h7e});function d7e(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}d7e(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function NE(e){return e.label!==void 0}var f7e=3,p7e="32px",m7e="16px",DW=4e3,g7e=356,y7e=14,_7e=20,v7e=200;function mc(...e){return e.filter(Boolean).join(" ")}function x7e(e){let[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}var b7e=e=>{var t,n,r,a,c,f,i,v,b,T,A;let{invert:M,toast:R,unstyled:B,interacting:L,setHeights:j,visibleToasts:V,heights:$,index:H,toasts:K,expanded:Y,removeToast:se,defaultRichColors:ce,closeButton:ye,style:ze,cancelButtonStyle:Le,actionButtonStyle:je,className:Re="",descriptionClassName:$e="",duration:Ge,position:ht,gap:ot,loadingIcon:Je,expandByDefault:Ne,classNames:Xe,icons:pt,closeButtonAriaLabel:zt="Close toast",pauseWhenPageIsHidden:Ft}=e,[un,Tn]=Se.useState(null),[fn,Cn]=Se.useState(null),[Vt,lr]=Se.useState(!1),[Nt,gn]=Se.useState(!1),[xn,kt]=Se.useState(!1),[zn,fr]=Se.useState(!1),[hi,br]=Se.useState(!1),[Pi,Ye]=Se.useState(0),[wt,Rt]=Se.useState(0),pn=Se.useRef(R.duration||Ge||DW),dn=Se.useRef(null),sn=Se.useRef(null),Ln=H===0,ur=H+1<=V,li=R.type,Si=R.dismissible!==!1,la=R.className||"",La=R.descriptionClassName||"",Uo=Se.useMemo(()=>$.findIndex(yt=>yt.toastId===R.id)||0,[$,R.id]),vo=Se.useMemo(()=>{var yt;return(yt=R.closeButton)!=null?yt:ye},[R.closeButton,ye]),ws=Se.useMemo(()=>R.duration||Ge||DW,[R.duration,Ge]),Ta=Se.useRef(0),Lo=Se.useRef(0),ns=Se.useRef(0),za=Se.useRef(null),[Ou,di]=ht.split("-"),rs=Se.useMemo(()=>$.reduce((yt,ti,Fi)=>Fi>=Uo?yt:yt+ti.height,0),[$,Uo]),Kl=o7e(),Na=R.invert||M,Yl=li==="loading";Lo.current=Se.useMemo(()=>Uo*ot+rs,[Uo,rs]),Se.useEffect(()=>{pn.current=ws},[ws]),Se.useEffect(()=>{lr(!0)},[]),Se.useEffect(()=>{let yt=sn.current;if(yt){let ti=yt.getBoundingClientRect().height;return Rt(ti),j(Fi=>[{toastId:R.id,height:ti,position:R.position},...Fi]),()=>j(Fi=>Fi.filter(it=>it.toastId!==R.id))}},[j,R.id]),Se.useLayoutEffect(()=>{if(!Vt)return;let yt=sn.current,ti=yt.style.height;yt.style.height="auto";let Fi=yt.getBoundingClientRect().height;yt.style.height=ti,Rt(Fi),j(it=>it.find(ne=>ne.toastId===R.id)?it.map(ne=>ne.toastId===R.id?{...ne,height:Fi}:ne):[{toastId:R.id,height:Fi,position:R.position},...it])},[Vt,R.title,R.description,j,R.id]);let is=Se.useCallback(()=>{gn(!0),Ye(Lo.current),j(yt=>yt.filter(ti=>ti.toastId!==R.id)),setTimeout(()=>{se(R)},v7e)},[R,se,j,Lo]);Se.useEffect(()=>{if(R.promise&&li==="loading"||R.duration===1/0||R.type==="loading")return;let yt;return Y||L||Ft&&Kl?(()=>{if(ns.current<Ta.current){let ti=new Date().getTime()-Ta.current;pn.current=pn.current-ti}ns.current=new Date().getTime()})():pn.current!==1/0&&(Ta.current=new Date().getTime(),yt=setTimeout(()=>{var ti;(ti=R.onAutoClose)==null||ti.call(R,R),is()},pn.current)),()=>clearTimeout(yt)},[Y,L,R,li,Ft,Kl,is]),Se.useEffect(()=>{R.delete&&is()},[is,R.delete]);function ku(){var yt,ti,Fi;return pt!=null&&pt.loading?Se.createElement("div",{className:mc(Xe==null?void 0:Xe.loader,(yt=R==null?void 0:R.classNames)==null?void 0:yt.loader,"sonner-loader"),"data-visible":li==="loading"},pt.loading):Je?Se.createElement("div",{className:mc(Xe==null?void 0:Xe.loader,(ti=R==null?void 0:R.classNames)==null?void 0:ti.loader,"sonner-loader"),"data-visible":li==="loading"},Je):Se.createElement(Q9e,{className:mc(Xe==null?void 0:Xe.loader,(Fi=R==null?void 0:R.classNames)==null?void 0:Fi.loader),visible:li==="loading"})}return Se.createElement("li",{tabIndex:0,ref:sn,className:mc(Re,la,Xe==null?void 0:Xe.toast,(t=R==null?void 0:R.classNames)==null?void 0:t.toast,Xe==null?void 0:Xe.default,Xe==null?void 0:Xe[li],(n=R==null?void 0:R.classNames)==null?void 0:n[li]),"data-sonner-toast":"","data-rich-colors":(r=R.richColors)!=null?r:ce,"data-styled":!(R.jsx||R.unstyled||B),"data-mounted":Vt,"data-promise":!!R.promise,"data-swiped":hi,"data-removed":Nt,"data-visible":ur,"data-y-position":Ou,"data-x-position":di,"data-index":H,"data-front":Ln,"data-swiping":xn,"data-dismissible":Si,"data-type":li,"data-invert":Na,"data-swipe-out":zn,"data-swipe-direction":fn,"data-expanded":!!(Y||Ne&&Vt),style:{"--index":H,"--toasts-before":H,"--z-index":K.length-H,"--offset":`${Nt?Pi:Lo.current}px`,"--initial-height":Ne?"auto":`${wt}px`,...ze,...R.style},onDragEnd:()=>{kt(!1),Tn(null),za.current=null},onPointerDown:yt=>{Yl||!Si||(dn.current=new Date,Ye(Lo.current),yt.target.setPointerCapture(yt.pointerId),yt.target.tagName!=="BUTTON"&&(kt(!0),za.current={x:yt.clientX,y:yt.clientY}))},onPointerUp:()=>{var yt,ti,Fi,it;if(zn||!Si)return;za.current=null;let ne=Number(((yt=sn.current)==null?void 0:yt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),le=Number(((ti=sn.current)==null?void 0:ti.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Te=new Date().getTime()-((Fi=dn.current)==null?void 0:Fi.getTime()),Oe=un==="x"?ne:le,Ce=Math.abs(Oe)/Te;if(Math.abs(Oe)>=_7e||Ce>.11){Ye(Lo.current),(it=R.onDismiss)==null||it.call(R,R),Cn(un==="x"?ne>0?"right":"left":le>0?"down":"up"),is(),fr(!0),br(!1);return}kt(!1),Tn(null)},onPointerMove:yt=>{var ti,Fi,it,ne;if(!za.current||!Si||((ti=window.getSelection())==null?void 0:ti.toString().length)>0)return;let le=yt.clientY-za.current.y,Te=yt.clientX-za.current.x,Oe=(Fi=e.swipeDirections)!=null?Fi:x7e(ht);!un&&(Math.abs(Te)>1||Math.abs(le)>1)&&Tn(Math.abs(Te)>Math.abs(le)?"x":"y");let Ce={x:0,y:0};un==="y"?(Oe.includes("top")||Oe.includes("bottom"))&&(Oe.includes("top")&&le<0||Oe.includes("bottom")&&le>0)&&(Ce.y=le):un==="x"&&(Oe.includes("left")||Oe.includes("right"))&&(Oe.includes("left")&&Te<0||Oe.includes("right")&&Te>0)&&(Ce.x=Te),(Math.abs(Ce.x)>0||Math.abs(Ce.y)>0)&&br(!0),(it=sn.current)==null||it.style.setProperty("--swipe-amount-x",`${Ce.x}px`),(ne=sn.current)==null||ne.style.setProperty("--swipe-amount-y",`${Ce.y}px`)}},vo&&!R.jsx?Se.createElement("button",{"aria-label":zt,"data-disabled":Yl,"data-close-button":!0,onClick:Yl||!Si?()=>{}:()=>{var yt;is(),(yt=R.onDismiss)==null||yt.call(R,R)},className:mc(Xe==null?void 0:Xe.closeButton,(a=R==null?void 0:R.classNames)==null?void 0:a.closeButton)},(c=pt==null?void 0:pt.close)!=null?c:i7e):null,R.jsx||X.isValidElement(R.title)?R.jsx?R.jsx:typeof R.title=="function"?R.title():R.title:Se.createElement(Se.Fragment,null,li||R.icon||R.promise?Se.createElement("div",{"data-icon":"",className:mc(Xe==null?void 0:Xe.icon,(f=R==null?void 0:R.classNames)==null?void 0:f.icon)},R.promise||R.type==="loading"&&!R.icon?R.icon||ku():null,R.type!=="loading"?R.icon||(pt==null?void 0:pt[li])||Y9e(li):null):null,Se.createElement("div",{"data-content":"",className:mc(Xe==null?void 0:Xe.content,(i=R==null?void 0:R.classNames)==null?void 0:i.content)},Se.createElement("div",{"data-title":"",className:mc(Xe==null?void 0:Xe.title,(v=R==null?void 0:R.classNames)==null?void 0:v.title)},typeof R.title=="function"?R.title():R.title),R.description?Se.createElement("div",{"data-description":"",className:mc($e,La,Xe==null?void 0:Xe.description,(b=R==null?void 0:R.classNames)==null?void 0:b.description)},typeof R.description=="function"?R.description():R.description):null),X.isValidElement(R.cancel)?R.cancel:R.cancel&&NE(R.cancel)?Se.createElement("button",{"data-button":!0,"data-cancel":!0,style:R.cancelButtonStyle||Le,onClick:yt=>{var ti,Fi;NE(R.cancel)&&Si&&((Fi=(ti=R.cancel).onClick)==null||Fi.call(ti,yt),is())},className:mc(Xe==null?void 0:Xe.cancelButton,(T=R==null?void 0:R.classNames)==null?void 0:T.cancelButton)},R.cancel.label):null,X.isValidElement(R.action)?R.action:R.action&&NE(R.action)?Se.createElement("button",{"data-button":!0,"data-action":!0,style:R.actionButtonStyle||je,onClick:yt=>{var ti,Fi;NE(R.action)&&((Fi=(ti=R.action).onClick)==null||Fi.call(ti,yt),!yt.defaultPrevented&&is())},className:mc(Xe==null?void 0:Xe.actionButton,(A=R==null?void 0:R.classNames)==null?void 0:A.actionButton)},R.action.label):null))};function LW(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function w7e(e,t){let n={};return[e,t].forEach((r,a)=>{let c=a===1,f=c?"--mobile-offset":"--offset",i=c?m7e:p7e;function v(b){["top","right","bottom","left"].forEach(T=>{n[`${f}-${T}`]=typeof b=="number"?`${b}px`:b})}typeof r=="number"||typeof r=="string"?v(r):typeof r=="object"?["top","right","bottom","left"].forEach(b=>{r[b]===void 0?n[`${f}-${b}`]=i:n[`${f}-${b}`]=typeof r[b]=="number"?`${r[b]}px`:r[b]}):v(i)}),n}var qXe=X.forwardRef(function(e,t){let{invert:n,position:r="bottom-right",hotkey:a=["altKey","KeyT"],expand:c,closeButton:f,className:i,offset:v,mobileOffset:b,theme:T="light",richColors:A,duration:M,style:R,visibleToasts:B=f7e,toastOptions:L,dir:j=LW(),gap:V=y7e,loadingIcon:$,icons:H,containerAriaLabel:K="Notifications",pauseWhenPageIsHidden:Y}=e,[se,ce]=Se.useState([]),ye=Se.useMemo(()=>Array.from(new Set([r].concat(se.filter(Ft=>Ft.position).map(Ft=>Ft.position)))),[se,r]),[ze,Le]=Se.useState([]),[je,Re]=Se.useState(!1),[$e,Ge]=Se.useState(!1),[ht,ot]=Se.useState(T!=="system"?T:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Je=Se.useRef(null),Ne=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),Xe=Se.useRef(null),pt=Se.useRef(!1),zt=Se.useCallback(Ft=>{ce(un=>{var Tn;return(Tn=un.find(fn=>fn.id===Ft.id))!=null&&Tn.delete||zs.dismiss(Ft.id),un.filter(({id:fn})=>fn!==Ft.id)})},[]);return Se.useEffect(()=>zs.subscribe(Ft=>{if(Ft.dismiss){ce(un=>un.map(Tn=>Tn.id===Ft.id?{...Tn,delete:!0}:Tn));return}setTimeout(()=>{PP.flushSync(()=>{ce(un=>{let Tn=un.findIndex(fn=>fn.id===Ft.id);return Tn!==-1?[...un.slice(0,Tn),{...un[Tn],...Ft},...un.slice(Tn+1)]:[Ft,...un]})})})}),[]),Se.useEffect(()=>{if(T!=="system"){ot(T);return}if(T==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ot("dark"):ot("light")),typeof window>"u")return;let Ft=window.matchMedia("(prefers-color-scheme: dark)");try{Ft.addEventListener("change",({matches:un})=>{ot(un?"dark":"light")})}catch{Ft.addListener(({matches:Tn})=>{try{ot(Tn?"dark":"light")}catch(fn){console.error(fn)}})}},[T]),Se.useEffect(()=>{se.length<=1&&Re(!1)},[se]),Se.useEffect(()=>{let Ft=un=>{var Tn,fn;a.every(Cn=>un[Cn]||un.code===Cn)&&(Re(!0),(Tn=Je.current)==null||Tn.focus()),un.code==="Escape"&&(document.activeElement===Je.current||(fn=Je.current)!=null&&fn.contains(document.activeElement))&&Re(!1)};return document.addEventListener("keydown",Ft),()=>document.removeEventListener("keydown",Ft)},[a]),Se.useEffect(()=>{if(Je.current)return()=>{Xe.current&&(Xe.current.focus({preventScroll:!0}),Xe.current=null,pt.current=!1)}},[Je.current]),Se.createElement("section",{ref:t,"aria-label":`${K} ${Ne}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ye.map((Ft,un)=>{var Tn;let[fn,Cn]=Ft.split("-");return se.length?Se.createElement("ol",{key:Ft,dir:j==="auto"?LW():j,tabIndex:-1,ref:Je,className:i,"data-sonner-toaster":!0,"data-theme":ht,"data-y-position":fn,"data-lifted":je&&se.length>1&&!c,"data-x-position":Cn,style:{"--front-toast-height":`${((Tn=ze[0])==null?void 0:Tn.height)||0}px`,"--width":`${g7e}px`,"--gap":`${V}px`,...R,...w7e(v,b)},onBlur:Vt=>{pt.current&&!Vt.currentTarget.contains(Vt.relatedTarget)&&(pt.current=!1,Xe.current&&(Xe.current.focus({preventScroll:!0}),Xe.current=null))},onFocus:Vt=>{Vt.target instanceof HTMLElement&&Vt.target.dataset.dismissible==="false"||pt.current||(pt.current=!0,Xe.current=Vt.relatedTarget)},onMouseEnter:()=>Re(!0),onMouseMove:()=>Re(!0),onMouseLeave:()=>{$e||Re(!1)},onDragEnd:()=>Re(!1),onPointerDown:Vt=>{Vt.target instanceof HTMLElement&&Vt.target.dataset.dismissible==="false"||Ge(!0)},onPointerUp:()=>Ge(!1)},se.filter(Vt=>!Vt.position&&un===0||Vt.position===Ft).map((Vt,lr)=>{var Nt,gn;return Se.createElement(b7e,{key:Vt.id,icons:H,index:lr,toast:Vt,defaultRichColors:A,duration:(Nt=L==null?void 0:L.duration)!=null?Nt:M,className:L==null?void 0:L.className,descriptionClassName:L==null?void 0:L.descriptionClassName,invert:n,visibleToasts:B,closeButton:(gn=L==null?void 0:L.closeButton)!=null?gn:f,interacting:$e,position:Ft,style:L==null?void 0:L.style,unstyled:L==null?void 0:L.unstyled,classNames:L==null?void 0:L.classNames,cancelButtonStyle:L==null?void 0:L.cancelButtonStyle,actionButtonStyle:L==null?void 0:L.actionButtonStyle,removeToast:zt,toasts:se.filter(xn=>xn.position==Vt.position),heights:ze.filter(xn=>xn.position==Vt.position),setHeights:Le,expandByDefault:c,gap:V,loadingIcon:$,expanded:je,pauseWhenPageIsHidden:Y,swipeDirections:e.swipeDirections})})):null}))}),kF="Collapsible",[S7e,ane]=qs(kF),[T7e,RF]=S7e(kF),sne=X.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:c,onOpenChange:f,...i}=e,[v=!1,b]=ys({prop:r,defaultProp:a,onChange:f});return he.jsx(T7e,{scope:n,disabled:c,contentId:Qa(),open:v,onOpenToggle:X.useCallback(()=>b(T=>!T),[b]),children:he.jsx(Qn.div,{"data-state":LF(v),"data-disabled":c?"":void 0,...i,ref:t})})});sne.displayName=kF;var lne="CollapsibleTrigger",cne=X.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=RF(lne,n);return he.jsx(Qn.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":LF(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:vn(e.onClick,a.onOpenToggle)})});cne.displayName=lne;var DF="CollapsibleContent",une=X.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=RF(DF,e.__scopeCollapsible);return he.jsx(wa,{present:n||a.open,children:({present:c})=>he.jsx(E7e,{...r,ref:t,present:c})})});une.displayName=DF;var E7e=X.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...c}=e,f=RF(DF,n),[i,v]=X.useState(r),b=X.useRef(null),T=qr(t,b),A=X.useRef(0),M=A.current,R=X.useRef(0),B=R.current,L=f.open||i,j=X.useRef(L),V=X.useRef();return X.useEffect(()=>{const $=requestAnimationFrame(()=>j.current=!1);return()=>cancelAnimationFrame($)},[]),$o(()=>{const $=b.current;if($){V.current=V.current||{transitionDuration:$.style.transitionDuration,animationName:$.style.animationName},$.style.transitionDuration="0s",$.style.animationName="none";const H=$.getBoundingClientRect();A.current=H.height,R.current=H.width,j.current||($.style.transitionDuration=V.current.transitionDuration,$.style.animationName=V.current.animationName),v(r)}},[f.open,r]),he.jsx(Qn.div,{"data-state":LF(f.open),"data-disabled":f.disabled?"":void 0,id:f.contentId,hidden:!L,...c,ref:T,style:{"--radix-collapsible-content-height":M?`${M}px`:void 0,"--radix-collapsible-content-width":B?`${B}px`:void 0,...e.style},children:L&&a})});function LF(e){return e?"open":"closed"}var A7e=sne,P7e=cne,C7e=une,qh="Accordion",I7e=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[zF,M7e,O7e]=xv(qh),[lI,ZXe]=qs(qh,[O7e,ane]),NF=ane(),hne=Se.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,c=r;return he.jsx(zF.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?he.jsx(L7e,{...c,ref:t}):he.jsx(D7e,{...a,ref:t})})});hne.displayName=qh;var[dne,k7e]=lI(qh),[fne,R7e]=lI(qh,{collapsible:!1}),D7e=Se.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:c=!1,...f}=e,[i,v]=ys({prop:n,defaultProp:r,onChange:a});return he.jsx(dne,{scope:e.__scopeAccordion,value:i?[i]:[],onItemOpen:v,onItemClose:Se.useCallback(()=>c&&v(""),[c,v]),children:he.jsx(fne,{scope:e.__scopeAccordion,collapsible:c,children:he.jsx(pne,{...f,ref:t})})})}),L7e=Se.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...c}=e,[f=[],i]=ys({prop:n,defaultProp:r,onChange:a}),v=Se.useCallback(T=>i((A=[])=>[...A,T]),[i]),b=Se.useCallback(T=>i((A=[])=>A.filter(M=>M!==T)),[i]);return he.jsx(dne,{scope:e.__scopeAccordion,value:f,onItemOpen:v,onItemClose:b,children:he.jsx(fne,{scope:e.__scopeAccordion,collapsible:!0,children:he.jsx(pne,{...c,ref:t})})})}),[z7e,cI]=lI(qh),pne=Se.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:c="vertical",...f}=e,i=Se.useRef(null),v=qr(i,t),b=M7e(n),A=bv(a)==="ltr",M=vn(e.onKeyDown,R=>{var ye;if(!I7e.includes(R.key))return;const B=R.target,L=b().filter(ze=>{var Le;return!((Le=ze.ref.current)!=null&&Le.disabled)}),j=L.findIndex(ze=>ze.ref.current===B),V=L.length;if(j===-1)return;R.preventDefault();let $=j;const H=0,K=V-1,Y=()=>{$=j+1,$>K&&($=H)},se=()=>{$=j-1,$<H&&($=K)};switch(R.key){case"Home":$=H;break;case"End":$=K;break;case"ArrowRight":c==="horizontal"&&(A?Y():se());break;case"ArrowDown":c==="vertical"&&Y();break;case"ArrowLeft":c==="horizontal"&&(A?se():Y());break;case"ArrowUp":c==="vertical"&&se();break}const ce=$%V;(ye=L[ce].ref.current)==null||ye.focus()});return he.jsx(z7e,{scope:n,disabled:r,direction:a,orientation:c,children:he.jsx(zF.Slot,{scope:n,children:he.jsx(Qn.div,{...f,"data-orientation":c,ref:v,onKeyDown:r?void 0:M})})})}),uP="AccordionItem",[N7e,FF]=lI(uP),mne=Se.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,c=cI(uP,n),f=k7e(uP,n),i=NF(n),v=Qa(),b=r&&f.value.includes(r)||!1,T=c.disabled||e.disabled;return he.jsx(N7e,{scope:n,open:b,disabled:T,triggerId:v,children:he.jsx(A7e,{"data-orientation":c.orientation,"data-state":bne(b),...i,...a,ref:t,disabled:T,open:b,onOpenChange:A=>{A?f.onItemOpen(r):f.onItemClose(r)}})})});mne.displayName=uP;var gne="AccordionHeader",yne=Se.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=cI(qh,n),c=FF(gne,n);return he.jsx(Qn.h3,{"data-orientation":a.orientation,"data-state":bne(c.open),"data-disabled":c.disabled?"":void 0,...r,ref:t})});yne.displayName=gne;var hz="AccordionTrigger",_ne=Se.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=cI(qh,n),c=FF(hz,n),f=R7e(hz,n),i=NF(n);return he.jsx(zF.ItemSlot,{scope:n,children:he.jsx(P7e,{"aria-disabled":c.open&&!f.collapsible||void 0,"data-orientation":a.orientation,id:c.triggerId,...i,...r,ref:t})})});_ne.displayName=hz;var vne="AccordionContent",xne=Se.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=cI(qh,n),c=FF(vne,n),f=NF(n);return he.jsx(C7e,{role:"region","aria-labelledby":c.triggerId,"data-orientation":a.orientation,...f,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});xne.displayName=vne;function bne(e){return e?"open":"closed"}var XXe=hne,KXe=mne,YXe=yne,JXe=_ne,QXe=xne,wne={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Oa,function(){var n,r,a;function c(i,v){if(!n)n=v;else if(!r)r=v;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",T={};n(T),a=v(T),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}c(["exports"],function(i){var v=1e-6,b=typeof Float32Array<"u"?Float32Array:Array;function T(u,o){var l=o[0],d=o[1],p=o[2],y=o[3],_=l*y-p*d;return _?(u[0]=y*(_=1/_),u[1]=-d*_,u[2]=-p*_,u[3]=l*_,u):null}function A(){var u=new b(9);return b!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function M(u,o){var l=o[0],d=o[1],p=o[2],y=o[3],_=o[4],S=o[5],P=o[6],I=o[7],k=o[8];return u[0]=_*k-S*I,u[1]=p*I-d*k,u[2]=d*S-p*_,u[3]=S*P-y*k,u[4]=l*k-p*P,u[5]=p*y-l*S,u[6]=y*I-_*P,u[7]=d*P-l*I,u[8]=l*_-d*y,u}function R(u,o,l){var d=o[0],p=o[1],y=o[2],_=o[3],S=o[4],P=o[5],I=o[6],k=o[7],D=o[8],N=l[0],W=l[1],q=l[2],J=l[3],ie=l[4],ae=l[5],me=l[6],de=l[7],Q=l[8];return u[0]=N*d+W*_+q*I,u[1]=N*p+W*S+q*k,u[2]=N*y+W*P+q*D,u[3]=J*d+ie*_+ae*I,u[4]=J*p+ie*S+ae*k,u[5]=J*y+ie*P+ae*D,u[6]=me*d+de*_+Q*I,u[7]=me*p+de*S+Q*k,u[8]=me*y+de*P+Q*D,u}function B(){var u=new b(16);return b!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u}function L(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function j(u,o){var l=o[0],d=o[1],p=o[2],y=o[3],_=o[4],S=o[5],P=o[6],I=o[7],k=o[8],D=o[9],N=o[10],W=o[11],q=o[12],J=o[13],ie=o[14],ae=o[15],me=l*S-d*_,de=l*P-p*_,Q=l*I-y*_,ue=d*P-p*S,pe=d*I-y*S,ve=p*I-y*P,Ie=k*J-D*q,De=k*ie-N*q,Fe=k*ae-W*q,He=D*ie-N*J,ct=D*ae-W*J,St=N*ae-W*ie,_t=me*St-de*ct+Q*He+ue*Fe-pe*De+ve*Ie;return _t?(u[0]=(S*St-P*ct+I*He)*(_t=1/_t),u[1]=(p*ct-d*St-y*He)*_t,u[2]=(J*ve-ie*pe+ae*ue)*_t,u[3]=(N*pe-D*ve-W*ue)*_t,u[4]=(P*Fe-_*St-I*De)*_t,u[5]=(l*St-p*Fe+y*De)*_t,u[6]=(ie*Q-q*ve-ae*de)*_t,u[7]=(k*ve-N*Q+W*de)*_t,u[8]=(_*ct-S*Fe+I*Ie)*_t,u[9]=(d*Fe-l*ct-y*Ie)*_t,u[10]=(q*pe-J*Q+ae*me)*_t,u[11]=(D*Q-k*pe-W*me)*_t,u[12]=(S*De-_*He-P*Ie)*_t,u[13]=(l*He-d*De+p*Ie)*_t,u[14]=(J*de-q*ue-ie*me)*_t,u[15]=(k*ue-D*de+N*me)*_t,u):null}function V(u,o,l){var d=o[0],p=o[1],y=o[2],_=o[3],S=o[4],P=o[5],I=o[6],k=o[7],D=o[8],N=o[9],W=o[10],q=o[11],J=o[12],ie=o[13],ae=o[14],me=o[15],de=l[0],Q=l[1],ue=l[2],pe=l[3];return u[0]=de*d+Q*S+ue*D+pe*J,u[1]=de*p+Q*P+ue*N+pe*ie,u[2]=de*y+Q*I+ue*W+pe*ae,u[3]=de*_+Q*k+ue*q+pe*me,u[4]=(de=l[4])*d+(Q=l[5])*S+(ue=l[6])*D+(pe=l[7])*J,u[5]=de*p+Q*P+ue*N+pe*ie,u[6]=de*y+Q*I+ue*W+pe*ae,u[7]=de*_+Q*k+ue*q+pe*me,u[8]=(de=l[8])*d+(Q=l[9])*S+(ue=l[10])*D+(pe=l[11])*J,u[9]=de*p+Q*P+ue*N+pe*ie,u[10]=de*y+Q*I+ue*W+pe*ae,u[11]=de*_+Q*k+ue*q+pe*me,u[12]=(de=l[12])*d+(Q=l[13])*S+(ue=l[14])*D+(pe=l[15])*J,u[13]=de*p+Q*P+ue*N+pe*ie,u[14]=de*y+Q*I+ue*W+pe*ae,u[15]=de*_+Q*k+ue*q+pe*me,u}function $(u,o,l){var d,p,y,_,S,P,I,k,D,N,W,q,J=l[0],ie=l[1],ae=l[2];return o===u?(u[12]=o[0]*J+o[4]*ie+o[8]*ae+o[12],u[13]=o[1]*J+o[5]*ie+o[9]*ae+o[13],u[14]=o[2]*J+o[6]*ie+o[10]*ae+o[14],u[15]=o[3]*J+o[7]*ie+o[11]*ae+o[15]):(p=o[1],y=o[2],_=o[3],S=o[4],P=o[5],I=o[6],k=o[7],D=o[8],N=o[9],W=o[10],q=o[11],u[0]=d=o[0],u[1]=p,u[2]=y,u[3]=_,u[4]=S,u[5]=P,u[6]=I,u[7]=k,u[8]=D,u[9]=N,u[10]=W,u[11]=q,u[12]=d*J+S*ie+D*ae+o[12],u[13]=p*J+P*ie+N*ae+o[13],u[14]=y*J+I*ie+W*ae+o[14],u[15]=_*J+k*ie+q*ae+o[15]),u}function H(u,o,l){var d=l[0],p=l[1],y=l[2];return u[0]=o[0]*d,u[1]=o[1]*d,u[2]=o[2]*d,u[3]=o[3]*d,u[4]=o[4]*p,u[5]=o[5]*p,u[6]=o[6]*p,u[7]=o[7]*p,u[8]=o[8]*y,u[9]=o[9]*y,u[10]=o[10]*y,u[11]=o[11]*y,u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15],u}function K(u,o,l){var d=Math.sin(l),p=Math.cos(l),y=o[4],_=o[5],S=o[6],P=o[7],I=o[8],k=o[9],D=o[10],N=o[11];return o!==u&&(u[0]=o[0],u[1]=o[1],u[2]=o[2],u[3]=o[3],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[4]=y*p+I*d,u[5]=_*p+k*d,u[6]=S*p+D*d,u[7]=P*p+N*d,u[8]=I*p-y*d,u[9]=k*p-_*d,u[10]=D*p-S*d,u[11]=N*p-P*d,u}function Y(u,o,l){var d=Math.sin(l),p=Math.cos(l),y=o[0],_=o[1],S=o[2],P=o[3],I=o[8],k=o[9],D=o[10],N=o[11];return o!==u&&(u[4]=o[4],u[5]=o[5],u[6]=o[6],u[7]=o[7],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[0]=y*p-I*d,u[1]=_*p-k*d,u[2]=S*p-D*d,u[3]=P*p-N*d,u[8]=y*d+I*p,u[9]=_*d+k*p,u[10]=S*d+D*p,u[11]=P*d+N*p,u}function se(u,o,l){var d=Math.sin(l),p=Math.cos(l),y=o[0],_=o[1],S=o[2],P=o[3],I=o[4],k=o[5],D=o[6],N=o[7];return o!==u&&(u[8]=o[8],u[9]=o[9],u[10]=o[10],u[11]=o[11],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[0]=y*p+I*d,u[1]=_*p+k*d,u[2]=S*p+D*d,u[3]=P*p+N*d,u[4]=I*p-y*d,u[5]=k*p-_*d,u[6]=D*p-S*d,u[7]=N*p-P*d,u}function ce(u,o){return u[0]=o[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=o[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=o[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function ye(u,o,l){var d,p,y,_=l[0],S=l[1],P=l[2],I=Math.hypot(_,S,P);return I<v?null:(_*=I=1/I,S*=I,P*=I,d=Math.sin(o),p=Math.cos(o),u[0]=_*_*(y=1-p)+p,u[1]=S*_*y+P*d,u[2]=P*_*y-S*d,u[3]=0,u[4]=_*S*y-P*d,u[5]=S*S*y+p,u[6]=P*S*y+_*d,u[7]=0,u[8]=_*P*y+S*d,u[9]=S*P*y-_*d,u[10]=P*P*y+p,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}function ze(u,o){var l=o[0],d=o[1],p=o[2],y=o[3],_=l+l,S=d+d,P=p+p,I=l*_,k=d*_,D=d*S,N=p*_,W=p*S,q=p*P,J=y*_,ie=y*S,ae=y*P;return u[0]=1-D-q,u[1]=k+ae,u[2]=N-ie,u[3]=0,u[4]=k-ae,u[5]=1-I-q,u[6]=W+J,u[7]=0,u[8]=N+ie,u[9]=W-J,u[10]=1-I-D,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}Math.hypot||(Math.hypot=function(){for(var u=0,o=arguments.length;o--;)u+=arguments[o]*arguments[o];return Math.sqrt(u)});var Le=V;function je(){var u=new b(3);return b!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function Re(u){var o=new b(3);return o[0]=u[0],o[1]=u[1],o[2]=u[2],o}function $e(u){return Math.hypot(u[0],u[1],u[2])}function Ge(u,o,l){var d=new b(3);return d[0]=u,d[1]=o,d[2]=l,d}function ht(u,o,l){return u[0]=o[0]+l[0],u[1]=o[1]+l[1],u[2]=o[2]+l[2],u}function ot(u,o,l){return u[0]=o[0]-l[0],u[1]=o[1]-l[1],u[2]=o[2]-l[2],u}function Je(u,o,l){return u[0]=o[0]*l[0],u[1]=o[1]*l[1],u[2]=o[2]*l[2],u}function Ne(u,o,l){return u[0]=Math.min(o[0],l[0]),u[1]=Math.min(o[1],l[1]),u[2]=Math.min(o[2],l[2]),u}function Xe(u,o,l){return u[0]=Math.max(o[0],l[0]),u[1]=Math.max(o[1],l[1]),u[2]=Math.max(o[2],l[2]),u}function pt(u,o,l){return u[0]=o[0]*l,u[1]=o[1]*l,u[2]=o[2]*l,u}function zt(u,o,l,d){return u[0]=o[0]+l[0]*d,u[1]=o[1]+l[1]*d,u[2]=o[2]+l[2]*d,u}function Ft(u,o){var l=o[0]-u[0],d=o[1]-u[1],p=o[2]-u[2];return l*l+d*d+p*p}function un(u){var o=u[0],l=u[1],d=u[2];return o*o+l*l+d*d}function Tn(u,o){return u[0]=-o[0],u[1]=-o[1],u[2]=-o[2],u}function fn(u,o){var l=o[0],d=o[1],p=o[2],y=l*l+d*d+p*p;return y>0&&(y=1/Math.sqrt(y)),u[0]=o[0]*y,u[1]=o[1]*y,u[2]=o[2]*y,u}function Cn(u,o){return u[0]*o[0]+u[1]*o[1]+u[2]*o[2]}function Vt(u,o,l){var d=o[0],p=o[1],y=o[2],_=l[0],S=l[1],P=l[2];return u[0]=p*P-y*S,u[1]=y*_-d*P,u[2]=d*S-p*_,u}function lr(u,o,l,d){var p=o[0],y=o[1],_=o[2];return u[0]=p+d*(l[0]-p),u[1]=y+d*(l[1]-y),u[2]=_+d*(l[2]-_),u}function Nt(u,o,l){var d=o[0],p=o[1],y=o[2],_=l[3]*d+l[7]*p+l[11]*y+l[15];return u[0]=(l[0]*d+l[4]*p+l[8]*y+l[12])/(_=_||1),u[1]=(l[1]*d+l[5]*p+l[9]*y+l[13])/_,u[2]=(l[2]*d+l[6]*p+l[10]*y+l[14])/_,u}function gn(u,o,l){var d=o[0],p=o[1],y=o[2];return u[0]=d*l[0]+p*l[3]+y*l[6],u[1]=d*l[1]+p*l[4]+y*l[7],u[2]=d*l[2]+p*l[5]+y*l[8],u}function xn(u,o,l){var d=l[0],p=l[1],y=l[2],_=o[0],S=o[1],P=o[2],I=p*P-y*S,k=y*_-d*P,D=d*S-p*_,N=p*D-y*k,W=y*I-d*D,q=d*k-p*I,J=2*l[3];return k*=J,D*=J,W*=2,q*=2,u[0]=_+(I*=J)+(N*=2),u[1]=S+k+W,u[2]=P+D+q,u}function kt(u,o){return u[0]===o[0]&&u[1]===o[1]&&u[2]===o[2]}var zn=ot,fr=Je,hi=$e;function br(){var u=new b(4);return b!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0,u[3]=0),u}function Pi(u,o,l){return u[0]=o[0]*l,u[1]=o[1]*l,u[2]=o[2]*l,u[3]=o[3]*l,u}function Ye(u,o){var l=o[0],d=o[1],p=o[2],y=o[3],_=l*l+d*d+p*p+y*y;return _>0&&(_=1/Math.sqrt(_)),u[0]=l*_,u[1]=d*_,u[2]=p*_,u[3]=y*_,u}function wt(u,o,l){var d=o[0],p=o[1],y=o[2],_=o[3];return u[0]=l[0]*d+l[4]*p+l[8]*y+l[12]*_,u[1]=l[1]*d+l[5]*p+l[9]*y+l[13]*_,u[2]=l[2]*d+l[6]*p+l[10]*y+l[14]*_,u[3]=l[3]*d+l[7]*p+l[11]*y+l[15]*_,u}function Rt(){var u=new b(4);return b!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function pn(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function dn(u,o,l){l*=.5;var d=o[0],p=o[1],y=o[2],_=o[3],S=Math.sin(l),P=Math.cos(l);return u[0]=d*P+_*S,u[1]=p*P+y*S,u[2]=y*P-p*S,u[3]=_*P-d*S,u}function sn(u,o,l){l*=.5;var d=o[0],p=o[1],y=o[2],_=o[3],S=Math.sin(l),P=Math.cos(l);return u[0]=d*P-y*S,u[1]=p*P+_*S,u[2]=y*P+d*S,u[3]=_*P-p*S,u}je(),br();var Ln,ur,li,Si,la,La=Ye,Uo=(Ln=je(),ur=Ge(1,0,0),li=Ge(0,1,0),function(u,o,l){var d=Cn(o,l);return d<-.999999?(Vt(Ln,ur,o),hi(Ln)<1e-6&&Vt(Ln,li,o),fn(Ln,Ln),function(p,y,_){_*=.5;var S=Math.sin(_);p[0]=S*y[0],p[1]=S*y[1],p[2]=S*y[2],p[3]=Math.cos(_)}(u,Ln,Math.PI),u):d>.999999?(u[0]=0,u[1]=0,u[2]=0,u[3]=1,u):(Vt(Ln,o,l),u[0]=Ln[0],u[1]=Ln[1],u[2]=Ln[2],u[3]=1+d,La(u,u))});function vo(){var u=new b(2);return b!=Float32Array&&(u[0]=0,u[1]=0),u}function ws(u,o){var l=new b(2);return l[0]=u,l[1]=o,l}function Ta(u,o,l){return u[0]=o[0]+l[0],u[1]=o[1]+l[1],u}function Lo(u,o,l){return u[0]=o[0]-l[0],u[1]=o[1]-l[1],u}function ns(u,o,l){return u[0]=o[0]*l,u[1]=o[1]*l,u}function za(u){return Math.hypot(u[0],u[1])}function Ou(u,o){var l=o[0],d=o[1],p=l*l+d*d;return p>0&&(p=1/Math.sqrt(p)),u[0]=o[0]*p,u[1]=o[1]*p,u}function di(u,o){return u[0]*o[0]+u[1]*o[1]}function rs(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}Rt(),Rt(),A(),vo();var Kl,Na,Yl=function(){if(la)return Si;function u(o,l,d,p){this.cx=3*o,this.bx=3*(d-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(p-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=l,this.p2x=d,this.p2y=p}return la=1,Si=u,u.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,l){if(l===void 0&&(l=1e-6),o<0)return 0;if(o>1)return 1;for(var d=o,p=0;p<8;p++){var y=this.sampleCurveX(d)-o;if(Math.abs(y)<l)return d;var _=this.sampleCurveDerivativeX(d);if(Math.abs(_)<1e-6)break;d-=y/_}var S=0,P=1;for(d=o,p=0;p<20&&(y=this.sampleCurveX(d),!(Math.abs(y-o)<l));p++)o>y?S=d:P=d,d=.5*(P-S)+S;return d},solve:function(o,l){return this.sampleCurveY(this.solveCurveX(o,l))}},Si}(),is=rs(Yl);function ku(){if(Na)return Kl;function u(o,l){this.x=o,this.y=l}return Na=1,Kl=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,l){return this.clone()._rotateAround(o,l)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var l=o.x-this.x,d=o.y-this.y;return l*l+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,l){return Math.atan2(this.x*l-this.y*o,this.x*o+this.y*l)},_matMult:function(o){var l=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=l,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var l=Math.cos(o),d=Math.sin(o),p=d*this.x+l*this.y;return this.x=l*this.x-d*this.y,this.y=p,this},_rotateAround:function(o,l){var d=Math.cos(o),p=Math.sin(o),y=l.y+p*(this.x-l.x)+d*(this.y-l.y);return this.x=l.x+d*(this.x-l.x)-p*(this.y-l.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(o){return o instanceof u?o:Array.isArray(o)?new u(o[0],o[1]):o},Kl}var yt=rs(ku());function ti(u,o){if(Array.isArray(u)){if(!Array.isArray(o)||u.length!==o.length)return!1;for(let l=0;l<u.length;l++)if(!ti(u[l],o[l]))return!1;return!0}if(typeof u=="object"&&u!==null&&o!==null){if(typeof o!="object"||Object.keys(u).length!==Object.keys(o).length)return!1;for(const l in u)if(!ti(u[l],o[l]))return!1;return!0}return u===o}const Fi=Math.PI/180,it=180/Math.PI;function ne(u){return u*Fi}function le(u){return u*it}const Te=[[0,0],[1,0],[1,1],[0,1]];function Oe(u){if(u<=0)return 0;if(u>=1)return 1;const o=u*u,l=o*u;return 4*(u<.5?l:3*(u-o)+l-.75)}function Ce(u,o,l,d){const p=new is(u,o,l,d);return function(y){return p.solve(y)}}const Be=Ce(.25,.1,.25,1);function Ue(u,o,l){return Math.min(l,Math.max(o,u))}function Ve(u,o,l){return(l=Ue((l-u)/(o-u),0,1))*l*(3-2*l)}function rt(u,o,l){const d=l-o,p=((u-o)%d+d)%d+o;return p===o?l:p}function ft(u,o,l){if(!u.length)return l(null,[]);let d=u.length;const p=new Array(u.length);let y=null;u.forEach((_,S)=>{o(_,(P,I)=>{P&&(y=P),p[S]=I,--d==0&&l(y,p)})})}function tt(u,...o){for(const l of o)for(const d in l)u[d]=l[d];return u}let Bt=1;function Ht(){return Bt++}function rn(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function Dn(u,o){u.forEach(l=>{o[l]&&(o[l]=o[l].bind(o))})}function jn(u,o,l){const d={};for(const p in u)d[p]=o.call(this,u[p],p,u);return d}function qn(u,o,l){const d={};for(const p in u)o.call(this,u[p],p,u)&&(d[p]=u[p]);return d}function er(u){return Array.isArray(u)?u.map(er):typeof u=="object"&&u?jn(u,er):u}const Ci={};function nr(u){Ci[u]||(typeof console<"u"&&console.warn(u),Ci[u]=!0)}function Zr(u,o,l){return(l.y-u.y)*(o.x-u.x)>(o.y-u.y)*(l.x-u.x)}function _r(u){let o=0;for(let l,d,p=0,y=u.length,_=y-1;p<y;_=p++)l=u[p],d=u[_],o+=(d.x-l.x)*(l.y+d.y);return o}function Xr([u,o,l]){const d=ne(o+90),p=ne(l);return{x:u*Math.cos(d)*Math.sin(p),y:u*Math.sin(d)*Math.sin(p),z:u*Math.cos(p),azimuthal:o,polar:l}}function ni(u){return(typeof self<"u"||u!==void 0)&&typeof WorkerGlobalScope<"u"&&(u!==void 0?u:self)instanceof WorkerGlobalScope}function ji(u){const o={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,d,p,y)=>{const _=p||y;return o[d]=!_||_.toLowerCase(),""}),o["max-age"]){const l=parseInt(o["max-age"],10);isNaN(l)?delete o["max-age"]:o["max-age"]=l}return o}let Ji=null;function xo(u,o){return[u[4*o],u[4*o+1],u[4*o+2],u[4*o+3]]}function zo(u,o,l,d){for(;o<l;){const p=o+l>>1;u[p]<d?o=p+1:l=p}return o}function Jl(u,o,l,d){for(;o<l;){const p=o+l>>1;u[p]<=d?o=p+1:l=p}return o}function Jo(u){return u>0?1/(1.001-u):1+u}function Qo(u){return u>0?1-1/(1.001-u):-u}function Io(u,o,l){return(u-o.min)*(l.max-l.min)/(o.max-o.min)+l.min}const Vo={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Vo.API_URL)return null;try{const u=new URL(Vo.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function wl(u){return Vo.API_URL_REGEX.test(u)}function Ru(u){return Vo.API_SPRITE_REGEX.test(u)}let Qf,Zh,ig,ep,Du,tp;function Wv(){return Qf==null&&(Qf=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Qf}const Xs={now:()=>ep!==void 0?ep:performance.now(),setNow(u){ep=u},restoreNow(){ep=void 0},frame(u){const o=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(u,o=0){const{width:l,height:d}=u;Du||(Du=document.createElement("canvas"));const p=Du.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>Du.width||d>Du.height)&&(Du.width=l,Du.height=d),p.clearRect(-o,-o,l+2*o,d+2*o),p.drawImage(u,0,0,l,d),p.getImageData(-o,-o,l+2*o,d+2*o)},resolveURL:u=>(Zh||(Zh=document.createElement("a")),Zh.href=u,Zh.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(ig==null&&(ig=window.matchMedia("(prefers-reduced-motion: reduce)")),ig.matches)},hasCanvasFingerprintNoise(){if(tp!==void 0)return tp;if(!Wv())return tp=!1,!1;const u=new OffscreenCanvas(85,1),o=u.getContext("2d",{willReadFrequently:!0});let l=0;for(let p=0;p<u.width;++p)o.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,o.fillRect(p,0,1,1);const d=o.getImageData(0,0,u.width,u.height);l=0;for(let p=0;p<d.data.length;++p)if(p%4!=3&&l++!==d.data[p])return tp=!0,!0;return tp=!1,!1}};function Hv(u,o){const l=u.indexOf("?");if(l<0)return`${u}?${new URLSearchParams(o).toString()}`;const d=new URLSearchParams(u.slice(l));for(const p in o)d.set(p,o[p]);return`${u.slice(0,l)}?${d.toString()}`}function Fa(u,o={persistentParams:[]}){const l=u.indexOf("?");if(l<0)return u;const d=new URLSearchParams,p=new URLSearchParams(u.slice(l));for(const _ of o.persistentParams){const S=p.get(_);S&&d.set(_,S)}const y=d.toString();return`${u.slice(0,l)}${y.length>0?`?${y}`:""}`}const Ks="mapbox-tiles";let Ql=500,Ys=50;const ec=["language","worldview","jobid"];let Ss,np;function qv(){try{return caches}catch{}}function tc(){const u=qv();u&&Ss==null&&(Ss=u.open(Ks))}let rp=1/0;const Zv={supported:!1,testSupport:function(u){!og&&ca&&(ag?qw(u):ip=u)}};let ip,ca,og=!1,ag=!1;const Xh=typeof self<"u"?self:{};function qw(u){const o=u.createTexture();u.bindTexture(u.TEXTURE_2D,o);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,ca),u.isContextLost())return;Zv.supported=!0}catch{}u.deleteTexture(o),og=!0}Xh.document&&(ca=Xh.document.createElement("img"),ca.onload=function(){ip&&qw(ip),ip=null,ag=!0},ca.onerror=function(){og=!0,ip=null},ca.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const sg={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(sg);class lg extends Error{constructor(o,l,d){l===401&&wl(d)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=l,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const gr=ni()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Kh=function(u,o){if(!(/^file:/.test(l=u.url)||/^file:/.test(gr())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(d,p){const y=new AbortController,_=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:gr(),referrerPolicy:d.referrerPolicy,signal:y.signal});let S=!1,P=!1;const I=(k=_.url).indexOf("sku=")>0&&wl(k);var k;d.type==="json"&&_.headers.set("Accept","application/json");const D=(W,q,J)=>{if(P)return;if(W&&W.message!=="SecurityError"&&nr(W.toString()),q&&J)return N(q);const ie=Date.now();fetch(_).then(ae=>{if(ae.ok){const me=I?ae.clone():null;return N(ae,me,ie)}return p(new lg(ae.statusText,ae.status,d.url))}).catch(ae=>{ae.name!=="AbortError"&&p(new Error(`${ae.message} ${d.url}`))})},N=(W,q,J)=>{(d.type==="arrayBuffer"?W.arrayBuffer():d.type==="json"?W.json():W.text()).then(ie=>{P||(q&&J&&function(ae,me,de){if(tc(),Ss==null)return;const Q=ji(me.headers.get("Cache-Control")||"");if(Q["no-store"])return;const ue={status:me.status,statusText:me.statusText,headers:new Headers};me.headers.forEach((Ie,De)=>ue.headers.set(De,Ie)),Q["max-age"]&&ue.headers.set("Expires",new Date(de+1e3*Q["max-age"]).toUTCString());const pe=ue.headers.get("Expires");if(!pe||new Date(pe).getTime()-de<42e4)return;let ve=Fa(ae.url,{persistentParams:ec});if(me.status===206){const Ie=ae.headers.get("Range");if(!Ie)return;ue.status=200,ve=Hv(ve,{range:Ie})}(function(Ie,De){if(np===void 0)try{new Response(new ReadableStream),np=!0}catch{np=!1}np?De(Ie.body):Ie.blob().then(De).catch(Fe=>nr(Fe.message))})(me,Ie=>{const De=new Response((Fe=me.status)!==200&&Fe!==404&&[101,103,204,205,304].includes(Fe)?null:Ie,ue);var Fe;tc(),Ss!=null&&Ss.then(He=>He.put(ve,De)).catch(He=>nr(He.message))})}(_,q,J),S=!0,p(null,ie,W.headers.get("Cache-Control"),W.headers.get("Expires")))}).catch(ie=>{P||p(new Error(ie.message))})};return I?function(W,q){if(tc(),Ss==null)return q(null);Ss.then(J=>{let ie=Fa(W.url,{persistentParams:ec});const ae=W.headers.get("Range");ae&&(ie=Hv(ie,{range:ae})),J.match(ie).then(me=>{const de=function(Q){if(!Q)return!1;const ue=new Date(Q.headers.get("Expires")||0),pe=ji(Q.headers.get("Cache-Control")||"");return Number(ue)>Date.now()&&!pe["no-cache"]}(me);J.delete(ie).catch(q),de&&J.put(ie,me.clone()).catch(q),q(null,me,de)}).catch(q)}).catch(q)}(_,D):D(null,null),{cancel:()=>{P=!0,S||y.abort()}}}(u,o);if(ni(self)&&self.worker.actor)return self.worker.actor.send("getResource",u,o,void 0,!0)}var l;return function(d,p){const y=new XMLHttpRequest;y.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(y.responseType="arraybuffer");for(const _ in d.headers)y.setRequestHeader(_,d.headers[_]);return d.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=d.credentials==="include",y.onerror=()=>{p(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let _=y.response;if(d.type==="json")try{_=JSON.parse(y.response)}catch(S){return p(S)}p(null,_,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else p(new lg(y.statusText,y.status,d.url))},y.send(d.body),{cancel:()=>y.abort()}}(u,o)},Yh=function(u,o){return Kh(tt(u,{type:"arrayBuffer"}),o)};function uI(u){const o=document.createElement("a");return o.href=u,o.protocol===location.protocol&&o.host===location.host}const Zw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Lu,Uc;Lu=[],Uc=0;const Jh=function(u,o){if(Zv.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),Uc>=Vo.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:u,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return Lu.push(y),y}Uc++;let l=!1;const d=()=>{if(!l)for(l=!0,Uc--;Lu.length&&Uc<Vo.MAX_PARALLEL_IMAGE_REQUESTS;){const y=Lu.shift(),{requestParameters:_,callback:S,cancelled:P}=y;P||(y.cancel=Jh(_,S).cancel)}},p=Yh(u,(y,_,S,P)=>{d(),y?o(y):_&&(self.createImageBitmap?function(I,k){const D=new Blob([new Uint8Array(I)],{type:"image/png"});createImageBitmap(D).then(N=>{k(null,N)}).catch(N=>{k(new Error(`Could not load image because of ${N.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(I,k)=>o(I,k,S,P)):function(I,k){const D=new Image;D.onload=()=>{k(null,D),URL.revokeObjectURL(D.src),D.onload=null,requestAnimationFrame(()=>{D.src=Zw})},D.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const N=new Blob([new Uint8Array(I)],{type:"image/png"});D.src=I.byteLength?URL.createObjectURL(N):Zw}(_,(I,k)=>o(I,k,S,P)))});return{cancel:()=>{p.cancel(),d()}}};var Xw,Xv,zu,op={exports:{}},Qh={exports:{}},cg={exports:{}},Kv=function(){if(zu)return op.exports;zu=1;var u=(Xw||(Xw=1,Qh.exports=function(l,d){var p,y,_,S,P,I,k,D;for(y=l.length-(p=3&l.length),_=d,P=3432918353,I=461845907,D=0;D<y;)k=255&l.charCodeAt(D)|(255&l.charCodeAt(++D))<<8|(255&l.charCodeAt(++D))<<16|(255&l.charCodeAt(++D))<<24,++D,_=27492+(65535&(S=5*(65535&(_=(_^=k=(65535&(k=(k=(65535&k)*P+(((k>>>16)*P&65535)<<16)&4294967295)<<15|k>>>17))*I+(((k>>>16)*I&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(k=0,p){case 3:k^=(255&l.charCodeAt(D+2))<<16;case 2:k^=(255&l.charCodeAt(D+1))<<8;case 1:_^=k=(65535&(k=(k=(65535&(k^=255&l.charCodeAt(D)))*P+(((k>>>16)*P&65535)<<16)&4294967295)<<15|k>>>17))*I+(((k>>>16)*I&65535)<<16)&4294967295}return _^=l.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),Qh.exports),o=(Xv||(Xv=1,cg.exports=function(l,d){for(var p,y=l.length,_=d^y,S=0;y>=4;)p=1540483477*(65535&(p=255&l.charCodeAt(S)|(255&l.charCodeAt(++S))<<8|(255&l.charCodeAt(++S))<<16|(255&l.charCodeAt(++S))<<24))+((1540483477*(p>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),y-=4,++S;switch(y){case 3:_^=(255&l.charCodeAt(S+2))<<16;case 2:_^=(255&l.charCodeAt(S+1))<<8;case 1:_=1540483477*(65535&(_^=255&l.charCodeAt(S)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),cg.exports);return op.exports=u,op.exports.murmur3=u,op.exports.murmur2=o,op.exports}(),Ba=rs(Kv);class Vc{constructor(o,...l){tt(this,l[0]||{}),this.type=o}}class Yv extends Vc{constructor(o,l={}){super("error",tt({error:o},l))}}function Jv(u,o,l){l[u]&&l[u].indexOf(o)!==-1||(l[u]=l[u]||[],l[u].push(o))}function ug(u,o,l){if(l&&l[u]){const d=l[u].indexOf(o);d!==-1&&l[u].splice(d,1)}}class Nu{on(o,l){return this._listeners=this._listeners||{},Jv(o,l,this._listeners),this}off(o,l){return ug(o,l,this._listeners),ug(o,l,this._oneTimeListeners),this}once(o,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Jv(o,l,this._oneTimeListeners),this):new Promise(d=>{this.once(o,d)})}fire(o,l){const d=typeof o=="string"?new Vc(o,l):o,p=d.type;if(this.listens(p)){d.target=this;const y=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const P of y)P.call(this,d);const _=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const P of _)ug(p,P,this._oneTimeListeners),P.call(this,d);const S=this._eventedParent;S&&(tt(d,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(d))}else d instanceof Yv&&console.error(d.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,l){return this._eventedParent=o,this._eventedParentData=l,this}}class ja{constructor(o){typeof o=="string"?this.name=o:(this.name=o.name,this.iconsetId=o.iconsetId)}static from(o){return new ja(o)}static toString(o){return o.iconsetId?`${o.name}${o.iconsetId}`:o.name}static parse(o){const[l,d]=o.split("");return new ja({name:l,iconsetId:d})}static isEqual(o,l){return o.name===l.name&&o.iconsetId===l.iconsetId}toString(){return ja.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Qv,hg={},ap=function(){if(Qv)return hg;Qv=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(y){return(y=Math.round(y))<0?0:y>255?255:y}function l(y){return o(y[y.length-1]==="%"?parseFloat(y)/100*255:parseInt(y))}function d(y){return(_=y[y.length-1]==="%"?parseFloat(y)/100:parseFloat(y))<0?0:_>1?1:_;var _}function p(y,_,S){return S<0?S+=1:S>1&&(S-=1),6*S<1?y+(_-y)*S*6:2*S<1?_:3*S<2?y+(_-y)*(2/3-S)*6:y}try{hg.parseCSSColor=function(y){var _,S=y.replace(/ /g,"").toLowerCase();if(S in u)return u[S].slice();if(S[0]==="#")return S.length===4?(_=parseInt(S.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:S.length===7&&(_=parseInt(S.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var P=S.indexOf("("),I=S.indexOf(")");if(P!==-1&&I+1===S.length){var k=S.substr(0,P),D=S.substr(P+1,I-(P+1)).split(","),N=1;switch(k){case"rgba":if(D.length!==4)return null;N=d(D.pop());case"rgb":return D.length!==3?null:[l(D[0]),l(D[1]),l(D[2]),N];case"hsla":if(D.length!==4)return null;N=d(D.pop());case"hsl":if(D.length!==3)return null;var W=(parseFloat(D[0])%360+360)%360/360,q=d(D[1]),J=d(D[2]),ie=J<=.5?J*(q+1):J+q-J*q,ae=2*J-ie;return[o(255*p(ae,ie,W+1/3)),o(255*p(ae,ie,W)),o(255*p(ae,ie,W-1/3)),N];default:return null}}return null}}catch{}return hg}();class wr{constructor(o,l,d,p=1){this.r=o,this.g=l,this.b=d,this.a=p}static parse(o){if(!o)return;if(o instanceof wr)return o;if(typeof o!="string")return;const l=ap.parseCSSColor(o);return l?new wr(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toStringPremultipliedAlpha(){const[o,l,d,p]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(o)},${Math.round(l)},${Math.round(d)},${p})`}toString(){const[o,l,d,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*o)},${Math.round(255*l)},${Math.round(255*d)},${p})`}toRenderColor(o){const{r:l,g:d,b:p,a:y}=this;return new Kw(o,l,d,p,y)}clone(){return new wr(this.r,this.g,this.b,this.a)}}class Kw{constructor(o,l,d,p,y){if(o){const _=o.image.height,S=_*_;l=y===0?0:l/y*(_-1),d=y===0?0:d/y*(_-1),p=y===0?0:p/y*(_-1);const P=Math.floor(l),I=Math.floor(d),k=Math.floor(p),D=Math.ceil(l),N=Math.ceil(d),W=Math.ceil(p),q=l-P,J=d-I,ie=p-k,ae=o.image.data,me=4*(P+I*S+k*_),de=4*(P+I*S+W*_),Q=4*(P+N*S+k*_),ue=4*(P+N*S+W*_),pe=4*(D+I*S+k*_),ve=4*(D+I*S+W*_),Ie=4*(D+N*S+k*_),De=4*(D+N*S+W*_);if(me<0||De>=ae.length)throw new Error("out of range");this.r=yn(yn(yn(ae[me],ae[de],ie),yn(ae[Q],ae[ue],ie),J),yn(yn(ae[pe],ae[ve],ie),yn(ae[Ie],ae[De],ie),J),q)/255*y,this.g=yn(yn(yn(ae[me+1],ae[de+1],ie),yn(ae[Q+1],ae[ue+1],ie),J),yn(yn(ae[pe+1],ae[ve+1],ie),yn(ae[Ie+1],ae[De+1],ie),J),q)/255*y,this.b=yn(yn(yn(ae[me+2],ae[de+2],ie),yn(ae[Q+2],ae[ue+2],ie),J),yn(yn(ae[pe+2],ae[ve+2],ie),yn(ae[Ie+2],ae[De+2],ie),J),q)/255*y,this.a=y}else this.r=l,this.g=d,this.b=p,this.a=y}toArray(){const{r:o,g:l,b:d,a:p}=this;return p===0?[0,0,0,0]:[255*o/p,255*l/p,255*d/p,p]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:o,g:l,b:d,a:p}=this,y=Math.min(Math.max(o/p,0),1),_=Math.min(Math.max(l/p,0),1),S=Math.min(Math.max(d/p,0),1),P=Math.min(y,_,S),I=Math.max(y,_,S),k=(P+I)/2;if(P===I)return[0,0,100*k,p];const D=I-P,N=k>.5?D/(2-I-P):D/(I+P);let W=0;return I===y?W=(_-S)/D+(_<S?6:0):I===_?W=(S-y)/D+2:I===S&&(W=(y-_)/D+4),W*=60,[Math.min(Math.max(W,0),360),Math.min(Math.max(100*N,0),100),Math.min(Math.max(100*k,0),100),p]}toArray01(){const{r:o,g:l,b:d,a:p}=this;return p===0?[0,0,0,0]:[o/p,l/p,d/p,p]}toArray01Scaled(o){const{r:l,g:d,b:p,a:y}=this;return y===0?[0,0,0]:[l/y*o,d/y*o,p/y*o]}toArray01PremultipliedAlpha(){const{r:o,g:l,b:d,a:p}=this;return[o,l,d,p]}toArray01Linear(){const{r:o,g:l,b:d,a:p}=this;return p===0?[0,0,0,0]:[Math.pow(o/p,2.2),Math.pow(l/p,2.2),Math.pow(d/p,2.2),p]}}function yn(u,o,l){return u*(1-l)+o*l}function Yw(u,o,l){return u.map((d,p)=>yn(d,o[p],l))}function dg(u){return u*u*u*u*u}wr.black=new wr(0,0,0,1),wr.white=new wr(1,1,1,1),wr.transparent=new wr(0,0,0,0),wr.red=new wr(1,0,0,1),wr.blue=new wr(0,0,1,1);var fg=Object.freeze({__proto__:null,array:Yw,color:function(u,o,l){return new wr(yn(u.r,o.r,l),yn(u.g,o.g,l),yn(u.b,o.b,l),yn(u.a,o.a,l))},easeIn:dg,number:yn});function sp(u,...o){for(const l of o)for(const d in l)u[d]=l[d];return u}class Ts extends Error{constructor(o,l){super(l),this.message=l,this.key=o}}class Fu{constructor(o,l=[]){this.parent=o,this.bindings={};for(const[d,p]of l)this.bindings[d]=p}concat(o){return new Fu(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Gc={kind:"null"},cn={kind:"number"},$r={kind:"string"},Or={kind:"boolean"},Ea={kind:"color"},Wc={kind:"object"},Ir={kind:"value"},Bu={kind:"collator"},lp={kind:"formatted"},cp={kind:"resolvedImage"};function ua(u,o){return{kind:"array",itemType:u,N:o}}function Qi(u){if(u.kind==="array"){const o=Qi(u.itemType);return typeof u.N=="number"?`array<${o}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${o}>`}return u.kind}const hI=[Gc,cn,$r,Or,Ea,lp,Wc,ua(Ir),cp];function up(u,o){if(o.kind==="error")return null;if(u.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!up(u.itemType,o.itemType))&&(typeof u.N!="number"||u.N===o.N))return null}else{if(u.kind===o.kind)return null;if(u.kind==="value"){for(const l of hI)if(!up(l,o))return null}}return`Expected ${Qi(u)} but found ${Qi(o)} instead.`}function e0(u,o){return o.some(l=>l.kind===u.kind)}function ed(u,o){return o.some(l=>l==="null"?u===null:l==="array"?Array.isArray(u):l==="object"?u&&!Array.isArray(u)&&typeof u=="object":l===typeof u)}class Hc{constructor(o,l,d){this.sensitivity=o?l?"variant":"case":l?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,l){return this.collator.compare(o,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class pg{constructor(o,l,d,p,y){this.text=o.normalize?o.normalize():o,this.image=l,this.scale=d,this.fontStack=p,this.textColor=y}}class ha{constructor(o){this.sections=o}static fromString(o){return new ha([new pg(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||!!o.image&&o.image.hasPrimary())}static factory(o){return o instanceof ha?o:ha.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const l of this.sections){if(l.image){const p=l.image.getPrimary().id.toString();o.push(["image",p]);continue}o.push(l.text);const d={};l.fontStack&&(d["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(d["font-scale"]=l.scale),l.textColor&&(d["text-color"]=["rgba"].concat(l.textColor.toRenderColor(null).toArray())),o.push(d)}return o}}class Js{constructor(o,l={}){if(this.id=ja.from(o),this.options=Object.assign({},l),l.transform){const{a:d,b:p,c:y,d:_,e:S,f:P}=l.transform;this.options.transform=new DOMMatrix([d,p,y,_,S,P])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:o,b:l,c:d,d:p,e:y,f:_}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:o,b:l,c:d,d:p,e:y,f:_}})}static parse(o){let l,d,p,y;try{({name:l,iconsetId:d,params:p,transform:y}=JSON.parse(o)||{})}catch{return null}if(!l)return null;const{a:_,b:S,c:P,d:I,e:k,f:D}=y||{};return new Js({name:l,iconsetId:d},{params:p,transform:new DOMMatrix([_,S,P,I,k,D])})}scaleSelf(o,l){return this.options.transform.scaleSelf(o,l),this}}class Aa{constructor(o,l,d,p,y=!1){this.primaryId=ja.from(o),this.primaryOptions=l,d&&(this.secondaryId=ja.from(d)),this.secondaryOptions=p,this.available=y}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Js(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Js(this.secondaryId,this.secondaryOptions):null}static from(o){return typeof o=="string"?Aa.build({name:o}):o}static build(o,l,d,p){return!o||typeof o=="object"&&!("name"in o)?null:new Aa(o,d,l,p)}}function Jw(u,o,l,d){return typeof u=="number"&&u>=0&&u<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof l=="number"&&l>=0&&l<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[u,o,l,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[u,o,l,d]:[u,o,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function td(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof wr||u instanceof Hc||u instanceof ha||u instanceof Aa)return!0;if(Array.isArray(u)){for(const o of u)if(!td(o))return!1;return!0}if(typeof u=="object"){for(const o in u)if(!td(u[o]))return!1;return!0}return!1}function mo(u){if(u===null)return Gc;if(typeof u=="string")return $r;if(typeof u=="boolean")return Or;if(typeof u=="number")return cn;if(u instanceof wr)return Ea;if(u instanceof Hc)return Bu;if(u instanceof ha)return lp;if(u instanceof Aa)return cp;if(Array.isArray(u)){const o=u.length;let l;for(const d of u){const p=mo(d);if(l){if(l===p)continue;l=Ir;break}l=p}return ua(l||Ir,o)}return Wc}function da(u){const o=typeof u;return u===null?"":o==="string"||o==="number"||o==="boolean"?String(u):u instanceof wr?u.toStringPremultipliedAlpha():u instanceof ha||u instanceof Aa?u.toString():JSON.stringify(u)}class Zn{constructor(o,l){this.type=o,this.value=l}static parse(o,l){if(o.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!td(o[1]))return l.error("invalid value");const d=o[1];let p=mo(d);const y=l.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new Zn(p,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof wr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof ha?this.value.serialize():this.value}}class Jt{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const hp={string:$r,number:cn,boolean:Or,object:Wc};class In{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let d,p=1;const y=o[0];if(y==="array"){let S,P;if(o.length>2){const I=o[1];if(typeof I!="string"||!(I in hp)||I==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);S=hp[I],p++}else S=Ir;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return l.error('The length argument to "array" must be a positive integer literal',2);P=o[2],p++}d=ua(S,P)}else d=hp[y];const _=[];for(;p<o.length;p++){const S=l.parse(o[p],p,Ir);if(!S)return null;_.push(S)}return new In(d,_)}evaluate(o){for(let l=0;l<this.args.length;l++){const d=this.args[l].evaluate(o);if(!up(this.type,mo(d)))return d;if(l===this.args.length-1)throw new Jt(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${Qi(mo(d))} but was expected to be of type ${Qi(this.type)}.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,l=[o.kind];if(o.kind==="array"){const d=o.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){l.push(d.kind);const p=o.N;(typeof p=="number"||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(d=>d.serialize()))}}class ju{constructor(o){this.type=lp,this.sections=o}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const d=o[1];if(!Array.isArray(d)&&typeof d=="object")return l.error("First argument must be an image or text section.");const p=[];let y=!1;for(let _=1;_<=o.length-1;++_){const S=o[_];if(y&&typeof S=="object"&&!Array.isArray(S)){y=!1;let P=null;if(S["font-scale"]&&(P=l.parseObjectValue(S["font-scale"],_,"font-scale",cn),!P))return null;let I=null;if(S["text-font"]&&(I=l.parseObjectValue(S["text-font"],_,"text-font",ua($r)),!I))return null;let k=null;if(S["text-color"]&&(k=l.parseObjectValue(S["text-color"],_,"text-color",Ea),!k))return null;const D=p[p.length-1];D.scale=P,D.font=I,D.textColor=k}else{const P=l.parse(o[_],_,Ir);if(!P)return null;const I=P.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:P,scale:null,font:null,textColor:null})}}return new ju(p)}evaluate(o){return new ha(this.sections.map(l=>{const d=l.content.evaluate(o);return mo(d)===cp?new pg("",d,null,null,null):new pg(da(d),null,l.scale?l.scale.evaluate(o):null,l.font?l.font.evaluate(o).join(","):null,l.textColor?l.textColor.evaluate(o):null)}))}eachChild(o){for(const l of this.sections)o(l.content),l.scale&&o(l.scale),l.font&&o(l.font),l.textColor&&o(l.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const l of this.sections){o.push(l.content.serialize());const d={};l.scale&&(d["font-scale"]=l.scale.serialize()),l.font&&(d["text-font"]=l.font.serialize()),l.textColor&&(d["text-color"]=l.textColor.serialize()),o.push(d)}return o}}class nd{constructor(o,l,d,p){this._imageWarnHistory={},this.type=cp,this.namePrimary=o,this.nameSecondary=l,d&&(this.paramsPrimary=d.params,this.iconsetIdPrimary=d.iconset?d.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(o,l){if(o.length<2)return l.error("Expected two or more arguments.");let d=1;const p=[];function y(){if(d<o.length){const S=l.parse(o[d],d++,$r);return S?(p.push({image:S,options:{}}),!0):(l.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(d<o.length){const P=o[d];if((S=P)===null||typeof S!="object"||Array.isArray(S))return!0;const I=P.params,k=P.iconset,D=l.concat(d);if(!I&&!k)return d++,!0;if(I){if(typeof I!="object"||I.constructor!==Object)return D.error('Image options "params" should be an object'),!1;const N={},W=D.concat(void 0,"params");for(const q in I){if(!q)return W.error("Image parameter name should be non-empty"),!1;const J=W.concat(void 0,q).parse(I[q],void 0,Ea,void 0,{typeAnnotation:"coerce"});if(!J)return!1;N[q]=J}p[p.length-1].options.params=N}if(k){if(typeof k!="object"||k.constructor!==Object)return D.error('Image options "iconset" should be an object'),!1;if(!k.id)return D.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=k}return d++,!0}var S;return!0}for(let S=0;S<2;S++)if(!y()||!_())return;return new nd(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(o,l){const d={};if(l){for(const p in l)if(l[p])try{d[p]=l[p].evaluate(o)}catch{continue}if(Object.keys(d).length!==0)return{params:d}}}evaluate(o){const l={name:this.namePrimary.evaluate(o),iconsetId:this.iconsetIdPrimary},d=this.nameSecondary?{name:this.nameSecondary.evaluate(o),iconsetId:this.iconsetIdSecondary}:void 0,p=Aa.build(l,d,this.paramsPrimary?this.evaluateParams(o,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(o,this.paramsSecondary):void 0);if(p&&o.availableImages){const y=p.getPrimary().id;if(p.available=o.availableImages.some(_=>ja.isEqual(_,y)),p.available){const _=p.getSecondary()?p.getSecondary().id:null;_&&(p.available=o.availableImages.some(S=>ja.isEqual(S,_)))}}return p}eachChild(o){if(o(this.namePrimary),this.paramsPrimary)for(const l in this.paramsPrimary)this.paramsPrimary[l]&&o(this.paramsPrimary[l]);if(this.nameSecondary&&(o(this.nameSecondary),this.paramsSecondary))for(const l in this.paramsSecondary)this.paramsSecondary[l]&&o(this.paramsSecondary[l])}outputDefined(){return!1}serializeOptions(o,l){const d={};if(l&&(d.iconset={id:l}),o){d.params={};for(const p in o)o[p]&&(d.params[p]=o[p].serialize())}return Object.keys(d).length>0?d:void 0}serialize(){const o=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const l=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);l&&o.push(l)}if(this.nameSecondary&&(o.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const l=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);l&&o.push(l)}return o}}function Mn(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}const Qw={"to-boolean":Or,"to-color":Ea,"to-number":cn,"to-string":$r};class Qs{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const d=o[0],p=[];let y=Gc;if(d==="to-array"){if(!Array.isArray(o[1]))return null;const _=o[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);y=ua(l.expectedType.itemType,_)}else{if(!(_>0&&td(o[1][0])))return null;y=ua(mo(o[1][0]),_)}for(let S=0;S<_;S++){const P=o[1][S];let I;if(Mn(P)==="array")I=l.parse(P,void 0,y.itemType);else{const k=Mn(P);if(k!==y.itemType.kind)return l.error(`Expected ${y.itemType.kind} but found ${k}.`);I=l.registry.literal.parse(["literal",P===void 0?null:P],l)}if(!I)return null;p.push(I)}}else{if((d==="to-boolean"||d==="to-string")&&o.length!==2)return l.error("Expected one argument.");y=Qw[d];for(let _=1;_<o.length;_++){const S=l.parse(o[_],_,Ir);if(!S)return null;p.push(S)}}return new Qs(y,p)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let l,d;for(const p of this.args){if(l=p.evaluate(o),d=null,l instanceof wr)return l;if(typeof l=="string"){const y=o.parseColor(l);if(y)return y}else if(Array.isArray(l)&&(d=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Jw(l[0],l[1],l[2],l[3]),!d))return new wr(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Jt(d||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const d of this.args){if(l=d.evaluate(o),l===null)return 0;const p=Number(l);if(!isNaN(p))return p}throw new Jt(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?ha.fromString(da(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?Aa.build(da(this.args[0].evaluate(o))):this.type.kind==="array"?this.args.map(l=>l.evaluate(o)):da(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ju([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new nd(this.args[0]).serialize();const o=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{o.push(l.serialize())}),o}}const eS=["Unknown","Point","LineString","Polygon"];class mg{constructor(o,l){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=l}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?eS[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:d,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(d*l-o[0])+this.featureDistanceData.bearing[1]*(p*l-o[1])}return 0}parseColor(o){let l=this._parseColorCache[o];return l||(l=this._parseColorCache[o]=wr.parse(o)),l}getConfig(o){return this.options?this.options.get(o):null}}class ea{constructor(o,l,d,p,y){this.name=o,this.type=l,this._evaluate=d,this.args=p,this._overloadIndex=y}evaluate(o){if(!this._evaluate){const l=ea.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,l){const d=o[0],p=ea.definitions[d];if(!p)return l.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,S=[];let P=null,I=-1;for(const[k,D]of _){if(Array.isArray(k)&&k.length!==o.length-1)continue;S.push(k),I++,P=new uS(l.registry,l.path,null,l.scope,void 0,l._scope,l.options);const N=[];let W=!1;for(let q=1;q<o.length;q++){const J=o[q],ie=Array.isArray(k)?k[q-1]:k.type,ae=P.parse(J,1+N.length,ie);if(!ae){W=!0;break}N.push(ae)}if(!W)if(Array.isArray(k)&&k.length!==N.length)P.error(`Expected ${k.length} arguments, but found ${N.length} instead.`);else{for(let q=0;q<N.length;q++){const J=Array.isArray(k)?k[q]:k.type,ie=N[q];P.concat(q+1).checkSubtype(J,ie.type)}if(P.errors.length===0)return new ea(d,y,D,N,I)}}if(S.length===1)l.errors.push(...P.errors);else{const k=(S.length?S:_.map(([N])=>N)).map(fa).join(" | "),D=[];for(let N=1;N<o.length;N++){const W=l.parse(o[N],1+D.length);if(!W)return null;D.push(Qi(W.type))}l.error(`Expected arguments of type ${k}, but found (${D.join(", ")}) instead.`)}return null}static register(o,l){ea.definitions=l;for(const d in l)o[d]=ea}}function fa(u){return Array.isArray(u)?`(${u.map(Qi).join(", ")})`:`(${Qi(u.type)}...)`}class rd{constructor(o,l,d){this.type=Bu,this.locale=d,this.caseSensitive=o,this.diacriticSensitive=l}static parse(o,l){if(o.length!==2)return l.error("Expected one argument.");const d=o[1];if(typeof d!="object"||Array.isArray(d))return l.error("Collator options argument must be an object.");const p=d["case-sensitive"]===void 0?l.parse(!1,1,Or):l.parseObjectValue(d["case-sensitive"],1,"case-sensitive",Or);if(!p)return null;const y=d["diacritic-sensitive"]===void 0?l.parse(!1,1,Or):l.parseObjectValue(d["diacritic-sensitive"],1,"diacritic-sensitive",Or);if(!y)return null;let _=null;return d.locale&&(_=l.parseObjectValue(d.locale,1,"locale",$r),!_)?null:new rd(p,y,_)}evaluate(o){return new Hc(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}function qc(u,o,l=0,d=u.length-1,p=Uu){for(;d>l;){if(d-l>600){const P=d-l+1,I=o-l+1,k=Math.log(P),D=.5*Math.exp(2*k/3),N=.5*Math.sqrt(k*D*(P-D)/P)*(I-P/2<0?-1:1);qc(u,o,Math.max(l,Math.floor(o-I*D/P+N)),Math.min(d,Math.floor(o+(P-I)*D/P+N)),p)}const y=u[o];let _=l,S=d;for($u(u,l,o),p(u[d],y)>0&&$u(u,l,d);_<S;){for($u(u,_,S),_++,S--;p(u[_],y)<0;)_++;for(;p(u[S],y)>0;)S--}p(u[l],y)===0?$u(u,l,S):(S++,$u(u,S,d)),S<=o&&(l=S+1),o<=S&&(d=S-1)}}function $u(u,o,l){const d=u[o];u[o]=u[l],u[l]=d}function Uu(u,o){return u<o?-1:u>o?1:0}function pa(u){let o=0;for(let l,d,p=0,y=u.length,_=y-1;p<y;_=p++)l=u[p],d=u[_],o+=(d.x-l.x)*(l.y+d.y);return o}function dp(u,o){u[0]=Math.min(u[0],o[0]),u[1]=Math.min(u[1],o[1]),u[2]=Math.max(u[2],o[0]),u[3]=Math.max(u[3],o[1])}function fp(u,o){return!(u[0]<=o[0]||u[2]>=o[2]||u[1]<=o[1]||u[3]>=o[3])}function dI(u,o,l){const d=u[0]-o[0],p=u[1]-o[1],y=u[0]-l[0],_=u[1]-l[1];return d*_-y*p==0&&d*y<=0&&p*_<=0}function nc(u,o,l=!1){let d=!1;for(let S=0,P=o.length;S<P;S++){const I=o[S];for(let k=0,D=I.length,N=D-1;k<D;N=k++){const W=I[N],q=I[k];if(dI(u,W,q))return l;(y=W)[1]>(p=u)[1]!=(_=q)[1]>p[1]&&p[0]<(_[0]-y[0])*(p[1]-y[1])/(_[1]-y[1])+y[0]&&(d=!d)}}var p,y,_;return d}function t0(u,o,l,d){const p=d[0]-l[0],y=d[1]-l[1],_=(u[0]-l[0])*y-p*(u[1]-l[1]),S=(o[0]-l[0])*y-p*(o[1]-l[1]);return _>0&&S<0||_<0&&S>0}function Sl(u,o,l,d){return(p=[d[0]-l[0],d[1]-l[1]])[0]*(y=[o[0]-u[0],o[1]-u[1]])[1]-p[1]*y[0]!=0&&!(!t0(u,o,l,d)||!t0(l,d,u,o));var p,y}function n0(u){const o=new yt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=new yt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const d of u[0])o.x>d.x&&(o.x=d.x),o.y>d.y&&(o.y=d.y),l.x<d.x&&(l.x=d.x),l.y<d.y&&(l.y=d.y);return{min:o,max:l}}const Zc=8192;function fI(u,o){const l=(180+u[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,p=Math.pow(2,o.z);return[Math.round(l*p*Zc),Math.round(d*p*Zc)]}function pI(u,o){for(let l=0;l<o.length;l++)if(nc(u,o[l]))return!0;return!1}function tS(u,o,l){for(const d of l)for(let p=0,y=d.length,_=y-1;p<y;_=p++)if(Sl(u,o,d[_],d[p]))return!0;return!1}function nS(u,o){for(let l=0;l<u.length;++l)if(!nc(u[l],o))return!1;for(let l=0;l<u.length-1;++l)if(tS(u[l],u[l+1],o))return!1;return!0}function mI(u,o){for(let l=0;l<o.length;l++)if(nS(u,o[l]))return!0;return!1}function gg(u,o,l){const d=[];for(let p=0;p<u.length;p++){const y=[];for(let _=0;_<u[p].length;_++){const S=fI(u[p][_],l);dp(o,S),y.push(S)}d.push(y)}return d}function rS(u,o,l){const d=[];for(let p=0;p<u.length;p++){const y=gg(u[p],o,l);d.push(y)}return d}function Xc(u,o,l,d){if(u[0]<l[0]||u[0]>l[2]){const p=.5*d;let y=u[0]-l[0]>p?-d:l[0]-u[0]>p?d:0;y===0&&(y=u[0]-l[2]>p?-d:l[2]-u[0]>p?d:0),u[0]+=y}dp(o,u)}function iS(u,o,l,d){const p=Math.pow(2,d.z)*Zc,y=[d.x*Zc,d.y*Zc],_=[];if(!u)return _;for(const S of u)for(const P of S){const I=[P.x+y[0],P.y+y[1]];Xc(I,o,l,p),_.push(I)}return _}function oS(u,o,l,d){const p=Math.pow(2,d.z)*Zc,y=[d.x*Zc,d.y*Zc],_=[];if(!u)return _;for(const P of u){const I=[];for(const k of P){const D=[k.x+y[0],k.y+y[1]];dp(o,D),I.push(D)}_.push(I)}if(o[2]-o[0]<=p/2){(S=o)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const P of _)for(const I of P)Xc(I,o,l,p)}var S;return _}class rc{constructor(o,l){this.type=Or,this.geojson=o,this.geometries=l}static parse(o,l){if(o.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(td(o[1])){const d=o[1];if(d.type==="FeatureCollection")for(let p=0;p<d.features.length;++p){const y=d.features[p].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new rc(d,d.features[p].geometry)}else if(d.type==="Feature"){const p=d.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new rc(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new rc(d,d)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(l,d){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=l.canonicalID();if(!_)return!1;if(d.type==="Polygon"){const S=gg(d.coordinates,y,_),P=iS(l.geometry(),p,y,_);if(!fp(p,y))return!1;for(const I of P)if(!nc(I,S))return!1}if(d.type==="MultiPolygon"){const S=rS(d.coordinates,y,_),P=iS(l.geometry(),p,y,_);if(!fp(p,y))return!1;for(const I of P)if(!pI(I,S))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(l,d){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=l.canonicalID();if(!_)return!1;if(d.type==="Polygon"){const S=gg(d.coordinates,y,_),P=oS(l.geometry(),p,y,_);if(!fp(p,y))return!1;for(const I of P)if(!nS(I,S))return!1}if(d.type==="MultiPolygon"){const S=rS(d.coordinates,y,_),P=oS(l.geometry(),p,y,_);if(!fp(p,y))return!1;for(const I of P)if(!mI(I,S))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const pp={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},r0=1/298.257223563,Es=r0*(2-r0),id=Math.PI/180;class od{static fromTile(o,l,d){const p=Math.PI*(1-2*(o+.5)/Math.pow(2,l)),y=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/id;return new od(y,d)}static get units(){return pp}constructor(o,l){if(o===void 0)throw new Error("No latitude given.");if(l&&!pp[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(pp).join(", ")}`);const d=6378.137*id*(l?pp[l]:1),p=Math.cos(o*id),y=1/(1-Es*(1-p*p)),_=Math.sqrt(y);this.kx=d*_*p,this.ky=d*_*y*(1-Es)}distance(o,l){const d=os(o[0]-l[0])*this.kx,p=(o[1]-l[1])*this.ky;return Math.sqrt(d*d+p*p)}bearing(o,l){const d=os(l[0]-o[0])*this.kx;return Math.atan2(d,(l[1]-o[1])*this.ky)/id}destination(o,l,d){const p=d*id;return this.offset(o,Math.sin(p)*l,Math.cos(p)*l)}offset(o,l,d){return[o[0]+l/this.kx,o[1]+d/this.ky]}lineDistance(o){let l=0;for(let d=0;d<o.length-1;d++)l+=this.distance(o[d],o[d+1]);return l}area(o){let l=0;for(let d=0;d<o.length;d++){const p=o[d];for(let y=0,_=p.length,S=_-1;y<_;S=y++)l+=os(p[y][0]-p[S][0])*(p[y][1]+p[S][1])*(d?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(o,l){let d=0;if(l<=0)return o[0];for(let p=0;p<o.length-1;p++){const y=o[p],_=o[p+1],S=this.distance(y,_);if(d+=S,d>l)return yg(y,_,(l-(d-S))/S)}return o[o.length-1]}pointToSegmentDistance(o,l,d){let[p,y]=l,_=os(d[0]-p)*this.kx,S=(d[1]-y)*this.ky;if(_!==0||S!==0){const P=(os(o[0]-p)*this.kx*_+(o[1]-y)*this.ky*S)/(_*_+S*S);P>1?(p=d[0],y=d[1]):P>0&&(p+=_/this.kx*P,y+=S/this.ky*P)}return _=os(o[0]-p)*this.kx,S=(o[1]-y)*this.ky,Math.sqrt(_*_+S*S)}pointOnLine(o,l){let d=1/0,p=o[0][0],y=o[0][1],_=0,S=0;for(let P=0;P<o.length-1;P++){let I=o[P][0],k=o[P][1],D=os(o[P+1][0]-I)*this.kx,N=(o[P+1][1]-k)*this.ky,W=0;D===0&&N===0||(W=(os(l[0]-I)*this.kx*D+(l[1]-k)*this.ky*N)/(D*D+N*N),W>1?(I=o[P+1][0],k=o[P+1][1]):W>0&&(I+=D/this.kx*W,k+=N/this.ky*W)),D=os(l[0]-I)*this.kx,N=(l[1]-k)*this.ky;const q=D*D+N*N;q<d&&(d=q,p=I,y=k,_=P,S=W)}return{point:[p,y],index:_,t:Math.max(0,Math.min(1,S))}}lineSlice(o,l,d){let p=this.pointOnLine(d,o),y=this.pointOnLine(d,l);if(p.index>y.index||p.index===y.index&&p.t>y.t){const I=p;p=y,y=I}const _=[p.point],S=p.index+1,P=y.index;!i0(d[S],_[0])&&S<=P&&_.push(d[S]);for(let I=S+1;I<=P;I++)_.push(d[I]);return i0(d[P],y.point)||_.push(y.point),_}lineSliceAlong(o,l,d){let p=0;const y=[];for(let _=0;_<d.length-1;_++){const S=d[_],P=d[_+1],I=this.distance(S,P);if(p+=I,p>o&&y.length===0&&y.push(yg(S,P,(o-(p-I))/I)),p>=l)return y.push(yg(S,P,(l-(p-I))/I)),y;p>o&&y.push(P)}return y}bufferPoint(o,l){const d=l/this.ky,p=l/this.kx;return[o[0]-p,o[1]-d,o[0]+p,o[1]+d]}bufferBBox(o,l){const d=l/this.ky,p=l/this.kx;return[o[0]-p,o[1]-d,o[2]+p,o[3]+d]}insideBBox(o,l){return os(o[0]-l[0])>=0&&os(o[0]-l[2])<=0&&o[1]>=l[1]&&o[1]<=l[3]}}function i0(u,o){return u[0]===o[0]&&u[1]===o[1]}function yg(u,o,l){const d=os(o[0]-u[0]);return[u[0]+d*l,u[1]+(o[1]-u[1])*l]}function os(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class _g{constructor(o=[],l=(d,p)=>d<p?-1:d>p?1:0){if(this.data=o,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:l,compare:d}=this,p=l[o];for(;o>0;){const y=o-1>>1,_=l[y];if(d(p,_)>=0)break;l[o]=_,o=y}l[o]=p}_down(o){const{data:l,compare:d}=this,p=this.length>>1,y=l[o];for(;o<p;){let _=1+(o<<1);const S=_+1;if(S<this.length&&d(l[S],l[_])<0&&(_=S),d(l[_],y)>=0)break;l[o]=l[_],o=_}l[o]=y}}var jt=8192;function o0(u,o){return o.dist-u.dist}const vg=100,xg=50;function a0(u){const o=[1/0,1/0,-1/0,-1/0];if(o.length!==u.length)return!1;for(let l=0;l<o.length;l++)if(o[l]!==u[l])return!1;return!0}function Vu(u){return u[1]-u[0]+1}function As(u,o){const l=u[1]>=u[0]&&u[1]<o;return l||console.warn("Distance Expression: Index is out of range"),l}function ad(u,o){if(u[0]>u[1])return[null,null];const l=Vu(u);if(o){if(l===2)return[u,null];const d=Math.floor(l/2);return[[u[0],u[0]+d],[u[0]+d,u[1]]]}{if(l===1)return[u,null];const d=Math.floor(l/2)-1;return[[u[0],u[0]+d],[u[0]+d+1,u[1]]]}}function Kc(u,o){const l=[1/0,1/0,-1/0,-1/0];if(!As(o,u.length))return l;for(let d=o[0];d<=o[1];++d)dp(l,u[d]);return l}function mp(u){const o=[1/0,1/0,-1/0,-1/0];for(let l=0;l<u.length;++l)for(let d=0;d<u[l].length;++d)dp(o,u[l][d]);return o}function Gu(u,o,l){if(a0(u)||a0(o))return NaN;let d=0,p=0;return u[2]<o[0]&&(d=o[0]-u[2]),u[0]>o[2]&&(d=u[0]-o[2]),u[1]>o[3]&&(p=u[1]-o[3]),u[3]<o[1]&&(p=o[1]-u[3]),l.distance([0,0],[d,p])}function sd(u){return 360*u-180}function dr(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function s0(u,o){const l=Math.pow(2,o.z),d=(u.y/jt+o.y)/l;return[sd((u.x/jt+o.x)/l),dr(d)]}function gI(u,o){const l=[];for(let d=0;d<u.length;++d)l.push(s0(u[d],o));return l}function aS(u,o,l){const d=l.pointOnLine(o,u).point;return l.distance(u,d)}function l0(u,o,l,d,p){const y=l.slice(d[0],d[1]+1);let _=1/0;for(let S=o[0];S<=o[1];++S)if((_=Math.min(_,aS(u[S],y,p)))===0)return 0;return _}function c0(u,o,l,d,p){const y=Math.min(p.pointToSegmentDistance(u,l,d),p.pointToSegmentDistance(o,l,d)),_=Math.min(p.pointToSegmentDistance(l,u,o),p.pointToSegmentDistance(d,u,o));return Math.min(y,_)}function Ii(u,o,l,d,p){if(!As(o,u.length)||!As(d,l.length))return NaN;let y=1/0;for(let _=o[0];_<o[1];++_)for(let S=d[0];S<d[1];++S){if(Sl(u[_],u[_+1],l[S],l[S+1]))return 0;y=Math.min(y,c0(u[_],u[_+1],l[S],l[S+1],p))}return y}function yI(u,o,l,d,p){if(!As(o,u.length)||!As(d,l.length))return NaN;let y=1/0;for(let _=o[0];_<=o[1];++_)for(let S=d[0];S<=d[1];++S)if((y=Math.min(y,p.distance(u[_],l[S])))===0)return y;return y}function _I(u,o,l){if(nc(u,o,!0))return 0;let d=1/0;for(const p of o){const y=p.length;if(y<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[y-1]&&(d=Math.min(d,l.pointToSegmentDistance(u,p[y-1],p[0])))===0||(d=Math.min(d,aS(u,p,l)))===0)return d}return d}function vI(u,o,l,d){if(!As(o,u.length))return NaN;for(let y=o[0];y<=o[1];++y)if(nc(u[y],l,!0))return 0;let p=1/0;for(let y=o[0];y<o[1];++y)for(const _ of l)for(let S=0,P=_.length,I=P-1;S<P;I=S++){if(Sl(u[y],u[y+1],_[I],_[S]))return 0;p=Math.min(p,c0(u[y],u[y+1],_[I],_[S],d))}return p}function sS(u,o){for(const l of u)for(let d=0;d<=l.length-1;++d)if(nc(l[d],o,!0))return!0;return!1}function xI(u,o,l,d=1/0){const p=mp(u),y=mp(o);if(d!==1/0&&Gu(p,y,l)>=d)return d;if(fp(p,y)){if(sS(u,o))return 0}else if(sS(o,u))return 0;let _=d;for(const S of u)for(let P=0,I=S.length,k=I-1;P<I;k=P++)for(const D of o)for(let N=0,W=D.length,q=W-1;N<W;q=N++){if(Sl(S[k],S[P],D[q],D[N]))return 0;_=Math.min(_,c0(S[k],S[P],D[q],D[N],l))}return _}function bg(u,o,l,d,p,y,_){if(y===null||_===null)return;const S=Gu(Kc(d,y),Kc(p,_),l);S<o&&u.push({dist:S,range1:y,range2:_})}function bI(u,o,l,d,p=1/0){let y=Math.min(d.distance(u[0],l[0][0]),p);if(y===0)return y;const _=new _g([{dist:0,range1:[0,u.length-1],range2:[0,0]}],o0),S=o?xg:vg,P=mp(l);for(;_.length;){const I=_.pop();if(I.dist>=y)continue;const k=I.range1;if(Vu(k)<=S){if(!As(k,u.length))return NaN;if(o){const D=vI(u,k,l,d);if((y=Math.min(y,D))===0)return y}else for(let D=k[0];D<=k[1];++D){const N=_I(u[D],l,d);if((y=Math.min(y,N))===0)return y}}else{const D=ad(k,o);if(D[0]!==null){const N=Gu(Kc(u,D[0]),P,d);N<y&&_.push({dist:N,range1:D[0],range2:[0,0]})}if(D[1]!==null){const N=Gu(Kc(u,D[1]),P,d);N<y&&_.push({dist:N,range1:D[1],range2:[0,0]})}}}return y}function lS(u,o,l,d,p,y=1/0){let _=Math.min(y,p.distance(u[0],l[0]));if(_===0)return _;const S=new _g([{dist:0,range1:[0,u.length-1],range2:[0,l.length-1]}],o0),P=o?xg:vg,I=d?xg:vg;for(;S.length;){const k=S.pop();if(k.dist>=_)continue;const D=k.range1,N=k.range2;if(Vu(D)<=P&&Vu(N)<=I){if(!As(D,u.length)||!As(N,l.length))return NaN;if(o&&d?_=Math.min(_,Ii(u,D,l,N,p)):o||d?o&&!d?_=Math.min(_,l0(l,N,u,D,p)):!o&&d&&(_=Math.min(_,l0(u,D,l,N,p))):_=Math.min(_,yI(u,D,l,N,p)),_===0)return _}else{const W=ad(D,o),q=ad(N,d);bg(S,_,p,u,l,W[0],q[0]),bg(S,_,p,u,l,W[0],q[1]),bg(S,_,p,u,l,W[1],q[0]),bg(S,_,p,u,l,W[1],q[1])}}return _}function u0(u,o,l,d,p=1/0){let y=p;const _=Kc(u,[0,u.length-1]);for(const S of l)if(!(y!==1/0&&Gu(_,Kc(S,[0,S.length-1]),d)>=y)&&(y=Math.min(y,lS(u,o,S,!0,d,y)),y===0))return y;return y}function wg(u,o,l,d,p=1/0){let y=p;const _=Kc(u,[0,u.length-1]);for(const S of l){if(y!==1/0&&Gu(_,mp(S),d)>=y)continue;const P=bI(u,o,S,d,y);if(isNaN(P))return P;if((y=Math.min(y,P))===0)return y}return y}function h0(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class Wu{constructor(o,l){this.type=cn,this.geojson=o,this.geometries=l}static parse(o,l){if(o.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${o.length-1} instead.`);if(td(o[1])){const d=o[1];if(d.type==="FeatureCollection"){for(let p=0;p<d.features.length;++p)if(h0(d.features[p].geometry.type))return new Wu(d,d.features[p].geometry)}else if(d.type==="Feature"){if(h0(d.geometry.type))return new Wu(d,d.geometry)}else if(h0(d.type))return new Wu(d,d)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(o){const l=o.geometry(),d=o.canonicalID();if(l!=null&&d!=null){if(o.geometryType()==="Point")return function(p,y,_){const S=[];for(const I of p)for(const k of I)S.push(s0(k,y));const P=new od(S[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?lS(S,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",P):_.type==="MultiLineString"?u0(S,!1,_.coordinates,P):_.type==="Polygon"||_.type==="MultiPolygon"?wg(S,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,P):null}(l,d,this.geometries);if(o.geometryType()==="LineString")return function(p,y,_){const S=[];for(const I of p){const k=[];for(const D of I)k.push(s0(D,y));S.push(k)}const P=new od(S[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return u0(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",S,P);if(_.type==="MultiLineString"){let I=1/0;for(let k=0;k<_.coordinates.length;k++){const D=u0(_.coordinates[k],!0,S,P,I);if(isNaN(D))return D;if((I=Math.min(I,D))===0)return I}return I}if(_.type==="Polygon"||_.type==="MultiPolygon"){let I=1/0;for(let k=0;k<S.length;k++){const D=wg(S[k],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,P,I);if(isNaN(D))return D;if((I=Math.min(I,D))===0)return I}return I}return null}(l,d,this.geometries);if(o.geometryType()==="Polygon")return function(p,y,_){const S=[];for(const I of function(k,D){const N=k.length;if(N<=1)return[k];const W=[];let q,J;for(let ie=0;ie<N;ie++){const ae=pa(k[ie]);ae!==0&&(k[ie].area=Math.abs(ae),J===void 0&&(J=ae<0),J===ae<0?(q&&W.push(q),q=[k[ie]]):q.push(k[ie]))}return q&&W.push(q),W}(p)){const k=[];for(let D=0;D<I.length;++D)k.push(gI(I[D],y));S.push(k)}const P=new od(S[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return wg(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",S,P);if(_.type==="MultiLineString"){let I=1/0;for(let k=0;k<_.coordinates.length;k++){const D=wg(_.coordinates[k],!0,S,P,I);if(isNaN(D))return D;if((I=Math.min(I,D))===0)return I}return I}return _.type==="Polygon"||_.type==="MultiPolygon"?function(I,k,D){let N=1/0;for(const W of I)for(const q of k){const J=xI(W,q,D,N);if(isNaN(J))return J;if((N=Math.min(N,J))===0)return N}return N}(_.type==="Polygon"?[_.coordinates]:_.coordinates,S,P):null}(l,d,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function d0(u,o){switch(u){case"string":return da(o);case"number":return+o;case"boolean":return!!o;case"color":return wr.parse(o);case"formatted":return ha.fromString(da(o));case"resolvedImage":return Aa.build(da(o))}return o}function cS(u,o,l,d){return d!==void 0&&(u=d*Math.round(u/d)),o!==void 0&&u<o&&(u=o),l!==void 0&&u>l&&(u=l),u}class ld{constructor(o,l,d){this.type=o,this.key=l,this.scope=d}static parse(o,l){let d=l.expectedType;if(d==null&&(d=Ir),o.length<2||o.length>3)return l.error("Invalid number of arguments for 'config' expression.");const p=l.parse(o[1],1);if(!(p instanceof Zn))return l.error("Key name of 'config' expression must be a string literal.");if(o.length>=3){const y=l.parse(o[2],2);return y instanceof Zn?new ld(d,da(p.value),da(y.value)):l.error("Scope of 'config' expression must be a string literal.")}return new ld(d,da(p.value))}evaluate(o){const l=[this.key,this.scope,o.scope].filter(Boolean).join(""),d=o.getConfig(l);if(!d)return null;const{type:p,value:y,values:_,minValue:S,maxValue:P,stepValue:I}=d,k=d.default.evaluate(o);let D=k;if(y){const N=o.scope;o.scope=(N||"").split("").slice(1).join(""),D=y.evaluate(o),o.scope=N}return p&&(D=d0(p,D)),D===void 0||S===void 0&&P===void 0&&I===void 0||(typeof D=="number"?D=cS(D,S,P,I):Array.isArray(D)&&(D=D.map(N=>typeof N=="number"?cS(N,S,P,I):N))),y!==void 0&&D!==void 0&&_&&!_.includes(D)&&(D=k,p&&(D=d0(p,D))),(p&&p!==this.type||D!==void 0&&mo(D)!==this.type)&&(D=d0(this.type.kind,D)),D}eachChild(){}outputDefined(){return!1}serialize(){const o=["config",this.key];return this.scope&&o.concat(this.key),o}}function gp(u){if(u instanceof ea&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof rc||u instanceof Wu)return!1;let o=!0;return u.eachChild(l=>{o&&!gp(l)&&(o=!1)}),o}function Sg(u){if(u instanceof ea&&u.name==="feature-state")return!1;let o=!0;return u.eachChild(l=>{o&&!Sg(l)&&(o=!1)}),o}function Tg(u){if(u instanceof ld)return new Set([u.key]);let o=new Set;return u.eachChild(l=>{o=new Set([...o,...Tg(l)])}),o}function cd(u,o){if(u instanceof ea&&o.indexOf(u.name)>=0)return!1;let l=!0;return u.eachChild(d=>{l&&!cd(d,o)&&(l=!1)}),l}class Eg{constructor(o,l){this.type=l.type,this.name=o,this.boundExpression=l}static parse(o,l){if(o.length!==2||typeof o[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const d=o[1];return l.scope.has(d)?new Eg(d,l.scope.get(d)):l.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class f0{constructor(o,l=[],d,p=new Fu,y=[],_,S){this.registry=o,this.path=l,this.key=l.map(P=>typeof P=="string"?`['${P}']`:`[${P}]`).join(""),this.scope=p,this.errors=y,this.expectedType=d,this._scope=_,this.options=S}parse(o,l,d,p,y={}){return l||d?this.concat(l,null,d,p)._parse(o,y):this._parse(o,y)}parseObjectValue(o,l,d,p,y,_={}){return this.concat(l,d,p,y)._parse(o,_)}_parse(o,l){function d(p,y,_){return _==="assert"?new In(y,[p]):_==="coerce"?new Qs(y,[p]):p}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=typeof o[0]=="string"?this.registry[o[0]]:void 0;if(p){let y=p.parse(o,this);if(!y)return null;if(this.expectedType){const _=this.expectedType,S=y.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||S.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(_,S))return null}else y=d(y,_,l.typeAnnotation||"coerce");else y=d(y,_,l.typeAnnotation||"assert")}if(!(y instanceof Zn)&&y.type.kind!=="resolvedImage"&&p0(y)){const _=new mg(this._scope,this.options);try{y=new Zn(y.type,y.evaluate(_))}catch(S){return this.error(S.message),null}}return y}return Qs.parse(["to-array",o],this)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,l,d,p){let y=typeof o=="number"?this.path.concat(o):this.path;y=typeof l=="string"?y.concat(l):y;const _=p?this.scope.concat(p):this.scope;return new f0(this.registry,y,d||null,_,this.errors,this._scope,this.options)}error(o,...l){const d=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new Ts(d,o))}checkSubtype(o,l){const d=up(o,l);return d&&this.error(d),d}}var uS=f0;function p0(u){if(u instanceof Eg)return p0(u.boundExpression);if(u instanceof ea&&u.name==="error"||u instanceof rd||u instanceof rc||u instanceof Wu||u instanceof ld)return!1;const o=u instanceof Qs||u instanceof In;let l=!0;return u.eachChild(d=>{l=o?l&&p0(d):l&&d instanceof Zn}),!!l&&gp(u)&&cd(u,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Ag(u,o){const l=u.length-1;let d,p,y=0,_=l,S=0;for(;y<=_;)if(S=Math.floor((y+_)/2),d=u[S],p=u[S+1],d<=o){if(S===l||o<p)return S;y=S+1}else{if(!(d>o))throw new Jt("Input is not a number.");_=S-1}return 0}class yp{constructor(o,l,d){this.type=o,this.input=l,this.labels=[],this.outputs=[];for(const[p,y]of d)this.labels.push(p),this.outputs.push(y)}static parse(o,l){if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");const d=l.parse(o[1],1,cn);if(!d)return null;const p=[];let y=null;l.expectedType&&l.expectedType.kind!=="value"&&(y=l.expectedType);for(let _=1;_<o.length;_+=2){const S=_===1?-1/0:o[_],P=o[_+1],I=_,k=_+1;if(typeof S!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(p.length&&p[p.length-1][0]>=S)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const D=l.parse(P,k,y);if(!D)return null;y=y||D.type,p.push([S,D])}return new yp(y,d,p)}evaluate(o){const l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(o);const p=this.input.evaluate(o);if(p<=l[0])return d[0].evaluate(o);const y=l.length;return p>=l[y-1]?d[y-1].evaluate(o):d[Ag(l,p)].evaluate(o)}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&o.push(this.labels[l]),o.push(this.outputs[l].serialize());return o}}const hS=.95047,dS=1.08883,fS=4/29,ud=6/29,pS=3*ud*ud,wI=ud*ud*ud,m0=Math.PI/180,SI=180/Math.PI;function Pg(u){return u>wI?Math.pow(u,1/3):u/pS+fS}function g0(u){return u>ud?u*u*u:pS*(u-fS)}function y0(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function _0(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function v0(u){const o=_0(u.r),l=_0(u.g),d=_0(u.b),p=Pg((.4124564*o+.3575761*l+.1804375*d)/hS),y=Pg((.2126729*o+.7151522*l+.072175*d)/1);return{l:116*y-16,a:500*(p-y),b:200*(y-Pg((.0193339*o+.119192*l+.9503041*d)/dS)),alpha:u.a}}function x0(u){let o=(u.l+16)/116,l=isNaN(u.a)?o:o+u.a/500,d=isNaN(u.b)?o:o-u.b/200;return o=1*g0(o),l=hS*g0(l),d=dS*g0(d),new wr(y0(3.2404542*l-1.5371385*o-.4985314*d),y0(-.969266*l+1.8760108*o+.041556*d),y0(.0556434*l-.2040259*o+1.0572252*d),u.alpha)}function hd(u,o,l){const d=o-u;return u+l*(d>180||d<-180?d-360*Math.round(d/360):d)}const dd={forward:v0,reverse:x0,interpolate:function(u,o,l){return{l:yn(u.l,o.l,l),a:yn(u.a,o.a,l),b:yn(u.b,o.b,l),alpha:yn(u.alpha,o.alpha,l)}}},fd={forward:function(u){const{l:o,a:l,b:d}=v0(u),p=Math.atan2(d,l)*SI;return{h:p<0?p+360:p,c:Math.sqrt(l*l+d*d),l:o,alpha:u.a}},reverse:function(u){const o=u.h*m0,l=u.c;return x0({l:u.l,a:Math.cos(o)*l,b:Math.sin(o)*l,alpha:u.alpha})},interpolate:function(u,o,l){return{h:hd(u.h,o.h,l),c:yn(u.c,o.c,l),l:yn(u.l,o.l,l),alpha:yn(u.alpha,o.alpha,l)}}};var mS=Object.freeze({__proto__:null,hcl:fd,lab:dd});class Pa{constructor(o,l,d,p,y){this.type=o,this.operator=l,this.interpolation=d,this.input=p,this.labels=[],this.outputs=[];for(const[_,S]of y)this.labels.push(_),this.outputs.push(S)}static interpolationFactor(o,l,d,p){let y=0;if(o.name==="exponential")y=_p(l,o.base,d,p);else if(o.name==="linear")y=_p(l,1,d,p);else if(o.name==="cubic-bezier"){const _=o.controlPoints;y=new is(_[0],_[1],_[2],_[3]).solve(_p(l,1,d,p))}return y}static parse(o,l){let[d,p,y,..._]=o;if(!Array.isArray(p)||p.length===0)return l.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const I=p[1];if(typeof I!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:I}}else{if(p[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const I=p.slice(1);if(I.length!==4||I.some(k=>typeof k!="number"||k<0||k>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:I}}}if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length-1>3&&(o.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(y=l.parse(y,2,cn),!y)return null;const S=[];let P=null;d==="interpolate-hcl"||d==="interpolate-lab"?P=Ea:l.expectedType&&l.expectedType.kind!=="value"&&(P=l.expectedType);for(let I=0;I<_.length;I+=2){const k=_[I],D=_[I+1],N=I+3,W=I+4;if(typeof k!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(S.length&&S[S.length-1][0]>=k)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',N);const q=l.parse(D,W,P);if(!q)return null;P=P||q.type,S.push([k,q])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new Pa(P,d,p,y,S):l.error(`Type ${Qi(P)} is not interpolatable.`)}evaluate(o){const l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(o);const p=this.input.evaluate(o);if(p<=l[0])return d[0].evaluate(o);const y=l.length;if(p>=l[y-1])return d[y-1].evaluate(o);const _=Ag(l,p),S=Pa.interpolationFactor(this.interpolation,p,l[_],l[_+1]),P=d[_].evaluate(o),I=d[_+1].evaluate(o);return this.operator==="interpolate"?fg[this.type.kind.toLowerCase()](P,I,S):this.operator==="interpolate-hcl"?fd.reverse(fd.interpolate(fd.forward(P),fd.forward(I),S)):dd.reverse(dd.interpolate(dd.forward(P),dd.forward(I),S))}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const l=[this.operator,o,this.input.serialize()];for(let d=0;d<this.labels.length;d++)l.push(this.labels[d],this.outputs[d].serialize());return l}}function _p(u,o,l,d){const p=d-l,y=u-l;return p===0?0:o===1?y/p:(Math.pow(o,y)-1)/(Math.pow(o,p)-1)}class Cg{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expectected at least one argument.");let d=null;const p=l.expectedType;p&&p.kind!=="value"&&(d=p);const y=[];for(const S of o.slice(1)){const P=l.parse(S,1+y.length,d,void 0,{typeAnnotation:"omit"});if(!P)return null;d=d||P.type,y.push(P)}const _=p&&y.some(S=>up(p,S.type));return new Cg(_?Ir:d,y)}evaluate(o){let l,d=null,p=0;for(const y of this.args){if(p++,d=y.evaluate(o),d&&d instanceof Aa&&!d.available&&(l||(l=d),d=null,p===this.args.length))return l;if(d!==null)break}return d}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(l=>{o.push(l.serialize())}),o}}class Ig{constructor(o,l){this.type=l.type,this.bindings=[].concat(o),this.result=l}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const l of this.bindings)o(l[1]);o(this.result)}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const d=[];for(let y=1;y<o.length-1;y+=2){const _=o[y];if(typeof _!="string")return l.error(`Expected string, but found ${typeof _} instead.`,y);if(/[^a-zA-Z0-9_]/.test(_))return l.error("Variable names must contain only alphanumeric characters or '_'.",y);const S=l.parse(o[y+1],y+1);if(!S)return null;d.push([_,S])}const p=l.parse(o[o.length-1],o.length-1,l.expectedType,d);return p?new Ig(d,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[l,d]of this.bindings)o.push(l,d.serialize());return o.push(this.result.serialize()),o}}class Mg{constructor(o,l,d){this.type=o,this.index=l,this.input=d}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,cn),p=l.parse(o[2],2,ua(l.expectedType||Ir));return d&&p?new Mg(p.type.itemType,d,p):null}evaluate(o){const l=this.index.evaluate(o),d=this.input.evaluate(o);if(l<0)throw new Jt(`Array index out of bounds: ${l} < 0.`);if(l>=d.length)throw new Jt(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l!==Math.floor(l))throw new Jt(`Array index must be an integer, but found ${l} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return d[l]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Og{constructor(o,l,d){this.type=o,this.index=l,this.input=d}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,cn),p=l.parse(o[2],2,ua(l.expectedType||Ir));return d&&p?new Og(p.type.itemType,d,p):null}evaluate(o){const l=this.index.evaluate(o),d=this.input.evaluate(o);if(l<0)throw new Jt(`Array index out of bounds: ${l} < 0.`);if(l>d.length-1)throw new Jt(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l===Math.floor(l))return d[l];const p=Math.floor(l),y=Math.ceil(l),_=d[p],S=d[y];if(typeof _!="number"||typeof S!="number")throw new Jt(`Cannot interpolate between non-number values at index ${l}.`);const P=l-p;return _*(1-P)+S*P}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class b0{constructor(o,l){this.type=Or,this.needle=o,this.haystack=l}static parse(o,l){if(o.length!==3)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,Ir),p=l.parse(o[2],2,Ir);return d&&p?e0(d.type,[Or,$r,cn,Gc,Ir])?new b0(d,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(d.type)} instead`):null}evaluate(o){const l=this.needle.evaluate(o),d=this.haystack.evaluate(o);if(d==null)return!1;if(!ed(l,["boolean","string","number","null"]))throw new Jt(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(mo(l))} instead.`);if(!ed(d,["string","array"]))throw new Jt(`Expected second argument to be of type array or string, but found ${Qi(mo(d))} instead.`);return d.indexOf(l)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class kg{constructor(o,l,d){this.type=cn,this.needle=o,this.haystack=l,this.fromIndex=d}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,Ir),p=l.parse(o[2],2,Ir);if(!d||!p)return null;if(!e0(d.type,[Or,$r,cn,Gc,Ir]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(d.type)} instead`);if(o.length===4){const y=l.parse(o[3],3,cn);return y?new kg(d,p,y):null}return new kg(d,p)}evaluate(o){const l=this.needle.evaluate(o),d=this.haystack.evaluate(o);if(!ed(l,["boolean","string","number","null"]))throw new Jt(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(mo(l))} instead.`);if(!ed(d,["string","array"]))throw new Jt(`Expected second argument to be of type array or string, but found ${Qi(mo(d))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(o);return d.indexOf(l,p)}return d.indexOf(l)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class w0{constructor(o,l,d,p,y,_){this.inputType=o,this.type=l,this.input=d,this.cases=p,this.outputs=y,this.otherwise=_}static parse(o,l){if(o.length<5)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return l.error("Expected an even number of arguments.");let d,p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const y={},_=[];for(let I=2;I<o.length-1;I+=2){let k=o[I];const D=o[I+1];Array.isArray(k)||(k=[k]);const N=l.concat(I);if(k.length===0)return N.error("Expected at least one branch label.");for(const q of k){if(typeof q!="number"&&typeof q!="string")return N.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return N.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return N.error("Numeric branch labels must be integer values.");if(d){if(N.checkSubtype(d,mo(q)))return null}else d=mo(q);if(y[String(q)]!==void 0)return N.error("Branch labels must be unique.");y[String(q)]=_.length}const W=l.parse(D,I,p);if(!W)return null;p=p||W.type,_.push(W)}const S=l.parse(o[1],1,Ir);if(!S)return null;const P=l.parse(o[o.length-1],o.length-1,p);return P?S.type.kind!=="value"&&l.concat(1).checkSubtype(d,S.type)?null:new w0(d,p,S,y,_,P):null}evaluate(o){const l=this.input.evaluate(o);return(mo(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),d=[],p={};for(const _ of l){const S=p[this.cases[_]];S===void 0?(p[this.cases[_]]=d.length,d.push([this.cases[_],[_]])):d[S][1].push(_)}const y=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,S]of d)o.push(S.length===1?y(S[0]):S.map(y)),o.push(this.outputs[_].serialize());return o.push(this.otherwise.serialize()),o}}class Rg{constructor(o,l,d){this.type=o,this.branches=l,this.otherwise=d}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return l.error("Expected an odd number of arguments.");let d;l.expectedType&&l.expectedType.kind!=="value"&&(d=l.expectedType);const p=[];for(let _=1;_<o.length-1;_+=2){const S=l.parse(o[_],_,Or);if(!S)return null;const P=l.parse(o[_+1],_+1,d);if(!P)return null;p.push([S,P]),d=d||P.type}const y=l.parse(o[o.length-1],o.length-1,d);return y?new Rg(d,p,y):null}evaluate(o){for(const[l,d]of this.branches)if(l.evaluate(o))return d.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[l,d]of this.branches)o(l),o(d);o(this.otherwise)}outputDefined(){return this.branches.every(([o,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(l=>{o.push(l.serialize())}),o}}class vp{constructor(o,l,d,p){this.type=o,this.input=l,this.beginIndex=d,this.endIndex=p}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,Ir),p=l.parse(o[2],2,cn);if(!d||!p)return null;if(!e0(d.type,[ua(Ir),$r,Ir]))return l.error(`Expected first argument to be of type array or string, but found ${Qi(d.type)} instead`);if(o.length===4){const y=l.parse(o[3],3,cn);return y?new vp(d.type,d,p,y):null}return new vp(d.type,d,p)}evaluate(o){const l=this.input.evaluate(o),d=this.beginIndex.evaluate(o);if(!ed(l,["string","array"]))throw new Jt(`Expected first argument to be of type array or string, but found ${Qi(mo(l))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(o);return l.slice(d,p)}return l.slice(d)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function xp(u,o){return u==="=="||u==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function gS(u,o,l,d){return d.compare(o,l)===0}function Hu(u,o,l){const d=u!=="=="&&u!=="!=";return class Sne{constructor(y,_,S){this.type=Or,this.lhs=y,this.rhs=_,this.collator=S,this.hasUntypedArgument=y.type.kind==="value"||_.type.kind==="value"}static parse(y,_){if(y.length!==3&&y.length!==4)return _.error("Expected two or three arguments.");const S=y[0];let P=_.parse(y[1],1,Ir);if(!P)return null;if(!xp(S,P.type))return _.concat(1).error(`"${S}" comparisons are not supported for type '${Qi(P.type)}'.`);let I=_.parse(y[2],2,Ir);if(!I)return null;if(!xp(S,I.type))return _.concat(2).error(`"${S}" comparisons are not supported for type '${Qi(I.type)}'.`);if(P.type.kind!==I.type.kind&&P.type.kind!=="value"&&I.type.kind!=="value")return _.error(`Cannot compare types '${Qi(P.type)}' and '${Qi(I.type)}'.`);d&&(P.type.kind==="value"&&I.type.kind!=="value"?P=new In(I.type,[P]):P.type.kind!=="value"&&I.type.kind==="value"&&(I=new In(P.type,[I])));let k=null;if(y.length===4){if(P.type.kind!=="string"&&I.type.kind!=="string"&&P.type.kind!=="value"&&I.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(k=_.parse(y[3],3,Bu),!k)return null}return new Sne(P,I,k)}evaluate(y){const _=this.lhs.evaluate(y),S=this.rhs.evaluate(y);if(d&&this.hasUntypedArgument){const P=mo(_),I=mo(S);if(P.kind!==I.kind||P.kind!=="string"&&P.kind!=="number")throw new Jt(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${P.kind}, ${I.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const P=mo(_),I=mo(S);if(P.kind!=="string"||I.kind!=="string")return o(y,_,S)}return this.collator?l(y,_,S,this.collator.evaluate(y)):o(y,_,S)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[u];return this.eachChild(_=>{y.push(_.serialize())}),y}}}const TI=Hu("==",function(u,o,l){return o===l},gS),EI=Hu("!=",function(u,o,l){return o!==l},function(u,o,l,d){return!gS(0,o,l,d)}),yS=Hu("<",function(u,o,l){return o<l},function(u,o,l,d){return d.compare(o,l)<0}),_S=Hu(">",function(u,o,l){return o>l},function(u,o,l,d){return d.compare(o,l)>0}),AI=Hu("<=",function(u,o,l){return o<=l},function(u,o,l,d){return d.compare(o,l)<=0}),PI=Hu(">=",function(u,o,l){return o>=l},function(u,o,l,d){return d.compare(o,l)>=0});class S0{constructor(o,l,d,p,y,_){this.type=$r,this.number=o,this.locale=l,this.currency=d,this.unit=p,this.minFractionDigits=y,this.maxFractionDigits=_}static parse(o,l){if(o.length!==3)return l.error("Expected two arguments.");const d=l.parse(o[1],1,cn);if(!d)return null;const p=o[2];if(typeof p!="object"||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=l.parseObjectValue(p.locale,2,"locale",$r),!y))return null;let _=null;if(p.currency&&(_=l.parseObjectValue(p.currency,2,"currency",$r),!_))return null;let S=null;if(p.unit&&(S=l.parseObjectValue(p.unit,2,"unit",$r),!S))return null;let P=null;if(p["min-fraction-digits"]&&(P=l.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",cn),!P))return null;let I=null;return p["max-fraction-digits"]&&(I=l.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",cn),!I)?null:new S0(d,y,_,S,P,I)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class bp{constructor(o){this.type=cn,this.input=o}static parse(o,l){if(o.length!==2)return l.error(`Expected 1 argument, but found ${o.length-1} instead.`);const d=l.parse(o[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${Qi(d.type)} instead.`):new bp(d):null}evaluate(o){const l=this.input.evaluate(o);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Jt(`Expected value to be of type string or array, but found ${Qi(mo(l))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(l=>{o.push(l.serialize())}),o}}function vS(u){return function(){u=1831565813+(u|=0)|0;let o=Math.imul(u^u>>>15,1|u);return o=o+Math.imul(o^o>>>7,61|o)^o,((o^o>>>14)>>>0)/4294967296}}const qu={"==":TI,"!=":EI,">":_S,"<":yS,">=":PI,"<=":AI,array:In,at:Mg,"at-interpolated":Og,boolean:In,case:Rg,coalesce:Cg,collator:rd,format:ju,image:nd,in:b0,"index-of":kg,interpolate:Pa,"interpolate-hcl":Pa,"interpolate-lab":Pa,length:bp,let:Ig,literal:Zn,match:w0,number:In,"number-format":S0,object:In,slice:vp,step:yp,string:In,"to-boolean":Qs,"to-color":Qs,"to-number":Qs,"to-string":Qs,var:Eg,within:rc,distance:Wu,config:ld};function xS(u,[o,l,d,p]){o=o.evaluate(u),l=l.evaluate(u),d=d.evaluate(u);const y=p?p.evaluate(u):1,_=Jw(o,l,d,y);if(_)throw new Jt(_);return new wr(o/255*y,l/255*y,d/255*y,y)}function bS(u,[o,l,d,p]){o=o.evaluate(u),l=l.evaluate(u),d=d.evaluate(u);const y=p?p.evaluate(u):1,_=function(I,k,D,N){return typeof I=="number"&&I>=0&&I<=360?typeof k=="number"&&k>=0&&k<=100&&typeof D=="number"&&D>=0&&D<=100?N===void 0||typeof N=="number"&&N>=0&&N<=1?null:`Invalid hsla value [${[I,k,D,N].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof N=="number"?[I,k,D,N]:[I,k,D]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof N=="number"?[I,k,D,N]:[I,k,D]).join(", ")}]: 'h' must be between 0 and 360.`}(o,l,d,y);if(_)throw new Jt(_);const S=`hsla(${o}, ${l}%, ${d}%, ${y})`,P=wr.parse(S);if(!P)throw new Jt(`Failed to parse HSLA color: ${S}`);return P}function T0(u,o){return u in o}function Dg(u,o){const l=o[u];return l===void 0?null:l}function Yc(u){return{type:u}}function wS(u){return{result:"success",value:u}}function as(u){return{result:"error",value:u}}function E0(u,o){return!!u&&!!u.parameters&&u.parameters.indexOf(o)>-1}function Lg(u){return u["property-type"]==="data-driven"}function SS(u){return E0(u.expression,"measure-light")}function A0(u){return E0(u.expression,"zoom")}function zg(u){return!!u.expression&&u.expression.interpolated}function Ng(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function TS(u){return u}function Fg(u,o){const l=o.type==="color",d=u.stops&&typeof u.stops[0][0]=="object",p=d||!(d||u.property!==void 0),y=u.type||(zg(o)?"exponential":"interval");if(l&&((u=sp({},u)).stops&&(u.stops=u.stops.map(I=>[I[0],wr.parse(I[1])])),u.default=wr.parse(u.default?u.default:o.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!mS[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let _,S,P;if(y==="exponential")_=ic;else if(y==="interval")_=CI;else if(y==="categorical"){_=ES,S=Object.create(null);for(const I of u.stops)S[I[0]]=I[1];P=typeof u.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);_=II}if(d){const I={},k=[];for(let W=0;W<u.stops.length;W++){const q=u.stops[W],J=q[0].zoom;I[J]===void 0&&(I[J]={zoom:J,type:u.type,property:u.property,default:u.default,stops:[]},k.push(J)),I[J].stops.push([q[0].value,q[1]])}const D=[];for(const W of k)D.push([I[W].zoom,Fg(I[W],o)]);const N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:Pa.interpolationFactor.bind(void 0,N),zoomStops:D.map(W=>W[0]),evaluate:({zoom:W},q)=>ic({stops:D,base:u.base},o,W).evaluate(W,q)}}if(p){const I=y==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:Pa.interpolationFactor.bind(void 0,I),zoomStops:u.stops.map(k=>k[0]),evaluate:({zoom:k})=>_(u,o,k,S,P)}}return{kind:"source",evaluate(I,k){const D=k&&k.properties?k.properties[u.property]:void 0;return D===void 0?Zu(u.default,o.default):_(u,o,D,S,P)}}}function Zu(u,o,l){return u!==void 0?u:o!==void 0?o:l!==void 0?l:void 0}function ES(u,o,l,d,p){return Zu(typeof l===p?d[l]:void 0,u.default,o.default)}function CI(u,o,l){if(Mn(l)!=="number")return Zu(u.default,o.default);const d=u.stops.length;if(d===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[d-1][0])return u.stops[d-1][1];const p=Ag(u.stops.map(y=>y[0]),l);return u.stops[p][1]}function ic(u,o,l){const d=u.base!==void 0?u.base:1;if(Mn(l)!=="number")return Zu(u.default,o.default);const p=u.stops.length;if(p===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[p-1][0])return u.stops[p-1][1];const y=Ag(u.stops.map(k=>k[0]),l),_=function(k,D,N,W){const q=W-N,J=k-N;return q===0?0:D===1?J/q:(Math.pow(D,J)-1)/(Math.pow(D,q)-1)}(l,d,u.stops[y][0],u.stops[y+1][0]),S=u.stops[y][1],P=u.stops[y+1][1];let I=fg[o.type]||TS;if(u.colorSpace&&u.colorSpace!=="rgb"){const k=mS[u.colorSpace];I=(D,N)=>k.reverse(k.interpolate(k.forward(D),k.forward(N),_))}return typeof S.evaluate=="function"?{evaluate(...k){const D=S.evaluate.apply(void 0,k),N=P.evaluate.apply(void 0,k);if(D!==void 0&&N!==void 0)return I(D,N,_)}}:I(S,P,_)}function II(u,o,l){return o.type==="color"?l=wr.parse(l):o.type==="formatted"?l=ha.fromString(l.toString()):o.type==="resolvedImage"?l=Aa.build(l.toString()):Mn(l)===o.type||o.type==="enum"&&o.values[l]||(l=void 0),Zu(l,u.default,o.default)}ea.register(qu,{error:[{kind:"error"},[$r],(u,[o])=>{throw new Jt(o.evaluate(u))}],typeof:[$r,[Ir],(u,[o])=>Qi(mo(o.evaluate(u)))],"to-rgba":[ua(cn,4),[Ea],(u,[o])=>o.evaluate(u).toRenderColor(null).toArray()],"to-hsla":[ua(cn,4),[Ea],(u,[o])=>o.evaluate(u).toRenderColor(null).toHslaArray()],rgb:[Ea,[cn,cn,cn],xS],rgba:[Ea,[cn,cn,cn,cn],xS],hsl:[Ea,[cn,cn,cn],bS],hsla:[Ea,[cn,cn,cn,cn],bS],has:{type:Or,overloads:[[[$r],(u,[o])=>T0(o.evaluate(u),u.properties())],[[$r,Wc],(u,[o,l])=>T0(o.evaluate(u),l.evaluate(u))]]},get:{type:Ir,overloads:[[[$r],(u,[o])=>Dg(o.evaluate(u),u.properties())],[[$r,Wc],(u,[o,l])=>Dg(o.evaluate(u),l.evaluate(u))]]},"feature-state":[Ir,[$r],(u,[o])=>Dg(o.evaluate(u),u.featureState||{})],properties:[Wc,[],u=>u.properties()],"geometry-type":[$r,[],u=>u.geometryType()],id:[Ir,[],u=>u.id()],zoom:[cn,[],u=>u.globals.zoom],pitch:[cn,[],u=>u.globals.pitch||0],"distance-from-center":[cn,[],u=>u.distanceFromCenter()],"measure-light":[cn,[$r],(u,[o])=>u.measureLight(o.evaluate(u))],"heatmap-density":[cn,[],u=>u.globals.heatmapDensity||0],"line-progress":[cn,[],u=>u.globals.lineProgress||0],"raster-value":[cn,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[cn,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[cn,[],u=>u.globals.skyRadialProgress||0],accumulated:[Ir,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[cn,Yc(cn),(u,o)=>{let l=0;for(const d of o)l+=d.evaluate(u);return l}],"*":[cn,Yc(cn),(u,o)=>{let l=1;for(const d of o)l*=d.evaluate(u);return l}],"-":{type:cn,overloads:[[[cn,cn],(u,[o,l])=>o.evaluate(u)-l.evaluate(u)],[[cn],(u,[o])=>-o.evaluate(u)]]},"/":[cn,[cn,cn],(u,[o,l])=>o.evaluate(u)/l.evaluate(u)],"%":[cn,[cn,cn],(u,[o,l])=>o.evaluate(u)%l.evaluate(u)],ln2:[cn,[],()=>Math.LN2],pi:[cn,[],()=>Math.PI],e:[cn,[],()=>Math.E],"^":[cn,[cn,cn],(u,[o,l])=>Math.pow(o.evaluate(u),l.evaluate(u))],sqrt:[cn,[cn],(u,[o])=>Math.sqrt(o.evaluate(u))],log10:[cn,[cn],(u,[o])=>Math.log(o.evaluate(u))/Math.LN10],ln:[cn,[cn],(u,[o])=>Math.log(o.evaluate(u))],log2:[cn,[cn],(u,[o])=>Math.log(o.evaluate(u))/Math.LN2],sin:[cn,[cn],(u,[o])=>Math.sin(o.evaluate(u))],cos:[cn,[cn],(u,[o])=>Math.cos(o.evaluate(u))],tan:[cn,[cn],(u,[o])=>Math.tan(o.evaluate(u))],asin:[cn,[cn],(u,[o])=>Math.asin(o.evaluate(u))],acos:[cn,[cn],(u,[o])=>Math.acos(o.evaluate(u))],atan:[cn,[cn],(u,[o])=>Math.atan(o.evaluate(u))],min:[cn,Yc(cn),(u,o)=>Math.min(...o.map(l=>l.evaluate(u)))],max:[cn,Yc(cn),(u,o)=>Math.max(...o.map(l=>l.evaluate(u)))],abs:[cn,[cn],(u,[o])=>Math.abs(o.evaluate(u))],round:[cn,[cn],(u,[o])=>{const l=o.evaluate(u);return l<0?-Math.round(-l):Math.round(l)}],floor:[cn,[cn],(u,[o])=>Math.floor(o.evaluate(u))],ceil:[cn,[cn],(u,[o])=>Math.ceil(o.evaluate(u))],"filter-==":[Or,[$r,Ir],(u,[o,l])=>u.properties()[o.value]===l.value],"filter-id-==":[Or,[Ir],(u,[o])=>u.id()===o.value],"filter-type-==":[Or,[$r],(u,[o])=>u.geometryType()===o.value],"filter-<":[Or,[$r,Ir],(u,[o,l])=>{const d=u.properties()[o.value],p=l.value;return typeof d==typeof p&&d<p}],"filter-id-<":[Or,[Ir],(u,[o])=>{const l=u.id(),d=o.value;return typeof l==typeof d&&l<d}],"filter->":[Or,[$r,Ir],(u,[o,l])=>{const d=u.properties()[o.value],p=l.value;return typeof d==typeof p&&d>p}],"filter-id->":[Or,[Ir],(u,[o])=>{const l=u.id(),d=o.value;return typeof l==typeof d&&l>d}],"filter-<=":[Or,[$r,Ir],(u,[o,l])=>{const d=u.properties()[o.value],p=l.value;return typeof d==typeof p&&d<=p}],"filter-id-<=":[Or,[Ir],(u,[o])=>{const l=u.id(),d=o.value;return typeof l==typeof d&&l<=d}],"filter->=":[Or,[$r,Ir],(u,[o,l])=>{const d=u.properties()[o.value],p=l.value;return typeof d==typeof p&&d>=p}],"filter-id->=":[Or,[Ir],(u,[o])=>{const l=u.id(),d=o.value;return typeof l==typeof d&&l>=d}],"filter-has":[Or,[Ir],(u,[o])=>o.value in u.properties()],"filter-has-id":[Or,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Or,[ua($r)],(u,[o])=>o.value.indexOf(u.geometryType())>=0],"filter-id-in":[Or,[ua(Ir)],(u,[o])=>o.value.indexOf(u.id())>=0],"filter-in-small":[Or,[$r,ua(Ir)],(u,[o,l])=>l.value.indexOf(u.properties()[o.value])>=0],"filter-in-large":[Or,[$r,ua(Ir)],(u,[o,l])=>function(d,p,y,_){for(;y<=_;){const S=y+_>>1;if(p[S]===d)return!0;p[S]>d?_=S-1:y=S+1}return!1}(u.properties()[o.value],l.value,0,l.value.length-1)],all:{type:Or,overloads:[[[Or,Or],(u,[o,l])=>o.evaluate(u)&&l.evaluate(u)],[Yc(Or),(u,o)=>{for(const l of o)if(!l.evaluate(u))return!1;return!0}]]},any:{type:Or,overloads:[[[Or,Or],(u,[o,l])=>o.evaluate(u)||l.evaluate(u)],[Yc(Or),(u,o)=>{for(const l of o)if(l.evaluate(u))return!0;return!1}]]},"!":[Or,[Or],(u,[o])=>!o.evaluate(u)],"is-supported-script":[Or,[$r],(u,[o])=>{const l=u.globals&&u.globals.isSupportedScript;return!l||l(o.evaluate(u))}],upcase:[$r,[$r],(u,[o])=>o.evaluate(u).toUpperCase()],downcase:[$r,[$r],(u,[o])=>o.evaluate(u).toLowerCase()],concat:[$r,Yc(Ir),(u,o)=>o.map(l=>da(l.evaluate(u))).join("")],"resolved-locale":[$r,[Bu],(u,[o])=>o.evaluate(u).resolvedLocale()],random:[cn,[cn,cn,Ir],(u,o)=>{const[l,d,p]=o.map(_=>_.evaluate(u));if(l>d||l===d)return l;let y;if(typeof p=="string")y=function(_){let S=0;if(_.length===0)return S;for(let P=0;P<_.length;P++)S=(S<<5)-S+_.charCodeAt(P),S|=0;return S}(p);else{if(typeof p!="number")throw new Jt(`Invalid seed input: ${p}`);y=p}return l+vS(y)()*(d-l)}]});class P0{constructor(o,l,d,p){this.expression=o,this._warningHistory={},this._evaluator=new mg(d,p),this._defaultValue=l?function(y){return y.type==="color"&&(Ng(y.default)||Array.isArray(y.default))?new wr(0,0,0,0):y.type==="color"?wr.parse(y.default)||null:y.default===void 0?null:y.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null,this.configDependencies=Tg(o)}evaluateWithoutErrorHandling(o,l,d,p,y,_,S,P){return this._evaluator.globals=o,this._evaluator.feature=l,this._evaluator.featureState=d,this._evaluator.canonical=p||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(o,l,d,p,y,_,S,P){this._evaluator.globals=o,this._evaluator.feature=l||null,this._evaluator.featureState=d||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=P||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new Jt(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${I.message}`)),this._defaultValue}}}function Bg(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in qu}function pd(u,o,l,d){const p=new uS(qu,[],o?function(_){const S={color:Ea,string:$r,number:cn,enum:$r,boolean:Or,formatted:lp,resolvedImage:cp};return _.type==="array"?ua(S[_.value]||Ir,_.length):S[_.type]}(o):void 0,void 0,void 0,l,d),y=p.parse(u,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?wS(new P0(y,o,l,d)):as(p.errors)}class Xu{constructor(o,l,d,p){this.kind=o,this._styleExpression=l,this.isLightConstant=d,this.isLineProgressConstant=p,this.isStateDependent=o!=="constant"&&!Sg(l.expression),this.configDependencies=Tg(l.expression)}evaluateWithoutErrorHandling(o,l,d,p,y,_){return this._styleExpression.evaluateWithoutErrorHandling(o,l,d,p,y,_)}evaluate(o,l,d,p,y,_){return this._styleExpression.evaluate(o,l,d,p,y,_)}}class md{constructor(o,l,d,p,y,_){this.kind=o,this.zoomStops=d,this._styleExpression=l,this.isStateDependent=o!=="camera"&&!Sg(l.expression),this.isLightConstant=y,this.isLineProgressConstant=_,this.configDependencies=Tg(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(o,l,d,p,y,_){return this._styleExpression.evaluateWithoutErrorHandling(o,l,d,p,y,_)}evaluate(o,l,d,p,y,_){return this._styleExpression.evaluate(o,l,d,p,y,_)}interpolationFactor(o,l,d){return this.interpolationType?Pa.interpolationFactor(this.interpolationType,o,l,d):0}}function wp(u,o,l,d){if((u=pd(u,o,l,d)).result==="error")return u;const p=u.value.expression,y=gp(p);if(!y&&!Lg(o))return as([new Ts("","data expressions not supported")]);const _=cd(p,["zoom","pitch","distance-from-center"]);if(!_&&!A0(o))return as([new Ts("","zoom expressions not supported")]);const S=cd(p,["measure-light"]);if(!S&&!SS(o))return as([new Ts("","measure-light expression not supported")]);const P=cd(p,["line-progress"]);if(!P&&!function(D){return E0(D.expression,"line-progress")}(o))return as([new Ts("","line-progress expression not supported")]);const I=o.expression&&o.expression.relaxZoomRestriction,k=jg(p);return k||_||I?k instanceof Ts?as([k]):k instanceof Pa&&!zg(o)?as([new Ts("",'"interpolate" expressions cannot be used with this property')]):wS(k?new md(y&&P?"camera":"composite",u.value,k.labels,k instanceof Pa?k.interpolation:void 0,S,P):new Xu(y&&P?"constant":"source",u.value,S,P)):as([new Ts("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Sp{constructor(o,l){this._parameters=o,this._specification=l,sp(this,Fg(this._parameters,this._specification))}static deserialize(o){return new Sp(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function jg(u){let o=null;if(u instanceof Ig)o=jg(u.result);else if(u instanceof Cg){for(const l of u.args)if(o=jg(l),o)break}else(u instanceof yp||u instanceof Pa)&&u.input instanceof ea&&u.input.name==="zoom"&&(o=u);return o instanceof Ts||u.eachChild(l=>{const d=jg(l);d instanceof Ts?o=d:o&&d&&o!==d&&(o=new Ts("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}var C0,$g,I0=function(){if($g)return C0;$g=1,C0=o;var u=3;function o(l,d,p){var y=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var _=new Int32Array(this.arrayBuffer);l=_[0],this.d=(d=_[1])+2*(p=_[2]);for(var S=0;S<this.d*this.d;S++){var P=_[u+S],I=_[u+S+1];y.push(P===I?null:_.subarray(P,I))}var k=_[u+y.length+1];this.keys=_.subarray(_[u+y.length],k),this.bboxes=_.subarray(k),this.insert=this._insertReadonly}else{this.d=d+2*p;for(var D=0;D<this.d*this.d;D++)y.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=l,this.padding=p,this.scale=d/l,this.uid=0;var N=p/d*l;this.min=-N,this.max=l+N}return o.prototype.insert=function(l,d,p,y,_){this._forEachCell(d,p,y,_,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(_)},o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},o.prototype._insertCell=function(l,d,p,y,_,S){this.cells[_].push(S)},o.prototype.query=function(l,d,p,y,_){var S=this.min,P=this.max;if(l<=S&&d<=S&&P<=p&&P<=y&&!_)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(l,d,p,y,this._queryCell,I,{},_),I},o.prototype._queryCell=function(l,d,p,y,_,S,P,I){var k=this.cells[_];if(k!==null)for(var D=this.keys,N=this.bboxes,W=0;W<k.length;W++){var q=k[W];if(P[q]===void 0){var J=4*q;(I?I(N[J+0],N[J+1],N[J+2],N[J+3]):l<=N[J+2]&&d<=N[J+3]&&p>=N[J+0]&&y>=N[J+1])?(P[q]=!0,S.push(D[q])):P[q]=!1}}},o.prototype._forEachCell=function(l,d,p,y,_,S,P,I){for(var k=this._convertToCellCoord(l),D=this._convertToCellCoord(d),N=this._convertToCellCoord(p),W=this._convertToCellCoord(y),q=k;q<=N;q++)for(var J=D;J<=W;J++){var ie=this.d*J+q;if((!I||I(this._convertFromCellCoord(q),this._convertFromCellCoord(J),this._convertFromCellCoord(q+1),this._convertFromCellCoord(J+1)))&&_.call(this,l,d,p,y,ie,S,P,I))return}},o.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},o.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,d=u+this.cells.length+1+1,p=0,y=0;y<this.cells.length;y++)p+=this.cells[y].length;var _=new Int32Array(d+p+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var S=d,P=0;P<l.length;P++){var I=l[P];_[u+P]=S,_.set(I,S),S+=I.length}return _[u+l.length]=S,_.set(this.keys,S),_[u+l.length+1]=S+=this.keys.length,_.set(this.bboxes,S),S+=this.bboxes.length,_.buffer},C0}(),gd=rs(I0);const Tp={};function Zt(u,o,l={}){Object.defineProperty(u,"_classRegistryKey",{value:o,writable:!1}),Tp[o]={klass:u,omit:l.omit||[]}}Zt(Object,"Object"),gd.serialize=function(u,o){const l=u.toArrayBuffer();return o&&o.add(l),{buffer:l}},gd.deserialize=function(u){return new gd(u.buffer)},Object.defineProperty(gd,"name",{value:"Grid"}),Zt(gd,"Grid"),typeof DOMMatrix<"u"&&Zt(DOMMatrix,"DOMMatrix"),Zt(wr,"Color"),Zt(Error,"Error"),Zt(ha,"Formatted"),Zt(pg,"FormattedSection"),Zt(lg,"AJAXError"),Zt(Aa,"ResolvedImage"),Zt(Sp,"StylePropertyFunction"),Zt(P0,"StyleExpression",{omit:["_evaluator"]}),Zt(ja,"ImageId"),Zt(Js,"ImageVariant"),Zt(md,"ZoomDependentExpression"),Zt(Xu,"ZoomConstantExpression"),Zt(ea,"CompoundExpression",{omit:["_evaluate"]});for(const u in qu)Tp[qu[u]._classRegistryKey]||Zt(qu[u],`Expression${u}`);function Ep(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function Ku(u){return self.ImageBitmap&&u instanceof ImageBitmap}function Jc(u,o){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(Ep(u)||Ku(u))return o&&o.add(u),u;if(ArrayBuffer.isView(u))return o&&o.add(u.buffer),u;if(u instanceof ImageData)return o&&o.add(u.data.buffer),u;if(Array.isArray(u)){const l=[];for(const d of u)l.push(Jc(d,o));return l}if(u instanceof Map){const l={$name:"Map",entries:[]};for(const[d,p]of u.entries())l.entries.push(Jc(d),Jc(p,o));return l}if(u instanceof Set){const l={$name:"Set"};let d=0;for(const p of u.values())l[++d]=Jc(p);return l}if(u instanceof DOMMatrix){const l={$name:"DOMMatrix"},d=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const p of d)l[p]=u[p];return l}if(typeof u=="bigint")return{$name:"BigInt",value:u.toString()};if(typeof u=="object"){const l=u.constructor,d=l._classRegistryKey;if(!d)throw new Error(`Can't serialize object of unregistered class "${l.name}".`);const p=l.serialize?l.serialize(u,o):{};if(!l.serialize){for(const y in u)u.hasOwnProperty(y)&&(Tp[d].omit.indexOf(y)>=0||(p[y]=Jc(u[y],o)));u instanceof Error&&(p.message=u.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(p.$name=d),p}throw new Error("can't serialize object of type "+typeof u)}function Qc(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||Ep(u)||Ku(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(Qc);if(typeof u=="object"){const o=u.$name||"Object";if(o==="Map"){const p=u.entries||[],y=new Map;for(let _=0;_<p.length;_+=2)y.set(Qc(p[_]),Qc(p[_+1]));return y}if(o==="Set"){const p=new Set;for(const y of Object.keys(u))y!=="$name"&&p.add(Qc(u[y]));return p}if(o==="DOMMatrix"){let p;return p=u.is2D?[u.a,u.b,u.c,u.d,u.e,u.f]:[u.m11,u.m12,u.m13,u.m14,u.m21,u.m22,u.m23,u.m24,u.m31,u.m32,u.m33,u.m34,u.m41,u.m42,u.m43,u.m44],new DOMMatrix(p)}if(o==="BigInt")return BigInt(u.value);const{klass:l}=Tp[o];if(!l)throw new Error(`Can't deserialize unregistered class "${o}".`);if(l.deserialize)return l.deserialize(u);const d=Object.create(l.prototype);for(const p of Object.keys(u))p!=="$name"&&(d[p]=Qc(u[p]));return d}throw new Error("can't deserialize object of type "+typeof u)}const bn={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function M0(u){for(const o of u)if(Ap(o.charCodeAt(0)))return!0;return!1}function MI(u){for(const o of u)if(!AS(o.charCodeAt(0)))return!1;return!0}function AS(u){return!(bn.Arabic(u)||bn["Arabic Supplement"](u)||bn["Arabic Extended-A"](u)||bn["Arabic Presentation Forms-A"](u)||bn["Arabic Presentation Forms-B"](u))}function Ap(u){return!(u!==746&&u!==747&&(u<4352||!(bn["Bopomofo Extended"](u)||bn.Bopomofo(u)||bn["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||bn["CJK Compatibility Ideographs"](u)||bn["CJK Compatibility"](u)||bn["CJK Radicals Supplement"](u)||bn["CJK Strokes"](u)||!(!bn["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||bn["CJK Unified Ideographs Extension A"](u)||bn["CJK Unified Ideographs"](u)||bn["Enclosed CJK Letters and Months"](u)||bn["Hangul Compatibility Jamo"](u)||bn["Hangul Jamo Extended-A"](u)||bn["Hangul Jamo Extended-B"](u)||bn["Hangul Jamo"](u)||bn["Hangul Syllables"](u)||bn.Hiragana(u)||bn["Ideographic Description Characters"](u)||bn.Kanbun(u)||bn["Kangxi Radicals"](u)||bn["Katakana Phonetic Extensions"](u)||bn.Katakana(u)&&u!==12540||!(!bn["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!bn["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||bn["Unified Canadian Aboriginal Syllabics"](u)||bn["Unified Canadian Aboriginal Syllabics Extended"](u)||bn["Vertical Forms"](u)||bn["Yijing Hexagram Symbols"](u)||bn["Yi Syllables"](u)||bn["Yi Radicals"](u))))}function PS(u){return!(Ap(u)||function(o){return!!(bn["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||bn["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||bn["Letterlike Symbols"](o)||bn["Number Forms"](o)||bn["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||bn["Control Pictures"](o)&&o!==9251||bn["Optical Character Recognition"](o)||bn["Enclosed Alphanumerics"](o)||bn["Geometric Shapes"](o)||bn["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||bn["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||bn["CJK Symbols and Punctuation"](o)||bn.Katakana(o)||bn["Private Use Area"](o)||bn["CJK Compatibility Forms"](o)||bn["Small Form Variants"](o)||bn["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(u))}function OI(u){return bn.Arabic(u)||bn["Arabic Supplement"](u)||bn["Arabic Extended-A"](u)||bn["Arabic Presentation Forms-A"](u)||bn["Arabic Presentation Forms-B"](u)}function CS(u){return u>=1424&&u<=2303||bn["Arabic Presentation Forms-A"](u)||bn["Arabic Presentation Forms-B"](u)}function kI(u,o){return!(!o&&CS(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||bn.Khmer(u))}function RI(u){for(const o of u)if(CS(o.charCodeAt(0)))return!0;return!1}const O0="deferred",k0="loading",R0="loaded";let D0=null,$a="unavailable",eu=null;const Yu=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&($a="error"),D0&&D0(u)};function Ug(){Vg.fire(new Vc("pluginStateChange",{pluginStatus:$a,pluginURL:eu}))}const Vg=new Nu,yd=function(){return $a},IS=function(){if($a!==O0||!eu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");$a=k0,Ug(),eu&&Yh({url:eu},u=>{u?Yu(u):($a=R0,Ug())})},Ps={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>$a===R0||Ps.applyArabicShaping!=null,isLoading:()=>$a===k0,setState(u){$a=u.pluginStatus,eu=u.pluginURL},isParsed:()=>Ps.applyArabicShaping!=null&&Ps.processBidirectionalText!=null&&Ps.processStyledBidirectionalText!=null,getPluginURL:()=>eu};class zr{constructor(o,l){this.zoom=o,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(o){return function(l,d){for(const p of l)if(!kI(p.charCodeAt(0),d))return!1;return!0}(o,Ps.isLoaded())}}class Pp{constructor(o,l,d,p){this.property=o,this.value=l,this.expression=function(y,_,S,P){if(Ng(y))return new Sp(y,_);if(Bg(y)||Array.isArray(y)&&y.length>0){const I=wp(y,_,S,P);if(I.result==="error")throw new Error(I.value.map(k=>`${k.key}: ${k.message}`).join(", "));return I.value}{let I=y;return typeof y=="string"&&_.type==="color"&&(I=wr.parse(y)),{kind:"constant",configDependencies:new Set,evaluate:()=>I}}}(l===void 0?o.specification.default:l,o.specification,d,p)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,l,d){return this.property.possiblyEvaluate(this,o,l,d)}}class tu{constructor(o,l,d){this.property=o,this.value=new Pp(o,void 0,l,d)}transitioned(o,l){return new OS(this.property,this.value,l,tt({},o.transition,this.transition),o.now)}untransitioned(){return new OS(this.property,this.value,null,{},0)}}class MS{constructor(o,l,d){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._scope=l,this._options=d,this.configDependencies=new Set}getValue(o){return er(this._values[o].value.value)}setValue(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new tu(this._values[o].property,this._scope,this._options)),this._values[o].value=new Pp(this._values[o].property,l===null?void 0:er(l),this._scope,this._options),this._values[o].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].value.expression.configDependencies]))}setTransitionOrValue(o,l){l&&(this._options=l);const d=this._properties.properties;if(o)for(const p in o){const y=o[p];if(p.endsWith("-transition")){const _=p.slice(0,-11);d[_]&&this.setTransition(_,y)}else d.hasOwnProperty(p)&&this.setValue(p,y)}}getTransition(o){return er(this._values[o].transition)}setTransition(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new tu(this._values[o].property)),this._values[o].transition=er(l)||void 0}serialize(){const o={};for(const l of Object.keys(this._values)){const d=this.getValue(l);d!==void 0&&(o[l]=d);const p=this.getTransition(l);p!==void 0&&(o[`${l}-transition`]=p)}return o}transitioned(o,l){const d=new kS(this._properties);for(const p of Object.keys(this._values))d._values[p]=this._values[p].transitioned(o,l._values[p]);return d}untransitioned(){const o=new kS(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].untransitioned();return o}}class OS{constructor(o,l,d,p,y){const _=p.delay||0,S=p.duration||0;y=y||0,this.property=o,this.value=l,this.begin=y+_,this.end=this.begin+S,o.specification.transition&&(p.delay||p.duration)&&(this.prior=d)}possiblyEvaluate(o,l,d){const p=o.now||0,y=this.value.possiblyEvaluate(o,l,d),_=this.prior;if(_){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return _.possiblyEvaluate(o,l,d);{const S=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(o,l,d),y,Oe(S))}}return y}}class kS{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,l,d){const p=new Ju(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(o,l,d);return p}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class DI{constructor(o,l,d){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._scope=l,this._options=d,this.configDependencies=new Set}getValue(o){return er(this._values[o].value)}setValue(o,l){this._values[o]=new Pp(this._values[o].property,l===null?void 0:er(l),this._scope,this._options),this._values[o].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].expression.configDependencies]))}serialize(){const o={};for(const l of Object.keys(this._values)){const d=this.getValue(l);d!==void 0&&(o[l]=d)}return o}possiblyEvaluate(o,l,d){const p=new Ju(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(o,l,d);return p}}class _d{constructor(o,l,d){this.property=o,this.value=l,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,l,d,p){return this.property.evaluate(this.value,this.parameters,o,l,d,p)}}class Ju{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class Dt{constructor(o){this.specification=o}possiblyEvaluate(o,l){return o.expression.evaluate(l)}interpolate(o,l,d){const p=fg[this.specification.type];return p?p(o,l,d):o}}class qt{constructor(o,l){this.specification=o,this.overrides=l}possiblyEvaluate(o,l,d,p){return new _d(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(l,null,{},d,p)}:o.expression,l)}interpolate(o,l,d){if(o.value.kind!=="constant"||l.value.kind!=="constant")return o;if(o.value.value===void 0||l.value.value===void 0)return new _d(this,{kind:"constant",value:void 0},o.parameters);const p=fg[this.specification.type];return p?new _d(this,{kind:"constant",value:p(o.value.value,l.value.value,d)},o.parameters):o}evaluate(o,l,d,p,y,_){return o.kind==="constant"?o.value:o.evaluate(l,d,p,y,_)}}class Qu{constructor(o){this.specification=o}possiblyEvaluate(o,l,d,p){return!!o.expression.evaluate(l,null,{},d,p)}interpolate(){return!1}}class Di{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new zr(0,{});for(const d in o){const p=o[d];p.specification.overridable&&this.overridableProperties.push(d);const y=this.defaultPropertyValues[d]=new Pp(p,void 0),_=this.defaultTransitionablePropertyValues[d]=new tu(p);this.defaultTransitioningPropertyValues[d]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=y.possiblyEvaluate(l)}}}Zt(qt,"DataDrivenProperty"),Zt(Dt,"DataConstantProperty"),Zt(Qu,"ColorRampProperty");var Ke=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white"},"sky-atmosphere-color":{"type":"color","default":"white"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function el(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Gg(u){if(Array.isArray(u))return u.map(Gg);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const o={};for(const l in u)o[l]=Gg(u[l]);return o}return el(u)}function Wg(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const o of u.slice(1))if(!Wg(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function L0(u,o="",l=null,d="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Wg(u)||(u=Hg(u));const p=u;let y=!0;try{y=function(k){if(!vd(k))return k;let D=Gg(k);return DS(D),D=RS(D),D}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let _=null,S=null;if(d!=="background"&&d!=="sky"&&d!=="slot"){S=Ke[`filter_${d}`];const k=pd(y,S,o,l);if(k.result==="error")throw new Error(k.value.map(D=>`${D.key}: ${D.message}`).join(", "));_=(D,N,W)=>k.value.evaluate(D,N,{},W)}let P=null,I=null;if(y!==p){const k=pd(p,S,o,l);if(k.result==="error")throw new Error(k.value.map(D=>`${D.key}: ${D.message}`).join(", "));P=(D,N,W,q,J)=>k.value.evaluate(D,N,{},W,void 0,void 0,q,J),I=!gp(k.value.expression)}return{filter:_,dynamicFilter:P||void 0,needGeometry:LS(y),needFeature:!!I}}function RS(u){if(!Array.isArray(u))return u;const o=function(l){if(LI.has(l[0])){for(let d=1;d<l.length;d++)if(vd(l[d]))return!0}return l}(u);return o===!0?o:o.map(l=>RS(l))}function DS(u){let o=!1;const l=[];if(u[0]==="case"){for(let d=1;d<u.length-1;d+=2)o=o||vd(u[d]),l.push(u[d+1]);l.push(u[u.length-1])}else if(u[0]==="match"){o=o||vd(u[1]);for(let d=2;d<u.length-1;d+=2)l.push(u[d+1]);l.push(u[u.length-1])}else if(u[0]==="step"){o=o||vd(u[1]);for(let d=1;d<u.length-1;d+=2)l.push(u[d+1])}o&&(u.length=0,u.push("any",...l));for(let d=1;d<u.length;d++)DS(u[d])}function vd(u){if(!Array.isArray(u))return!1;if((o=u[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let l=1;l<u.length;l++)if(vd(u[l]))return!0;return!1}const LI=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function zI(u,o){return u<o?-1:u>o?1:0}function LS(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let o=1;o<u.length;o++)if(LS(u[o]))return!0;return!1}function Hg(u){if(!u)return!0;const o=u[0];return u.length<=1?o!=="any":o==="=="?z0(u[1],u[2],"=="):o==="!="?qg(z0(u[1],u[2],"==")):o==="<"||o===">"||o==="<="||o===">="?z0(u[1],u[2],o):o==="any"?(l=u.slice(1),["any"].concat(l.map(Hg))):o==="all"?["all"].concat(u.slice(1).map(Hg)):o==="none"?["all"].concat(u.slice(1).map(Hg).map(qg)):o==="in"?N0(u[1],u.slice(2)):o==="!in"?qg(N0(u[1],u.slice(2))):o==="has"?zS(u[1]):o!=="!has"||qg(zS(u[1]));var l}function z0(u,o,l){switch(u){case"$type":return[`filter-type-${l}`,o];case"$id":return[`filter-id-${l}`,o];default:return[`filter-${l}`,u,o]}}function N0(u,o){if(o.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(l=>typeof l!=typeof o[0])?["filter-in-large",u,["literal",o.sort(zI)]]:["filter-in-small",u,["literal",o]]}}function zS(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function qg(u){return["!",u]}const Cp="";function eh(u,o){return o?`${u}${Cp}${o}`:u}const F0="-transition",nu=new Set(["fill","line","background","hillshade","raster"]);class ma extends Nu{constructor(o,l,d,p,y){if(super(),this.id=o.id,this.fqid=eh(this.id,d),this.type=o.type,this.scope=d,this.lut=p,this.options=y,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,o.type!=="custom"){if(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type&&o.type!=="background"&&o.type!=="sky"&&o.type!=="slot"){this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter;const _=pd(this.filter,Ke[`filter_${o.type}`]);_.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,..._.value.configDependencies]))}if(o.slot&&(this.slot=o.slot),l.layout&&(this._unevaluatedLayout=new DI(l.layout,this.scope,y),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint){this._transitionablePaint=new MS(l.paint,this.scope,y);for(const _ in o.paint)this.setPaintProperty(_,o.paint[_]);for(const _ in o.layout)this.setLayoutProperty(_,o.layout[_]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ju(l.paint)}}}onAdd(o){}onRemove(o){}isDraped(o){return!this.is3D(!0)&&nu.has(this.type)}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,l){if(this.type==="custom"&&o==="visibility")return void(this.visibility=l);const d=this._unevaluatedLayout;d._properties.properties[o]&&(d.setValue(o,l),this.configDependencies=new Set([...this.configDependencies,...d.configDependencies]),o==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(o){return o.endsWith(F0)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,l){const d=this._transitionablePaint,p=d._properties.properties;if(o.endsWith(F0)){const D=o.slice(0,-11);return p[D]&&d.setTransition(D,l||void 0),!1}if(!p[o])return!1;const y=d._values[o],_=y.value.isDataDriven(),S=y.value;d.setValue(o,l),this.configDependencies=new Set([...this.configDependencies,...d.configDependencies]),this._handleSpecialPaintPropertyUpdate(o);const P=d._values[o].value,I=P.isDataDriven(),k=o.endsWith("pattern")||o==="line-dasharray";return I||_||k||this._handleOverridablePaintPropertyUpdate(o,S,P)}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getDefaultProgramParams(o,l,d){return null}_handleOverridablePaintPropertyUpdate(o,l,d){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,l)}serialize(){return qn({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}is3D(o){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const o in this.paint._values){const l=this.paint.get(o);if(l instanceof _d&&Lg(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(o){this._filterCompiled||(this._featureFilter=L0(this.filter,this.scope,o),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(o){this._stats&&(o.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(o){}queryIntersectsFeature(o,l,d,p,y,_,S,P,I){}}const NI={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ip{constructor(o,l){this._structArray=o,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class yi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,l){return o._trim(),l&&(o.isTransferred=!0,l.add(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const l=Object.create(this.prototype);return l.arrayBuffer=o.arrayBuffer,l.length=o.length,l.capacity=o.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...o){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...o){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function vr(u,o=1){let l=0,d=0;return{members:u.map(p=>{const y=NI[p.type].BYTES_PER_ELEMENT,_=l=B0(l,Math.max(o,y)),S=p.components||1;return d=Math.max(d,y),l+=y*S,{name:p.name,type:p.type,components:S,offset:_}}),size:B0(l,Math.max(d,o)),alignment:o}}function B0(u,o){return Math.ceil(u/o)*o}class oc extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.int16[p+0]=l,this.int16[p+1]=d,o}}oc.prototype.bytesPerElement=4,Zt(oc,"StructArrayLayout2i4");class Zg extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const y=3*o;return this.int16[y+0]=l,this.int16[y+1]=d,this.int16[y+2]=p,o}}Zg.prototype.bytesPerElement=6,Zt(Zg,"StructArrayLayout3i6");class th extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,d,p)}emplace(o,l,d,p,y){const _=4*o;return this.int16[_+0]=l,this.int16[_+1]=d,this.int16[_+2]=p,this.int16[_+3]=y,o}}th.prototype.bytesPerElement=8,Zt(th,"StructArrayLayout4i8");class xd extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.float32[1*o+0]=l,o}}xd.prototype.bytesPerElement=4,Zt(xd,"StructArrayLayout1f4");class Xg extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const y=4*o,_=2*o;return this.int16[y+0]=l,this.int16[y+1]=d,this.float32[_+1]=p,o}}Xg.prototype.bytesPerElement=8,Zt(Xg,"StructArrayLayout2i1f8");class bd extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const y=4*o;return this.int16[y+0]=l,this.int16[y+1]=d,this.int16[y+2]=p,o}}bd.prototype.bytesPerElement=8,Zt(bd,"StructArrayLayout3i8");class j0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p,y)}emplace(o,l,d,p,y,_){const S=5*o;return this.int16[S+0]=l,this.int16[S+1]=d,this.int16[S+2]=p,this.int16[S+3]=y,this.int16[S+4]=_,o}}j0.prototype.bytesPerElement=10,Zt(j0,"StructArrayLayout5i10");class $0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S){const P=this.length;return this.resize(P+1),this.emplace(P,o,l,d,p,y,_,S)}emplace(o,l,d,p,y,_,S,P){const I=6*o,k=12*o,D=3*o;return this.int16[I+0]=l,this.int16[I+1]=d,this.uint8[k+4]=p,this.uint8[k+5]=y,this.uint8[k+6]=_,this.uint8[k+7]=S,this.float32[D+2]=P,o}}$0.prototype.bytesPerElement=12,Zt($0,"StructArrayLayout2i4ub1f12");class Tl extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const y=3*o;return this.float32[y+0]=l,this.float32[y+1]=d,this.float32[y+2]=p,o}}Tl.prototype.bytesPerElement=12,Zt(Tl,"StructArrayLayout3f12");class ac extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p,y)}emplace(o,l,d,p,y,_){const S=6*o,P=3*o;return this.uint16[S+0]=l,this.uint16[S+1]=d,this.uint16[S+2]=p,this.uint16[S+3]=y,this.float32[P+2]=_,o}}ac.prototype.bytesPerElement=12,Zt(ac,"StructArrayLayout4ui1f12");class Kg extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,d,p)}emplace(o,l,d,p,y){const _=4*o;return this.uint16[_+0]=l,this.uint16[_+1]=d,this.uint16[_+2]=p,this.uint16[_+3]=y,o}}Kg.prototype.bytesPerElement=8,Zt(Kg,"StructArrayLayout4ui8");class nh extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_){const S=this.length;return this.resize(S+1),this.emplace(S,o,l,d,p,y,_)}emplace(o,l,d,p,y,_,S){const P=6*o;return this.int16[P+0]=l,this.int16[P+1]=d,this.int16[P+2]=p,this.int16[P+3]=y,this.int16[P+4]=_,this.int16[P+5]=S,o}}nh.prototype.bytesPerElement=12,Zt(nh,"StructArrayLayout6i12");class wd extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S,P,I,k,D,N){const W=this.length;return this.resize(W+1),this.emplace(W,o,l,d,p,y,_,S,P,I,k,D,N)}emplace(o,l,d,p,y,_,S,P,I,k,D,N,W){const q=12*o;return this.int16[q+0]=l,this.int16[q+1]=d,this.int16[q+2]=p,this.int16[q+3]=y,this.uint16[q+4]=_,this.uint16[q+5]=S,this.uint16[q+6]=P,this.uint16[q+7]=I,this.int16[q+8]=k,this.int16[q+9]=D,this.int16[q+10]=N,this.int16[q+11]=W,o}}wd.prototype.bytesPerElement=24,Zt(wd,"StructArrayLayout4i4ui4i24");class Ca extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_){const S=this.length;return this.resize(S+1),this.emplace(S,o,l,d,p,y,_)}emplace(o,l,d,p,y,_,S){const P=10*o,I=5*o;return this.int16[P+0]=l,this.int16[P+1]=d,this.int16[P+2]=p,this.float32[I+2]=y,this.float32[I+3]=_,this.float32[I+4]=S,o}}Ca.prototype.bytesPerElement=20,Zt(Ca,"StructArrayLayout3i3f20");class El extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,d,p)}emplace(o,l,d,p,y){const _=4*o;return this.float32[_+0]=l,this.float32[_+1]=d,this.float32[_+2]=p,this.float32[_+3]=y,o}}El.prototype.bytesPerElement=16,Zt(El,"StructArrayLayout4f16");class U0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint32[1*o+0]=l,o}}U0.prototype.bytesPerElement=4,Zt(U0,"StructArrayLayout1ul4");class ru extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.uint16[p+0]=l,this.uint16[p+1]=d,o}}ru.prototype.bytesPerElement=4,Zt(ru,"StructArrayLayout2ui4");class V0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S,P,I,k,D,N,W){const q=this.length;return this.resize(q+1),this.emplace(q,o,l,d,p,y,_,S,P,I,k,D,N,W)}emplace(o,l,d,p,y,_,S,P,I,k,D,N,W,q){const J=20*o,ie=10*o;return this.int16[J+0]=l,this.int16[J+1]=d,this.int16[J+2]=p,this.int16[J+3]=y,this.int16[J+4]=_,this.float32[ie+3]=S,this.float32[ie+4]=P,this.float32[ie+5]=I,this.float32[ie+6]=k,this.int16[J+14]=D,this.uint32[ie+8]=N,this.uint16[J+18]=W,this.uint16[J+19]=q,o}}V0.prototype.bytesPerElement=40,Zt(V0,"StructArrayLayout5i4f1i1ul2ui40");class Yg extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S){const P=this.length;return this.resize(P+1),this.emplace(P,o,l,d,p,y,_,S)}emplace(o,l,d,p,y,_,S,P){const I=8*o;return this.int16[I+0]=l,this.int16[I+1]=d,this.int16[I+2]=p,this.int16[I+4]=y,this.int16[I+5]=_,this.int16[I+6]=S,this.int16[I+7]=P,o}}Yg.prototype.bytesPerElement=16,Zt(Yg,"StructArrayLayout3i2i2i16");class Mp extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p,y)}emplace(o,l,d,p,y,_){const S=4*o,P=8*o;return this.float32[S+0]=l,this.float32[S+1]=d,this.float32[S+2]=p,this.int16[P+6]=y,this.int16[P+7]=_,o}}Mp.prototype.bytesPerElement=16,Zt(Mp,"StructArrayLayout2f1f2i16");class G0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_){const S=this.length;return this.resize(S+1),this.emplace(S,o,l,d,p,y,_)}emplace(o,l,d,p,y,_,S){const P=20*o,I=5*o;return this.uint8[P+0]=l,this.uint8[P+1]=d,this.float32[I+1]=p,this.float32[I+2]=y,this.float32[I+3]=_,this.float32[I+4]=S,o}}G0.prototype.bytesPerElement=20,Zt(G0,"StructArrayLayout2ub4f20");class bo extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const y=3*o;return this.uint16[y+0]=l,this.uint16[y+1]=d,this.uint16[y+2]=p,o}}bo.prototype.bytesPerElement=6,Zt(bo,"StructArrayLayout3ui6");class W0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae,me,de,Q,ue){const pe=this.length;return this.resize(pe+1),this.emplace(pe,o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae,me,de,Q,ue)}emplace(o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae,me,de,Q,ue,pe){const ve=30*o,Ie=15*o,De=60*o;return this.int16[ve+0]=l,this.int16[ve+1]=d,this.int16[ve+2]=p,this.float32[Ie+2]=y,this.float32[Ie+3]=_,this.uint16[ve+8]=S,this.uint16[ve+9]=P,this.uint32[Ie+5]=I,this.uint32[Ie+6]=k,this.uint32[Ie+7]=D,this.uint16[ve+16]=N,this.uint16[ve+17]=W,this.uint16[ve+18]=q,this.float32[Ie+10]=J,this.float32[Ie+11]=ie,this.uint8[De+48]=ae,this.uint8[De+49]=me,this.uint8[De+50]=de,this.uint32[Ie+13]=Q,this.int16[ve+28]=ue,this.uint8[De+58]=pe,o}}W0.prototype.bytesPerElement=60,Zt(W0,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class H0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae,me,de,Q,ue,pe,ve,Ie,De,Fe,He,ct,St,_t,bt,Pt,st){const xt=this.length;return this.resize(xt+1),this.emplace(xt,o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae,me,de,Q,ue,pe,ve,Ie,De,Fe,He,ct,St,_t,bt,Pt,st)}emplace(o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae,me,de,Q,ue,pe,ve,Ie,De,Fe,He,ct,St,_t,bt,Pt,st,xt){const nt=20*o,lt=40*o,It=80*o;return this.float32[nt+0]=l,this.float32[nt+1]=d,this.int16[lt+4]=p,this.int16[lt+5]=y,this.int16[lt+6]=_,this.int16[lt+7]=S,this.int16[lt+8]=P,this.int16[lt+9]=I,this.int16[lt+10]=k,this.int16[lt+11]=D,this.int16[lt+12]=N,this.uint16[lt+13]=W,this.uint16[lt+14]=q,this.uint16[lt+15]=J,this.uint16[lt+16]=ie,this.uint16[lt+17]=ae,this.uint16[lt+18]=me,this.uint16[lt+19]=de,this.uint16[lt+20]=Q,this.uint16[lt+21]=ue,this.uint16[lt+22]=pe,this.uint16[lt+23]=ve,this.uint16[lt+24]=Ie,this.uint16[lt+25]=De,this.uint16[lt+26]=Fe,this.uint16[lt+27]=He,this.uint32[nt+14]=ct,this.float32[nt+15]=St,this.float32[nt+16]=_t,this.float32[nt+17]=bt,this.float32[nt+18]=Pt,this.uint8[It+76]=st,this.uint16[lt+39]=xt,o}}H0.prototype.bytesPerElement=80,Zt(H0,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class iu extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p,y)}emplace(o,l,d,p,y,_){const S=5*o;return this.float32[S+0]=l,this.float32[S+1]=d,this.float32[S+2]=p,this.float32[S+3]=y,this.float32[S+4]=_,o}}iu.prototype.bytesPerElement=20,Zt(iu,"StructArrayLayout5f20");class Op extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S){const P=this.length;return this.resize(P+1),this.emplace(P,o,l,d,p,y,_,S)}emplace(o,l,d,p,y,_,S,P){const I=7*o;return this.float32[I+0]=l,this.float32[I+1]=d,this.float32[I+2]=p,this.float32[I+3]=y,this.float32[I+4]=_,this.float32[I+5]=S,this.float32[I+6]=P,o}}Op.prototype.bytesPerElement=28,Zt(Op,"StructArrayLayout7f28");class q0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S,P,I,k,D){const N=this.length;return this.resize(N+1),this.emplace(N,o,l,d,p,y,_,S,P,I,k,D)}emplace(o,l,d,p,y,_,S,P,I,k,D,N){const W=11*o;return this.float32[W+0]=l,this.float32[W+1]=d,this.float32[W+2]=p,this.float32[W+3]=y,this.float32[W+4]=_,this.float32[W+5]=S,this.float32[W+6]=P,this.float32[W+7]=I,this.float32[W+8]=k,this.float32[W+9]=D,this.float32[W+10]=N,o}}q0.prototype.bytesPerElement=44,Zt(q0,"StructArrayLayout11f44");class Jg extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S,P,I){const k=this.length;return this.resize(k+1),this.emplace(k,o,l,d,p,y,_,S,P,I)}emplace(o,l,d,p,y,_,S,P,I,k){const D=9*o;return this.float32[D+0]=l,this.float32[D+1]=d,this.float32[D+2]=p,this.float32[D+3]=y,this.float32[D+4]=_,this.float32[D+5]=S,this.float32[D+6]=P,this.float32[D+7]=I,this.float32[D+8]=k,o}}Jg.prototype.bytesPerElement=36,Zt(Jg,"StructArrayLayout9f36");class rh extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.float32[p+0]=l,this.float32[p+1]=d,o}}rh.prototype.bytesPerElement=8,Zt(rh,"StructArrayLayout2f8");class Z0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,d,p)}emplace(o,l,d,p,y){const _=6*o;return this.uint32[3*o+0]=l,this.uint16[_+2]=d,this.uint16[_+3]=p,this.uint16[_+4]=y,o}}Z0.prototype.bytesPerElement=12,Zt(Z0,"StructArrayLayout1ul3ui12");class kp extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint16[1*o+0]=l,o}}kp.prototype.bytesPerElement=2,Zt(kp,"StructArrayLayout1ui2");class Sd extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie){const ae=this.length;return this.resize(ae+1),this.emplace(ae,o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie)}emplace(o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae){const me=16*o;return this.float32[me+0]=l,this.float32[me+1]=d,this.float32[me+2]=p,this.float32[me+3]=y,this.float32[me+4]=_,this.float32[me+5]=S,this.float32[me+6]=P,this.float32[me+7]=I,this.float32[me+8]=k,this.float32[me+9]=D,this.float32[me+10]=N,this.float32[me+11]=W,this.float32[me+12]=q,this.float32[me+13]=J,this.float32[me+14]=ie,this.float32[me+15]=ae,o}}Sd.prototype.bytesPerElement=64,Zt(Sd,"StructArrayLayout16f64");class Rp extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,y,_,S){const P=this.length;return this.resize(P+1),this.emplace(P,o,l,d,p,y,_,S)}emplace(o,l,d,p,y,_,S,P){const I=10*o,k=5*o;return this.uint16[I+0]=l,this.uint16[I+1]=d,this.uint16[I+2]=p,this.uint16[I+3]=y,this.float32[k+2]=_,this.float32[k+3]=S,this.float32[k+4]=P,o}}Rp.prototype.bytesPerElement=20,Zt(Rp,"StructArrayLayout4ui3f20");class X0 extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.int16[1*o+0]=l,o}}X0.prototype.bytesPerElement=2,Zt(X0,"StructArrayLayout1i2");class Qg extends yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint8[1*o+0]=l,o}}Qg.prototype.bytesPerElement=1,Zt(Qg,"StructArrayLayout1ub1");class NS extends Ip{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}NS.prototype.size=40;class ey extends V0{get(o){return new NS(this,o)}}Zt(ey,"CollisionBoxArray");class FS extends Ip{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}FS.prototype.size=60;class BS extends W0{get(o){return new FS(this,o)}}Zt(BS,"PlacedSymbolArray");class jS extends Ip{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(o){this._structArray.uint32[this._pos4+14]=o}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(o){this._structArray.float32[this._pos4+18]=o}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}jS.prototype.size=80;class $S extends H0{get(o){return new jS(this,o)}}Zt($S,"SymbolInstanceArray");class K0 extends xd{getoffsetX(o){return this.float32[1*o+0]}}Zt(K0,"GlyphOffsetArray");class US extends oc{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}Zt(US,"SymbolLineVertexArray");class VS extends Ip{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}VS.prototype.size=12;class GS extends Z0{get(o){return new VS(this,o)}}Zt(GS,"FeatureIndexArray");class WS extends ru{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}Zt(WS,"FillExtrusionCentroidArray");class HS extends Ip{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}HS.prototype.size=6;class qS extends Zg{get(o){return new HS(this,o)}}Zt(qS,"FillExtrusionWallArray");const FI=vr([{name:"a_pos",components:2,type:"Int16"}],4),BI=vr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ti{constructor(o=[]){this.segments=o}_prepareSegment(o,l,d,p){let y=this.segments[this.segments.length-1];return o>Ti.MAX_VERTEX_ARRAY_LENGTH&&nr(`Max vertices per segment is ${Ti.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!y||y.vertexLength+o>Ti.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:l,primitiveOffset:d,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}prepareSegment(o,l,d,p){return this._prepareSegment(o,l.length,d.length,p)}get(){return this.segments}destroy(){for(const o of this.segments)for(const l in o.vaos)o.vaos[l].destroy()}static simpleSegment(o,l,d,p){return new Ti([{vertexOffset:o,primitiveOffset:l,vertexLength:d,primitiveLength:p,vaos:{},sortKey:0}])}}function ZS(u,o){return 256*(u=Ue(Math.floor(u),0,255))+Ue(Math.floor(o),0,255)}Ti.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zt(Ti,"SegmentVector");const jI=vr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Td=vr([{name:"a_pattern_b",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),$I=vr([{name:"a_dash",components:4,type:"Uint16"}]);class Ed{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(o,l,d,p){this.ids.push(XS(o)),this.positions.push(l,d,p)}eachPosition(o,l){const d=XS(o);let p=0,y=this.ids.length-1;for(;p<y;){const _=p+y>>1;this.ids[_]>=d?y=_:p=_+1}for(;this.ids[p]===d;)l(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(o,l){const d=new Float64Array(o.ids),p=new Uint32Array(o.positions);return ty(d,p,0,d.length-1),l&&(l.add(d.buffer),l.add(p.buffer)),{ids:d,positions:p}}static deserialize(o){const l=new Ed;let d;l.ids=o.ids,l.positions=o.positions;for(const p of l.ids)p!==d&&l.uniqueIds.push(p),d=p;return l.indexed=!0,l}}function XS(u){const o=+u;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:Ba(String(u))}function ty(u,o,l,d){for(;l<d;){const p=u[l+d>>1];let y=l-1,_=d+1;for(;;){do y++;while(u[y]<p);do _--;while(u[_]>p);if(y>=_)break;Dp(u,y,_),Dp(o,3*y,3*_),Dp(o,3*y+1,3*_+1),Dp(o,3*y+2,3*_+2)}_-l<d-_?(ty(u,o,l,_),l=_+1):(ty(u,o,_+1,d),d=_)}}function Dp(u,o,l){const d=u[o];u[o]=u[l],u[l]=d}Zt(Ed,"FeaturePositionMap");class Al{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,l),this.initialized=!0),!!this.location}set(o,l,d){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class ny extends Al{constructor(o){super(o),this.current=0}set(o,l,d){this.fetchUniformLocation(o,l)&&this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}}class Hi extends Al{constructor(o){super(o),this.current=0}set(o,l,d){this.fetchUniformLocation(o,l)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class tl extends Al{constructor(o){super(o),this.current=[0,0]}set(o,l,d){this.fetchUniformLocation(o,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1])))}}class Lp extends Al{constructor(o){super(o),this.current=[0,0,0]}set(o,l,d){this.fetchUniformLocation(o,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2])))}}class ry extends Al{constructor(o){super(o),this.current=[0,0,0,0]}set(o,l,d){this.fetchUniformLocation(o,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class KS extends Al{constructor(o){super(o),this.current=wr.transparent.toRenderColor(null)}set(o,l,d){this.fetchUniformLocation(o,l)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const UI=new Float32Array(16);class zp extends Al{constructor(o){super(o),this.current=UI}set(o,l,d){if(this.fetchUniformLocation(o,l)){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let p=1;p<16;p++)if(d[p]!==this.current[p]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}}}const YS=new Float32Array(9),Y0=new Float32Array(4);class Cs extends Al{constructor(o){super(o),this.current=Y0}set(o,l,d){if(this.fetchUniformLocation(o,l)){for(let p=0;p<4;p++)if(d[p]!==this.current[p]){this.current=d,this.gl.uniformMatrix2fv(this.location,!1,d);break}}}}function Np(u){return[ZS(255*u.r,255*u.g),ZS(255*u.b,255*u.a)]}class Fp{constructor(o,l,d,p){this.value=o,this.uniformNames=l.map(y=>`u_${y}`),this.type=d,this.context=p}setUniform(o,l,d,p,y){const _=p.constantOr(this.value);l.set(o,y,_ instanceof wr?_.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):_)}getBinding(o,l){return this.type==="color"?new KS(o):new Hi(o)}}class Ad{constructor(o,l){this.uniformNames=l.map(d=>`u_${d}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(o,l){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br),this.patternTransition=l?l.tl.concat(l.br):this.pattern}setUniform(o,l,d,p,y){let _=null;y!=="u_pattern"&&y!=="u_dash"||(_=this.pattern),y==="u_pattern_b"&&(_=this.patternTransition),y==="u_pixel_ratio"&&(_=this.pixelRatio),_&&l.set(o,y,_)}getBinding(o,l){return l==="u_pattern"||l==="u_pattern_b"||l==="u_dash"?new ry(o):new Hi(o)}}class sc{constructor(o,l,d,p){this.expression=o,this.type=d,this.maxValue=0,this.paintVertexAttributes=l.map(y=>({name:`a_${y}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(o,l,d,p,y,_,S){const P=this.paintVertexArray.length,I=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new zr(0,{brightness:_}),l,{},y,p,S):this.expression.kind==="constant"&&this.expression.value,k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new zr(0,{brightness:_}),l,{},y,p,S):this.lutExpression.value)==="none";this.paintVertexArray.resize(o),this._setPaintValue(P,o,I,k?null:this.context.lut)}updatePaintArray(o,l,d,p,y,_,S){const P=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:S},d,p,void 0,y):this.expression.kind==="constant"&&this.expression.value,I=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new zr(0,{brightness:S}),d,p,void 0,y):this.lutExpression.value)==="none";this._setPaintValue(o,l,P,I?null:this.context.lut)}_setPaintValue(o,l,d,p){if(this.type==="color"){const y=Np(d.toRenderColor(p));for(let _=o;_<l;_++)this.paintVertexArray.emplace(_,y[0],y[1])}else{for(let y=o;y<l;y++)this.paintVertexArray.emplace(y,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class nl{constructor(o,l,d,p,y,_){this.expression=o,this.uniformNames=l.map(S=>`u_${S}_t`),this.type=d,this.useIntegerZoom=p,this.context=y,this.maxValue=0,this.paintVertexAttributes=l.map(S=>({name:`a_${S}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(o,l,d,p,y,_,S){const P=this.expression.evaluate(new zr(this.context.zoom,{brightness:_}),l,{},y,p,S),I=this.expression.evaluate(new zr(this.context.zoom+1,{brightness:_}),l,{},y,p,S),k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new zr(0,{brightness:_}),l,{},y,p,S):this.lutExpression.value)==="none",D=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(D,o,P,I,k?null:this.context.lut)}updatePaintArray(o,l,d,p,y,_,S){const P=this.expression.evaluate({zoom:this.context.zoom,brightness:S},d,p,void 0,y),I=this.expression.evaluate({zoom:this.context.zoom+1,brightness:S},d,p,void 0,y),k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new zr(0,{brightness:S}),d,p,void 0,y):this.lutExpression.value)==="none";this._setPaintValue(o,l,P,I,k?null:this.context.lut)}_setPaintValue(o,l,d,p,y){if(this.type==="color"){const _=Np(d.toRenderColor(y)),S=Np(d.toRenderColor(y));for(let P=o;P<l;P++)this.paintVertexArray.emplace(P,_[0],_[1],S[0],S[1])}else{for(let _=o;_<l;_++)this.paintVertexArray.emplace(_,d,p);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(p))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,l,d,p,y){const _=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,S=Ue(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);l.set(o,y,S)}getBinding(o,l){return new Hi(o)}}class rl{constructor(o,l,d,p,y){this.expression=o,this.layerId=y,this.paintVertexAttributes=(d==="array"?$I:jI).members;for(let _=0;_<l.length;++_);this.paintVertexArray=new p,this.paintTransitionVertexArray=new ac}populatePaintArray(o,l,d,p){const y=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(y,o,l.patterns&&l.patterns[this.layerId],d)}updatePaintArray(o,l,d,p,y,_,S){this._setPaintValues(o,l,d.patterns&&d.patterns[this.layerId],_)}_setPaintValues(o,l,d,p){if(!p||!d)return;const y=p[d[0]],_=p[d[1]];if(y){if(y){const{tl:S,br:P,pixelRatio:I}=y;for(let k=o;k<l;k++)this.paintVertexArray.emplace(k,S[0],S[1],P[0],P[1],I)}if(_){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:S,br:P,pixelRatio:I}=_;for(let k=o;k<l;k++)this.paintTransitionVertexArray.emplace(k,S[0],S[1],P[0],P[1],I)}}}upload(o){const l=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,l)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=o.createVertexBuffer(this.paintTransitionVertexArray,Td.members,l))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class ou{constructor(o,l,d=()=>!0){this.binders={},this._buffers=[],this.context=l;const p=[];for(const y in o.paint._values){const _=o.paint.get(y);if(y.endsWith("-use-theme")||!d(y)||!(_ instanceof _d&&Lg(_.property.specification)))continue;const S=s(y,o.type),P=_.value,I=_.property.specification.type,k=!!_.property.useIntegerZoom,D=y==="line-dasharray"||y.endsWith("pattern"),N=o.paint.get(`${y}-use-theme`),W=y==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant"||N&&N.value.kind!=="constant";if(P.kind!=="constant"||W)if(P.kind==="source"||W||D){const q=x(y,I,"source");this.binders[y]=D?new rl(P,S,I,q,o.id):new sc(P,S,I,q),p.push(`/a_${y}`)}else{const q=x(y,I,"composite");this.binders[y]=new nl(P,S,I,k,l,q),p.push(`/z_${y}`)}else this.binders[y]=D?new Ad(P.value,S):new Fp(P.value,S,I,l),p.push(`/u_${y}`);N&&(this.binders[y].lutExpression=N.value)}this.cacheKey=p.sort().join("")}getMaxValue(o){const l=this.binders[o];return l instanceof sc||l instanceof nl?l.maxValue:0}populatePaintArrays(o,l,d,p,y,_,S){for(const P in this.binders){const I=this.binders[P];I.context=this.context,(I instanceof sc||I instanceof nl||I instanceof rl)&&I.populatePaintArray(o,l,d,p,y,_,S)}}setConstantPatternPositions(o,l){for(const d in this.binders){const p=this.binders[d];p instanceof Ad&&p.setConstantPatternPositions(o,l)}}getPatternTransitionVertexBuffer(o){const l=this.binders[o];return l instanceof rl?l.paintTransitionVertexBuffer:null}updatePaintArrays(o,l,d,p,y,_,S,P,I){let k=!1;const D=Object.keys(o),N=D.length!==0&&!P,W=N?D:l.uniqueIds;this.context.lut=y.lut;for(const q in this.binders){const J=this.binders[q];if(J.context=this.context,(J instanceof sc||J instanceof nl||J instanceof rl)&&J.expression&&J.expression.kind&&J.expression.kind!=="constant"&&(J.expression.isStateDependent===!0||J.expression.isLightConstant===!1)){const ie=y.paint.get(q);J.expression=ie.value;for(const ae of W){const me=o[ae.toString()];l.eachPosition(ae,(de,Q,ue)=>{const pe=p.feature(de);J.updatePaintArray(Q,ue,pe,me,_,S,I)})}if(!N)for(const ae of d.uniqueIds){const me=o[ae.toString()];d.eachPosition(ae,(de,Q,ue)=>{const pe=p.feature(de);J.updatePaintArray(Q,ue,pe,me,_,S,I)})}k=!0}}return k}defines(){const o=[];for(const l in this.binders){const d=this.binders[l];(d instanceof Fp||d instanceof Ad)&&o.push(...d.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return o}getBinderAttributes(){const o=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof sc||d instanceof nl||d instanceof rl)for(let p=0;p<d.paintVertexAttributes.length;p++)o.push(d.paintVertexAttributes[p].name);if(d instanceof rl)for(let p=0;p<Td.members.length;p++)o.push(Td.members[p].name)}return o}getBinderUniforms(){const o=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof Fp||d instanceof Ad||d instanceof nl)for(const p of d.uniformNames)o.push(p)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const l=[];for(const d in this.binders){const p=this.binders[d];if(p instanceof Fp||p instanceof Ad||p instanceof nl)for(const y of p.uniformNames)l.push({name:y,property:d,binding:p.getBinding(o,y)})}return l}setUniforms(o,l,d,p,y){for(const{name:_,property:S,binding:P}of d)this.binders[S].setUniform(o,P,y,p.get(S),_)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const l=this.binders[o];(l instanceof sc||l instanceof nl||l instanceof rl)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer),l instanceof rl&&l.paintTransitionVertexBuffer&&this._buffers.push(l.paintTransitionVertexBuffer)}}upload(o){for(const l in this.binders){const d=this.binders[l];(d instanceof sc||d instanceof nl||d instanceof rl)&&d.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const l=this.binders[o];(l instanceof sc||l instanceof nl||l instanceof rl)&&l.destroy()}}}class ih{constructor(o,l,d=()=>!0){this.programConfigurations={};for(const p of o)this.programConfigurations[p.id]=new ou(p,l,d);this.needsUpload=!1,this._featureMap=new Ed,this._featureMapWithoutIds=new Ed,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(o,l,d,p,y,_,S,P){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(o,l,p,y,_,S,P);l.id!==void 0?this._featureMap.add(l.id,d,this._bufferOffset,o):(this._featureMapWithoutIds.add(this._idlessCounter,d,this._bufferOffset,o),this._idlessCounter+=1),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,l,d,p,y,_,S){for(const P of d)this.needsUpload=this.programConfigurations[P.id].updatePaintArrays(o,this._featureMap,this._featureMapWithoutIds,l,P,p,y,_,S||0)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const m={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"]};function s(u,o){return m[u]||[u.replace(`${o}-`,"").replace(/-/g,"_")]}const h={"line-pattern":{source:ac,composite:ac},"fill-pattern":{source:ac,composite:ac},"fill-extrusion-pattern":{source:ac,composite:ac},"line-dasharray":{source:Kg,composite:Kg}},g={color:{source:rh,composite:El},number:{source:xd,composite:rh}};function x(u,o,l){const d=h[u];return d&&d[l]||g[o][l]}Zt(Fp,"ConstantBinder"),Zt(Ad,"PatternConstantBinder"),Zt(sc,"SourceExpressionBinder"),Zt(rl,"PatternCompositeBinder"),Zt(nl,"CompositeExpressionBinder"),Zt(ou,"ProgramConfiguration",{omit:["_buffers"]}),Zt(ih,"ProgramConfigurationSet");const w=jt/Math.PI/2,E=5,C=6,O=16383,z=64,F=[z,32,16],G=-w,U=w;function Z(u,o,l,d=w){return l=ne(l),[u*Math.sin(l)*d,-o*d,u*Math.cos(l)*d]}function te(u,o,l){return Z(Math.cos(ne(u)),Math.sin(ne(u)),o,l)}const ee=63710088e-1,oe=2*Math.PI*ee;class re{constructor(o,l){if(isNaN(o)||isNaN(l))throw new Error(`Invalid LngLat object: (${o}, ${l})`);if(this.lng=+o,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new re(rt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const l=Math.PI/180,d=this.lat*l,p=o.lat*l,y=Math.sin(d)*Math.sin(p)+Math.cos(d)*Math.cos(p)*Math.cos((o.lng-this.lng)*l);return ee*Math.acos(Math.min(y,1))}toBounds(o=0){const l=360*o/40075017,d=l/Math.cos(Math.PI/180*this.lat);return new fe({lng:this.lng-d,lat:this.lat-l},{lng:this.lng+d,lat:this.lat+l})}toEcef(o){return te(this.lat,this.lng,w+o*w/ee)}static convert(o){if(o instanceof re)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new re(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new re(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class fe{constructor(o,l){if(o)if(l)this.setSouthWest(o).setNorthEast(l);else if(o.length===4){const d=o;this.setSouthWest([d[0],d[1]]).setNorthEast([d[2],d[3]])}else{const d=o;this.setSouthWest(d[0]).setNorthEast(d[1])}}setNorthEast(o){return this._ne=o instanceof re?new re(o.lng,o.lat):re.convert(o),this}setSouthWest(o){return this._sw=o instanceof re?new re(o.lng,o.lat):re.convert(o),this}extend(o){const l=this._sw,d=this._ne;let p,y;if(o instanceof re)p=o,y=o;else{if(!(o instanceof fe))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(fe.convert(o)):this.extend(re.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(re.convert(o)):this;if(p=o._sw,y=o._ne,!p||!y)return this}return l||d?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),d.lng=Math.max(y.lng,d.lng),d.lat=Math.max(y.lat,d.lat)):(this._sw=new re(p.lng,p.lat),this._ne=new re(y.lng,y.lat)),this}getCenter(){return new re((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new re(this.getWest(),this.getNorth())}getSouthEast(){return new re(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:l,lat:d}=re.convert(o);let p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&p}static convert(o){if(o)return o instanceof fe?o:new fe(o)}}const _e=0,be=25.5;function Pe(u){return oe*Math.cos(u*Math.PI/180)}function Ee(u){return(180+u)/360}function Ae(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function we(u,o){return u/Pe(o)}function Me(u){return 360*u-180}function ke(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function Qe(u,o){return u*Pe(ke(o))}const qe=85.051129;function mt(u){return Math.cos(ne(Ue(u,-qe,qe)))}function dt(u,o){const l=Ue(o,_e,be),d=Math.pow(2,l);return mt(u)*oe/(512*d)}function Ot(u){return 1/Math.cos(u*Math.PI/180)}function Ze(u,o=0){const l=Math.exp(Math.PI*(1-(u.y+o/jt)/(1<<u.z)*2));return 80150034*l/(l*l+1)/jt/(1<<u.z)}class et{constructor(o,l,d=0){this.x=+o,this.y=+l,this.z=+d}static fromLngLat(o,l=0){const d=re.convert(o);return new et(Ee(d.lng),Ae(d.lat),we(l,d.lat))}toLngLat(){return new re(Me(this.x),ke(this.y))}toAltitude(){return Qe(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/oe*Ot(ke(this.y))}}function We(u,o,l,d,p,y,_,S,P){const I=(o+d)/2,k=(l+p)/2,D=new yt(I,k);S(D),function(N,W,q,J,ie,ae){const me=q-ie,de=J-ae;return Math.abs((J-W)*me-(q-N)*de)/Math.hypot(me,de)}(D.x,D.y,y.x,y.y,_.x,_.y)>=P?(We(u,o,l,I,k,y,D,S,P),We(u,I,k,d,p,D,_,S,P)):u.push(_)}function vt(u,o,l){let d=u[0],p=d.x,y=d.y;o(d);const _=[d];for(let S=1;S<u.length;S++){const P=u[S],{x:I,y:k}=P;o(P),We(_,p,y,I,k,d,P,o,l),p=I,y=k,d=P}return _}function at(u,o,l,d){if(d(o,l)){const p=o.add(l)._mult(.5);at(u,o,p,d),at(u,p,l,d)}else u.push(l)}function Tt(u,o){let l=u[0];const d=[l];for(let p=1;p<u.length;p++){const y=u[p];at(d,l,y,o),l=y}return d}const gt=Math.pow(2,14)-1,Et=-gt-1;function At(u,o){const l=Math.round(u.x*o),d=Math.round(u.y*o);return u.x=Ue(l,Et,gt),u.y=Ue(d,Et,gt),(l<u.x||l>u.x+1||d<u.y||d>u.y+1)&&nr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function Yt(u,o,l){const d=u.loadGeometry(),p=u.extent,y=jt/p;if(o&&l&&l.projection.isReprojectedInTileSpace){const _=1<<o.z,{scale:S,x:P,y:I,projection:k}=l,D=N=>{const W=Me((o.x+N.x/p)/_),q=ke((o.y+N.y/p)/_),J=k.project(W,q);N.x=(J.x*S-P)*p,N.y=(J.y*S-I)*p};for(let N=0;N<d.length;N++)if(u.type!==1)d[N]=vt(d[N],D,1);else{const W=[];for(const q of d[N])q.x<0||q.x>=p||q.y<0||q.y>=p||(D(q),W.push(q));d[N]=W}}for(const _ of d)for(const S of _)At(S,y);return d}function an(u,o){return{type:u.type,id:u.id,properties:u.properties,geometry:o?Yt(u):[]}}function Xt(u,o,l,d,p){u.emplaceBack(2*o+(d+1)/2,2*l+(p+1)/2)}function ln(u,o,l){u.emplaceBack(o.x,o.y,o.z,l[0]*16384,l[1]*16384,l[2]*16384)}class Qt{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new oc,this.indexArray=new bo,this.segments=new Ti,this.programConfigurations=new ih(o.layers,{zoom:o.zoom,lut:o.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}updateFootprints(o,l){}populate(o,l,d,p){const y=this.layers[0],_=[];let S=null;y.type==="circle"&&(S=y.layout.get("circle-sort-key"));for(const{feature:I,id:k,index:D,sourceLayerIndex:N}of o){const W=this.layers[0]._featureFilter.needGeometry,q=an(I,W);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),q,d))continue;const J=S?S.evaluate(q,{},d):void 0,ie={id:k,properties:I.properties,type:I.type,sourceLayerIndex:N,index:D,geometry:W?q.geometry:Yt(I,d,p),patterns:{},sortKey:J};_.push(ie)}S&&_.sort((I,k)=>I.sortKey-k.sortKey);let P=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new nh,P=p.projection);for(const I of _){const{geometry:k,index:D,sourceLayerIndex:N}=I,W=o[D].feature;this.addFeature(I,k,D,l.availableImages,d,P,l.brightness),l.featureIndex.insert(W,k,D,N,this.index)}}update(o,l,d,p,y,_,S){this.programConfigurations.updatePaintArrays(o,l,y,d,p,_,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,FI.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,BI.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,l,d,p,y,_,S){for(const P of l)for(const I of P){const k=I.x,D=I.y;if(k<0||k>=jt||D<0||D>=jt)continue;if(_){const q=_.projectTilePoint(k,D,y),J=_.upVector(y,k,D),ie=this.globeExtVertexArray;ln(ie,q,J),ln(ie,q,J),ln(ie,q,J),ln(ie,q,J)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),W=N.vertexLength;Xt(this.layoutVertexArray,k,D,-1,-1),Xt(this.layoutVertexArray,k,D,1,-1),Xt(this.layoutVertexArray,k,D,1,1),Xt(this.layoutVertexArray,k,D,-1,1),this.indexArray.emplaceBack(W,W+1,W+2),this.indexArray.emplaceBack(W,W+2,W+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,{},p,y,S)}}function Sn(u,o){for(let l=0;l<u.length;l++)if(Fr(o,u[l]))return!0;for(let l=0;l<o.length;l++)if(Fr(u,o[l]))return!0;return!!kr(u,o)}function Rn(u,o,l){return!!Fr(u,o)||!!Fn(o,u,l)}function tr(u,o){if(u.length===1)return yr(o,u[0]);for(let l=0;l<o.length;l++){const d=o[l];for(let p=0;p<d.length;p++)if(Fr(u,d[p]))return!0}for(let l=0;l<u.length;l++)if(yr(o,u[l]))return!0;for(let l=0;l<o.length;l++)if(kr(u,o[l]))return!0;return!1}function Nr(u,o,l){if(u.length>1){if(kr(u,o))return!0;for(let d=0;d<o.length;d++)if(Fn(o[d],u,l))return!0}for(let d=0;d<u.length;d++)if(Fn(u[d],o,l))return!0;return!1}function kr(u,o){if(u.length===0||o.length===0)return!1;for(let l=0;l<u.length-1;l++){const d=u[l],p=u[l+1];for(let y=0;y<o.length-1;y++)if(rr(d,p,o[y],o[y+1]))return!0}return!1}function rr(u,o,l,d){return Zr(u,l,d)!==Zr(o,l,d)&&Zr(u,o,l)!==Zr(u,o,d)}function Oi(u,o,l){return(u.x-l.x)*(o.y-l.y)-(u.y-l.y)*(o.x-l.x)}function wi(u,o,l,d){const p=Oi(u,o,d),y=Oi(u,o,l);if(Math.sign(p)===Math.sign(y))return;const _=Oi(l,d,u),S=_+y-p;return Math.sign(_)!==Math.sign(S)?[_/(_-S),y/(y-p)]:void 0}function Fn(u,o,l){const d=l*l;if(o.length===1)return u.distSqr(o[0])<d;for(let p=1;p<o.length;p++)if(hr(u,o[p-1],o[p])<d)return!0;return!1}function hr(u,o,l){const d=o.distSqr(l);if(d===0)return u.distSqr(o);const p=((u.x-o.x)*(l.x-o.x)+(u.y-o.y)*(l.y-o.y))/d;return u.distSqr(p<0?o:p>1?l:l.sub(o)._mult(p)._add(o))}function yr(u,o){let l,d,p,y=!1;for(let _=0;_<u.length;_++){l=u[_];for(let S=0,P=l.length-1;S<l.length;P=S++)d=l[S],p=l[P],d.y>o.y!=p.y>o.y&&o.x<(p.x-d.x)*(o.y-d.y)/(p.y-d.y)+d.x&&(y=!y)}return y}function Fr(u,o){let l=!1;for(let d=0,p=u.length-1;d<u.length;p=d++){const y=u[d],_=u[p];y.y>o.y!=_.y>o.y&&o.x<(_.x-y.x)*(o.y-y.y)/(_.y-y.y)+y.x&&(l=!l)}return l}function Xi(u,o,l,d,p){for(const _ of u)if(o<=_.x&&l<=_.y&&d>=_.x&&p>=_.y)return!0;const y=[new yt(o,l),new yt(o,p),new yt(d,p),new yt(d,l)];if(u.length>2){for(const _ of y)if(Fr(u,_))return!0}for(let _=0;_<u.length-1;_++)if(Li(u[_],u[_+1],y))return!0;return!1}function Li(u,o,l){const d=l[0],p=l[2];if(u.x<d.x&&o.x<d.x||u.x>p.x&&o.x>p.x||u.y<d.y&&o.y<d.y||u.y>p.y&&o.y>p.y)return!1;const y=Zr(u,o,l[0]);return y!==Zr(u,o,l[1])||y!==Zr(u,o,l[2])||y!==Zr(u,o,l[3])}function qi(u,o,l,d,p,y){let _=o.y-u.y,S=u.x-o.x;if(y=y||0){const P=_*_+S*S;if(P===0)return!0;const I=Math.sqrt(P);_/=I,S/=I}return!((l.x-u.x)*_+(l.y-u.y)*S-y<0||(d.x-u.x)*_+(d.y-u.y)*S-y<0||(p.x-u.x)*_+(p.y-u.y)*S-y<0)}function _i(u,o,l,d,p,y,_){return!(qi(u,o,d,p,y,_)||qi(o,l,d,p,y,_)||qi(l,u,d,p,y,_)||qi(d,p,u,o,l,_)||qi(p,y,u,o,l,_)||qi(y,d,u,o,l,_))}function Vn(u,o,l){const d=o.paint.get(u).value;return d.kind==="constant"?d.value:l.programConfigurations.get(o.id).getMaxValue(u)}function fi(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function mr(u,o,l,d,p){if(!o[0]&&!o[1])return u;const y=yt.convert(o)._mult(p);l==="viewport"&&y._rotate(-d);const _=[];for(let S=0;S<u.length;S++)_.push(u[S].sub(y));return _}function pi(u,o,l,d){const p=yt.convert(u)._mult(d);return o==="viewport"&&p._rotate(-l),p}let Sr,vi;function wo(u,o,l){var d=2*Math.PI*6378137/256/Math.pow(2,l);return[u*d-2*Math.PI*6378137/2,o*d-2*Math.PI*6378137/2]}Zt(Qt,"CircleBucket",{omit:["layers"]});class ri{constructor(o,l,d){this.z=o,this.x=l,this.y=d,this.key=No(0,o,o,l,d)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,l){const d=function(y,_,S){var P=wo(256*y,256*(_=Math.pow(2,S)-_-1),S),I=wo(256*(y+1),256*(_+1),S);return P[0]+","+P[1]+","+I[0]+","+I[1]}(this.x,this.y,this.z),p=function(y,_,S){let P,I="";for(let k=y;k>0;k--)P=1<<k-1,I+=(_&P?1:0)+(S&P?2:0);return I}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Mo{constructor(o,l){this.wrap=o,this.canonical=l,this.key=No(o,l.z,l.z,l.x,l.y)}}class Ui{constructor(o,l,d,p,y){this.overscaledZ=o,this.wrap=l,this.canonical=new ri(d,+p,+y),this.key=l===0&&o===d?this.canonical.key:No(l,o,d,p,y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const l=this.canonical.z-o;return o>this.canonical.z?new Ui(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ui(o,this.wrap,o,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(o,l=!0){if(this.overscaledZ===o&&l)return this.key;if(o>this.canonical.z)return No(this.wrap*+l,o,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-o;return No(this.wrap*+l,o,o,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const l=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.z<this.canonical.z&&o.canonical.x===this.canonical.x>>l&&o.canonical.y===this.canonical.y>>l}children(o){if(this.overscaledZ>=o)return[new Ui(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,d=2*this.canonical.x,p=2*this.canonical.y;return[new Ui(l,this.wrap,l,d,p),new Ui(l,this.wrap,l,d+1,p),new Ui(l,this.wrap,l,d,p+1),new Ui(l,this.wrap,l,d+1,p+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new Ui(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new Ui(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Mo(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function No(u,o,l,d,p){const y=1<<Math.min(l,22);let _=y*(p%y)+d%y;return u&&l<22&&(_+=y*y*((u<0?-2*u-1:2*u)%(1<<2*(22-l)))),16*(32*_+l)+(o-l)}const il=[u=>{let o=u.canonical.x-1,l=u.wrap;return o<0&&(o=(1<<u.canonical.z)-1,l--),new Ui(u.overscaledZ,l,u.canonical.z,o,u.canonical.y)},u=>{let o=u.canonical.x+1,l=u.wrap;return o===1<<u.canonical.z&&(o=0,l++),new Ui(u.overscaledZ,l,u.canonical.z,o,u.canonical.y)},u=>new Ui(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new Ui(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];Zt(ri,"CanonicalTileID"),Zt(Ui,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const lc=vr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ua}=lc,Is=vr([{name:"a_pos_3",components:3,type:"Int16"}]);var Pl=vr([{name:"a_pos",type:"Int16",components:2}]);class Cl{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,d){const p=di(l,this.dir);if(Math.abs(p)<1e-6)return!1;const y=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1])/p;return d[0]=this.pos[0]+this.dir[0]*y,d[1]=this.pos[1]+this.dir[1]*y,!0}}class ol{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,d){const p=Cn(l,this.dir);if(Math.abs(p)<1e-6)return!1;const y=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1]+(o[2]-this.pos[2])*l[2])/p;return d[0]=this.pos[0]+this.dir[0]*y,d[1]=this.pos[1]+this.dir[1]*y,d[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(o,l,d){if(function(W,q){var J=W[0],ie=W[1],ae=W[2],me=q[0],de=q[1],Q=q[2];return Math.abs(J-me)<=v*Math.max(1,Math.abs(J),Math.abs(me))&&Math.abs(ie-de)<=v*Math.max(1,Math.abs(ie),Math.abs(de))&&Math.abs(ae-Q)<=v*Math.max(1,Math.abs(ae),Math.abs(Q))}(this.pos,o)||l===0)return d[0]=d[1]=d[2]=0,!1;const[p,y,_]=this.dir,S=this.pos[0]-o[0],P=this.pos[1]-o[1],I=this.pos[2]-o[2],k=p*p+y*y+_*_,D=2*(S*p+P*y+I*_),N=D*D-4*k*(S*S+P*P+I*I-l*l);if(N<0){const W=Math.max(-D/2,0),q=S+p*W,J=P+y*W,ie=I+_*W,ae=Math.hypot(q,J,ie);return d[0]=q*l/ae,d[1]=J*l/ae,d[2]=ie*l/ae,!1}{const W=(-D-Math.sqrt(N))/(2*k);if(W<0){const q=Math.hypot(S,P,I);return d[0]=S*l/q,d[1]=P*l/q,d[2]=I*l/q,!1}return d[0]=S+p*W,d[1]=P+y*W,d[2]=I+_*W,!0}}}class Pd{constructor(o,l,d,p,y){this.TL=o,this.TR=l,this.BR=d,this.BL=p,this.horizon=y}static fromInvProjectionMatrix(o,l,d){const p=[-1,1,1],y=[1,1,1],_=[1,-1,1],S=[-1,-1,1],P=Nt(p,p,o),I=Nt(y,y,o),k=Nt(_,_,o),D=Nt(S,S,o);return new Pd(P,I,k,D,l/d)}}function oh(u,o,l){let d=1/0,p=-1/0;const y=[];for(const _ of u){zn(y,_,o);const S=Cn(y,l);d=Math.min(d,S),p=Math.max(p,S)}return[d,p]}function iy(u,o){let l=!0;for(let d=0;d<u.planes.length;d++){const p=u.planes[d];let y=0;for(let _=0;_<o.length;_++)y+=Cn(p,o[_])+p[3]>=0;if(y===0)return 0;y!==o.length&&(l=!1)}return l?2:1}function oy(u,o){for(const l of u.projections){const d=oh(o,u.points[0],l.axis);if(l.projection[1]<d[0]||l.projection[0]>d[1])return 0}return 1}function ay(u,o){let l=0;const d=[0,0,0,0];for(let _=0;_<u.length;_++)d[0]=u[_][0],d[1]=u[_][1],d[2]=u[_][2],d[3]=1,(p=d)[0]*(y=o)[0]+p[1]*y[1]+p[2]*y[2]+p[3]*y[3]>=0&&l++;var p,y;return l}class Bp{constructor(o,l){this.points=o||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=mi.fromPoints(this.points),this.projections=[],this.frustumEdges=[zn([],this.points[2],this.points[3]),zn([],this.points[0],this.points[3]),zn([],this.points[4],this.points[0]),zn([],this.points[5],this.points[1]),zn([],this.points[6],this.points[2]),zn([],this.points[7],this.points[3])];for(const d of this.frustumEdges){const p=[0,-d[2],d[1]],y=[d[2],0,-d[0]];this.projections.push({axis:p,projection:oh(this.points,this.points[0],p)}),this.projections.push({axis:y,projection:oh(this.points,this.points[0],y)})}}static fromInvProjectionMatrix(o,l,d,p){const y=Math.pow(2,d),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const k=wt([],I,o),D=1/k[3]/l*y;return(N=k)[0]=(W=k)[0]*(q=[D,D,p?1/k[3]:D,D])[0],N[1]=W[1]*q[1],N[2]=W[2]*q[2],N[3]=W[3]*q[3],N;var N,W,q}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const k=fn([],Vt([],zn([],_[I[0]],_[I[1]]),zn([],_[I[2]],_[I[1]]))),D=-Cn(k,_[I[1]]);return k.concat(D)}),P=[];for(let I=0;I<_.length;I++)P.push([_[I][0],_[I][1],_[I][2]]);return new Bp(P,S)}intersectsPrecise(o,l,d){for(let p=0;p<l.length;p++)if(!ay(o,l[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!ay(o,this.planes[p]))return 0;for(const p of d)for(const y of this.frustumEdges){const _=Vt([],p,y),S=$e(_);if(S===0)continue;pt(_,_,1/S);const P=oh(this.points,this.points[0],_),I=oh(o,this.points[0],_);if(P[0]>I[1]||I[0]>P[1])return 0}return 1}containsPoint(o){for(const l of this.planes){const d=l[3];if(Cn([l[0],l[1],l[2]],o)+d<0)return!1}return!0}}class mi{static fromPoints(o){const l=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const p of o)Ne(l,l,p),Xe(d,d,p);return new mi(l,d)}static fromTileIdAndHeight(o,l,d){const p=1<<o.canonical.z,y=o.canonical.x,_=o.canonical.y;return new mi([y/p,_/p,l],[(y+1)/p,(_+1)/p,d])}static applyTransform(o,l){const d=o.getCorners();for(let p=0;p<d.length;++p)Nt(d[p],d[p],l);return mi.fromPoints(d)}static applyTransformFast(o,l){const d=[l[12],l[13],l[14]],p=[...d];for(let y=0;y<3;y++)for(let _=0;_<3;_++){const S=l[4*_+y],P=S*o.min[_],I=S*o.max[_];d[y]+=Math.min(P,I),p[y]+=Math.max(P,I)}return new mi(d,p)}static projectAabbCorners(o,l){const d=o.getCorners();for(let p=0;p<d.length;++p)Nt(d[p],d[p],l);return d}constructor(o,l){this.min=o,this.max=l,this.center=pt([],ht([],this.min,this.max),.5)}quadrant(o){const l=[o%2==0,o<2],d=Re(this.min),p=Re(this.max);for(let y=0;y<l.length;y++)d[y]=l[y]?this.min[y]:this.center[y],p[y]=l[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new mi(d,p)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,l=this.max;return[[o[0],o[1],o[2]],[l[0],o[1],o[2]],[l[0],l[1],o[2]],[o[0],l[1],o[2]],[o[0],o[1],l[2]],[l[0],o[1],l[2]],[l[0],l[1],l[2]],[o[0],l[1],l[2]]]}intersects(o){return this.intersectsAabb(o.bounds)?iy(o,this.getCorners()):0}intersectsFlat(o){return this.intersectsAabb(o.bounds)?iy(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(o,l){return l||this.intersects(o)?oy(o,this.getCorners()):0}intersectsPreciseFlat(o,l){return l||this.intersectsFlat(o)?oy(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(o){for(let l=0;l<3;++l)if(this.min[l]>o.max[l]||o.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(o){return!(this.min[0]>o.max[0]||o.min[0]>this.max[0]||this.min[1]>o.max[1]||o.min[1]>this.max[1])}encapsulate(o){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],o.min[l]),this.max[l]=Math.max(this.max[l],o.max[l])}encapsulatePoint(o){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],o[l]),this.max[l]=Math.max(this.max[l],o[l])}closestPoint(o){return[Math.max(Math.min(this.max[0],o[0]),this.min[0]),Math.max(Math.min(this.max[1],o[1]),this.min[1]),Math.max(Math.min(this.max[2],o[2]),this.min[2])]}}function Cd(u){return u*w/ee}Zt(mi,"Aabb");const J0=[new mi([G,G,G],[U,U,U]),new mi([G,G,G],[0,0,U]),new mi([0,G,G],[U,0,U]),new mi([G,0,G],[0,U,U]),new mi([0,0,G],[U,U,U])];function BF(u,o,l,d=!0){const p=pt([],u._camera.position,u.worldSize),y=[o,l,1,1];wt(y,y,u.pixelMatrixInverse),Pi(y,y,1/y[3]);const _=fn([],zn([],y,p)),S=u.globeMatrix,P=[S[12],S[13],S[14]],I=zn([],P,p),k=$e(I),D=fn([],I),N=u.worldSize/(2*Math.PI),W=Cn(D,_),q=Math.asin(N/k);if(q<Math.acos(W)){if(!d)return null;const Fe=[],He=[];pt(Fe,_,k/W),fn(He,zn(He,Fe,I)),fn(_,ht(_,I,pt(_,He,Math.tan(q)*k)))}const J=[];new ol(p,_).closestPointOnSphere(P,N,J);const ie=fn([],xo(S,0)),ae=fn([],xo(S,1)),me=fn([],xo(S,2)),de=Cn(ie,J),Q=Cn(ae,J),ue=Cn(me,J),pe=le(Math.asin(-Q/N));let ve=le(Math.atan2(de,ue));ve=u.center.lng+function(Fe,He){const ct=(He-Fe+180)%360-180;return ct<-180?ct+360:ct}(u.center.lng,ve);const Ie=Ee(ve),De=Ue(Ae(pe),0,1);return new et(Ie,De)}class Ene{constructor(o,l,d){this.a=zn([],o,d),this.b=zn([],l,d),this.center=d;const p=fn([],this.a),y=fn([],this.b);this.angle=Math.acos(Cn(p,y))}}function VI(u,o){if(u.angle===0)return null;let l;return l=u.a[o]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[o]/u.a[o]/Math.sin(u.angle)-1/Math.tan(u.angle)),l<0||l>1?null:function(d,p,y,_){const S=Math.sin(y);return d*(Math.sin((1-_)*y)/S)+p*(Math.sin(_*y)/S)}(u.a[o],u.b[o],u.angle,Ue(l,0,1))+u.center[o]}function au(u){if(u.z<=1)return J0[u.z+2*u.y+u.x];const o=GI(JS(u));return mi.fromPoints(o)}function ah(u,o,l){return pt(u,u,1-l),zt(u,u,o,l)}function jF(u,o,l){for(const d of u)Nt(d,d,o),pt(d,d,l)}function $F(u,o,l,d){const p=o/u.worldSize,y=u.globeMatrix;if(l.z<=1){const De=au(l).getCorners();return jF(De,y,p),mi.fromPoints(De)}const _=JS(l,d),S=GI(_,w+Cd(u._tileCoverLift));jF(S,y,p);const P=Number.MAX_VALUE,I=[-P,-P,-P],k=[P,P,P];if(_.contains(u.center)){for(const He of S)Ne(k,k,He),Xe(I,I,He);I[2]=0;const De=u.point,Fe=[De.x*p,De.y*p,0];return Ne(k,k,Fe),Xe(I,I,Fe),new mi(k,I)}if(u._tileCoverLift>0){for(const De of S)Ne(k,k,De),Xe(I,I,De);return new mi(k,I)}const D=[y[12]*p,y[13]*p,y[14]*p],N=_.getCenter(),W=Ue(u.center.lat,-qe,qe),q=Ue(N.lat,-qe,qe),J=Ee(u.center.lng),ie=Ae(W);let ae=J-Ee(N.lng);const me=ie-Ae(q);ae>.5?ae-=1:ae<-.5&&(ae+=1);let de=0;Math.abs(ae)>Math.abs(me)?de=ae>=0?1:3:(de=me>=0?0:2,zt(D,D,[y[4]*p,y[5]*p,y[6]*p],-Math.sin(ne(me>=0?_.getSouth():_.getNorth()))*w));const Q=S[de],ue=S[(de+1)%4],pe=new Ene(Q,ue,D),ve=[VI(pe,0)||Q[0],VI(pe,1)||Q[1],VI(pe,2)||Q[2]],Ie=Id(u.zoom);if(Ie>0){const De=function({x:He,y:ct,z:St},_t,bt,Pt,st){const xt=1/(1<<St);let nt=He*xt,lt=nt+xt,It=ct*xt,Mt=It+xt,on=0;const Kt=(nt+lt)/2-Pt;return Kt>.5?on=-1:Kt<-.5&&(on=1),nt=((nt+on)*_t-(Pt*=_t))*bt+Pt,lt=((lt+on)*_t-Pt)*bt+Pt,It=(It*_t-(st*=_t))*bt+st,Mt=(Mt*_t-st)*bt+st,[[nt,Mt,0],[lt,Mt,0],[lt,It,0],[nt,It,0]]}(l,o,u._pixelsPerMercatorPixel,J,ie);for(let He=0;He<S.length;He++)ah(S[He],De[He],Ie);const Fe=ht([],De[de],De[(de+1)%4]);pt(Fe,Fe,.5),ah(ve,Fe,Ie)}for(const De of S)Ne(k,k,De),Xe(I,I,De);return k[2]=Math.min(Q[2],ue[2]),Ne(k,k,ve),Xe(I,I,ve),new mi(k,I)}function JS({x:u,y:o,z:l},d=!1){const p=1/(1<<l),y=new re(Me(u*p),o===(1<<l)-1&&d?-90:ke((o+1)*p)),_=new re(Me((u+1)*p),o===0&&d?90:ke(o*p));return new fe(y,_)}function GI(u,o=w){const l=ne(u.getNorth()),d=ne(u.getSouth()),p=Math.cos(l),y=Math.cos(d),_=Math.sin(l),S=Math.sin(d),P=u.getWest(),I=u.getEast();return[Z(y,S,P,o),Z(y,S,I,o),Z(p,_,I,o),Z(p,_,P,o)]}function Q0(u,o,l,d){const p=1<<l.z,y=(u/jt+l.x)/p;return te(ke((o/jt+l.y)/p),Me(y),d)}function QS({min:u,max:o}){return O/Math.max(o[0]-u[0],o[1]-u[1],o[2]-u[2])}const UF=new Float64Array(16);function eT(u){const o=QS(u),l=ce(UF,[o,o,o]);return $(l,l,Tn([],u.min))}function WI(u){const o=(d=u.min,(l=UF)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=d[0],l[13]=d[1],l[14]=d[2],l[15]=1,l);var l,d;const p=1/QS(u);return H(o,o,[p,p,p])}function HI(u){const o=jt/(2*Math.PI);return u/(2*Math.PI)/o}function VF(u,o){return jt/(512*Math.pow(2,u))*QS(au(o))}function GF(u,o,l,d,p){const y=HI(l),_=[u,o,-l/(2*Math.PI)],S=L(new Float64Array(16));return $(S,S,_),H(S,S,[y,y,y]),K(S,S,ne(-p)),Y(S,S,ne(-d)),S}function Id(u){return Ve(E,C,u)}function WF(u,o){const l=te(o.lat,o.lng),d=function(q){const J=te(q._center.lat,q._center.lng);let ie=Vt([],Ge(0,1,0),J);const ae=ye([],-q.angle,J);ie=Nt(ie,ie,ae),ye(ae,-q._pitch,ie);const me=fn([],J);return pt(me,me,Cd(q.cameraToCenterDistance/q.pixelsPerMeter)),Nt(me,me,ae),ht([],J,me)}(u);return _=(p=ot([],d,l))[0],S=p[1],P=p[2],I=(y=l)[0],k=y[1],D=y[2],W=(N=Math.sqrt(_*_+S*S+P*P)*Math.sqrt(I*I+k*k+D*D))&&Cn(p,y)/N,Math.acos(Math.min(Math.max(W,-1),1));var p,y,_,S,P,I,k,D,N,W}function qI(u,o){return WF(u,o)>Math.PI/2*1.01}const HF=ne(85),Ane=Math.cos(HF),Pne=Math.sin(HF),Cne=B(),qF=u=>{const o=[];return u.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o};function ZF(u,o,l,d,p,y,_,S,P){if(y&&u.queryGeometry.isAboveHorizon)return!1;y&&(P*=u.pixelToTileUnitsFactor);const I=u.tileID.canonical,k=l.projection.upVectorScale(I,l.center.lat,l.worldSize).metersToTile;for(const D of o)for(const N of D){const W=N.add(S),q=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(W.x,W.y,!0):0,J=l.projection.projectTilePoint(W.x,W.y,I);if(q>0){const de=l.projection.upVector(I,W.x,W.y);J.x+=de[0]*k*q,J.y+=de[1]*k*q,J.z+=de[2]*k*q}const ie=y?W:Ine(J.x,J.y,J.z,d),ae=y?u.tilespaceRays.map(de=>One(de,q)):u.queryGeometry.screenGeometry,me=wt([],[J.x,J.y,J.z,1],d);if(!_&&y?P*=me[3]/l.cameraToCenterDistance:_&&!y&&(P*=l.cameraToCenterDistance/me[3]),y){const de=ke((N.y/jt+I.y)/(1<<I.z));P/=l.projection.pixelsPerMeter(de,1)/we(1,de)}if(Rn(ae,ie,P))return!0}return!1}function Ine(u,o,l,d){const p=wt([],[u,o,l,1],d);return new yt(p[0]/p[3],p[1]/p[3])}const XF=Ge(0,0,0),Mne=Ge(0,0,1);function One(u,o){const l=je();return XF[2]=o,u.intersectsPlane(XF,Mne,l),new yt(l[0],l[1])}class KF extends Qt{}let YF,JF,QF,eB;function tB(u,{width:o,height:l},d,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==o*l*d)throw new RangeError("mismatched image size")}else p=new Uint8Array(o*l*d);return u.width=o,u.height=l,u.data=p,u}function nB(u,o,l){const{width:d,height:p}=o;d===u.width&&p===u.height||(ZI(u,o,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,d),height:Math.min(u.height,p)},l,null),u.width=d,u.height=p,u.data=o.data)}function ZI(u,o,l,d,p,y,_,S){if(p.width===0||p.height===0)return o;if(p.width>u.width||p.height>u.height||l.x>u.width-p.width||l.y>u.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>o.width||p.height>o.height||d.x>o.width-p.width||d.y>o.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const P=u.data,I=o.data,k=y===4&&S;for(let D=0;D<p.height;D++){const N=((l.y+D)*u.width+l.x)*y,W=((d.y+D)*o.width+d.x)*y;if(k)for(let q=0;q<p.width;q++){const J=N+q*y+3,ie=W+q*y;I[ie+0]=255,I[ie+1]=255,I[ie+2]=255,I[ie+3]=P[J]}else if(_)for(let q=0;q<p.width;q++){const J=N+q*y,ie=W+q*y,ae=P[J+3],me=new wr(P[J+0]/255*ae,P[J+1]/255*ae,P[J+2]/255*ae,ae).toRenderColor(_).toArray();I[ie+0]=me[0],I[ie+1]=me[1],I[ie+2]=me[2],I[ie+3]=me[3]}else for(let q=0;q<p.width*y;q++)I[W+q]=P[N+q]}return o}Zt(KF,"HeatmapBucket",{omit:["layers"]});class Md{constructor(o,l){tB(this,o,1,l)}resize(o){nB(this,new Md(o),1)}clone(){return new Md({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,d,p,y){ZI(o,l,d,p,y,1,null)}}class Go{constructor(o,l){tB(this,o,4,l)}resize(o){nB(this,new Go(o),4)}replace(o,l){l?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Go({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,d,p,y,_,S){ZI(o,l,d,p,y,4,_,S)}}class rB{constructor(o,l){this.width=o.width,this.height=o.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function ex(u){const o={},l=u.resolution||256,d=u.clips?u.clips.length:1,p=u.image||new Go({width:l,height:d}),y=(_,S,P)=>{o[u.evaluationKey]=P;const I=u.expression.evaluate(o);I&&(p.data[_+S+0]=Math.floor(255*I.r/I.a),p.data[_+S+1]=Math.floor(255*I.g/I.a),p.data[_+S+2]=Math.floor(255*I.b/I.a),p.data[_+S+3]=Math.floor(255*I.a))};if(u.clips)for(let _=0,S=0;_<d;++_,S+=4*l)for(let P=0,I=0;P<l;P++,I+=4){const k=P/(l-1),{start:D,end:N}=u.clips[_];y(S,I,D*(1-k)+N*k)}else for(let _=0,S=0;_<l;_++,S+=4)y(0,S,_/(l-1));return p}Zt(Md,"AlphaImage"),Zt(Go,"RGBAImage");const kne=vr([{name:"a_pos",components:2,type:"Int16"}],4),Rne=vr([{name:"a_road_z_offset",components:1,type:"Float32"}],4),Dne=vr([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),Lne=vr([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function tx(u,o,l=2){const d=o&&o.length,p=d?o[0]*l:u.length;let y=iB(u,0,p,l,!0);const _=[];if(!y||y.next===y.prev)return _;let S,P,I;if(d&&(y=function(k,D,N,W){const q=[];for(let J=0,ie=D.length;J<ie;J++){const ae=iB(k,D[J]*W,J<ie-1?D[J+1]*W:k.length,W,!1);ae===ae.next&&(ae.steiner=!0),q.push(Vne(ae))}q.sort(jne);for(let J=0;J<q.length;J++)N=$ne(q[J],N);return N}(u,o,y,l)),u.length>80*l){S=1/0,P=1/0;let k=-1/0,D=-1/0;for(let N=l;N<p;N+=l){const W=u[N],q=u[N+1];W<S&&(S=W),q<P&&(P=q),W>k&&(k=W),q>D&&(D=q)}I=Math.max(k-S,D-P),I=I!==0?32767/I:0}return nx(y,_,l,S,P,I,0),_}function iB(u,o,l,d,p){let y;if(p===function(_,S,P,I){let k=0;for(let D=S,N=P-I;D<P;D+=I)k+=(_[N]-_[D])*(_[D+1]+_[N+1]),N=D;return k}(u,o,l,d)>0)for(let _=o;_<l;_+=d)y=lB(_/d|0,u[_],u[_+1],y);else for(let _=l-d;_>=o;_-=d)y=lB(_/d|0,u[_],u[_+1],y);return y&&sy(y,y.next)&&(ox(y),y=y.next),y}function jp(u,o){if(!u)return u;o||(o=u);let l,d=u;do if(l=!1,d.steiner||!sy(d,d.next)&&So(d.prev,d,d.next)!==0)d=d.next;else{if(ox(d),d=o=d.prev,d===d.next)break;l=!0}while(l||d!==o);return o}function nx(u,o,l,d,p,y,_){if(!u)return;!_&&y&&function(P,I,k,D){let N=P;do N.z===0&&(N.z=XI(N.x,N.y,I,k,D)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==P);N.prevZ.nextZ=null,N.prevZ=null,function(W){let q,J=1;do{let ie,ae=W;W=null;let me=null;for(q=0;ae;){q++;let de=ae,Q=0;for(let pe=0;pe<J&&(Q++,de=de.nextZ,de);pe++);let ue=J;for(;Q>0||ue>0&&de;)Q!==0&&(ue===0||!de||ae.z<=de.z)?(ie=ae,ae=ae.nextZ,Q--):(ie=de,de=de.nextZ,ue--),me?me.nextZ=ie:W=ie,ie.prevZ=me,me=ie;ae=de}me.nextZ=null,J*=2}while(q>1)}(N)}(u,d,p,y);let S=u;for(;u.prev!==u.next;){const P=u.prev,I=u.next;if(y?Nne(u,d,p,y):zne(u))o.push(P.i,u.i,I.i),ox(u),u=I.next,S=I.next;else if((u=I)===S){_?_===1?nx(u=Fne(jp(u),o),o,l,d,p,y,2):_===2&&Bne(u,o,l,d,p,y):nx(jp(u),o,l,d,p,y,1);break}}}function zne(u){const o=u.prev,l=u,d=u.next;if(So(o,l,d)>=0)return!1;const p=o.x,y=l.x,_=d.x,S=o.y,P=l.y,I=d.y,k=Math.min(p,y,_),D=Math.min(S,P,I),N=Math.max(p,y,_),W=Math.max(S,P,I);let q=d.next;for(;q!==o;){if(q.x>=k&&q.x<=N&&q.y>=D&&q.y<=W&&rx(p,S,y,P,_,I,q.x,q.y)&&So(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function Nne(u,o,l,d){const p=u.prev,y=u,_=u.next;if(So(p,y,_)>=0)return!1;const S=p.x,P=y.x,I=_.x,k=p.y,D=y.y,N=_.y,W=Math.min(S,P,I),q=Math.min(k,D,N),J=Math.max(S,P,I),ie=Math.max(k,D,N),ae=XI(W,q,o,l,d),me=XI(J,ie,o,l,d);let de=u.prevZ,Q=u.nextZ;for(;de&&de.z>=ae&&Q&&Q.z<=me;){if(de.x>=W&&de.x<=J&&de.y>=q&&de.y<=ie&&de!==p&&de!==_&&rx(S,k,P,D,I,N,de.x,de.y)&&So(de.prev,de,de.next)>=0||(de=de.prevZ,Q.x>=W&&Q.x<=J&&Q.y>=q&&Q.y<=ie&&Q!==p&&Q!==_&&rx(S,k,P,D,I,N,Q.x,Q.y)&&So(Q.prev,Q,Q.next)>=0))return!1;Q=Q.nextZ}for(;de&&de.z>=ae;){if(de.x>=W&&de.x<=J&&de.y>=q&&de.y<=ie&&de!==p&&de!==_&&rx(S,k,P,D,I,N,de.x,de.y)&&So(de.prev,de,de.next)>=0)return!1;de=de.prevZ}for(;Q&&Q.z<=me;){if(Q.x>=W&&Q.x<=J&&Q.y>=q&&Q.y<=ie&&Q!==p&&Q!==_&&rx(S,k,P,D,I,N,Q.x,Q.y)&&So(Q.prev,Q,Q.next)>=0)return!1;Q=Q.nextZ}return!0}function Fne(u,o){let l=u;do{const d=l.prev,p=l.next.next;!sy(d,p)&&aB(d,l,l.next,p)&&ix(d,p)&&ix(p,d)&&(o.push(d.i,l.i,p.i),ox(l),ox(l.next),l=u=p),l=l.next}while(l!==u);return jp(l)}function Bne(u,o,l,d,p,y){let _=u;do{let S=_.next.next;for(;S!==_.prev;){if(_.i!==S.i&&Gne(_,S)){let P=sB(_,S);return _=jp(_,_.next),P=jp(P,P.next),nx(_,o,l,d,p,y,0),void nx(P,o,l,d,p,y,0)}S=S.next}_=_.next}while(_!==u)}function jne(u,o){let l=u.x-o.x;return l===0&&(l=u.y-o.y,l===0)&&(l=(u.next.y-u.y)/(u.next.x-u.x)-(o.next.y-o.y)/(o.next.x-o.x)),l}function $ne(u,o){const l=function(p,y){let _=y;const S=p.x,P=p.y;let I,k=-1/0;if(sy(p,_))return _;do{if(sy(p,_.next))return _.next;if(P<=_.y&&P>=_.next.y&&_.next.y!==_.y){const J=_.x+(P-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(J<=S&&J>k&&(k=J,I=_.x<_.next.x?_:_.next,J===S))return I}_=_.next}while(_!==y);if(!I)return null;const D=I,N=I.x,W=I.y;let q=1/0;_=I;do{if(S>=_.x&&_.x>=N&&S!==_.x&&oB(P<W?S:k,P,N,W,P<W?k:S,P,_.x,_.y)){const J=Math.abs(P-_.y)/(S-_.x);ix(_,p)&&(J<q||J===q&&(_.x>I.x||_.x===I.x&&Une(I,_)))&&(I=_,q=J)}_=_.next}while(_!==D);return I}(u,o);if(!l)return o;const d=sB(l,u);return jp(d,d.next),jp(l,l.next)}function Une(u,o){return So(u.prev,u,o.prev)<0&&So(o.next,u,u.next)<0}function XI(u,o,l,d,p){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-l)*p|0)|u<<8))|u<<4))|u<<2))|u<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-d)*p|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Vne(u){let o=u,l=u;do(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next;while(o!==u);return l}function oB(u,o,l,d,p,y,_,S){return(p-_)*(o-S)>=(u-_)*(y-S)&&(u-_)*(d-S)>=(l-_)*(o-S)&&(l-_)*(y-S)>=(p-_)*(d-S)}function rx(u,o,l,d,p,y,_,S){return!(u===_&&o===S)&&oB(u,o,l,d,p,y,_,S)}function Gne(u,o){return u.next.i!==o.i&&u.prev.i!==o.i&&!function(l,d){let p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==d.i&&p.next.i!==d.i&&aB(p,p.next,l,d))return!0;p=p.next}while(p!==l);return!1}(u,o)&&(ix(u,o)&&ix(o,u)&&function(l,d){let p=l,y=!1;const _=(l.x+d.x)/2,S=(l.y+d.y)/2;do p.y>S!=p.next.y>S&&p.next.y!==p.y&&_<(p.next.x-p.x)*(S-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==l);return y}(u,o)&&(So(u.prev,u,o.prev)||So(u,o.prev,o))||sy(u,o)&&So(u.prev,u,u.next)>0&&So(o.prev,o,o.next)>0)}function So(u,o,l){return(o.y-u.y)*(l.x-o.x)-(o.x-u.x)*(l.y-o.y)}function sy(u,o){return u.x===o.x&&u.y===o.y}function aB(u,o,l,d){const p=nT(So(u,o,l)),y=nT(So(u,o,d)),_=nT(So(l,d,u)),S=nT(So(l,d,o));return p!==y&&_!==S||!(p!==0||!tT(u,l,o))||!(y!==0||!tT(u,d,o))||!(_!==0||!tT(l,u,d))||!(S!==0||!tT(l,o,d))}function tT(u,o,l){return o.x<=Math.max(u.x,l.x)&&o.x>=Math.min(u.x,l.x)&&o.y<=Math.max(u.y,l.y)&&o.y>=Math.min(u.y,l.y)}function nT(u){return u>0?1:u<0?-1:0}function ix(u,o){return So(u.prev,u,u.next)<0?So(u,o,u.next)>=0&&So(u,u.prev,o)>=0:So(u,o,u.prev)<0||So(u,u.next,o)<0}function sB(u,o){const l=KI(u.i,u.x,u.y),d=KI(o.i,o.x,o.y),p=u.next,y=o.prev;return u.next=o,o.prev=u,l.next=p,p.prev=l,d.next=l,l.prev=d,y.next=d,d.prev=y,d}function lB(u,o,l,d){const p=KI(u,o,l);return d?(p.next=d.next,p.prev=d,d.next.prev=p,d.next=p):(p.prev=p,p.next=p),p}function ox(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function KI(u,o,l){return{i:u,x:o,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function rT(u,o){const l=u.length;if(l<=1)return[u];const d=[];let p,y;for(let _=0;_<l;_++){const S=_r(u[_]);S!==0&&(u[_].area=Math.abs(S),y===void 0&&(y=S<0),y===S<0?(p&&d.push(p),p=[u[_]]):p.push(u[_]))}if(p&&d.push(p),o>1)for(let _=0;_<d.length;_++)d[_].length<=o||(qc(d[_],o,1,d[_].length-1,Wne),d[_]=d[_].slice(0,o));return d}function Wne(u,o){return o.area-u.area}function cB(u,o,l=1){if(!u)return null;const d=typeof u=="string"?Aa.from(u).getPrimary():u.getPrimary(),p=typeof u=="string"?null:u.getSecondary();for(const y of[d,p]){if(!y)continue;const _=y.id.toString();o.has(_)||o.set(_,[]),y.scaleSelf(l),o.get(_).push(y)}return{primary:d.toString(),secondary:p?p.toString():null}}function YI(u,o,l,d){const p=d.patternDependencies;let y=!1;for(const _ of o){const S=_.paint.get(`${u}-pattern`);S.isConstant()||(y=!0),cB(S.constantOr(null),p,l)&&(y=!0)}return y}function JI(u,o,l,d,p,y){const _=y.patternDependencies;for(const S of o){const P=S.paint.get(`${u}-pattern`).value;if(P.kind!=="constant"){let I=P.evaluate({zoom:d},l,{},y.availableImages);I=I&&I.name?I.name:I;const k=cB(I,_,p);if(!k)continue;const{primary:D,secondary:N}=k;D&&(l.patterns[S.id]=[D,N].filter(Boolean))}}return l}var QI,uB,eM,hB,tM,dB,fB,iT={};function pB(){if(uB)return QI;uB=1;var u=ku();function o(p,y,_,S,P){this.properties={},this.extent=_,this.type=0,this._pbf=p,this._geometry=-1,this._keys=S,this._values=P,p.readFields(l,this,y)}function l(p,y,_){p==1?y.id=_.readVarint():p==2?function(S,P){for(var I=S.readVarint()+S.pos;S.pos<I;){var k=P._keys[S.readVarint()],D=P._values[S.readVarint()];P.properties[k]=D}}(_,y):p==3?y.type=_.readVarint():p==4&&(y._geometry=_.pos)}function d(p){for(var y,_,S=0,P=0,I=p.length,k=I-1;P<I;k=P++)S+=((_=p[k]).x-(y=p[P]).x)*(y.y+_.y);return S}return QI=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var y,_=p.readVarint()+p.pos,S=1,P=0,I=0,k=0,D=[];p.pos<_;){if(P<=0){var N=p.readVarint();S=7&N,P=N>>3}if(P--,S===1||S===2)I+=p.readSVarint(),k+=p.readSVarint(),S===1&&(y&&D.push(y),y=[]),y.push(new u(I,k));else{if(S!==7)throw new Error("unknown command "+S);y&&y.push(y[0].clone())}}return y&&D.push(y),D},o.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var y=p.readVarint()+p.pos,_=1,S=0,P=0,I=0,k=1/0,D=-1/0,N=1/0,W=-1/0;p.pos<y;){if(S<=0){var q=p.readVarint();_=7&q,S=q>>3}if(S--,_===1||_===2)(P+=p.readSVarint())<k&&(k=P),P>D&&(D=P),(I+=p.readSVarint())<N&&(N=I),I>W&&(W=I);else if(_!==7)throw new Error("unknown command "+_)}return[k,N,D,W]},o.prototype.toGeoJSON=function(p,y,_){var S,P,I=this.extent*Math.pow(2,_),k=this.extent*p,D=this.extent*y,N=this.loadGeometry(),W=o.types[this.type];function q(ae){for(var me=0;me<ae.length;me++){var de=ae[me];ae[me]=[360*(de.x+k)/I-180,360/Math.PI*Math.atan(Math.exp((180-360*(de.y+D)/I)*Math.PI/180))-90]}}switch(this.type){case 1:var J=[];for(S=0;S<N.length;S++)J[S]=N[S][0];q(N=J);break;case 2:for(S=0;S<N.length;S++)q(N[S]);break;case 3:for(N=function(ae){var me=ae.length;if(me<=1)return[ae];for(var de,Q,ue=[],pe=0;pe<me;pe++){var ve=d(ae[pe]);ve!==0&&(Q===void 0&&(Q=ve<0),Q===ve<0?(de&&ue.push(de),de=[ae[pe]]):de.push(ae[pe]))}return de&&ue.push(de),ue}(N),S=0;S<N.length;S++)for(P=0;P<N[S].length;P++)q(N[S][P])}N.length===1?N=N[0]:W="Multi"+W;var ie={type:"Feature",geometry:{type:W,coordinates:N},properties:this.properties};return"id"in this&&(ie.id=this.id),ie},QI}function mB(){if(hB)return eM;hB=1;var u=pB();function o(d,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(l,this,p),this.length=this._features.length}function l(d,p,y){d===15?p.version=y.readVarint():d===1?p.name=y.readString():d===5?p.extent=y.readVarint():d===2?p._features.push(y.pos):d===3?p._keys.push(y.readString()):d===4&&p._values.push(function(_){for(var S=null,P=_.readVarint()+_.pos;_.pos<P;){var I=_.readVarint()>>3;S=I===1?_.readString():I===2?_.readFloat():I===3?_.readDouble():I===4?_.readVarint64():I===5?_.readVarint():I===6?_.readSVarint():I===7?_.readBoolean():null}return S}(y))}return eM=o,o.prototype.feature=function(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];var p=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,p,this.extent,this._keys,this._values)},eM}function gB(){return fB||(fB=1,iT.VectorTile=function(){if(dB)return tM;dB=1;var u=mB();function o(l,d,p){if(l===3){var y=new u(p,p.readVarint()+p.pos);y.length&&(d[y.name]=y)}}return tM=function(l,d){this.layers=l.readFields(o,{},d)},tM}(),iT.VectorTileFeature=pB(),iT.VectorTileLayer=mB()),iT}var Od=gB();const $p="3d_elevation_id",yB="level";class Hne{constructor(){this._valid=!1}reset(o){return this.feature=o,this._valid=!0,this._geometry=o.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(o,l){return this._valid&&o(l(this._geometry)),this}require(o,l,d){return this.get(o,!0,l,d)}optional(o,l,d){return this.get(o,!1,l,d)}success(){return this._valid}get(o,l,d,p){const y=this.feature.properties.hasOwnProperty(o)?+this.feature.properties[o]:void 0;return this._valid&&y!==void 0&&!Number.isNaN(y)?d(p?p(y):y):l&&(this._valid=!1),this}}class _B{constructor(o,l){this.featureFunc=o,this.vertexFunc=l}parseFeature(o,l,d){return this.featureFunc(o,l,d)}parseVertex(o,l,d){return this.vertexFunc(o,l,d)}}const qne=new _B((u,o,l)=>u.reset(o).require($p,d=>{l.id=d}).optional("fixed_height_relative",d=>{l.constantHeight=d},Up.decodeRelativeHeight).geometry(d=>{l.bounds=d},n0).success(),(u,o,l)=>u.reset(o).require($p,d=>{l.id=d}).require("elevation_idx",d=>{l.idx=d}).require("extent",d=>{l.extent=d}).require("height_relative",d=>{l.height=d},Up.decodeRelativeHeight).geometry(d=>{l.position=d},Up.getPoint).success()),Zne=new _B((u,o,l)=>u.reset(o).require($p,d=>{l.id=d}).optional("fixed_height",d=>{l.constantHeight=d},Up.decodeMetricHeight).geometry(d=>{l.bounds=d},n0).success(),(u,o,l)=>u.reset(o).require($p,d=>{l.id=d}).require("elevation_idx",d=>{l.idx=d}).require("extent",d=>{l.extent=d}).require("height",d=>{l.height=d},Up.decodeMetricHeight).geometry(d=>{l.position=d},Up.getPoint).success());class Up{static getPoint(o){return ws(o[0][0].x,o[0][0].y)}static decodeRelativeHeight(o){return 1e-4*o*5}static decodeMetricHeight(o){return 1e-4*o}static parse(o){const l=[],d=[],p=o.length,y=new Hne;for(let S=0;S<p;S++){const P=o.feature(S),I=P.properties.hasOwnProperty("version")?String(P.properties.version):void 0,k=(_=I)?_==="1.0.1"?Zne:void 0:qne;if(k===void 0){nr(`Unknown elevation feature version number ${I||"(unknown)"}`);continue}const D=P.properties.hasOwnProperty("type")?P.properties.type:void 0;if(D){if(Od.VectorTileFeature.types[P.type]==="Point"&&D==="curve_point"){const N={};k.parseVertex(y,P,N)&&l.push(N)}else if(Od.VectorTileFeature.types[P.type]==="Polygon"&&D==="curve_meta"){const N={};k.parseFeature(y,P,N)&&d.push(N)}}}var _;return{vertices:l,features:d}}}class vB{constructor(o,l){this.feature=o,this.metersToTile=l,this.index=0}get(){const o=this.feature.vertices[this.index],l=this.feature.vertexProps[this.index].dir,d=l[1],p=-l[0],y=(o.extent+1)*this.metersToTile;return[new yt(Math.trunc(o.position[0]+d*y),Math.trunc(o.position[1]+p*y)),new yt(Math.trunc(o.position[0]-d*y),Math.trunc(o.position[1]-p*y))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class nM{constructor(o,l,d,p,y,_){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=o,this.heightRange={min:d,max:d},this.safeArea=l,this.constantHeight=d,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=y,this.edges=this.edges.filter(S=>{return S.a<this.vertices.length&&S.b<this.vertices.length&&!((P=this.vertices[S.a].position)[0]===(I=this.vertices[S.b].position)[0]&&P[1]===I[1]);var P,I}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const S of this.vertices)this.vertexProps.push({dir:ws(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,S.height),this.heightRange.max=Math.max(this.heightRange.max,S.height);for(const S of this.edges){const P=this.vertices[S.a].position,I=this.vertices[S.b].position,k=Lo(vo(),I,P),D=za(k),N=ns(vo(),k,1/D);this.edgeProps.push({vec:k,dir:N,len:D});const W=this.vertexProps[S.a].dir,q=this.vertexProps[S.b].dir;Ta(W,W,N),Ta(q,q,N)}for(const S of this.vertexProps)S.dir[0]===0&&S.dir[1]===0||Ou(S.dir,S.dir);this.tessellate(_)}}pointElevation(o){if(this.constantHeight!=null)return this.constantHeight;const l=this.getClosestEdge(o);if(l==null)return 0;const[d,p]=l;return((y,_,S)=>(1-S)*y+S*_)(this.vertices[this.edges[d].a].height,this.vertices[this.edges[d].b].height,p)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(o){if(this.edges.length===0)return;let l=0,d=Number.POSITIVE_INFINITY,p=0;const y=ws(o.x,o.y);for(let _=0;_<this.edges.length;_++){const S=this.edges[_],P=this.edgeProps[_].dir,I=new Cl(y,this.edgeProps[_].dir),k=this.vertices[S.a].position,D=this.vertices[S.b].position,N=vo(),W=vo(),q=I.intersectsPlane(k,this.vertexProps[S.a].dir,N),J=I.intersectsPlane(D,this.vertexProps[S.b].dir,W);if(!q||!J)continue;const ie=Lo(vo(),W,N),ae=Lo(vo(),y,N),me=di(ie,ie),de=me>0?di(ae,ie)/me:0,Q=Ue(de,0,1),ue=Math.abs((de-Q)*this.edgeProps[_].len),pe=Lo(vo(),y,k),ve=ue+Math.abs(di(pe,ws(P[1],-P[0])));ve<d&&(l=_,d=ve,p=Q)}return[l,p]}tessellate(o){for(let l=this.edges.length-1;l>=0;--l){const d=this.edges[l].a,p=this.edges[l].b,{position:y,height:_,extent:S}=this.vertices[d],{position:P,height:I,extent:k}=this.vertices[p],D=this.vertexProps[d].dir,N=this.vertexProps[p].dir,W=Ge(y[0]/o,y[1]/o,_),q=Ge(P[0]/o,P[1]/o,I),J=Ge(D[1],-D[0],0);pt(J,J,S);const ie=Ge(N[1],-N[0],0);if(pt(ie,ie,k),this.distSqLines(Ge(W[0]+.5*J[0],W[1]+.5*J[1],W[2]+.5*J[2]),Ge(q[0]-.5*ie[0],q[1]-.5*ie[1],q[2]-.5*ie[2]),Ge(W[0]-.5*J[0],W[1]-.5*J[1],W[2]-.5*J[2]),Ge(q[0]+.5*ie[0],q[1]+.5*ie[1],q[2]+.5*ie[2]))<=.0025000000000000005)continue;const ae=this.vertices.length,me=Ta(vo(),y,P);this.vertices.push({position:ns(me,me,.5),height:.5*(_+I),extent:.5*(S+k)});const de=Ta(vo(),D,N);this.vertexProps.push({dir:Ou(de,de)}),this.edges.splice(l,1),this.edgeProps.splice(l,1),this.edges.push({a:d,b:ae}),this.edges.push({a:ae,b:p});const Q=Lo(vo(),this.vertices[ae].position,y),ue=za(Q),pe={vec:Q,dir:ns(vo(),Q,1/ue),len:ue};this.edgeProps.push(pe),this.edgeProps.push(pe)}}distSqLines(o,l,d,p){const y=ot(je(),l,o),_=ot(je(),p,d),S=ot(je(),o,d),P=Cn(y,y),I=Cn(y,_),k=Cn(y,S),D=Cn(_,_),N=Cn(_,S),W=P*D-I*I;if(W===0){const ie=Cn(S,_)/Cn(_,_);return Ft(lr(je(),d,p,ie),o)}const q=(I*N-k*D)/W,J=(P*N-I*k)/W;return Ft(lr(je(),o,l,q),lr(je(),d,p,J))}}class rM{static parseFrom(o,l){const d=Up.parse(o);if(!d)return[];let{vertices:p,features:y}=d;const _=1/Ze(l);y.sort((k,D)=>k.id-D.id),p.sort((k,D)=>k.id-D.id||k.idx-D.idx),p=p.filter((k,D,N)=>D===N.findIndex(W=>W.id===k.id&&W.idx===k.idx));const S=new Array;let P=0;const I=p.length;for(const k of y){if(k.constantHeight){S.push(new nM(k.id,k.bounds,k.constantHeight));continue}for(;P!==I&&p[P].id<k.id;)P++;if(P===I||p[P].id!==k.id)continue;const D=new Array,N=new Array,W=P;for(;P!==I&&p[P].id===k.id;){const q=p[P];if(D.push({position:q.position,height:q.height,extent:q.extent}),P!==W&&p[P-1].idx===q.idx-1){const J=P-W;N.push({a:J-1,b:J})}P++}S.push(new nM(k.id,k.bounds,void 0,D,N,_))}return S}static getElevationFeature(o,l){if(!l)return;const d=+o.properties[$p];return Number.isNaN(d)?void 0:l.find(p=>p.id===d)}}class xB{constructor(o,l){this.zScale=1,this.xOffset=0,this.yOffset=0,o.equals(l)||(this.zScale=Math.pow(2,l.z-o.z),this.xOffset=(o.x*this.zScale-l.x)*jt,this.yOffset=(o.y*this.zScale-l.y)*jt)}constantElevation(o,l){if(o.constantHeight!=null)return this.computeBiasedHeight(o.constantHeight,l)}pointElevation(o,l,d){const p=this.constantElevation(l,d);return p??(o.x=o.x*this.zScale+this.xOffset,o.y=o.y*this.zScale+this.yOffset,this.computeBiasedHeight(l.pointElevation(o),d))}computeBiasedHeight(o,l){return l<=0?o:o+l*Ve(0,l,o>=0?o:Math.abs(.5*o))}}Zt(nM,"ElevationFeature");class bB{constructor(){this.polygons=new Map}add(o,...l){this.polygons.has(o)?this.polygons.get(o).push(...l):this.polygons.set(o,l)}merge(o){for(const[l,d]of o.polygons)this.add(l,...d)}}class Vp{constructor(){this.portals=[]}static evaluate(o){if(o.length===0)return new Vp;let l=[];for(const I of o)l.push(...I.portals);if(l.length===0)return new Vp;const d=(I,k)=>I<=0&&k<=0||I>=jt&&k>=jt;for(const I of l){const k=I.va,D=I.vb;(d(k.x,D.x)||d(k.y,D.y))&&(I.type="border")}const p=l.filter(I=>I.type!=="unevaluated"),y=l.filter(I=>I.type==="unevaluated");if(y.length===0)return new Vp;y.sort((I,k)=>I.hash===k.hash?I.isTunnel===k.isTunnel?0:I.isTunnel?-1:1:I.hash<k.hash?1:-1),l=p.concat(y);let _=p.length,S=_,P=_;do if(S++,S===l.length||l[_].hash!==l[S].hash){if(S-_==2){P<_&&(l[P]=l[_],l[_]=null);const I=l[P],k=l[S-1];I.type=I.isTunnel!==k.isTunnel?"tunnel":"polygon",I.connection={a:I.connection.a,b:k.connection.a},P++}_=S}while(_!==l.length);return l.splice(P),l.sort((I,k)=>I.hash<k.hash?1:-1),{portals:l}}}Zt(Vp,"ElevationPortalGraph"),Zt(bB,"ElevationPolygons");class Xne{constructor(o,l,d){this.outPositions=o,this.outNormals=l,this.outIndices=d,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(o,l,d){let p=o[2];d!=null&&(p*=d);const y=this.getVec3Bits(o)<<96n|this.getVec3Bits(l),_=this.vertexLookup.get(y);if(_!=null)return _;const S=this.outPositions.length;this.vertexLookup.set(y,S);const P=Math.trunc(16384*l[0]),I=Math.trunc(16384*l[1]),k=Math.trunc(16384*l[2]);return this.outPositions.emplaceBack(o[0],o[1],p),this.outNormals.emplaceBack(P,I,k),S}addVertices(o,l,...d){const p=[];for(const y of d){const _=this.addVertex(y,o,l);p.push(_)}return p}addTriangles(o,l,d){if(l&&d){const p=d.length===1,y=Ge(0,0,0);for(let _=0;_<o.length;_+=3){const S=l[o[_+0]],P=l[o[_+1]],I=l[o[_+2]],k=p?d[0]:d[o[_+1]],D=p?d[0]:d[o[_+2]],N=this.addVertex(Ge(S.x,S.y,p?d[0]:d[o[_+0]]),y),W=this.addVertex(Ge(P.x,P.y,k),y),q=this.addVertex(Ge(I.x,I.y,D),y);this.outIndices.emplaceBack(N,W,q)}}else for(let p=0;p<o.length;p+=3)this.outIndices.emplaceBack(o[p+0],o[p+1],o[p+2])}addQuad(o,l){const d=this.addVertices(l,void 0,...o.map(P=>Ge(P.coord.x,P.coord.y,P.height))),[p,y,_,S]=d;this.addTriangles([p,y,_,_,S,p])}getBits(o){return this.view.setFloat32(0,o),BigInt(this.view.getUint32(0))}getVec3Bits(o){return this.getBits(o[0])<<64n|this.getBits(o[1])<<32n|this.getBits(o[2])}}class Ms{constructor(o){this.unevaluatedPortals=new Vp,this.portalPolygons=new bB,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new Xg,this.vertexNormals=new bd,this.indexArray=new bo,this.tileToMeters=Ze(o)}addVertices(o,l){const d=this.unevalVertices.length;for(let p=0;p<o.length;p++)this.unevalVertices.push(o[p]),this.unevalHeights.push(l[p]);return d}addTriangles(o,l,d){const p=d?this.unevalTunnelTriangles:this.unevalTriangles;for(const y of o)p.push(y+l)}addRenderableRing(o,l,d,p,y){const _=[new yt(y.min.x,y.min.y),new yt(y.max.x,y.min.y),new yt(y.max.x,y.max.y),new yt(y.min.x,y.max.y)];for(let S=0;S<d-1;S++){const P=l+S,I=P+1,k=this.unevalVertices[P],D=this.unevalVertices[I];if(!(k.x>=y.min.x&&k.x<=y.max.x&&k.y>=y.min.y&&k.y<=y.max.y||D.x>=y.min.x&&D.x<=y.max.x&&D.y>=y.min.y&&D.y<=y.max.y||Li(k,D,_))||this.isOnBorder(k.x,D.x)||this.isOnBorder(k.y,D.y))continue;const N=Ms.computeEdgeHash(this.unevalVertices[P],this.unevalVertices[I]);let W,q=this.vertexHashLookup.get(Ms.computePosHash(k));q!=null?W=q.next:(q=this.vertexHashLookup.get(Ms.computePosHash(D)),W=q!=null?q.prev:N),this.unevalEdges.push({polygonIdx:o,a:P,b:I,hash:N,portalHash:W,isTunnel:p,type:"unevaluated"})}}addPortalCandidates(o,l,d,p,y){if(l.length===0)return;this.portalPolygons.add(o,{geometry:l,zLevel:y});const _=l[0];this.vertexHashLookup.clear();let S=Ms.computeEdgeHash(_[_.length-2],_[_.length-1]);for(let P=0;P<_.length-1;P++){const I=_[P+0],k=_[P+1],D=ws(k.x-I.x,k.y-I.y),N=za(D);if(N===0)continue;let W="unevaluated";const q=p.pointElevation(I),J=p.pointElevation(k);Math.abs(q)<.01&&Math.abs(J)<.01?W="entrance":(this.isOnBorder(I.x,k.x)||this.isOnBorder(I.y,k.y))&&(W="border");const ie=Ms.computeEdgeHash(I,k);this.unevaluatedPortals.portals.push({connection:{a:o,b:void 0},va:I,vb:k,vab:D,length:N,hash:ie,isTunnel:d,type:W});const ae=Ms.computePosHash(I);this.vertexHashLookup.set(ae,{prev:S,next:ie}),S=ie}}construct(o){if(this.unevalVertices.length===0)return;const l=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),d=D=>{D.primitiveLength=this.indexArray.length-D.primitiveOffset},p=new Xne(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(o.portals,this.unevalEdges);const y=l(),_=l(),S=l(),P=(D,N)=>{D.sort((q,J)=>q.type===N&&J.type!==N?-1:q.type!==N&&J.type===N?1:0);const W=D.findIndex(q=>q.type!==N);return W>=0?W:D.length};let I=0;this.unevalEdges.length>0&&(I=P(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:I},this.tileToMeters));const k=l();if(this.unevalEdges.length>0){const D=this.unevalEdges.splice(I),N=P(D,"tunnel")+I;this.unevalEdges.push(...D),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:I},{min:I,max:N})}d(S),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),d(k),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),d(_),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),d(y),this.maskSegments=Ti.simpleSegment(0,k.primitiveOffset,0,k.primitiveLength),this.depthSegments=Ti.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength),this.renderableSegments=Ti.simpleSegment(0,S.primitiveOffset,0,S.primitiveLength),this.shadowCasterSegments=Ti.simpleSegment(0,y.primitiveOffset,0,y.primitiveLength)}upload(o){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=o.createVertexBuffer(this.vertexPositions,Dne.members),this.vertexBufferNormal=o.createVertexBuffer(this.vertexNormals,Lne.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(o,l,d,p,y){const _=new Map;for(let S=p;S<y;S++){const P=d[S],I=P.a,k=P.b,D=Ms.computePosHash(o[I]),N=Ms.computePosHash(o[k]);_.has(D)||_.set(D,{}),_.has(N)||_.set(N,{});const W=_.get(D),q=_.get(N);l[I]<=0&&l[k]<=0||(W.to=k,q.from=I)}return _}constructBridgeStructures(o,l,d,p,y,_){const S=this.computeVertexConnections(l,d,p,y.min,y.max),P=1/_,I=.5*P,k=N=>Ge(l[N].x,l[N].y,d[N]*P),D=N=>{const W=S.get(Ms.computePosHash(l[N])),q=W.from,J=W.to;if(!q||!J)return;const ie=k(q),ae=k(N),me=k(J),de=Ge(0,0,0);if(!kt(ie,ae)){const ue=zn(je(),ae,ie);ht(de,de,fn(ue,ue))}if(!kt(me,ae)){const ue=zn(je(),me,ae);ht(de,de,fn(ue,ue))}const Q=hi(de);return Q>0?pt(de,de,1/Q):void 0};for(let N=y.min;N<y.max;N++){const W=p[N],q=this.prepareEdgePoints(l,d,W,(Ct,kn)=>Ct>kn);if(q==null)continue;const J=q[0],ie=q[1],ae=Ge(J.coord.x,J.coord.y,P*J.height),me=Ge(ie.coord.x,ie.coord.y,P*ie.height);if(kt(ae,me))continue;const de=zn(je(),me,ae);fn(de,de);const Q=Ct=>fn(Ct,Ct),ue=D(W.a)||de,pe=D(W.b)||de,ve=Q(Ge(ue[1],-ue[0],0)),Ie=Q(Ge(pe[1],-pe[0],0)),De=Q(Vt(je(),ve,ue)),Fe=Q(Vt(je(),Ie,pe)),He=je(),ct=[ht(je(),ae,pt(He,zn(He,ve,De),I)),ht(je(),ae,pt(He,ht(He,ve,De),I)),ht(je(),ae,pt(He,De,I)),ae],St=[ht(je(),me,pt(He,zn(He,Ie,Fe),I)),ht(je(),me,pt(He,ht(He,Ie,Fe),I)),ht(je(),me,pt(He,Fe,I)),me],[_t,bt]=o.addVertices(ve,_,ct[0],ct[1]),[Pt,st]=o.addVertices(Ie,_,St[0],St[1]);o.addTriangles([_t,bt,Pt,bt,st,Pt]);const[xt,nt]=o.addVertices(De,_,ct[1],ct[2]),[lt,It]=o.addVertices(Fe,_,St[1],St[2]);o.addTriangles([xt,nt,lt,nt,It,lt]);const[Mt,on]=o.addVertices(Tn(ve,ve),_,ct[2],ct[3]),[Kt,$t]=o.addVertices(Tn(Ie,Ie),_,St[2],St[3]);o.addTriangles([Mt,on,Kt,on,$t,Kt])}}constructTunnelStructures(o,l,d,p,y,_){const S=P=>fn(P,P);for(let P=y.min;P<y.max;P++){const I=this.prepareEdgePoints(l,d,p[P],(W,q)=>W<q);if(I==null)continue;const[k,D]=I,N=S(Ge(D.coord.y-k.coord.y,-(D.coord.x-k.coord.x),0));o.addQuad([k,D,{coord:D.coord,height:p[P].isTunnel?-.1:0},{coord:k.coord,height:p[P].isTunnel?-.1:0}],N)}for(let P=_.min;P<_.max;P++){const I=p[P],k=l[I.a],D=l[I.b],N=S(Ge(D.y-k.y,-(D.x-k.x),0));o.addQuad([{coord:D,height:0},{coord:k,height:0},{coord:k,height:d[I.a]+4},{coord:D,height:d[I.b]+4}],N),o.addQuad([{coord:k,height:0},{coord:D,height:0},{coord:D,height:d[I.b]+4},{coord:k,height:d[I.a]+4}],N)}}prepareEdgePoints(o,l,d,p){let y=l[d.a],_=l[d.b];const S=p(y,0),P=p(_,0);if(S&&P)return[{coord:o[d.a],height:y},{coord:o[d.b],height:_}];if(!S&&!P)return;const I=o[d.a].clone(),k=o[d.b].clone();if(S){if(!P){const D=_/(_-y);k.x=yn(k.x,I.x,D),k.y=yn(k.y,I.y,D),_=yn(_,y,D)}}else{const D=y/(y-_);I.x=yn(I.x,k.x,D),I.y=yn(I.y,k.y,D),y=yn(y,_,D)}return[{coord:I,height:y},{coord:k,height:_}]}prepareEdges(o,l){if(l.length===0)return;l.sort((S,P)=>S.hash===P.hash?P.polygonIdx-S.polygonIdx:P.hash>S.hash?1:-1);let d=0,p=0,y=0,_=l[d].polygonIdx;do p++,(p===l.length||l[d].hash!==l[p].hash)&&((p-d==1||l[p-1].polygonIdx!==_)&&(y<d&&(l[y]=l[d],l[d]=null),l[y].type="none",y++),d=p,d!==l.length&&(_=l[d].polygonIdx));while(d!==l.length);if(l.splice(y),l.length!==0&&o.length!==0){l.sort((I,k)=>I.portalHash<k.portalHash?1:-1);let S=0,P=0;for(;S!==l.length&&P!==o.length;){const I=l[S],k=o[P];I.portalHash>k.hash?S++:k.hash>I.portalHash?P++:(I.type=k.type,S++)}}}isOnBorder(o,l){return o<=0&&l<=0||o>=jt&&l>=jt}static computeEdgeHash(o,l){return(o.y===l.y&&o.x>l.x||o.y>l.y)&&([o,l]=[l,o]),BigInt(Ms.computePosHash(o))<<32n|BigInt(Ms.computePosHash(l))}static computePosHash(o){return((65535&o.x)<<16|65535&o.y)>>>0}}var wB,SB={exports:{}},TB=(wB||(wB=1,function(u,o){(function(l){function d(ge,xe){return ge>xe?1:ge<xe?-1:0}var p=function(ge,xe){ge===void 0&&(ge=d),xe===void 0&&(xe=!1),this._compare=ge,this._root=null,this._size=0,this._noDuplicates=!!xe},y={size:{configurable:!0}};function _(ge,xe,ut,Lt,Gt){var Ut=Gt-Lt;if(Ut>0){var nn=Lt+Math.floor(Ut/2),An={key:xe[nn],data:ut[nn],parent:ge};return An.left=_(An,xe,ut,Lt,nn),An.right=_(An,xe,ut,nn+1,Gt),An}return null}function S(ge,xe,ut,Lt,Gt){if(!(ut>=Lt)){for(var Ut=ge[ut+Lt>>1],nn=ut-1,An=Lt+1;;){do nn++;while(Gt(ge[nn],Ut)<0);do An--;while(Gt(ge[An],Ut)>0);if(nn>=An)break;var or=ge[nn];ge[nn]=ge[An],ge[An]=or,or=xe[nn],xe[nn]=xe[An],xe[An]=or}S(ge,xe,ut,An,Gt),S(ge,xe,An+1,Lt,Gt)}}p.prototype.rotateLeft=function(ge){var xe=ge.right;xe&&(ge.right=xe.left,xe.left&&(xe.left.parent=ge),xe.parent=ge.parent),ge.parent?ge===ge.parent.left?ge.parent.left=xe:ge.parent.right=xe:this._root=xe,xe&&(xe.left=ge),ge.parent=xe},p.prototype.rotateRight=function(ge){var xe=ge.left;xe&&(ge.left=xe.right,xe.right&&(xe.right.parent=ge),xe.parent=ge.parent),ge.parent?ge===ge.parent.left?ge.parent.left=xe:ge.parent.right=xe:this._root=xe,xe&&(xe.right=ge),ge.parent=xe},p.prototype._splay=function(ge){for(;ge.parent;){var xe=ge.parent;xe.parent?xe.left===ge&&xe.parent.left===xe?(this.rotateRight(xe.parent),this.rotateRight(xe)):xe.right===ge&&xe.parent.right===xe?(this.rotateLeft(xe.parent),this.rotateLeft(xe)):xe.left===ge&&xe.parent.right===xe?(this.rotateRight(xe),this.rotateLeft(xe)):(this.rotateLeft(xe),this.rotateRight(xe)):xe.left===ge?this.rotateRight(xe):this.rotateLeft(xe)}},p.prototype.splay=function(ge){for(var xe,ut,Lt,Gt,Ut;ge.parent;)(ut=(xe=ge.parent).parent)&&ut.parent?((Lt=ut.parent).left===ut?Lt.left=ge:Lt.right=ge,ge.parent=Lt):(ge.parent=null,this._root=ge),Gt=ge.left,Ut=ge.right,ge===xe.left?(ut&&(ut.left===xe?(xe.right?(ut.left=xe.right,ut.left.parent=ut):ut.left=null,xe.right=ut,ut.parent=xe):(Gt?(ut.right=Gt,Gt.parent=ut):ut.right=null,ge.left=ut,ut.parent=ge)),Ut?(xe.left=Ut,Ut.parent=xe):xe.left=null,ge.right=xe,xe.parent=ge):(ut&&(ut.right===xe?(xe.left?(ut.right=xe.left,ut.right.parent=ut):ut.right=null,xe.left=ut,ut.parent=xe):(Ut?(ut.left=Ut,Ut.parent=ut):ut.left=null,ge.right=ut,ut.parent=ge)),Gt?(xe.right=Gt,Gt.parent=xe):xe.right=null,ge.left=xe,xe.parent=ge)},p.prototype.replace=function(ge,xe){ge.parent?ge===ge.parent.left?ge.parent.left=xe:ge.parent.right=xe:this._root=xe,xe&&(xe.parent=ge.parent)},p.prototype.minNode=function(ge){if(ge===void 0&&(ge=this._root),ge)for(;ge.left;)ge=ge.left;return ge},p.prototype.maxNode=function(ge){if(ge===void 0&&(ge=this._root),ge)for(;ge.right;)ge=ge.right;return ge},p.prototype.insert=function(ge,xe){var ut=this._root,Lt=null,Gt=this._compare;if(this._noDuplicates)for(;ut;){if(Lt=ut,Gt(ut.key,ge)===0)return;ut=Gt(ut.key,ge)<0?ut.right:ut.left}else for(;ut;)Lt=ut,ut=Gt(ut.key,ge)<0?ut.right:ut.left;return ut={key:ge,data:xe,left:null,right:null,parent:Lt},Lt?Gt(Lt.key,ut.key)<0?Lt.right=ut:Lt.left=ut:this._root=ut,this.splay(ut),this._size++,ut},p.prototype.find=function(ge){for(var xe=this._root,ut=this._compare;xe;){var Lt=ut(xe.key,ge);if(Lt<0)xe=xe.right;else{if(!(Lt>0))return xe;xe=xe.left}}return null},p.prototype.contains=function(ge){for(var xe=this._root,ut=this._compare;xe;){var Lt=ut(ge,xe.key);if(Lt===0)return!0;xe=Lt<0?xe.left:xe.right}return!1},p.prototype.remove=function(ge){var xe=this.find(ge);if(!xe)return!1;if(this.splay(xe),xe.left)if(xe.right){var ut=this.minNode(xe.right);ut.parent!==xe&&(this.replace(ut,ut.right),ut.right=xe.right,ut.right.parent=ut),this.replace(xe,ut),ut.left=xe.left,ut.left.parent=ut}else this.replace(xe,xe.left);else this.replace(xe,xe.right);return this._size--,!0},p.prototype.removeNode=function(ge){if(!ge)return!1;if(this.splay(ge),ge.left)if(ge.right){var xe=this.minNode(ge.right);xe.parent!==ge&&(this.replace(xe,xe.right),xe.right=ge.right,xe.right.parent=xe),this.replace(ge,xe),xe.left=ge.left,xe.left.parent=xe}else this.replace(ge,ge.left);else this.replace(ge,ge.right);return this._size--,!0},p.prototype.erase=function(ge){var xe=this.find(ge);if(xe){this.splay(xe);var ut=xe.left,Lt=xe.right,Gt=null;ut&&(ut.parent=null,Gt=this.maxNode(ut),this.splay(Gt),this._root=Gt),Lt&&(ut?Gt.right=Lt:this._root=Lt,Lt.parent=Gt),this._size--}},p.prototype.pop=function(){var ge=this._root,xe=null;if(ge){for(;ge.left;)ge=ge.left;xe={key:ge.key,data:ge.data},this.remove(ge.key)}return xe},p.prototype.next=function(ge){var xe=ge;if(xe)if(xe.right)for(xe=xe.right;xe&&xe.left;)xe=xe.left;else for(xe=ge.parent;xe&&xe.right===ge;)ge=xe,xe=xe.parent;return xe},p.prototype.prev=function(ge){var xe=ge;if(xe)if(xe.left)for(xe=xe.left;xe&&xe.right;)xe=xe.right;else for(xe=ge.parent;xe&&xe.left===ge;)ge=xe,xe=xe.parent;return xe},p.prototype.forEach=function(ge){for(var xe=this._root,ut=[],Lt=!1,Gt=0;!Lt;)xe?(ut.push(xe),xe=xe.left):ut.length>0?(ge(xe=ut.pop(),Gt++),xe=xe.right):Lt=!0;return this},p.prototype.range=function(ge,xe,ut,Lt){for(var Gt=[],Ut=this._compare,nn=this._root;Gt.length!==0||nn;)if(nn)Gt.push(nn),nn=nn.left;else{if(Ut((nn=Gt.pop()).key,xe)>0)break;if(Ut(nn.key,ge)>=0&&ut.call(Lt,nn))return this;nn=nn.right}return this},p.prototype.keys=function(){for(var ge=this._root,xe=[],ut=[],Lt=!1;!Lt;)ge?(xe.push(ge),ge=ge.left):xe.length>0?(ge=xe.pop(),ut.push(ge.key),ge=ge.right):Lt=!0;return ut},p.prototype.values=function(){for(var ge=this._root,xe=[],ut=[],Lt=!1;!Lt;)ge?(xe.push(ge),ge=ge.left):xe.length>0?(ge=xe.pop(),ut.push(ge.data),ge=ge.right):Lt=!0;return ut},p.prototype.at=function(ge){for(var xe=this._root,ut=[],Lt=!1,Gt=0;!Lt;)if(xe)ut.push(xe),xe=xe.left;else if(ut.length>0){if(xe=ut.pop(),Gt===ge)return xe;Gt++,xe=xe.right}else Lt=!0;return null},p.prototype.load=function(ge,xe,ut){if(ge===void 0&&(ge=[]),xe===void 0&&(xe=[]),ut===void 0&&(ut=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Lt=ge.length;return ut&&S(ge,xe,0,Lt-1,this._compare),this._root=_(null,ge,xe,0,Lt),this._size=Lt,this},p.prototype.min=function(){var ge=this.minNode(this._root);return ge?ge.key:null},p.prototype.max=function(){var ge=this.maxNode(this._root);return ge?ge.key:null},p.prototype.isEmpty=function(){return this._root===null},y.size.get=function(){return this._size},p.createTree=function(ge,xe,ut,Lt,Gt){return new p(ut,Gt).load(ge,xe,Lt)},Object.defineProperties(p.prototype,y);var P=0,I=1,k=2,D=3,N=0,W=1,q=2,J=3;function ie(ge,xe,ut){xe===null?(ge.inOut=!1,ge.otherInOut=!0):(ge.isSubject===xe.isSubject?(ge.inOut=!xe.inOut,ge.otherInOut=xe.otherInOut):(ge.inOut=!xe.otherInOut,ge.otherInOut=xe.isVertical()?!xe.inOut:xe.inOut),xe&&(ge.prevInResult=!ae(xe,ut)||xe.isVertical()?xe.prevInResult:xe));var Lt=ae(ge,ut);ge.resultTransition=Lt?function(Gt,Ut){var nn,An=!Gt.inOut,or=!Gt.otherInOut;switch(Ut){case N:nn=An&&or;break;case W:nn=An||or;break;case J:nn=An^or;break;case q:nn=Gt.isSubject?An&&!or:or&&!An}return nn?1:-1}(ge,ut):0}function ae(ge,xe){switch(ge.type){case P:switch(xe){case N:return!ge.otherInOut;case W:return ge.otherInOut;case q:return ge.isSubject&&ge.otherInOut||!ge.isSubject&&!ge.otherInOut;case J:return!0}break;case k:return xe===N||xe===W;case D:return xe===q;case I:return!1}return!1}var me=function(ge,xe,ut,Lt,Gt){this.left=xe,this.point=ge,this.otherEvent=ut,this.isSubject=Lt,this.type=Gt||P,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},de={inResult:{configurable:!0}};function Q(ge,xe){return ge[0]===xe[0]&&ge[1]===xe[1]}me.prototype.isBelow=function(ge){var xe=this.point,ut=this.otherEvent.point;return this.left?(xe[0]-ge[0])*(ut[1]-ge[1])-(ut[0]-ge[0])*(xe[1]-ge[1])>0:(ut[0]-ge[0])*(xe[1]-ge[1])-(xe[0]-ge[0])*(ut[1]-ge[1])>0},me.prototype.isAbove=function(ge){return!this.isBelow(ge)},me.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},de.inResult.get=function(){return this.resultTransition!==0},me.prototype.clone=function(){var ge=new me(this.point,this.left,this.otherEvent,this.isSubject,this.type);return ge.contourId=this.contourId,ge.resultTransition=this.resultTransition,ge.prevInResult=this.prevInResult,ge.isExteriorRing=this.isExteriorRing,ge.inOut=this.inOut,ge.otherInOut=this.otherInOut,ge},Object.defineProperties(me.prototype,de);var ue=11102230246251565e-32,pe=134217729,ve=(3+8*ue)*ue;function Ie(ge,xe,ut,Lt,Gt){var Ut,nn,An,or,ar=xe[0],Wn=Lt[0],Rr=0,Kr=0;Wn>ar==Wn>-ar?(Ut=ar,ar=xe[++Rr]):(Ut=Wn,Wn=Lt[++Kr]);var sr=0;if(Rr<ge&&Kr<ut)for(Wn>ar==Wn>-ar?(An=Ut-((nn=ar+Ut)-ar),ar=xe[++Rr]):(An=Ut-((nn=Wn+Ut)-Wn),Wn=Lt[++Kr]),Ut=nn,An!==0&&(Gt[sr++]=An);Rr<ge&&Kr<ut;)Wn>ar==Wn>-ar?(An=Ut-((nn=Ut+ar)-(or=nn-Ut))+(ar-or),ar=xe[++Rr]):(An=Ut-((nn=Ut+Wn)-(or=nn-Ut))+(Wn-or),Wn=Lt[++Kr]),Ut=nn,An!==0&&(Gt[sr++]=An);for(;Rr<ge;)An=Ut-((nn=Ut+ar)-(or=nn-Ut))+(ar-or),ar=xe[++Rr],Ut=nn,An!==0&&(Gt[sr++]=An);for(;Kr<ut;)An=Ut-((nn=Ut+Wn)-(or=nn-Ut))+(Wn-or),Wn=Lt[++Kr],Ut=nn,An!==0&&(Gt[sr++]=An);return Ut===0&&sr!==0||(Gt[sr++]=Ut),sr}function De(ge){return new Float64Array(ge)}var Fe=33306690738754716e-32,He=22204460492503146e-32,ct=11093356479670487e-47,St=De(4),_t=De(8),bt=De(12),Pt=De(16),st=De(4);function xt(ge,xe,ut){var Lt=function(Gt,Ut,nn,An,or,ar){var Wn=(Ut-ar)*(nn-or),Rr=(Gt-or)*(An-ar),Kr=Wn-Rr;if(Wn===0||Rr===0||Wn>0!=Rr>0)return Kr;var sr=Math.abs(Wn+Rr);return Math.abs(Kr)>=Fe*sr?Kr:-function(Ei,oi,Mr,zi,ci,Yr,ai){var Lr,Xn,Br,Ai,En,pr,ui,ki,gi,eo,Vr,Ki,Va,Wo,Fo,Ga,cu,to,go=Ei-ci,Ho=Mr-ci,ga=oi-Yr,ta=zi-Yr;St[0]=(Fo=(ki=go-(ui=(pr=pe*go)-(pr-go)))*(eo=ta-(gi=(pr=pe*ta)-(pr-ta)))-((Wo=go*ta)-ui*gi-ki*gi-ui*eo))-((Vr=Fo-(cu=(ki=ga-(ui=(pr=pe*ga)-(pr-ga)))*(eo=Ho-(gi=(pr=pe*Ho)-(pr-Ho)))-((Ga=ga*Ho)-ui*gi-ki*gi-ui*eo)))+(En=Fo-Vr))+(En-cu),St[1]=(Va=Wo-((Ki=Wo+Vr)-(En=Ki-Wo))+(Vr-En))-((Vr=Va-Ga)+(En=Va-Vr))+(En-Ga),St[2]=Ki-((to=Ki+Vr)-(En=to-Ki))+(Vr-En),St[3]=to;var Fd=function(B7e,I$){for(var M$=I$[0],sO=1;sO<4;sO++)M$+=I$[sO];return M$}(0,St),Dx=He*ai;if(Fd>=Dx||-Fd>=Dx||(Lr=Ei-(go+(En=Ei-go))+(En-ci),Br=Mr-(Ho+(En=Mr-Ho))+(En-ci),Xn=oi-(ga+(En=oi-ga))+(En-Yr),Ai=zi-(ta+(En=zi-ta))+(En-Yr),Lr===0&&Xn===0&&Br===0&&Ai===0)||(Dx=ct*ai+ve*Math.abs(Fd),(Fd+=go*Ai+ta*Lr-(ga*Br+Ho*Xn))>=Dx||-Fd>=Dx))return Fd;st[0]=(Fo=(ki=Lr-(ui=(pr=pe*Lr)-(pr-Lr)))*(eo=ta-(gi=(pr=pe*ta)-(pr-ta)))-((Wo=Lr*ta)-ui*gi-ki*gi-ui*eo))-((Vr=Fo-(cu=(ki=Xn-(ui=(pr=pe*Xn)-(pr-Xn)))*(eo=Ho-(gi=(pr=pe*Ho)-(pr-Ho)))-((Ga=Xn*Ho)-ui*gi-ki*gi-ui*eo)))+(En=Fo-Vr))+(En-cu),st[1]=(Va=Wo-((Ki=Wo+Vr)-(En=Ki-Wo))+(Vr-En))-((Vr=Va-Ga)+(En=Va-Vr))+(En-Ga),st[2]=Ki-((to=Ki+Vr)-(En=to-Ki))+(Vr-En),st[3]=to;var koe=Ie(4,St,4,st,_t);st[0]=(Fo=(ki=go-(ui=(pr=pe*go)-(pr-go)))*(eo=Ai-(gi=(pr=pe*Ai)-(pr-Ai)))-((Wo=go*Ai)-ui*gi-ki*gi-ui*eo))-((Vr=Fo-(cu=(ki=ga-(ui=(pr=pe*ga)-(pr-ga)))*(eo=Br-(gi=(pr=pe*Br)-(pr-Br)))-((Ga=ga*Br)-ui*gi-ki*gi-ui*eo)))+(En=Fo-Vr))+(En-cu),st[1]=(Va=Wo-((Ki=Wo+Vr)-(En=Ki-Wo))+(Vr-En))-((Vr=Va-Ga)+(En=Va-Vr))+(En-Ga),st[2]=Ki-((to=Ki+Vr)-(En=to-Ki))+(Vr-En),st[3]=to;var Roe=Ie(koe,_t,4,st,bt);st[0]=(Fo=(ki=Lr-(ui=(pr=pe*Lr)-(pr-Lr)))*(eo=Ai-(gi=(pr=pe*Ai)-(pr-Ai)))-((Wo=Lr*Ai)-ui*gi-ki*gi-ui*eo))-((Vr=Fo-(cu=(ki=Xn-(ui=(pr=pe*Xn)-(pr-Xn)))*(eo=Br-(gi=(pr=pe*Br)-(pr-Br)))-((Ga=Xn*Br)-ui*gi-ki*gi-ui*eo)))+(En=Fo-Vr))+(En-cu),st[1]=(Va=Wo-((Ki=Wo+Vr)-(En=Ki-Wo))+(Vr-En))-((Vr=Va-Ga)+(En=Va-Vr))+(En-Ga),st[2]=Ki-((to=Ki+Vr)-(En=to-Ki))+(Vr-En),st[3]=to;var Doe=Ie(Roe,bt,4,st,Pt);return Pt[Doe-1]}(Gt,Ut,nn,An,or,ar,sr)}(ge[0],ge[1],xe[0],xe[1],ut[0],ut[1]);return Lt>0?-1:Lt<0?1:0}function nt(ge,xe){var ut=ge.point,Lt=xe.point;return ut[0]>Lt[0]?1:ut[0]<Lt[0]?-1:ut[1]!==Lt[1]?ut[1]>Lt[1]?1:-1:function(Gt,Ut,nn,An){return Gt.left!==Ut.left?Gt.left?1:-1:xt(nn,Gt.otherEvent.point,Ut.otherEvent.point)!==0?Gt.isBelow(Ut.otherEvent.point)?-1:1:!Gt.isSubject&&Ut.isSubject?1:-1}(ge,xe,ut)}function lt(ge,xe,ut){var Lt=new me(xe,!1,ge,ge.isSubject),Gt=new me(xe,!0,ge.otherEvent,ge.isSubject);return Q(ge.point,ge.otherEvent.point)&&console.warn("what is that, a collapsed segment?",ge),Lt.contourId=Gt.contourId=ge.contourId,nt(Gt,ge.otherEvent)>0&&(ge.otherEvent.left=!0,Gt.left=!1),ge.otherEvent.otherEvent=Gt,ge.otherEvent=Lt,ut.push(Gt),ut.push(Lt),ut}function It(ge,xe){return ge[0]*xe[1]-ge[1]*xe[0]}function Mt(ge,xe){return ge[0]*xe[0]+ge[1]*xe[1]}function on(ge,xe,ut){var Lt=function(or,ar,Wn,Rr,Kr){var sr=[ar[0]-or[0],ar[1]-or[1]],Ei=[Rr[0]-Wn[0],Rr[1]-Wn[1]];function oi(pr,ui,ki){return[pr[0]+ui*ki[0],pr[1]+ui*ki[1]]}var Mr=[Wn[0]-or[0],Wn[1]-or[1]],zi=It(sr,Ei),ci=zi*zi,Yr=Mt(sr,sr);if(ci>0){var ai=It(Mr,Ei)/zi;if(ai<0||ai>1)return null;var Lr=It(Mr,sr)/zi;return Lr<0||Lr>1?null:ai===0||ai===1?[oi(or,ai,sr)]:Lr===0||Lr===1?[oi(Wn,Lr,Ei)]:[oi(or,ai,sr)]}if((ci=(zi=It(Mr,sr))*zi)>0)return null;var Xn=Mt(sr,Mr)/Yr,Br=Xn+Mt(sr,Ei)/Yr,Ai=Math.min(Xn,Br),En=Math.max(Xn,Br);return Ai<=1&&En>=0?Ai===1?[oi(or,Ai>0?Ai:0,sr)]:En===0?[oi(or,En<1?En:1,sr)]:[oi(or,Ai>0?Ai:0,sr),oi(or,En<1?En:1,sr)]:null}(ge.point,ge.otherEvent.point,xe.point,xe.otherEvent.point),Gt=Lt?Lt.length:0;if(Gt===0||Gt===1&&(Q(ge.point,xe.point)||Q(ge.otherEvent.point,xe.otherEvent.point))||Gt===2&&ge.isSubject===xe.isSubject)return 0;if(Gt===1)return Q(ge.point,Lt[0])||Q(ge.otherEvent.point,Lt[0])||lt(ge,Lt[0],ut),Q(xe.point,Lt[0])||Q(xe.otherEvent.point,Lt[0])||lt(xe,Lt[0],ut),1;var Ut=[],nn=!1,An=!1;return Q(ge.point,xe.point)?nn=!0:nt(ge,xe)===1?Ut.push(xe,ge):Ut.push(ge,xe),Q(ge.otherEvent.point,xe.otherEvent.point)?An=!0:nt(ge.otherEvent,xe.otherEvent)===1?Ut.push(xe.otherEvent,ge.otherEvent):Ut.push(ge.otherEvent,xe.otherEvent),nn&&An||nn?(xe.type=I,ge.type=xe.inOut===ge.inOut?k:D,nn&&!An&&lt(Ut[1].otherEvent,Ut[0].point,ut),2):An?(lt(Ut[0],Ut[1].point,ut),3):Ut[0]!==Ut[3].otherEvent?(lt(Ut[0],Ut[1].point,ut),lt(Ut[1],Ut[2].point,ut),3):(lt(Ut[0],Ut[1].point,ut),lt(Ut[3].otherEvent,Ut[2].point,ut),3)}function Kt(ge,xe){if(ge===xe)return 0;if(xt(ge.point,ge.otherEvent.point,xe.point)!==0||xt(ge.point,ge.otherEvent.point,xe.otherEvent.point)!==0)return Q(ge.point,xe.point)?ge.isBelow(xe.otherEvent.point)?-1:1:ge.point[0]===xe.point[0]?ge.point[1]<xe.point[1]?-1:1:nt(ge,xe)===1?xe.isAbove(ge.point)?-1:1:ge.isBelow(xe.point)?-1:1;if(ge.isSubject!==xe.isSubject)return ge.isSubject?-1:1;var ut=ge.point,Lt=xe.point;return ut[0]===Lt[0]&&ut[1]===Lt[1]?(ut=ge.otherEvent.point)[0]===(Lt=xe.otherEvent.point)[0]&&ut[1]===Lt[1]?0:ge.contourId>xe.contourId?1:-1:nt(ge,xe)===1?1:-1}var $t=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Ct(ge,xe,ut,Lt){var Gt,Ut=ge+1,nn=xe[ge].point,An=xe.length;for(Ut<An&&(Gt=xe[Ut].point);Ut<An&&Gt[0]===nn[0]&&Gt[1]===nn[1];){if(!ut[Ut])return Ut;++Ut<An&&(Gt=xe[Ut].point)}for(Ut=ge-1;ut[Ut]&&Ut>Lt;)Ut--;return Ut}$t.prototype.isExterior=function(){return this.holeOf==null};var kn=tn,en=tn;function tn(ge,xe){if(!(this instanceof tn))return new tn(ge,xe);if(this.data=ge||[],this.length=this.data.length,this.compare=xe||Pn,this.length>0)for(var ut=(this.length>>1)-1;ut>=0;ut--)this._down(ut)}function Pn(ge,xe){return ge<xe?-1:ge>xe?1:0}tn.prototype={push:function(ge){this.data.push(ge),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var ge=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),ge}},peek:function(){return this.data[0]},_up:function(ge){for(var xe=this.data,ut=this.compare,Lt=xe[ge];ge>0;){var Gt=ge-1>>1,Ut=xe[Gt];if(ut(Lt,Ut)>=0)break;xe[ge]=Ut,ge=Gt}xe[ge]=Lt},_down:function(ge){for(var xe=this.data,ut=this.compare,Lt=this.length>>1,Gt=xe[ge];ge<Lt;){var Ut=1+(ge<<1),nn=Ut+1,An=xe[Ut];if(nn<this.length&&ut(xe[nn],An)<0&&(Ut=nn,An=xe[nn]),ut(An,Gt)>=0)break;xe[ge]=An,ge=Ut}xe[ge]=Gt}},kn.default=en;var Bn=Math.max,$n=Math.min,Jn=0;function Hn(ge,xe,ut,Lt,Gt,Ut){var nn,An,or,ar,Wn,Rr;for(nn=0,An=ge.length-1;nn<An;nn++)if(ar=ge[nn+1],Wn=new me(or=ge[nn],!1,void 0,xe),Rr=new me(ar,!1,Wn,xe),Wn.otherEvent=Rr,or[0]!==ar[0]||or[1]!==ar[1]){Wn.contourId=Rr.contourId=ut,Ut||(Wn.isExteriorRing=!1,Rr.isExteriorRing=!1),nt(Wn,Rr)>0?Rr.left=!0:Wn.left=!0;var Kr=or[0],sr=or[1];Gt[0]=$n(Gt[0],Kr),Gt[1]=$n(Gt[1],sr),Gt[2]=Bn(Gt[2],Kr),Gt[3]=Bn(Gt[3],sr),Lt.push(Wn),Lt.push(Rr)}}var Gn=[];function Ur(ge,xe,ut){typeof ge[0][0][0]=="number"&&(ge=[ge]),typeof xe[0][0][0]=="number"&&(xe=[xe]);var Lt=function(sr,Ei,oi){var Mr=null;return sr.length*Ei.length==0&&(oi===N?Mr=Gn:oi===q?Mr=sr:oi!==W&&oi!==J||(Mr=sr.length===0?Ei:sr)),Mr}(ge,xe,ut);if(Lt)return Lt===Gn?null:Lt;var Gt=[1/0,1/0,-1/0,-1/0],Ut=[1/0,1/0,-1/0,-1/0],nn=function(sr,Ei,oi,Mr,zi){var ci,Yr,ai,Lr,Xn,Br,Ai=new kn(null,nt);for(ai=0,Lr=sr.length;ai<Lr;ai++)for(Xn=0,Br=(ci=sr[ai]).length;Xn<Br;Xn++)(Yr=Xn===0)&&Jn++,Hn(ci[Xn],!0,Jn,Ai,oi,Yr);for(ai=0,Lr=Ei.length;ai<Lr;ai++)for(Xn=0,Br=(ci=Ei[ai]).length;Xn<Br;Xn++)Yr=Xn===0,zi===q&&(Yr=!1),Yr&&Jn++,Hn(ci[Xn],!1,Jn,Ai,Mr,Yr);return Ai}(ge,xe,Gt,Ut,ut);if(Lt=function(sr,Ei,oi,Mr,zi){var ci=null;return(oi[0]>Mr[2]||Mr[0]>oi[2]||oi[1]>Mr[3]||Mr[1]>oi[3])&&(zi===N?ci=Gn:zi===q?ci=sr:zi!==W&&zi!==J||(ci=sr.concat(Ei))),ci}(ge,xe,Gt,Ut,ut))return Lt===Gn?null:Lt;for(var An=function(sr){var Ei,oi,Mr=function(ai){var Lr,Xn,Br,Ai,En=[];for(Xn=0,Br=ai.length;Xn<Br;Xn++)((Lr=ai[Xn]).left&&Lr.inResult||!Lr.left&&Lr.otherEvent.inResult)&&En.push(Lr);for(var pr=!1;!pr;)for(pr=!0,Xn=0,Br=En.length;Xn<Br;Xn++)Xn+1<Br&&nt(En[Xn],En[Xn+1])===1&&(Ai=En[Xn],En[Xn]=En[Xn+1],En[Xn+1]=Ai,pr=!1);for(Xn=0,Br=En.length;Xn<Br;Xn++)(Lr=En[Xn]).otherPos=Xn;for(Xn=0,Br=En.length;Xn<Br;Xn++)(Lr=En[Xn]).left||(Ai=Lr.otherPos,Lr.otherPos=Lr.otherEvent.otherPos,Lr.otherEvent.otherPos=Ai);return En}(sr),zi={},ci=[],Yr=function(){if(!zi[Ei]){var ai=ci.length,Lr=function(En,pr,ui){var ki=new $t;if(En.prevInResult!=null){var gi=En.prevInResult,eo=gi.outputContourId;if(gi.resultTransition>0){var Vr=pr[eo];if(Vr.holeOf!=null){var Ki=Vr.holeOf;pr[Ki].holeIds.push(ui),ki.holeOf=Ki,ki.depth=pr[eo].depth}else pr[eo].holeIds.push(ui),ki.holeOf=eo,ki.depth=pr[eo].depth+1}else ki.holeOf=null,ki.depth=pr[eo].depth}else ki.holeOf=null,ki.depth=0;return ki}(Mr[Ei],ci,ai),Xn=function(En){zi[En]=!0,En<Mr.length&&Mr[En]&&(Mr[En].outputContourId=ai)},Br=Ei,Ai=Ei;for(Lr.points.push(Mr[Ei].point);Xn(Br),Xn(Br=Mr[Br].otherPos),Lr.points.push(Mr[Br].point),!((Br=Ct(Br,Mr,zi,Ai))==Ai||Br>=Mr.length)&&Mr[Br];);ci.push(Lr)}};for(Ei=0,oi=Mr.length;Ei<oi;Ei++)Yr();return ci}(function(sr,Ei,oi,Mr,zi,ci){for(var Yr,ai,Lr,Xn=new p(Kt),Br=[],Ai=Math.min(Mr[2],zi[2]);sr.length!==0;){var En=sr.pop();if(Br.push(En),ci===N&&En.point[0]>Ai||ci===q&&En.point[0]>Mr[2])break;if(En.left){ai=Yr=Xn.insert(En),Yr=Yr!==(Lr=Xn.minNode())?Xn.prev(Yr):null,ai=Xn.next(ai);var pr=Yr?Yr.key:null;if(ie(En,pr,ci),ai&&on(En,ai.key,sr)===2&&(ie(En,pr,ci),ie(ai.key,En,ci)),Yr&&on(Yr.key,En,sr)===2){var ui=Yr;ie(pr,(ui=ui!==Lr?Xn.prev(ui):null)?ui.key:null,ci),ie(En,pr,ci)}}else ai=Yr=Xn.find(En=En.otherEvent),Yr&&ai&&(Yr=Yr!==Lr?Xn.prev(Yr):null,ai=Xn.next(ai),Xn.remove(En),ai&&Yr&&on(Yr.key,ai.key,sr))}return Br}(nn,0,0,Gt,Ut,ut)),or=[],ar=0;ar<An.length;ar++){var Wn=An[ar];if(Wn.isExterior()){for(var Rr=[Wn.points],Kr=0;Kr<Wn.holeIds.length;Kr++)Rr.push(An[Wn.holeIds[Kr]].points);or.push(Rr)}}return or}var ii={UNION:W,DIFFERENCE:q,INTERSECTION:N,XOR:J};l.diff=function(ge,xe){return Ur(ge,xe,q)},l.intersection=function(ge,xe){return Ur(ge,xe,N)},l.operations=ii,l.union=function(ge,xe){return Ur(ge,xe,W)},l.xor=function(ge,xe){return Ur(ge,xe,J)},Object.defineProperty(l,"__esModule",{value:!0})})(o)}(0,SB.exports)),SB.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function oT(u,o,l,d){const p=[],y=d===0?(_,S,P,I,k,D)=>{_.push(new yt(D,P+(D-S)/(I-S)*(k-P)))}:(_,S,P,I,k,D)=>{_.push(new yt(S+(D-P)/(k-P)*(I-S),D))};for(const _ of u){const S=[];for(const P of _){if(P.length<=2)continue;const I=[];for(let N=0;N<P.length-1;N++){const W=P[N].x,q=P[N].y,J=P[N+1].x,ie=P[N+1].y,ae=d===0?W:q,me=d===0?J:ie;ae<o?me>o&&y(I,W,q,J,ie,o):ae>l?me<l&&y(I,W,q,J,ie,l):I.push(P[N]),me<o&&ae>=o&&y(I,W,q,J,ie,o),me>l&&ae<=l&&y(I,W,q,J,ie,l)}let k=P[P.length-1];const D=d===0?k.x:k.y;D>=o&&D<=l&&I.push(k),I.length&&(k=I[I.length-1],I[0].x===k.x&&I[0].y===k.y||I.push(I[0]),S.push(I))}S.length&&p.push(S)}return p}function Kne(u,o){const l=iM(u),d=iM([o]),p=TB.intersection(l,d);return p==null?[]:EB(p)}function Yne(u,o){let d=iM(u,65536);for(;o.valid();o.next()){const[p,y]=o.get(),_=p.x*65536,S=p.y*65536,P=y.x*65536,I=y.y*65536,k=P-_,D=I-S,N=Math.hypot(k,D),W=Math.trunc(D/N*3),q=-Math.trunc(k/N*3);d=TB.diff(d,[[[_,S],[P,I],[P+W,I+q],[_+W,S+q],[_,S]]])}return EB(d,1/65536)}function iM(u,o=1){return[u.map(l=>l.map(d=>[d.x*o,d.y*o]))]}function EB(u,o=1){return u.map(l=>l.map((d,p)=>{const y=d.map(_=>new yt(_[0]*o,_[1]*o).round());return p>0&&y.reverse(),y}))}class oM{constructor(o,l){this.layoutVertexArray=new oc,this.indexArray=new bo,this.lineIndexArray=new ru,this.triangleSegments=new Ti,this.lineSegments=new Ti,this.programConfigurations=new ih(o.layers,{zoom:o.zoom,lut:o.lut}),this.uploaded=!1,l&&(this.elevatedLayoutVertexArray=new xd)}update(o,l,d,p,y,_,S){this.programConfigurations.updatePaintArrays(o,l,y,d,p,_,S)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,kne.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.lineIndexBuffer=o.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=o.createVertexBuffer(this.elevatedLayoutVertexArray,Rne.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(o,l,d,p,y,_){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,l,d,p,y,_)}}class aM{constructor(o){this.zoom=o.zoom,this.pixelRatio=o.pixelRatio,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new oM(o,!1),this.elevationBufferData=new oM(o,!0),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=o.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(o,l){}populate(o,l,d,p){this.hasPattern=YI("fill",this.layers,this.pixelRatio,l);const y=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:S,id:P,index:I,sourceLayerIndex:k}of o){const D=this.layers[0]._featureFilter.needGeometry,N=an(S,D);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),N,d))continue;const W=y?y.evaluate(N,{},d,l.availableImages):void 0,q={id:P,properties:S.properties,type:S.type,sourceLayerIndex:k,index:I,geometry:D?N.geometry:Yt(S,d,p),patterns:{},sortKey:W};_.push(q)}y&&_.sort((S,P)=>S.sortKey-P.sortKey);for(const S of _){const{geometry:P,index:I,sourceLayerIndex:k}=S;if(this.hasPattern){const D=JI("fill",this.layers,S,this.zoom,this.pixelRatio,l);this.patternFeatures.push(D)}else this.addFeature(S,P,I,d,{},l.availableImages,l.brightness,l.elevationFeatures);l.featureIndex.insert(o[I].feature,P,I,k,this.index)}}update(o,l,d,p,y,_,S){this.bufferData.update(o,l,d,p,y,_,S),this.elevationBufferData.update(o,l,d,p,y,_,S)}addFeatures(o,l,d,p,y,_){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,l,d,p,_,o.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(o){this.bufferData.upload(o),this.elevationBufferData.upload(o),this.elevatedStructures&&this.elevatedStructures.upload(o)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(o,l,d,p,y,_=[],S,P){const I=rT(l,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(o,I,p,d,P):this.addGeometry(I,this.bufferData),this.bufferData.populatePaintArrays(o,d,y,_,p,S),this.elevationBufferData.populatePaintArrays(o,d,y,_,p,S)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(o){this.elevatedStructures&&this.elevatedStructures.construct(o)}addElevatedRoadFeature(o,l,d,p,y){const _=new Array,S=rM.getElevationFeature(o,y);if(S){{const P=this.clipPolygonsToTile(l,1);P.length>0&&_.push({polygons:P,elevationFeature:S,elevationTileID:d})}for(const P of _)if(P.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Ms(P.elevationTileID));const k=P.elevationFeature.isTunnel();let D=0;o.properties.hasOwnProperty(yB)&&(D=+o.properties[yB]);for(const N of P.polygons)this.elevatedStructures.addPortalCandidates(P.elevationFeature.id,N,k,P.elevationFeature,D)}P.elevationFeature.constantHeight==null&&(P.polygons=this.prepareElevatedPolygons(P.polygons,P.elevationFeature,P.elevationTileID));const I=new xB(d,P.elevationTileID);this.addElevatedGeometry(P.polygons,I,P.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p)}}else this.addGeometry(l,this.bufferData)}addElevatedGeometry(o,l,d,p,y){const _={elevation:d,elevationSampler:l,bias:p,index:y},[S,P]=this.addGeometry(o,this.elevationBufferData,_);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:S,max:P}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,S),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,P))}addGeometry(o,l,d){let p=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,_=null;d&&(_=d.elevationSampler.constantElevation(d.elevation,d.bias),_!=null&&(p=_,y=_));const S=(P,I,k)=>{if(d!=null)if(I.push(P),_!=null)l.elevatedLayoutVertexArray.emplaceBack(_),k.push(_);else{const D=d.elevationSampler.pointElevation(P,d.elevation,d.bias);l.elevatedLayoutVertexArray.emplaceBack(D),k.push(D),p=Math.min(p,D),y=Math.max(y,D)}};for(const P of o){let I=0;for(const de of P)I+=de.length;const k=l.triangleSegments.prepareSegment(I,l.layoutVertexArray,l.indexArray),D=k.vertexLength,N=[],W=[],q=[],J=[],ie=[],ae=l.layoutVertexArray.length;for(const de of P){if(de.length===0)continue;de!==P[0]&&W.push(N.length/2);const Q=l.lineSegments.prepareSegment(de.length,l.layoutVertexArray,l.lineIndexArray),ue=Q.vertexLength;d&&ie.push(l.layoutVertexArray.length-ae),S(de[0],q,J),l.layoutVertexArray.emplaceBack(de[0].x,de[0].y),l.lineIndexArray.emplaceBack(ue+de.length-1,ue),N.push(de[0].x),N.push(de[0].y);for(let pe=1;pe<de.length;pe++)S(de[pe],q,J),l.layoutVertexArray.emplaceBack(de[pe].x,de[pe].y),l.lineIndexArray.emplaceBack(ue+pe-1,ue+pe),N.push(de[pe].x),N.push(de[pe].y);Q.vertexLength+=de.length,Q.primitiveLength+=de.length}const me=tx(N,W);for(let de=0;de<me.length;de+=3)l.indexArray.emplaceBack(D+me[de],D+me[de+1],D+me[de+2]);if(me.length>0&&d&&this.elevationMode==="hd-road-base"){const de=d.elevation.isTunnel(),Q=d.elevation.safeArea,ue=this.elevatedStructures.addVertices(q,J);this.elevatedStructures.addTriangles(me,ue,de);const pe=ie.length;if(pe>0){for(let ve=0;ve<pe-1;ve++)this.elevatedStructures.addRenderableRing(d.index,ie[ve]+ue,ie[ve+1]-ie[ve],de,Q);this.elevatedStructures.addRenderableRing(d.index,ie[pe-1]+ue,q.length-ie[pe-1],de,Q)}}k.vertexLength+=I,k.primitiveLength+=me.length/3}return[p,y]}prepareElevatedPolygons(o,l,d){const p=1/Ze(d),y=[];for(const _ of o){const S=Yne(_,new vB(l,p));y.push(...S)}return y}clipPolygonsToTile(o,l){const d=-l,p=-l,y=jt+l,_=jt+l;let S=0;const P=[],I=[];for(;S<o.length;S++){const N=o[S],W=n0(N);(W.min.x>=d&&W.max.x<=y&&W.min.y>=p&&W.max.y<=_?P:I).push(N)}if(P.length===o.length)return o;const k=[new yt(d,p),new yt(y,p),new yt(y,_),new yt(d,_),new yt(d,p)],D=P;for(const N of I)D.push(...Kne(N,k));return D}}let AB,PB,CB,IB;Zt(aM,"FillBucket",{omit:["layers","patternFeatures"]}),Zt(oM,"FillBufferData"),Zt(Ms,"ElevatedStructures");class sM{constructor(o,l,d,p){if(this.triangleCount=l.length/3,this.min=new yt(0,0),this.max=new yt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||o.length===0)return;const[y,_]=[o[0].clone(),o[0].clone()];for(let D=1;D<o.length;++D){const N=o[D];y.x=Math.min(y.x,N.x),y.y=Math.min(y.y,N.y),_.x=Math.max(_.x,N.x),_.y=Math.max(_.y,N.y)}if(p){const D=Math.ceil(Math.max(_.x-y.x,_.y-y.y)/p);d=Math.max(d,D)}if(d===0)return;this.min=y,this.max=_;const S=this.max.sub(this.min);S.x=Math.max(S.x,1),S.y=Math.max(S.y,1);const P=Math.max(S.x,S.y)/d;this.cellsX=Math.max(1,Math.ceil(S.x/P)),this.cellsY=Math.max(1,Math.ceil(S.y/P)),this.xScale=1/P,this.yScale=1/P;const I=[];for(let D=0;D<this.triangleCount;D++){const N=o[l[3*D+0]].sub(this.min),W=o[l[3*D+1]].sub(this.min),q=o[l[3*D+2]].sub(this.min),J=su(Math.floor(Math.min(N.x,W.x,q.x)),this.xScale,this.cellsX),ie=su(Math.floor(Math.max(N.x,W.x,q.x)),this.xScale,this.cellsX),ae=su(Math.floor(Math.min(N.y,W.y,q.y)),this.yScale,this.cellsY),me=su(Math.floor(Math.max(N.y,W.y,q.y)),this.yScale,this.cellsY),de=new yt(0,0),Q=new yt(0,0),ue=new yt(0,0),pe=new yt(0,0);for(let ve=ae;ve<=me;++ve){de.y=Q.y=ve*P,ue.y=pe.y=(ve+1)*P;for(let Ie=J;Ie<=ie;++Ie)de.x=ue.x=Ie*P,Q.x=pe.x=(Ie+1)*P,(_i(N,W,q,de,Q,pe)||_i(N,W,q,de,pe,ue))&&I.push({cellIdx:ve*this.cellsX+Ie,triIdx:D})}}if(I.length===0)return;I.sort((D,N)=>D.cellIdx-N.cellIdx||D.triIdx-N.triIdx);let k=0;for(;k<I.length;){const D=I[k].cellIdx,N={start:this.payload.length,len:0};for(;k<I.length&&I[k].cellIdx===D;)++N.len,this.payload.push(I[k++].triIdx);this.cells[D]=N}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(o,l){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>o.x||o.y>this.max.y||this.min.y>o.y)return;const d=su(o.x-this.min.x,this.xScale,this.cellsX),p=su(o.y-this.min.y,this.yScale,this.cellsY),y=this.cells[p*this.cellsX+d];if(y){this._lazyInitLookup();for(let _=0;_<y.len;_++){const S=this.payload[y.start+_],P=Math.floor(S/8),I=1<<S%8;if(!(this.lookup[P]&I)&&(this.lookup[P]|=I,l.push(S),l.length===this.triangleCount))return}}}query(o,l,d){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>l.x||o.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();const p=su(o.x-this.min.x,this.xScale,this.cellsX),y=su(l.x-this.min.x,this.xScale,this.cellsX),_=su(o.y-this.min.y,this.yScale,this.cellsY),S=su(l.y-this.min.y,this.yScale,this.cellsY);for(let P=_;P<=S;P++)for(let I=p;I<=y;I++){const k=this.cells[P*this.cellsX+I];if(k)for(let D=0;D<k.len;D++){const N=this.payload[k.start+D],W=Math.floor(N/8),q=1<<N%8;if(!(this.lookup[W]&q)&&(this.lookup[W]|=q,d.push(N),d.length===this.triangleCount))return}}}}function su(u,o,l){return Math.max(0,Math.min(l-1,Math.floor(u*o)))}Zt(sM,"TriangleGridIndex");class MB{constructor(o){this.zoom=o.zoom,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[]}updateFootprints(o,l){for(const d of this.footprints)l.push({footprint:d,id:o})}populate(o,l,d,p){const y=[];for(const{feature:_,id:S,index:P,sourceLayerIndex:I}of o){const k=this.layers[0]._featureFilter.needGeometry,D=an(_,k);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),D,d))continue;const N={id:S,properties:_.properties,type:_.type,sourceLayerIndex:I,index:P,geometry:k?D.geometry:Yt(_,d,p),patterns:{}};y.push(N)}for(const _ of y){const{geometry:S,index:P,sourceLayerIndex:I}=_;this.addFeature(_,S,P,d,{},l.availableImages,l.brightness),l.featureIndex.insert(o[P].feature,S,P,I,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(o){}update(o,l,d,p,y,_,S){}destroy(){}addFeature(o,l,d,p,y,_=[],S){for(const P of rT(l,2)){const I=[],k=[],D=[],N=new yt(1/0,1/0),W=new yt(-1/0,-1/0);for(const ie of P)if(ie.length!==0){ie!==P[0]&&D.push(k.length/2);for(let ae=0;ae<ie.length;ae++)k.push(ie[ae].x),k.push(ie[ae].y),I.push(ie[ae]),N.x=Math.min(N.x,ie[ae].x),N.y=Math.min(N.y,ie[ae].y),W.x=Math.max(W.x,ie[ae].x),W.y=Math.max(W.y,ie[ae].y)}const q=tx(k,D),J=new sM(I,q,8,256);this.footprints.push({vertices:I,indices:q,grid:J,min:N,max:W})}}}Zt(MB,"ClipBucket",{omit:["layers"]});const Jne=vr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Qne=vr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),ere=vr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),tre=vr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),nre=vr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),rre=vr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:ire}=Jne,aT=Number.MAX_SAFE_INTEGER;function OB(u,o,l,d){return u.order<o||u.order===aT||!(u.clipMask&l)||function(p,y){return y.length!==0&&y.find(_=>_===p)===void 0}(d,u.clipScope)}function sT(u,o){return u.x-o.x||u.y-o.y}function kB(u,o){return sT(u.min,o.min)===0&&sT(u.max,o.max)===0}function lM(u,o){return!(u.min.x>o.max.x||u.max.x<o.min.x||u.min.y>o.max.y||u.max.y<o.min.y)}function cM(u,o){if(u.length!==o.length)return!1;for(let l=0;l<u.length;l++)if(u[l].sourceId!==o[l].sourceId||!kB(u[l],o[l])||u[l].order!==o[l].order||u[l].clipMask!==o[l].clipMask||!ti(u[l].clipScope,o[l].clipScope))return!1;return!0}function RB(u,o,l){const d=1/jt,p=1/(1<<l.canonical.z),y=(o.x*d+l.canonical.x)*p+l.wrap,_=(o.y*d+l.canonical.y)*p;return{min:new yt((u.x*d+l.canonical.x)*p+l.wrap,(u.y*d+l.canonical.y)*p),max:new yt(y,_)}}function ore(u,o,l){const d=1<<l.canonical.z,p=((o.x-l.wrap)*d-l.canonical.x)*jt,y=(o.y*d-l.canonical.y)*jt;return{min:new yt(((u.x-l.wrap)*d-l.canonical.x)*jt,(u.y*d-l.canonical.y)*jt),max:new yt(p,y)}}function DB(u,o,l,d,p,y,_){const S=u.indices,P=u.vertices,I=[];for(let k=d;k<d+p;k+=3){const D=o[l[k+0]+y],N=o[l[k+1]+y],W=o[l[k+2]+y],q=Math.min(D.x,N.x,W.x),J=Math.max(D.x,N.x,W.x),ie=Math.min(D.y,N.y,W.y),ae=Math.max(D.y,N.y,W.y);I.length=0,u.grid.query(new yt(q,ie),new yt(J,ae),I);for(let me=0;me<I.length;me++){const de=I[me];if(_i(P[S[3*de+0]],P[S[3*de+1]],P[S[3*de+2]],D,N,W,_))return!0}}return!1}function LB(u,o,l,d){if(!u||!l)return!1;let p=u.vertices;if(!o.canonical.equals(d.canonical)||o.wrap!==d.wrap){if(l.vertices.length<u.vertices.length)return LB(l,d,u,o);const y=o.canonical,_=d.canonical,S=Math.pow(2,_.z-y.z);p=u.vertices.map(P=>new yt((P.x+y.x*jt)*S-_.x*jt,(P.y+y.y*jt)*S-_.y*jt))}return DB(l,p,u.indices,0,u.indices.length,0,0)}function zB(u,o,l,d){const p=Math.pow(2,d.z-l.z);return new yt((u+l.x*jt)*p-d.x*jt,(o+l.y*jt)*p-d.y*jt)}function NB(u,o){const l=[];o.grid.queryPoint(u,l);const d=o.indices,p=o.vertices;for(let y=0;y<l.length;y++){const _=l[y];if(Fr([p[d[3*_+0]],p[d[3*_+1]],p[d[3*_+2]]],u))return!0}return!1}const uM=[new yt(0,0),new yt(jt,0),new yt(jt,jt),new yt(0,jt)];function FB(u,o){const l=[];let d=[];if(!o||u.length<2)return[u];if(u.length===2)return Li(u[0],u[1],uM)?[u]:[];for(let p=0;p<u.length+2;p++){const y=u[p%u.length],_=u[(p+1)%u.length],S=Li(p===0?u[u.length-1]:u[(p-1)%u.length],y,uM),P=Li(y,_,uM),I=S||P;I&&d.push(y),I&&P||d.length>0&&(d.length>1&&l.push(d),d=[])}return d.length>1&&l.push(d),l}const hM=Od.VectorTileFeature.types,are=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],sre=["fill-extrusion-flood-light-ground-radius"],lre=Math.pow(2,13),cre=Math.pow(2,15)-1,BB=new yt(0,1),kd=2147483648;function ax(u,o,l,d,p,y,_,S){u.emplaceBack((o<<1)+_,(l<<1)+y,(Math.floor(d*lre)<<1)+p,Math.round(S))}function sx(u,o,l){u.emplaceBack(o.x*jt,o.y*jt,l?1:0)}function lT(u,o,l,d,p,y){u.emplaceBack(o.x,o.y,(l.x<<1)+d,(l.y<<1)+p,y)}function lx(u,o,l){u.emplaceBack(o.x,o.y,o.z,l[0]*16384,l[1]*16384,l[2]*16384)}class jB{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class $B{constructor(){this.centroidXY=new yt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new yt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new yt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new yt(this.max.x-this.min.x,this.max.y-this.min.y)}}class UB{constructor(){this.acc=new yt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(o,l){o.min.x===Number.MAX_VALUE&&(o.min.x=o.max.x=l.x,o.min.y=o.max.y=l.y)}appendEdge(o,l,d){this.accCount++,this.acc._add(l);let p=!!this.borders;l.x<o.min.x?(o.min.x=l.x,p=!0):l.x>o.max.x&&(o.max.x=l.x,p=!0),l.y<o.min.y?(o.min.y=l.y,p=!0):l.y>o.max.y&&(o.max.y=l.y,p=!0),((l.x===0||l.x===jt)&&l.x===d.x)!=((l.y===0||l.y===jt)&&l.y===d.y)&&this.processBorderOverlap(l,d),p&&this.checkBorderIntersection(l,d)}checkBorderIntersection(o,l){l.x<0!=o.x<0&&this.addBorderIntersection(0,yn(l.y,o.y,(0-l.x)/(o.x-l.x))),l.x>jt!=o.x>jt&&this.addBorderIntersection(1,yn(l.y,o.y,(jt-l.x)/(o.x-l.x))),l.y<0!=o.y<0&&this.addBorderIntersection(2,yn(l.x,o.x,(0-l.y)/(o.y-l.y))),l.y>jt!=o.y>jt&&this.addBorderIntersection(3,yn(l.x,o.x,(jt-l.y)/(o.y-l.y)))}addBorderIntersection(o,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[o];l<d[0]&&(d[0]=l),l>d[1]&&(d[1]=l)}processBorderOverlap(o,l){if(o.x===l.x){if(o.y===l.y)return;const d=o.x===0?0:1;this.addBorderIntersection(d,l.y),this.addBorderIntersection(d,o.y)}else{const d=o.y===0?2:3;this.addBorderIntersection(d,l.x),this.addBorderIntersection(d,o.x)}}centroid(){return this.accCount===0?new yt(0,0):new yt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((o,l)=>o+ +(l[0]!==Number.MAX_VALUE),0):0}}function VB(u,o){const l=u.add(o)._unit(),d=Ue(u.x*l.x+u.y*l.y,-1,1);var p,y,_;return p=Math.acos(d),Math.min(4,Math.max(-4,Math.tan(p)))/4*cre*((y=u).x*(_=o).y-y.y*_.x<0?-1:1)}const ure=[u=>u.x<0,u=>u.x>jt,u=>u.y<0,u=>u.y>jt];function hre(u,o,l,d){const p=[4];if(d===0)return p;l._mult(d);const y=u.sub(l),_=o.sub(l),S=[u,o,y,_];for(let P=0;P<4;P++)for(const I of S)if(ure[P](I)){p.push(P);break}return p}class GB{constructor(o){this.vertexArray=new j0,this.indexArray=new bo,this.programConfigurations=new ih(o.layers,{zoom:o.zoom,lut:o.lut},l=>sre.includes(l)),this._segments=new Ti,this.hiddenByLandmarkVertexArray=new Qg,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Ti}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(o,l,d,p=!1){const y=o.length;if(y>2){let _=Math.max(0,this._segments.get().length-1);const S=this._segments._prepareSegment(4*y,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let P;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const I=o[0],k=o[1];P=VB(I.sub(o[y-1])._perp()._unit(),k.sub(I)._perp()._unit())}for(let I=0;I<y;I++){const k=I===y-1?0:I+1,D=o[I],N=o[k],W=o[k===y-1?0:k+1],q=N.sub(D)._perp()._unit(),J=VB(q,W.sub(N)._perp()._unit()),ie=P,ae=J;if(dM(D,N,l)||p&&qB(D,l)&&qB(N,l)){P=J;continue}const me=S.vertexLength;lT(this.vertexArray,D,N,1,1,ie),lT(this.vertexArray,D,N,1,0,ie),lT(this.vertexArray,D,N,0,1,ae),lT(this.vertexArray,D,N,0,0,ae),S.vertexLength+=4;const de=hre(D,N,q,d);for(const Q of de)this._segmentToGroundQuads[_].push({id:me,region:Q}),this._segmentToRegionTriCounts[_][Q]+=2,S.primitiveLength+=2;P=J}}}prepareBorderSegments(){if(!this.hasData())return;const o=this._segments.get(),l=o.length;for(let d=0;d<l;d++)this._segmentToGroundQuads[d].sort((p,y)=>p.region-y.region);for(let d=0;d<l;d++){const p=this._segmentToGroundQuads[d],y=o[d],_=this._segmentToRegionTriCounts[d];_.reduce((P,I)=>P+I,0);let S=0;for(let P=0;P<=4;P++){const I=_[P];if(I!==0){let k=this.regionSegments[P];k||(k=this.regionSegments[P]=new Ti);const D={vertexOffset:y.vertexOffset,primitiveOffset:y.primitiveOffset+S,vertexLength:y.vertexLength,primitiveLength:I};k.get().push(D)}S+=I}for(let P=0;P<p.length;P++){const I=p[P].id;this.indexArray.emplaceBack(I,I+1,I+3),this.indexArray.emplaceBack(I,I+3,I+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(o,l,d,p,y,_){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,o,l,d,p,y,_)}upload(o){this.hasData()&&(this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Qne.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}uploadPaintProperties(o){this.hasData()&&this.programConfigurations.upload(o)}update(o,l,d,p,y,_,S){this.hasData()&&this.programConfigurations.updatePaintArrays(o,l,d,p,y,_,S)}updateHiddenByLandmark(o){if(!this.hasData())return;const l=o.groundVertexCount+o.groundVertexArrayOffset;if(o.groundVertexCount===0)return;const d=o.flags&kd?1:0;for(let p=o.groundVertexArrayOffset;p<l;++p)this.hiddenByLandmarkVertexArray.emplace(p,d);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(o){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=o.createVertexBuffer(this.hiddenByLandmarkVertexArray,nre.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let o=0;o<=4;o++){const l=this.regionSegments[o];l&&l.destroy()}}}}class cT{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.pixelRatio=o.pixelRatio,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new bo,this.footprintVertices=new oc,this.footprintSegments=[],this.layoutVertexArray=new th,this.centroidVertexArray=new WS,this.wallVertexArray=new qS,this.indexArray=new bo,this.programConfigurations=new ih(o.layers,{zoom:o.zoom,lut:o.lut},l=>are.includes(l)),this.segments=new Ti,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new GB(o),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(o,l){}populate(o,l,d,p){this.features=[],this.hasPattern=YI("fill-extrusion",this.layers,this.pixelRatio,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Ze(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:y,id:_,index:S,sourceLayerIndex:P}of o){const I=this.layers[0]._featureFilter.needGeometry,k=an(y,I);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),k,d))continue;const D={id:_,sourceLayerIndex:P,index:S,geometry:I?k.geometry:Yt(y,d,p),properties:y.properties,type:y.type,patterns:{}},N=this.layoutVertexArray.length,W=hM[D.type]==="Polygon";if(this.hasPattern)this.features.push(JI("fill-extrusion",this.layers,D,this.zoom,this.pixelRatio,l));else if(this.wallMode)for(const q of D.geometry)for(const J of FB(q,W))this.addFeature(D,[J],S,d,{},l.availableImages,p,l.brightness);else this.addFeature(D,D.geometry,S,d,{},l.availableImages,p,l.brightness);l.featureIndex.insert(y,D.geometry,S,P,this.index,N)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(o,l,d,p,y,_){for(const S of this.features){const P=hM[S.type]==="Polygon",{geometry:I}=S;if(this.wallMode)for(const k of I)for(const D of FB(k,P))this.addFeature(S,[D],S.index,l,d,p,y,_);else this.addFeature(S,I,S.index,l,d,p,y,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(o,l,d,p,y,_,S){this.programConfigurations.updatePaintArrays(o,l,y,d,p,_,S),this.groundEffect.update(o,l,y,d,p,_,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,ire),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.wallVertexBuffer=o.createVertexBuffer(this.wallVertexArray,tre.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,rre.members,!0)),this.groundEffect.upload(o)),this.groundEffect.uploadPaintProperties(o),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.groundEffect.uploadHiddenByLandmark(o),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,ere.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,l,d,p,y,_,S,P){const I=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,k=[new yt(0,0),new yt(jt,jt)],D=S.projection,N=D.name==="globe",W=this.wallMode||hM[o.type]==="Polygon",q=new UB;q.centroidDataIndex=this.centroidData.length;const J=new $B,ie=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},p)<=0,ae=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},p);let me;if(J.height=ae,J.vertexArrayOffset=this.layoutVertexArray.length,J.groundVertexArrayOffset=this.groundEffect.vertexArray.length,N&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new nh),this.wallMode){if(N)return void nr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(l.length!==1)return;me=function(Fe){const He=Fe[0].x===Fe[Fe.length-1].x&&Fe[0].y===Fe[Fe.length-1].y;(function($t){let Ct=0;const kn=$t.length;for(let en=0;en<kn;en++)Ct+=($t[(en+1)%kn].x-$t[en].x)*($t[(en+1)%kn].y+$t[en].y);return Ct>=0})(Fe)||(Fe=Fe.reverse());const St={geometry:[],joinNormals:[],indices:[]},_t=[],bt=[],Pt=[];let st=Fe.length;for(;st>=2&&Fe[st-1].equals(Fe[st-2]);)st--;if(st<(He?3:2))return St;let xt,nt,lt,It,Mt,on=0;for(;on<st-1&&Fe[on].equals(Fe[on+1]);)on++;He&&(xt=Fe[st-2],Mt=Fe[on].sub(xt)._unit()._perp());for(let $t=on;$t<st;$t++){if(lt=$t===st-1?He?Fe[on+1]:void 0:Fe[$t+1],lt&&Fe[$t].equals(lt))continue;Mt&&(It=Mt),xt&&(nt=xt),xt=Fe[$t],Mt=lt?lt.sub(xt)._unit()._perp():It,It=It||Mt;let Ct=It.add(Mt);Ct.x===0&&Ct.y===0||Ct._unit();const kn=Ct.x*Mt.x+Ct.y*Mt.y,en=kn!==0?1/kn:1/0,tn=It.x*Mt.y-It.y*Mt.x>0;let Pn="miter";const Bn=2;Pn==="miter"&&en>Bn&&(Pn="bevel"),Pn==="bevel"&&(en>100&&(Pn="flipbevel"),en<Bn&&(Pn="miter"));const $n=(Jn,Hn,Gn,Ur)=>{const ii=new yt(Jn.x,Jn.y),ge=new yt(Jn.x,Jn.y);ii.x+=Hn.x*Ur,ii.y+=Hn.y*Ur,ge.x-=Hn.x*Math.max(Gn,1),ge.y-=Hn.y*Math.max(Gn,1),Pt.push(Hn),_t.push(ii),bt.push(ge)};if(Pn==="miter")Ct._mult(en),$n(xt,Ct,0,0);else if(Pn==="flipbevel")Ct=Mt.mult(-1),$n(xt,Ct,0,0),$n(xt,Ct.mult(-1),0,0);else{const Jn=-Math.sqrt(en*en-1),Hn=tn?Jn:0,Gn=tn?0:Jn;nt&&$n(xt,It,Hn,Gn),lt&&$n(xt,Mt,Hn,Gn)}}St.geometry=[..._t,...bt.reverse(),_t[0]],St.joinNormals=[...Pt,...Pt.reverse(),Pt[Pt.length-1]];const Kt=St.geometry.length-1;for(let $t=0;$t<Kt/2;$t++)if($t+1<Kt/2){let Ct=$t,kn=$t+1,en=Kt-1-$t,tn=Kt-2-$t;Ct=Ct===0?Kt-1:Ct-1,kn=kn===0?Kt-1:kn-1,en=en===0?Kt-1:en-1,tn=tn===0?Kt-1:tn-1,St.indices.push(en),St.indices.push(kn),St.indices.push(Ct),St.indices.push(en),St.indices.push(tn),St.indices.push(kn)}return St}(l[0]),l=[me.geometry]}const de=(Fe,He)=>Fe<(He.length-1)/2||Fe===He.length-1,Q=this.wallMode?[l]:rT(l,500);for(let Fe=Q.length-1;Fe>=0;Fe--){const He=Q[Fe];(He.length===0||(ue=He[0]).every(ct=>ct.x<=0)||ue.every(ct=>ct.x>=jt)||ue.every(ct=>ct.y<=0)||ue.every(ct=>ct.y>=jt))&&Q.splice(Fe,1)}var ue;let pe;if(N)pe=YB(Q,k,p);else{pe=[];for(const Fe of Q)pe.push({polygon:Fe,bounds:k})}const ve=W?this.edgeRadius:0,Ie=ve>0&&this.zoom<17,De=(Fe,He)=>{if(Fe.length===0)return!1;const ct=Fe[Fe.length-1];return He.x===ct.x&&He.y===ct.y};for(const{polygon:Fe,bounds:He}of pe){let ct=0,St=0;for(const st of Fe)W&&!st[0].equals(st[st.length-1])&&st.push(st[0]),St+=W?st.length-1:st.length;const _t=this.segments.prepareSegment((W?5:4)*St,this.layoutVertexArray,this.indexArray);J.footprintSegIdx<0&&(J.footprintSegIdx=this.footprintSegments.length),J.polygonSegIdx<0&&(J.polygonSegIdx=this.polygonSegments.length);const bt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Pt=new jB;if(Pt.vertexOffset=this.footprintVertices.length,Pt.indexOffset=3*this.footprintIndices.length,Pt.ringIndices=[],W){const st=[],xt=[];ct=_t.vertexLength;for(let lt=0;lt<Fe.length;lt++){const It=Fe[lt];It.length&&lt!==0&&xt.push(st.length/2);const Mt=[];let on,Kt;on=It[1].sub(It[0])._perp()._unit(),Pt.ringIndices.push(It.length-1);for(let $t=1;$t<It.length;$t++){const Ct=It[$t],kn=It[$t===It.length-1?1:$t+1],en=Ct.clone();if(ve){Kt=kn.sub(Ct)._perp()._unit();const tn=on.add(Kt)._unit(),Pn=ve*Math.min(4,1/(on.x*tn.x+on.y*tn.y));en.x+=Pn*tn.x,en.y+=Pn*tn.y,en.x=Math.round(en.x),en.y=Math.round(en.y),on=Kt}if(!ie||ve!==0&&!Ie||De(Mt,en)||Mt.push(en),ax(this.layoutVertexArray,en.x,en.y,0,0,1,1,0),this.wallMode){const tn=de($t,It);sx(this.wallVertexArray,me.joinNormals[$t],!tn)}_t.vertexLength++,this.footprintVertices.emplaceBack(Ct.x,Ct.y),st.push(Ct.x,Ct.y),N&&lx(this.layoutVertexExtArray,D.projectTilePoint(en.x,en.y,p),D.upVector(p,en.x,en.y))}ie&&(ve===0||Ie)&&(Mt.length!==0&&De(Mt,Mt[0])&&Mt.pop(),this.groundEffect.addData(Mt,He,I))}const nt=this.wallMode?me.indices:tx(st,xt);for(let lt=0;lt<nt.length;lt+=3)this.footprintIndices.emplaceBack(Pt.vertexOffset+nt[lt+0],Pt.vertexOffset+nt[lt+1],Pt.vertexOffset+nt[lt+2]),this.indexArray.emplaceBack(ct+nt[lt],ct+nt[lt+2],ct+nt[lt+1]),_t.primitiveLength++;Pt.indexCount+=nt.length,Pt.vertexCount+=this.footprintVertices.length-Pt.vertexOffset}for(let st=0;st<Fe.length;st++){const xt=Fe[st];q.startRing(J,xt[0]);let nt=xt.length>4&&ZB(xt[xt.length-2],xt[0],xt[1]),lt=ve?dre(xt[xt.length-2],xt[0],xt[1],ve):0;const It=[];let Mt,on,Kt;on=xt[1].sub(xt[0])._perp()._unit();let $t=!0;for(let Ct=1,kn=0;Ct<xt.length;Ct++){let en=xt[Ct-1],tn=xt[Ct];const Pn=xt[Ct===xt.length-1?1:Ct+1];if(q.appendEdge(J,tn,en),dM(tn,en,He)){ve&&(on=Pn.sub(tn)._perp()._unit(),$t=!$t);continue}const Bn=tn.sub(en)._perp(),$n=Bn.x/(Math.abs(Bn.x)+Math.abs(Bn.y)),Jn=Bn.y>0?1:0,Hn=en.dist(tn);if(kn+Hn>32768&&(kn=0),ve){Kt=Pn.sub(tn)._perp()._unit();let ge=HB(en,tn,Pn,WB(on,Kt),ve);isNaN(ge)&&(ge=0);const xe=tn.sub(en)._unit();en=en.add(xe.mult(lt))._round(),tn=tn.add(xe.mult(-ge))._round(),lt=ge,on=Kt,ie&&this.zoom>=17&&(De(It,en)||It.push(en),De(It,tn)||It.push(tn))}const Gn=_t.vertexLength,Ur=xt.length>4&&ZB(en,tn,Pn);let ii=XB(kn,nt,$t);if(ax(this.layoutVertexArray,en.x,en.y,$n,Jn,0,0,ii),ax(this.layoutVertexArray,en.x,en.y,$n,Jn,0,1,ii),this.wallMode){const ge=de(Ct-1,xt),xe=me.joinNormals[Ct-1];sx(this.wallVertexArray,xe,ge),sx(this.wallVertexArray,xe,ge)}if(kn+=Hn,ii=XB(kn,Ur,!$t),nt=Ur,ax(this.layoutVertexArray,tn.x,tn.y,$n,Jn,0,0,ii),ax(this.layoutVertexArray,tn.x,tn.y,$n,Jn,0,1,ii),this.wallMode){const ge=de(Ct,xt),xe=me.joinNormals[Ct];sx(this.wallVertexArray,xe,ge),sx(this.wallVertexArray,xe,ge)}if(_t.vertexLength+=4,this.indexArray.emplaceBack(Gn+0,Gn+1,Gn+2),this.indexArray.emplaceBack(Gn+1,Gn+3,Gn+2),_t.primitiveLength+=2,ve){const ge=ct+(Ct===1?xt.length-2:Ct-2),xe=Ct===1?ct:ge+1;if(this.indexArray.emplaceBack(Gn+1,ge,Gn+3),this.indexArray.emplaceBack(ge,xe,Gn+3),_t.primitiveLength+=2,Mt===void 0&&(Mt=Gn),!dM(Pn,xt[Ct],He)){const ut=Ct===xt.length-1?Mt:_t.vertexLength;this.indexArray.emplaceBack(Gn+2,Gn+3,ut),this.indexArray.emplaceBack(Gn+3,ut+1,ut),this.indexArray.emplaceBack(Gn+3,xe,ut+1),_t.primitiveLength+=3}$t=!$t}if(N){const ge=this.layoutVertexExtArray,xe=D.projectTilePoint(en.x,en.y,p),ut=D.projectTilePoint(tn.x,tn.y,p),Lt=D.upVector(p,en.x,en.y),Gt=D.upVector(p,tn.x,tn.y);lx(ge,xe,Lt),lx(ge,xe,Lt),lx(ge,ut,Gt),lx(ge,ut,Gt)}}W&&(ct+=xt.length-1),ie&&ve&&this.zoom>=17&&(It.length!==0&&De(It,It[0])&&It.pop(),this.groundEffect.addData(It,He,I,ve>0))}this.footprintSegments.push(Pt),bt.triangleCount=this.indexArray.length-bt.triangleArrayOffset,this.polygonSegments.push(bt),++J.footprintSegLen,++J.polygonSegLen}if(J.vertexCount=this.layoutVertexArray.length-J.vertexArrayOffset,J.groundVertexCount=this.groundEffect.vertexArray.length-J.groundVertexArrayOffset,J.vertexCount!==0){if(J.centroidXY=q.borders?BB:this.encodeCentroid(q,J),this.centroidData.push(J),q.borders){this.featuresOnBorder.push(q);const Fe=this.featuresOnBorder.length-1;for(let He=0;He<q.borders.length;He++)q.borders[He][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[He].push(Fe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,y,_,p,P),this.groundEffect.addPaintPropertiesData(o,d,y,_,p,P),this.maxHeight=Math.max(this.maxHeight,ae)}}sortBorders(){for(let o=0;o<this.borderFeatureIndices.length;o++)this.borderFeatureIndices[o].sort((l,d)=>this.featuresOnBorder[l].borders[o][0]-this.featuresOnBorder[d].borders[o][0])}splitToSubtiles(){const o=[];for(let S=0;S<this.centroidData.length;S++){const P=this.centroidData[S],I=+(P.min.y+P.max.y>jt),k=2*I+(+(P.min.x+P.max.x>jt)^I);for(let D=0;D<P.polygonSegLen;D++){const N=P.polygonSegIdx+D;o.push({centroidIdx:S,subtile:k,polygonSegmentIdx:N,triangleSegmentIdx:this.polygonSegments[N].triangleSegIdx})}}const l=new bo;o.sort((S,P)=>S.triangleSegmentIdx===P.triangleSegmentIdx?S.subtile-P.subtile:S.triangleSegmentIdx-P.triangleSegmentIdx);let d=0,p=0,y=0;for(const S of o){if(S.triangleSegmentIdx!==d)break;y++}const _=o.length;for(;p!==o.length;){d=o[p].triangleSegmentIdx;let S=0,P=p,I=p;for(let k=P;k<y&&o[k].subtile===S;k++)I++;for(;P!==y;){const k=o[P];S=k.subtile;const D=this.centroidData[k.centroidIdx].min.clone(),N=this.centroidData[k.centroidIdx].max.clone(),W={vertexOffset:this.segments.segments[d].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[d].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let q=P;q<I;q++){const J=o[q],ie=this.polygonSegments[J.polygonSegmentIdx],ae=this.centroidData[J.centroidIdx].min,me=this.centroidData[J.centroidIdx].max,de=this.indexArray.uint16;for(let Q=ie.triangleArrayOffset;Q<ie.triangleArrayOffset+ie.triangleCount;Q++)l.emplaceBack(de[3*Q],de[3*Q+1],de[3*Q+2]);W.primitiveLength+=ie.triangleCount,D.x=Math.min(D.x,ae.x),D.y=Math.min(D.y,ae.y),N.x=Math.max(N.x,me.x),N.y=Math.max(N.y,me.y)}W.primitiveLength>0&&this.triangleSubSegments.push({segment:W,min:D,max:N}),P=I;for(let q=P;q<y&&o[q].subtile===o[P].subtile;q++)I++}p=y;for(let k=p;k<_&&o[k].triangleSegmentIdx===o[p].triangleSegmentIdx;k++)y++}l._trim(),this.indexArray=l}getVisibleSegments(o,l,d){const p=new Ti;if(this.wallMode){for(const J of this.triangleSubSegments)p.segments.push(J.segment);return p}let y=0,_=0;const S=1<<o.canonical.z;if(l){const J=l.getMinMaxForTile(o);J&&(y=J.min,_=J.max)}_+=this.maxHeight;const P=o.toUnwrapped();let I;const k=[P.canonical.x/S+P.wrap,P.canonical.y/S],D=[(P.canonical.x+1)/S+P.wrap,(P.canonical.y+1)/S],N=(J,ie,ae)=>[J[0]*(1-ae[0])+ie[0]*ae[0],J[1]*(1-ae[1])+ie[1]*ae[1]],W=[],q=[];for(const J of this.triangleSubSegments){W[0]=J.min.x/jt,W[1]=J.min.y/jt,q[0]=J.max.x/jt,q[1]=J.max.y/jt;const ie=N(k,D,W),ae=N(k,D,q);if(new mi([ie[0],ie[1],y],[ae[0],ae[1],_]).intersectsPrecise(d)===0){I&&(p.segments.push(I),I=void 0);continue}const me=J.segment;I&&I.vertexOffset!==me.vertexOffset&&(p.segments.push(I),I=void 0),I?(I.vertexLength+=me.vertexLength,I.primitiveLength+=me.primitiveLength):I={vertexOffset:me.vertexOffset,primitiveLength:me.primitiveLength,vertexLength:me.vertexLength,primitiveOffset:me.primitiveOffset,sortKey:void 0,vaos:{}}}return I&&p.segments.push(I),p}encodeCentroid(o,l){const d=o.centroid(),p=l.span(),y=Math.min(7,Math.round(p.x*this.tileToMeter/10)),_=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new yt(Ue(d.x,1,jt-1)<<3|y,Ue(d.y,1,jt-1)<<3|_)}encodeBorderCentroid(o){if(!o.borders)return new yt(0,0);const l=o.borders,d=Number.MAX_VALUE;if(l[0][0]!==d||l[1][0]!==d){const p=l[0][0]!==d?0:1;return new yt(6|(l[0][0]!==d?0:65528),(l[p][0]+l[p][1])/2<<3|6)}{const p=l[2][0]!==d?2:3;return new yt((l[p][0]+l[p][1])/2<<3|6,6|(l[2][0]!==d?0:65528))}}showCentroid(o){const l=this.centroidData[o.centroidDataIndex];l.flags&=kd,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(o){this.groundEffect.updateHiddenByLandmark(o);const l=o.vertexArrayOffset,d=o.vertexCount+o.vertexArrayOffset,p=o.flags&kd?BB:o.centroidXY,y=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==p.y||y!==p.x){for(let _=l;_<d;++_)this.centroidVertexArray.emplace(_,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const o of this.centroidData)this.writeCentroidToBuffer(o)}updateReplacement(o,l,d){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(o.toUnwrapped());if(cM(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const y=[];for(const _ of this.activeReplacements){if(_.order<d)continue;const S=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-o.canonical.z));for(const P of this.centroidData)if(!(P.flags&kd||_.min.x>P.max.x||P.min.x>_.max.x||_.min.y>P.max.y||P.min.y>_.max.y))for(let I=0;I<P.footprintSegLen;I++){const k=this.footprintSegments[P.footprintSegIdx+I];if(y.length=0,fre(this.footprintVertices,k.vertexOffset,k.vertexCount,_.footprintTileId.canonical,o.canonical,y),DB(_.footprint,y,this.footprintIndices.uint16,k.indexOffset,k.indexCount,-k.vertexOffset,-S)){P.flags|=kd;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(o,l,d){let p=!1;for(let y=0;y<d.footprintSegLen;y++){const _=this.footprintSegments[d.footprintSegIdx+y];let S=0;for(const P of _.ringIndices){for(let I=S,k=P+S-1;I<P+S;k=I++){const D=this.footprintVertices.int16[2*(I+_.vertexOffset)+0],N=this.footprintVertices.int16[2*(I+_.vertexOffset)+1],W=this.footprintVertices.int16[2*(k+_.vertexOffset)+1];N>l!=W>l&&o<(this.footprintVertices.int16[2*(k+_.vertexOffset)+0]-D)*(l-N)/(W-N)+D&&(p=!p)}S=P}}return p}getHeightAtTileCoord(o,l){let d=Number.NEGATIVE_INFINITY,p=!0;const y=4*(o+jt)*jt+(l+jt);if(this.partLookup.hasOwnProperty(y)){const _=this.partLookup[y];return _?{height:_.height,hidden:!!(_.flags&kd)}:void 0}for(const _ of this.centroidData)o>_.max.x||_.min.x>o||l>_.max.y||_.min.y>l||this.footprintContainsPoint(o,l,_)&&_&&_.height>d&&(d=_.height,this.partLookup[y]=_,p=!!(_.flags&kd));if(d!==Number.NEGATIVE_INFINITY)return{height:d,hidden:p};this.partLookup[y]=void 0}}function WB(u,o){const l=u.add(o)._unit();return u.x*l.x+u.y*l.y}function dre(u,o,l,d){const p=o.sub(u)._perp()._unit(),y=l.sub(o)._perp()._unit();return HB(u,o,l,WB(p,y),d)}function HB(u,o,l,d,p){const y=Math.sqrt(1-d*d);return Math.min(u.dist(o)/3,o.dist(l)/3,p*y/d)}function dM(u,o,l){return u.x<l[0].x&&o.x<l[0].x||u.x>l[1].x&&o.x>l[1].x||u.y<l[0].y&&o.y<l[0].y||u.y>l[1].y&&o.y>l[1].y}function qB(u,o){return u.x<o[0].x||u.x>o[1].x||u.y<o[0].y||u.y>o[1].y}function ZB(u,o,l){if(u.x<0||u.x>=jt||o.x<0||o.x>=jt||l.x<0||l.x>=jt)return!1;const d=l.sub(o),p=d.perp(),y=u.sub(o);return(d.x*y.x+d.y*y.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(y.x*y.x+y.y*y.y))>-.866&&p.x*y.x+p.y*y.y<0}function XB(u,o,l){const d=o?2|u:-3&u;return l?1|d:-2&d}function KB(){const u=Math.PI/32,o=Math.tan(u),l=ee;return l*Math.sqrt(1+2*o*o)-l}function YB(u,o,l){const d=1<<l.z,p=Me(l.x/d),y=Me((l.x+1)/d),_=ke(l.y/d),S=ke((l.y+1)/d);return function(P,I,k,D,N=0,W){const q=[];if(!P.length||!k||!D)return q;const J=(pe,ve)=>{for(const Ie of pe)q.push({polygon:Ie,bounds:ve})},ie=Math.ceil(Math.log2(k)),ae=Math.ceil(Math.log2(D)),me=ie-ae,de=[];for(let pe=0;pe<Math.abs(me);pe++)de.push(me>0?0:1);for(let pe=0;pe<Math.min(ie,ae);pe++)de.push(0),de.push(1);let Q=P;if(Q=oT(Q,I[0].y-N,I[1].y+N,1),Q=oT(Q,I[0].x-N,I[1].x+N,0),!Q.length)return q;const ue=[];for(de.length?ue.push({polygons:Q,bounds:I,depth:0}):J(Q,I);ue.length;){const pe=ue.pop(),ve=pe.depth,Ie=de[ve],De=pe.bounds[0],Fe=pe.bounds[1],He=Ie===0?De.x:De.y,ct=Ie===0?Fe.x:Fe.y,St=W?W(Ie,He,ct):.5*(He+ct),_t=oT(pe.polygons,He-N,St+N,Ie),bt=oT(pe.polygons,St-N,ct+N,Ie);if(_t.length){const Pt=[De,new yt(Ie===0?St:Fe.x,Ie===1?St:Fe.y)];de.length>ve+1?ue.push({polygons:_t,bounds:Pt,depth:ve+1}):J(_t,Pt)}if(bt.length){const Pt=[new yt(Ie===0?St:De.x,Ie===1?St:De.y),Fe];de.length>ve+1?ue.push({polygons:bt,bounds:Pt,depth:ve+1}):J(bt,Pt)}}return q}(u,o,Math.ceil((y-p)/11.25),Math.ceil((_-S)/11.25),1,(P,I,k)=>{if(P===0)return .5*(I+k);{const D=ke((l.y+I/jt)/d);return(Ae(.5*(ke((l.y+k/jt)/d)+D))*d-l.y)*jt}})}function fre(u,o,l,d,p,y){const _=Math.pow(2,d.z-p.z);for(let S=0;S<l;S++){let P=u.int16[2*(S+o)+0],I=u.int16[2*(S+o)+1];P=(P+p.x*jt)*_-d.x*jt,I=(I+p.y*jt)*_-d.y*jt,y.push(new yt(P,I))}}let JB,QB;Zt(cT,"FillExtrusionBucket",{omit:["layers","features"]}),Zt($B,"PartData"),Zt(jB,"FootprintSegment"),Zt(UB,"BorderCentroidData"),Zt(GB,"GroundEffect");class Gp extends yt{constructor(o,l,d){super(o,l),this.z=d}}class ej extends Gp{constructor(o,l,d,p){super(o,l,d),this.w=p}}function tj(u,o,l,d){const p=l==="x"?"y":"x",y=(d-u[l])/(o[l]-u[l]);u[p]=Math.round(u[p]+(o[p]-u[p])*y),u[l]=d,u.hasOwnProperty("z")&&(u.z=yn(u.z,o.z,y)),u.hasOwnProperty("w")&&(u.w=yn(u.w,o.w,y))}function nj(u,o,l,d){const p=l,y=d;for(const _ of["x","y"]){let S=u,P=o;S[_]>=P[_]&&(S=o,P=u),S[_]<p&&P[_]>p&&tj(S,P,_,p),S[_]<y&&P[_]>y&&tj(P,S,_,y)}}function uT(u,o,l,d,p,y){const _=[];for(let S=0;S<u.length;S++){const P=u[S];let I;const k=_.length;let D=0;for(let N=0;N<P.length-1;N++){let W=P[N],q=P[N+1],J=0;const ie=D;let ae,me;y&&(J=Math.hypot(q.x-W.x,q.y-W.y),D+=J,ae=W,me=q),W.x<o&&q.x<o||(W.x<o?W=new yt(o,W.y+(o-W.x)/(q.x-W.x)*(q.y-W.y))._round():q.x<o&&(q=new yt(o,W.y+(o-W.x)/(q.x-W.x)*(q.y-W.y))._round()),W.y<l&&q.y<l||(W.y<l?W=new yt(W.x+(l-W.y)/(q.y-W.y)*(q.x-W.x),l)._round():q.y<l&&(q=new yt(W.x+(l-W.y)/(q.y-W.y)*(q.x-W.x),l)._round()),W.x>=d&&q.x>=d||(W.x>=d?W=new yt(d,W.y+(d-W.x)/(q.x-W.x)*(q.y-W.y))._round():q.x>=d&&(q=new yt(d,W.y+(d-W.x)/(q.x-W.x)*(q.y-W.y))._round()),W.y>=p&&q.y>=p||(W.y>=p?W=new yt(W.x+(p-W.y)/(q.y-W.y)*(q.x-W.x),p)._round():q.y>=p&&(q=new yt(W.x+(p-W.y)/(q.y-W.y)*(q.x-W.x),p)._round()),I&&W.equals(I[I.length-1])||(I=[W],_.push(I),y&&y.push({progress:{min:ie+rj(ae,me,W)*J,max:1},parentIndex:S,prevPoint:ae,nextPoint:me})),I.push(q),y&&(y[y.length-1].progress.max=ie+rj(ae,me,q)*J,y[y.length-1].nextPoint=me)))))}if(y&&D>0)for(let N=k;N<_.length;N++)y[N].progress.min/=D,y[N].progress.max/=D}return _}function pre(u,o,l,d,p){if(u.length<2)return void d.push(u);const y=[];for(;o.valid();){const[I,k]=o.get();for(let D=0;D<u.length-1;D++){const N=u[D],W=u[D+1],q=wi(N,W,I,k);if(q){const[J]=q,ie=new yt(yn(N.x,W.x,J),yn(N.y,W.y,J));y.push({t:D+J,distance:0,point:ie})}}o.next()}if(y.length===0)return void d.push(u);y.sort((I,k)=>I.t-k.t);let _=0,S=0,P=[];for(d.push(P);_!==u.length;){if(S===y.length){for(;_!==u.length;)P.length!==0&&P[P.length-1].equals(u[_])||P.push(u[_]),_++;break}y[S].t<=_?(P.length!==0&&P[P.length-1].equals(y[S].point)||P.push(y[S].point),Math.trunc(y[S].t),S++):(P.length!==0&&P[P.length-1].equals(u[_])||P.push(u[_]),_++)}}function rj(u,o,l){return u.x!==o.x?(l.x-u.x)/(o.x-u.x):u.y!==o.y?(l.y-u.y)/(o.y-u.y):0}function cx(u,o){return u.x*o.x+u.y*o.y}function ij(u,o){if(u.length===1){let l=0;const d=o[l++];let p;for(;!p||d.equals(p);)if(p=o[l++],!p)return 1/0;for(;l<o.length;l++){const y=o[l],_=u[0],S=p.sub(d),P=y.sub(d),I=_.sub(d),k=cx(S,S),D=cx(S,P),N=cx(P,P),W=cx(I,S),q=cx(I,P),J=k*N-D*D,ie=(N*W-D*q)/J,ae=(k*q-D*W)/J,me=d.z*(1-ie-ae)+p.z*ie+y.z*ae;if(isFinite(me))return me}return 1/0}{let l=1/0;for(const d of o)l=Math.min(l,d.z);return l}}function oj(u,o,l,d,p,y,_,S){const P=_*p.getElevationAt(u,o,!0,!0),I=y[0]!==0,k=I?y[1]===0?_*(y[0]/7-450):_*function(D,N,W){const q=Math.floor(N[0]/8),J=Math.floor(N[1]/8),ie=10*(N[0]-8*q),ae=10*(N[1]-8*J),me=D.getElevationAt(q,J,!0,!0),de=D.getMeterToDEM(W),Q=Math.floor(.5*(ie*de-1)),ue=Math.floor(.5*(ae*de-1)),pe=D.tileCoordToPixel(q,J),ve=2*Q+1,Ie=2*ue+1,De=function(bt,Pt,st,xt,nt){return[bt.getElevationAtPixel(Pt,st,!0),bt.getElevationAtPixel(Pt+nt,st,!0),bt.getElevationAtPixel(Pt,st+nt,!0),bt.getElevationAtPixel(Pt+xt,st+nt,!0)]}(D,pe.x-Q,pe.y-ue,ve,Ie),Fe=Math.abs(De[0]-De[1]),He=Math.abs(De[2]-De[3]),ct=Math.abs(De[0]-De[2])+Math.abs(De[1]-De[3]),St=Math.min(.25,.5*de*(Fe+He)/ve),_t=Math.min(.25,.5*de*ct/Ie);return me+Math.max(St*ie,_t*ae)}(p,y,S):P;return{base:P+(l===0?-1:l),top:I?Math.max(k+d,P+l+2):P+d}}const mre=vr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),gre=vr([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:yre}=mre,_re=vr([{name:"a_packed",components:3,type:"Float32"}]),{members:vre}=_re,xre=vr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:bre}=xre;class aj{constructor(o,l){this.width=o,this.height=l,this.nextRow=0,this.image=new Md({width:o,height:l}),this.positions={},this.uploaded=!1}getDash(o,l){const d=this.getKey(o,l);return this.positions[d]}trim(){const o=this.width,l=this.height=rn(this.nextRow);this.image.resize({width:o,height:l})}getKey(o,l){return o.join(",")+l}getDashRanges(o,l,d){const p=[];let y=o.length%2==1?-o[o.length-1]*d:0,_=o[0]*d,S=!0;p.push({left:y,right:_,isDash:S,zeroLength:o[0]===0});let P=o[0];for(let I=1;I<o.length;I++){S=!S;const k=o[I];y=P*d,P+=k,_=P*d,p.push({left:y,right:_,isDash:S,zeroLength:k===0})}return p}addRoundDash(o,l,d){const p=l/2;for(let y=-d;y<=d;y++){const _=this.width*(this.nextRow+d+y);let S=0,P=o[S];for(let I=0;I<this.width;I++){I/P.right>1&&(P=o[++S]);const k=Math.abs(I-P.left),D=Math.abs(I-P.right),N=Math.min(k,D);let W;const q=y/d*(p+1);if(P.isDash){const J=p-Math.abs(q);W=Math.sqrt(N*N+J*J)}else W=p-Math.sqrt(N*N+q*q);this.image.data[_+I]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(o,l){for(let P=o.length-1;P>=0;--P){const I=o[P],k=o[P+1];I.zeroLength?o.splice(P,1):k&&k.isDash===I.isDash&&(k.left=I.left,o.splice(P,1))}const d=o[0],p=o[o.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const y=this.width*this.nextRow;let _=0,S=o[_];for(let P=0;P<this.width;P++){P/S.right>1&&(S=o[++_]);const I=Math.abs(P-S.left),k=Math.abs(P-S.right),D=Math.min(I,k);this.image.data[y+P]=Math.max(0,Math.min(255,(S.isDash?D:-D)+l+128))}}addDash(o,l){const d=this.getKey(o,l);if(this.positions[d])return this.positions[d];const p=l==="round",y=p?7:0,_=2*y+1;if(this.nextRow+_>this.height)return nr("LineAtlas out of space"),null;o.length===0&&o.push(1);let S=0;for(let k=0;k<o.length;k++)o[k]<0&&(nr("Negative value is found in line dasharray, replacing values with 0"),o[k]=0),S+=o[k];if(S!==0){const k=this.width/S,D=this.getDashRanges(o,this.width,k);p?this.addRoundDash(D,k,y):this.addRegularDash(D,l==="square"?.5*k:0)}const P=this.nextRow+y;this.nextRow+=_;const I={tl:[P,y],br:[S,0]};return this.positions[d]=I,I}}Zt(aj,"LineAtlas");const wre=Od.VectorTileFeature.types,Sre=Math.cos(Math.PI/180*37.5),Tre=Math.cos(Math.PI/180*5);class fM{constructor(o){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=o.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=o.overscaling,this.pixelRatio=o.pixelRatio,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new $0,this.layoutVertexArray2=new Tl,this.patternVertexArray=new Tl,this.indexArray=new bo,this.programConfigurations=new ih(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new Ti,this.maxLineLength=0,this.zOffsetVertexArray=new Tl,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=o.tessellationStep?o.tessellationStep:jt/64}updateFootprints(o,l){}populate(o,l,d,p){this.hasPattern=YI("line",this.layers,this.pixelRatio,l);const y=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Ze(d);const _=this.layers[0].layout.get("line-elevation-reference");if(_==="hd-road-markup")this.elevationType="road";else{const N=this.layers[0].layout.get("line-z-offset"),W=N.isConstant()&&!N.constantOr(0);this.elevationType=_!=="sea"&&_!=="ground"&&W?"none":"offset",this.elevationType==="offset"&&_==="none"&&nr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const S=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&S!==void 0;const P=[];for(const{feature:N,id:W,index:q,sourceLayerIndex:J}of o){const ie=this.layers[0]._featureFilter.needGeometry,ae=an(N,ie);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),ae,d))continue;const me=y?y.evaluate(ae,{},d):void 0,de={id:W,properties:N.properties,type:N.type,sourceLayerIndex:J,index:q,geometry:ie?ae.geometry:Yt(N,d,p),patterns:{},sortKey:me};P.push(de)}y&&P.sort((N,W)=>N.sortKey-W.sortKey);const{lineAtlas:I,featureIndex:k}=l,D=this.addConstantDashes(I);for(const N of P){const{geometry:W,index:q,sourceLayerIndex:J}=N;if(D&&this.addFeatureDashes(N,I),this.hasPattern){const ie=JI("line",this.layers,N,this.zoom,this.pixelRatio,l);this.patternFeatures.push(ie)}else this.addFeature(N,W,q,d,I.positions,l.availableImages,l.brightness,l.elevationFeatures);k.insert(o[q].feature,W,q,J,this.index)}}addConstantDashes(o){let l=!1;for(const d of this.layers){const p=d.paint.get("line-dasharray").value,y=d.layout.get("line-cap").value;if(p.kind!=="constant"||y.kind!=="constant")l=!0;else{const _=y.value,S=p.value;if(!S)continue;o.addDash(S,_)}}return l}addFeatureDashes(o,l){const d=this.zoom;for(const p of this.layers){const y=p.paint.get("line-dasharray").value,_=p.layout.get("line-cap").value;if(y.kind==="constant"&&_.kind==="constant")continue;let S,P;if(y.kind==="constant"){if(S=y.value,!S)continue}else S=y.evaluate({zoom:d},o);P=_.kind==="constant"?_.value:_.evaluate({zoom:d},o),l.addDash(S,P),o.patterns[p.id]=[l.getKey(S,P)]}}update(o,l,d,p,y,_,S){this.programConfigurations.updatePaintArrays(o,l,y,d,p,_,S)}addFeatures(o,l,d,p,y,_){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,l,d,p,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,vre)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=o.createVertexBuffer(this.patternVertexArray,bre)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,gre.members,!0)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,yre),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,l,d,p,y,_,S,P){const I=this.layers[0].layout,k=I.get("line-join").evaluate(o,{}),D=I.get("line-cap").evaluate(o,{}),N=I.get("line-miter-limit"),W=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(o),this.lineFeature=o,this.zOffsetValue=I.get("line-z-offset").value;const q=this.layers[0].paint.get("line-width").value;if(q.kind!=="constant"&&q.isLineProgressConstant===!1&&(this.variableWidthValue=q),this.elevationType==="road"){const J=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(o,l,p,P,k,D,N,W)){const[ie,ae]=this.clipRuntimeLinesToTile(l,1);for(let me=0;me<ie.length;me++){const de=ie[me],Q=ae[me],ue={progress:{min:Q.progress.min,max:Q.progress.max},nextDir:this.computeSegNextDir(Q,de),prevDir:this.computeSegPrevDir(Q,de)};this.addLine(de,o,p,k,D,N,W,ue)}this.fillNonElevatedRoadSegment(J)}}else for(const J of l)this.addLine(J,o,p,k,D,N,W);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,y,_,p,S)}computeSegNextDir(o,l){return o.nextPoint.sub(l.at(-2)).unit()}computeSegPrevDir(o,l){return l[1].sub(o.prevPoint).unit()}clipLinesToTile(o,l){return uT(o,-l,-l,jt+l,jt+l)}clipRuntimeLinesToTile(o,l){const d=[];return[uT(o,-l,-l,jt+l,jt+l,d),d]}addElevatedRoadFeature(o,l,d,p,y,_,S,P){const I=[],k=rM.getElevationFeature(o,p);if(k){const D=this.clipLinesToTile(l,1),N=this.prepareElevatedLines(D,k,d);for(const W of N)I.push({geometry:W,elevation:k,elevationTileID:d,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(I.length===0)return!1;for(const D of I){const N=this.layoutVertexArray.length;this.addLine(D.geometry,o,d,y,_,S,P);const W=new xB(d,D.elevationTileID);if(D.elevation)for(let q=N;q<this.layoutVertexArray.length;q++){const J=new yt(this.layoutVertexArray.int16[6*q]>>1,this.layoutVertexArray.int16[6*q+1]>>1),ie=W.pointElevation(J,D.elevation,.05);this.updateHeightRange(ie),this.zOffsetVertexArray.emplaceBack(ie,0,0)}else this.fillNonElevatedRoadSegment(N)}return!0}prepareElevatedLines(o,l,d){if(l.constantHeight!=null)return o;const p=[],y=1/Ze(d);for(const _ of o)pre(_,new vB(l,y),0,p);return p}fillNonElevatedRoadSegment(o){for(let l=o;l<this.layoutVertexArray.length;l++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(o){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,o),this.heightRange.max=Math.max(this.heightRange.max,o)):this.heightRange={min:o,max:o}}addLine(o,l,d,p,y,_,S,P){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const I=p==="none";this.patternJoinNone=this.hasPattern&&I,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const k=P&&P.progress.min>0,D=P&&P.progress.max<1;if(this.lineClips){let Ie={min:this.lineClips.start,max:this.lineClips.end},De=1;if(P){const ct=this.lineClips.end-this.lineClips.start;Ie=function(St,_t,bt){return{min:Io(St.min,_t,bt),max:Io(St.max,_t,bt)}}(P.progress,{min:0,max:1},Ie),ct>0&&(De=(Ie.max-Ie.min)/ct)}const Fe=+l.properties.mapbox_clip_feature_len,He=+l.properties.mapbox_clip_seg_len;if(Number.isNaN(Fe)||Number.isNaN(He)){for(let St=0;St<o.length-1;St++)this.totalDistance+=o[St].dist(o[St+1]);const ct=this.totalDistance/(Ie.max-Ie.min);this.totalFeatureLength=Number.isFinite(ct)?ct:0,this.lineClips.start=Ie.min,this.lineClips.end=Ie.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Fe,this.distance=He*De,this.lineClips.start=Ie.min,this.lineClips.end=Ie.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const N=wre[l.type]==="Polygon";let W=o.length;for(;W>=2&&o[W-1].equals(o[W-2]);)W--;let q=0;for(;q<W-1&&o[q].equals(o[q+1]);)q++;if(W<(N?3:2))return;p==="bevel"&&(_=1.05);const J=this.segments.prepareSegment(10*W,this.layoutVertexArray,this.indexArray);let ie,ae,me,de,Q,ue,pe,ve;P&&P.prevDir&&(ue=P.prevDir.perp()),P&&P.nextDir&&(pe=P.nextDir.perp()),this.e1=this.e2=-1,N&&(ie=o[W-2],Q=o[q].sub(ie)._unit()._perp());for(let Ie=q;Ie<W;Ie++){if(me=Ie===W-1?N?o[q+1]:void 0:o[Ie+1],me&&o[Ie].equals(me))continue;Q&&(de=Q),ie&&(ae=ie),ie=o[Ie],ve=this.evaluateLineProgressFeatures(ae?ae.dist(ie):0),Q=me?me.sub(ie)._unit()._perp():de,de=de||Q;const De=ae&&me;let Fe=De?p:N||I?"butt":y;const He=de.x*Q.x+de.y*Q.y;if(I){const nt=function(lt){if(lt.patternJoinNone){const It=lt.segmentPoints.length/2,Mt=lt.lineSoFar-lt.segmentStart;for(let on=0;on<It;++on){const Kt=lt.segmentPoints[2*on+1],$t=Math.round(lt.segmentPoints[2*on])+.5+.25*Kt;lt.patternVertexArray.emplaceBack($t,Mt,lt.segmentStart),lt.patternVertexArray.emplaceBack($t,Mt,lt.segmentStart)}lt.segmentPoints.length=0}lt.e1=lt.e2=-1};if(De&&He<Tre){this.updateDistance(ae,ie),this.addCurrentVertex(ie,de,1,1,J,ve),nt(this),this.addCurrentVertex(ie,Q,-1,-1,J,ve);continue}if(ae){if(!me){this.updateDistance(ae,ie),this.addCurrentVertex(ie,de,1,1,J,ve),nt(this);continue}Fe="miter"}}let ct=de.add(Q);ct.x===0&&ct.y===0||ct._unit();const St=ct.x*Q.x+ct.y*Q.y,_t=St!==0?1/St:1/0,bt=2*Math.sqrt(2-2*St),Pt=St<Sre&&ae&&me,st=de.x*Q.y-de.y*Q.x>0,xt=this.overscaling<=16?15*jt/(512*this.overscaling):0;if(De&&Fe==="round"){if(_t<S)Fe="miter";else if(_t<=2){const nt=pM(ie,-10,jt+10);Fe=this.elevationType==="offset"&&(nt||this.hasCrossSlope)?"miter":"fakeround"}}if(Fe==="miter"&&_t>_&&(Fe="bevel"),Fe==="bevel"&&(_t>2&&(Fe="flipbevel"),_t<_&&(Fe="miter")),ae&&!(Fe==="miter"&&Pt)&&this.updateDistance(ae,ie),Fe==="miter")if(Pt){const nt=ie.dist(ae);if(nt>2*xt){const It=ie.sub(ie.sub(ae)._mult(xt/nt)._round());this.updateDistance(ae,It),this.addCurrentVertex(It,de,0,0,J,ve),ae=It}this.updateDistance(ae,ie),ct._mult(_t),this.addCurrentVertex(ie,ct,0,0,J,ve);const lt=ie.dist(me);if(lt>2*xt){const It=ie.add(me.sub(ie)._mult(xt/lt)._round());this.updateDistance(ie,It),this.addCurrentVertex(It,Q,0,0,J,ve),ie=It}}else ct._mult(_t),this.addCurrentVertex(ie,ct,0,0,J,ve);else if(Fe==="flipbevel"){if(_t>100)ct=Q.mult(-1);else{const nt=_t*de.add(Q).mag()/de.sub(Q).mag();ct._perp()._mult(nt*(st?-1:1))}this.addCurrentVertex(ie,ct,0,0,J,ve),this.addCurrentVertex(ie,ct.mult(-1),0,0,J,ve)}else if(Fe==="bevel"||Fe==="fakeround"){ve!=null&&ae&&this.addCurrentVertex(ie,pe||de,-1,-1,J,ve);const nt=ie.dist(ae)<=2*xt&&Fe!=="bevel",lt=ct.mult(st?1:-1);lt._mult(_t);const It=Q.mult(st?-1:1),Mt=de.mult(st?-1:1),on=this.evaluateLineProgressFeatures(this.distance);if(ve==null&&(this.addHalfVertex(ie,lt.x,lt.y,!1,!st,0,J,on),nt||this.addHalfVertex(ie,lt.x+2*Mt.x,lt.y+2*Mt.y,!1,st,0,J,on)),Fe==="fakeround"){const Kt=Math.round(180*bt/Math.PI/20);this.addHalfVertex(ie,Mt.x,Mt.y,!1,st,0,J,on);for(let $t=0;$t<Kt;$t++){let Ct=$t/Kt;if(Ct!==.5){const en=Ct-.5;Ct+=Ct*en*(Ct-1)*((1.0904+He*(He*(3.55645-1.43519*He)-3.2452))*en*en+(.848013+He*(.215638*He-1.06021)))}const kn=It.sub(Mt)._mult(Ct)._add(Mt)._unit();this.addHalfVertex(ie,kn.x,kn.y,!1,st,0,J,on)}this.addHalfVertex(ie,It.x,It.y,!1,st,0,J,on)}nt||ve!=null||this.addHalfVertex(ie,lt.x+2*It.x,lt.y+2*It.y,!1,st,0,J,on),ve!=null&&me&&this.addCurrentVertex(ie,ue||Q,1,1,J,ve)}else if(Fe==="butt")this.addCurrentVertex(ie,ct,0,0,J,ve);else if(Fe==="square"){if(!ae){const nt=k?0:-1;this.addCurrentVertex(ie,ct,nt,nt,J,ve)}if(this.addCurrentVertex(ie,ct,0,0,J,ve),ae){const nt=D?0:1;this.addCurrentVertex(ie,ct,nt,nt,J,ve)}}else if(Fe==="round"){if(ae){const nt=!De&&pe?pe:de;this.addCurrentVertex(ie,nt,0,0,J,ve),!De&&D||this.addCurrentVertex(ie,nt,1,1,J,ve,!0)}if(me){const nt=!De&&ue?ue:Q;!De&&k||this.addCurrentVertex(ie,nt,-1,-1,J,ve,!0),this.addCurrentVertex(ie,nt,0,0,J,ve)}}}}addVerticesTo(o,l,d,p,y,_,S,P,I,k){const D=(l.w-o.w)/this.tessellationStep|0;let N=0;const W=this.scaledDistance;if(D>1){this.lineSoFar=o.w;const J=(l.x-o.x)/D,ie=(l.y-o.y)/D,ae=(l.z-o.z)/D,me=(l.w-o.w)/D;for(let de=1;de<D;++de){o.x+=J,o.y+=ie,o.z+=ae,this.lineSoFar+=me,N+=me;const Q=this.evaluateLineProgressFeatures(this.prevDistance+N);this.scaledDistance=(this.prevDistance+N)/this.totalDistance,this.addHalfVertex(o,d,p,k,!1,S,I,Q),this.addHalfVertex(o,y,_,k,!0,-P,I,Q)}}this.lineSoFar=l.w,this.scaledDistance=W;const q=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,d,p,k,!1,S,I,q),this.addHalfVertex(l,y,_,k,!0,-P,I,q)}evaluateLineProgressFeatures(o){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+o)/this.totalFeatureLength):nr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:l}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}}addCurrentVertex(o,l,d,p,y,_,S=!1){const P=l.x+l.y*d,I=l.y-l.x*d,k=l.y*p-l.x,D=-l.y-l.x*p;if(_!=null){const N=this.elevationType==="offset",W=-10,q=jt+10,J=_.zOffset,ie=new ej(o.x,o.y,J,this.lineSoFar),ae=!!N&&pM(o,W,q),me=this.lineSoFar,de=this.distance;if(this.currentVertex)if(ae){const Q=this.currentVertexIsOutside,ue=this.currentVertex,pe=new ej(o.x,o.y,J,this.lineSoFar);if(nj(ue,pe,W,q),!pM(pe,W,q)){if(Q){this.e1=this.e2=-1,this.distance-=ue.dist(ie),this.lineSoFar=ue.w;const ve=this.evaluateLineProgressFeatures(ue.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ue,P,I,S,!1,d,y,ve),this.addHalfVertex(ue,k,D,S,!0,-p,y,ve),this.prevDistance=this.distance}this.distance=this.prevDistance+ue.dist(pe),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ue,pe,P,I,k,D,d,p,y,S),this.distance=de,this.scaledDistance=this.distance/this.totalDistance}}else{const Q=this.currentVertex;if(this.currentVertexIsOutside){nj(Q,ie,W,q),this.e1=this.e2=-1,this.distance-=Q.dist(ie),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=Q.w;const ue=this.evaluateLineProgressFeatures(Q.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Q,P,I,S,!1,d,y,ue),this.addHalfVertex(Q,k,D,S,!0,-p,y,ue),this.prevDistance=this.distance,this.distance=de,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(Q,ie,P,I,k,D,d,p,y,S)}else ae||(this.addHalfVertex(o,P,I,S,!1,d,y,_),this.addHalfVertex(o,k,D,S,!0,-p,y,_));this.currentVertex=ie,this.currentVertexIsOutside=ae,this.lineSoFar=me}else this.addHalfVertex(o,P,I,S,!1,d,y,_),this.addHalfVertex(o,k,D,S,!0,-p,y,_)}addHalfVertex({x:o,y:l},d,p,y,_,S,P,I){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,S)),this.layoutVertexArray.emplaceBack((o<<1)+(y?1:0),(l<<1)+(_?1:0),Math.round(63*d)+128,Math.round(63*p)+128,1+(S===0?0:S<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const D=yn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,D)}const k=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),P.primitiveLength++),_?this.e2=k:this.e1=k,I!=null&&this.zOffsetVertexArray.emplaceBack(I.zOffset,I.variableWidth,I.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(o,l){this.prevDistance=this.distance,this.distance+=o.dist(l),this.updateScaledDistance()}}function pM(u,o,l){return u.x<o||u.x>l||u.y<o||u.y>l}let sj,lj;function cj(u,o,l){return o*(jt/(u.tileSize*Math.pow(2,l-u.tileID.overscaledZ)))}Zt(fM,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const uj=(u,o,l)=>(1-l)*u+l*o;function hj(u,o){return 1/cj(u,1,o.tileZoom)}function dj(u,o,l,d){return u.translatePosMatrix(d||o.tileID.projMatrix,o,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const fj=u=>{const o=[];pj(u)&&o.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT");const l=u.paint.get("line-trim-offset");l[0]===0&&l[1]===0||o.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&o.push("RENDER_LINE_BORDER");const d=u.layout.get("line-join").constantOr("miter")==="none",p=!!u.paint.get("line-pattern").constantOr(1);return d&&p&&o.push("LINE_JOIN_NONE"),o};function pj(u){const o=u.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}let mM;const mj=()=>mM||(mM={layout:sj||(sj=new Di({"line-cap":new qt(Ke.layout_line["line-cap"]),"line-join":new qt(Ke.layout_line["line-join"]),"line-miter-limit":new Dt(Ke.layout_line["line-miter-limit"]),"line-round-limit":new Dt(Ke.layout_line["line-round-limit"]),"line-sort-key":new qt(Ke.layout_line["line-sort-key"]),"line-z-offset":new qt(Ke.layout_line["line-z-offset"]),"line-elevation-reference":new Dt(Ke.layout_line["line-elevation-reference"]),"line-cross-slope":new Dt(Ke.layout_line["line-cross-slope"]),visibility:new Dt(Ke.layout_line.visibility),"line-width-unit":new Dt(Ke.layout_line["line-width-unit"])})),paint:lj||(lj=new Di({"line-opacity":new qt(Ke.paint_line["line-opacity"]),"line-color":new qt(Ke.paint_line["line-color"]),"line-translate":new Dt(Ke.paint_line["line-translate"]),"line-translate-anchor":new Dt(Ke.paint_line["line-translate-anchor"]),"line-width":new qt(Ke.paint_line["line-width"]),"line-gap-width":new qt(Ke.paint_line["line-gap-width"]),"line-offset":new qt(Ke.paint_line["line-offset"]),"line-blur":new qt(Ke.paint_line["line-blur"]),"line-dasharray":new qt(Ke.paint_line["line-dasharray"]),"line-pattern":new qt(Ke.paint_line["line-pattern"]),"line-pattern-cross-fade":new Dt(Ke.paint_line["line-pattern-cross-fade"]),"line-gradient":new Qu(Ke.paint_line["line-gradient"]),"line-trim-offset":new Dt(Ke.paint_line["line-trim-offset"]),"line-trim-fade-range":new Dt(Ke.paint_line["line-trim-fade-range"]),"line-trim-color":new Dt(Ke.paint_line["line-trim-color"]),"line-emissive-strength":new Dt(Ke.paint_line["line-emissive-strength"]),"line-border-width":new qt(Ke.paint_line["line-border-width"]),"line-border-color":new qt(Ke.paint_line["line-border-color"]),"line-occlusion-opacity":new Dt(Ke.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},mM);class Ere extends qt{possiblyEvaluate(o,l){return l=new zr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(o,l)}evaluate(o,l,d,p){return l=tt({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(o,l,d,p)}}let ux;function gj(u,o){return o>0?o+2*u:u}const Are=vr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Pre=vr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Cre=vr([{name:"a_projected_pos",components:4,type:"Float32"}],4);vr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ire=vr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Mre=vr([{name:"a_texb",components:2,type:"Uint16"}]),Ore=vr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),kre=vr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const yj=vr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Rre=vr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);vr([{name:"triangle",components:3,type:"Uint16"}]),vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),vr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),vr([{type:"Float32",name:"offsetX"}]),vr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Oo=24;function Dre(u,o,l){return u.sections.forEach(d=>{d.text=function(p,y,_){const S=y.layout.get("text-transform").evaluate(_,{});return S==="uppercase"?p=p.toLocaleUpperCase():S==="lowercase"&&(p=p.toLocaleLowerCase()),Ps.applyArabicShaping&&(p=Ps.applyArabicShaping(p)),p}(d.text,o,l)}),u}const hx={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function Lre(u){return u==="︶"||u==="﹈"||u==="︸"||u==="﹄"||u==="﹂"||u==="︾"||u==="︼"||u==="︺"||u==="︘"||u==="﹀"||u==="︐"||u==="︓"||u==="︔"||u==="｀"||u==="￣"||u==="︑"||u==="︒"}function zre(u){return u==="︵"||u==="﹇"||u==="︷"||u==="﹃"||u==="﹁"||u==="︽"||u==="︻"||u==="︹"||u==="︗"||u==="︿"}var _j,gM,vj,yM={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Nre(){return _j||(_j=1,yM.read=function(u,o,l,d,p){var y,_,S=8*p-d-1,P=(1<<S)-1,I=P>>1,k=-7,D=l?p-1:0,N=l?-1:1,W=u[o+D];for(D+=N,y=W&(1<<-k)-1,W>>=-k,k+=S;k>0;y=256*y+u[o+D],D+=N,k-=8);for(_=y&(1<<-k)-1,y>>=-k,k+=d;k>0;_=256*_+u[o+D],D+=N,k-=8);if(y===0)y=1-I;else{if(y===P)return _?NaN:1/0*(W?-1:1);_+=Math.pow(2,d),y-=I}return(W?-1:1)*_*Math.pow(2,y-d)},yM.write=function(u,o,l,d,p,y){var _,S,P,I=8*y-p-1,k=(1<<I)-1,D=k>>1,N=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=d?0:y-1,q=d?1:-1,J=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(S=isNaN(o)?1:0,_=k):(_=Math.floor(Math.log(o)/Math.LN2),o*(P=Math.pow(2,-_))<1&&(_--,P*=2),(o+=_+D>=1?N/P:N*Math.pow(2,1-D))*P>=2&&(_++,P/=2),_+D>=k?(S=0,_=k):_+D>=1?(S=(o*P-1)*Math.pow(2,p),_+=D):(S=o*Math.pow(2,D-1)*Math.pow(2,p),_=0));p>=8;u[l+W]=255&S,W+=q,S/=256,p-=8);for(_=_<<p|S,I+=p;I>0;u[l+W]=255&_,W+=q,_/=256,I-=8);u[l+W-q]|=128*J}),yM}function xj(){if(vj)return gM;vj=1,gM=o;var u=Nre();function o(Q){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Q)?Q:new Uint8Array(Q||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var l=4294967296,d=1/l,p=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function y(Q){return Q.type===o.Bytes?Q.readVarint()+Q.pos:Q.pos+1}function _(Q,ue,pe){return pe?4294967296*ue+(Q>>>0):4294967296*(ue>>>0)+(Q>>>0)}function S(Q,ue,pe){var ve=ue<=16383?1:ue<=2097151?2:ue<=268435455?3:Math.floor(Math.log(ue)/(7*Math.LN2));pe.realloc(ve);for(var Ie=pe.pos-1;Ie>=Q;Ie--)pe.buf[Ie+ve]=pe.buf[Ie]}function P(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeVarint(Q[pe])}function I(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeSVarint(Q[pe])}function k(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeFloat(Q[pe])}function D(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeDouble(Q[pe])}function N(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeBoolean(Q[pe])}function W(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeFixed32(Q[pe])}function q(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeSFixed32(Q[pe])}function J(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeFixed64(Q[pe])}function ie(Q,ue){for(var pe=0;pe<Q.length;pe++)ue.writeSFixed64(Q[pe])}function ae(Q,ue){return(Q[ue]|Q[ue+1]<<8|Q[ue+2]<<16)+16777216*Q[ue+3]}function me(Q,ue,pe){Q[pe]=ue,Q[pe+1]=ue>>>8,Q[pe+2]=ue>>>16,Q[pe+3]=ue>>>24}function de(Q,ue){return(Q[ue]|Q[ue+1]<<8|Q[ue+2]<<16)+(Q[ue+3]<<24)}return o.prototype={destroy:function(){this.buf=null},readFields:function(Q,ue,pe){for(pe=pe||this.length;this.pos<pe;){var ve=this.readVarint(),Ie=ve>>3,De=this.pos;this.type=7&ve,Q(Ie,ue,this),this.pos===De&&this.skip(ve)}return ue},readMessage:function(Q,ue){return this.readFields(Q,ue,this.readVarint()+this.pos)},readFixed32:function(){var Q=ae(this.buf,this.pos);return this.pos+=4,Q},readSFixed32:function(){var Q=de(this.buf,this.pos);return this.pos+=4,Q},readFixed64:function(){var Q=ae(this.buf,this.pos)+ae(this.buf,this.pos+4)*l;return this.pos+=8,Q},readSFixed64:function(){var Q=ae(this.buf,this.pos)+de(this.buf,this.pos+4)*l;return this.pos+=8,Q},readFloat:function(){var Q=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Q},readDouble:function(){var Q=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Q},readVarint:function(Q){var ue,pe,ve=this.buf;return ue=127&(pe=ve[this.pos++]),pe<128?ue:(ue|=(127&(pe=ve[this.pos++]))<<7,pe<128?ue:(ue|=(127&(pe=ve[this.pos++]))<<14,pe<128?ue:(ue|=(127&(pe=ve[this.pos++]))<<21,pe<128?ue:function(Ie,De,Fe){var He,ct,St=Fe.buf;if(He=(112&(ct=St[Fe.pos++]))>>4,ct<128||(He|=(127&(ct=St[Fe.pos++]))<<3,ct<128)||(He|=(127&(ct=St[Fe.pos++]))<<10,ct<128)||(He|=(127&(ct=St[Fe.pos++]))<<17,ct<128)||(He|=(127&(ct=St[Fe.pos++]))<<24,ct<128)||(He|=(1&(ct=St[Fe.pos++]))<<31,ct<128))return _(Ie,He,De);throw new Error("Expected varint not more than 10 bytes")}(ue|=(15&(pe=ve[this.pos]))<<28,Q,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Q=this.readVarint();return Q%2==1?(Q+1)/-2:Q/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Q=this.readVarint()+this.pos,ue=this.pos;return this.pos=Q,Q-ue>=12&&p?function(pe,ve,Ie){return p.decode(pe.subarray(ve,Ie))}(this.buf,ue,Q):function(pe,ve,Ie){for(var De="",Fe=ve;Fe<Ie;){var He,ct,St,_t=pe[Fe],bt=null,Pt=_t>239?4:_t>223?3:_t>191?2:1;if(Fe+Pt>Ie)break;Pt===1?_t<128&&(bt=_t):Pt===2?(192&(He=pe[Fe+1]))==128&&(bt=(31&_t)<<6|63&He)<=127&&(bt=null):Pt===3?(ct=pe[Fe+2],(192&(He=pe[Fe+1]))==128&&(192&ct)==128&&((bt=(15&_t)<<12|(63&He)<<6|63&ct)<=2047||bt>=55296&&bt<=57343)&&(bt=null)):Pt===4&&(ct=pe[Fe+2],St=pe[Fe+3],(192&(He=pe[Fe+1]))==128&&(192&ct)==128&&(192&St)==128&&((bt=(15&_t)<<18|(63&He)<<12|(63&ct)<<6|63&St)<=65535||bt>=1114112)&&(bt=null)),bt===null?(bt=65533,Pt=1):bt>65535&&(bt-=65536,De+=String.fromCharCode(bt>>>10&1023|55296),bt=56320|1023&bt),De+=String.fromCharCode(bt),Fe+=Pt}return De}(this.buf,ue,Q)},readBytes:function(){var Q=this.readVarint()+this.pos,ue=this.buf.subarray(this.pos,Q);return this.pos=Q,ue},readPackedVarint:function(Q,ue){if(this.type!==o.Bytes)return Q.push(this.readVarint(ue));var pe=y(this);for(Q=Q||[];this.pos<pe;)Q.push(this.readVarint(ue));return Q},readPackedSVarint:function(Q){if(this.type!==o.Bytes)return Q.push(this.readSVarint());var ue=y(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSVarint());return Q},readPackedBoolean:function(Q){if(this.type!==o.Bytes)return Q.push(this.readBoolean());var ue=y(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readBoolean());return Q},readPackedFloat:function(Q){if(this.type!==o.Bytes)return Q.push(this.readFloat());var ue=y(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFloat());return Q},readPackedDouble:function(Q){if(this.type!==o.Bytes)return Q.push(this.readDouble());var ue=y(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readDouble());return Q},readPackedFixed32:function(Q){if(this.type!==o.Bytes)return Q.push(this.readFixed32());var ue=y(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFixed32());return Q},readPackedSFixed32:function(Q){if(this.type!==o.Bytes)return Q.push(this.readSFixed32());var ue=y(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSFixed32());return Q},readPackedFixed64:function(Q){if(this.type!==o.Bytes)return Q.push(this.readFixed64());var ue=y(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFixed64());return Q},readPackedSFixed64:function(Q){if(this.type!==o.Bytes)return Q.push(this.readSFixed64());var ue=y(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSFixed64());return Q},skip:function(Q){var ue=7&Q;if(ue===o.Varint)for(;this.buf[this.pos++]>127;);else if(ue===o.Bytes)this.pos=this.readVarint()+this.pos;else if(ue===o.Fixed32)this.pos+=4;else{if(ue!==o.Fixed64)throw new Error("Unimplemented type: "+ue);this.pos+=8}},writeTag:function(Q,ue){this.writeVarint(Q<<3|ue)},realloc:function(Q){for(var ue=this.length||16;ue<this.pos+Q;)ue*=2;if(ue!==this.length){var pe=new Uint8Array(ue);pe.set(this.buf),this.buf=pe,this.length=ue}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Q){this.realloc(4),me(this.buf,Q,this.pos),this.pos+=4},writeSFixed32:function(Q){this.realloc(4),me(this.buf,Q,this.pos),this.pos+=4},writeFixed64:function(Q){this.realloc(8),me(this.buf,-1&Q,this.pos),me(this.buf,Math.floor(Q*d),this.pos+4),this.pos+=8},writeSFixed64:function(Q){this.realloc(8),me(this.buf,-1&Q,this.pos),me(this.buf,Math.floor(Q*d),this.pos+4),this.pos+=8},writeVarint:function(Q){(Q=+Q||0)>268435455||Q<0?function(ue,pe){var ve,Ie;if(ue>=0?(ve=ue%4294967296|0,Ie=ue/4294967296|0):(Ie=~(-ue/4294967296),4294967295^(ve=~(-ue%4294967296))?ve=ve+1|0:(ve=0,Ie=Ie+1|0)),ue>=18446744073709552e3||ue<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");pe.realloc(10),function(De,Fe,He){He.buf[He.pos++]=127&De|128,De>>>=7,He.buf[He.pos++]=127&De|128,De>>>=7,He.buf[He.pos++]=127&De|128,De>>>=7,He.buf[He.pos++]=127&De|128,He.buf[He.pos]=127&(De>>>=7)}(ve,0,pe),function(De,Fe){var He=(7&De)<<4;Fe.buf[Fe.pos++]|=He|((De>>>=3)?128:0),De&&(Fe.buf[Fe.pos++]=127&De|((De>>>=7)?128:0),De&&(Fe.buf[Fe.pos++]=127&De|((De>>>=7)?128:0),De&&(Fe.buf[Fe.pos++]=127&De|((De>>>=7)?128:0),De&&(Fe.buf[Fe.pos++]=127&De|((De>>>=7)?128:0),De&&(Fe.buf[Fe.pos++]=127&De)))))}(Ie,pe)}(Q,this):(this.realloc(4),this.buf[this.pos++]=127&Q|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=127&(Q>>>=7)|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=127&(Q>>>=7)|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=Q>>>7&127))))},writeSVarint:function(Q){this.writeVarint(Q<0?2*-Q-1:2*Q)},writeBoolean:function(Q){this.writeVarint(!!Q)},writeString:function(Q){Q=String(Q),this.realloc(4*Q.length),this.pos++;var ue=this.pos;this.pos=function(ve,Ie,De){for(var Fe,He,ct=0;ct<Ie.length;ct++){if((Fe=Ie.charCodeAt(ct))>55295&&Fe<57344){if(!He){Fe>56319||ct+1===Ie.length?(ve[De++]=239,ve[De++]=191,ve[De++]=189):He=Fe;continue}if(Fe<56320){ve[De++]=239,ve[De++]=191,ve[De++]=189,He=Fe;continue}Fe=He-55296<<10|Fe-56320|65536,He=null}else He&&(ve[De++]=239,ve[De++]=191,ve[De++]=189,He=null);Fe<128?ve[De++]=Fe:(Fe<2048?ve[De++]=Fe>>6|192:(Fe<65536?ve[De++]=Fe>>12|224:(ve[De++]=Fe>>18|240,ve[De++]=Fe>>12&63|128),ve[De++]=Fe>>6&63|128),ve[De++]=63&Fe|128)}return De}(this.buf,Q,this.pos);var pe=this.pos-ue;pe>=128&&S(ue,pe,this),this.pos=ue-1,this.writeVarint(pe),this.pos+=pe},writeFloat:function(Q){this.realloc(4),u.write(this.buf,Q,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Q){this.realloc(8),u.write(this.buf,Q,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Q){var ue=Q.length;this.writeVarint(ue),this.realloc(ue);for(var pe=0;pe<ue;pe++)this.buf[this.pos++]=Q[pe]},writeRawMessage:function(Q,ue){this.pos++;var pe=this.pos;Q(ue,this);var ve=this.pos-pe;ve>=128&&S(pe,ve,this),this.pos=pe-1,this.writeVarint(ve),this.pos+=ve},writeMessage:function(Q,ue,pe){this.writeTag(Q,o.Bytes),this.writeRawMessage(ue,pe)},writePackedVarint:function(Q,ue){ue.length&&this.writeMessage(Q,P,ue)},writePackedSVarint:function(Q,ue){ue.length&&this.writeMessage(Q,I,ue)},writePackedBoolean:function(Q,ue){ue.length&&this.writeMessage(Q,N,ue)},writePackedFloat:function(Q,ue){ue.length&&this.writeMessage(Q,k,ue)},writePackedDouble:function(Q,ue){ue.length&&this.writeMessage(Q,D,ue)},writePackedFixed32:function(Q,ue){ue.length&&this.writeMessage(Q,W,ue)},writePackedSFixed32:function(Q,ue){ue.length&&this.writeMessage(Q,q,ue)},writePackedFixed64:function(Q,ue){ue.length&&this.writeMessage(Q,J,ue)},writePackedSFixed64:function(Q,ue){ue.length&&this.writeMessage(Q,ie,ue)},writeBytesField:function(Q,ue){this.writeTag(Q,o.Bytes),this.writeBytes(ue)},writeFixed32Field:function(Q,ue){this.writeTag(Q,o.Fixed32),this.writeFixed32(ue)},writeSFixed32Field:function(Q,ue){this.writeTag(Q,o.Fixed32),this.writeSFixed32(ue)},writeFixed64Field:function(Q,ue){this.writeTag(Q,o.Fixed64),this.writeFixed64(ue)},writeSFixed64Field:function(Q,ue){this.writeTag(Q,o.Fixed64),this.writeSFixed64(ue)},writeVarintField:function(Q,ue){this.writeTag(Q,o.Varint),this.writeVarint(ue)},writeSVarintField:function(Q,ue){this.writeTag(Q,o.Varint),this.writeSVarint(ue)},writeStringField:function(Q,ue){this.writeTag(Q,o.Bytes),this.writeString(ue)},writeFloatField:function(Q,ue){this.writeTag(Q,o.Fixed32),this.writeFloat(ue)},writeDoubleField:function(Q,ue){this.writeTag(Q,o.Fixed64),this.writeDouble(ue)},writeBooleanField:function(Q,ue){this.writeVarintField(Q,!!ue)}},gM}var hT=rs(xj());const _M=3;function Fre(u,o,l){o.glyphs=[],u===1&&l.readMessage(Bre,o)}function Bre(u,o,l){if(u===3){const{id:d,bitmap:p,width:y,height:_,left:S,top:P,advance:I}=l.readMessage(jre,{});o.glyphs.push({id:d,bitmap:new Md({width:y+2*_M,height:_+2*_M},p),metrics:{width:y,height:_,left:S,top:P,advance:I}})}else u===4?o.ascender=l.readSVarint():u===5&&(o.descender=l.readSVarint())}function jre(u,o,l){u===1?o.id=l.readVarint():u===2?o.bitmap=l.readBytes():u===3?o.width=l.readVarint():u===4?o.height=l.readVarint():u===5?o.left=l.readSVarint():u===6?o.top=l.readSVarint():u===7&&(o.advance=l.readVarint())}const bj=_M,ss={horizontal:1,vertical:2,horizontalOnly:3};class dx{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(o,l){const d=new dx;return d.scale=o||1,d.fontStack=l,d}static forImage(o){const l=new dx;return l.image=o,l}}class ly{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,l,d){const p=new ly;for(let y=0;y<o.sections.length;y++){const _=o.sections[y];_.image?p.addImageSection(_,d):p.addTextSection(_,l)}return p}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCodePoint(o){return this.text.codePointAt(o)}verticalizePunctuation(o){this.text=function(l,d){let p="";for(let y=0;y<l.length;y++){const _=l.charCodeAt(y+1)||null,S=l.charCodeAt(y-1)||null;p+=!d&&(_&&PS(_)&&!hx[l[y+1]]||S&&PS(S)&&!hx[l[y-1]])||!hx[l[y]]?l[y]:hx[l[y]]}return p}(this.text,o)}trim(){let o=0;for(let d=0;d<this.text.length&&dT[this.text.charCodeAt(d)];d++)o++;let l=this.text.length;for(let d=this.text.length-1;d>=0&&d>=o&&dT[this.text.charCodeAt(d)];d--)l--;this.text=this.text.substring(o,l),this.sectionIndex=this.sectionIndex.slice(o,l)}substring(o,l){const d=new ly;return d.text=this.text.substring(o,l),d.sectionIndex=this.sectionIndex.slice(o,l),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,l)=>Math.max(o,this.sections[l].scale),0)}addTextSection(o,l){this.text+=o.text,this.sections.push(dx.forText(o.scale,o.fontStack||l));const d=this.sections.length-1;for(let p=0;p<o.text.length;++p)this.sectionIndex.push(d)}addImageSection(o,l){const d=o.image?o.image.getPrimary():null;if(!d)return void nr("Can't add FormattedSection with an empty image.");d.scaleSelf(l);const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(dx.forImage(d)),this.sectionIndex.push(this.sections.length-1)):nr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function vM(u,o,l,d,p,y,_,S,P,I,k,D,N,W,q,J=1){const ie=ly.fromFeature(u,p,J);D===ss.vertical&&ie.verticalizePunctuation(N);let ae=[];const me=function(ve,Ie,De,Fe,He,ct){if(!ve)return[];const St=[],_t=function(xt,nt,lt,It,Mt,on){let Kt=0;for(let $t=0;$t<xt.length();$t++){const Ct=xt.getSection($t);Kt+=wj(xt.getCodePoint($t),Ct,It,Mt,nt,on)}return Kt/Math.max(1,Math.ceil(Kt/lt))}(ve,Ie,De,Fe,He,ct),bt=ve.text.indexOf("​")>=0;let Pt=0;for(let xt=0;xt<ve.length();xt++){const nt=ve.getSection(xt),lt=ve.getCodePoint(xt);if(dT[lt]||(Pt+=wj(lt,nt,Fe,He,Ie,ct)),xt<ve.length()-1){const It=!((st=lt)<11904||!(bn["Bopomofo Extended"](st)||bn.Bopomofo(st)||bn["CJK Compatibility Forms"](st)||bn["CJK Compatibility Ideographs"](st)||bn["CJK Compatibility"](st)||bn["CJK Radicals Supplement"](st)||bn["CJK Strokes"](st)||bn["CJK Symbols and Punctuation"](st)||bn["CJK Unified Ideographs Extension A"](st)||bn["CJK Unified Ideographs"](st)||bn["Enclosed CJK Letters and Months"](st)||bn["Halfwidth and Fullwidth Forms"](st)||bn.Hiragana(st)||bn["Ideographic Description Characters"](st)||bn["Kangxi Radicals"](st)||bn["Katakana Phonetic Extensions"](st)||bn.Katakana(st)||bn["Vertical Forms"](st)||bn["Yi Radicals"](st)||bn["Yi Syllables"](st)));($re[lt]||It||nt.image)&&St.push(Tj(xt+1,Pt,_t,St,Ure(lt,ve.getCodePoint(xt+1),It&&bt),!1))}}var st;return Ej(Tj(ve.length(),Pt,_t,St,0,!0))}(ie,I,y,o,d,W),{processBidirectionalText:de,processStyledBidirectionalText:Q}=Ps;if(de&&ie.sections.length===1){const ve=de(ie.toString(),me);for(const Ie of ve){const De=new ly;De.text=Ie,De.sections=ie.sections;for(let Fe=0;Fe<Ie.length;Fe++)De.sectionIndex.push(0);ae.push(De)}}else if(Q){const ve=Q(ie.text,ie.sectionIndex,me);for(const Ie of ve){const De=new ly;De.text=Ie[0],De.sectionIndex=Ie[1],De.sections=ie.sections,ae.push(De)}}else ae=function(ve,Ie){const De=[],Fe=ve.text;let He=0;for(const ct of Ie)De.push(ve.substring(He,ct)),He=ct;return He<Fe.length&&De.push(ve.substring(He,Fe.length)),De}(ie,me);const ue=[],pe={positionedLines:ue,text:ie.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:D,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(ve,Ie,De,Fe,He,ct,St,_t,bt,Pt,st,xt){let nt=0,lt=0,It=0;const Mt=_t==="right"?1:_t==="left"?0:.5;let on=!1;for(const tn of He){const Pn=tn.getSections();for(const Bn of Pn){if(Bn.image)continue;const $n=Ie[Bn.fontStack];if($n&&(on=$n.ascender!==void 0&&$n.descender!==void 0,!on))break}if(!on)break}let Kt=0;for(const tn of He){tn.trim();const Pn=tn.getMaxScale(),Bn=(Pn-1)*Oo,$n={positionedGlyphs:[],lineOffset:0};ve.positionedLines[Kt]=$n;const Jn=$n.positionedGlyphs;let Hn=0;if(!tn.length()){lt+=ct,++Kt;continue}let Gn=0,Ur=0;for(let ge=0;ge<tn.length();ge++){const xe=tn.getSection(ge),ut=tn.getSectionIndex(ge),Lt=tn.getCodePoint(ge);let Gt=xe.scale,Ut=null,nn=null,An=null,or=Oo,ar=0;bt===ss.vertical&&(($t=Lt)===12312||$t===12313||$t===12316||$t===12540||$t===12448)&&(bt=ss.horizontal);const Wn=!(bt===ss.horizontal||!st&&!Ap(Lt)||st&&(dT[Lt]||OI(Lt)));if(xe.image){const Rr=Fe.get(xe.image.toString());if(!Rr)continue;An=xe.image,ve.iconsInText=ve.iconsInText||!0,nn=Rr.paddedRect;const Kr=Rr.displaySize;Gt=Gt*Oo/xt,Ut={width:Kr[0],height:Kr[1],left:0,top:-bj,advance:Wn?Kr[1]:Kr[0],localGlyph:!1},ar=on?-Ut.height*Gt:Pn*Oo-17-Kr[1]*Gt,or=Ut.advance;const sr=(Wn?Kr[0]:Kr[1])*Gt-Oo*Pn;sr>0&&sr>Hn&&(Hn=sr)}else{const Rr=De[xe.fontStack];if(!Rr)continue;Rr[Lt]&&(nn=Rr[Lt]);const Kr=Ie[xe.fontStack];if(!Kr)continue;const sr=Kr.glyphs[Lt];if(!sr)continue;if(Ut=sr.metrics,or=Lt!==8203?Oo:0,on){const Ei=Kr.ascender!==void 0?Math.abs(Kr.ascender):0,oi=Kr.descender!==void 0?Math.abs(Kr.descender):0,Mr=(Ei+oi)*Gt;Gn<Mr&&(Gn=Mr,Ur=(Ei-oi)/2*Gt),ar=-Ei*Gt}else ar=(Pn-Gt)*Oo-17}Wn?(ve.verticalizable=!0,Jn.push({glyph:Lt,image:An,x:nt,y:lt+ar,vertical:Wn,scale:Gt,localGlyph:Ut.localGlyph,fontStack:xe.fontStack,sectionIndex:ut,metrics:Ut,rect:nn}),nt+=or*Gt+Pt):(Jn.push({glyph:Lt,image:An,x:nt,y:lt+ar,vertical:Wn,scale:Gt,localGlyph:Ut.localGlyph,fontStack:xe.fontStack,sectionIndex:ut,metrics:Ut,rect:nn}),nt+=Ut.advance*Gt+Pt)}Jn.length!==0&&(It=Math.max(nt-Pt,It),on?Aj(Jn,Mt,Hn,Ur,ct*Pn/2):Aj(Jn,Mt,Hn,0,ct/2)),nt=0;const ii=ct*Pn+Hn;$n.lineOffset=Math.max(Hn,Bn),lt+=ii,++Kt}var $t;const Ct=lt,{horizontalAlign:kn,verticalAlign:en}=xM(St);(function(tn,Pn,Bn,$n,Jn,Hn){const Gn=(Pn-Bn)*Jn,Ur=-Hn*$n;for(const ii of tn)for(const ge of ii.positionedGlyphs)ge.x+=Gn,ge.y+=Ur})(ve.positionedLines,Mt,kn,en,It,Ct),ve.top+=-en*Ct,ve.bottom=ve.top+Ct,ve.left+=-kn*It,ve.right=ve.left+It,ve.hasBaseline=on}(pe,o,l,d,ae,_,S,P,D,I,N,q),!function(ve){for(const Ie of ve)if(Ie.positionedGlyphs.length!==0)return!1;return!0}(ue))return pe}const dT={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},$re={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function wj(u,o,l,d,p,y){if(o.image){const _=d.get(o.image.toString());return _?_.displaySize[0]*o.scale*Oo/y+p:0}{const _=l[o.fontStack],S=_&&_.glyphs[u];return S?S.metrics.advance*o.scale+p:0}}function Sj(u,o,l,d){const p=Math.pow(u-o,2);return d?u<o?p/2:2*p:p+Math.abs(l)*l}function Ure(u,o,l){let d=0;return u===10&&(d-=1e4),l&&(d+=150),u!==40&&u!==65288||(d+=50),o!==41&&o!==65289||(d+=50),d}function Tj(u,o,l,d,p,y){let _=null,S=Sj(o,l,p,y);for(const P of d){const I=Sj(o-P.x,l,p,y)+P.badness;I<=S&&(_=P,S=I)}return{index:u,x:o,priorBreak:_,badness:S}}function Ej(u){return u?Ej(u.priorBreak).concat(u.index):[]}function xM(u){let o=.5,l=.5;switch(u){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:o,verticalAlign:l}}function Aj(u,o,l,d,p){if(!(o||l||d||p))return;const y=u.length-1,_=u[y],S=(_.x+_.metrics.advance*_.scale)*o;for(let P=0;P<=y;P++)u[P].x-=S,u[P].y+=l+d+p}function Pj(u){return u.imagePrimary!==void 0&&u.top!==void 0&&u.bottom!==void 0&&u.left!==void 0&&u.right!==void 0}function Vre(u,o,l,d){const{horizontalAlign:p,verticalAlign:y}=xM(d),_=l[0]-u.displaySize[0]*p,S=l[1]-u.displaySize[1]*y;return{imagePrimary:u,imageSecondary:o,top:S,bottom:S+u.displaySize[1],left:_,right:_+u.displaySize[0]}}function Cj(u,o,l,d,p,y){const _=u.imagePrimary;let S;if(_.content){const ie=_.content,ae=_.pixelRatio||1;S=[ie[0]/ae,ie[1]/ae,_.displaySize[0]-ie[2]/ae,_.displaySize[1]-ie[3]/ae]}const P=o.left*y,I=o.right*y;let k,D,N,W;l==="width"||l==="both"?(W=p[0]+P-d[3],D=p[0]+I+d[1]):(W=p[0]+(P+I-_.displaySize[0])/2,D=W+_.displaySize[0]);const q=o.top*y,J=o.bottom*y;return l==="height"||l==="both"?(k=p[1]+q-d[0],N=p[1]+J+d[2]):(k=p[1]+(q+J-_.displaySize[1])/2,N=k+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:k,right:D,bottom:N,left:W,collisionPadding:S}}function Ij(u){return!u.imagePrimary.stretchX}function Mj(u){return!u.imagePrimary.stretchY}function Oj(u){return{width:u.right-u.left,height:u.bottom-u.top}}const lu=128;function kj(u,o){const{expression:l}=o;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new zr(u+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:p}=l;let y=0;for(;y<d.length&&d[y]<=u;)y++;y=Math.max(0,y-1);let _=y;for(;_<d.length&&d[_]<u+1;)_++;_=Math.min(d.length-1,_);const S=d[y],P=d[_];return l.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:P,interpolationType:p}:{kind:"camera",minZoom:S,maxZoom:P,minSize:l.evaluate(new zr(S)),maxSize:l.evaluate(new zr(P)),interpolationType:p}}}function bM(u,{uSize:o,uSizeT:l},{lowerSize:d,upperSize:p}){return u.kind==="source"?d/lu:u.kind==="composite"?yn(d/lu,p/lu,l):o}function fx(u,o,l=1){let d=0,p=0;if(u.kind==="constant")p=u.layoutSize*l;else if(u.kind!=="source"){const{interpolationType:y,minZoom:_,maxZoom:S}=u,P=y?Ue(Pa.interpolationFactor(y,o,_,S),0,1):0;u.kind==="camera"?p=yn(u.minSize,u.maxSize,P)*l:d=P*l}return{uSizeT:d,uSize:p}}class sh extends yt{constructor(o,l,d,p,y){super(o,l),this.angle=p,this.z=d,y!==void 0&&(this.segment=y)}clone(){return new sh(this.x,this.y,this.z,this.angle,this.segment)}}function Rj(u,o,l,d,p){if(o.segment===void 0)return!0;let y=o,_=o.segment+1,S=0;for(;S>-l/2;){if(_--,_<0)return!1;S-=u[_].dist(y),y=u[_]}S+=u[_].dist(u[_+1]),_++;const P=[];let I=0;for(;S<l/2;){const k=u[_],D=u[_+1];if(!D)return!1;let N=u[_-1].angleTo(k)-k.angleTo(D);for(N=Math.abs((N+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:S,angleDelta:N}),I+=N;S-P[0].distance>d;)I-=P.shift().angleDelta;if(I>p)return!1;_++,S+=k.dist(D)}return!0}function Dj(u){let o=0;for(let l=0;l<u.length-1;l++)o+=u[l].dist(u[l+1]);return o}function Lj(u,o,l){return u?.6*o*l:0}function zj(u,o){return Math.max(u?u.right-u.left:0,o?o.right-o.left:0)}function Gre(u,o,l,d,p,y){const _=Lj(l,p,y),S=zj(l,d)*y;let P=0;const I=Dj(u)/2;for(let k=0;k<u.length-1;k++){const D=u[k],N=u[k+1],W=D.dist(N);if(P+W>I){const q=(I-P)/W,J=yn(D.x,N.x,q),ie=yn(D.y,N.y,q),ae=new sh(J,ie,0,N.angleTo(D),k);return!_||Rj(u,ae,S,_,o)?ae:void 0}P+=W}}function Wre(u,o,l,d,p,y,_,S,P){const I=Lj(d,y,_),k=zj(d,p),D=k*_,N=u[0].x===0||u[0].x===P||u[0].y===0||u[0].y===P;return o-D<o/4&&(o=D+o/4),Nj(u,N?o/2*S%o:(k/2+2*y)*_*S%o,o,I,l,D,N,!1,P)}function Nj(u,o,l,d,p,y,_,S,P){const I=y/2,k=Dj(u);let D=0,N=o-l,W=[];for(let q=0;q<u.length-1;q++){const J=u[q],ie=u[q+1],ae=J.dist(ie),me=ie.angleTo(J);for(;N+l<D+ae;){N+=l;const de=(N-D)/ae,Q=yn(J.x,ie.x,de),ue=yn(J.y,ie.y,de);if(Q>=0&&Q<P&&ue>=0&&ue<P&&N-I>=0&&N+I<=k){const pe=new sh(Q,ue,0,me,q);d&&!Rj(u,pe,y,d,p)||W.push(pe)}}D+=ae}return S||W.length||_||(W=Nj(u,D/2,l,d,p,y,_,!0,P)),W}function Fj(u){let o=0,l=0;for(const _ of u)o+=_.w*_.h,l=Math.max(l,_.w);u.sort((_,S)=>S.h-_.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),l),h:1/0}];let p=0,y=0;for(const _ of u)for(let S=d.length-1;S>=0;S--){const P=d[S];if(!(_.w>P.w||_.h>P.h)){if(_.x=P.x,_.y=P.y,y=Math.max(y,_.y+_.h),p=Math.max(p,_.x+_.w),_.w===P.w&&_.h===P.h){const I=d.pop();S<d.length&&(d[S]=I)}else _.h===P.h?(P.x+=_.w,P.w-=_.w):_.w===P.w?(P.y+=_.h,P.h-=_.h):(d.push({x:P.x+_.w,y:P.y,w:P.w-_.w,h:_.h}),P.y+=_.h,P.h-=_.h);break}}return{w:p,h:y,fill:o/(p*y)||0}}Zt(sh,"Anchor");const Wp=1;class px{static getImagePositionScale(o,l,d){if(l&&o&&o.options&&o.options.transform){const p=o.options.transform;return{x:p.a,y:p.d}}return{x:d,y:d}}constructor(o,l,d,p){this.paddedRect=o;const{pixelRatio:y,version:_,stretchX:S,stretchY:P,content:I,sdf:k,usvg:D}=l;this.pixelRatio=y,this.stretchX=S,this.stretchY=P,this.content=I,this.version=_,this.padding=d,this.sdf=k,this.scale=px.getImagePositionScale(p,D,y)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function wM(u,o,l){const d=Js.parse(u),p=function(y,_,S=[1,1]){return{x:0,y:0,w:(y.data?y.data.width:y.width*S[0])+2*_,h:(y.data?y.data.height:y.height*S[1])+2*_}}(o,l,[d.options.transform.a,d.options.transform.d]);return{bin:p,imagePosition:new px(p,o,l,d),imageVariant:d}}class Bj{constructor(o,l,d){const p=new Map,y=new Map;this.haveRenderCallbacks=[];const _=[];this.addImages(o,p,Wp,_),this.addImages(l,y,2,_);const{w:S,h:P}=Fj(_),I=new Go({width:S||1,height:P||1});for(const[k,D]of o.entries()){const N=p.get(k).paddedRect;Go.copy(D.data,I,{x:0,y:0},{x:N.x+Wp,y:N.y+Wp},D.data,d,D.sdf)}for(const[k,D]of l.entries()){const N=y.get(k),W=N.paddedRect;let q=N.padding;const J=W.x+q,ie=W.y+q,ae=D.data.width,me=D.data.height;q=q>1?q-1:q,Go.copy(D.data,I,{x:0,y:0},{x:J,y:ie},D.data,d),Go.copy(D.data,I,{x:0,y:me-q},{x:J,y:ie-q},{width:ae,height:q},d),Go.copy(D.data,I,{x:0,y:0},{x:J,y:ie+me},{width:ae,height:q},d),Go.copy(D.data,I,{x:ae-q,y:0},{x:J-q,y:ie},{width:q,height:me},d),Go.copy(D.data,I,{x:0,y:0},{x:J+ae,y:ie},{width:q,height:me},d),Go.copy(D.data,I,{x:ae-q,y:me-q},{x:J-q,y:ie-q},{width:q,height:q},d),Go.copy(D.data,I,{x:0,y:me-q},{x:J+ae,y:ie-q},{width:q,height:q},d),Go.copy(D.data,I,{x:0,y:0},{x:J+ae,y:ie+me},{width:q,height:q},d),Go.copy(D.data,I,{x:ae-q,y:0},{x:J-q,y:ie+me},{width:q,height:q},d)}this.lut=d,this.image=I,this.iconPositions=p,this.patternPositions=y}addImages(o,l,d,p){for(const[y,_]of o.entries()){const{bin:S,imagePosition:P,imageVariant:I}=wM(y,_,d);l.set(y,P),p.push(S),_.hasRenderCallback&&this.haveRenderCallbacks.push(I.id)}}patchUpdatedImages(o,l,d){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>o.hasImage(p,d)),o.dispatchRenderCallbacks(this.haveRenderCallbacks,d);for(const p of o.getUpdatedImages(d)){for(const y of this.iconPositions.keys()){const _=Js.parse(y);if(ja.isEqual(_.id,p)){const S=o.getImage(p,d);this.patchUpdatedImage(this.iconPositions.get(y),S,l)}}for(const y of this.patternPositions.keys()){const _=Js.parse(y);if(ja.isEqual(_.id,p)){const S=o.getImage(p,d);this.patchUpdatedImage(this.patternPositions.get(y),S,l)}}}}patchUpdatedImage(o,l,d){if(!o||!l||o.version===l.version)return;o.version=l.version;const[p,y]=o.tl,_=o.sdf;if(this.lut||_){const S={width:l.data.width,height:l.data.height},P=new Go(S);Go.copy(l.data,P,{x:0,y:0},{x:0,y:0},S,this.lut,_),d.update(P,{position:{x:p,y}})}else d.update(l.data,{position:{x:p,y}})}}Zt(px,"ImagePosition"),Zt(Bj,"ImageAtlas");const mx=1e20;function jj(u,o,l,d,p,y,_,S,P){for(let I=o;I<o+d;I++)$j(u,l*y+I,y,p,_,S,P);for(let I=l;I<l+p;I++)$j(u,I*y+o,1,d,_,S,P)}function $j(u,o,l,d,p,y,_){y[0]=0,_[0]=-mx,_[1]=mx,p[0]=u[o];for(let S=1,P=0,I=0;S<d;S++){p[S]=u[o+S*l];const k=S*S;do{const D=y[P];I=(p[S]-p[D]+k-D*D)/(S-D)/2}while(I<=_[P]&&--P>-1);P++,y[P]=S,_[P]=I,_[P+1]=mx}for(let S=0,P=0;S<d;S++){for(;_[P+1]<S;)P++;const I=y[P],k=S-I;u[o+S*l]=p[I]+k*k}}const cc=2,SM={none:0,ideographs:1,all:2};class cy{constructor(o,l,d){this.requestManager=o,this.localGlyphMode=l,this.localFontFamily=d,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o,l){this.urls[l]=o}getGlyphs(o,l,d){const p=[],y=this.urls[l]||Vo.GLYPHS_URL;for(const _ in o)for(const S of o[_])p.push({stack:_,id:S});ft(p,({stack:_,id:S},P)=>{let I=this.entries[_];I||(I=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=I.glyphs[S];if(k!==void 0)return void P(null,{stack:_,id:S,glyph:k});if(k=this._tinySDF(I,_,S),k)return I.glyphs[S]=k,void P(null,{stack:_,id:S,glyph:k});const D=Math.floor(S/256);if(256*D>65535)return nr("glyphs > 65535 not supported"),void P(null,{stack:_,id:S,glyph:k});if(I.ranges[D])return void P(null,{stack:_,id:S,glyph:k});let N=I.requests[D];N||(N=I.requests[D]=[],cy.loadGlyphRange(_,D,y,this.requestManager,(W,q)=>{if(q){I.ascender=q.ascender,I.descender=q.descender;for(const J in q.glyphs)this._doesCharSupportLocalGlyph(+J)||(I.glyphs[+J]=q.glyphs[+J]);I.ranges[D]=!0}for(const J of N)J(W,q);delete I.requests[D]})),N.push((W,q)=>{W?P(W):q&&P(null,{stack:_,id:S,glyph:q.glyphs[S]||null})})},(_,S)=>{if(_)d(_);else if(S){const P={};for(const{stack:I,id:k,glyph:D}of S)P[I]===void 0&&(P[I]={}),P[I].glyphs===void 0&&(P[I].glyphs={}),P[I].glyphs[k]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},P[I].ascender=this.entries[I].ascender,P[I].descender=this.entries[I].descender;d(null,P)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==SM.none&&(this.localGlyphMode===SM.all?!!this.localFontFamily:!!this.localFontFamily&&(bn["CJK Unified Ideographs"](o)||bn["Hangul Syllables"](o)||bn.Hiragana(o)||bn.Katakana(o)||bn["CJK Symbols and Punctuation"](o)||bn["CJK Unified Ideographs Extension A"](o)||bn["CJK Unified Ideographs Extension B"](o)||bn.Osage(o)))}_tinySDF(o,l,d){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(d))return;let y=o.tinySDF;if(!y){let J="400";/bold/i.test(l)?J="900":/medium/i.test(l)?J="500":/light/i.test(l)&&(J="200"),y=o.tinySDF=new cy.TinySDF({fontFamily:p,fontWeight:J,fontSize:24*cc,buffer:3*cc,radius:8*cc}),y.fontWeight=J}if(this.localGlyphs[y.fontWeight][d])return this.localGlyphs[y.fontWeight][d];const _=String.fromCodePoint(d),{data:S,width:P,height:I,glyphWidth:k,glyphHeight:D,glyphLeft:N,glyphTop:W,glyphAdvance:q}=y.draw(_);return this.localGlyphs[y.fontWeight][d]={id:d,bitmap:new Md({width:P,height:I},S),metrics:{width:k/cc,height:D/cc,left:N/cc,top:W/cc-27,advance:q/cc,localGlyph:!0}}}}cy.loadGlyphRange=function(u,o,l,d,p){const y=256*o,_=y+255,S=d.transformRequest(d.normalizeGlyphsURL(l).replace("{fontstack}",u).replace("{range}",`${y}-${_}`),sg.Glyphs);Yh(S,(P,I)=>{if(P)p(P);else if(I){const k={},D=function(N){return new hT(N).readFields(Fre,{})}(I);for(const N of D.glyphs)k[N.id]=N;p(null,{glyphs:k,ascender:D.ascender,descender:D.descender})}})},cy.TinySDF=class{constructor({fontSize:u=24,buffer:o=3,radius:l=8,cutoff:d=.25,fontFamily:p="sans-serif",fontWeight:y="normal",fontStyle:_="normal"}={}){this.buffer=o,this.cutoff=d,this.radius=l;const S=this.size=u+4*o,P=this._createCanvas(S),I=this.ctx=P.getContext("2d",{willReadFrequently:!0});I.font=`${_} ${y} ${u}px ${p}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(u){const o=document.createElement("canvas");return o.width=o.height=u,o}draw(u){const{width:o,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:p,actualBoundingBoxRight:y}=this.ctx.measureText(u),_=Math.ceil(l),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-p))),P=Math.min(this.size-this.buffer,_+Math.ceil(d)),I=S+2*this.buffer,k=P+2*this.buffer,D=Math.max(I*k,0),N=new Uint8ClampedArray(D),W={data:N,width:I,height:k,glyphWidth:S,glyphHeight:P,glyphTop:_,glyphLeft:0,glyphAdvance:o};if(S===0||P===0)return W;const{ctx:q,buffer:J,gridInner:ie,gridOuter:ae}=this;q.clearRect(J,J,S,P),q.fillText(u,J,J+_);const me=q.getImageData(J,J,S,P);ae.fill(mx,0,D),ie.fill(0,0,D);for(let de=0;de<P;de++)for(let Q=0;Q<S;Q++){const ue=me.data[4*(de*S+Q)+3]/255;if(ue===0)continue;const pe=(de+J)*I+Q+J;if(ue===1)ae[pe]=0,ie[pe]=mx;else{const ve=.5-ue;ae[pe]=ve>0?ve*ve:0,ie[pe]=ve<0?ve*ve:0}}jj(ae,0,0,I,k,I,this.f,this.v,this.z),jj(ie,J,J,S,P,I,this.f,this.v,this.z);for(let de=0;de<D;de++){const Q=Math.sqrt(ae[de])-Math.sqrt(ie[de]);N[de]=Math.round(255-255*(Q/this.radius+this.cutoff))}return W}};const Rd=Wp;function Uj(u,o){return u+o[1]-o[0]}function Vj(u,o,l,d,p=1){const y=[],_=u.imagePrimary,S=_.pixelRatio,P=_.paddedRect.w-2*Rd,I=_.paddedRect.h-2*Rd,k=(u.right-u.left)*p,D=(u.bottom-u.top)*p,N=_.stretchX||[[0,P]],W=_.stretchY||[[0,I]],q=N.reduce(Uj,0),J=W.reduce(Uj,0),ie=P-q,ae=I-J;let me=0,de=q,Q=0,ue=J,pe=0,ve=ie,Ie=0,De=ae;if(_.content&&d){const He=_.content;me=fT(N,0,He[0]),Q=fT(W,0,He[1]),de=fT(N,He[0],He[2]),ue=fT(W,He[1],He[3]),pe=He[0]-me,Ie=He[1]-Q,ve=He[2]-He[0]-de,De=He[3]-He[1]-ue}const Fe=(He,ct,St,_t)=>{const bt=pT(He.stretch-me,de,k,u.left*p),Pt=mT(He.fixed-pe,ve,He.stretch,q),st=pT(ct.stretch-Q,ue,D,u.top*p),xt=mT(ct.fixed-Ie,De,ct.stretch,J),nt=pT(St.stretch-me,de,k,u.left*p),lt=mT(St.fixed-pe,ve,St.stretch,q),It=pT(_t.stretch-Q,ue,D,u.top*p),Mt=mT(_t.fixed-Ie,De,_t.stretch,J),on=new yt(bt,st),Kt=new yt(nt,st),$t=new yt(nt,It),Ct=new yt(bt,It),kn=new yt(Pt/S,xt/S),en=new yt(lt/S,Mt/S),tn=o*Math.PI/180;if(tn){const Gn=Math.sin(tn),Ur=Math.cos(tn),ii=[Ur,-Gn,Gn,Ur];on._matMult(ii),Kt._matMult(ii),Ct._matMult(ii),$t._matMult(ii)}const Pn=He.stretch+He.fixed,Bn=St.stretch+St.fixed,$n=ct.stretch+ct.fixed,Jn=_t.stretch+_t.fixed,Hn=u.imageSecondary;return{tl:on,tr:Kt,bl:Ct,br:$t,texPrimary:{x:_.paddedRect.x+Rd+Pn,y:_.paddedRect.y+Rd+$n,w:Bn-Pn,h:Jn-$n},texSecondary:Hn?{x:Hn.paddedRect.x+Rd+Pn,y:Hn.paddedRect.y+Rd+$n,w:Bn-Pn,h:Jn-$n}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:kn,pixelOffsetBR:en,minFontScaleX:ve/S/k,minFontScaleY:De/S/D,isSDF:l}};if(d&&(_.stretchX||_.stretchY)){const He=Gj(N,ie,q),ct=Gj(W,ae,J);for(let St=0;St<He.length-1;St++){const _t=He[St],bt=He[St+1];for(let Pt=0;Pt<ct.length-1;Pt++)y.push(Fe(_t,ct[Pt],bt,ct[Pt+1]))}}else y.push(Fe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:I+1}));return y}function fT(u,o,l){let d=0;for(const p of u)d+=Math.max(o,Math.min(l,p[1]))-Math.max(o,Math.min(l,p[0]));return d}function Gj(u,o,l){const d=[{fixed:-Rd,stretch:0}];for(const[p,y]of u){const _=d[d.length-1];d.push({fixed:p-_.stretch,stretch:_.stretch}),d.push({fixed:p-_.stretch,stretch:_.stretch+(y-p)})}return d.push({fixed:o+Rd,stretch:l}),d}function pT(u,o,l,d){return u/o*l+d}function mT(u,o,l,d){return u-o*l/d}function Hre(u,o,l,d){const p=o+u.positionedLines[d].lineOffset;return d===0?l+p/2:l+(p+(o+u.positionedLines[d-1].lineOffset))/2}function qre(u,o=1,l=!1){let d=1/0,p=1/0,y=-1/0,_=-1/0;const S=u[0];for(let W=0;W<S.length;W++){const q=S[W];(!W||q.x<d)&&(d=q.x),(!W||q.y<p)&&(p=q.y),(!W||q.x>y)&&(y=q.x),(!W||q.y>_)&&(_=q.y)}const P=Math.min(y-d,_-p);let I=P/2;const k=new _g([],Zre);if(P===0)return new yt(d,p);for(let W=d;W<y;W+=P)for(let q=p;q<_;q+=P)k.push(new uy(W+I,q+I,I,u));let D=function(W){let q=0,J=0,ie=0;const ae=W[0];for(let me=0,de=ae.length,Q=de-1;me<de;Q=me++){const ue=ae[me],pe=ae[Q],ve=ue.x*pe.y-pe.x*ue.y;J+=(ue.x+pe.x)*ve,ie+=(ue.y+pe.y)*ve,q+=3*ve}return new uy(J/q,ie/q,0,W)}(u),N=k.length;for(;k.length;){const W=k.pop();(W.d>D.d||!D.d)&&(D=W,l&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,N)),W.max-D.d<=o||(I=W.h/2,k.push(new uy(W.p.x-I,W.p.y-I,I,u)),k.push(new uy(W.p.x+I,W.p.y-I,I,u)),k.push(new uy(W.p.x-I,W.p.y+I,I,u)),k.push(new uy(W.p.x+I,W.p.y+I,I,u)),N+=4)}return l&&(console.log(`num probes: ${N}`),console.log(`best distance: ${D.d}`)),D.p}function Zre(u,o){return o.max-u.max}class uy{constructor(o,l,d,p){this.p=new yt(o,l),this.h=d,this.d=function(y,_){let S=!1,P=1/0;for(let I=0;I<_.length;I++){const k=_[I];for(let D=0,N=k.length,W=N-1;D<N;W=D++){const q=k[D],J=k[W];q.y>y.y!=J.y>y.y&&y.x<(J.x-q.x)*(y.y-q.y)/(J.y-q.y)+q.x&&(S=!S),P=Math.min(P,hr(y,q,J))}}return(S?1:-1)*Math.sqrt(P)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const Xre=Object.keys,TM=Number.POSITIVE_INFINITY,Kre=Math.sqrt(2);function Wj(u,[o,l]){let d=0,p=0;if(l===TM){o<0&&(o=0);const y=o/Kre;switch(u){case"top-right":case"top-left":p=y-7;break;case"bottom-right":case"bottom-left":p=7-y;break;case"bottom":p=7-o;break;case"top":p=o-7}switch(u){case"top-right":case"bottom-right":d=-y;break;case"top-left":case"bottom-left":d=y;break;case"left":d=o;break;case"right":d=-o}}else{switch(o=Math.abs(o),l=Math.abs(l),u){case"top-right":case"top-left":case"top":p=l-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-l}switch(u){case"top-right":case"bottom-right":case"right":d=-o;break;case"top-left":case"bottom-left":case"left":d=o}}return[d,p]}function gT(u,o,l,d,p,y,_,S,P){if(!o||!o.usvg)return;const I=Oj(d),k=Oj(p),D=y!=="both"&&y!=="width"||!Ij(d)?1:Math.max(1,k.width/I.width),N=y!=="both"&&y!=="height"||!Mj(d)?1:Math.max(1,k.height/I.height);l.scaleSelf(D,N);const W=l.toString();_.set(W,l),S.set(W,o);const{imagePosition:q}=wM(W,o,Wp);P.set(W,q)}function Hj(u,o,l,d,p,y,_,S){if(!u)return;const P=function(I,k,D,N,W){if(I.kind==="camera")return I.maxSize;if(I.kind==="composite"){const q=k.possiblyEvaluate(new zr(I.maxZoom),D).evaluate(W,{},D),J=k.possiblyEvaluate(new zr(I.minZoom),D).evaluate(W,{},D);return Math.max(q,J)}return k.possiblyEvaluate(new zr(N)).evaluate(W,{},D)}(o,l,d,p,y);return u.scaleSelf(P*S*_)}function qj(u,o,l,d,p,y,_,S){return{iconPrimary:Hj(u.getPrimary(),o,l,d,p,y,_,S),iconSecondary:Hj(u.getSecondary(),o,l,d,p,y,_,S)}}function Zj(u,o,l,d){if(!u)return;const p=o.get(l.toString());if(u.imagePrimary=p,d){const y=o.get(d.toString());u.imageSecondary=y}}function Yre(u,o){for(const l in u.horizontal)Xj(u.horizontal[l],o);Xj(u.vertical,o)}function Xj(u,o){if(u){for(const l of u.positionedLines)for(const d of l.positionedGlyphs)if(d.image!==null){const p=d.image.toString();d.rect=o.get(p).paddedRect}}}function EM(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Jre(u,o,l,d,p,y,_,S,P){const I=AM(y.horizontal)||y.vertical,k=l.get("icon-text-fit-padding").evaluate(d,{},p);let D,N=o;return o&&P!=="none"&&(u.allowVerticalPlacement&&y.vertical&&(D=Cj(o,y.vertical,P,k,S,_)),I&&(N=Cj(o,I,P,k,S,_))),{defaultShapedIcon:N,verticallyShapedIcon:D}}function Qre(u,o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae,me,de){let Q=_.textMaxSize.evaluate(o,{},N);Q===void 0?Q=S*_.textScaleFactor:Q*=_.textScaleFactor;const ue=u.layers[0].layout,pe=AM(l.horizontal)||l.vertical,ve=W.name==="globe",Ie=Oo,De=u.tilePixelRatio*Q/Ie,Fe=(Pt=u.overscaling,u.zoom>18&&Pt>2&&(Pt>>=1),Math.max(jt/(512*Pt),1)*ue.get("symbol-spacing")),He=ue.get("text-padding")*u.tilePixelRatio,ct=ue.get("icon-padding")*u.tilePixelRatio,St=ne(ue.get("text-max-angle")),_t=ue.get("icon-rotation-alignment")==="map"&&de!=="point",bt=Fe/2;var Pt;u.hasAnyIconTextFit===!1&&ie!=="none"&&(u.hasAnyIconTextFit=!0);const st=o.properties?+o.properties[$p]:null,xt=st&&u.elevationFeatureIdToIndex?u.elevationFeatureIdToIndex.get(st):65535,nt=(lt,It,Mt)=>{if(It.x<0||It.x>=jt||It.y<0||It.y>=jt)return;let on=null;if(ve){const{x:Kt,y:$t,z:Ct}=W.projectTilePoint(It.x,It.y,Mt);on={anchor:new sh(Kt,$t,Ct,0,void 0),up:W.upVector(Mt,It.x,It.y)}}(function(Kt,$t,Ct,kn,en,tn,Pn,Bn,$n,Jn,Hn,Gn,Ur,ii,ge,xe,ut,Lt,Gt,Ut,nn,An,or,ar,Wn,Rr,Kr,sr,Ei){const oi=Kt.addToLineVertexArray($t,kn);let Mr,zi,ci,Yr,ai,Lr,Xn,Br=0,Ai=0,En=0,pr=0,ui=-1,ki=-1;const gi={};let eo=Ba("");const Vr=Ct?Ct.anchor:$t,Ki=sr!=="none";let Va=0,Wo=0;if($n._unevaluatedLayout.getValue("text-radial-offset")===void 0){const to=$n.layout.get("text-offset").evaluate(nn,{},Wn);Va=to[0]*Oo,Wo=to[1]*Oo}else Va=$n.layout.get("text-radial-offset").evaluate(nn,{},Wn)*Oo,Wo=TM;if(Kt.allowVerticalPlacement&&en.vertical){const to=en.vertical;if(ge)Lr=PM(to),Bn&&(Xn=PM(Bn));else{const go=$n.layout.get("text-rotate").evaluate(nn,{},Wn)+90;ci=yT(Jn,Vr,$t,Hn,Gn,Ur,to,ii,go,xe),Bn&&(Yr=yT(Jn,Vr,$t,Hn,Gn,Ur,Bn,Lt,go))}}if(tn){const to=Kt.iconSizeData,go=$n.layout.get("icon-rotate").evaluate(nn,{},Wn),Ho=Vj(tn,go,or,Ki,An.iconScaleFactor),ga=Bn?Vj(Bn,go,or,Ki,An.iconScaleFactor):void 0;zi=yT(Jn,Vr,$t,Hn,Gn,Ur,tn,Lt,go,null),Br=4*Ho.length;let ta=null;to.kind==="source"?(ta=[lu*$n.layout.get("icon-size").evaluate(nn,{},Wn)*An.iconScaleFactor],ta[0]>Dd&&nr(`${Kt.layerIds[0]}: Value for "icon-size" is >= ${gx}. Reduce your "icon-size".`)):to.kind==="composite"&&(ta=[lu*An.compositeIconSizes[0].evaluate(nn,{},Wn)*An.iconScaleFactor,lu*An.compositeIconSizes[1].evaluate(nn,{},Wn)*An.iconScaleFactor],(ta[0]>Dd||ta[1]>Dd)&&nr(`${Kt.layerIds[0]}: Value for "icon-size" is >= ${gx}. Reduce your "icon-size".`)),Kt.addSymbols(Kt.icon,Ho,ta,Ut,Gt,nn,void 0,Ct,$t,oi.lineStartIndex,oi.lineLength,-1,ar,Wn,Rr,Kr),ui=Kt.icon.placedSymbolArray.length-1,ga&&(Ai=4*ga.length,Kt.addSymbols(Kt.icon,ga,ta,Ut,Gt,nn,ss.vertical,Ct,$t,oi.lineStartIndex,oi.lineLength,-1,ar,Wn,Rr,Kr),ki=Kt.icon.placedSymbolArray.length-1)}for(const to in en.horizontal){const go=to,Ho=en.horizontal[go];Mr||(eo=Ba(Ho.text),ge?ai=PM(Ho):Mr=yT(Jn,Vr,$t,Hn,Gn,Ur,Ho,ii,$n.layout.get("text-rotate").evaluate(nn,{},Wn),xe));const ga=Ho.positionedLines.length===1;if(En+=Kj(Kt,Ct,$t,Ho,Pn,$n,ge,nn,xe,oi,en.vertical?ss.horizontal:ss.horizontalOnly,ga?Xre(en.horizontal):[go],gi,ui,An,ar,Wn,Rr),ga)break}en.vertical&&(pr+=Kj(Kt,Ct,$t,en.vertical,Pn,$n,ge,nn,xe,oi,ss.vertical,["vertical"],gi,ki,An,ar,Wn,Rr));let Fo=-1;const Ga=(to,go)=>to?Math.max(to,go):go;Fo=Ga(ai,Fo),Fo=Ga(Lr,Fo),Fo=Ga(Xn,Fo);const cu=Fo>-1?1:0;Kt.glyphOffsetArray.length>=65535&&nr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),nn.sortKey!==void 0&&Kt.addToSortKeyRanges(Kt.symbolInstances.length,nn.sortKey),Kt.symbolInstances.emplaceBack($t.x,$t.y,Vr.x,Vr.y,Vr.z,gi.right>=0?gi.right:-1,gi.center>=0?gi.center:-1,gi.left>=0?gi.left:-1,gi.vertical>=0?gi.vertical:-1,ui,ki,eo,Mr!==void 0?Mr:Kt.collisionBoxArray.length,Mr!==void 0?Mr+1:Kt.collisionBoxArray.length,ci!==void 0?ci:Kt.collisionBoxArray.length,ci!==void 0?ci+1:Kt.collisionBoxArray.length,zi!==void 0?zi:Kt.collisionBoxArray.length,zi!==void 0?zi+1:Kt.collisionBoxArray.length,Yr||Kt.collisionBoxArray.length,Yr?Yr+1:Kt.collisionBoxArray.length,Hn,En,pr,Br,Ai,cu,0,Va,Wo,Fo,0,Ki?1:0,Ei)})(u,It,on,lt,l,d,y,p,u.layers[0],u.collisionBoxArray,o.index,o.sourceLayerIndex,u.index,He,me,I,0,ct,_t,ae,o,_,k,D,N,q,J,ie,xt)};if(de==="line")for(const lt of uT(o.geometry,0,0,jt,jt)){const It=Wre(lt,Fe,St,l.vertical||pe,d,Ie,De,u.overscaling,jt);for(const Mt of It)pe&&eie(u,pe.text,bt,Mt)||nt(lt,Mt,N)}else if(de==="line-center"){for(const lt of o.geometry)if(lt.length>1){const It=Gre(lt,St,l.vertical||pe,d,Ie,De);It&&nt(lt,It,N)}}else if(o.type==="Polygon")for(const lt of rT(o.geometry,0)){const It=qre(lt,16);nt(lt[0],new sh(It.x,It.y,0,0,void 0),N)}else if(o.type==="LineString")for(const lt of o.geometry)nt(lt,new sh(lt[0].x,lt[0].y,0,0,void 0),N);else if(o.type==="Point")for(const lt of o.geometry)for(const It of lt)nt([It],new sh(It.x,It.y,0,0,void 0),N)}const gx=255,Dd=gx*lu;function Kj(u,o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie,ae){const me=function(ue,pe,ve,Ie,De,Fe,He,ct){const St=[];if(pe.positionedLines.length===0)return St;const _t=Ie.layout.get("text-rotate").evaluate(Fe,{})*Math.PI/180,bt=function(lt){const It=lt[0],Mt=lt[1],on=It*Mt;return on>0?[It,-Mt]:on<0?[-It,Mt]:It===0?[Mt,It]:[Mt,-It]}(ve);let Pt=Math.abs(pe.top-pe.bottom);for(const lt of pe.positionedLines)Pt-=lt.lineOffset;const st=pe.positionedLines.length,xt=Pt/st;let nt=pe.top-ve[1];for(let lt=0;lt<st;++lt){const It=pe.positionedLines[lt];nt=Hre(pe,xt,nt,lt);for(const Mt of It.positionedGlyphs){if(!Mt.rect)continue;const on=Mt.rect||{};let Kt=bj+1,$t=!0,Ct=1,kn=0;if(Mt.image){const nn=He.get(Mt.image.toString());if(!nn)continue;if(nn.sdf){nr("SDF images are not supported in formatted text and will be ignored.");continue}$t=!1,Ct=nn.pixelRatio,Kt=Wp/Ct}const en=(De||ct)&&Mt.vertical,tn=Mt.metrics.advance*Mt.scale/2,Pn=Mt.metrics,Bn=Mt.rect;if(Bn===null)continue;ct&&pe.verticalizable&&(kn=Mt.image?tn-Mt.metrics.width*Mt.scale/2:0);const $n=De?[Mt.x+tn,Mt.y]:[0,0];let Jn=[0,0],Hn=[0,0],Gn=!1;De||(en?(Hn=[Mt.x+tn+bt[0],Mt.y+bt[1]-kn],Gn=!0):Jn=[Mt.x+tn+ve[0],Mt.y+ve[1]-kn]);const Ur=Bn.w*Mt.scale/(Ct*(Mt.localGlyph?cc:1)),ii=Bn.h*Mt.scale/(Ct*(Mt.localGlyph?cc:1));let ge,xe,ut,Lt;if(en){const nn=Mt.y-nt,An=new yt(-tn,tn-nn),or=-Math.PI/2,ar=new yt(...Hn);ge=new yt(-tn+Jn[0],Jn[1]),ge._rotateAround(or,An)._add(ar),ge.x+=-nn+tn,ge.y-=(Pn.left-Kt)*Mt.scale;const Wn=Mt.image?Pn.advance*Mt.scale:Oo*Mt.scale,Rr=String.fromCodePoint(Mt.glyph);Lre(Rr)?ge.x+=(1-Kt)*Mt.scale:zre(Rr)?ge.x+=Wn-Pn.height*Mt.scale+(-Kt-1)*Mt.scale:ge.x+=Mt.image||Pn.width+2*Kt===Bn.w&&Pn.height+2*Kt===Bn.h?(Wn-ii)/2:(Wn-(Pn.height+2*Kt)*Mt.scale)/2,xe=new yt(ge.x,ge.y-Ur),ut=new yt(ge.x+ii,ge.y),Lt=new yt(ge.x+ii,ge.y-Ur)}else{const nn=(Pn.left-Kt)*Mt.scale-tn+Jn[0],An=(-Pn.top-Kt)*Mt.scale+Jn[1],or=nn+Ur,ar=An+ii;ge=new yt(nn,An),xe=new yt(or,An),ut=new yt(nn,ar),Lt=new yt(or,ar)}if(_t){let nn;nn=De?new yt(0,0):Gn?new yt(bt[0],bt[1]):new yt(ve[0],ve[1]),ge._rotateAround(_t,nn),xe._rotateAround(_t,nn),ut._rotateAround(_t,nn),Lt._rotateAround(_t,nn)}const Gt=new yt(0,0),Ut=new yt(0,0);St.push({tl:ge,tr:xe,bl:ut,br:Lt,texPrimary:on,texSecondary:void 0,writingMode:pe.writingMode,glyphOffset:$n,sectionIndex:Mt.sectionIndex,isSDF:$t,pixelOffsetTL:Gt,pixelOffsetBR:Ut,minFontScaleX:0,minFontScaleY:0})}}return St}(0,d,P,y,_,S,p,u.allowVerticalPlacement),de=u.textSizeData;let Q=null;de.kind==="source"?(Q=[lu*y.layout.get("text-size").evaluate(S,{},ie)*q.textScaleFactor],Q[0]>Dd&&nr(`${u.layerIds[0]}: Value for "text-size" is >= ${gx}. Reduce your "text-size".`)):de.kind==="composite"&&(Q=[lu*q.compositeTextSizes[0].evaluate(S,{},ie)*q.textScaleFactor,lu*q.compositeTextSizes[1].evaluate(S,{},ie)*q.textScaleFactor],(Q[0]>Dd||Q[1]>Dd)&&nr(`${u.layerIds[0]}: Value for "text-size" is >= ${gx}. Reduce your "text-size".`)),u.addSymbols(u.text,me,Q,P,_,S,k,o,l,I.lineStartIndex,I.lineLength,W,J,ie,ae,!1);for(const ue of D)N[ue]=u.text.placedSymbolArray.length-1;return 4*me.length}function AM(u){for(const o in u)return u[o];return null}function yT(u,o,l,d,p,y,_,S,P,I){let k=_.top,D=_.bottom,N=_.left,W=_.right;if(Pj(_)&&_.collisionPadding){const q=_.collisionPadding;N-=q[0],k-=q[1],W+=q[2],D+=q[3]}if(P){const q=new yt(N,k),J=new yt(W,k),ie=new yt(N,D),ae=new yt(W,D),me=ne(P);let de=new yt(0,0);I&&(de=new yt(I[0],I[1])),q._rotateAround(me,de),J._rotateAround(me,de),ie._rotateAround(me,de),ae._rotateAround(me,de),N=Math.min(q.x,J.x,ie.x,ae.x),W=Math.max(q.x,J.x,ie.x,ae.x),k=Math.min(q.y,J.y,ie.y,ae.y),D=Math.max(q.y,J.y,ie.y,ae.y)}return u.emplaceBack(o.x,o.y,o.z,l.x,l.y,N,k,W,D,S,d,p,y),u.length-1}function PM(u){Pj(u)&&u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const o=u.bottom-u.top;return o>0?Math.max(10,o):null}function eie(u,o,l,d){const p=u.compareText;if(o in p){const y=p[o];for(let _=y.length-1;_>=0;_--)if(d.dist(y[_])<l)return!0}else p[o]=[];return p[o].push(d),!1}function Yj(u,o){const l=u.fovAboveCenter,d=u.elevation?u.elevation.getMinElevationBelowMSL()*o:0,p=(u._camera.position[2]*u.worldSize-d)/Math.cos(u._pitch),y=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-u._pitch-l,.01));let _=Math.sin(u._pitch)*y+p;const S=p*(1/u._horizonShift);if(!u.elevation||u.elevation.exaggeration()===0){let P=Math.max(u.zoom-17,0);u.isOrthographic&&(P/=10),_*=1+P}return Math.min(1.01*_,S)}function yx(u,o){if(!o.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:o};const l=Math.pow(2,-u.z),d=u.x*l,p=(u.x+1)*l,y=u.y*l,_=(u.y+1)*l,S=Me(d),P=Me(p),I=ke(y),k=ke(_),D=o.project(S,I),N=o.project(P,I),W=o.project(P,k),q=o.project(S,k);let J=Math.min(D.x,N.x,W.x,q.x),ie=Math.min(D.y,N.y,W.y,q.y),ae=Math.max(D.x,N.x,W.x,q.x),me=Math.max(D.y,N.y,W.y,q.y);const de=l/16;function Q(pe,ve,Ie,De,Fe,He){const ct=(Ie+Fe)/2,St=(De+He)/2,_t=o.project(Me(ct),ke(St)),bt=Math.max(0,J-_t.x,ie-_t.y,_t.x-ae,_t.y-me);J=Math.min(J,_t.x),ae=Math.max(ae,_t.x),ie=Math.min(ie,_t.y),me=Math.max(me,_t.y),bt>de&&(Q(pe,_t,Ie,De,ct,St),Q(_t,ve,ct,St,Fe,He))}Q(D,N,d,y,p,y),Q(N,W,p,y,p,_),Q(W,q,p,_,d,_),Q(q,D,d,_,d,y),J-=de,ie-=de,ae+=de,me+=de;const ue=1/Math.max(ae-J,me-ie);return{scale:ue,x:J*ue,y:ie*ue,x2:ae*ue,y2:me*ue,projection:o}}function Jj(u,{x:o,y:l},d=0){return new yt(((o-d)*u.scale-u.x)*jt,(l*u.scale-u.y)*jt)}const tie=L(new Float32Array(16));class Ld{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,l){return{x:0,y:0,z:0}}unproject(o,l){return new re(0,0)}projectTilePoint(o,l,d){return{x:o,y:l,z:0}}locationPoint(o,l,d,p=!0){return o._coordinatePoint(o.locationCoordinate(l,d),p)}pixelsPerMeter(o,l){return we(1,o)*l}pixelSpaceConversion(o,l,d){return 1}farthestPixelDistance(o){return Yj(o,o.pixelsPerMeter)}pointCoordinate(o,l,d,p){const y=o.horizonLineFromTop(!1),_=new yt(l,Math.max(y,d));return o.rayIntersectionCoordinate(o.pointRayIntersection(_,p))}pointCoordinate3D(o,l,d){const p=new yt(l,d);if(o.elevation)return o.elevation.pointCoordinate(p);{const y=this.pointCoordinate(o,p.x,p.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(o,l){if(o.elevation&&o.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(o,l.x,l.y);const d=o.horizonLineFromTop();return l.y<d}createInversionMatrix(o,l){return tie}createTileMatrix(o,l,d){let p,y,_;const S=d.canonical,P=L(new Float64Array(16));if(this.isReprojectedInTileSpace){const I=yx(S,this);p=1,y=I.x+d.wrap*I.scale,_=I.y,H(P,P,[p/I.scale,p/I.scale,o.pixelsPerMeter/l])}else p=l/o.zoomScale(S.z),y=(S.x+Math.pow(2,S.z)*d.wrap)*p,_=S.y*p;return $(P,P,[y,_,0]),H(P,P,[p/jt,p/jt,1]),P}upVector(o,l,d){return[0,0,1]}upVectorScale(o,l,d){return{metersToTile:1}}}class nie extends Ld{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[l,d]=this.parallels=o.parallels||[29.5,45.5],p=Math.sin(ne(l));this.n=(p+Math.sin(ne(d)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(o,l){const{n:d,c:p,r0:y}=this,_=ne(o-this.center[0]),S=ne(l),P=Math.sqrt(p-2*d*Math.sin(S))/d;return{x:P*Math.sin(_*d),y:P*Math.cos(_*d)-y,z:0}}unproject(o,l){const{n:d,c:p,r0:y}=this,_=y+l;let S=Math.atan2(o,Math.abs(_))*Math.sign(_);_*d<0&&(S-=Math.PI*Math.sign(o)*Math.sign(_));const P=ne(this.center[0])*d;S=rt(S,-Math.PI-P,Math.PI-P);const I=Ue(le(S/d)+this.center[0],-180,180),k=Math.asin(Ue((p-(o*o+_*_)*d*d)/(2*d),-1,1)),D=Ue(le(k),-qe,qe);return new re(I,D)}}const _x=1.340264,vx=-.081106,xx=893e-6,bx=.003796,_T=Math.sqrt(3)/2;class rie extends Ld{project(o,l){l=l/180*Math.PI,o=o/180*Math.PI;const d=Math.asin(_T*Math.sin(l)),p=d*d,y=p*p*p;return{x:.5*(o*Math.cos(d)/(_T*(_x+3*vx*p+y*(7*xx+9*bx*p)))/Math.PI+.5),y:1-.5*(d*(_x+vx*p+y*(xx+bx*p))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=d*d,y=p*p*p;for(let k,D,N,W=0;W<12&&(D=d*(_x+vx*p+y*(xx+bx*p))-l,N=_x+3*vx*p+y*(7*xx+9*bx*p),k=D/N,d=Ue(d-k,-Math.PI/3,Math.PI/3),p=d*d,y=p*p*p,!(Math.abs(k)<1e-12));++W);const _=_T*o*(_x+3*vx*p+y*(7*xx+9*bx*p))/Math.cos(d),S=Math.asin(Math.sin(d)/_T),P=Ue(180*_/Math.PI,-180,180),I=Ue(180*S/Math.PI,-qe,qe);return new re(P,I)}}class iie extends Ld{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){return{x:.5+o/360,y:.5-l/360,z:0}}unproject(o,l){const d=360*(o-.5),p=Ue(360*(.5-l),-qe,qe);return new re(d,p)}}const hy=Math.PI/2;function vT(u){return Math.tan((hy+u)/2)}class oie extends Ld{constructor(o){super(o),this.center=o.center||[0,30];const[l,d]=this.parallels=o.parallels||[30,30];let p=ne(l),y=ne(d);this.southernCenter=p+y<0,this.southernCenter&&(p=-p,y=-y);const _=Math.cos(p),S=vT(p);this.n=p===y?Math.sin(p):Math.log(_/Math.cos(y))/Math.log(vT(y)/S),this.f=_*Math.pow(vT(p),this.n)/this.n}project(o,l){l=ne(l),this.southernCenter&&(l=-l),o=ne(o-this.center[0]);const d=1e-6,{n:p,f:y}=this;y>0?l<-hy+d&&(l=-hy+d):l>hy-d&&(l=hy-d);const _=y/Math.pow(vT(l),p);let S=_*Math.sin(p*o),P=y-_*Math.cos(p*o);return S=.5*(S/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:S,y:this.southernCenter?P:1-P,z:0}}unproject(o,l){o=(2*o-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:d,f:p}=this,y=p-l,_=Math.sign(y),S=Math.sign(d)*Math.sqrt(o*o+y*y);let P=Math.atan2(o,Math.abs(y))*_;y*d<0&&(P-=Math.PI*Math.sign(o)*_);const I=Ue(le(P/d)+this.center[0],-180,180),k=Ue(le(2*Math.atan(Math.pow(p/S,1/d))-hy),-qe,qe);return new re(I,this.southernCenter?-k:k)}}class Qj extends Ld{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,l){return{x:Ee(o),y:Ae(l),z:0}}unproject(o,l){const d=Me(o),p=ke(l);return new re(d,p)}}const e4=ne(qe);class aie extends Ld{project(o,l){const d=(l=ne(l))*l,p=d*d;return{x:.5*((o=ne(o))*(.8707-.131979*d+p*(p*(.003971*d-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+d*(.015085+p*(.028874*d-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=25,y=0,_=d*d;do{_=d*d;const I=_*_;y=(d*(1.007226+_*(.015085+I*(.028874*_-.044475-.005916*I)))-l)/(1.007226+_*(.045255+I*(.259866*_-.311325-.005916*11*I))),d=Ue(d-y,-e4,e4)}while(Math.abs(y)>1e-6&&--p>0);_=d*d;const S=Ue(le(o/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),P=le(d);return new re(S,P)}}const t4=ne(qe);class sie extends Ld{project(o,l){l=ne(l),o=ne(o);const d=Math.cos(l),p=2/Math.PI,y=Math.acos(d*Math.cos(o/2)),_=Math.sin(y)/y,S=.5*(o*p+2*d*Math.sin(o/2)/_)||0,P=.5*(l+Math.sin(l)/_)||0;return{x:.5*(S/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(o,l){let d=o=(2*o-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,y=25;const _=1e-6;let S=0,P=0;do{const I=Math.cos(p),k=Math.sin(p),D=2*k*I,N=k*k,W=I*I,q=Math.cos(d/2),J=Math.sin(d/2),ie=2*q*J,ae=J*J,me=1-W*q*q,de=me?1/me:0,Q=me?Math.acos(I*q)*Math.sqrt(1/me):0,ue=.5*(2*Q*I*J+2*d/Math.PI)-o,pe=.5*(Q*k+p)-l,ve=.5*de*(W*ae+Q*I*q*N)+1/Math.PI,Ie=de*(ie*D/4-Q*k*J),De=.125*de*(D*J-Q*k*W*ie),Fe=.5*de*(N*q+Q*ae*I)+.5,He=Ie*De-Fe*ve;S=(pe*Ie-ue*Fe)/He,P=(ue*De-pe*ve)/He,d=Ue(d-S,-Math.PI,Math.PI),p=Ue(p-P,-t4,t4)}while((Math.abs(S)>_||Math.abs(P)>_)&&--y>0);return new re(le(d),le(p))}}class n4 extends Ld{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ne(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){const{scale:d,cosPhi:p}=this;return{x:ne(o)*p*d+.5,y:-Math.sin(ne(l))/p*d+.5,z:0}}unproject(o,l){const{scale:d,cosPhi:p}=this,y=-(l-.5)/d,_=Ue(le((o-.5)/d)/p,-180,180),S=Math.asin(Ue(y*p,-1,1)),P=Ue(le(S),-qe,qe);return new re(_,P)}}class lie extends Qj{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,l,d){const p=Q0(o,l,d);return Nt(p,p,eT(au(d))),{x:p[0],y:p[1],z:p[2]}}locationPoint(o,l,d){const p=te(l.lat,l.lng),y=fn([],p),_=d?o._centerAltitude+d:o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(l),o._centerAltitude):o._centerAltitude;zt(p,p,y,we(1,0)*jt*_);const S=L(new Float64Array(16));return V(S,o.pixelMatrix,o.globeMatrix),Nt(p,p,S),new yt(p[0],p[1])}pixelsPerMeter(o,l){return we(1,0)*l}pixelSpaceConversion(o,l,d){const p=we(1,o)*l,y=yn(we(1,45)*l,p,d);return this.pixelsPerMeter(o,l)/y}createTileMatrix(o,l,d){const p=WI(au(d.canonical));return V(new Float64Array(16),o.globeMatrix,p)}createInversionMatrix(o,l){const{center:d}=o,p=eT(au(l));return Y(p,p,ne(d.lng)),K(p,p,ne(d.lat)),H(p,p,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(o,l,d,p){return BF(o,l,d,!0)||new et(0,0)}pointCoordinate3D(o,l,d){const p=this.pointCoordinate(o,l,d,0);return[p.x,p.y,p.z]}isPointAboveHorizon(o,l){return!BF(o,l.x,l.y,!1)}farthestPixelDistance(o){const l=function(p,y){const _=p.cameraToCenterDistance,S=p._centerAltitude*y,P=p._camera,I=p._camera.forward(),k=ht([],pt([],I,-_),[0,0,S]),D=p.worldSize/(2*Math.PI),N=[0,0,-D],W=p.width/p.height,q=Math.tan(p.fovAboveCenter),J=pt([],P.up(),q),ie=pt([],P.right(),q*W),ae=fn([],ht([],ht([],I,J),ie)),me=[];let de;if(new ol(k,ae).closestPointOnSphere(N,D,me)){const Q=ht([],me,N),ue=zn([],Q,k);de=Math.cos(p.fovAboveCenter)*$e(ue)}else{const Q=zn([],k,N),ue=zn([],N,k);fn(ue,ue);const pe=$e(Q)-D;de=Math.sqrt(pe*(pe+2*D));const ve=Math.acos(de/(D+pe))-Math.acos(Cn(I,ue));de*=Math.cos(ve)}return 1.01*de}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),d=Id(o.zoom);if(d>0){const p=Yj(o,we(1,o.center.lat)*o.worldSize),y=o.worldSize/(2*Math.PI),_=Math.max(o.width,o.height)/o.worldSize*Math.PI;return yn(l,p+y*(1-Math.cos(_)),Math.pow(d,10))}return l}upVector(o,l,d){return Q0(l,d,o,1)}upVectorScale(o){return{metersToTile:Cd(QS(au(o)))}}}function r4(u){const o=u.parallels,l=!!o&&Math.abs(o[0]+o[1])<.01;switch(u.name){case"mercator":return new Qj(u);case"equirectangular":return new iie(u);case"naturalEarth":return new aie(u);case"equalEarth":return new rie(u);case"winkelTripel":return new sie(u);case"albers":return l?new n4(u):new nie(u);case"lambertConformalConic":return l?new n4(u):new oie(u);case"globe":return new lie(u)}throw new Error(`Invalid projection name: ${u.name}`)}const cie=Od.VectorTileFeature.types,uie=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function xT(u,o,l,d,p,y,_,S,P,I,k,D,N){const W=S?Math.min(Dd,Math.round(S[0])):0,q=S?Math.min(Dd,Math.round(S[1])):0;u.emplaceBack(o,l,Math.round(32*d),Math.round(32*p),y,_,(W<<1)+(P?1:0),q,16*I,16*k,256*D,256*N)}function bT(u,o,l){u.emplaceBack(o,l)}function wT(u,o,l,d,p,y,_){u.emplaceBack(o,l,d,p,y,_)}function ST(u,o,l,d,p){u.emplaceBack(o,l,d,p),u.emplaceBack(o,l,d,p),u.emplaceBack(o,l,d,p),u.emplaceBack(o,l,d,p)}function hie(u){for(const o of u.sections)if(RI(o.text))return!0;return!1}class CM{constructor(o){this.layoutVertexArray=new wd,this.indexArray=new bo,this.programConfigurations=o,this.segments=new Ti,this.dynamicLayoutVertexArray=new El,this.opacityVertexArray=new U0,this.placedSymbolArray=new BS,this.iconTransitioningVertexArray=new ru,this.globeExtVertexArray=new Ca,this.zOffsetVertexArray=new xd}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(o,l,d,p,y){this.isEmpty()||(d&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Are.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,Cre.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,uie,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=o.createVertexBuffer(this.iconTransitioningVertexArray,Mre.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Pre.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||y)&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Ire.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||p)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Zt(CM,"SymbolBuffers");class IM{constructor(o,l,d){this.layoutVertexArray=new o,this.layoutAttributes=l,this.indexArray=new d,this.segments=new Ti,this.collisionVertexArray=new G0,this.collisionVertexArrayExt=new El}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,Ore.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,kre.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Zt(IM,"CollisionBuffers");class TT{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.lut=o.lut,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=L([]),this.placementViewportMatrix=L([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=kj(this.zoom,l["text-size"]),this.iconSizeData=kj(this.zoom,l["icon-size"]);const d=this.layers[0].layout,p=d.get("symbol-sort-key"),y=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(_=>ss[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=o.sourceID,this.projection=o.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new CM(new ih(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("text")||o.startsWith("symbol"))),this.icon=new CM(new ih(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("icon")||o.startsWith("symbol"))),this.glyphOffsetArray=new K0,this.lineVertexArray=new US,this.symbolInstances=new $S}calculateGlyphDependencies(o,l,d,p,y){for(const _ of o){const S=_.codePointAt(0);if(S===void 0)break;if(l[S]=!0,p&&y&&S<=65535){const P=hx[_];P&&(l[P.charCodeAt(0)]=!0)}}}updateFootprints(o,l){}updateReplacement(o,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const d=l.getReplacementRegionsForTile(o.toUnwrapped(),!0);return!cM(this.activeReplacements,d)&&(this.activeReplacements=d,!0)}populate(o,l,d,p){const y=this.layers[0],_=y.layout,S=this.projection.name==="globe",P=_.get("text-font"),I=_.get("text-field"),k=_.get("icon-image"),[D,N]=_.get("icon-size-scale-range"),W=Ue(l.scaleFactor||1,D,N),q=(I.value.kind!=="constant"||I.value.value instanceof ha&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),J=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,ie=_.get("symbol-sort-key");if(this.features=[],!q&&!J)return;const ae=l.iconDependencies,me=l.glyphDependencies,de=l.availableImages,Q=new zr(this.zoom);for(const{feature:ue,id:pe,index:ve,sourceLayerIndex:Ie}of o){const De=y._featureFilter.needGeometry,Fe=an(ue,De);if(!y._featureFilter.filter(Q,Fe,d))continue;if(De||(Fe.geometry=Yt(ue,d,p)),S&&ue.type!==1&&d.z<=5){const bt=Fe.geometry,Pt=.98078528056,st=(xt,nt)=>Cn(Q0(xt.x,xt.y,d,1),Q0(nt.x,nt.y,d,1))<Pt;for(let xt=0;xt<bt.length;xt++)bt[xt]=Tt(bt[xt],st)}let He,ct;if(q){const bt=y.getValueAndResolveTokens("text-field",Fe,d,de),Pt=ha.factory(bt);hie(Pt)&&(this.hasRTLText=!0),(!this.hasRTLText||yd()==="unavailable"||this.hasRTLText&&Ps.isParsed())&&(He=Dre(Pt,y,Fe))}if(J){const bt=y.getValueAndResolveTokens("icon-image",Fe,d,de);ct=typeof bt=="string"?Aa.build(bt):bt}if(!He&&!ct)continue;const St=this.sortFeaturesByKey?ie.evaluate(Fe,{},d):void 0,_t={id:pe,text:He,icon:ct,index:ve,sourceLayerIndex:Ie,geometry:Fe.geometry,properties:ue.properties,type:cie[ue.type],sortKey:St};if(this.features.push(_t),ct){const bt=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Pt,iconSecondary:st}=qj(ct,this.iconSizeData,bt["icon-size"],d,this.zoom,_t,this.pixelRatio,W),xt=Pt.id.toString();if(ae.has(xt)?ae.get(xt).push(Pt):ae.set(xt,[Pt]),st){const nt=st.id.toString();ae.has(nt)?ae.get(nt).push(st):ae.set(nt,[st])}}if(He){const bt=P.evaluate(Fe,{},d).join(","),Pt=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ss.vertical)>=0;for(const st of He.sections)if(st.image){const xt=st.image.getPrimary().scaleSelf(this.pixelRatio),nt=xt.id.toString(),lt=ae.get(nt)||[];lt.push(xt),ae.set(nt,lt)}else{const xt=M0(He.toString()),nt=st.fontStack||bt,lt=me[nt]=me[nt]||{};this.calculateGlyphDependencies(st.text,lt,Pt,this.allowVerticalPlacement,xt)}}}if(_.get("symbol-placement")==="line"&&(this.features=function(ue){const pe={},ve={},Ie=[];let De=0;function Fe(_t){Ie.push(ue[_t]),De++}function He(_t,bt,Pt){const st=ve[_t];return delete ve[_t],ve[bt]=st,Ie[st].geometry[0].pop(),Ie[st].geometry[0]=Ie[st].geometry[0].concat(Pt[0]),st}function ct(_t,bt,Pt){const st=pe[bt];return delete pe[bt],pe[_t]=st,Ie[st].geometry[0].shift(),Ie[st].geometry[0]=Pt[0].concat(Ie[st].geometry[0]),st}function St(_t,bt,Pt){const st=Pt?bt[0][bt[0].length-1]:bt[0][0];return`${_t}:${st.x}:${st.y}`}for(let _t=0;_t<ue.length;_t++){const bt=ue[_t],Pt=bt.geometry,st=bt.text?bt.text.toString():null;if(!st){Fe(_t);continue}const xt=St(st,Pt),nt=St(st,Pt,!0);if(xt in ve&&nt in pe&&ve[xt]!==pe[nt]){const lt=ct(xt,nt,Pt),It=He(xt,nt,Ie[lt].geometry);delete pe[xt],delete ve[nt],ve[St(st,Ie[It].geometry,!0)]=It,Ie[lt].geometry=null}else xt in ve?He(xt,nt,Pt):nt in pe?ct(xt,nt,Pt):(Fe(_t),pe[xt]=De-1,ve[nt]=De-1)}return Ie.filter(_t=>_t.geometry)}(this.features)),_.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",l.elevationFeatures){!this.elevationFeatures&&l.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const ue of l.elevationFeatures)this.elevationFeatureIdToIndex.set(ue.id,this.elevationFeatures.length),this.elevationFeatures.push(ue)}}else _.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((ue,pe)=>ue.sortKey-pe.sortKey)}update(o,l,d,p,y,_,S){this.text.programConfigurations.updatePaintArrays(o,l,y,d,p,_,S),this.icon.programConfigurations.updatePaintArrays(o,l,y,d,p,_,S)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);if(d.elevationFeatureIndex===65535)continue;const p=this.elevationFeatures[d.elevationFeatureIndex];if(p){const y=.05+p.pointElevation(new yt(d.tileAnchorX,d.tileAnchorY));d.zOffset!==y&&(o=!0,d.zOffset=y)}}o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const o=(y,_,S)=>{d+=_,d>y.length&&y.resize(d);for(let P=-_;P<0;P++)y.emplace(P+d,S)},l=(y,_,S)=>{p+=_,p>y.length&&y.resize(p);for(let P=-_;P<0;P++)y.emplace(P+p,S)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let d=0,p=0;for(let y=0;y<this.symbolInstances.length;y++){const _=this.symbolInstances.get(y),{numHorizontalGlyphVertices:S,numVerticalGlyphVertices:P,numIconVertices:I}=_,k=_.zOffset,D=I>0;if((S>0||P>0)&&(o(this.text.zOffsetVertexArray,S,k),o(this.text.zOffsetVertexArray,P,k)),D){const{placedIconSymbolIndex:N,verticalPlacedIconSymbolIndex:W}=_;N>=0&&l(this.icon.zOffsetVertexArray,I,k),W>=0&&l(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,k)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=r4(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,l){const d=this.lineVertexArray.length;if(o.segment!==void 0)for(const{x:p,y}of l)this.lineVertexArray.emplaceBack(p,y);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(o,l,d,p,y,_,S,P,I,k,D,N,W,q,J,ie){const ae=o.indexArray,me=o.layoutVertexArray,de=o.globeExtVertexArray,Q=o.segments.prepareSegment(4*l.length,me,ae,this.canOverlap?_.sortKey:void 0),ue=this.glyphOffsetArray.length,pe=Q.vertexLength,ve=this.allowVerticalPlacement&&S===ss.vertical?Math.PI/2:0,Ie=_.text&&_.text.sections;for(let Fe=0;Fe<l.length;Fe++){const{tl:He,tr:ct,bl:St,br:_t,texPrimary:bt,texSecondary:Pt,pixelOffsetTL:st,pixelOffsetBR:xt,minFontScaleX:nt,minFontScaleY:lt,glyphOffset:It,isSDF:Mt,sectionIndex:on}=l[Fe],Kt=Q.vertexLength,$t=It[1];if(xT(me,I.x,I.y,He.x,$t+He.y,bt.x,bt.y,d,Mt,st.x,st.y,nt,lt),xT(me,I.x,I.y,ct.x,$t+ct.y,bt.x+bt.w,bt.y,d,Mt,xt.x,st.y,nt,lt),xT(me,I.x,I.y,St.x,$t+St.y,bt.x,bt.y+bt.h,d,Mt,st.x,xt.y,nt,lt),xT(me,I.x,I.y,_t.x,$t+_t.y,bt.x+bt.w,bt.y+bt.h,d,Mt,xt.x,xt.y,nt,lt),P){const{x:Ct,y:kn,z:en}=P.anchor,[tn,Pn,Bn]=P.up;wT(de,Ct,kn,en,tn,Pn,Bn),wT(de,Ct,kn,en,tn,Pn,Bn),wT(de,Ct,kn,en,tn,Pn,Bn),wT(de,Ct,kn,en,tn,Pn,Bn),ST(o.dynamicLayoutVertexArray,Ct,kn,en,ve)}else ST(o.dynamicLayoutVertexArray,I.x,I.y,I.z,ve);if(ie){const Ct=Pt||bt;bT(o.iconTransitioningVertexArray,Ct.x,Ct.y),bT(o.iconTransitioningVertexArray,Ct.x+Ct.w,Ct.y),bT(o.iconTransitioningVertexArray,Ct.x,Ct.y+Ct.h),bT(o.iconTransitioningVertexArray,Ct.x+Ct.w,Ct.y+Ct.h)}ae.emplaceBack(Kt,Kt+1,Kt+2),ae.emplaceBack(Kt+1,Kt+2,Kt+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(It[0]),Fe!==l.length-1&&on===l[Fe+1].sectionIndex||o.programConfigurations.populatePaintArrays(me.length,_,_.index,{},W,q,J,Ie&&Ie[on])}const De=P?P.anchor:I;o.placedSymbolArray.emplaceBack(De.x,De.y,De.z,I.x,I.y,ue,this.glyphOffsetArray.length-ue,pe,k,D,I.segment,d?d[0]:0,d?d[1]:0,p[0],p[1],S,0,0,0,N,0)}_commitLayoutVertex(o,l,d,p,y,_,S){o.emplaceBack(l,d,p,y,_,Math.round(S.x),Math.round(S.y))}_addCollisionDebugVertices(o,l,d,p,y,_,S){const P=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),I=P.vertexLength,k=S.tileAnchorX,D=S.tileAnchorY;for(let W=0;W<4;W++)d.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(d.collisionVertexArrayExt,l,o.padding,S.zOffset),this._commitLayoutVertex(d.layoutVertexArray,p,y,_,k,D,new yt(o.x1,o.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,y,_,k,D,new yt(o.x2,o.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,y,_,k,D,new yt(o.x2,o.y2)),this._commitLayoutVertex(d.layoutVertexArray,p,y,_,k,D,new yt(o.x1,o.y2)),P.vertexLength+=4;const N=d.indexArray;N.emplaceBack(I,I+1),N.emplaceBack(I+1,I+2),N.emplaceBack(I+2,I+3),N.emplaceBack(I+3,I),P.primitiveLength+=4}_addTextDebugCollisionBoxes(o,l,d,p,y,_){for(let S=p;S<y;S++){const P=d.get(S),I=this.getSymbolInstanceTextSize(o,_,l,S);this._addCollisionDebugVertices(P,I,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(o,l,d,p,y,_){for(let S=p;S<y;S++){const P=d.get(S),I=this.getSymbolInstanceIconSize(o,l,_.placedIconSymbolIndex);this._addCollisionDebugVertices(P,I,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,_)}}generateCollisionDebugBuffers(o,l,d){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new IM(Yg,yj.members,ru),this.iconCollisionBox=new IM(Yg,yj.members,ru);const p=fx(this.iconSizeData,o),y=fx(this.textSizeData,o,d);for(let _=0;_<this.symbolInstances.length;_++){const S=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(y,o,l,S.textBoxStartIndex,S.textBoxEndIndex,S),this._addTextDebugCollisionBoxes(y,o,l,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._addIconDebugCollisionBoxes(p,o,l,S.iconBoxStartIndex,S.iconBoxEndIndex,S),this._addIconDebugCollisionBoxes(p,o,l,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S)}}getSymbolInstanceTextSize(o,l,d,p){const y=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),_=bM(this.textSizeData,o,y)/Oo;return this.tilePixelRatio*_}getSymbolInstanceIconSize(o,l,d){const p=this.icon.placedSymbolArray.get(d),y=bM(this.iconSizeData,o,p);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(o,l,d,p){o.emplaceBack(l,-d,-d,p),o.emplaceBack(l,d,-d,p),o.emplaceBack(l,d,d,p),o.emplaceBack(l,-d,d,p)}_updateTextDebugCollisionBoxes(o,l,d,p,y,_,S){for(let P=p;P<y;P++){const I=d.get(P),k=this.getSymbolInstanceTextSize(o,_,l,P);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,I.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(o,l,d,p,y,_,S){for(let P=p;P<y;P++){const I=d.get(P),k=this.getSymbolInstanceIconSize(o,l,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,I.padding,_.zOffset)}}updateCollisionDebugBuffers(o,l,d,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const y=fx(this.iconSizeData,o,p),_=fx(this.textSizeData,o,d);for(let S=0;S<this.symbolInstances.length;S++){const P=this.symbolInstances.get(S);this._updateTextDebugCollisionBoxes(_,o,l,P.textBoxStartIndex,P.textBoxEndIndex,P,d),this._updateTextDebugCollisionBoxes(_,o,l,P.verticalTextBoxStartIndex,P.verticalTextBoxEndIndex,P,d),this._updateIconDebugCollisionBoxes(y,o,l,P.iconBoxStartIndex,P.iconBoxEndIndex,P,p),this._updateIconDebugCollisionBoxes(y,o,l,P.verticalIconBoxStartIndex,P.verticalIconBoxEndIndex,P,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,l,d,p,y,_,S,P,I){const k={};if(l<d){const{x1:D,y1:N,x2:W,y2:q,padding:J,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:de,tileAnchorY:Q,featureIndex:ue}=o.get(l);k.textBox={x1:D,y1:N,x2:W,y2:q,padding:J,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:de,tileAnchorY:Q},k.textFeatureIndex=ue}if(p<y){const{x1:D,y1:N,x2:W,y2:q,padding:J,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:de,tileAnchorY:Q,featureIndex:ue}=o.get(p);k.verticalTextBox={x1:D,y1:N,x2:W,y2:q,padding:J,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:de,tileAnchorY:Q},k.verticalTextFeatureIndex=ue}if(_<S){const{x1:D,y1:N,x2:W,y2:q,padding:J,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:de,tileAnchorY:Q,featureIndex:ue}=o.get(_);k.iconBox={x1:D,y1:N,x2:W,y2:q,padding:J,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:de,tileAnchorY:Q},k.iconFeatureIndex=ue}if(P<I){const{x1:D,y1:N,x2:W,y2:q,padding:J,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:de,tileAnchorY:Q,featureIndex:ue}=o.get(P);k.verticalIconBox={x1:D,y1:N,x2:W,y2:q,padding:J,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:me,tileAnchorX:de,tileAnchorY:Q},k.verticalIconFeatureIndex=ue}return k}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(o,l){const d=o.placedSymbolArray.get(l),p=d.vertexStartIndex+4*d.numGlyphs;for(let y=d.vertexStartIndex;y<p;y+=4)o.indexArray.emplaceBack(y,y+1,y+2),o.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(o),d=Math.cos(o),p=[],y=[],_=[];for(let S=0;S<this.symbolInstances.length;++S){_.push(S);const P=this.symbolInstances.get(S);p.push(0|Math.round(l*P.tileAnchorX+d*P.tileAnchorY)),y.push(P.featureIndex)}return _.sort((S,P)=>p[S]-p[P]||y[P]-y[S]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let o=0;o<this.symbolInstances.length;++o)this.symbolInstanceIndexesSortedZOffset.push(o)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((o,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(o).zOffset)}addToSortKeyRanges(o,l){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===l?d.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const d=this.symbolInstances.get(l);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:y,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:S,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:I}=d;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),y>=0&&y!==p&&this.addIndicesForPlacedSymbol(this.text,y),_>=0&&_!==y&&_!==p&&this.addIndicesForPlacedSymbol(this.text,_),S>=0&&this.addIndicesForPlacedSymbol(this.text,S),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let i4,o4,MM;Zt(TT,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),TT.addDynamicAttributes=ST;class a4{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Gc,this.defaultValue=o}evaluate(o){if(o.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(o.formattedSection))return l.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Zt(a4,"FormatSectionOverride",{omit:["defaultValue"]});const OM=()=>MM||(MM={layout:i4||(i4=new Di({"symbol-placement":new Dt(Ke.layout_symbol["symbol-placement"]),"symbol-spacing":new Dt(Ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Dt(Ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(Ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Dt(Ke.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Dt(Ke.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Dt(Ke.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Dt(Ke.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Dt(Ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new Dt(Ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Dt(Ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(Ke.layout_symbol["icon-size"]),"icon-size-scale-range":new Dt(Ke.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new qt(Ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qt(Ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(Ke.layout_symbol["icon-image"]),"icon-rotate":new qt(Ke.layout_symbol["icon-rotate"]),"icon-padding":new Dt(Ke.layout_symbol["icon-padding"]),"icon-keep-upright":new Dt(Ke.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(Ke.layout_symbol["icon-offset"]),"icon-anchor":new qt(Ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Dt(Ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Dt(Ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Dt(Ke.layout_symbol["text-rotation-alignment"]),"text-field":new qt(Ke.layout_symbol["text-field"]),"text-font":new qt(Ke.layout_symbol["text-font"]),"text-size":new qt(Ke.layout_symbol["text-size"]),"text-size-scale-range":new Dt(Ke.layout_symbol["text-size-scale-range"]),"text-max-width":new qt(Ke.layout_symbol["text-max-width"]),"text-line-height":new qt(Ke.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(Ke.layout_symbol["text-letter-spacing"]),"text-justify":new qt(Ke.layout_symbol["text-justify"]),"text-radial-offset":new qt(Ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Dt(Ke.layout_symbol["text-variable-anchor"]),"text-anchor":new qt(Ke.layout_symbol["text-anchor"]),"text-max-angle":new Dt(Ke.layout_symbol["text-max-angle"]),"text-writing-mode":new Dt(Ke.layout_symbol["text-writing-mode"]),"text-rotate":new qt(Ke.layout_symbol["text-rotate"]),"text-padding":new Dt(Ke.layout_symbol["text-padding"]),"text-keep-upright":new Dt(Ke.layout_symbol["text-keep-upright"]),"text-transform":new qt(Ke.layout_symbol["text-transform"]),"text-offset":new qt(Ke.layout_symbol["text-offset"]),"text-allow-overlap":new Dt(Ke.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Dt(Ke.layout_symbol["text-ignore-placement"]),"text-optional":new Dt(Ke.layout_symbol["text-optional"]),visibility:new Dt(Ke.layout_symbol.visibility)})),paint:o4||(o4=new Di({"icon-opacity":new qt(Ke.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new qt(Ke.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new qt(Ke.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new qt(Ke.paint_symbol["text-emissive-strength"]),"icon-color":new qt(Ke.paint_symbol["icon-color"]),"icon-halo-color":new qt(Ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(Ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(Ke.paint_symbol["icon-halo-blur"]),"icon-translate":new Dt(Ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new Dt(Ke.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Dt(Ke.paint_symbol["icon-image-cross-fade"]),"text-opacity":new qt(Ke.paint_symbol["text-opacity"]),"text-occlusion-opacity":new qt(Ke.paint_symbol["text-occlusion-opacity"]),"text-color":new qt(Ke.paint_symbol["text-color"],{runtimeType:Ea,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new qt(Ke.paint_symbol["text-halo-color"]),"text-halo-width":new qt(Ke.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(Ke.paint_symbol["text-halo-blur"]),"text-translate":new Dt(Ke.paint_symbol["text-translate"]),"text-translate-anchor":new Dt(Ke.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Dt(Ke.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Dt(Ke.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Dt(Ke.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Dt(Ke.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new qt(Ke.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},MM);class ET extends ma{constructor(o,l,d,p){super(o,OM(),l,d,p),this._colorAdjustmentMatrix=L([]),this.hasInitialOcclusionOpacityProperties=o.paint!==void 0&&("icon-occlusion-opacity"in o.paint||"text-occlusion-opacity"in o.paint)}recalculate(o,l){super.recalculate(o,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const p=[];for(const y of d)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(o,l,d,p){return this._saturation===o&&this._contrast===l&&this._brightnessMin===d&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(y,_,S,P){y=Qo(y),_=Jo(_);const I=B(),k=y/3,D=1-2*k,N=[D,k,k,0,k,D,k,0,k,k,D,0,0,0,0,1],W=.5-.5*_,q=P-S;return V(I,[q,0,0,0,0,q,0,0,0,0,q,0,S,S,S,1],[_,0,0,0,0,_,0,0,0,0,_,0,W,W,W,1]),V(I,I,N),I}(o,l,d,p),this._saturation=o,this._contrast=l,this._brightnessMin=d,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(o,l,d,p){const y=this.layout.get(o).evaluate(l,{},d,p),_=this._unevaluatedLayout._values[o];return _.isDataDriven()||Bg(_.value)||!y?y:function(S,P){return P.replace(/{([^{}]+)}/g,(I,k)=>k in S?String(S[k]):"")}(l.properties,y)}createBucket(o){return new TT(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of OM().paint.overridableProperties){if(!ET.hasPaintOverride(this.layout,o))continue;const l=this.paint.get(o),d=new a4(l),p=new P0(d,l.property.specification,this.scope,this.options);let y=null;y=l.value.kind==="constant"||l.value.kind==="source"?new Xu("source",p):new md("composite",p,l.value.zoomStops,l.value.interpolationType),this.paint._values[o]=new _d(l.property,y,l.parameters)}}_handleOverridablePaintPropertyUpdate(o,l,d){return!(!this.layout||l.isDataDriven()||d.isDataDriven())&&ET.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,l){const d=o.get("text-field"),p=OM().paint.properties[l];let y=!1;const _=S=>{for(const P of S)if(p.overrides&&p.overrides.hasOverride(P))return void(y=!0)};if(d.value.kind==="constant"&&d.value.value instanceof ha)_(d.value.value.sections);else if(d.value.kind==="source"){const S=I=>{y||(I instanceof Zn&&mo(I.value)===lp?_(I.value.sections):I instanceof ju?_(I.sections):I.eachChild(S))},P=d.value;P._styleExpression&&S(P._styleExpression.expression)}return y}getProgramIds(){return["symbol"]}getDefaultProgramParams(o,l,d){return{config:new ou(this,{zoom:l,lut:d}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let s4,l4,c4,u4;var kM=vr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function RM(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function DM(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class LM{constructor(o,l,d,p){this.context=o,this.format=d,this.useMipmap=p&&p.useMipmap,this.texture=o.gl.createTexture(),this.update(l,{premultiply:p&&p.premultiply})}update(o,l){const d=o&&o instanceof HTMLVideoElement&&o.width===0?o.videoWidth:o.width,p=o&&o instanceof HTMLVideoElement&&o.height===0?o.videoHeight:o.height,{context:y}=this,{gl:_}=y,{x:S,y:P}=l&&l.position?l.position:{x:0,y:0},I=S+d,k=P+p;!this.size||this.size[0]===I&&this.size[1]===k||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!l||l.premultiply!==!1));const D=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||ImageBitmap&&o instanceof ImageBitmap;if(!this.size&&I>0&&k>0){const N=this.useMipmap?Math.floor(Math.log2(Math.max(I,k)))+1:1;_.texStorage2D(_.TEXTURE_2D,N,this.format,I,k),this.size=[I,k]}if(this.size)if(D)_.texSubImage2D(_.TEXTURE_2D,0,S,P,RM(this.format),DM(this.format),o);else{const N=o.data;N&&_.texSubImage2D(_.TEXTURE_2D,0,S,P,d,p,RM(this.format),DM(this.format),N)}this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(o,l,d=!1){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),o!==this.minFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,o),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap&&!d?o===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),l!==this.wrapS&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(o,l,d,p){const{context:y}=this,{gl:_}=y;_.bindTexture(_.TEXTURE_2D,this.texture),l!==this.magFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,l),this.magFilter=l),o!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?o===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),d!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,d),this.wrapS=d),p!==this.wrapT&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,p),this.wrapT=p)}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class AT{constructor(o,l){this.context=o,this.texture=l}bind(o,l){const{context:d}=this,{gl:p}=d;p.bindTexture(p.TEXTURE_2D,this.texture),o!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,o),this.minFilter=o),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrapS=l)}}function PT(u,o,l,d,p,y,_,S){const P=[u,o,1,l,d,1,p,y,1],I=[_,S,1],k=M([],P),[D,N,W]=gn(I,I,k);return R(P,P,[D,0,0,0,N,0,0,0,W])}function h4(u,o,l,d,p,y,_,S){const P=function(I,k,D,N,W,q,J,ie){const ae=PT(0,0,1,0,1,1,0,1),me=PT(I,k,D,N,W,q,J,ie);return R(me,me,M([],ae))}(u,o,l,d,p,y,_,S);return[P[2]/P[8]/jt,P[5]/P[8]/jt]}function CT(u){return[u[0],Math.min(Math.max(u[1],-qe),qe)]}class d4 extends Nu{constructor(o,l,d,p){super(),this.id=o,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=l,this._dirty=!1}load(o,l){if(this._loaded=l||!1,this.fire(new Vc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return o&&(this.coordinates=o),this._loaded=!0,void this._finishLoading();this._imageRequest=Jh(this.map._requestManager.transformRequest(this.url,sg.Image),(d,p)=>{this._imageRequest=null,this._loaded=!0,d?this.fire(new Yv(d)):p&&(this.image=p instanceof HTMLImageElement?Xs.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}setTexture(o){if(!(o.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new AT(this.map.painter.context,o.handle),this.width=o.dimensions[0],this.height=o.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Vc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(o){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof AT||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(o){if(this.coordinates=o,this._boundsArray=void 0,this._unsupportedCoords=!1,!o.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=o[0][1],d=o[0][1];for(const y of o)y[1]>d&&(d=y[1]),y[1]<l&&(l=y[1]);const p=(d+l)/2;if(p>qe?this.onNorthPole=!0:p<-qe&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const y=o.map(et.fromLngLat);this.tileID=function(_){let S=1/0,P=1/0,I=-1/0,k=-1/0;for(const J of _)S=Math.min(S,J.x),P=Math.min(P,J.y),I=Math.max(I,J.x),k=Math.max(k,J.y);const D=Math.max(I-S,k-P),N=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),W=Math.pow(2,N);let q=Math.floor((S+I)/2*W);return q>1&&(q-=1),new ri(N,q,Math.floor((P+k)/2*W))}(y),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Vc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(o){for(const ae in this.tiles){const me=this.tiles[ae];me.state!=="loaded"&&(me.state="loaded",me.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const l=yx(new ri(0,0,0),this.map.transform.projection),d=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ae){const me=ae[1].x-ae[0].x,de=ae[1].y-ae[0].y,Q=ae[2].x-ae[1].x,ue=ae[2].y-ae[1].y,pe=ae[3].x-ae[2].x,ve=ae[3].y-ae[2].y,Ie=ae[0].x-ae[3].x,De=ae[0].y-ae[3].y,Fe=me*ue-Q*de,He=Q*ve-pe*ue,ct=pe*De-Ie*ve,St=Ie*de-me*De;return Fe>0&&He>0&&ct>0&&St>0||Fe<0&&He<0&&ct<0&&St<0}(d))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const p=yx(this.tileID,this.map.transform.projection),[y,_,S,P]=this.coordinates.map(ae=>{const me=p.projection.project(ae[0],ae[1]);return Jj(p,me)._round()});this.perspectiveTransform=h4(y.x,y.y,_.x,_.y,S.x,S.y,P.x,P.y);const I=this._boundsArray=new th;I.emplaceBack(y.x,y.y,0,0),I.emplaceBack(_.x,_.y,jt,0),I.emplaceBack(P.x,P.y,0,jt),I.emplaceBack(S.x,S.y,jt,jt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=o.createVertexBuffer(I,kM.members),this.boundsSegments=Ti.simpleSegment(0,0,4,2);const k=[],D=[CT((N=this.coordinates)[0]),CT(N[1]),CT(N[2]),CT(N[3])];var N;const[W,q,J,ie]=function(ae){let me=ae[0][0],de=me,Q=ae[0][1],ue=Q;for(let pe=1;pe<ae.length;pe++)ae[pe][0]<me?me=ae[pe][0]:ae[pe][0]>de&&(de=ae[pe][0]),ae[pe][1]<Q?Q=ae[pe][1]:ae[pe][1]>ue&&(ue=ae[pe][1]);return[me,Q,de-me,ue-Q]}(D);{const ae=new th,[me,de,Q,ue]=function(st){let xt=st[0].x,nt=xt,lt=st[0].y,It=lt;for(let Mt=1;Mt<st.length;Mt++)st[Mt].x<xt?xt=st[Mt].x:st[Mt].x>nt&&(nt=st[Mt].x),st[Mt].y<lt?lt=st[Mt].y:st[Mt].y>It&&(It=st[Mt].y);return[xt,lt,nt-xt,It-lt]}(d),pe=st=>[(st.x-me)/Q,(st.y-de)/ue],[ve,Ie,De,Fe]=d.map(pe),He=function(st,xt,nt,lt,It,Mt,on,Kt){const $t=PT(0,0,1,0,1,1,0,1);return R($t,$t,M([],PT(st,xt,nt,lt,It,Mt,on,Kt)))}(ve[0],ve[1],Ie[0],Ie[1],De[0],De[1],Fe[0],Fe[1]);this.elevatedGlobePerspectiveTransform=h4(ve[0],ve[1],Ie[0],Ie[1],De[0],De[1],Fe[0],Fe[1]);const ct=(st,xt)=>{k.push(st.lng);const nt=Math.round((st.lng-W)/J*jt),lt=Math.round((st.lat-q)/ie*jt),It=pe(xt),Mt=gn([],[It[0],It[1],1],He),on=Math.round(Mt[0]/Mt[2]*jt),Kt=Math.round(Mt[1]/Mt[2]*jt);ae.emplaceBack(nt,lt,on,Kt)},St=d[3].x-d[0].x,_t=d[3].y-d[0].y,bt=d[2].x-d[1].x,Pt=d[2].y-d[1].y;for(let st=0;st<65;st++){const xt=st/64,nt=[d[0].x+xt*St,d[0].y+xt*_t],lt=[d[1].x+xt*bt,d[1].y+xt*Pt],It=lt[0]-nt[0],Mt=lt[1]-nt[1];for(let on=0;on<65;on++){const Kt=on/64,$t={x:nt[0]+It*Kt,y:nt[1]+Mt*Kt,z:0};ct(l.projection.unproject($t.x,$t.y),$t)}}this.elevatedGlobeVertexBuffer=o.createVertexBuffer(ae,kM.members)}{this.maxLongitudeTriangleSize=0;let ae=[],me=new bo;const de=(Q,ue,pe)=>{me.emplaceBack(Q,ue,pe);const ve=k[Q],Ie=k[ue],De=k[pe],Fe=Math.min(Math.min(ve,Ie),De),He=Math.max(Math.max(ve,Ie),De)-Fe;He>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=He),ae.push(Fe+He/2)};for(let Q=0;Q<64;Q++)for(let ue=0;ue<64;ue++){const pe=65*Q+ue,ve=pe+1,Ie=pe+65,De=Ie+1;de(pe,Ie,ve),de(ve,Ie,De)}[ae,me]=function(Q,ue){const pe=Array.from({length:Q.length},(De,Fe)=>Fe);pe.sort((De,Fe)=>Q[De]-Q[Fe]);const ve=[],Ie=new bo;for(let De=0;De<pe.length;De++){const Fe=pe[De];ve.push(Q[Fe]);const He=3*Fe,ct=He+1;Ie.emplaceBack(ue.uint16[He],ue.uint16[ct],ue.uint16[ct+1])}return[ve,Ie]}(ae,me),this.elevatedGlobeTrianglesCenterLongitudes=ae,this.elevatedGlobeIndexBuffer=o.createIndexBuffer(me)}this.elevatedGlobeSegments=Ti.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,J/jt,0,ie/jt,0,0,q,W,0])}prepare(){const o=Object.keys(this.tiles).length!==0;if(this.tileID&&!o)return;const l=this.map.painter.context,d=l.gl;!this._dirty||this.texture instanceof AT||(this.texture?this.texture.update(this.image):(this.texture=new LM(l,this.image,d.RGBA8),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._dirty=!1),o&&this._prepareData(l)}loadTile(o,l){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},l(null)):(o.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(o){const l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;const d=this.elevatedGlobeTrianglesCenterLongitudes;let p=(y=o+180)+360*Math.round((d[0]-y)/360);var y;const _=new Ti,S=(D,N)=>{_.segments.push({vertexOffset:0,primitiveOffset:D,vertexLength:l.segments[0].vertexLength,primitiveLength:N,sortKey:void 0,vaos:{}})},P=.51*this.maxLongitudeTriangleSize;if(Math.abs(d[0]-p)<=P){const D=Jl(d,0,d.length,p+P);return D===d.length||S(D,zo(d,D+1,d.length,p+360-P)-D),_}p<d[0]&&(p+=360);const I=zo(d,0,d.length,p-P);if(I===d.length)return S(0,d.length),_;S(0,I-0);const k=Jl(d,I+1,d.length,p+P);return k!==d.length&&S(k,d.length-k),_}}const die=(Math.pow(256,2)-1)/16907520;class f4 extends ma{constructor(o,l,d,p){super(o,{layout:c4||(c4=new Di({visibility:new Dt(Ke.layout_raster.visibility)})),paint:u4||(u4=new Di({"raster-opacity":new Dt(Ke.paint_raster["raster-opacity"]),"raster-color":new Qu(Ke.paint_raster["raster-color"]),"raster-color-mix":new Dt(Ke.paint_raster["raster-color-mix"]),"raster-color-range":new Dt(Ke.paint_raster["raster-color-range"]),"raster-hue-rotate":new Dt(Ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Dt(Ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Dt(Ke.paint_raster["raster-brightness-max"]),"raster-saturation":new Dt(Ke.paint_raster["raster-saturation"]),"raster-contrast":new Dt(Ke.paint_raster["raster-contrast"]),"raster-resampling":new Dt(Ke.paint_raster["raster-resampling"]),"raster-fade-duration":new Dt(Ke.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Dt(Ke.paint_raster["raster-emissive-strength"]),"raster-array-band":new Dt(Ke.paint_raster["raster-array-band"]),"raster-elevation":new Dt(Ke.paint_raster["raster-elevation"]),"raster-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},l,d,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(o){return!(o&&o._source instanceof d4&&(o._source.onNorthPole||o._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(o){o!=="raster-color"&&o!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(o){if(!this.hasColorMap()||!this._curRampRange)return;const l=this._transitionablePaint._values["raster-color"].value.expression,[d,p]=o||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(d)&&isNaN(p)||d===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=ex({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:d,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[d,p])}}let p4,m4,g4,y4,_4;class v4 extends ma{constructor(o,l,d,p){super(o,{layout:p4||(p4=new Di({visibility:new Dt(Ke["layout_raster-particle"].visibility)})),paint:m4||(m4=new Di({"raster-particle-array-band":new Dt(Ke["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Dt(Ke["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Qu(Ke["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Dt(Ke["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Dt(Ke["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Dt(Ke["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Dt(Ke["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Dt(Ke["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},l,d,p),this._updateColorRamp(),this.lastInvalidatedAt=Xs.now()}onRemove(o){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(o){return!1}_handleSpecialPaintPropertyUpdate(o){o!=="raster-particle-color"&&o!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),o==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=ex({expression:o,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Xs.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class fie extends ma{constructor(o,l){super(o,{},l,null),this.implementation=o,o.slot&&(this.slot=o.slot)}is3D(o){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(o){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}function zM(u,o,l){const d=[0,0,1],p=pn([]);return sn(p,p,l?-ne(u)+Math.PI:ne(u)),dn(p,p,-ne(o)),xn(d,d,p),fn(d,d)}function x4(u,o){const l=IT(u.projection,u.zoom,u.width,u.height),d=function(y,_,S,P,I){const k=new re(S.lng-180*zd,S.lat),D=new re(S.lng+180*zd,S.lat),N=y.project(k.lng,k.lat),W=y.project(D.lng,D.lat),q=-Math.atan2(W.y-N.y,W.x-N.x),J=et.fromLngLat(S);J.y=Ue(J.y,-1+zd,1-zd);const ie=J.toLngLat(),ae=y.project(ie.lng,ie.lat),me=et.fromLngLat(ie);me.x+=zd;const de=me.toLngLat(),Q=y.project(de.lng,de.lat),ue=w4(Q.x-ae.x,Q.y-ae.y,q),pe=et.fromLngLat(ie);pe.y+=zd;const ve=pe.toLngLat(),Ie=y.project(ve.lng,ve.lat),De=w4(Ie.x-ae.x,Ie.y-ae.y,q),Fe=Math.abs(ue.x)/Math.abs(De.y),He=L([]);se(He,He,-q*(1-(I?0:P)));const ct=L([]);return H(ct,ct,[1,1-(1-Fe)*P,1]),ct[4]=-De.x/De.y*P,se(ct,ct,q),V(ct,He,ct),ct}(u.projection,0,u.center,l,o),p=b4(u);return H(d,d,[p,p,1]),d}function b4(u){const o=u.projection,l=IT(u.projection,u.zoom,u.width,u.height),d=NM(o,u.center),p=NM(o,re.convert(o.center));return Math.pow(2,d*l+(1-l)*p)}function IT(u,o,l,d,p=1/0){const y=u.range;if(!y)return 0;const _=Math.min(p,Math.max(l,d)),S=Math.log(_/1024)/Math.LN2;return Ve(y[0]+S,y[1]+S,o)}const zd=1/4e4;function NM(u,o){const l=Ue(o.lat,-qe,qe),d=new re(o.lng-180*zd,l),p=new re(o.lng+180*zd,l),y=u.project(d.lng,l),_=u.project(p.lng,l),S=et.fromLngLat(d),P=et.fromLngLat(p),I=_.x-y.x,k=_.y-y.y,D=P.x-S.x,N=P.y-S.y,W=Math.sqrt((D*D+N*N)/(I*I+k*k));return Math.log(W)/Math.LN2}function w4(u,o,l){const d=Math.cos(l),p=Math.sin(l);return{x:u*d-o*p,y:u*p+o*d}}function S4(u,o,l){L(u),se(u,u,ne(o[2])),K(u,u,ne(o[0])),Y(u,u,ne(o[1])),H(u,u,l),V(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function MT(u,o,l,d,p,y,_,S){const P=[l[0]-o[0],l[1]-o[1],0],I=[d[0]-o[0],d[1]-o[1],0];if($e(P)<1e-12||$e(I)<1e-12)return pn(u);const k=Vt([],P,I);fn(k,k),ot(I,d,o),P[2]=(y-p)*S,I[2]=(_-p)*S;const D=P;return Vt(D,P,I),fn(D,D),Uo(u,k,D)}function FM(u,o,l=!1){const d=Id(o.zoom),p=function(y,_,S){const P=_.worldSize,I=[y[12],y[13],y[14]],k=ke(I[1]/P),D=Me(I[0]/P),N=L([]),W=we(1,k)*P,q=we(1,0)*P*dt(k,_.zoom),J=1/HI(P);let ie=q*J;if(S){const Q=IT(_.projection,_.zoom,_.width,_.height,1024);ie=J*_.projection.pixelSpaceConversion(_.center.lat,P,Q)}const ae=te(k,D);ht(ae,ae,pt([],fn([],ae),W*ie*I[2]));const me=function(Q){const ue=[Q[0],Q[1],Q[2]];let pe=[0,1,0];const ve=Vt([],pe,ue);return Vt(pe,ue,ve),un(pe)===0&&(pe=[0,1,0],Vt(ve,ue,pe)),fn(ve,ve),fn(pe,pe),fn(ue,ue),[ve[0],ve[1],ve[2],0,pe[0],pe[1],pe[2],0,ue[0],ue[1],ue[2],0,Q[0],Q[1],Q[2],1]}(ae);H(N,N,[ie,ie,ie*W]),$(N,N,[-I[0],-I[1],-I[2]]);const de=V([],_.globeMatrix,me);return V(de,de,N),V(de,de,y),de}(u,o,l);if(d>0){const y=function(_,S){const P=S.worldSize,I=we(1,0)*P*dt(S.center.lat,S.zoom)/HI(P),k=we(1,S.center.lat)*P,D=L([]);return Y(D,D,ne(S.center.lng)),K(D,D,ne(S.center.lat)),$(D,D,[0,0,w]),H(D,D,[I,I,I*k]),$(D,D,[S.point.x-.5*P,S.point.y-.5*P,0]),V(D,D,_),V(D,S.globeMatrix,D)}(u,o);return function(_,S,P){const I=(q,J,ie)=>{const ae=$e(q),me=$e(J),de=ah(q,J,ie);return pt(de,de,1/$e(de)*yn(ae,me,ie))},k=I([_[0],_[1],_[2]],[S[0],S[1],S[2]],P),D=I([_[4],_[5],_[6]],[S[4],S[5],S[6]],P),N=I([_[8],_[9],_[10]],[S[8],S[9],S[10]],P),W=ah([_[12],_[13],_[14]],[S[12],S[13],S[14]],P);return[k[0],k[1],k[2],0,D[0],D[1],D[2],0,N[0],N[1],N[2],0,W[0],W[1],W[2],1]}(p,y,d)}return p}function T4(u,o,l,d){const p=mi.projectAabbCorners(d,l);let y=Number.MAX_VALUE,_=-1;for(let I=0;I<p.length;++I){const k=p[I];k[0]=(.5*k[0]+.5)*o.width,k[1]=(.5-.5*k[1])*o.height,k[2]<y&&(_=I,y=k[2])}const S=I=>new yt(p[I][0],p[I][1]);let P;switch(_){case 0:case 6:P=[S(1),S(5),S(4),S(7),S(3),S(2),S(1)];break;case 1:case 7:P=[S(0),S(4),S(5),S(6),S(2),S(3),S(0)];break;case 3:case 5:P=[S(1),S(0),S(4),S(7),S(6),S(2),S(1)];break;default:P=[S(1),S(5),S(6),S(7),S(3),S(0),S(1)]}if(Sn(u,P))return y}const pie=vr([{name:"a_pos_3f",components:3,type:"Float32"}]),mie=vr([{name:"a_color_3f",components:3,type:"Float32"}]),gie=vr([{name:"a_color_4f",components:4,type:"Float32"}]),yie=vr([{name:"a_uv_2f",components:2,type:"Float32"}]),_ie=vr([{name:"a_normal_3f",components:3,type:"Float32"}]),vie=vr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),xie=vr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),E4={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class OT{constructor(o,l,d,p){this.message=(o?`${o}: `:"")+d,p&&(this.identifier=p),l!=null&&l.__line__&&(this.line=l.__line__)}}function BM(u,o){const l=u.indexOf("://")===-1;try{return new URL(u,l&&o?"http://example.com":void 0),!0}catch{return!1}}class A4{constructor(o,l){this.feature=o,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class P4{constructor(){this.instancedDataArray=new Sd,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class jM{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=o.projection,this.index=o.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=o.styleDefinedModelURLs}updateFootprints(o,l){}populate(o,l,d,p){this.tileToMeter=Ze(d);const y=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:S,index:P,sourceLayerIndex:I}of o){const k=S??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),D=an(_,y);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),D,d))continue;const N={id:k,sourceLayerIndex:I,index:P,geometry:y?D.geometry:Yt(_,d,p),properties:_.properties,type:_.type,patterns:{}},W=this.addFeature(N,N.geometry,D);W&&l.featureIndex.insert(_,N.geometry,P,I,this.index,this.instancesPerModel[W].instancedDataArray.length,jt/32)}this.lookup=null}update(o,l,d,p){for(const y in this.instancesPerModel){const _=this.instancesPerModel[y];for(const S in o)_.idToFeaturesIndex.hasOwnProperty(S)&&(this.evaluate(_.features[_.idToFeaturesIndex[S]],o[S],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let o=!1;for(const l in this.instancesPerModel){const d=this.instancesPerModel[l];for(const p of d.features){const y=this.layers[0],_=p.feature,S=this.canonical,P=y.paint.get("model-rotation").evaluate(_,{},S),I=y.paint.get("model-scale").evaluate(_,{},S),k=y.paint.get("model-translation").evaluate(_,{},S);kt(p.rotation,P)&&kt(p.scale,I)&&kt(p.translation,k)||(this.evaluate(p,p.featureStates,d,!0),o=!0)}}return o}updateReplacement(o,l,d,p){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const y=l.getReplacementRegionsForTile(o.toUnwrapped(),!0);if(cM(this.activeReplacements,y))return!1;this.activeReplacements=y;let _=!1;for(const S in this.instancesPerModel){const P=this.instancesPerModel[S],I=P.instancedDataArray;for(const k of P.features){const D=k.instancedDataOffset,N=k.instancedDataCount;for(let W=0;W<N;W++){const q=16*(W+D);let J=I.float32[q+0];const ie=J>jt;J=ie?J-jt:J;const ae=Math.floor(J),me=I.float32[q+1];let de=!1;for(const Q of this.activeReplacements)if(!OB(Q,d,E4.Model,p)&&!(Q.min.x>ae||ae>Q.max.x||Q.min.y>me||me>Q.max.y)&&(de=NB(zB(ae,me,o.canonical,Q.footprintTileId.canonical),Q.footprint),de))break;I.float32[q]=de?J+jt:J,_=_||de!==ie}}}return _}isEmpty(){for(const o in this.instancesPerModel)if(this.instancesPerModel[o].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(o){if(!this.uploaded)for(const l in this.instancesPerModel){const d=this.instancesPerModel[l];d.instancedDataArray.length<0||d.instancedDataArray.length===0||(d.instancedDataBuffer?d.instancedDataBuffer.updateData(d.instancedDataArray):d.instancedDataBuffer=o.createVertexBuffer(d.instancedDataArray,vie.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const l in this.instancesPerModel){const d=this.instancesPerModel[l];d.instancedDataArray.length!==0&&d.instancedDataBuffer&&d.instancedDataBuffer.destroy()}const o=this.layers[0].modelManager;if(o&&this.modelUris&&this.modelsRequested)for(const l of this.modelUris)o.removeModel(l,"",!0)}addFeature(o,l,d){const p=this.layers[0],y=p.layout.get("model-id").evaluate(d,{},this.canonical);if(!y)return nr(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),y;(BM(y,!1)||this.styleDefinedModelURLs[y]!==void 0)&&(this.modelUris.includes(y)||this.modelUris.push(y)),this.instancesPerModel[y]||(this.instancesPerModel[y]=new P4);const _=this.instancesPerModel[y],S=_.instancedDataArray,P=new A4(d,S.length);for(const I of l)for(const k of I){if(k.x<0||k.x>=jt||k.y<0||k.y>=jt)continue;const D=(this.lookupDim-1)/jt,N=this.lookupDim*(k.y*D|0)+k.x*D|0;if(this.lookup){if(this.lookup[N]!==0)continue;this.lookup[N]=1}this.instanceCount++;const W=S.length;S.resize(W+1),_.instancesEvaluatedElevation.push(0),S.float32[16*W]=k.x,S.float32[16*W+1]=k.y}return P.instancedDataCount=_.instancedDataArray.length-P.instancedDataOffset,P.instancedDataCount>0&&(o.id&&(_.idToFeaturesIndex[o.id]=_.features.length),_.features.push(P),this.evaluate(P,{},_,!1)),y}getModelUris(){return this.modelUris}evaluate(o,l,d,p){const y=this.layers[0],_=o.feature,S=this.canonical,P=o.rotation=y.paint.get("model-rotation").evaluate(_,l,S),I=o.scale=y.paint.get("model-scale").evaluate(_,l,S),k=o.translation=y.paint.get("model-translation").evaluate(_,l,S),D=y.paint.get("model-color").evaluate(_,l,S);D.a=y.paint.get("model-color-mix-intensity").evaluate(_,l,S);const N=[];this.maxVerticalOffset<k[2]&&(this.maxVerticalOffset=k[2]),this.maxScale=Math.max(Math.max(this.maxScale,I[0]),Math.max(I[1],I[2])),S4(N,P,I);const W=Math.round(100*D.a)+D.b/1.05;for(let q=0;q<o.instancedDataCount;++q){const J=o.instancedDataOffset+q,ie=16*J,ae=d.instancedDataArray.float32;let me=0;p&&(me=ae[ie+6]-d.instancesEvaluatedElevation[J]);const de=0|ae[ie+1];ae[ie]=(0|ae[ie])+D.r/1.05,ae[ie+1]=de+D.g/1.05,ae[ie+2]=W,ae[ie+3]=1/(S.z>10?this.tileToMeter:Ze(S,de)),ae[ie+4]=k[0],ae[ie+5]=k[1],ae[ie+6]=k[2]+me,ae[ie+7]=N[0],ae[ie+8]=N[1],ae[ie+9]=N[2],ae[ie+10]=N[4],ae[ie+11]=N[5],ae[ie+12]=N[6],ae[ie+13]=N[8],ae[ie+14]=N[9],ae[ie+15]=N[10],d.instancesEvaluatedElevation[J]=k[2]}}}let C4,I4;Zt(jM,"ModelBucket",{omit:["layers"]}),Zt(P4,"PerModelAttributes"),Zt(A4,"ModelFeature");const Hp=64,dy={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function M4(u,o,l,d,p,y,_,S,P,I=!1){const k=l.zoom,D=l.project(d),N=dt(d.lat,k),W=1/N;L(u),$(u,u,[D.x+_[0]*W,D.y+_[1]*W,_[2]]);let q=1,J=1;const ie=l.worldSize;if(I){if(l.projection.name==="mercator"){let Q=0;l.elevation&&(Q=l.elevation.getAtPointOrZero(new et(D.x/ie,D.y/ie),0));const ue=wt([],[D.x,D.y,Q,1],l.projMatrix)[3]/l.cameraToCenterDistance;q=ue,J=ue*dt(l.center.lat,k)}else if(l.projection.name==="globe"){const Q=FM(u,l),ue=[0,0,0,1];wt(ue,ue,V([],l.projMatrix,Q));const pe=ue[3]/l.cameraToCenterDistance,ve=Id(k),Ie=l.projection.pixelsPerMeter(d.lat,ie)*dt(d.lat,k),De=l.projection.pixelsPerMeter(l.center.lat,ie)*dt(l.center.lat,k);q=pe/yn(Ie,mt(l.center.lat),ve),J=pe*N/Ie,q*=De,J*=De}}else q=W;H(u,u,[q,q,J]);const ae=[...u],me=o.orientation,de=[];if(S4(de,[me[0]+p[0],me[1]+p[1],me[2]+p[2]],y),V(u,ae,de),S&&l.elevation){let Q=0;const ue=[];if(P&&l.elevation){Q=function(ve,Ie,De,Fe,He){const ct=Ie.elevation;if(!ct)return 0;const St=mi.projectAabbCorners(De,Fe),_t=we(1,He.lat)*Ie.worldSize,bt=function(Ct,kn){const en=[0,0,1],tn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Pn of tn){const Bn=Ct[Pn.corners[0]],$n=Ct[Pn.corners[1]],Jn=Ct[Pn.corners[2]],Hn=[$n[0]-Bn[0],$n[1]-Bn[1],kn*($n[2]-Bn[2])],Gn=Vt(Hn,Hn,[Jn[0]-Bn[0],Jn[1]-Bn[1],kn*(Jn[2]-Bn[2])]);fn(Gn,Gn),Pn.dotProductWithUp=Cn(Gn,en)}return tn.sort((Pn,Bn)=>Pn.dotProductWithUp-Bn.dotProductWithUp),tn[0].corners}(St,_t),Pt=St[bt[0]],st=St[bt[1]],xt=St[bt[2]],nt=St[bt[3]],lt=ct.getAtPointOrZero(new et(Pt[0]/Ie.worldSize,Pt[1]/Ie.worldSize),0),It=ct.getAtPointOrZero(new et(st[0]/Ie.worldSize,st[1]/Ie.worldSize),0),Mt=ct.getAtPointOrZero(new et(xt[0]/Ie.worldSize,xt[1]/Ie.worldSize),0),on=ct.getAtPointOrZero(new et(nt[0]/Ie.worldSize,nt[1]/Ie.worldSize),0),Kt=(lt+on)/2,$t=(It+Mt)/2;return Kt>$t?It<Mt?MT(ve,st,nt,Pt,It,on,lt,_t):MT(ve,xt,Pt,nt,Mt,lt,on,_t):lt<on?MT(ve,Pt,st,xt,lt,It,Mt,_t):MT(ve,nt,xt,st,on,Mt,It,_t),Math.max(Kt,$t)}(ue,l,o.aabb,u,d);const pe=V([],ze([],ue),de);V(u,ae,pe)}else Q=l.elevation.getAtPointOrZero(new et(D.x/ie,D.y/ie),0);Q!==0&&(u[14]+=Q)}}function wx(u,o,l=!1){u.uploaded||(u.gfxTexture=new LM(o,u.image,l?o.gl.R8:o.gl.RGBA8,{useMipmap:u.sampler.minFilter>=o.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function bie(u,o,l){u.indexBuffer=o.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=o.createVertexBuffer(u.vertexArray,pie.members,!1,!0),u.normalArray&&(u.normalBuffer=o.createVertexBuffer(u.normalArray,_ie.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=o.createVertexBuffer(u.texcoordArray,yie.members,!1,!0)),u.colorArray&&(u.colorBuffer=o.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?mie:gie).members,!1,!0)),u.featureArray&&(u.pbrBuffer=o.createVertexBuffer(u.featureArray,xie.members,!0)),u.segments=Ti.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const d=u.material;d.pbrMetallicRoughness.baseColorTexture&&wx(d.pbrMetallicRoughness.baseColorTexture,o),d.pbrMetallicRoughness.metallicRoughnessTexture&&wx(d.pbrMetallicRoughness.metallicRoughnessTexture,o),d.normalTexture&&wx(d.normalTexture,o),d.occlusionTexture&&wx(d.occlusionTexture,o,l),d.emissionTexture&&wx(d.emissionTexture,o)}function $M(u,o,l){if(u.meshes)for(const d of u.meshes)bie(d,o,l);if(u.children)for(const d of u.children)$M(d,o,l)}function kT(u){if(u.meshes)for(const o of u.meshes)o.indexArray.destroy(),o.vertexArray.destroy(),o.colorArray&&o.colorArray.destroy(),o.normalArray&&o.normalArray.destroy(),o.texcoordArray&&o.texcoordArray.destroy(),o.featureArray&&o.featureArray.destroy();if(u.children)for(const o of u.children)kT(o)}function UM(u){if(u.meshes)for(const l of u.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((o=l.material).pbrMetallicRoughness.baseColorTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),o.pbrMetallicRoughness.metallicRoughnessTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),o.normalTexture&&o.normalTexture.gfxTexture&&o.normalTexture.gfxTexture.destroy(),o.emissionTexture&&o.emissionTexture.gfxTexture&&o.emissionTexture.gfxTexture.destroy(),o.occlusionTexture&&o.occlusionTexture.gfxTexture&&o.occlusionTexture.gfxTexture.destroy()));var o;if(u.children)for(const l of u.children)UM(l)}class fy{constructor(o,l,d){this._demTile=o,this._dem=this._demTile.dem,this._scale=l,this._offset=d}static create(o,l,d){const p=d||o.findDEMTileFor(l);if(!p||!p.dem)return;const y=p.dem,_=p.tileID,S=1<<l.canonical.z-_.canonical.z;return new fy(p,y.dim/jt/S,[(l.canonical.x/S-_.canonical.x)*y.dim,(l.canonical.y/S-_.canonical.y)*y.dim])}tileCoordToPixel(o,l){const d=l*this._scale+this._offset[1],p=Math.floor(o*this._scale+this._offset[0]),y=Math.floor(d);return new yt(p,y)}getElevationAt(o,l,d,p){const y=o*this._scale+this._offset[0],_=l*this._scale+this._offset[1],S=Math.floor(y),P=Math.floor(_),I=this._dem;return p=!!p,d?yn(yn(I.get(S,P,p),I.get(S,P+1,p),_-P),yn(I.get(S+1,P,p),I.get(S+1,P+1,p),_-P),y-S):I.get(S,P,p)}getElevationAtPixel(o,l,d){return this._dem.get(o,l,!!d)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*we(1,o)*this._dem.stride}}const VM=new Float32Array(262144),qp=new Uint8Array(262144);function O4(u){let o=0;if(u.meshes)for(const l of u.meshes)o=Math.max(o,l.aabb.max[2]);if(u.children)for(const l of u.children)o=Math.max(o,O4(l));return o}function k4(u,o,l){if(u.meshes)for(const d of u.meshes){if(d.aabb.min[0]===1/0)continue;const p=mi.applyTransform(d.aabb,u.matrix);l.insert(o,p.min[0],p.min[1],p.max[0],p.max[1])}if(u.children)for(const d of u.children)k4(d,o,l)}const R4=["","wall","door","roof","window","lamp","logo"];class D4{constructor(o){this.node=o,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:o.id,geometry:[],properties:{height:O4(o)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new mi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let o=0;const l=new mi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const d of this.node.meshes)this.node.lightMeshIndex!==o&&(d.transformedAabb=mi.applyTransformFast(d.aabb,this.node.matrix),l.encapsulate(d.transformedAabb)),o++;this.aabb=l}return this.aabb}}class RT{constructor(o,l,d,p,y,_,S){this.id=d,this.layers=o,this.layerIds=this.layers.map(P=>P.fqid),this.stateDependentLayerIds=this.layers.filter(P=>P.isStateDependent()).map(P=>P.id),this.modelTraits|=dy.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=dy.HasMapboxMeshFeatures),y&&(this.modelTraits|=dy.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const P of l)this.nodesInfo.push(new D4(P)),k4(P,S.featureIndexArray.length,S.grid),S.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,S.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(o,l){for(const d of this.getNodesInfo()){const p=d.node;p.footprint&&l.push({footprint:p.footprint,id:o})}}update(o){const l=Object.keys(o).length!==0;if(l&&!this.stateDependentLayers.length)return;const d=l?this.stateDependentLayers:this.layers;if(!ti(o,this.states))for(const p of d)this.evaluate(p,o);this.states=structuredClone(o)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(o){if(!this.needsUpload)return;const l=this.getNodesInfo();for(const d of l){const p=d.node;this.uploaded?this.updatePbrBuffer(p):$M(p,o,!0)}for(const d of l)kT(d.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(o){let l=!1;if(!o.meshes)return l;for(const d of o.meshes)d.pbrBuffer&&(d.pbrBuffer.updateData(d.featureArray),l=!0);return l}needsReEvaluation(o,l,d){const p=o.transform.projectionOptions,y=o.style.getBrightness(),_=this.brightness!==y;if(!this.uploaded||this.dirty||p.name!==this.projection.name||Sx(d.paint.get("model-color").value,_)||Sx(d.paint.get("model-color-mix-intensity").value,_)||Sx(d.paint.get("model-roughness").value,_)||Sx(d.paint.get("model-emissive-strength").value,_)||Sx(d.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=p,this.brightness=y;const S=this.getNodesInfo();for(const P of S)P.state=null;return!0}return!1}evaluateScale(o,l){if(o.transform.zoom===this.zoom)return;this.zoom=o.transform.zoom;const d=this.getNodesInfo(),p=this.id.canonical;for(const y of d){const _=y.feature;y.evaluatedScale=l.paint.get("model-scale").evaluate(_,{},p)}}evaluate(o,l){const d=this.getNodesInfo();for(const p of d){if(!p.node.meshes)continue;const y=p.feature,_=l&&l[y.id];if(ti(_,p.state))continue;p.state=structuredClone(_);const S=p.node.meshes&&p.node.meshes[0].featureData,P=p.evaluatedColor[2],I=p.evaluatedRMEA[2],k=this.id.canonical;if(p.hasTranslucentParts=!1,S){for(let D=0;D<R4.length;D++){const N=R4[D];N.length&&(y.properties.part=N);const W=o.paint.get("model-color").evaluate(y,_,k).toRenderColor(null),q=o.paint.get("model-color-mix-intensity").evaluate(y,_,k);p.evaluatedColor[D]=[W.r,W.g,W.b,q],p.evaluatedRMEA[D][0]=o.paint.get("model-roughness").evaluate(y,_,k),p.evaluatedRMEA[D][2]=o.paint.get("model-emissive-strength").evaluate(y,_,k),p.evaluatedRMEA[D][3]=W.a,p.emissionHeightBasedParams[D]=o.paint.get("model-height-based-emissive-strength-multiplier").evaluate(y,_,k),!p.hasTranslucentParts&&W.a<1&&(p.hasTranslucentParts=!0)}delete y.properties.part,Sie(p,P!==p.evaluatedColor[2]||I!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=o.paint.get("model-emissive-strength").evaluate(y,_,k);p.evaluatedScale=o.paint.get("model-scale").evaluate(y,_,k),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(o,l,d,p){const y=o.findDEMTileFor(d);if(y&&(y.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(y.dem&&y.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=y.tileID.overscaledZ;const _=fy.create(o,d,y);if(!_)return;this.modelTraits&dy.HasMapboxMeshFeatures&&this.updateDEM(o,_,d,p);for(const S of this.getNodesInfo()){const P=S.node;if(!P.footprint||!P.footprint.vertices||!P.footprint.vertices.length)continue;const I=P.footprint.vertices;let k=_.getElevationAt(I[0].x,I[0].y,!0,!0);for(let D=1;D<I.length;D++)k=Math.min(k,_.getElevationAt(I[D].x,I[D].y,!0,!0));P.elevation=k}}this.terrainTile=y.tileID.canonical,this.terrainExaggeration=l}}updateDEM(o,l,d,p){let y=l._dem._modifiedForSources[p];if(y===void 0&&(l._dem._modifiedForSources[p]=[],y=l._dem._modifiedForSources[p]),y.includes(d.canonical))return;const _=l._dem.dim;y.push(d.canonical);let S=!1;for(const P of this.getNodesInfo()){const I=P.node;if(!I.footprint||!I.footprint.grid)continue;const k=I.footprint.grid,D=l.tileCoordToPixel(k.min.x,k.min.y),N=l.tileCoordToPixel(k.max.x,k.max.y),W=Math.min(Math.min(_-N.y,D.x),Math.min(D.y,_-N.x));if(W<0)continue;const q=Ue(W,2,5);let J=Math.max(0,D.x-q),ie=Math.max(0,D.y-q),ae=Math.min(N.x+q,_-1),me=Math.min(N.y+q,_-1);for(let pe=ie;pe<=me;++pe)for(let ve=J;ve<=ae;++ve)qp[pe*_+ve]=255;let de=0,Q=0;for(let pe=0;pe<k.cellsY;++pe)for(let ve=0;ve<k.cellsX;++ve){if(!k.cells[pe*k.cellsX+ve])continue;const Ie=l.tileCoordToPixel(k.min.x+ve/k.xScale,k.min.y+pe/k.yScale),De=l.tileCoordToPixel(k.min.x+(ve+1)/k.xScale,k.min.y+(pe+1)/k.yScale);for(let Fe=Ie.y;Fe<=Math.min(De.y+1,_-1);++Fe)for(let He=Ie.x;He<=Math.min(De.x+1,_-1);++He)qp[Fe*_+He]===255&&(qp[Fe*_+He]=0,de+=l.getElevationAtPixel(He,Fe),Q++)}const ue=de/Q;J=Math.max(1,D.x-q),ie=Math.max(1,D.y-q),ae=Math.min(N.x+q,_-2),me=Math.min(N.y+q,_-2),S=!0;for(let pe=ie;pe<=me;++pe)for(let ve=J;ve<=ae;++ve)qp[pe*_+ve]===0&&(VM[pe*_+ve]=l._dem.set(ve,pe,ue));for(let pe=1;pe<q;++pe){J=Math.max(1,D.x-pe),ie=Math.max(1,D.y-pe),ae=Math.min(N.x+pe,_-2),me=Math.min(N.y+pe,_-2);for(let ve=ie;ve<=me;++ve)for(let Ie=J;Ie<=ae;++Ie){const De=ve*_+Ie;if(qp[De]===255){let Fe=0,He=0,ct=-1,St=-1;for(let _t=-1;_t<=1;++_t)for(let bt=-1;bt<=1;++bt){const Pt=(ve+_t)*_+Ie+bt;if(qp[Pt]>=pe)continue;const st=VM[Pt],xt=Math.abs(st);xt>He&&(Fe=st,He=xt,ct=bt,St=_t)}if(He>.1){const _t=1-(pe+.5*Math.abs(ct*St))/q;let bt=l._dem.get(Ie,ve)+Fe*_t;const Pt=l._dem.get(Ie+ct,ve+St),st=l._dem.get(Ie-ct,ve-St,!0);(bt-Pt)*(bt-st)>0&&(bt=(Pt+st)/2),VM[De]=l._dem.set(Ie,ve,bt),qp[De]=pe}}}}}S&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=Xs.now())}setFilter(o){this.filter=o?L0(o):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(o=>this.filter.filter(new zr(this.id.overscaledZ),o.feature,this.id.canonical)):this.nodesInfo}destroy(){const o=this.getNodesInfo();for(const l of o)kT(l.node),UM(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(o,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const d=l.getReplacementRegionsForTile(o.toUnwrapped()),p=this.getNodesInfo();for(let y=0;y<this.nodesInfo.length;y++){const _=p[y].node;p[y].hiddenByReplacement=!!_.footprint&&!d.find(S=>S.footprint===_.footprint)}}getHeightAtTileCoord(o,l){const d=this.getNodesInfo(),p=[],y=[0,0,0],_=L([]);for(let S=0;S<this.nodesInfo.length;S++){const P=d[S],I=P.node.meshes[0],k=I.transformedAabb;if(o<k.min[0]||l<k.min[1]||o>k.max[0]||l>k.max[1])continue;if(P.node.hidden===!0)return{height:1/0,maxHeight:P.feature.properties.height,hidden:!1,verticalScale:P.evaluatedScale[2]};j(_,P.node.matrix),y[0]=o,y[1]=l,Nt(y,y,_);const D=(y[0]-I.aabb.min[0])/(I.aabb.max[0]-I.aabb.min[0])*Hp|0,N=Math.min(63,(y[1]-I.aabb.min[1])/(I.aabb.max[1]-I.aabb.min[1])*Hp|0)*Hp+Math.min(63,D),W=I.heightmap[N];if(!(W<0&&P.node.footprint))return P.hiddenByReplacement?void 0:{height:W,maxHeight:P.feature.properties.height,hidden:!1,verticalScale:P.evaluatedScale[2]};if(P.node.footprint.grid.query(new yt(o,l),new yt(o,l),p),p.length>0)return{height:void 0,maxHeight:P.feature.properties.height,hidden:P.hiddenByReplacement,verticalScale:P.evaluatedScale[2]}}}}function Sx(u,o){return u instanceof Xu&&!u.isLightConstant&&o}function wie(u,o,l,d,p,y,_,S){let P=(61440&o|(61440&o)>>4)>>8,I=(3840&o|(3840&o)>>4)>>4,k=240&o|(240&o)>>4;l[3]>0&&(P=yn(P,255*l[0],l[3]),I=yn(I,255*l[1],l[3]),k=yn(k,255*l[2],l[3]));const D=P<<8|I,N=k<<8|Math.floor(255*d[3]),W=function(pe){const ve=Ue(pe,0,2);return Math.min(Math.round(.5*ve*255),255)}(d[2])<<8|15*d[0]<<4|15*d[1],q=Ue(p[0],0,1),J=Ue(p[1],0,1),ie=Ue(p[2],0,1),ae=Ue(p[3],0,1);let me,de,Q,ue;if(q!==J&&_!==y&&J!==q){const pe=_-y;de=1/(pe*(J-q)),Q=-(y+pe*q)/(pe*(J-q));const ve=Ue(p[4],-1,1);ue=Math.pow(10,ve),me=255*ie<<8|255*ae}else me=65535,de=0,Q=1,ue=1;if(u.emplaceBack(D,N,W,me,de,Q,ue),S){const pe=S.length;S.clear();for(let ve=0;ve<pe;ve++)S.emplaceBack(D,N,W,me,de,Q,ue)}}function Sie(u,o,l){const d=u.node;let p=0;const y=l&dy.HasMeshoptCompression;for(const _ of d.meshes){if(d.lights&&d.lightMeshIndex===p||!_.featureData)continue;_.featureArray=new Rp,_.featureArray.reserve(_.featureData.length);let S=o;for(const P of _.featureData){const I=y?65535&P:P>>16&65535,k=y?P>>16&65535:65535&P,D=(15&k)<8?15&k:0,N=u.evaluatedRMEA[D],W=u.evaluatedColor[D],q=u.emissionHeightBasedParams[D];let J;if(S&&D===2&&d.lights&&(J=new Rp,J.resize(10*d.lights.length)),wie(_.featureArray,I,W,N,q,_.aabb.min[2],_.aabb.max[2],J),J&&S){S=!1;const ie=d.meshes[d.lightMeshIndex];ie.featureArray=J,ie.featureArray._trim()}}_.featureArray._trim(),p++}}function L4(u,o,l,d){const p=1<<u.z;o.lat=ke((d/jt+u.y)/p),o.lng=Me((l/jt+u.x)/p)}Zt(RT,"Tiled3dModelBucket",{omit:["layers"]}),Zt(D4,"Tiled3dModelFeature");const Tie={circle:class extends ma{constructor(u,o,l,d){super(u,{layout:Sr||(Sr=new Di({"circle-sort-key":new qt(Ke.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Dt(Ke.layout_circle["circle-elevation-reference"]),visibility:new Dt(Ke.layout_circle.visibility)})),paint:vi||(vi=new Di({"circle-radius":new qt(Ke.paint_circle["circle-radius"]),"circle-color":new qt(Ke.paint_circle["circle-color"]),"circle-blur":new qt(Ke.paint_circle["circle-blur"]),"circle-opacity":new qt(Ke.paint_circle["circle-opacity"]),"circle-translate":new Dt(Ke.paint_circle["circle-translate"]),"circle-translate-anchor":new Dt(Ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Dt(Ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Dt(Ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(Ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(Ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(Ke.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Dt(Ke.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,d)}createBucket(u){return new Qt(u)}queryRadius(u){const o=u;return Vn("circle-radius",this,o)+Vn("circle-stroke-width",this,o)+fi(this.paint.get("circle-translate"))}queryIntersectsFeature(u,o,l,d,p,y,_,S){const P=pi(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,u.pixelToTileUnitsFactor),I=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l);return ZF(u,d,y,_,S,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,I)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,o,l){const d=qF(this);return{config:new ou(this,{zoom:o,lut:l}),defines:d,overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends ma{createBucket(u){return new KF(u)}constructor(u,o,l,d){super(u,{layout:YF||(YF=new Di({visibility:new Dt(Ke.layout_heatmap.visibility)})),paint:JF||(JF=new Di({"heatmap-radius":new qt(Ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(Ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Dt(Ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qu(Ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Dt(Ke.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,d),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ex({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return Vn("heatmap-radius",this,u)}queryIntersectsFeature(u,o,l,d,p,y,_,S){const P=this.paint.get("heatmap-radius").evaluate(o,l);return ZF(u,d,y,_,S,!0,!0,new yt(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,o,l){return u==="heatmap"?{config:new ou(this,{zoom:o,lut:l}),overrideFog:!1}:{}}},hillshade:class extends ma{constructor(u,o,l,d){super(u,{layout:QF||(QF=new Di({visibility:new Dt(Ke.layout_hillshade.visibility)})),paint:eB||(eB=new Di({"hillshade-illumination-direction":new Dt(Ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Dt(Ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Dt(Ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Dt(Ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Dt(Ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Dt(Ke.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Dt(Ke.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,d)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,o,l){return{overrideFog:!1}}},fill:class extends ma{constructor(u,o,l,d){super(u,{layout:AB||(AB=new Di({"fill-sort-key":new qt(Ke.layout_fill["fill-sort-key"]),visibility:new Dt(Ke.layout_fill.visibility),"fill-elevation-reference":new Dt(Ke.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new qt(Ke.layout_fill["fill-construct-bridge-guard-rail"])})),paint:PB||(PB=new Di({"fill-antialias":new Dt(Ke.paint_fill["fill-antialias"]),"fill-opacity":new qt(Ke.paint_fill["fill-opacity"]),"fill-color":new qt(Ke.paint_fill["fill-color"]),"fill-outline-color":new qt(Ke.paint_fill["fill-outline-color"]),"fill-translate":new Dt(Ke.paint_fill["fill-translate"]),"fill-translate-anchor":new Dt(Ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new qt(Ke.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Dt(Ke.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Dt(Ke.paint_fill["fill-emissive-strength"]),"fill-z-offset":new qt(Ke.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new qt(Ke.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new qt(Ke.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,d)}getProgramIds(){const u=this.paint.get("fill-pattern"),o=u&&u.constantOr(1),l=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(u,o,l){return{config:new ou(this,{zoom:o,lut:l}),overrideFog:!1}}recalculate(u,o){super.recalculate(u,o);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new aM(u)}queryRadius(){return fi(this.paint.get("fill-translate"))}queryIntersectsFeature(u,o,l,d,p,y){return!u.queryGeometry.isAboveHorizon&&tr(mr(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,u.pixelToTileUnitsFactor),d)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(u){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const o=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return u!=null?o&&!u:o}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends ma{constructor(u,o,l,d){super(u,{layout:JB||(JB=new Di({visibility:new Dt(Ke["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Dt(Ke["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:QB||(QB=new Di({"fill-extrusion-opacity":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Dt(Ke["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new cT(u)}queryRadius(){return fi(this.paint.get("fill-extrusion-translate"))}is3D(u){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,o,l,d,p,y,_,S,P){const I=pi(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,u.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(o,l),D=this.paint.get("fill-extrusion-base").evaluate(o,l),N=[0,0],W=S&&y.elevation,q=y.elevation?y.elevation.exaggeration():1,J=u.tile.getBucket(this);if(W&&J instanceof cT){const Q=J.centroidVertexArray,ue=P+1;ue<Q.length&&(N[0]=Q.geta_centroid_pos0(ue),N[1]=Q.geta_centroid_pos1(ue))}if(N[0]===0&&N[1]===1)return!1;y.projection.name==="globe"&&(d=YB([d],[new yt(0,0),new yt(jt,jt)],u.tileID.canonical).map(Q=>Q.polygon).flat());const ie=W?S:null,[ae,me]=function(Q,ue,pe,ve,Ie,De,Fe,He,ct,St,_t){return Q.projection.name==="globe"?function(bt,Pt,st,xt,nt,lt,It,Mt,on,Kt,$t){const Ct=[],kn=[],en=bt.projection.upVectorScale($t,bt.center.lat,bt.worldSize).metersToTile,tn=[0,0,0,1],Pn=[0,0,0,1],Bn=(Jn,Hn,Gn,Ur)=>{Jn[0]=Hn,Jn[1]=Gn,Jn[2]=Ur,Jn[3]=1},$n=KB();st>0&&(st+=$n),xt+=$n;for(const Jn of Pt){const Hn=[],Gn=[];for(const Ur of Jn){const ii=Ur.x+nt.x,ge=Ur.y+nt.y,xe=bt.projection.projectTilePoint(ii,ge,$t),ut=bt.projection.upVector($t,Ur.x,Ur.y);let Lt=st,Gt=xt;if(It){const Ut=oj(ii,ge,st,xt,It,Mt,on,Kt);Lt+=Ut.base,Gt+=Ut.top}st!==0?Bn(tn,xe.x+ut[0]*en*Lt,xe.y+ut[1]*en*Lt,xe.z+ut[2]*en*Lt):Bn(tn,xe.x,xe.y,xe.z),Bn(Pn,xe.x+ut[0]*en*Gt,xe.y+ut[1]*en*Gt,xe.z+ut[2]*en*Gt),Nt(tn,tn,lt),Nt(Pn,Pn,lt),Hn.push(new Gp(tn[0],tn[1],tn[2])),Gn.push(new Gp(Pn[0],Pn[1],Pn[2]))}Ct.push(Hn),kn.push(Gn)}return[Ct,kn]}(Q,ue,pe,ve,Ie,De,Fe,He,ct,St,_t):Fe?function(bt,Pt,st,xt,nt,lt,It,Mt,on){const Kt=[],$t=[],Ct=[0,0,0,1];for(const kn of bt){const en=[],tn=[];for(const Pn of kn){const Bn=Pn.x+xt.x,$n=Pn.y+xt.y,Jn=oj(Bn,$n,Pt,st,lt,It,Mt,on);Ct[0]=Bn,Ct[1]=$n,Ct[2]=Jn.base,Ct[3]=1,wt(Ct,Ct,nt),Ct[3]=Math.max(Ct[3],1e-5);const Hn=new Gp(Ct[0]/Ct[3],Ct[1]/Ct[3],Ct[2]/Ct[3]);Ct[0]=Bn,Ct[1]=$n,Ct[2]=Jn.top,Ct[3]=1,wt(Ct,Ct,nt),Ct[3]=Math.max(Ct[3],1e-5);const Gn=new Gp(Ct[0]/Ct[3],Ct[1]/Ct[3],Ct[2]/Ct[3]);en.push(Hn),tn.push(Gn)}Kt.push(en),$t.push(tn)}return[Kt,$t]}(ue,pe,ve,Ie,De,Fe,He,ct,St):function(bt,Pt,st,xt,nt){const lt=[],It=[],Mt=nt[8]*Pt,on=nt[9]*Pt,Kt=nt[10]*Pt,$t=nt[11]*Pt,Ct=nt[8]*st,kn=nt[9]*st,en=nt[10]*st,tn=nt[11]*st;for(const Pn of bt){const Bn=[],$n=[];for(const Jn of Pn){const Hn=Jn.x+xt.x,Gn=Jn.y+xt.y,Ur=nt[0]*Hn+nt[4]*Gn+nt[12],ii=nt[1]*Hn+nt[5]*Gn+nt[13],ge=nt[2]*Hn+nt[6]*Gn+nt[14],xe=nt[3]*Hn+nt[7]*Gn+nt[15],ut=Ur+Mt,Lt=ii+on,Gt=ge+Kt,Ut=Math.max(xe+$t,1e-5),nn=Ur+Ct,An=ii+kn,or=ge+en,ar=Math.max(xe+tn,1e-5);Bn.push(new Gp(ut/Ut,Lt/Ut,Gt/Ut)),$n.push(new Gp(nn/ar,An/ar,or/ar))}lt.push(Bn),It.push($n)}return[lt,It]}(ue,pe,ve,Ie,De)}(y,d,D,k,I,_,ie,N,q,y.center.lat,u.tileID.canonical),de=u.queryGeometry;return function(Q,ue,pe){let ve=1/0;tr(pe,ue)&&(ve=ij(pe,ue[0]));for(let Ie=0;Ie<ue.length;Ie++){const De=ue[Ie],Fe=Q[Ie];for(let He=0;He<De.length-1;He++){const ct=De[He],St=[ct,De[He+1],Fe[He+1],Fe[He],ct];Sn(pe,St)&&(ve=Math.min(ve,ij(pe,St)))}}return ve!==1/0&&ve}(ae,me,de.isPointQuery()?de.screenBounds:de.screenGeometry)}},line:class extends ma{constructor(u,o,l,d){const p=mj();super(u,p,o,l,d),p.layout&&(this.layout=new Ju(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof yp,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,o){super.recalculate(u,o),this.paint._values["line-floorwidth"]=(()=>{if(ux)return ux;const l=mj();return ux=new Ere(l.paint.properties["line-width"].specification),ux.useIntegerZoom=!0,ux})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new fM(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,o,l){const d=fj(this);return{config:new ou(this,{zoom:o,lut:l}),defines:d,overrideFog:!1}}queryRadius(u){const o=u,l=gj(Vn("line-width",this,o),Vn("line-gap-width",this,o)),d=Vn("line-offset",this,o);return l/2+Math.abs(d)+fi(this.paint.get("line-translate"))}queryIntersectsFeature(u,o,l,d,p,y){if(u.queryGeometry.isAboveHorizon)return!1;const _=mr(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,u.pixelToTileUnitsFactor),S=u.pixelToTileUnitsFactor/2*gj(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),P=this.paint.get("line-offset").evaluate(o,l);return P&&(d=function(I,k){const D=[],N=new yt(0,0);for(let W=0;W<I.length;W++){const q=I[W],J=[];for(let ie=0;ie<q.length;ie++){const ae=q[ie],me=q[ie+1],de=ie===0?N:ae.sub(q[ie-1])._unit()._perp(),Q=ie===q.length-1?N:me.sub(ae)._unit()._perp(),ue=de._add(Q)._unit();ue._mult(1/(ue.x*Q.x+ue.y*Q.y)),J.push(ue._mult(k)._add(ae))}D.push(J)}return D}(d,P*u.pixelToTileUnitsFactor)),function(I,k,D){for(let N=0;N<k.length;N++){const W=k[N];if(I.length>=3){for(let q=0;q<W.length;q++)if(Fr(I,W[q]))return!0}if(Nr(I,W,D))return!0}return!1}(_,d,S)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(u){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:ET,background:class extends ma{constructor(u,o,l,d){super(u,{layout:s4||(s4=new Di({visibility:new Dt(Ke.layout_background.visibility)})),paint:l4||(l4=new Di({"background-pitch-alignment":new Dt(Ke.paint_background["background-pitch-alignment"]),"background-color":new Dt(Ke.paint_background["background-color"]),"background-pattern":new Dt(Ke.paint_background["background-pattern"]),"background-opacity":new Dt(Ke.paint_background["background-opacity"]),"background-emissive-strength":new Dt(Ke.paint_background["background-emissive-strength"]),"background-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,d)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,o,l){return{overrideFog:!1}}is3D(u){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:f4,"raster-particle":v4,sky:class extends ma{constructor(u,o,l,d){super(u,{layout:g4||(g4=new Di({visibility:new Dt(Ke.layout_sky.visibility)})),paint:y4||(y4=new Di({"sky-type":new Dt(Ke.paint_sky["sky-type"]),"sky-atmosphere-sun":new Dt(Ke.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Dt(Ke.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Dt(Ke.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Dt(Ke.paint_sky["sky-gradient-radius"]),"sky-gradient":new Qu(Ke.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Dt(Ke.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Dt(Ke.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Dt(Ke.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,d),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=ex({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(u,o){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),p=!d,y=u.style.light,_=y.properties.get("position");return p&&y.properties.get("anchor")==="viewport"&&nr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?zM(_.azimuthal,90-_.polar,o):zM(d[0],90-d[1],o)}const l=this.paint.get("sky-gradient-center");return zM(l[0],90-l[1],o)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends ma{constructor(u,o,l,d){super(u,{paint:_4||(_4=new Di({}))},o,null)}},model:class extends ma{constructor(u,o,l,d){super(u,{layout:C4||(C4=new Di({visibility:new Dt(Ke.layout_model.visibility),"model-id":new qt(Ke.layout_model["model-id"])})),paint:I4||(I4=new Di({"model-opacity":new qt(Ke.paint_model["model-opacity"]),"model-rotation":new qt(Ke.paint_model["model-rotation"]),"model-scale":new qt(Ke.paint_model["model-scale"]),"model-translation":new qt(Ke.paint_model["model-translation"]),"model-color":new qt(Ke.paint_model["model-color"]),"model-color-mix-intensity":new qt(Ke.paint_model["model-color-mix-intensity"]),"model-type":new Dt(Ke.paint_model["model-type"]),"model-cast-shadows":new Dt(Ke.paint_model["model-cast-shadows"]),"model-receive-shadows":new Dt(Ke.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Dt(Ke.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new qt(Ke.paint_model["model-emissive-strength"]),"model-roughness":new qt(Ke.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new qt(Ke.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Dt(Ke.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Dt(Ke.paint_model["model-front-cutoff"]),"model-color-use-theme":new qt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new jM(u)}getProgramIds(){return["model"]}is3D(u){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof RT?jt-1:0}queryIntersectsFeature(u,o,l,d,p,y){if(!this.modelManager)return!1;const _=this.modelManager,S=u.tile.getBucket(this);if(!(S&&S instanceof jM))return!1;for(const P in S.instancesPerModel){const I=S.instancesPerModel[P],k=o.id!==void 0?o.id:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0;if(I.idToFeaturesIndex.hasOwnProperty(k)){const D=I.features[I.idToFeaturesIndex[k]],N=_.getModel(P,this.scope);if(!N)return!1;let W=B();const q=new re(0,0),J=S.canonical;let ie=Number.MAX_VALUE;for(let ae=0;ae<D.instancedDataCount;++ae){const me=16*(D.instancedDataOffset+ae),de=I.instancedDataArray.float32,Q=[de[me+4],de[me+5],de[me+6]];L4(J,q,de[me],0|de[me+1]),M4(W,N,y,q,D.rotation,D.scale,Q,!1,!1,!1),y.projection.name==="globe"&&(W=FM(W,y));const ue=V([],y.projMatrix,W),pe=u.queryGeometry,ve=T4(pe.isPointQuery()?pe.screenBounds:pe.screenGeometry,y,ue,N.aabb);ve!=null&&(ie=Math.min(ve,ie))}return ie!==Number.MAX_VALUE&&ie}}return!1}_handleOverridablePaintPropertyUpdate(u,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const o=this._transitionablePaint._values[u];return o!=null&&o.value!=null&&o.value.expression!=null&&o.value.expression instanceof md}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends ma{constructor(u,o,l,d){super(u,{layout:CB||(CB=new Di({"clip-layer-types":new Dt(Ke.layout_clip["clip-layer-types"]),"clip-layer-scope":new Dt(Ke.layout_clip["clip-layer-scope"])})),paint:IB||(IB=new Di({}))},o,l,d)}recalculate(u,o){super.recalculate(u,o)}createBucket(u){return new MB(u)}is3D(u){return!0}}};class Eie{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Aie{constructor(){this.tasks={},this.taskQueue=[],Dn(["process"],this),this.invoker=new Eie(this.process),this.nextId=0}add(o,l){const d=this.nextId++,p=function({type:y,isSymbolTile:_,zoom:S}){return S=S||0,y==="message"?0:y!=="maybePrepare"||_?y!=="parseTile"||_?y==="parseTile"&&_?300-S:y==="maybePrepare"&&_?400-S:500:200-S:100-S}(l);if(p===0){try{o()}finally{}return null}return this.tasks[d]={fn:o,metadata:l,priority:p,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const o=this.pick();if(o===null)return;const l=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let o=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){const y=this.tasks[this.taskQueue[p]];y.priority<l&&(l=y.priority,o=p)}if(o===null)return null;const d=this.taskQueue[o];return this.taskQueue.splice(o,1),d}remove(){this.invoker.remove()}}class z4{constructor(o,l,d){this.target=o,this.parent=l,this.mapId=d,this.callbacks={},this.cancelCallbacks={},Dn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Aie}send(o,l,d,p,y=!1,_){const S=Math.round(1e18*Math.random()).toString(36).substring(0,10);d&&(d.metadata=_,this.callbacks[S]=d);const P=new Set;return this.target.postMessage({id:S,type:o,hasCallback:!!d,targetMapId:p,mustQueue:y,sourceMapId:this.mapId,data:Jc(l,P)},P),{cancel:()=>{d&&delete this.callbacks[S],this.target.postMessage({id:S,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(o){const l=o.data;if(!l)return;const d=l.id;if(d&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const p=this.cancelCallbacks[d];delete this.cancelCallbacks[d],p&&p.cancel()}else if(l.mustQueue||ni(self)){const p=this.callbacks[d],y=this.scheduler.add(()=>this.processTask(d,l),p&&p.metadata||{type:"message"});y&&(this.cancelCallbacks[d]=y)}else this.processTask(d,l)}processTask(o,l){if(delete this.cancelCallbacks[o],l.type==="<response>"){const d=this.callbacks[o];delete this.callbacks[o],d&&(l.error?d(Qc(l.error)):d(null,Qc(l.data)))}else{const d=new Set,p=l.hasCallback?(_,S)=>{this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:_?Jc(_):null,data:Jc(S,d)},d)}:()=>{},y=Qc(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,y,p);else if(this.parent.getWorkerSource){const _=l.type.split("."),{source:S,scope:P}=y;this.parent.getWorkerSource(l.sourceMapId,_[0],S,P)[_[1]](y,p)}else p(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Tx={workerUrl:"",workerClass:null,workerParams:void 0};const GM="mapboxgl_preloaded_worker_pool";class Zp{constructor(){this.active={}}acquire(o,l=Zp.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<l;)this.workers.push(Tx.workerClass!=null?new Tx.workerClass:new self.Worker(Tx.workerUrl,Tx.workerParams));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.workers&&this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[GM]}numActive(){return Object.keys(this.active).length}}Zp.workerCount=2;class py{constructor(o,l,d="Worker",p=Zp.workerCount){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=Ht();const y=this.workerPool.acquire(this.id,p);for(let _=0;_<y.length;_++){const S=new py.Actor(y[_],l,this.id);S.name=`${d} ${_}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,l,d){ft(this.actors,(p,y)=>{p.send(o,l,y)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}let Ex,WM;function DT(){return Ex||(Ex=new Zp),Ex}py.Actor=z4;const HM=new wr(0,0,0),qM={PATH_RULE_UNSPECIFIED:0,PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},ZM={LINE_CAP_UNSPECIFIED:0,LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},LT={LINE_JOIN_UNSPECIFIED:0,LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},Pie={PAINT_ORDER_UNSPECIFIED:0,PAINT_ORDER_FILL_AND_STROKE:1,PAINT_ORDER_STROKE_AND_FILL:2},Ax={PATH_COMMAND_UNSPECIFIED:0,PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},N4={MASK_TYPE_UNSPECIFIED:0,MASK_TYPE_LUMINANCE:1,MASK_TYPE_ALPHA:2};function Cie(u,o,l){u===1&&o.icons.push(function(d,p){return function(y){if(y.usvg_tree.height||(y.usvg_tree.height=y.usvg_tree.width),!y.metadata)return y;const{metadata:_}=y;if(_.content_area){const{content_area:S}=_;S.top==null&&(S.top=S.left),S.width==null&&(S.width=y.usvg_tree.width),S.height==null&&(S.height=S.width)}return _.stretch_x&&_.stretch_x.length&&F4(_,"x"),_.stretch_y&&_.stretch_y.length&&F4(_,"y"),y}(d.readFields(Iie,{name:void 0},p))}(l,l.readVarint()+l.pos))}function F4(u,o){const l=[],d=u[`stretch_${o}`];let p=null;for(let y=0;y<d.length;y++)p===null?p=l.length===0?d[0]:l[l.length-1][1]+d[y]:(l.push([p,p+d[y]]),p=null);u[`stretch_${o}_areas`]=l}function Iie(u,o,l){u===1?o.name=l.readString():u===2?o.metadata=function(d,p){return d.readFields(Mie,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)}(l,l.readVarint()+l.pos):u===3&&(o.usvg_tree=function(d,p){return d.readFields(Rie,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)}(l,l.readVarint()+l.pos),o.data="usvg_tree")}function Mie(u,o,l){u===1?o.stretch_x=l.readPackedVarint():u===2?o.stretch_y=l.readPackedVarint():u===3?o.content_area=function(d,p){return d.readFields(Oie,{left:0},p)}(l,l.readVarint()+l.pos):u===4&&o.variables.push(function(d,p){return d.readFields(kie,{name:void 0},p)}(l,l.readVarint()+l.pos))}function Oie(u,o,l){u===1?o.left=l.readVarint():u===2?o.width=l.readVarint():u===3?o.top=l.readVarint():u===4&&(o.height=l.readVarint())}function kie(u,o,l){u===1?o.name=l.readString():u===2&&(o.rgb_color=FT(l.readVarint()),o.value="rgb_color")}function Rie(u,o,l){u===1?o.width=o.height=l.readVarint():u===2?o.height=l.readVarint():u===3?o.children.push(zT(l,l.readVarint()+l.pos)):u===4?o.linear_gradients.push(function(d,p){return d.readFields(jie,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)}(l,l.readVarint()+l.pos)):u===5?o.radial_gradients.push(function(d,p){return d.readFields(Uie,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)}(l,l.readVarint()+l.pos)):u===7?o.clip_paths.push(function(d,p){return d.readFields(Vie,{children:[]},p)}(l,l.readVarint()+l.pos)):u===8&&o.masks.push(function(d,p){const y=d.readFields(Gie,{left:0,width:20,mask_type:N4.MASK_TYPE_LUMINANCE,children:[]},p);return y.height==null&&(y.height=y.width),y.top==null&&(y.top=y.left),y}(l,l.readVarint()+l.pos))}function zT(u,o){return u.readFields(Die,{},o)}function Die(u,o,l){u===1?(o.group=function(d,p){return d.readFields(Lie,{opacity:255,children:[]},p)}(l,l.readVarint()+l.pos),o.node="group"):u===2&&(o.path=function(d,p){return d.readFields(Nie,{paint_order:1,commands:[],step:1,diffs:[],rule:qM.PATH_RULE_NON_ZERO},p)}(l,l.readVarint()+l.pos),o.node="path")}function Lie(u,o,l){u===1?o.transform=NT(l,l.readVarint()+l.pos):u===2?o.opacity=l.readVarint():u===5?o.clip_path_idx=l.readVarint():u===6?o.mask_idx=l.readVarint():u===7&&o.children.push(zT(l,l.readVarint()+l.pos))}function NT(u,o){return u.readFields(zie,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},o)}function zie(u,o,l){u===1?o.sx=l.readFloat():u===2?o.ky=l.readFloat():u===3?o.kx=l.readFloat():u===4?o.sy=l.readFloat():u===5?o.tx=l.readFloat():u===6&&(o.ty=l.readFloat())}function Nie(u,o,l){u===1?o.fill=function(d,p){return d.readFields(Fie,{rgb_color:HM,paint:"rgb_color",opacity:255},p)}(l,l.readVarint()+l.pos):u===2?o.stroke=function(d,p){return d.readFields(Bie,{rgb_color:HM,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)}(l,l.readVarint()+l.pos):u===3?o.paint_order=l.readVarint():u===5?l.readPackedVarint(o.commands):u===6?o.step=l.readFloat():u===7?l.readPackedSVarint(o.diffs):u===8&&(o.rule=l.readVarint())}function Fie(u,o,l){u===1?(o.rgb_color=FT(l.readVarint()),o.paint="rgb_color"):u===2?(o.linear_gradient_idx=l.readVarint(),o.paint="linear_gradient_idx"):u===3?(o.radial_gradient_idx=l.readVarint(),o.paint="radial_gradient_idx"):u===5&&(o.opacity=l.readVarint())}function FT(u){return new wr((u>>16&255)/255,(u>>8&255)/255,(255&u)/255,1)}function Bie(u,o,l){u===1?(o.rgb_color=FT(l.readVarint()),o.paint="rgb_color"):u===2?(o.linear_gradient_idx=l.readVarint(),o.paint="linear_gradient_idx"):u===3?(o.radial_gradient_idx=l.readVarint(),o.paint="radial_gradient_idx"):u===5?l.readPackedFloat(o.dasharray):u===6?o.dashoffset=l.readFloat():u===7?o.miterlimit=l.readFloat():u===8?o.opacity=l.readVarint():u===9?o.width=l.readFloat():u===10?o.linecap=l.readVarint():u===11&&(o.linejoin=l.readVarint())}function jie(u,o,l){u===1?o.transform=NT(l,l.readVarint()+l.pos):u===2?o.spread_method=l.readVarint():u===3?o.stops.push(B4(l,l.readVarint()+l.pos)):u===4?o.x1=l.readFloat():u===5?o.y1=l.readFloat():u===6?o.x2=l.readFloat():u===7&&(o.y2=l.readFloat())}function B4(u,o){return u.readFields($ie,{offset:0,opacity:255,rgb_color:HM},o)}function $ie(u,o,l){u===1?o.offset=l.readFloat():u===2?o.opacity=l.readVarint():u===3&&(o.rgb_color=FT(l.readVarint()))}function Uie(u,o,l){u===1?o.transform=NT(l,l.readVarint()+l.pos):u===2?o.spread_method=l.readVarint():u===3?o.stops.push(B4(l,l.readVarint()+l.pos)):u===4?o.cx=l.readFloat():u===5?o.cy=l.readFloat():u===6?o.r=l.readFloat():u===7?o.fx=l.readFloat():u===8?o.fy=l.readFloat():u===9&&(o.fr=l.readFloat())}function Vie(u,o,l){u===1?o.transform=NT(l,l.readVarint()+l.pos):u===2?o.clip_path_idx=l.readVarint():u===3&&o.children.push(zT(l,l.readVarint()+l.pos))}function Gie(u,o,l){u===1?o.left=o.top=l.readFloat():u===2?o.width=o.height=l.readFloat():u===3?o.top=l.readFloat():u===4?o.height=l.readFloat():u===5?o.mask_type=l.readVarint():u===6?o.mask_idx=l.readVarint():u===7&&o.children.push(zT(l,l.readVarint()+l.pos))}class Wie{static calculate(o={},l=[]){const d=new Map,p=new Map;if(Object.keys(o).length===0)return d;l.forEach(y=>{p.set(y.name,y.rgb_color||new wr(0,0,0))});for(const[y,_]of Object.entries(o))p.has(y)?d.set(p.get(y).toStringPremultipliedAlpha(),_):console.warn(`Ignoring unknown image variable "${y}"`);return d}}function my(u,o=255,l){const d=o/255,p=u.toStringPremultipliedAlpha(),y=l.has(p)?l.get(p).clone():u.clone();return y.a*=d,y.toString()}function Px(u,o){if(!Wv()){const l=document.createElement("canvas");return l.width=u,l.height=o,l}return new OffscreenCanvas(u,o)}function Hie(u,o){const l=Wie.calculate(o.params,u.metadata?u.metadata.variables:[]),d=u.usvg_tree,p=d.width,y=d.height,_=o.transform?o.transform:new DOMMatrix,S=Math.max(1,Math.round(p*_.a)),P=Math.max(1,Math.round(y*_.d)),I=new DOMMatrix([S/p,0,0,P/y,0,0]),k=Px(S,P).getContext("2d");return XM(k,I,d,d,l),k.getImageData(0,0,S,P)}function XM(u,o,l,d,p){for(const y of d.children)j4(u,o,l,y,p)}function j4(u,o,l,d,p){d.group?(u.save(),function(y,_,S,P,I){const k=P.mask_idx!=null?S.masks[P.mask_idx]:null,D=P.clip_path_idx!=null?S.clip_paths[P.clip_path_idx]:null;if(P.transform&&(_=BT(P.transform).preMultiplySelf(_)),!function(q,J,ie){return q.opacity!==255||J||ie}(P,D!=null,k!=null))return void XM(y,_,S,P,I);const N=Px(y.canvas.width,y.canvas.height),W=N.getContext("2d");XM(W,_,S,P,I),D&&q4(W,_,S,D),k&&Z4(W,_,S,k,I),y.globalAlpha=P.opacity/255,y.drawImage(N,0,0)}(u,o,l,d.group,p),u.restore()):d.path&&(u.save(),function(y,_,S,P,I){const k=X4(P);y.setTransform(_),P.paint_order===Pie.PAINT_ORDER_FILL_AND_STROKE?($4(y,S,P,k,I),V4(y,S,P,k,I)):(V4(y,S,P,k,I),$4(y,S,P,k,I))}(u,o,l,d.path,p),u.restore())}function $4(u,o,l,d,p){const y=l.fill;if(!y)return;const _=y.opacity/255;switch(y.paint){case"rgb_color":u.fillStyle=my(y.rgb_color,y.opacity,p);break;case"linear_gradient_idx":u.fillStyle=G4(u,o.linear_gradients[y.linear_gradient_idx],_,p);break;case"radial_gradient_idx":u.fillStyle=W4(u,o.radial_gradients[y.radial_gradient_idx],_,p)}u.fill(d,U4(l))}function U4(u){return u.rule===qM.PATH_RULE_NON_ZERO?"nonzero":u.rule===qM.PATH_RULE_EVEN_ODD?"evenodd":void 0}function V4(u,o,l,d,p){const y=l.stroke;if(!y)return;u.lineWidth=y.width,u.miterLimit=y.miterlimit,u.setLineDash(y.dasharray),u.lineDashOffset=y.dashoffset;const _=y.opacity/255;switch(y.paint){case"rgb_color":u.strokeStyle=my(y.rgb_color,y.opacity,p);break;case"linear_gradient_idx":u.strokeStyle=G4(u,o.linear_gradients[y.linear_gradient_idx],_,p);break;case"radial_gradient_idx":u.strokeStyle=W4(u,o.radial_gradients[y.radial_gradient_idx],_,p)}switch(y.linejoin){case LT.LINE_JOIN_MITER_CLIP:case LT.LINE_JOIN_MITER:u.lineJoin="miter";break;case LT.LINE_JOIN_ROUND:u.lineJoin="round";break;case LT.LINE_JOIN_BEVEL:u.lineJoin="bevel"}switch(y.linecap){case ZM.LINE_CAP_BUTT:u.lineCap="butt";break;case ZM.LINE_CAP_ROUND:u.lineCap="round";break;case ZM.LINE_CAP_SQUARE:u.lineCap="square"}u.stroke(d)}function G4(u,o,l,d){if(o.stops.length===1){const N=o.stops[0];return my(N.rgb_color,N.opacity*l,d)}const p=BT(o.transform),{x1:y,y1:_,x2:S,y2:P}=o,I=p.transformPoint(new DOMPoint(y,_)),k=p.transformPoint(new DOMPoint(S,P)),D=u.createLinearGradient(I.x,I.y,k.x,k.y);for(const N of o.stops)D.addColorStop(N.offset,my(N.rgb_color,N.opacity*l,d));return D}function W4(u,o,l,d){if(o.stops.length===1){const N=o.stops[0];return my(N.rgb_color,N.opacity*l,d)}const p=BT(o.transform),{fx:y,fy:_,cx:S,cy:P}=o,I=p.transformPoint(new DOMPoint(y,_)),k=p.transformPoint(new DOMPoint(S,P)),D=u.createRadialGradient(I.x,I.y,0,k.x,k.y,o.r*((p.a+p.d)/2));for(const N of o.stops)D.addColorStop(N.offset,my(N.rgb_color,N.opacity*l,d));return D}function H4(u,o,l,d){const p=d.transform?BT(d.transform).preMultiplySelf(o):o,y=Px(u.canvas.width,u.canvas.height),_=y.getContext("2d");for(const P of d.children)if(P.group)H4(_,p,l,P.group);else if(P.path){const I=P.path,k=new Path2D;k.addPath(X4(I),p),_.fill(k,U4(I))}const S=d.clip_path_idx!=null?l.clip_paths[d.clip_path_idx]:null;S&&q4(_,p,l,S),u.globalCompositeOperation="source-over",u.drawImage(y,0,0)}function q4(u,o,l,d){const p=Px(u.canvas.width,u.canvas.height);H4(p.getContext("2d"),o,l,d),u.globalCompositeOperation="destination-in",u.drawImage(p,0,0)}function Z4(u,o,l,d,p){if(d.children.length===0)return;const y=d.mask_idx!=null?l.masks[d.mask_idx]:null;y&&Z4(u,o,l,y,p);const _=u.canvas.width,S=u.canvas.height,P=Px(_,S),I=P.getContext("2d"),k=d.width,D=d.height,N=d.left,W=d.top,q=new Path2D,J=new Path2D;J.rect(N,W,k,D),q.addPath(J,o),I.clip(q);for(const me of d.children)j4(I,o,l,me,p);const ie=I.getImageData(0,0,_,S),ae=ie.data;if(d.mask_type===N4.MASK_TYPE_LUMINANCE)for(let me=0;me<ae.length;me+=4)ae[me+3]=ae[me+3]/255*(.2126*ae[me]+.7152*ae[me+1]+.0722*ae[me+2]);I.putImageData(ie,0,0),u.globalCompositeOperation="destination-in",u.drawImage(P,0,0)}function BT(u){return u?new DOMMatrix([u.sx,u.ky,u.kx,u.sy,u.tx,u.ty]):new DOMMatrix}function X4(u){const o=new Path2D,l=u.step;let d=u.diffs[0]*l,p=u.diffs[1]*l;o.moveTo(d,p);for(let y=0,_=2;y<u.commands.length;y++)switch(u.commands[y]){case Ax.PATH_COMMAND_MOVE:d+=u.diffs[_++]*l,p+=u.diffs[_++]*l,o.moveTo(d,p);break;case Ax.PATH_COMMAND_LINE:d+=u.diffs[_++]*l,p+=u.diffs[_++]*l,o.lineTo(d,p);break;case Ax.PATH_COMMAND_QUAD:{const S=d+u.diffs[_++]*l,P=p+u.diffs[_++]*l;d=S+u.diffs[_++]*l,p=P+u.diffs[_++]*l,o.quadraticCurveTo(S,P,d,p);break}case Ax.PATH_COMMAND_CUBIC:{const S=d+u.diffs[_++]*l,P=p+u.diffs[_++]*l,I=S+u.diffs[_++]*l,k=P+u.diffs[_++]*l;d=I+u.diffs[_++]*l,p=k+u.diffs[_++]*l,o.bezierCurveTo(S,P,I,k,d,p);break}case Ax.PATH_COMMAND_CLOSE:o.closePath()}return o}class jT{constructor(o){this.capacity=o,this.cache=new Map}get(o){if(!this.cache.has(o))return;const l=this.cache.get(o);return this.cache.delete(o),this.cache.set(o,l),l}put(o,l){this.cache.has(o)?this.cache.delete(o):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(o,l)}delete(o){this.cache.delete(o)}}Zt(jT,"LRUCache");class KM{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(o){return new Go(o,o.data)}getFromCache(o,l,d){return this.cacheMap.has(d)||this.cacheMap.set(d,new jT(150)),this.cacheMap.get(d).get(eh(o.toString(),l))}setInCache(o,l,d,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new jT(150));const y=this.cacheDependenciesMap.get(p),_=eh(o.id.toString(),d);y.get(_)||y.set(_,new Set);const S=this.cacheMap.get(p),P=o.toString();y.get(_).add(P),S.put(eh(o.toString(),d),l)}removeImagesFromCacheByIds(o,l,d=0){if(!this.cacheMap.has(d)||!this.cacheDependenciesMap.has(d))return;const p=this.cacheMap.get(d),y=this.cacheDependenciesMap.get(d);for(const _ of o){const S=eh(_.toString(),l);if(y.has(S)){for(const P of y.get(S))p.delete(P);y.delete(S)}}}rasterize(o,l,d,p,y=Hie){const _=this.getFromCache(o,d,p);if(_)return _.clone();const S=y(l.icon,o.options),P=KM._getImage(S);return this.setInCache(o,P,d,p),P.clone()}}class K4{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,l){const d=this.toIdx(o,l);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(o,l){return this.leaves[this.toIdx(o,l)]}toIdx(o,l){return l*this.size+o}}function Y4(u,o,l,d){let p=0,y=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(d[_])<1e-15){if(l[_]<u[_]||l[_]>o[_])return null}else{const S=1/d[_];let P=(u[_]-l[_])*S,I=(o[_]-l[_])*S;if(P>I){const k=P;P=I,I=k}if(P>p&&(p=P),I<y&&(y=I),p>y)return null}return p}function J4(u,o,l,d,p,y,_,S,P,I,k){const D=d-u,N=p-o,W=y-l,q=_-u,J=S-o,ie=P-l,ae=k[1]*ie-k[2]*J,me=k[2]*q-k[0]*ie,de=k[0]*J-k[1]*q,Q=D*ae+N*me+W*de;if(Math.abs(Q)<1e-15)return null;const ue=1/Q,pe=I[0]-u,ve=I[1]-o,Ie=I[2]-l,De=(pe*ae+ve*me+Ie*de)*ue;if(De<0||De>1)return null;const Fe=ve*W-Ie*N,He=Ie*D-pe*W,ct=pe*N-ve*D,St=(k[0]*Fe+k[1]*He+k[2]*ct)*ue;return St<0||De+St>1?null:(q*Fe+J*He+ie*ct)*ue}function Q4(u,o,l){return(u-o)/(l-o)}function e$(u,o,l,d,p,y,_,S,P){const I=1<<l,k=y-d,D=_-p,N=(u+1)/I*k+d,W=(o+0)/I*D+p,q=(o+1)/I*D+p;S[0]=(u+0)/I*k+d,S[1]=W,P[0]=N,P[1]=q}class t${constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(y){const _=Math.ceil(Math.log2(y.dim/8)),S=[];let P=Math.ceil(Math.pow(2,_));const I=1/P,k=(W,q,J,ie,ae)=>{const me=ie?1:0,de=(W+1)*J-me,Q=q*J,ue=(q+1)*J-me;ae[0]=W*J,ae[1]=Q,ae[2]=de,ae[3]=ue};let D=new K4(P);const N=[];for(let W=0;W<P*P;W++){k(W%P,Math.floor(W/P),I,!1,N);const q=Nd(N[0],N[1],y),J=Nd(N[2],N[1],y),ie=Nd(N[2],N[3],y),ae=Nd(N[0],N[3],y);D.minimums.push(Math.min(q,J,ie,ae)),D.maximums.push(Math.max(q,J,ie,ae)),D.leaves.push(1)}for(S.push(D),P/=2;P>=1;P/=2){const W=S[S.length-1];D=new K4(P);for(let q=0;q<P*P;q++){k(q%P,Math.floor(q/P),2,!0,N);const J=W.getElevation(N[0],N[1]),ie=W.getElevation(N[2],N[1]),ae=W.getElevation(N[2],N[3]),me=W.getElevation(N[0],N[3]),de=W.isLeaf(N[0],N[1]),Q=W.isLeaf(N[2],N[1]),ue=W.isLeaf(N[2],N[3]),pe=W.isLeaf(N[0],N[3]),ve=Math.min(J.min,ie.min,ae.min,me.min),Ie=Math.max(J.max,ie.max,ae.max,me.max),De=de&&Q&&ue&&pe;D.maximums.push(Ie),D.minimums.push(ve),D.leaves.push(Ie-ve<=5&&De?1:0)}S.push(D)}return S}(this.dem),d=l.length-1,p=l[d];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,d,0)}raycastRoot(o,l,d,p,y,_,S=1){return Y4([o,l,-100],[d,p,this.maximums[0]*S],y,_)}raycast(o,l,d,p,y,_,S=1){if(!this.nodeCount)return null;const P=this.raycastRoot(o,l,d,p,y,_,S);if(P==null)return null;const I=[],k=[],D=[],N=[],W=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;W.length>0;){const{idx:q,t:J,nodex:ie,nodey:ae,depth:me}=W.pop();if(this.leaves[q]){e$(ie,ae,me,o,l,d,p,D,N);const Q=1<<me,ue=(ie+0)/Q,pe=(ie+1)/Q,ve=(ae+0)/Q,Ie=(ae+1)/Q,De=Nd(ue,ve,this.dem)*S,Fe=Nd(pe,ve,this.dem)*S,He=Nd(pe,Ie,this.dem)*S,ct=Nd(ue,Ie,this.dem)*S,St=J4(D[0],D[1],De,N[0],D[1],Fe,N[0],N[1],He,y,_),_t=J4(N[0],N[1],He,D[0],N[1],ct,D[0],D[1],De,y,_),bt=Math.min(St!==null?St:Number.MAX_VALUE,_t!==null?_t:Number.MAX_VALUE);if(bt!==Number.MAX_VALUE)return bt;{const Pt=zt([],y,_,J);if(n$(De,Fe,ct,He,Q4(Pt[0],D[0],N[0]),Q4(Pt[1],D[1],N[1]))>=Pt[2])return J}continue}let de=0;for(let Q=0;Q<this._siblingOffset.length;Q++){e$((ie<<1)+this._siblingOffset[Q][0],(ae<<1)+this._siblingOffset[Q][1],me+1,o,l,d,p,D,N),D[2]=-100,N[2]=this.maximums[this.childOffsets[q]+Q]*S;const ue=Y4(D,N,y,_);if(ue!=null){const pe=ue;I[Q]=pe;let ve=!1;for(let Ie=0;Ie<de&&!ve;Ie++)pe>=I[k[Ie]]&&(k.splice(Ie,0,Q),ve=!0);ve||(k[de]=Q),de++}}for(let Q=0;Q<de;Q++){const ue=k[Q];W.push({idx:this.childOffsets[q]+ue,t:I[ue],nodex:(ie<<1)+this._siblingOffset[ue][0],nodey:(ae<<1)+this._siblingOffset[ue][1],depth:me+1})}}return null}_addNode(o,l,d){return this.minimums.push(o),this.maximums.push(l),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(o,l,d,p,y){if(o[p].isLeaf(l,d)===1)return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const _=p-1,S=o[_];let P=0,I=0;for(let k=0;k<this._siblingOffset.length;k++){const D=2*l+this._siblingOffset[k][0],N=2*d+this._siblingOffset[k][1],W=S.getElevation(D,N),q=S.isLeaf(D,N),J=this._addNode(W.min,W.max,q);q&&(P|=1<<k),I||(I=J)}for(let k=0;k<this._siblingOffset.length;k++)P&1<<k||this._construct(o,2*l+this._siblingOffset[k][0],2*d+this._siblingOffset[k][1],_,I+k)}}function n$(u,o,l,d,p,y){return yn(yn(u,l,y),yn(o,d,y),p)}function Nd(u,o,l){const d=l.dim,p=Ue(u*d-.5,0,d-1),y=Ue(o*d-.5,0,d-1),_=Math.floor(p),S=Math.floor(y),P=Math.min(_+1,d-1),I=Math.min(S+1,d-1);return n$(l.get(_,S),l.get(P,S),l.get(_,I),l.get(P,I),p-_,y-S)}const qie={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Zie(u,o,l){return(256*u*256+256*o+l)/10-1e4}function Xie(u,o,l){return 256*u+o+l/256-32768}class $T{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,l,d,p=!1){if(this.uid=o,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return void nr(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const y=this.dim=l.height-2,_=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let P=0;P<y;P++)_[this._idx(-1,P)]=_[this._idx(0,P)],_[this._idx(y,P)]=_[this._idx(y-1,P)],_[this._idx(P,-1)]=_[this._idx(P,0)],_[this._idx(P,y)]=_[this._idx(P,y-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(y,-1)]=_[this._idx(y-1,0)],_[this._idx(-1,y)]=_[this._idx(0,y-1)],_[this._idx(y,y)]=_[this._idx(y-1,y-1)]}const S=d==="terrarium"?Xie:Zie;for(let P=0;P<_.length;++P){const I=4*P;this.floatView[P]=S(this.pixels[I],this.pixels[I+1],this.pixels[I+2])}this._timestamp=Xs.now()}_buildQuadTree(){this._tree=new t$(this)}get(o,l,d=!1){d&&(o=Ue(o,-1,this.dim),l=Ue(l,-1,this.dim));const p=this._idx(o,l);return this.floatView[p]}set(o,l,d){const p=this._idx(o,l),y=this.floatView[p];return this.floatView[p]=d,d-y}static getUnpackVector(o){return qie[o]}_idx(o,l){if(o<-1||o>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(o+1)}static pack(o,l){const d=[0,0,0,0],p=$T.getUnpackVector(l);let y=Math.floor((o+p[3])/p[2]);return d[2]=y%256,y=Math.floor(y/256),d[1]=y%256,y=Math.floor(y/256),d[0]=y,d}getPixels(){return new rB({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,l,d){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,y=l*this.dim+this.dim,_=d*this.dim,S=d*this.dim+this.dim;switch(l){case-1:p=y-1;break;case 1:y=p+1}switch(d){case-1:_=S-1;break;case 1:S=_+1}const P=-l*this.dim,I=-d*this.dim;for(let k=_;k<S;k++)for(let D=p;D<y;D++){const N=4*this._idx(D,k),W=4*this._idx(D+P,k+I);this.pixels[N+0]=o.pixels[W+0],this.pixels[N+1]=o.pixels[W+1],this.pixels[N+2]=o.pixels[W+2],this.pixels[N+3]=o.pixels[W+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Kie(u,o,l){u===1?o.headerLength=l.readFixed32():u===2?o.x=l.readVarint():u===3?o.y=l.readVarint():u===4?o.z=l.readVarint():u===5&&o.layers.push(function(d,p){return d.readFields(toe,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)}(l,l.readVarint()+l.pos))}function Yie(u,o,l){u===1?(o.delta_filter=function(d,p){return d.readFields(Jie,{blockSize:0},p)}(l,l.readVarint()+l.pos),o.filter="delta_filter"):u===2?(l.readVarint(),o.filter="zigzag_filter"):u===3?(l.readVarint(),o.filter="bitshuffle_filter"):u===4&&(l.readVarint(),o.filter="byteshuffle_filter")}function Jie(u,o,l){u===1&&(o.blockSize=l.readVarint())}function Qie(u,o,l){u===1?(l.readVarint(),o.codec="gzip_data"):u===2?(l.readVarint(),o.codec="jpeg_image"):u===3?(l.readVarint(),o.codec="webp_image"):u===4&&(l.readVarint(),o.codec="png_image")}function eoe(u,o,l){let d=0,p=0;u===1?o.firstByte=l.readFixed64():u===2?o.lastByte=l.readFixed64():u===3?o.filters.push(function(y,_){return y.readFields(Yie,{},_)}(l,l.readVarint()+l.pos)):u===4?o.codec=function(y,_){return y.readFields(Qie,{},_)}(l,l.readVarint()+l.pos):u===5?p=l.readFloat():u===6?d=l.readFloat():u===7?o.bands.push(l.readString()):u===8?o.offset=l.readDouble():u===9&&(o.scale=l.readDouble()),o.offset===0&&(o.offset=p),o.scale===0&&(o.scale=d)}function toe(u,o,l){u===1?o.version=l.readVarint():u===2?o.name=l.readString():u===3?o.units=l.readString():u===4?o.tileSize=l.readVarint():u===5?o.buffer=l.readVarint():u===6?o.pixelFormat=l.readVarint():u===7&&o.dataIndex.push(function(d,p){return d.readFields(eoe,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)}(l,l.readVarint()+l.pos))}function noe(u,o,l){if(u===2)(function(d,p,y){d.readFields(roe,y,p)})(l,l.readVarint()+l.pos,o);else if(u===3)throw new Error("Not implemented")}function roe(u,o,l){if(u===1){let d=0;const p=l.readVarint()+l.pos;for(;l.pos<p;)o[d++]=l.readVarint()}}function ioe(u,o){if(o.length!==4)throw new Error(`Expected data of dimension 4 but got ${o.length}.`);let l=o[3];for(let d=2;d>=1;d--){const p=d===1?1:0,y=d===2?1:0;for(let _=0;_<o[0];_++){const S=o[1]*_;for(let P=p;P<o[1];P++){const I=o[2]*(P+S);for(let k=y;k<o[2];k++){const D=o[3]*(k+I);for(let N=0;N<o[3];N++){const W=D+N;u[W]+=u[W-l]}}}}l*=o[d]}return u}function ooe(u){for(let o=0,l=u.length;o<l;o++)u[o]=u[o]>>>1^-(1&u[o]);return u}function aoe(u,o){switch(o){case"uint32":return u;case"uint16":for(let l=0;l<u.length;l+=2){const d=u[l],p=u[l+1];u[l]=(240&d)>>4|(61440&d)>>8|(240&p)<<4|61440&p,u[l+1]=15&d|(3840&d)>>4|(15&p)<<8|(3840&p)<<4}return u;case"uint8":for(let l=0;l<u.length;l+=4){const d=u[l],p=u[l+1],y=u[l+2],_=u[l+3];u[l+0]=(192&d)>>6|(192&p)>>4|(192&y)>>2|192&_,u[l+1]=(48&d)>>4|(48&p)>>2|48&y|(48&_)<<2,u[l+2]=(12&d)>>2|12&p|(12&y)<<2|(12&_)<<4,u[l+3]=3&d|(3&p)<<2|(3&y)<<4|(3&_)<<6}return u;default:throw new Error(`Invalid pixel format, "${o}"`)}}Zt($T,"DEMData"),Zt(t$,"DemMinMaxQuadTree",{omit:["dem"]});var al=Uint8Array,Cx=Uint16Array,soe=Int32Array,r$=new al([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i$=new al([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),loe=new al([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o$=function(u,o){for(var l=new Cx(31),d=0;d<31;++d)l[d]=o+=1<<u[d-1];var p=new soe(l[30]);for(d=1;d<30;++d)for(var y=l[d];y<l[d+1];++y)p[y]=y-l[d]<<5|d;return{b:l,r:p}},a$=o$(r$,2),s$=a$.b,coe=a$.r;s$[28]=258,coe[258]=28;for(var uoe=o$(i$,0).b,l$=new Cx(32768),so=0;so<32768;++so){var gy=(43690&so)>>1|(21845&so)<<1;l$[so]=((65280&(gy=(61680&(gy=(52428&gy)>>2|(13107&gy)<<2))>>4|(3855&gy)<<4))>>8|(255&gy)<<8)>>1}var Ix=function(u,o,l){for(var d=u.length,p=0,y=new Cx(o);p<d;++p)u[p]&&++y[u[p]-1];var _,S=new Cx(o);for(p=1;p<o;++p)S[p]=S[p-1]+y[p-1]<<1;_=new Cx(1<<o);var P=15-o;for(p=0;p<d;++p)if(u[p])for(var I=p<<4|u[p],k=o-u[p],D=S[u[p]-1]++<<k,N=D|(1<<k)-1;D<=N;++D)_[l$[D]>>P]=I;return _},Mx=new al(288);for(so=0;so<144;++so)Mx[so]=8;for(so=144;so<256;++so)Mx[so]=9;for(so=256;so<280;++so)Mx[so]=7;for(so=280;so<288;++so)Mx[so]=8;var c$=new al(32);for(so=0;so<32;++so)c$[so]=5;var hoe=Ix(Mx,9),doe=Ix(c$,5),YM=function(u){for(var o=u[0],l=1;l<u.length;++l)u[l]>o&&(o=u[l]);return o},uc=function(u,o,l){var d=o/8|0;return(u[d]|u[d+1]<<8)>>(7&o)&l},JM=function(u,o){var l=o/8|0;return(u[l]|u[l+1]<<8|u[l+2]<<16)>>(7&o)},foe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],hc=function(u,o,l){var d=new Error(o||foe[u]);if(d.code=u,Error.captureStackTrace&&Error.captureStackTrace(d,hc),!l)throw d;return d},poe=new al(0),moe=typeof TextDecoder<"u"&&new TextDecoder;try{moe.decode(poe,{stream:!0})}catch{}const goe={gzip_data:"gzip"};class Il extends Error{constructor(o){super(o),this.name="MRTError"}}const yoe={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},u$={uint32:1,uint16:2,uint8:4},_oe={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let QM;class UT{constructor(o=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=o}getLayer(o){const l=this.layers[o];if(!l)throw new Il(`Layer '${o}' not found`);return l}getHeaderLength(o){const l=new Uint8Array(o),d=new DataView(o);if(l[0]!==13)throw new Il("File is not a valid MRT.");return d.getUint32(1,!0)}parseHeader(o){const l=new Uint8Array(o),d=this.getHeaderLength(o);if(l.length<d)throw new Il(`Expected header with length >= ${d} but got buffer of length ${l.length}`);const p=function(y,_){return y.readFields(Kie,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new QM(l.subarray(0,d)));if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new Il(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const y of p.layers)this.layers[y.name]=new h$(y,{cacheSize:this._cacheSize});return this}createDecodingTask(o){const l=[],d=this.getLayer(o.layerName);for(let p of o.blockIndices){const y=d.dataIndex[p],_=y.firstByte-o.firstByte,S=y.lastByte-o.firstByte;if(d._blocksInProgress.has(p))continue;const P={layerName:d.name,firstByte:_,lastByte:S,pixelFormat:d.pixelFormat,blockIndex:p,blockShape:[y.bands.length].concat(d.bandShape),buffer:d.buffer,codec:y.codec.codec,filters:y.filters.map(I=>I.filter)};d._blocksInProgress.add(p),l.push(P)}return new d$(l,()=>{l.forEach(p=>d._blocksInProgress.delete(p.blockIndex))},(p,y)=>{if(l.forEach(_=>d._blocksInProgress.delete(_.blockIndex)),p)throw p;y.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class h${constructor({version:o,name:l,units:d,tileSize:p,pixelFormat:y,buffer:_,dataIndex:S},P){if(this.version=o,this.version!==1)throw new Il(`Cannot parse raster layer encoded with MRT version ${o}`);this.name=l,this.units=d,this.tileSize=p,this.buffer=_,this.pixelFormat=yoe[y],this.dataIndex=S,this.bandShape=[p+2*_,p+2*_,u$[this.pixelFormat]],this._decodedBlocks=new jT(P?P.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return u$[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:o})=>o).flat()}processDecodedData(o){const l=o.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,o.data)}getBlockForBand(o){let l=0;switch(typeof o){case"string":for(const[d,p]of this.dataIndex.entries()){for(const[y,_]of p.bands.entries())if(_===o)return{bandIndex:l+y,blockIndex:d,blockBandIndex:y};l+=p.bands.length}break;case"number":for(const[d,p]of this.dataIndex.entries()){if(o>=l&&o<l+p.bands.length)return{bandIndex:o,blockIndex:d,blockBandIndex:o-l};l+=p.bands.length}break;default:throw new Il(`Invalid band \`${JSON.stringify(o)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(o){let l=1/0,d=-1/0;const p=[],y=new Set;for(const _ of o){const{blockIndex:S}=this.getBlockForBand(_);if(S<0)throw new Il(`Invalid band: ${JSON.stringify(_)}`);const P=this.dataIndex[S];p.includes(S)||p.push(S),y.add(S),l=Math.min(l,P.firstByte),d=Math.max(d,P.lastByte)}if(y.size>this.cacheSize)throw new Il(`Number of blocks to decode (${y.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:d,blockIndices:p}}hasBand(o){const{blockIndex:l}=this.getBlockForBand(o);return l>=0}hasDataForBand(o){const{blockIndex:l}=this.getBlockForBand(o);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(o){const{blockIndex:l,blockBandIndex:d}=this.getBlockForBand(o);if(l<0)throw new Il(`Band not found: ${JSON.stringify(o)}`);const p=this._decodedBlocks.get(l.toString());if(!p)throw new Il(`Data for band ${JSON.stringify(o)} of layer "${this.name}" not decoded.`);const y=this.dataIndex[l],_=this.bandShape.reduce((I,k)=>I*k,1),S=d*_,P=p.subarray(S,S+_);return{data:P,bytes:new Uint8Array(P.buffer).subarray(P.byteOffset,P.byteOffset+P.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:y.offset,scale:y.scale}}}UT.setPbf=function(u){QM=u};class d${constructor(o,l,d){this.tasks=o,this._onCancel=l,this._onComplete=d,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(o,l){this._finalized||(this._onComplete(o,l),this._finalized=!0)}}UT.performDecoding=function(u,o){const l=new Uint8Array(u);return Promise.all(o.tasks.map(d=>{const{layerName:p,firstByte:y,lastByte:_,pixelFormat:S,blockShape:P,blockIndex:I,filters:k,codec:D}=d,N=l.subarray(y,_+1),W=new Uint32Array(P[0]*P[1]*P[2]);let q;if(D!=="gzip_data")throw new Il(`Unhandled codec: ${D}`);return q=function(J,ie){if(!globalThis.DecompressionStream&&ie==="gzip_data")return Promise.resolve(((Q=function(ve){ve[0]==31&&ve[1]==139&&ve[2]==8||hc(6,"invalid gzip data");var Ie=ve[3],De=10;4&Ie&&(De+=2+(ve[10]|ve[11]<<8));for(var Fe=(Ie>>3&1)+(Ie>>4&1);Fe>0;Fe-=!ve[De++]);return De+(2&Ie)}(de=J))+8>de.length&&hc(6,"invalid gzip data"),function(ve,Ie,De,Fe){var He=ve.length;if(!He||Ie.f&&!Ie.l)return De||new al(0);var ct=!De,St=ct||Ie.i!=2,_t=Ie.i;ct&&(De=new al(3*He));var bt,Pt,st=function(zi){var ci=De.length;if(zi>ci){var Yr=new al(Math.max(2*ci,zi));Yr.set(De),De=Yr}},xt=Ie.f||0,nt=Ie.p||0,lt=Ie.b||0,It=Ie.l,Mt=Ie.d,on=Ie.m,Kt=Ie.n,$t=8*He;do{if(!It){xt=uc(ve,nt,1);var Ct=uc(ve,nt+1,3);if(nt+=3,!Ct){var kn=ve[(ge=4+((nt+7)/8|0))-4]|ve[ge-3]<<8,en=ge+kn;if(en>He){_t&&hc(0);break}St&&st(lt+kn),De.set(ve.subarray(ge,en),lt),Ie.b=lt+=kn,Ie.p=nt=8*en,Ie.f=xt;continue}if(Ct==1)It=hoe,Mt=doe,on=9,Kt=5;else if(Ct==2){var tn=uc(ve,nt,31)+257,Pn=uc(ve,nt+10,15)+4,Bn=tn+uc(ve,nt+5,31)+1;nt+=14;for(var $n=new al(Bn),Jn=new al(19),Hn=0;Hn<Pn;++Hn)Jn[loe[Hn]]=uc(ve,nt+3*Hn,7);nt+=3*Pn;var Gn=YM(Jn),Ur=(1<<Gn)-1,ii=Ix(Jn,Gn);for(Hn=0;Hn<Bn;){var ge,xe=ii[uc(ve,nt,Ur)];if(nt+=15&xe,(ge=xe>>4)<16)$n[Hn++]=ge;else{var ut=0,Lt=0;for(ge==16?(Lt=3+uc(ve,nt,3),nt+=2,ut=$n[Hn-1]):ge==17?(Lt=3+uc(ve,nt,7),nt+=3):ge==18&&(Lt=11+uc(ve,nt,127),nt+=7);Lt--;)$n[Hn++]=ut}}var Gt=$n.subarray(0,tn),Ut=$n.subarray(tn);on=YM(Gt),Kt=YM(Ut),It=Ix(Gt,on),Mt=Ix(Ut,Kt)}else hc(1);if(nt>$t){_t&&hc(0);break}}St&&st(lt+131072);for(var nn=(1<<on)-1,An=(1<<Kt)-1,or=nt;;or=nt){var ar=(ut=It[JM(ve,nt)&nn])>>4;if((nt+=15&ut)>$t){_t&&hc(0);break}if(ut||hc(2),ar<256)De[lt++]=ar;else{if(ar==256){or=nt,It=null;break}var Wn=ar-254;ar>264&&(Wn=uc(ve,nt,(1<<(sr=r$[Hn=ar-257]))-1)+s$[Hn],nt+=sr);var Rr=Mt[JM(ve,nt)&An],Kr=Rr>>4;if(Rr||hc(3),nt+=15&Rr,Ut=uoe[Kr],Kr>3){var sr=i$[Kr];Ut+=JM(ve,nt)&(1<<sr)-1,nt+=sr}if(nt>$t){_t&&hc(0);break}St&&st(lt+131072);var Ei=lt+Wn;if(lt<Ut){var oi=0-Ut,Mr=Math.min(Ut,Ei);for(oi+lt<0&&hc(3);lt<Mr;++lt)De[lt]=(void 0)[oi+lt]}for(;lt<Ei;++lt)De[lt]=De[lt-Ut]}}Ie.l=It,Ie.p=or,Ie.b=lt,Ie.f=xt,It&&(xt=1,Ie.m=on,Ie.d=Mt,Ie.n=Kt)}while(!xt);return lt!=De.length&&ct?(bt=De,((Pt=lt)==null||Pt>bt.length)&&(Pt=bt.length),new al(bt.subarray(0,Pt))):De.subarray(0,lt)}(de.subarray(Q,-8),{i:2},new al(((ae=de)[(me=ae.length)-4]|ae[me-3]<<8|ae[me-2]<<16|ae[me-1]<<24)>>>0))));var ae,me,de,Q;const ue=goe[ie];if(!ue)throw new Error(`Unhandled codec: ${ie}`);const pe=new globalThis.DecompressionStream(ue);return new Response(new Blob([J]).stream().pipeThrough(pe)).arrayBuffer().then(ve=>new Uint8Array(ve))}(N,D).then(J=>(function(ie,ae){ie.readFields(noe,ae)}(new QM(J),W),new _oe[S](W.buffer))),q.then(J=>{for(let ie=k.length-1;ie>=0;ie--)switch(k[ie]){case"delta_filter":ioe(J,P);break;case"zigzag_filter":ooe(J);break;case"bitshuffle_filter":aoe(J,S);break;default:throw new Il(`Unhandled filter "${k[ie]}"`)}return{layerName:p,blockIndex:I,data:J}}).catch(J=>{throw J})}))},Zt(d$,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Zt(UT,"MapboxRasterTile"),Zt(h$,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let Ox,eO,dc,yy,tO,_y=null;function f$(){return ni(self)&&self.worker.dracoUrl?self.worker.dracoUrl:eO||Vo.DRACO_URL}function p$(){if(ni(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(yy)return yy;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return yy=WebAssembly.validate(u)?Vo.MESHOPT_SIMD_URL:Vo.MESHOPT_URL,yy}const VT={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},voe={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},kx={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function m$(u,o,l){const d=l.json.bufferViews.length,p=l.buffers.length;o.bufferView=d,l.json.bufferViews[d]={buffer:p,byteLength:u.byteLength},l.buffers[p]=u}const nO="KHR_draco_mesh_compression";function xoe(u,o){const l=u.extensions&&u.extensions[nO];if(!l)return;const d=new dc.Decoder,p=v$(o,l.bufferView),y=new dc.Mesh;if(!d.DecodeArrayToMesh(p,p.byteLength,y))throw new Error("Failed to decode Draco mesh");const _=o.json.accessors[u.indices],S=VT[_.componentType],P=_.count*S.BYTES_PER_ELEMENT,I=dc._malloc(P);S===Uint16Array?d.GetTrianglesUInt16Array(y,P,I):d.GetTrianglesUInt32Array(y,P,I),m$(dc.memory.buffer.slice(I,I+P),_,o),dc._free(I);for(const k of Object.keys(l.attributes)){const D=d.GetAttributeByUniqueId(y,l.attributes[k]),N=o.json.accessors[u.attributes[k]],W=voe[N.componentType],q=N.count*kx[N.type]*VT[N.componentType].BYTES_PER_ELEMENT,J=dc._malloc(q);d.GetAttributeDataArrayForAllPoints(y,D,dc[W],q,J),m$(dc.memory.buffer.slice(J,J+q),N,o),dc._free(J)}d.destroy(),y.destroy(),delete u.extensions[nO]}const GT="EXT_meshopt_compression";function boe(u,o){if(!u.extensions||!u.extensions[GT])return;const l=u.extensions[GT],d=new Uint8Array(o.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),p=new Uint8Array(l.count*l.byteStride);tO.decodeGltfBuffer(p,l.count,l.byteStride,d,l.mode,l.filter),u.buffer=o.buffers.length,u.byteOffset=0,o.buffers[u.buffer]=p.buffer,delete u.extensions[GT]}const g$=1179937895,y$=new TextDecoder("utf8");function _$(u,o){return new URL(u,o).href}function woe(u,o,l,d){return fetch(_$(u.uri,d)).then(p=>p.arrayBuffer()).then(p=>{o.buffers[l]=p})}function v$(u,o){const l=u.json.bufferViews[o];return new Uint8Array(u.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function Soe(u,o,l,d){if(u.uri){const p=_$(u.uri,d);return fetch(p).then(y=>y.blob()).then(y=>createImageBitmap(y)).then(y=>{o.images[l]=y})}if(u.bufferView!==void 0){const p=v$(o,u.bufferView),y=new Blob([p],{type:u.mimeType});return createImageBitmap(y).then(_=>{o.images[l]=_})}}function x$(u,o=0,l){const d={json:null,images:[],buffers:[]};if(new Uint32Array(u,o,1)[0]===g$){const k=new Uint32Array(u,o);let D=2;const N=(k[D++]>>2)-3,W=k[D++]>>2;if(D++,d.json=JSON.parse(y$.decode(k.subarray(D,D+W))),D+=W,D<N){const q=k[D++];D++;const J=o+(D<<2);d.buffers[0]=u.slice(J,J+q)}}else d.json=JSON.parse(y$.decode(new Uint8Array(u,o)));const{buffers:p,images:y,meshes:_,extensionsUsed:S,bufferViews:P}=d.json;let I=Promise.resolve();if(p){const k=[];for(let D=0;D<p.length;D++){const N=p[D];N.uri?k.push(woe(N,d,D,l)):d.buffers[D]||(d.buffers[D]=null)}I=Promise.all(k)}return I.then(()=>{const k=[],D=S&&S.includes(nO),N=S&&S.includes(GT);if(D&&k.push(function(){if(!dc)return Ox??(Ox=function(W){let q,J=null;function ie(){q=new Uint8Array(J.buffer)}function ae(){throw new Error("Unexpected Draco error.")}const me={a:{a:ae,d:function(de,Q,ue){return q.copyWithin(de,Q,Q+ue)},c:function(de){const Q=q.length,ue=Math.max(de>>>0,Math.ceil(1.2*Q)),pe=Math.ceil((ue-Q)/65536);try{return J.grow(pe),ie(),!0}catch{return!1}},b:ae}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(W,me):W.then(de=>de.arrayBuffer()).then(de=>WebAssembly.instantiate(de,me))).then(de=>{const{Rb:Q,Qb:ue,P:pe,T:ve,X:Ie,Ja:De,La:Fe,Qa:He,Va:ct,Wa:St,eb:_t,jb:bt,f:Pt,e:st,yb:xt,zb:nt,Ab:lt,Bb:It,Db:Mt,Gb:on}=de.instance.exports;J=st;const Kt=(()=>{let $t=0,Ct=0,kn=0,en=0;return tn=>{kn&&(Q(en),Q($t),Ct+=kn,kn=$t=0),$t||(Ct+=128,$t=ue(Ct));const Pn=tn.length+7&-8;let Bn=$t;Pn>=Ct&&(kn=Pn,Bn=en=ue(Pn));for(let $n=0;$n<tn.length;$n++)q[Bn+$n]=tn[$n];return Bn}})();return ie(),Pt(),{memory:st,_free:Q,_malloc:ue,Mesh:class{constructor(){this.ptr=pe()}destroy(){ve(this.ptr)}},Decoder:class{constructor(){this.ptr=De()}destroy(){bt(this.ptr)}DecodeArrayToMesh($t,Ct,kn){const en=Kt($t),tn=Fe(this.ptr,en,Ct,kn.ptr);return!!Ie(tn)}GetAttributeByUniqueId($t,Ct){return{ptr:He(this.ptr,$t.ptr,Ct)}}GetTrianglesUInt16Array($t,Ct,kn){ct(this.ptr,$t.ptr,Ct,kn)}GetTrianglesUInt32Array($t,Ct,kn){St(this.ptr,$t.ptr,Ct,kn)}GetAttributeDataArrayForAllPoints($t,Ct,kn,en,tn){_t(this.ptr,$t.ptr,Ct.ptr,kn,en,tn)}},DT_INT8:xt(),DT_UINT8:nt(),DT_INT16:lt(),DT_UINT16:It(),DT_UINT32:Mt(),DT_FLOAT32:on()}})}(fetch(f$())),Ox.then(W=>{dc=W,Ox=void 0}))}()),N&&k.push(function(){if(tO)return;const W=function(q){let J;const ie=WebAssembly.instantiateStreaming(q,{}).then(de=>{J=de.instance,J.exports.__wasm_call_ctors()}),ae={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},me={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ie,supported:!0,decodeGltfBuffer(de,Q,ue,pe,ve,Ie){(function(De,Fe,He,ct,St,_t,bt){const Pt=De.exports.sbrk,st=ct+3&-4,xt=Pt(st*St),nt=Pt(_t.length),lt=new Uint8Array(De.exports.memory.buffer);lt.set(_t,nt);const It=Fe(xt,ct,St,nt,_t.length);if(It===0&&bt&&bt(xt,st,St),He.set(lt.subarray(xt,xt+ct*St)),Pt(xt-Pt(0)),It!==0)throw new Error(`Malformed buffer data: ${It}`)})(J,J.exports[me[ve]],de,Q,ue,pe,J.exports[ae[Ie]])}}}(fetch(p$()));return W.ready.then(()=>{tO=W})}()),y)for(let W=0;W<y.length;W++)k.push(Soe(y[W],d,W,l));return(k.length?Promise.all(k):Promise.resolve()).then(()=>{if(D&&_)for(const{primitives:W}of _)for(const q of W)xoe(q,d);if(N&&_&&P)for(const W of P)boe(W,d);return d})})}function Xp(u,o){const l=u.json.bufferViews[o.bufferView],d=VT[o.componentType];return new d(u.buffers[l.buffer],(o.byteOffset||0)+(l.byteOffset||0),o.count*(l.byteStride&&l.byteStride!==kx[o.type]*d.BYTES_PER_ELEMENT?l.byteStride/d.BYTES_PER_ELEMENT:kx[o.type]))}function rO(u,o,l,d){const p=VT[o.componentType],y=function(k){switch(k){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),_=u.json.bufferViews[o.bufferView],S=_.byteStride?_.byteStride/p.BYTES_PER_ELEMENT:kx[o.type],P=l.float32,I=P.length/l.capacity;for(let k=0,D=0;k<o.count*S;k+=S,D+=I)for(let N=0;N<I;N++)P[D+N]=d[k+N]*y;l._trim()}function Toe(u,o,l){const d=u.indices,p=u.attributes,y={};y.indexArray=new bo;const _=o.json.accessors[d],S=_.count/3;y.indexArray.reserve(S);const P=Xp(o,_);for(let N=0;N<S;N++)y.indexArray.emplaceBack(P[3*N],P[3*N+1],P[3*N+2]);y.indexArray._trim(),y.vertexArray=new Tl;const I=o.json.accessors[p.POSITION];y.vertexArray.reserve(I.count);const k=Xp(o,I);for(let N=0;N<I.count;N++)y.vertexArray.emplaceBack(k[3*N],k[3*N+1],k[3*N+2]);if(y.vertexArray._trim(),y.aabb=new mi(I.min,I.max),y.centroid=function(N,W){const q=[0,0,0],J=N.length;if(J>0){for(let ie=0;ie<J;ie++){const ae=3*N[ie];q[0]+=W[ae],q[1]+=W[ae+1],q[2]+=W[ae+2]}q[0]/=J,q[1]/=J,q[2]/=J}return q}(P,k),p.COLOR_0!==void 0){const N=o.json.accessors[p.COLOR_0],W=kx[N.type],q=Xp(o,N);y.colorArray=W===3?new Tl:new El,y.colorArray.resize(N.count),rO(o,N,y.colorArray,q)}if(p.NORMAL!==void 0){y.normalArray=new Tl;const N=o.json.accessors[p.NORMAL];y.normalArray.resize(N.count);const W=Xp(o,N);rO(o,N,y.normalArray,W)}if(p.TEXCOORD_0!==void 0&&l.length>0){y.texcoordArray=new rh;const N=o.json.accessors[p.TEXCOORD_0];y.texcoordArray.resize(N.count);const W=Xp(o,N);rO(o,N,y.texcoordArray,W)}if(p._FEATURE_ID_RGBA4444!==void 0){const N=o.json.accessors[p._FEATURE_ID_RGBA4444];o.json.extensionsUsed&&o.json.extensionsUsed.includes("EXT_meshopt_compression")&&(y.featureData=Xp(o,N))}p._FEATURE_RGBA4444!==void 0&&(y.featureData=new Uint32Array(Xp(o,o.json.accessors[p._FEATURE_RGBA4444]).buffer));const D=u.material;return y.material=function(N,W){const{emissiveFactor:q=[0,0,0],alphaMode:J="OPAQUE",alphaCutoff:ie=.5,normalTexture:ae,occlusionTexture:me,emissiveTexture:de,doubleSided:Q}=N,{baseColorFactor:ue=[1,1,1,1],metallicFactor:pe=1,roughnessFactor:ve=1,baseColorTexture:Ie,metallicRoughnessTexture:De}=N.pbrMetallicRoughness||{},Fe=me?W[me.index]:void 0;if(me&&me.extensions&&me.extensions.KHR_texture_transform&&Fe){const He=me.extensions.KHR_texture_transform;Fe.offsetScale=[He.offset[0],He.offset[1],He.scale[0],He.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new wr(...ue),metallicFactor:pe,roughnessFactor:ve,baseColorTexture:Ie?W[Ie.index]:void 0,metallicRoughnessTexture:De?W[De.index]:void 0},doubleSided:Q,emissiveFactor:q,alphaMode:J,alphaCutoff:ie,normalTexture:ae?W[ae.index]:void 0,occlusionTexture:Fe,emissionTexture:de?W[de.index]:void 0,defined:N.defined===void 0}}(D!==void 0?o.json.materials[D]:{defined:!1},l),y}function b$(u,o,l){const{matrix:d,rotation:p,translation:y,scale:_,mesh:S,extras:P,children:I}=u,k={};if(k.matrix=d||function(D,N,W,q){var J=N[0],ie=N[1],ae=N[2],me=N[3],de=J+J,Q=ie+ie,ue=ae+ae,pe=J*de,ve=J*Q,Ie=J*ue,De=ie*Q,Fe=ie*ue,He=ae*ue,ct=me*de,St=me*Q,_t=me*ue,bt=q[0],Pt=q[1],st=q[2];return D[0]=(1-(De+He))*bt,D[1]=(ve+_t)*bt,D[2]=(Ie-St)*bt,D[3]=0,D[4]=(ve-_t)*Pt,D[5]=(1-(pe+He))*Pt,D[6]=(Fe+ct)*Pt,D[7]=0,D[8]=(Ie+St)*st,D[9]=(Fe-ct)*st,D[10]=(1-(pe+De))*st,D[11]=0,D[12]=W[0],D[13]=W[1],D[14]=W[2],D[15]=1,D}([],p||[0,0,0,1],y||[0,0,0],_||[1,1,1]),S!==void 0){k.meshes=l[S];const D=k.anchor=[0,0];for(const N of k.meshes){const{min:W,max:q}=N.aabb;D[0]+=W[0]+q[0],D[1]+=W[1]+q[1]}D[0]=Math.floor(D[0]/k.meshes.length/2),D[1]=Math.floor(D[1]/k.meshes.length/2)}if(P&&(P.id&&(k.id=P.id),P.lights&&(k.lights=function(D){if(!D.length)return[];const N=function(ae){const me=atob(ae),de=new Uint8Array(me.length);for(let Q=0;Q<me.length;Q++)de[Q]=me.codePointAt(Q);return de}(D),W=[],q=N.length/24,J=new Uint16Array(N.buffer),ie=new Float32Array(N.buffer);for(let ae=0;ae<q;ae++){const me=J[2*ae*6]/30,de=J[2*ae*6+1]/30,Q=J[2*ae*6+10]/100,ue=ie[6*ae+1],pe=ie[6*ae+2],ve=ie[6*ae+3],Ie=ie[6*ae+4],De=ve-ue,Fe=Ie-pe,He=Math.hypot(De,Fe);W.push({pos:[ue+.5*De,pe+.5*Fe,de],normal:[Fe/He,-De/He,0],width:He,height:me,depth:Q,points:[ue,pe,ve,Ie]})}return W}(P.lights))),I){const D=[];for(const N of I)D.push(b$(o.json.nodes[N],o,l));k.children=D}return k}function Eoe(u){if(u.vertices.length===0||u.indices.length===0)return null;const o=new sM(u.vertices,u.indices,8,256),[l,d]=[o.min.clone(),o.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:o,min:l,max:d}}function Aoe(u){if(!u.extras||!u.extras.ground)return null;const o=u.extras.ground;if(!o||!Array.isArray(o)||o.length===0)return null;const l=o[0];if(!l||!Array.isArray(l)||l.length===0)return null;const d=[];for(const _ of l){if(!Array.isArray(_)||_.length!==2)continue;const S=_[0],P=_[1];typeof S=="number"&&typeof P=="number"&&d.push(new yt(S,P))}if(d.length<3)return null;d.length>1&&d[d.length-1].equals(d[0])&&d.pop();let p=0;for(let _=0;_<d.length;_++){const S=d[_],P=d[(_+1)%d.length],I=d[(_+2)%d.length];p+=(S.x-P.x)*(I.y-P.y)-(I.x-P.x)*(S.y-P.y)}p>0&&d.reverse();const y=tx(d.flatMap(_=>[_.x,_.y]),[]);return y.length===0?null:{vertices:d,indices:y}}function Poe(u,o){const l=[],d=[];let p=0;const y=[];for(const _ of u){p=l.length;const S=_.vertexArray.float32,P=_.indexArray.uint16;for(let I=0;I<_.vertexArray.length;I++)y[0]=S[3*I+0],y[1]=S[3*I+1],y[2]=S[3*I+2],Nt(y,y,o),l.push(new yt(y[0],y[1]));for(let I=0;I<3*_.indexArray.length;I++)d.push(P[I]+p)}if(d.length%3!=0)return null;for(let _=0;_<d.length;_+=3){const S=l[d[_+0]],P=l[d[_+1]],I=l[d[_+2]];(S.x-P.x)*(I.y-P.y)-(I.x-P.x)*(S.y-P.y)>0&&([d[_+1],d[_+2]]=[d[_+2],d[_+1]])}return{vertices:l,indices:d}}function w$(u){const o=function(P,I){const k=[],D=WebGL2RenderingContext;if(P.json.textures)for(const N of P.json.textures){const W={magFilter:D.LINEAR,minFilter:D.NEAREST,wrapS:D.REPEAT,wrapT:D.REPEAT};N.sampler!==void 0&&Object.assign(W,P.json.samplers[N.sampler]),k.push({image:I[N.source],sampler:W,uploaded:!1})}return k}(u,u.images),l=function(P,I){const k=[];for(const D of P.json.meshes){const N=[];for(const W of D.primitives)N.push(Toe(W,P,I));k.push(N)}return k}(u,o),{scenes:d,scene:p,nodes:y}=u.json,_=d?d[p||0].nodes:y,S=[];for(const P of _)S.push(b$(y[P],u,l));return function(P,I,k){const D={},N=new Set;for(let W=0;W<P.length;W++){const q=k[I[W]];if(!q.extras)continue;const J=q.extras["mapbox:footprint:version"],ie=q.extras["mapbox:footprint:id"];(J||ie)&&N.add(W),J==="1.0.0"&&ie&&(D[ie]=W)}for(let W=0;W<P.length;W++){if(N.has(W))continue;const q=P[W],J=k[I[W]];if(!J.extras)continue;let ie=null;q.id in D&&(ie=Poe(P[D[q.id]].meshes,q.matrix)),ie||(ie=Aoe(J)),ie&&(q.footprint=Eoe(ie))}if(N.size>0){const W=Array.from(N.values()).sort((q,J)=>q-J);for(let q=W.length-1;q>=0;q--)P.splice(W[q],1)}}(S,_,u.json.nodes),S}function Coe(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const o=u.vertexArray.float32,l=u.aabb.min[0]-1,d=u.aabb.min[1]-1,p=Hp/(u.aabb.max[0]-l+2),y=Hp/(u.aabb.max[1]-d+2);for(let _=0;_<o.length;_+=3){const S=o[_+2],P=(o[_+0]-l)*p|0,I=(o[_+1]-d)*y|0;S>u.heightmap[I*Hp+P]&&(u.heightmap[I*Hp+P]=S)}}function Ioe(u,o){const l={};l.indexArray=new bo,l.indexArray.reserve(4*u.length),l.vertexArray=new Tl,l.vertexArray.reserve(10*u.length),l.colorArray=new El,l.vertexArray.reserve(10*u.length);let d=0;for(const _ of u){const S=Math.min(10,Math.max(4,1.3*_.height))*o,P=[-_.normal[1],_.normal[0],0],I=Math.min(.29,.1*_.width/_.depth),k=_.width-2*_.depth*o*(I+.01),D=zt([],_.pos,P,k/2),N=zt([],_.pos,P,-k/2),W=[D[0],D[1],D[2]+_.height],q=[N[0],N[1],N[2]+_.height],J=zt([],_.normal,P,I);pt(J,J,S);const ie=zt([],_.normal,P,-I);pt(ie,ie,S),ht(J,D,J),ht(ie,N,ie),D[2]+=.1,N[2]+=.1,l.vertexArray.emplaceBack(J[0],J[1],J[2]),l.vertexArray.emplaceBack(ie[0],ie[1],ie[2]),l.vertexArray.emplaceBack(D[0],D[1],D[2]),l.vertexArray.emplaceBack(N[0],N[1],N[2]),l.vertexArray.emplaceBack(W[0],W[1],W[2]),l.vertexArray.emplaceBack(q[0],q[1],q[2]),l.vertexArray.emplaceBack(D[0],D[1],D[2]),l.vertexArray.emplaceBack(N[0],N[1],N[2]),l.vertexArray.emplaceBack(J[0],J[1],J[2]),l.vertexArray.emplaceBack(ie[0],ie[1],ie[2]);const ae=k/S/2;l.colorArray.emplaceBack(-ae-I,-1,ae,.8),l.colorArray.emplaceBack(ae+I,-1,ae,.8),l.colorArray.emplaceBack(-ae,0,ae,1.3),l.colorArray.emplaceBack(ae,0,ae,1.3),l.colorArray.emplaceBack(ae+I,-.8,ae,.7),l.colorArray.emplaceBack(ae+I,-.8,ae,.7),l.colorArray.emplaceBack(0,0,ae,1.3),l.colorArray.emplaceBack(0,0,ae,1.3),l.colorArray.emplaceBack(ae+I,-1.2,ae,.8),l.colorArray.emplaceBack(ae+I,-1.2,ae,.8),l.indexArray.emplaceBack(6+d,4+d,8+d),l.indexArray.emplaceBack(7+d,9+d,5+d),l.indexArray.emplaceBack(0+d,1+d,2+d),l.indexArray.emplaceBack(1+d,3+d,2+d),d+=10}const p={defined:!0,emissiveFactor:[0,0,0]},y={};return y.baseColorFactor=wr.white,p.pbrMetallicRoughness=y,l.material=p,l.aabb=new mi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}class S${constructor(o){this._stringToNumber={},this._numberToString=[];for(let l=0;l<o.length;l++){const d=o[l];this._stringToNumber[d]=l,this._numberToString[l]=d}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const Moe=["id","tile","layer","source","sourceLayer","state"];class vy{constructor(o,l,d,p,y){this.type="Feature",this._vectorTileFeature=o,this._z=l,this._x=d,this._y=p,this.properties=o.properties,this.id=y}clone(){const o=new vy(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(o.state=Object.assign({},this.state)),this.layer&&(o.layer=Object.assign({},this.layer)),this.source&&(o.source=this.source),this.sourceLayer&&(o.sourceLayer=this.sourceLayer),o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const l of Moe)this[l]!==void 0&&(o[l]=this[l]);return o}}class T${constructor(o,l){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new gd(jt,16,0),this.featureIndexArray=new GS,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(o,l,d,p,y,_=0,S=0){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,p,y,_);const I=this.grid;for(let k=0;k<l.length;k++){const D=l[k],N=[1/0,1/0,-1/0,-1/0];for(let W=0;W<D.length;W++){const q=D[W];N[0]=Math.min(N[0],q.x),N[1]=Math.min(N[1],q.y),N[2]=Math.max(N[2],q.x),N[3]=Math.max(N[3],q.y)}S!==0&&(N[0]-=S,N[1]-=S,N[2]+=S,N[3]+=S),N[0]<jt&&N[1]<jt&&N[2]>=0&&N[3]>=0&&I.insert(P,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Od.VectorTile(new hT(this.rawTileData)).layers,this.sourceLayerCoder=new S$(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,l){const{tilespaceGeometry:d,transform:p,tileTransform:y,pixelPosMatrix:_,availableImages:S}=l;this.loadVTLayers(),this.serializedLayersCache.clear();const P=d.bufferedTilespaceBounds,I=this.grid.query(P.min.x,P.min.y,P.max.x,P.max.y,(W,q,J,ie)=>Xi(d.bufferedTilespaceGeometry,W,q,J,ie));I.sort(Ooe);let k=null;p.elevation&&I.length>0&&(k=fy.create(p.elevation,this.tileID));const D={};let N;for(let W=0;W<I.length;W++){const q=I[W];if(q===N)continue;N=q;const J=this.featureIndexArray.get(q);let ie=null;this.is3DTile?this.loadMatchingModelFeature(D,J,o,d,p):this.loadMatchingFeature(D,J,o,S,(ae,me,de,Q=0)=>(ie||(ie=Yt(ae,this.tileID.canonical,y)),me.queryIntersectsFeature(d,ae,de,ie,this.z,p,_,k,Q)))}return D}loadMatchingFeature(o,l,d,p,y){const{featureIndex:_,bucketIndex:S,sourceLayerIndex:P,layoutVertexArrayOffset:I}=l,k=this.bucketLayerIDs[S],D=d.layers,N=Object.keys(D);if(N.length&&!function(ae,me){for(let de=0;de<ae.length;de++)if(me.indexOf(ae[de])>=0)return!0;return!1}(N,k))return;const W=d.sourceCache,q=this.sourceLayerCoder.decode(P),J=this.vtLayers[q].feature(_),ie=this.getId(J,q);for(let ae=0;ae<k.length;ae++){const me=k[ae];if(!D[me])continue;const{styleLayer:de,targets:Q}=D[me];let ue={};ie!==void 0&&(ue=W.getFeatureState(de.sourceLayer,ie));const pe=!y||y(J,de,ue,I);if(!pe)continue;const ve=new vy(J,this.z,this.x,this.y,ie);ve.tile=this.tileID.canonical,ve.state=ue;let Ie=this.serializedLayersCache.get(me);Ie||(Ie=de.serialize(),Ie.id=me,this.serializedLayersCache.set(me,Ie)),ve.source=Ie.source,ve.sourceLayer=Ie["source-layer"],ve.layer=tt({},Ie),ve.layer.paint=E$(Ie.paint,de.paint,J,ue,p),ve.layer.layout=E$(Ie.layout,de.layout,J,ue,p);let De=!1;for(const Fe of Q){this.updateFeatureProperties(ve,Fe);const{filter:He}=Fe;if(He){if(J.properties=ve.properties,He.needGeometry){const ct=an(J,!0);if(!He.filter(new zr(this.tileID.overscaledZ),ct,this.tileID.canonical))continue}else if(!He.filter(new zr(this.tileID.overscaledZ),J))continue}De=!0,Fe.targetId&&this.addFeatureVariant(ve,Fe)}De&&this.appendToResult(o,me,_,ve,pe)}}loadMatchingModelFeature(o,l,d,p,y){const _=this.bucketLayerIDs[0][0],S=d.layers;if(!S[_])return;const{styleLayer:P,targets:I}=S[_];if(P.type!=="model")return;const k=p.tile,D=l.featureIndex,N=k.getBucket(P);if(!(N&&N instanceof RT))return;const W=function(Ie,De,Fe,He){const ct=Ie.getNodesInfo()[De];if(ct.hiddenByReplacement||!ct.node.meshes)return;let St=Number.MAX_VALUE;const _t=ct.node,bt=Fe.tile,Pt=He.calculatePosMatrix(bt.tileID.toUnwrapped(),He.worldSize),st=ct.evaluatedScale;let xt=0;He.elevation&&_t.elevation&&(xt=_t.elevation*He.elevation.exaggeration()),$(Pt,Pt,[(_t.anchor?_t.anchor[0]:0)*(st[0]-1),(_t.anchor?_t.anchor[1]:0)*(st[1]-1),xt]),H(Pt,Pt,st);const nt=Fe.queryGeometry,lt=nt.isPointQuery()?nt.screenBounds:nt.screenGeometry,It=function(on){const Kt=V([],Pt,on.matrix);V(Kt,He.expandedFarZProjMatrix,Kt);for(let $t=0;$t<on.meshes.length;++$t){const Ct=on.meshes[$t];if($t===on.lightMeshIndex)continue;const kn=T4(lt,He,Kt,Ct.aabb);kn!=null&&(St=Math.min(kn,St))}if(on.children)for(const $t of on.children)It($t)};if(It(_t),St===Number.MAX_VALUE)return;const Mt=new re(0,0);return L4(bt.tileID.canonical,Mt,ct.node.anchor[0],ct.node.anchor[1]),{intersectionZ:St,position:Mt,feature:ct.feature}}(N,D,p,y);if(!W)return;const{z:q,x:J,y:ie}=k.tileID.canonical,{feature:ae,intersectionZ:me,position:de}=W;let Q={};ae.id!==void 0&&(Q=d.sourceCache.getFeatureState(P.sourceLayer,ae.id));const ue=new vy({},q,J,ie,ae.id);ue.tile=this.tileID.canonical,ue.state=Q,ue.properties=ae.properties,ue.geometry={type:"Point",coordinates:[de.lng,de.lat]};let pe=this.serializedLayersCache.get(_);pe||(pe=P.serialize(),pe.id=_,this.serializedLayersCache.set(_,pe)),ue.source=pe.source,ue.sourceLayer=pe["source-layer"],ue.layer=tt({},pe);let ve=!1;for(const Ie of I){this.updateFeatureProperties(ue,Ie);const{filter:De}=Ie;if(De){if(ae.properties=ue.properties,De.needGeometry){if(!De.filter(new zr(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!De.filter(new zr(this.tileID.overscaledZ),ae))continue}ve=!0,Ie.targetId&&this.addFeatureVariant(ue,Ie)}ve&&this.appendToResult(o,_,D,ue,me)}updateFeatureProperties(o,l,d){if(l.properties){const p={};for(const y in l.properties){const _=l.properties[y].evaluate({zoom:this.z},o._vectorTileFeature,o.state,o.tile,d);_!=null&&(p[y]=_)}o.properties=p}}addFeatureVariant(o,l,d){const p={target:l.target,namespace:l.namespace,uniqueFeatureID:l.uniqueFeatureID};l.properties&&(p.properties=o.properties),o.variants=o.variants||{},o.variants[l.targetId]=o.variants[l.targetId]||[],o.variants[l.targetId].push(p)}appendToResult(o,l,d,p,y){let _=o[l];_===void 0&&(_=o[l]=[]),_.push({featureIndex:d,feature:p,intersectionZ:y})}lookupSymbolFeatures(o,l,d,p,y){const _={};this.loadVTLayers();for(const S of o)this.loadMatchingFeature(_,{bucketIndex:l,sourceLayerIndex:d,featureIndex:S,layoutVertexArrayOffset:0},p,y);return _}loadFeature(o){const{featureIndex:l,sourceLayerIndex:d}=o;this.loadVTLayers();const p=this.sourceLayerCoder.decode(d),y=this.vtFeatures[p];if(y[l])return y[l];const _=this.vtLayers[p].feature(l);return y[l]=_,_}hasLayer(o){for(const l of this.bucketLayerIDs)for(const d of l)if(o===d)return!0;return!1}getId(o,l){let d=o.id;if(this.promoteId){const p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[l];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){const y=pd(p);if(y.result!=="success"){const _=y.value.map(S=>`${S.key}: ${S.message}`).join(", ");return void nr(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=y.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new mg),d=this.promoteIdExpression.evaluate({zoom:0},o)}else d=o.properties[p];typeof d=="boolean"&&(d=Number(d))}return d}}function E$(u,o,l,d,p){return jn(u,(y,_)=>{const S=o instanceof Ju?o.get(_):null;return S&&S.evaluate?S.evaluate(l,d,void 0,p):S})}function Ooe(u,o){return o-u}Zt(T$,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const A$=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class iO{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,d]=new Uint8Array(o,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=d>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const y=A$[15&d];if(!y)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(o,2,1),[S]=new Uint32Array(o,4,1);return new iO(S,_,y,o)}constructor(o,l=64,d=Float64Array,p){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=d,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const y=A$.indexOf(this.ArrayType),_=2*o*this.ArrayType.BYTES_PER_ELEMENT,S=o*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-S%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${d}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+S+P,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+_+S+P),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+S+P,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=o)}add(o,l){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=o,this.coords[this._pos++]=l,d}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return oO(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,l,d,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:_,nodeSize:S}=this,P=[0,y.length-1,0],I=[];for(;P.length;){const k=P.pop()||0,D=P.pop()||0,N=P.pop()||0;if(D-N<=S){for(let ie=N;ie<=D;ie++){const ae=_[2*ie],me=_[2*ie+1];ae>=o&&ae<=d&&me>=l&&me<=p&&I.push(y[ie])}continue}const W=N+D>>1,q=_[2*W],J=_[2*W+1];q>=o&&q<=d&&J>=l&&J<=p&&I.push(y[W]),(k===0?o<=q:l<=J)&&(P.push(N),P.push(W-1),P.push(1-k)),(k===0?d>=q:p>=J)&&(P.push(W+1),P.push(D),P.push(1-k))}return I}within(o,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:_}=this,S=[0,p.length-1,0],P=[],I=d*d;for(;S.length;){const k=S.pop()||0,D=S.pop()||0,N=S.pop()||0;if(D-N<=_){for(let ie=N;ie<=D;ie++)C$(y[2*ie],y[2*ie+1],o,l)<=I&&P.push(p[ie]);continue}const W=N+D>>1,q=y[2*W],J=y[2*W+1];C$(q,J,o,l)<=I&&P.push(p[W]),(k===0?o-d<=q:l-d<=J)&&(S.push(N),S.push(W-1),S.push(1-k)),(k===0?o+d>=q:l+d>=J)&&(S.push(W+1),S.push(D),S.push(1-k))}return P}}function oO(u,o,l,d,p,y){if(p-d<=l)return;const _=d+p>>1;P$(u,o,_,d,p,y),oO(u,o,l,d,_-1,1-y),oO(u,o,l,_+1,p,1-y)}function P$(u,o,l,d,p,y){for(;p>d;){if(p-d>600){const I=p-d+1,k=l-d+1,D=Math.log(I),N=.5*Math.exp(2*D/3),W=.5*Math.sqrt(D*N*(I-N)/I)*(k-I/2<0?-1:1);P$(u,o,l,Math.max(d,Math.floor(l-k*N/I+W)),Math.min(p,Math.floor(l+(I-k)*N/I+W)),y)}const _=o[2*l+y];let S=d,P=p;for(Rx(u,o,d,l),o[2*p+y]>_&&Rx(u,o,d,p);S<P;){for(Rx(u,o,S,P),S++,P--;o[2*S+y]<_;)S++;for(;o[2*P+y]>_;)P--}o[2*d+y]===_?Rx(u,o,d,P):(P++,Rx(u,o,P,p)),P<=l&&(d=P+1),l<=P&&(p=P-1)}}function Rx(u,o,l,d){aO(u,l,d),aO(o,2*l,2*d),aO(o,2*l+1,2*d+1)}function aO(u,o,l){const d=u[o];u[o]=u[l],u[l]=d}function C$(u,o,l,d){const p=u-l,y=o-d;return p*p+y*y}i.$=ea,i.A=Vc,i.B=Js,i.C=eh,i.D=py,i.E=Nu,i.F=2,i.G=px,i.H=Fj,i.I=ja,i.J=class extends OT{},i.K=Mn,i.L=sp,i.M=el,i.N=zg,i.O=Lg,i.P=yt,i.Q=A0,i.R=sg,i.S=Bg,i.T=LM,i.U=Gg,i.V=OT,i.W=wp,i.X=pd,i.Y=Sg,i.Z=cd,i._=gp,i.a=function(u){return Vo.API_CDN_URL_REGEX.test(u)},i.a$=Ht,i.a0=ap,i.a1=Wg,i.a2=Ng,i.a3=SS,i.a4=function(u){const o=u.value;let l=[];if(!o)return l;const d=Mn(o);return d!=="string"?(l=l.concat([new OT(u.key,o,`string expected, "${d}" found`)]),l):(BM(o,!0)||(l=l.concat([new OT(u.key,o,`invalid url "${o}"`)])),l)},i.a5=Ke,i.a6=MS,i.a7=Di,i.a8=Dt,i.a9=class{constructor(u){this.specification=u}possiblyEvaluate(u,o){return Xr(u.expression.evaluate(o))}interpolate(u,o,l){return{x:yn(u.x,o.x,l),y:yn(u.y,o.y,l),z:yn(u.z,o.z,l),azimuthal:yn(u.azimuthal,o.azimuthal,l),polar:yn(u.polar,o.polar,l)}}},i.aA=wt,i.aB=Fr,i.aC=vt,i.aD=Ue,i.aE=w,i.aF=function(u,o){const l={};for(let d=0;d<o.length;d++){const p=o[d];p in u&&(l[p]=u[p])}return l},i.aG=fe,i.aH=Ae,i.aI=class{constructor(u){this.entries={},this.scheduler=u}request(u,o,l,d){const p=this.entries[u]=this.entries[u]||{callbacks:[]};if(p.result){const[y,_]=p.result;return this.scheduler?this.scheduler.add(()=>{d(y,_)},o):d(y,_),()=>{}}return p.callbacks.push(d),p.cancel||(p.cancel=l((y,_)=>{p.result=[y,_];for(const S of p.callbacks)this.scheduler?this.scheduler.add(()=>{S(y,_)},o):S(y,_);setTimeout(()=>delete this.entries[u],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(y=>y!==d),p.callbacks.length||(p.cancel(),delete this.entries[u]))}}},i.aJ=function(u,o,l){const d=JSON.stringify(u.request);return u.data&&(this.deduped.entries[d]={result:[null,u.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},p=>{const y=Yh(u.request,(_,S,P,I)=>{_?p(_):S&&p(null,{vectorTile:l?void 0:new Od.VectorTile(new hT(S)),rawData:S,cacheControl:P,expires:I})});return()=>{y.cancel(),p()}},o)},i.aK=function(u){rp++,rp>Ys&&(u.getActor().send("enforceCacheSizeLimit",Ql),rp=0)},i.aL=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},i.aM=Ui,i.aN=f4,i.aO=v4,i.aP=d4,i.aQ=function(u,o){const l=document.createElement("video");l.muted=!0,l.onloadstart=function(){o(null,l)};for(let d=0;d<u.length;d++){const p=document.createElement("source");uI(u[d])||(l.crossOrigin="Anonymous"),p.src=u[d],l.appendChild(p)}return{cancel:()=>{}}},i.aR=AT,i.aS=function(u){return fetch(u).then(o=>o.arrayBuffer()).then(o=>x$(o,0,u))},i.aT=w$,i.aU=class{constructor(u,o,l,d){this.id=u,this.position=o!=null?new re(o[0],o[1]):new re(0,0),this.orientation=l??[0,0,0],this.nodes=d,this.uploaded=!1,this.aabb=new mi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,o){if(V(u.matrix,o,u.matrix),u.meshes)for(const l of u.meshes){const d=mi.applyTransformFast(l.aabb,u.matrix);this.aabb.encapsulate(d)}if(u.children)for(const l of u.children)this._applyTransformations(l,u.matrix)}computeBoundsAndApplyParent(){const u=L([]);for(const o of this.nodes)this._applyTransformations(o,u)}computeModelMatrix(u,o,l,d,p,y,_=!1){M4(this.matrix,this,u.transform,this.position,o,l,d,p,y,_)}upload(u){if(!this.uploaded){for(const o of this.nodes)$M(o,u);for(const o of this.nodes)kT(o);this.uploaded=!0}}destroy(){for(const u of this.nodes)UM(u)}},i.aV=Dn,i.aW=yx,i.aX=Me,i.aY=ke,i.aZ=th,i.a_=bo,i.aa=zr,i.ab=md,i.ac=et,i.ad=Nt,i.ae=$e,i.af=Ve,i.ag=Ju,i.ah=Id,i.ai=yn,i.aj=jt,i.ak=Yw,i.al=ne,i.am=wr,i.an=class{constructor(u){this.specification=u}possiblyEvaluate(u,o){return function([l,d]){const p=Xr([1,l,d]);return{x:p.x,y:p.y,z:p.z}}(u.expression.evaluate(o))}interpolate(u,o,l){return{x:yn(u.x,o.x,l),y:yn(u.y,o.y,l),z:yn(u.z,o.z,l)}}},i.ao=function(u,o,l=0,d=!0){const p=new yt(l,l),y=u.sub(p),_=o.add(p),S=[y,new yt(_.x,y.y),_,new yt(y.x,_.y)];return d&&S.push(y.clone()),S},i.ap=function(u,o){const l=[];for(let d=0;d<u.length;d++){const p=rt(d-1,-1,u.length-1),y=rt(d+1,-1,u.length-1),_=u[d],S=u[y],P=u[p].sub(_).unit(),I=S.sub(_).unit(),k=I.angleWithSep(P.x,P.y),D=P.add(I).unit().mult(-1*o/Math.sin(k/2));l.push(_.add(D))}return l},i.aq=Jj,i.ar=Xi,i.as=function(u,o,l=0){return Ge(((o.x-l)*u.scale-u.x)*jt,(o.y*u.scale-u.y)*jt,Qe(o.z,o.y))},i.at=zn,i.au=fn,i.av=ol,i.aw=cj,i.ax=function(u){let o=1/0,l=1/0,d=-1/0,p=-1/0;for(const y of u)o=Math.min(o,y.x),l=Math.min(l,y.y),d=Math.max(d,y.x),p=Math.max(p,y.y);return{min:new yt(o,l),max:new yt(d,p)}},i.ay=Ee,i.az=V,i.b=function(u){return Vo.API_FONTS_REGEX.test(u)},i.b$=pt,i.b0=ey,i.b1=TT,i.b2=function(){Ps.isLoading()||Ps.isLoaded()||yd()!=="deferred"||IS()},i.b3=L0,i.b4=an,i.b5=vy,i.b6=ji,i.b7=fM,i.b8=aM,i.b9=Yt,i.bA=function(u,o){const{x:l,y:d}=u.point,p=GF(l,d,u.worldSize/u._pixelsPerMercatorPixel,0,0);return V(p,p,WI(au(o)))},i.bB=T,i.bC=function(u){return u[0]=0,u[1]=0,u[2]=0,u},i.bD=function(u,o){return Math.hypot(o[0]-u[0],o[1]-u[1],o[2]-u[2])},i.bE=Cn,i.bF=zt,i.bG=Vt,i.bH=fx,i.bI=ss,i.bJ=bM,i.bK=function(u,o,l,d,p){const y=5*o+2;u.float32[y+0]=l,u.float32[y+1]=d,u.float32[y+2]=p},i.bL=ST,i.bM=uT,i.bN=Sn,i.bO=Oo,i.bP=OB,i.bQ=E4,i.bR=zB,i.bS=NB,i.bT=EM,i.bU=Wj,i.bV=xM,i.bW=iO,i.bX=rt,i.bY=pn,i.bZ=function(u,o,l){l*=.5;var d=o[0],p=o[1],y=o[2],_=o[3],S=Math.sin(l),P=Math.cos(l);return u[0]=d*P+p*S,u[1]=p*P-d*S,u[2]=y*P+_*S,u[3]=_*P-y*S,u},i.b_=dn,i.ba=oc,i.bb=kp,i.bc=Pl,i.bd=Ti,i.be=tx,i.bf=kM,i.bg=function(u,o){const l=Id(o.zoom);if(l===0)return au(u);const d=JS(u),p=GI(d),y=Ee(d.getWest())*o.worldSize,_=Ee(d.getEast())*o.worldSize,S=Ae(d.getNorth())*o.worldSize,P=Ae(d.getSouth())*o.worldSize,I=[y,S,0],k=[_,S,0],D=[y,P,0],N=[_,P,0],W=j([],o.globeMatrix);return Nt(I,I,W),Nt(k,k,W),Nt(D,D,W),Nt(N,N,W),p[0]=ah(p[0],D,l),p[1]=ah(p[1],N,l),p[2]=ah(p[2],k,l),p[3]=ah(p[3],I,l),mi.fromPoints(p)},i.bh=eT,i.bi=j,i.bj=Q0,i.bk=ah,i.bl=Zg,i.bm=Is,i.bn=ce,i.bo=$,i.bp=UT,i.bq=hT,i.br=Yh,i.bs=function(u,o){const l=[];for(const d in u)d in o||l.push(d);return l},i.bt=ft,i.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bv=ti,i.bw=function(u){var o=new b(16);return o[0]=u[0],o[1]=u[1],o[2]=u[2],o[3]=u[3],o[4]=u[4],o[5]=u[5],o[6]=u[6],o[7]=u[7],o[8]=u[8],o[9]=u[9],o[10]=u[10],o[11]=u[11],o[12]=u[12],o[13]=u[13],o[14]=u[14],o[15]=u[15],o},i.bx=L,i.by=se,i.bz=B,i.c=Ru,i.c$=function(u){return u({pluginStatus:$a,pluginURL:eu}),Vg.on("pluginStateChange",u),u},i.c0=hi,i.c1=xo,i.c2=function(u,o){return u[0]=-o[0],u[1]=-o[1],u[2]=-o[2],u[3]=o[3],u},i.c3=ze,i.c4=function(u,o,l,d,p){var y,_=1/Math.tan(o/2);return u[0]=_/l,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=_,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,p!=null&&p!==1/0?(u[10]=(p+d)*(y=1/(d-p)),u[14]=2*p*d*y):(u[10]=-1,u[14]=-2*d),u},i.c5=function(u,o,l,d,p,y,_){var S=1/(o-l),P=1/(d-p),I=1/(y-_);return u[0]=-2*S,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*P,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*I,u[11]=0,u[12]=(o+l)*S,u[13]=(p+d)*P,u[14]=(_+y)*I,u[15]=1,u},i.c6=we,i.c7=function(u,o,l){u[4*o+0]=l[0],u[4*o+1]=l[1],u[4*o+2]=l[2],u[4*o+3]=l[3]},i.c8=zp,i.c9=tl,i.cA=IT,i.cB=Le,i.cC=x4,i.cD=function(u){const o=x4(u,!0);return T([],[o[0],o[1],o[4],o[5]])},i.cE=H,i.cF=Pd,i.cG=K,i.cH=function(u){const{x:o,y:l}=u.point,{lng:d,lat:p}=u._center;return GF(o,l,u.worldSize,d,p)},i.cI=Je,i.cJ=le,i.cK=No,i.cL=E,i.cM=function(u,o,l){let d=0;for(let p=0;p<2;++p)u[p]>0&&(d+=(u[p]-0)*(u[p]-0)),o[p]<0&&(d+=(0-o[p])*(0-o[p]));return d},i.cN=45,i.cO=dg,i.cP=Pe,i.cQ=ry,i.cR=function(u,o,l){const d=Math.sqrt(u*u+o*o+l*l),p=d>0?Math.acos(l/d)*it:0;let y=u!==0||o!==0?Math.atan2(-o,-u)*it+90:0;return y<0&&(y+=360),[d,y,p]},i.cS=Ge,i.cT=Ze,i.cU=ht,i.cV=mi,i.cW=Xr,i.cX=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},i.cY=ot,i.cZ=BM,i.c_=function(u,o){return u.readFields(Cie,{icons:[]},o)},i.ca=Lp,i.cb=Hi,i.cc=ny,i.cd=re,i.ce=r4,i.cf=function(){var u=new b(4);return b!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u},i.cg=function(u,o,l){var d=o[0],p=o[1],y=o[2],_=o[3],S=Math.sin(l),P=Math.cos(l);return u[0]=d*P+y*S,u[1]=p*P+_*S,u[2]=d*-S+y*P,u[3]=p*-S+_*P,u},i.ch=function(u,o){return u[0]===o[0]&&u[1]===o[1]&&u[2]===o[2]&&u[3]===o[3]},i.ci=kt,i.cj=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},i.ck=La,i.cl=xn,i.cm=Mo,i.cn=Bp,i.co=b4,i.cp=ri,i.cq=$F,i.cr=function(u,o,l,d,p,y,_,S,P){if(P.name==="globe")return $F(u,o,new ri(l,d,p),!1);const I=yx({z:l,x:d,y:p},P);return new mi([(y+I.x/I.scale)*o,o*(I.y/I.scale),_],[(y+I.x2/I.scale)*o,o*(I.y2/I.scale),S])},i.cs=function(u,o,l){return u[0]=Math.min(o[0],l[0]),u[1]=Math.min(o[1],l[1]),u[2]=Math.min(o[2],l[2]),u[3]=Math.min(o[3],l[3]),u},i.ct=function(u,o,l){return u[0]=Math.max(o[0],l[0]),u[1]=Math.max(o[1],l[1]),u[2]=Math.max(o[2],l[2]),u[3]=Math.max(o[3],l[3]),u},i.cu=function(u){const o=Math.round((u+45+360)%360/90)%4;return Te[o]},i.cv=qe,i.cw=Pi,i.cx=C,i.cy=function(u){const o=L(new Float64Array(16));V(o,u.pixelMatrix,u.globeMatrix);const l=[0,G,0],d=[0,U,0];return Nt(l,l,o),Nt(d,d,o),[l[0]>0&&l[0]<=u.width&&l[1]>0&&l[1]<=u.height&&!qI(u,new re(u.center.lat,90)),d[0]>0&&d[0]<=u.width&&d[1]>0&&d[1]<=u.height&&!qI(u,new re(u.center.lat,-90))]},i.cz=function(u,o){const{scale:l}=u.tileTransform,d=l*jt/(u.tileSize*Math.pow(2,o.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return function(p,y,_){var S=y[1],P=y[2],I=y[3],k=_[0],D=_[1];return p[0]=y[0]*k,p[1]=S*k,p[2]=P*D,p[3]=I*D,p}(new Float32Array(4),o.inverseAdjustmentMatrix,[d,d])},i.d=function(u){return Vo.API_TILEJSON_REGEX.test(u)},i.d$=X0,i.d0=DT,i.d1=cy,i.d2=SM,i.d3=gr,i.d4=Yu,i.d5=Fa,i.d6=Ba,i.d7=er,i.d8=function(u){const o=u.indexOf(Cp);return o>=0?u.slice(0,o):u},i.d9=function(u){return u.indexOf(Cp)>=0},i.dA=VF,i.dB=Qo,i.dC=Jo,i.dD=256,i.dE=function(u,o){const l=[0,0,0];return Nt(l,l,eT(au(o.canonical))),Nt(l,l,u),l},i.dF=u=>({u_camera_to_center_distance:new Hi(u),u_extrude_scale:new Cs(u),u_device_pixel_ratio:new Hi(u),u_matrix:new zp(u),u_inv_rot_matrix:new zp(u),u_merc_center:new tl(u),u_tile_id:new Lp(u),u_zoom_transition:new Hi(u),u_up_dir:new Lp(u),u_emissive_strength:new Hi(u)}),i.dG=u=>({u_matrix:new zp(u),u_pixels_to_tile_units:new Cs(u),u_device_pixel_ratio:new Hi(u),u_width_scale:new Hi(u),u_floor_width_scale:new Hi(u),u_units_to_pixels:new tl(u),u_dash_image:new ny(u),u_gradient_image:new ny(u),u_image_height:new Hi(u),u_texsize:new tl(u),u_tile_units_to_pixels:new Hi(u),u_alpha_discard_threshold:new Hi(u),u_trim_offset:new tl(u),u_trim_fade_range:new tl(u),u_trim_color:new ry(u),u_emissive_strength:new Hi(u),u_zbias_factor:new Hi(u),u_tile_to_meter:new Hi(u),u_ground_shadow_factor:new Lp(u)}),i.dH=u=>({u_matrix:new zp(u),u_texsize:new tl(u),u_pixels_to_tile_units:new Cs(u),u_device_pixel_ratio:new Hi(u),u_width_scale:new Hi(u),u_floor_width_scale:new Hi(u),u_image:new ny(u),u_units_to_pixels:new tl(u),u_tile_units_to_pixels:new Hi(u),u_alpha_discard_threshold:new Hi(u),u_trim_offset:new tl(u),u_trim_fade_range:new tl(u),u_trim_color:new ry(u),u_emissive_strength:new Hi(u),u_zbias_factor:new Hi(u),u_tile_to_meter:new Hi(u),u_ground_shadow_factor:new Lp(u),u_pattern_transition:new Hi(u)}),i.dI=Mp,i.dJ=Rre,i.dK=qF,i.dL=(u,o,l,d,p,y)=>{const _=u.transform,S=_.projection.name==="globe";let P;if(y.paint.get("circle-pitch-alignment")==="map")if(S){const k=VF(_.zoom,o.canonical)*_._pixelsPerMercatorPixel;P=Float32Array.from([k,0,0,k])}else P=_.calculatePixelsToTileUnitsMatrix(l);else P=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const I={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(_.projection),u_matrix:u.translatePosMatrix(o.projMatrix,l,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Xs.devicePixelRatio,u_extrude_scale:P,u_inv_rot_matrix:Cne,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:y.paint.get("circle-emissive-strength")};if(S){I.u_inv_rot_matrix=d,I.u_merc_center=p,I.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],I.u_zoom_transition=Id(_.zoom);const k=p[0]*jt,D=p[1]*jt;I.u_up_dir=_.projection.upVector(new ri(0,0,0),k,D)}return I},i.dM=fj,i.dN=Aa,i.dO=(u,o,l,d,p,y,_,S,P,I)=>{const k=u.transform,D=k.pitch<15?uj(.07,.7,Ue((14-k.zoom)/5,0,1)):.07,N=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:dj(u,o,l,d),u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:k.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:p,u_width_scale:y,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:hj(o,k),u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:S,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(N?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:Ze(o.tileID.canonical,0),u_ground_shadow_factor:P,u_pattern_transition:I}},i.dP=(u,o,l,d,p,y,_,S,P,I)=>{const k=u.transform,D=k.calculatePixelsToTileUnitsMatrix(o),N=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none",W=k.pitch<15?uj(.07,.7,Ue((14-k.zoom)/5,0,1)):.07;return{u_matrix:dj(u,o,l,d),u_pixels_to_tile_units:D,u_device_pixel_ratio:y,u_width_scale:_,u_floor_width_scale:S,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:pj(l)&&o.lineAtlasTexture?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:hj(o,u.transform),u_alpha_discard_threshold:0,u_trim_offset:P,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(N?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:W,u_tile_to_meter:Ze(o.tileID.canonical,0),u_ground_shadow_factor:I}},i.dQ=rn,i.dR=ex,i.dS=Qe,i.dT=KB,i.dU=il,i.dV=cT,i.dW=kd,i.dX=450,i.dY=7,i.dZ=die,i.d_=vr,i.da=function(u){const o=u.lastIndexOf(Cp);return o>=0?u.slice(o+1):""},i.db=function(u){const o=[],l=u.id;return l===void 0&&o.push({message:`layers.${l}: missing required property "id"`}),u.render===void 0&&o.push({message:`layers.${l}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&o.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),o},i.dc=function(u,o,l,d){return u.type==="custom"?new fie(u,o):new Tie[u.type](u,o,l,d)},i.dd=qn,i.de=function(u){const o=u.indexOf(Cp);return o>=0?u.slice(o+1):""},i.df=class extends vy{constructor(u,o){super(u._vectorTileFeature,u._z,u._x,u._y,u.id),u.state&&(this.state=Object.assign({},u.state)),this.target=o.target,this.namespace=o.namespace,o.properties&&(this.properties=o.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=u.source,this.sourceLayer=u.sourceLayer,this.layer=u.layer)}toJSON(){const u=super.toJSON();return u.target=this.target,u.namespace=this.namespace,u}},i.dg=Vg,i.dh=Kh,i.di=KS,i.dj=class extends Al{constructor(u){super(u),this.current=YS}set(u,o,l){if(this.fetchUniformLocation(u,o)){for(let d=0;d<9;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},i.dk=Oe,i.dl=function(u,o,l){const d=Id(l.zoom),p=u.style.map._antialias,y=u.terrain&&u.terrain.exaggeration()>0;return d===0&&!p&&!y},i.dm=function(u){const o=u.pixelsPerMeter,l=o/we(1,u.center.lat),d=L(new Float64Array(16));return $(d,d,[u.point.x,u.point.y,0]),H(d,d,[l,l,o]),Float32Array.from(d)},i.dn=JS,i.dp=function(u){const o=qe-5;u=Ue(u,-o,o)/o*90;const l=Math.pow(Math.abs(Math.sin(ne(u))),3);return Math.round(l*(F.length-1))},i.dq=function(u,o,l,d){const p=o.getNorth(),y=o.getSouth(),_=o.getWest(),S=o.getEast(),P=1<<u.z,I=S-_,k=p-y,D=I/z,N=-k/F[l],W=[0,D,0,N,0,0,p,_,0];if(u.z>0){const q=180/d;R(W,W,[q/I+1,0,0,0,q/k+1,0,-.5*q/D,.5*q/N,1])}return W[2]=P,W[5]=u.x,W[8]=u.y,W},i.dr=au,i.ds=function(u,o,l){const d=L(new Float64Array(16)),p=(o/(1<<u)-.5)*Math.PI*2;return Y(d,l.globeMatrix,p),Float32Array.from(d)},i.dt=class{isDataAvailableAtPoint(u){const o=this._source();if(this.isUsingMockSource()||!o||u.y<0||u.y>1)return!1;const l=o.getSource().maxzoom,d=1<<l,p=Math.floor(u.x),y=Math.floor((u.x-p)*d),_=Math.floor(u.y*d),S=this.findDEMTileFor(new Ui(l,p,l,y,_));return!(!S||!S.dem)}getAtPointOrZero(u,o=0){return this.getAtPoint(u,o)||0}getAtPoint(u,o,l=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const d=this._source();if(!d||u.y<0||u.y>1)return o;const p=d.getSource().maxzoom,y=1<<p,_=Math.floor(u.x),S=u.x-_,P=new Ui(p,_,p,Math.floor(S*y),Math.floor(u.y*y)),I=this.findDEMTileFor(P);if(!I||!I.dem)return o;const k=I.dem,D=1<<I.tileID.canonical.z,N=(S*D-I.tileID.canonical.x)*k.dim,W=(u.y*D-I.tileID.canonical.y)*k.dim,q=Math.floor(N),J=Math.floor(W);return(l?this.exaggeration():1)*yn(yn(k.get(q,J),k.get(q,J+1),W-J),yn(k.get(q+1,J),k.get(q+1,J+1),W-J),N-q)}getAtTileOffset(u,o,l){const d=1<<u.canonical.z;return this.getAtPointOrZero(new et(u.wrap+(u.canonical.x+o/jt)/d,(u.canonical.y+l/jt)/d))}getAtTileOffsetFunc(u,o,l,d){return p=>{const y=this.getAtTileOffset(u,p.x,p.y),_=d.upVector(u.canonical,p.x,p.y);return pt(_,_,y*d.upVectorScale(u.canonical,o,l).metersToTile),_}}getForTilePoints(u,o,l,d){if(this.isUsingMockSource())return!1;const p=fy.create(this,u,d);return!!p&&(o.forEach(y=>{y[2]=this.exaggeration()*p.getElevationAt(y[0],y[1],l)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(u);if(!o||!o.dem)return null;const l=o.dem.tree,d=o.tileID,p=1<<u.canonical.z-d.canonical.z;let y=u.canonical.x/p-d.canonical.x,_=u.canonical.y/p-d.canonical.y,S=0;for(let P=0;P<u.canonical.z-d.canonical.z&&!l.leaves[S];P++){y*=2,_*=2;const I=2*Math.floor(_)+Math.floor(y);S=l.childOffsets[S]+I,y%=1,_%=1}return{min:this.exaggeration()*l.minimums[S],max:this.exaggeration()*l.maximums[S]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,o,l){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let o=!1,l=Number.MAX_VALUE,d=Number.MIN_VALUE;for(const p of u){const y=this.getMinMaxForTile(p.tileID);y&&(l=Math.min(l,y.min),d=Math.max(d,y.max),o=!0)}return o?{min:l,max:d}:null}},i.du=rB,i.dv=Cd,i.dw=function(u,o){return[Math.pow(u[0],2.2)*o,Math.pow(u[1],2.2)*o,Math.pow(u[2],2.2)*o]},i.dx=A,i.dy=function(u,o){var l=Math.sin(o),d=Math.cos(o);return u[0]=d,u[1]=l,u[2]=0,u[3]=-l,u[4]=d,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},i.dz=gn,i.e=Vo,i.e$=S$,i.e0=256,i.e1=WI,i.e2=Tl,i.e3=Y,i.e4=function(u,o){return u[0]=o[0],u[1]=o[1],u[2]=o[2],u[3]=o[4],u[4]=o[5],u[5]=o[6],u[6]=o[8],u[7]=o[9],u[8]=o[10],u},i.e5=iu,i.e6=Op,i.e7=function(u,o,l,d,p){return Ue((u-o)/(l-o)*(p-d)+d,d,p)},i.e8=sn,i.e9=function(u,o){var l=o[0],d=o[1],p=o[2],y=o[3],_=o[4],S=o[5],P=o[6],I=o[7],k=o[8],D=k*_-S*I,N=-k*y+S*P,W=I*y-_*P,q=l*D+d*N+p*W;return q?(u[0]=D*(q=1/q),u[1]=(-k*d+p*I)*q,u[2]=(S*d-p*_)*q,u[3]=N*q,u[4]=(k*l-p*P)*q,u[5]=(-S*l+p*y)*q,u[6]=W*q,u[7]=(-I*l+d*P)*q,u[8]=(_*l-d*y)*q,u):null},i.eA=function(u,o,l){return u[0]=o[0]/l[0],u[1]=o[1]/l[1],u[2]=o[2]/l[2],u},i.eB=fr,i.eC=te,i.eD=un,i.eE=function(u,o,l,d){return u[0]=o,u[1]=l,u[2]=d,u},i.eF=function([u,o,l]){const d=Math.hypot(u,o,l),p=Math.atan2(u,l),y=.5*Math.PI-Math.acos(-o/d);return new re(le(p),le(y))},i.eG=Ye,i.eH=NM,i.eI=function(u){const o=u.navigator?u.navigator.userAgent:null;return!!function(l){if(Ji==null){const d=l.navigator?l.navigator.userAgent:null;Ji=!!l.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return Ji}(u)&&!(!o||!(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},i.eJ=function(u,o){Ql=u,Ys=o},i.eK=qI,i.eL=WF,i.eM=function(u){const o=[0,0,0],l=L(new Float64Array(16));return V(l,u.pixelMatrix,u.globeMatrix),Nt(o,o,l),new yt(o[0],o[1])},i.eN=function(u,o,l=!1){if($a===O0||$a===k0||$a===R0)throw new Error("setRTLTextPlugin cannot be called multiple times.");eu=Xs.resolveURL(u),$a=O0,D0=o,Ug(),l||IS()},i.eO=yd,i.eP=function(){DT().acquire(GM)},i.eQ=function(){const u=Ex;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(GM),Ex=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.eR=Zp,i.eS=function(u){const o=qv();if(!o)return;const l=o.delete(Ks);u&&l.then(()=>u()).catch(u)},i.eT=Tx,i.eU=f$,i.eV=function(u){eO=Xs.resolveURL(u),_y||(_y=new py(DT(),new Nu)),_y.broadcast("setDracoUrl",eO)},i.eW=p$,i.eX=function(u){yy=Xs.resolveURL(u),_y||(_y=new py(DT(),new Nu)),_y.broadcast("setMeshoptUrl",yy)},i.eY=Zt,i.eZ=Md,i.e_=cc,i.ea=vS,i.eb=Tn,i.ec=dt,i.ed=class{constructor(u,o,l,d){this.context=u,this.format=d,this.size=l,this.texture=u.gl.createTexture();const[p,y,_]=this.size,{gl:S}=u;S.bindTexture(S.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),S.texImage3D(S.TEXTURE_3D,0,this.format,p,y,_,0,RM(this.format),DM(this.format),o.data)}bind(u,o){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_3D,this.texture),u!==this.minFilter&&(d.texParameteri(d.TEXTURE_3D,d.TEXTURE_MAG_FILTER,u),d.texParameteri(d.TEXTURE_3D,d.TEXTURE_MIN_FILTER,u),this.minFilter=u),o!==this.wrapS&&(d.texParameteri(d.TEXTURE_3D,d.TEXTURE_WRAP_S,o),d.texParameteri(d.TEXTURE_3D,d.TEXTURE_WRAP_T,o),this.wrapS=o)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},i.ee=function(u,o){if(u===o){var l=o[1],d=o[2],p=o[3],y=o[6],_=o[7],S=o[11];u[1]=o[4],u[2]=o[8],u[3]=o[12],u[4]=l,u[6]=o[9],u[7]=o[13],u[8]=d,u[9]=y,u[11]=o[14],u[12]=p,u[13]=_,u[14]=S}else u[0]=o[0],u[1]=o[4],u[2]=o[8],u[3]=o[12],u[4]=o[1],u[5]=o[5],u[6]=o[9],u[7]=o[13],u[8]=o[2],u[9]=o[6],u[10]=o[10],u[11]=o[14],u[12]=o[3],u[13]=o[7],u[14]=o[11],u[15]=o[15];return u},i.ef=FM,i.eg=je,i.eh=[1,1,1],i.ei=function(u,o,l,d){var p=new b(4);return p[0]=u,p[1]=o,p[2]=l,p[3]=d,p},i.ej=br,i.ek=function(u,o,l,d){var p=o[0],y=o[1],_=o[2],S=o[3];return u[0]=p+d*(l[0]-p),u[1]=y+d*(l[1]-y),u[2]=_+d*(l[2]-_),u[3]=S+d*(l[3]-S),u},i.el=fy,i.em=dy,i.en=ru,i.eo=rh,i.ep=function(u,o,l,d,p,y,_,S,P,I,k,D,N,W,q,J){var ie=new b(16);return ie[0]=u,ie[1]=o,ie[2]=l,ie[3]=d,ie[4]=p,ie[5]=y,ie[6]=_,ie[7]=S,ie[8]=P,ie[9]=I,ie[10]=k,ie[11]=D,ie[12]=N,ie[13]=W,ie[14]=q,ie[15]=J,ie},i.eq=ee,i.er=Jg,i.es=q0,i.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new yt(1/0,1/0),max:new yt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,o=!1){const l=RB(new yt(0,0),new yt(jt,jt),u),d=[];if(o&&!lM(l,this._globalClipBounds))return d;for(const p of this._activeRegions){if(p.hiddenByOverlap||!lM(l,p))continue;const y=ore(p.min,p.max,u);d.push({min:y.min,max:y.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return d}setSources(u){this._setSources(u.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{const l=[];for(const d of o.cache.getVisibleCoordinates()){const p=o.cache.getTile(d).buckets[o.layer];p&&p.updateFootprints(d.toUnwrapped(),l)}return l},getOrder:()=>o.order,getClipMask:()=>o.clipMask,getClipScope:()=>o.clipScope})))}_addSource(u){const o=u.getFootprints();if(o.length===0)return;const l=u.getOrder(),d=u.getClipMask(),p=u.getClipScope();for(const y of o){if(!y.footprint)continue;const _=RB(y.footprint.min,y.footprint.max,y.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:y.id,footprint:y.footprint,order:l,clipMask:d,clipScope:p})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort((o,l)=>o.priority-l.priority||sT(o.min,l.min)||sT(o.max,l.max)||o.order-l.order||o.clipMask-l.clipMask||function(d,p){const y=(_,S)=>_+S;return d.length-p.length||d.reduce(y,"").localeCompare(p.reduce(y,""))}(o.clipScope,l.clipScope));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let o=0;for(;!u&&o!==this._activeRegions.length;){const l=this._activeRegions[o],d=this._prevRegions[o];u=l.priority!==d.priority||!kB(l,d)||l.order!==d.order||l.clipMask!==d.clipMask||!ti(l.clipScope,d.clipScope),++o}}if(u){++this._updateTime;for(const l of this._activeRegions)l.order!==aT&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));const o=l=>{const d=this._activeRegions;if(l>=d.length)return l;const p=d[l].priority;for(;l<d.length&&d[l].priority===p;)++l;return l};if(this._sourceIds.length>1){let l=0,d=o(l);for(;l!==d;){let p=l;const y=l;for(;p!==d;){const _=this._activeRegions[p];_.hiddenByOverlap=!1;for(let S=0;S<y;S++){const P=this._activeRegions[S];if(!P.hiddenByOverlap&&_.order===aT&&lM(_,P)&&(_.hiddenByOverlap=LB(_.footprint,_.tileId,P.footprint,P.tileId),_.hiddenByOverlap))break}++p}l=d,d=o(l)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=u.length-1;o>=0;o--)this._addSource(u[o]);this._computeReplacement()}},i.eu=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,o){const l=new oc,d=new bo,p=[],y=u+1+2,_=o[0]+1,S=o[0]+1+(1+o.length),P=(I,k,D)=>{let N=I===y-1?I-2:I===0?I:I-1;return N+=D?24575:0,[N,k]};for(let I=0;I<y;++I)l.emplaceBack(...P(I,0,!0));for(let I=0;I<_;++I)for(let k=0;k<y;++k)l.emplaceBack(...P(k,I,(k===0||k===y-1)&&!0));for(let I=0;I<o.length;++I){const k=o[I];for(let D=0;D<y;++D)l.emplaceBack(...P(D,k,!0))}for(let I=0;I<o.length;++I){const k=d.length,D=o[I]+1+2,N=new bo;for(let J=0;J<D-1;J++){const ie=J===D-2,ae=ie?y*(S-o.length+I-J):y;for(let me=0;me<y-1;me++){const de=J*y+me;J===0||ie||me===0||me===y-2?(N.emplaceBack(de+1,de,de+ae),N.emplaceBack(de+ae,de+ae+1,de+1)):(d.emplaceBack(de+1,de,de+ae),d.emplaceBack(de+ae,de+ae+1,de+1))}}const W=Ti.simpleSegment(0,k,l.length,d.length-k);for(let J=0;J<N.uint16.length;J+=3)d.emplaceBack(N.uint16[J],N.uint16[J+1],N.uint16[J+2]);const q=Ti.simpleSegment(0,k,l.length,d.length-k);p.push({withoutSkirts:W,withSkirts:q})}return{vertices:l,indices:d,segments:p}}_createGrid(u){const o=this._fillGridMeshWithLods(z,F);this._gridSegments=o.segments,this._gridBuffer=u.createVertexBuffer(o.vertices,Pl.members),this._gridIndexBuffer=u.createIndexBuffer(o.indices,!0)}_createPoles(u){const o=new bo;for(let _=0;_<=z;_++)o.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=u.createIndexBuffer(o,!0);const l=new iu,d=new iu,p=new iu,y=new iu;this._poleSegments=[];for(let _=0,S=0;_<E;_++){const P=360/(1<<_);l.emplaceBack(0,-w,0,.5,0),d.emplaceBack(0,-w,0,.5,1),p.emplaceBack(0,-w,0,.5,.5),y.emplaceBack(0,-w,0,.5,.5);for(let I=0;I<=z;I++){let k=I/z,D=0;const N=yn(0,P,k),[W,q,J]=Z(Ane,Pne,N,w);l.emplaceBack(W,q,J,k,D),d.emplaceBack(W,q,J,k,1-D);const ie=ne(N);k=.5+.5*Math.sin(ie),D=.5+.5*Math.cos(ie),p.emplaceBack(W,q,J,k,D),y.emplaceBack(W,q,J,k,1-D)}this._poleSegments.push(Ti.simpleSegment(S,0,66,64)),S+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(l,Ua,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(d,Ua,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(p,Ua,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(y,Ua,!1)}getGridBuffers(u,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},i.ev=aT,i.ew=Ce,i.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.ey=Be,i.ez=Ot,i.f=function(u){return u.indexOf("mapbox:")===0},i.f0=T$,i.f1=aj,i.f2=$p,i.f3="hd_road_elevation",i.f4=rM,i.f5=jn,i.f6=Vp,i.f7=wM,i.f8=Wp,i.f9=function(u,o,l,d,p,y,_,S=1,P,I){u.createArrays(),u.tilePixelRatio=jt/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const k=u.layers[0].layout,D=u.layers[0]._unevaluatedLayout._values,N={};N.scaleFactor=S,N.textSizeScaleRange=k.get("text-size-scale-range"),N.iconSizeScaleRange=k.get("icon-size-scale-range");const[W,q]=N.textSizeScaleRange,[J,ie]=N.iconSizeScaleRange;N.textScaleFactor=Ue(N.scaleFactor,W,q),N.iconScaleFactor=Ue(N.scaleFactor,J,ie);const ae=D["text-size"],me=D["icon-size"];if(u.textSizeData.kind==="composite"){const{minZoom:Ie,maxZoom:De}=u.textSizeData;N.compositeTextSizes=[ae.possiblyEvaluate(new zr(Ie),y),ae.possiblyEvaluate(new zr(De),y)]}if(u.iconSizeData.kind==="composite"){const{minZoom:Ie,maxZoom:De}=u.iconSizeData;N.compositeIconSizes=[me.possiblyEvaluate(new zr(Ie),y),me.possiblyEvaluate(new zr(De),y)]}N.layoutTextSize=ae.possiblyEvaluate(new zr(_+1),y),N.layoutIconSize=me.possiblyEvaluate(new zr(_+1),y),N.textMaxSize=ae.possiblyEvaluate(new zr(18),y);const de=k.get("symbol-placement"),Q=k.get("text-rotation-alignment")==="map"&&de!=="point",ue=k.get("text-size");let pe=!1;const ve=[];for(const Ie of u.features){const De=k.get("text-font").evaluate(Ie,{},y).join(","),Fe=ue.evaluate(Ie,{},y)*N.textScaleFactor,He=N.layoutTextSize.evaluate(Ie,{},y)*N.textScaleFactor,ct=N.layoutIconSize.evaluate(Ie,{},y)*N.iconScaleFactor,St={horizontal:{},vertical:void 0},_t=Ie.text;let bt,Pt=[0,0];if(_t){const tn=_t.toString(),Pn=k.get("text-letter-spacing").evaluate(Ie,{},y)*Oo,Bn=k.get("text-line-height").evaluate(Ie,{},y)*Oo,$n=MI(tn)?Pn:0,Jn=k.get("text-anchor").evaluate(Ie,{},y),Hn=k.get("text-variable-anchor");if(!Hn){const xe=k.get("text-radial-offset").evaluate(Ie,{},y);if(xe)Pt=Wj(Jn,[xe*Oo,TM]);else{const ut=k.get("text-offset").evaluate(Ie,{},y);Pt=[ut[0]*Oo,ut[1]*Oo]}}let Gn=Q?"center":k.get("text-justify").evaluate(Ie,{},y);const Ur=de==="point",ii=Ur?k.get("text-max-width").evaluate(Ie,{},y)*Oo:1/0,ge=xe=>{u.allowVerticalPlacement&&M0(tn)&&(St.vertical=vM(_t,o,l,p,De,ii,Bn,Jn,xe,$n,Pt,ss.vertical,!0,He,Fe,P))};if(!Q&&Hn){const xe=Gn==="auto"?Hn.map(Lt=>EM(Lt)):[Gn];let ut=!1;for(let Lt=0;Lt<xe.length;Lt++){const Gt=xe[Lt];if(!St.horizontal[Gt])if(ut)St.horizontal[Gt]=St.horizontal[0];else{const Ut=vM(_t,o,l,p,De,ii,Bn,"center",Gt,$n,Pt,ss.horizontal,!1,He,Fe,P);Ut&&(St.horizontal[Gt]=Ut,ut=Ut.positionedLines.length===1)}}ge("left")}else{if(Gn==="auto"&&(Gn=EM(Jn)),Ur||k.get("text-writing-mode").indexOf("horizontal")>=0||!M0(tn)){const xe=vM(_t,o,l,p,De,ii,Bn,Jn,Gn,$n,Pt,ss.horizontal,!1,He,Fe,P);xe&&(St.horizontal[Gn]=xe)}ge(Ur?"left":Gn)}}let st,xt,nt,lt,It,Mt,on,Kt=!1;if(Ie.icon&&Ie.icon.hasPrimary()){const tn=qj(Ie.icon,u.iconSizeData,D["icon-size"],y,u.zoom,Ie,P,N.iconScaleFactor);st=tn.iconPrimary,nt=tn.iconSecondary;const Pn=st.toString();if(xt=d.get(Pn),xt&&(It=k.get("icon-offset").evaluate(Ie,{},y),Mt=k.get("icon-anchor").evaluate(Ie,{},y),on=k.get("icon-text-fit").evaluate(Ie,{},y),bt=Vre(p.get(Pn),nt?p.get(nt.toString()):void 0,It,Mt),Kt=xt.sdf,u.sdfIcons===void 0?u.sdfIcons=xt.sdf:u.sdfIcons!==xt.sdf&&nr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xt.pixelRatio!==u.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0)),nt){const Bn=nt.toString();lt=d.get(Bn)}}pe=pe||!(!Ie.icon||!Ie.icon.hasSecondary());const $t=AM(St.horizontal)||St.vertical;u.iconsInText||(u.iconsInText=!!$t&&$t.iconsInText);const Ct=He*N.textScaleFactor/Oo,{defaultShapedIcon:kn,verticallyShapedIcon:en}=Jre(u,bt,k,Ie,y,St,Ct,It,on);on!=="none"&&bt&&(Ij(bt)||Mj(bt))&&(gT(0,xt,st,bt,kn,on,I,d,p),gT(0,lt,nt,bt,kn,on,I,d,p),en&&(gT(0,xt,st,bt,en,on,I,d,p),gT(0,lt,nt,bt,en,on,I,d,p))),bt=kn,ve.push({feature:Ie,shapedTextOrientations:St,shapedText:$t,shapedIcon:bt,iconPrimary:st,iconSecondary:nt,iconOffset:It,iconAnchor:Mt,verticallyShapedIcon:en,layoutTextSize:He,layoutIconSize:ct,textOffset:Pt,isSDFIcon:Kt,iconTextFit:on})}return{featureData:ve,sizes:N,hasAnySecondaryIcon:pe,textAlongLine:Q,symbolPlacement:de}},i.fa=Bj,i.fb=function(u,o,l,d,p,y,_,S,P,I){const{featureData:k,hasAnySecondaryIcon:D,sizes:N,textAlongLine:W,symbolPlacement:q}=o;for(const J of k){const{shapedIcon:ie,verticallyShapedIcon:ae,feature:me,shapedTextOrientations:de,shapedText:Q,layoutTextSize:ue,textOffset:pe,isSDFIcon:ve,iconPrimary:Ie,iconSecondary:De,iconTextFit:Fe,iconOffset:He}=J;Zj(ie,I.iconPositions,Ie,De),Zj(ae,I.iconPositions,Ie,De),Yre(de,I.iconPositions),(Q||ie)&&Qre(u,me,de,ie,ae,P,N,ue,0,pe,ve,d,p,_,S,D,Fe,He,W,q)}l&&u.generateCollisionDebugBuffers(y,u.collisionBoxArray,N.textScaleFactor)},i.fc=Od,i.fd=$T,i.fe=ku,i.ff=gB,i.fg=xj,i.fh=rs,i.fi=function(u){let o=0;if(new Uint32Array(u,0,1)[0]!==g$){const l=new Uint32Array(u,0,7),[,,d,p,y,_]=l;o=l.byteLength+p+y+_+y,(d!==u.byteLength||o>=u.byteLength)&&nr("Invalid b3dm header information.")}return x$(u,o)},i.fj=function(u,o){const l=w$(u);for(const d of l){for(const p of d.meshes)Coe(p);d.lights&&(d.lightMeshIndex=d.meshes.length,d.meshes.push(Ioe(d.lights,o)))}return l},i.fk=RT,i.fl=ni,i.fm=z4,i.fn=Ps,i.fo=function(u){tc(),Ss!=null&&Ss.then(o=>{o.keys().then(l=>{for(let d=0;d<l.length-u;d++)o.delete(l[d]).catch(p=>nr(p.message))}).catch(l=>nr(l.message))}).catch(o=>nr(o.message))},i.g=function(u,o){return Kh(tt(u,{method:"GET"}),o)},i.h=wl,i.i=function(u){return Vo.API_STYLE_REGEX.test(u)&&!Ru(u)},i.j=function(u){return decodeURIComponent(atob(u).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(o,l)=>String.fromCharCode(+("0x"+l))))},i.l=tt,i.m=Zv,i.n=function(u,o){return Kh(tt(u,{type:"json"}),o)},i.o=Jh,i.p=function(u,o){return Kh(tt(u,{method:"POST"}),o)},i.q=Xs,i.r=Go,i.s=function(u){try{const o=self[u];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=Wv,i.u=function(){return function u(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()},i.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},i.w=nr,i.x=function(){return WM||(WM=new Zp),WM},i.y=KM,i.z=Yv}),c(["./shared"],function(i){function v(it){const ne=it?it.url.toString():void 0;return ne?performance.getEntriesByName(ne):[]}function b(it){if(typeof it=="number"||typeof it=="boolean"||typeof it=="string"||it==null)return JSON.stringify(it);if(Array.isArray(it)){let le="[";for(const Te of it)le+=`${b(Te)},`;return`${le}]`}let ne="{";for(const le of Object.keys(it).sort())ne+=`${le}:${b(it[le])},`;return`${ne}}`}function T(it){let ne="";for(const le of i.bu)(it.type!=="model"||le!=="minzoom"&&le!=="maxzoom")&&(ne+=`/${b(it[le])}`);return ne}class A{constructor(ne){this.keyCache={},this._layers={},this._layerConfigs={},ne&&this.replace(ne)}replace(ne,le){this._layerConfigs={},this._layers={},this.update(ne,[],le)}update(ne,le,Te){this._options=Te;for(const Ce of ne)this._layerConfigs[Ce.id]=Ce,(this._layers[Ce.id]=i.dc(Ce,this.scope,null,this._options)).compileFilter(Te),this.keyCache[Ce.id]&&delete this.keyCache[Ce.id];for(const Ce of le)delete this.keyCache[Ce],delete this._layerConfigs[Ce],delete this._layers[Ce];this.familiesBySource={};const Oe=function(Ce,Be){const Ue={};for(let rt=0;rt<Ce.length;rt++){const ft=Ce[rt];let tt=Be&&Be[ft.id];tt||(ft.type==="symbol"?tt=ft.id:(tt=T(ft),ft.type==="line"&&ft.paint&&function Ht(rn){return typeof rn=="string"&&rn==="line-progress"||(Array.isArray(rn)?rn.some(Ht):!(!rn||typeof rn!="object")&&Object.values(rn).some(Ht))}(ft.paint["line-width"])&&(tt+=`/${b(ft.paint["line-width"])}`))),Be&&(Be[ft.id]=tt);let Bt=Ue[tt];Bt||(Bt=Ue[tt]=[]),Bt.push(ft)}const Ve=[];for(const rt in Ue)Ve.push(Ue[rt]);return Ve}(Object.values(this._layerConfigs),this.keyCache);for(const Ce of Oe){const Be=Ce.map(Bt=>this._layers[Bt.id]),Ue=Be[0];if(Ue.visibility==="none")continue;const Ve=Ue.source||"";let rt=this.familiesBySource[Ve];rt||(rt=this.familiesBySource[Ve]={});const ft=Ue.sourceLayer||"_geojsonTileLayer";let tt=rt[ft];tt||(tt=rt[ft]=[]),tt.push(Be)}}}const M=1*i.e_;class R{constructor(ne){const le={},Te=[];for(const Ue in ne){const Ve=ne[Ue],rt=le[Ue]={};for(const ft in Ve.glyphs){const tt=Ve.glyphs[+ft];if(!tt||tt.bitmap.width===0||tt.bitmap.height===0)continue;const Bt=tt.metrics.localGlyph?M:1,Ht={x:0,y:0,w:tt.bitmap.width+2*Bt,h:tt.bitmap.height+2*Bt};Te.push(Ht),rt[ft]=Ht}}const{w:Oe,h:Ce}=i.H(Te),Be=new i.eZ({width:Oe||1,height:Ce||1});for(const Ue in ne){const Ve=ne[Ue];for(const rt in Ve.glyphs){const ft=Ve.glyphs[+rt];if(!ft||ft.bitmap.width===0||ft.bitmap.height===0)continue;const tt=le[Ue][rt],Bt=ft.metrics.localGlyph?M:1;i.eZ.copy(ft.bitmap,Be,{x:0,y:0},{x:tt.x+Bt,y:tt.y+Bt},ft.bitmap)}}this.image=Be,this.positions=le}}i.eY(R,"GlyphAtlas");class B{constructor(ne){this.tileID=new i.aM(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.tileZoom=ne.tileZoom,this.uid=ne.uid,this.zoom=ne.zoom,this.lut=ne.lut,this.canonical=ne.tileID.canonical,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.scope=ne.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.request&&ne.request.collectResourceTiming,this.promoteId=ne.promoteId,this.isSymbolTile=ne.isSymbolTile,this.tileTransform=i.aW(ne.tileID.canonical,ne.projection),this.projection=ne.projection,this.worldview=ne.worldview,this.localizableLayerIds=ne.localizableLayerIds,this.brightness=ne.brightness,this.extraShadowCaster=!!ne.extraShadowCaster,this.tessellationStep=ne.tessellationStep,this.scaleFactor=ne.scaleFactor}parse(ne,le,Te,Oe,Ce,Be){this.status="parsing",this.data=ne,this.collisionBoxArray=new i.b0;const Ue=new i.e$(Object.keys(ne.layers).sort()),Ve=new i.f0(this.tileID,this.promoteId);Ve.bucketLayerIDs=[];const rt={},ft=new i.f1(256,256),tt={featureIndex:Ve,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:ft,availableImages:Te,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Bt=le.familiesBySource[this.source];for(const _r in Bt){const Xr=ne.layers[_r];if(!Xr)continue;let ni=!1,ji=!1,Ji=!1;for(const Jo of Bt[_r])Jo[0].type==="symbol"?ni=!0:ji=!0,Jo[0].is3D()&&Jo[0].type!=="model"&&(Ji=!0);if(this.extraShadowCaster&&!Ji||this.isSymbolTile===!0&&!ni||this.isSymbolTile===!1&&!ji)continue;Xr.version===1&&i.w(`Vector tile source "${this.source}" layer "${_r}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xo=Ue.encode(_r),zo=[];let Jl=!1;for(let Jo=0,Qo=0;Jo<Xr.length;Jo++){const Io=Xr.feature(Jo),Vo=Ve.getId(Io,_r);if(this.localizableLayerIds&&this.localizableLayerIds.has(_r)){const wl=Io.properties?Io.properties.worldview:null;if(this.worldview&&typeof wl=="string")if(wl==="all")Io.properties.$localized=!0;else{if(!wl.split(",").includes(this.worldview))continue;Io.properties.$localized=!0,Io.properties.worldview=this.worldview}}!Jl&&Io.properties&&Io.properties.hasOwnProperty(i.f2)&&(Jl=!0),zo.push({feature:Io,id:Vo,index:Qo,sourceLayerIndex:xo}),Qo++}Jl&&!tt.elevationFeatures&&ne.layers.hasOwnProperty(i.f3)&&(tt.elevationFeatures=i.f4.parseFrom(ne.layers[i.f3],this.canonical));for(const Jo of Bt[_r]){const Qo=Jo[0];(!this.extraShadowCaster||Qo.is3D()&&Qo.type!=="model")&&(this.isSymbolTile!==void 0&&Qo.type==="symbol"!==this.isSymbolTile||Qo.minzoom&&this.zoom<Math.floor(Qo.minzoom)||Qo.maxzoom&&this.zoom>=Qo.maxzoom||Qo.visibility!=="none"&&(L(Jo,this.zoom,tt.brightness,Te),(rt[Qo.id]=Qo.createBucket({index:Ve.bucketLayerIDs.length,layers:Jo,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xo,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Oe})).populate(zo,tt,this.tileID.canonical,this.tileTransform),Ve.bucketLayerIDs.push(Jo.map(Io=>i.C(Io.id,Io.scope)))))}}let Ht,rn,Dn,jn,qn,er;ft.trim();const Ci={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},nr=()=>{if(Ht)return this.status="done",Be(Ht);if(this.extraShadowCaster)this.status="done",Be(null,{buckets:Object.values(rt).filter(_r=>!_r.isEmpty()),featureIndex:Ve,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:tt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(rn&&Dn&&jn){const _r=new R(rn),Xr=new Map;for(const[Ji,xo]of Dn.entries()){const{imagePosition:zo}=i.f7(Ji,xo,i.f8);Xr.set(Ji,zo)}const ni={};for(const Ji in rt){const xo=rt[Ji];xo instanceof i.b1&&(L(xo.layers,this.zoom,tt.brightness,Te),ni[Ji]=i.f9(xo,rn,_r.positions,Dn,Xr,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,qn))}const ji={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Ce,Dn,qn,()=>{ji.iconsPending=!1,Zr(ni,_r,ji)}),this.rasterizeIfNeeded(Ce,jn,er,()=>{ji.patternsPending=!1,Zr(ni,_r,ji)})}},Zr=(_r,Xr,ni,ji)=>{if(ni.iconsPending||ni.patternsPending)return;const Ji=new i.fa(Dn,jn,this.lut);for(const xo in rt){const zo=rt[xo];if(xo in _r)i.fb(zo,_r[xo],this.showCollisionBoxes,Te,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Dn,Ji);else if(zo.hasPattern&&(zo instanceof i.b7||zo instanceof i.b8||zo instanceof i.dV)){L(zo.layers,this.zoom,tt.brightness,Te);const Jl=Object.fromEntries(Ji.patternPositions);zo.addFeatures(tt,this.tileID.canonical,Jl,Te,this.tileTransform,this.brightness)}}this.status="done",Be(null,{buckets:Object.values(rt).filter(xo=>!xo.isEmpty()),featureIndex:Ve,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Xr.image,lineAtlas:ft,imageAtlas:Ji,brightness:tt.brightness})};if(!this.extraShadowCaster){const _r=i.f5(tt.glyphDependencies,ji=>Object.keys(ji).map(Number));Object.keys(_r).length?Ce.send("getGlyphs",{uid:this.uid,stacks:_r,scope:this.scope},(ji,Ji)=>{Ht||(Ht=ji,rn=Ji,nr())},void 0,!1,Ci):rn={};const Xr=Array.from(tt.iconDependencies.keys()).map(ji=>i.I.parse(ji));Xr.length?Ce.send("getImages",{images:Xr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(ji,Ji)=>{Ht||(Ht=ji,Dn=new Map,qn=this.updateImageMapAndGetImageTaskQueue(Dn,Ji,tt.iconDependencies),nr())},void 0,!1,Ci):(Dn=new Map,qn=new Map);const ni=Array.from(tt.patternDependencies.keys()).map(ji=>i.I.parse(ji));ni.length?Ce.send("getImages",{images:ni,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(ji,Ji)=>{Ht||(Ht=ji,jn=new Map,er=this.updateImageMapAndGetImageTaskQueue(jn,Ji,tt.patternDependencies),nr())},void 0,!1,Ci):(jn=new Map,er=new Map)}if(tt.elevationFeatures&&tt.elevationFeatures.length>0){const _r=[];for(const ni of Object.values(rt))if(ni instanceof i.b8){const ji=ni.getUnevaluatedPortalGraph();ji&&_r.push(ji)}const Xr=i.f6.evaluate(_r);for(const ni of Object.values(rt))ni instanceof i.b8&&ni.setEvaluatedPortalGraph(Xr)}nr()}rasterizeIfNeeded(ne,le,Te,Oe){Array.from(le.values()).some(Ce=>Ce.usvg)?this.rasterize(ne,le,Te,Oe):Oe()}updateImageMapAndGetImageTaskQueue(ne,le,Te){const Oe=new Map;for(const Ce of le.keys()){const Be=Te.get(Ce)||[];for(const Ue of Be){const Ve=Ue.toString(),rt=le.get(Ue.id.toString());rt.usvg?Oe.has(Ve)||(Oe.set(Ve,Ue),ne.set(Ve,Object.assign({},rt))):ne.set(Ve,rt)}}return Oe}rasterize(ne,le,Te,Oe){this.rasterizeTask=ne.send("rasterizeImages",{scope:this.scope,tasks:Te},(Ce,Be)=>{if(!Ce)for(const[Ue,Ve]of Be.entries()){const rt=Object.assign(le.get(Ue),{data:Ve});le.set(Ue,rt)}Oe()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function L(it,ne,le,Te){const Oe=new i.aa(ne,{brightness:le});for(const Ce of it)Ce.recalculate(Oe,Te)}class j extends i.E{constructor(ne,le,Te,Oe,Ce,Be,Ue){super(),this.actor=ne,this.layerIndex=le,this.availableImages=Te,this.availableModels=Oe,this.loadVectorData=Be||i.aJ,this.loading={},this.loaded={},this.deduped=new i.aI(ne.scheduler),this.isSpriteLoaded=Ce,this.scheduler=ne.scheduler,this.brightness=Ue}loadTile(ne,le){const Te=ne.uid,Oe=ne&&ne.request,Ce=Oe&&Oe.collectResourceTiming,Be=this.loading[Te]=new B(ne);Be.abort=this.loadVectorData(ne,(Ue,Ve)=>{const rt=!this.loading[Te];if(delete this.loading[Te],Be.cancelRasterize(),rt||Ue||!Ve)return Be.status="done",rt||(this.loaded[Te]=Be),le(Ue);const ft=Ve.rawData,tt={};Ve.expires&&(tt.expires=Ve.expires),Ve.cacheControl&&(tt.cacheControl=Ve.cacheControl),Be.vectorTile=Ve.vectorTile||new i.fc.VectorTile(new i.bq(ft));const Bt=()=>{Be.parse(Be.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(Ht,rn)=>{if(Ht||!rn)return le(Ht);const Dn={};if(Ce){const jn=v(Oe);jn.length>0&&(Dn.resourceTiming=JSON.parse(JSON.stringify(jn)))}le(null,i.l({rawTileData:ft.slice(0)},rn,tt,Dn))})};this.isSpriteLoaded?Bt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Bt,{type:"parseTile",isSymbolTile:ne.isSymbolTile,zoom:ne.tileZoom}):Bt()}),this.loaded=this.loaded||{},this.loaded[Te]=Be})}reloadTile(ne,le){const Te=this.loaded,Oe=ne.uid;if(Te&&Te[Oe]){const Ce=Te[Oe];Ce.scaleFactor=ne.scaleFactor,Ce.showCollisionBoxes=ne.showCollisionBoxes,Ce.projection=ne.projection,Ce.brightness=ne.brightness,Ce.tileTransform=i.aW(ne.tileID.canonical,ne.projection),Ce.extraShadowCaster=ne.extraShadowCaster,Ce.lut=ne.lut;const Be=(Ue,Ve)=>{const rt=Ce.reloadCallback;rt&&(delete Ce.reloadCallback,Ce.parse(Ce.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,rt)),le(Ue,Ve)};Ce.status==="parsing"?Ce.reloadCallback=Be:Ce.status==="done"&&(Ce.vectorTile?Ce.parse(Ce.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Be):Be())}else le(null,void 0)}abortTile(ne,le){const Te=ne.uid,Oe=this.loading[Te];Oe&&(Oe.abort&&Oe.abort(),delete this.loading[Te]),le()}removeTile(ne,le){const Te=this.loaded,Oe=ne.uid;Te&&Te[Oe]&&delete Te[Oe],le()}}class V{loadTile(ne,le){const{uid:Te,encoding:Oe,rawImageData:Ce,padding:Be}=ne,Ue=ImageBitmap&&Ce instanceof ImageBitmap?this.getImageData(Ce,Be):Ce;le(null,new i.fd(Te,Ue,Oe,Be<1))}reloadTile(ne,le){le(null,null)}abortTile(ne,le){le()}removeTile(ne,le){le()}getImageData(ne,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);const Te=this.offscreenCanvasContext.getImageData(-le,-le,ne.width+2*le,ne.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Te}}i.bp.setPbf(i.bq);class ${constructor(ne){this._mrt=new i.bp(ne.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=ne.uid,this.tileID=ne.tileID,this.source=ne.source}parse(ne,le){const Te=this._mrt;this.status="parsing",this._entireBuffer=ne;try{Te.parseHeader(ne),this._isHeaderLoaded=!0;const Oe=[];for(const Ce in Te.layers){const Be=Te.getLayer(Ce),Ue=Be.getDataRange(Be.getBandList()),Ve=Te.createDecodingTask(Ue),rt=ne.slice(Ue.firstByte,Ue.lastByte+1),ft=i.bp.performDecoding(rt,Ve).then(tt=>Ve.complete(null,tt)).catch(tt=>Ve.complete(tt,null));Oe.push(ft)}Promise.allSettled(Oe).then(()=>le(null,Te)).catch(Ce=>le(Ce))}catch(Oe){le(Oe)}}}class H{constructor(ne){this.actor=ne,this.loading={},this.loaded={}}loadTile(ne,le){const Te=ne.uid,Oe=ne.request,Ce=this.loading[Te]=new $(ne),{cancel:Be}=i.br(Oe,(Ue,Ve,rt,ft)=>{const tt=!this.loading[Te];if(delete this.loading[Te],tt||Ue||!Ve)return Ce.status="done",tt||(this.loaded[Te]=Ce),le(Ue);Ce.parse(Ve,(Bt,Ht)=>{if(Bt||!Ht)return le(Bt);le(null,Ht,rt,ft)}),this.loaded[Te]=Ce});Ce.abort=Be}reloadTile(ne,le){le(null,void 0)}abortTile(ne,le){const Te=ne.uid,Oe=this.loading[Te];Oe&&(Oe.abort&&Oe.abort(),delete this.loading[Te]),le()}removeTile(ne,le){const Te=ne.uid;this.loaded[Te]&&delete this.loaded[Te],le()}decodeRasterArray(ne,le){i.bp.performDecoding(ne.buffer,ne.task).then(Te=>le(null,Te)).catch(Te=>le(Te))}}const K=i.fc.VectorTileFeature.prototype.toGeoJSON;class Y{constructor(ne){this._feature=ne,this.extent=i.aj,this.type=ne.type,this.properties=ne.tags,"id"in ne&&!isNaN(ne.id)&&(this.id=parseInt(ne.id,10))}loadGeometry(){if(this._feature.type===1){const ne=[];for(const le of this._feature.geometry)ne.push([new i.P(le[0],le[1])]);return ne}{const ne=[];for(const le of this._feature.geometry){const Te=[];for(const Oe of le)Te.push(new i.P(Oe[0],Oe[1]));ne.push(Te)}return ne}}toGeoJSON(ne,le,Te){return K.call(this,ne,le,Te)}}class se{constructor(ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.aj,this.length=ne.length,this._features=ne}feature(ne){return new Y(this._features[ne])}}const ce=64/4096,ye=128;class ze{constructor(){this.features=new Map}clear(){this.features.clear()}load(ne=[],le){for(const Te of ne){const Oe=Te.id;if(Oe==null)continue;let Ce=this.features.get(Oe);Ce&&this.updateCache(Ce,le),Te.geometry?(Ce=je(Te),this.updateCache(Ce,le),this.features.set(Oe,Ce)):this.features.delete(Oe),this.updateCache(Ce,le)}}updateCache(ne,le){for(const{canonical:Te,uid:Oe}of Object.values(le)){const{z:Ce,x:Be,y:Ue}=Te;Le(ne,Math.pow(2,Ce),Be,Ue)&&delete le[Oe]}}getTile(ne,le,Te){const Oe=Math.pow(2,ne),Ce=[];for(const Be of this.features.values())Le(Be,Oe,le,Te)&&Ce.push(ht(Be,Oe,le,Te));return{features:Ce}}getFeatures(){return[...this.features.values()]}}function Le({minX:it,minY:ne,maxX:le,maxY:Te},Oe,Ce,Be){return it<(Ce+1+ce)/Oe&&ne<(Be+1+ce)/Oe&&le>(Ce-ce)/Oe&&Te>(Be-ce)/Oe}function je(it){const{id:ne,geometry:le,properties:Te}=it;if(!le)return;if(le.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Oe,coordinates:Ce}=le,Be={id:ne,type:1,geometry:[],tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Ue=Be.geometry;if(Oe==="Point")Re(Ce,Ue,Be);else if(Oe==="MultiPoint")for(const Ve of Ce)Re(Ve,Ue,Be);else if(Oe==="LineString")Be.type=2,$e(Ce,Ue,Be);else if(Oe==="MultiLineString")Be.type=2,Ge(Ce,Ue,Be);else if(Oe==="Polygon")Be.type=3,Ge(Ce,Ue,Be,!0);else{if(Oe!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Be.type=3;for(const Ve of Ce)Ge(Ve,Ue,Be,!0)}return Be}function Re([it,ne],le,Te){const Oe=i.ay(it);let Ce=i.aH(ne);Ce=Ce<0?0:Ce>1?1:Ce,le.push(Oe,Ce),Te.minX=Math.min(Te.minX,Oe),Te.minY=Math.min(Te.minY,Ce),Te.maxX=Math.max(Te.maxX,Oe),Te.maxY=Math.max(Te.maxY,Ce)}function $e(it,ne,le,Te=!1,Oe=!1){const Ce=[];for(const Be of it)Re(Be,Ce,le);ne.push(Ce),Te&&function(Be,Ue){let Ve=0;for(let rt=0,ft=Be.length,tt=ft-2;rt<ft;tt=rt,rt+=2)Ve+=(Be[rt]-Be[tt])*(Be[rt+1]+Be[tt+1]);if(Ve>0===Ue)for(let rt=0,ft=Be.length;rt<ft/2;rt+=2){const tt=Be[rt],Bt=Be[rt+1];Be[rt]=Be[ft-2-rt],Be[rt+1]=Be[ft-1-rt],Be[ft-2-rt]=tt,Be[ft-1-rt]=Bt}}(Ce,Oe)}function Ge(it,ne,le,Te=!1){for(let Oe=0;Oe<it.length;Oe++)$e(it[Oe],ne,le,Te,Oe===0)}function ht(it,ne,le,Te){const{id:Oe,type:Ce,geometry:Be,tags:Ue}=it,Ve=[];if(Ce===1)(function(rt,ft,tt,Bt,Ht){for(let rn=0;rn<rt.length;rn+=2){const Dn=Math.round(i.aj*(rt[rn+0]*ft-tt)),jn=Math.round(i.aj*(rt[rn+1]*ft-Bt));Ht.push([Dn,jn])}})(Be,ne,le,Te,Ve);else for(const rt of Be)ot(rt,ne,le,Te,Ve);return{id:Oe,type:Ce,geometry:Ve,tags:Ue}}function ot(it,ne,le,Te,Oe){const Ce=-ye,Be=i.aj+ye;let Ue;for(let Ve=0;Ve<it.length-2;Ve+=2){let rt=Math.round(i.aj*(it[Ve+0]*ne-le)),ft=Math.round(i.aj*(it[Ve+1]*ne-Te)),tt=Math.round(i.aj*(it[Ve+2]*ne-le)),Bt=Math.round(i.aj*(it[Ve+3]*ne-Te));const Ht=tt-rt,rn=Bt-ft;rt<Ce&&tt<Ce||(rt<Ce?(ft+=Math.round(rn*((Ce-rt)/Ht)),rt=Ce):tt<Ce&&(Bt=ft+Math.round(rn*((Ce-rt)/Ht)),tt=Ce),ft<Ce&&Bt<Ce||(ft<Ce?(rt+=Math.round(Ht*((Ce-ft)/rn)),ft=Ce):Bt<Ce&&(tt=rt+Math.round(Ht*((Ce-ft)/rn)),Bt=Ce),rt>=Be&&tt>=Be||(rt>=Be?(ft+=Math.round(rn*((Be-rt)/Ht)),rt=Be):tt>=Be&&(Bt=ft+Math.round(rn*((Be-rt)/Ht)),tt=Be),ft>=Be&&Bt>=Be||(ft>=Be?(rt+=Math.round(Ht*((Be-ft)/rn)),ft=Be):Bt>=Be&&(tt=rt+Math.round(Ht*((Be-ft)/rn)),Bt=Be),Ue&&rt===Ue[Ue.length-1][0]&&ft===Ue[Ue.length-1][1]||(Ue=[[rt,ft]],Oe.push(Ue)),Ue.push([tt,Bt])))))}}var Je,Ne,Xe,pt={exports:{}},zt=function(){if(Xe)return pt.exports;Xe=1;var it=i.fg(),ne=function(){if(Ne)return Je;Ne=1;var ft=i.fe(),tt=i.ff().VectorTileFeature;function Bt(rn,Dn){this.options=Dn||{},this.features=rn,this.length=rn.length}function Ht(rn,Dn){this.id=typeof rn.id=="number"?rn.id:void 0,this.type=rn.type,this.rawGeometry=rn.type===1?[rn.geometry]:rn.geometry,this.properties=rn.tags,this.extent=Dn||4096}return Je=Bt,Bt.prototype.feature=function(rn){return new Ht(this.features[rn],this.options.extent)},Ht.prototype.loadGeometry=function(){var rn=this.rawGeometry;this.geometry=[];for(var Dn=0;Dn<rn.length;Dn++){for(var jn=rn[Dn],qn=[],er=0;er<jn.length;er++)qn.push(new ft(jn[er][0],jn[er][1]));this.geometry.push(qn)}return this.geometry},Ht.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var rn=this.geometry,Dn=1/0,jn=-1/0,qn=1/0,er=-1/0,Ci=0;Ci<rn.length;Ci++)for(var nr=rn[Ci],Zr=0;Zr<nr.length;Zr++){var _r=nr[Zr];Dn=Math.min(Dn,_r.x),jn=Math.max(jn,_r.x),qn=Math.min(qn,_r.y),er=Math.max(er,_r.y)}return[Dn,qn,jn,er]},Ht.prototype.toGeoJSON=tt.prototype.toGeoJSON,Je}();function le(ft){var tt=new it;return function(Bt,Ht){for(var rn in Bt.layers)Ht.writeMessage(3,Te,Bt.layers[rn])}(ft,tt),tt.finish()}function Te(ft,tt){var Bt;tt.writeVarintField(15,ft.version||1),tt.writeStringField(1,ft.name||""),tt.writeVarintField(5,ft.extent||4096);var Ht={keys:[],values:[],keycache:{},valuecache:{}};for(Bt=0;Bt<ft.length;Bt++)Ht.feature=ft.feature(Bt),tt.writeMessage(2,Oe,Ht);var rn=Ht.keys;for(Bt=0;Bt<rn.length;Bt++)tt.writeStringField(3,rn[Bt]);var Dn=Ht.values;for(Bt=0;Bt<Dn.length;Bt++)tt.writeMessage(4,rt,Dn[Bt])}function Oe(ft,tt){var Bt=ft.feature;Bt.id!==void 0&&tt.writeVarintField(1,Bt.id),tt.writeMessage(2,Ce,ft),tt.writeVarintField(3,Bt.type),tt.writeMessage(4,Ve,Bt)}function Ce(ft,tt){var Bt=ft.feature,Ht=ft.keys,rn=ft.values,Dn=ft.keycache,jn=ft.valuecache;for(var qn in Bt.properties){var er=Bt.properties[qn],Ci=Dn[qn];if(er!==null){Ci===void 0&&(Ht.push(qn),Dn[qn]=Ci=Ht.length-1),tt.writeVarint(Ci);var nr=typeof er;nr!=="string"&&nr!=="boolean"&&nr!=="number"&&(er=JSON.stringify(er));var Zr=nr+":"+er,_r=jn[Zr];_r===void 0&&(rn.push(er),jn[Zr]=_r=rn.length-1),tt.writeVarint(_r)}}}function Be(ft,tt){return(tt<<3)+(7&ft)}function Ue(ft){return ft<<1^ft>>31}function Ve(ft,tt){for(var Bt=ft.loadGeometry(),Ht=ft.type,rn=0,Dn=0,jn=Bt.length,qn=0;qn<jn;qn++){var er=Bt[qn],Ci=1;Ht===1&&(Ci=er.length),tt.writeVarint(Be(1,Ci));for(var nr=Ht===3?er.length-1:er.length,Zr=0;Zr<nr;Zr++){Zr===1&&Ht!==1&&tt.writeVarint(Be(2,nr-1));var _r=er[Zr].x-rn,Xr=er[Zr].y-Dn;tt.writeVarint(Ue(_r)),tt.writeVarint(Ue(Xr)),rn+=_r,Dn+=Xr}Ht===3&&tt.writeVarint(Be(7,1))}}function rt(ft,tt){var Bt=typeof ft;Bt==="string"?tt.writeStringField(1,ft):Bt==="boolean"?tt.writeBooleanField(7,ft):Bt==="number"&&(ft%1!=0?tt.writeDoubleField(3,ft):ft<0?tt.writeSVarintField(6,ft):tt.writeVarintField(5,ft))}return pt.exports=le,pt.exports.fromVectorTileJs=le,pt.exports.fromGeojsonVt=function(ft,tt){tt=tt||{};var Bt={};for(var Ht in ft)Bt[Ht]=new ne(ft[Ht].features,tt),Bt[Ht].name=Ht,Bt[Ht].version=tt.version,Bt[Ht].extent=tt.extent;return le({layers:Bt})},pt.exports.GeoJSONWrapper=ne,pt.exports}(),Ft=i.fh(zt);const un={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:it=>it},Tn=Math.fround||(fn=new Float32Array(1),it=>(fn[0]=+it,fn[0]));var fn;const Cn=3,Vt=5,lr=6;class Nt{constructor(ne){this.options=Object.assign(Object.create(un),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:le,minZoom:Te,maxZoom:Oe}=this.options;le&&console.time("total time");const Ce=`prepare ${ne.length} points`;le&&console.time(Ce),this.points=ne;const Be=[];for(let Ve=0;Ve<ne.length;Ve++){const rt=ne[Ve];if(!rt.geometry)continue;const[ft,tt]=rt.geometry.coordinates,Bt=Tn(kt(ft)),Ht=Tn(zn(tt));Be.push(Bt,Ht,1/0,Ve,-1,1),this.options.reduce&&Be.push(0)}let Ue=this.trees[Oe+1]=this._createTree(Be);le&&console.timeEnd(Ce);for(let Ve=Oe;Ve>=Te;Ve--){const rt=+Date.now();Ue=this.trees[Ve]=this._createTree(this._cluster(Ue,Ve)),le&&console.log("z%d: %d clusters in %dms",Ve,Ue.numItems,+Date.now()-rt)}return le&&console.timeEnd("total time"),this}getClusters(ne,le){let Te=((ne[0]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,ne[1]));let Ce=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const Be=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)Te=-180,Ce=180;else if(Te>Ce){const tt=this.getClusters([Te,Oe,180,Be],le),Bt=this.getClusters([-180,Oe,Ce,Be],le);return tt.concat(Bt)}const Ue=this.trees[this._limitZoom(le)],Ve=Ue.range(kt(Te),zn(Be),kt(Ce),zn(Oe)),rt=Ue.data,ft=[];for(const tt of Ve){const Bt=this.stride*tt;ft.push(rt[Bt+Vt]>1?gn(rt,Bt,this.clusterProps):this.points[rt[Bt+Cn]])}return ft}getChildren(ne){const le=this._getOriginId(ne),Te=this._getOriginZoom(ne),Oe="No cluster with the specified id.",Ce=this.trees[Te];if(!Ce)throw new Error(Oe);const Be=Ce.data;if(le*this.stride>=Be.length)throw new Error(Oe);const Ue=this.options.radius/(this.options.extent*Math.pow(2,Te-1)),Ve=Ce.within(Be[le*this.stride],Be[le*this.stride+1],Ue),rt=[];for(const ft of Ve){const tt=ft*this.stride;Be[tt+4]===ne&&rt.push(Be[tt+Vt]>1?gn(Be,tt,this.clusterProps):this.points[Be[tt+Cn]])}if(rt.length===0)throw new Error(Oe);return rt}getLeaves(ne,le,Te){const Oe=[];return this._appendLeaves(Oe,ne,le=le||10,Te=Te||0,0),Oe}getTile(ne,le,Te){const Oe=this.trees[this._limitZoom(ne)],Ce=Math.pow(2,ne),{extent:Be,radius:Ue}=this.options,Ve=Ue/Be,rt=(Te-Ve)/Ce,ft=(Te+1+Ve)/Ce,tt={features:[]};return this._addTileFeatures(Oe.range((le-Ve)/Ce,rt,(le+1+Ve)/Ce,ft),Oe.data,le,Te,Ce,tt),le===0&&this._addTileFeatures(Oe.range(1-Ve/Ce,rt,1,ft),Oe.data,Ce,Te,Ce,tt),le===Ce-1&&this._addTileFeatures(Oe.range(0,rt,Ve/Ce,ft),Oe.data,-1,Te,Ce,tt),tt.features.length?tt:null}getClusterExpansionZoom(ne){let le=this._getOriginZoom(ne)-1;for(;le<=this.options.maxZoom;){const Te=this.getChildren(ne);if(le++,Te.length!==1)break;ne=Te[0].properties.cluster_id}return le}_appendLeaves(ne,le,Te,Oe,Ce){const Be=this.getChildren(le);for(const Ue of Be){const Ve=Ue.properties;if(Ve&&Ve.cluster?Ce+Ve.point_count<=Oe?Ce+=Ve.point_count:Ce=this._appendLeaves(ne,Ve.cluster_id,Te,Oe,Ce):Ce<Oe?Ce++:ne.push(Ue),ne.length===Te)break}return Ce}_createTree(ne){const le=new i.bW(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Te=0;Te<ne.length;Te+=this.stride)le.add(ne[Te],ne[Te+1]);return le.finish(),le.data=ne,le}_addTileFeatures(ne,le,Te,Oe,Ce,Be){for(const Ue of ne){const Ve=Ue*this.stride,rt=le[Ve+Vt]>1;let ft,tt,Bt;if(rt)ft=xn(le,Ve,this.clusterProps),tt=le[Ve],Bt=le[Ve+1];else{const Dn=this.points[le[Ve+Cn]];ft=Dn.properties;const[jn,qn]=Dn.geometry.coordinates;tt=kt(jn),Bt=zn(qn)}const Ht={type:1,geometry:[[Math.round(this.options.extent*(tt*Ce-Te)),Math.round(this.options.extent*(Bt*Ce-Oe))]],tags:ft};let rn;rn=rt||this.options.generateId?le[Ve+Cn]:this.points[le[Ve+Cn]].id,rn!==void 0&&(Ht.id=rn),Be.features.push(Ht)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,le){const{radius:Te,extent:Oe,reduce:Ce,minPoints:Be}=this.options,Ue=Te/(Oe*Math.pow(2,le)),Ve=ne.data,rt=[],ft=this.stride;for(let tt=0;tt<Ve.length;tt+=ft){if(Ve[tt+2]<=le)continue;Ve[tt+2]=le;const Bt=Ve[tt],Ht=Ve[tt+1],rn=ne.within(Ve[tt],Ve[tt+1],Ue),Dn=Ve[tt+Vt];let jn=Dn;for(const qn of rn){const er=qn*ft;Ve[er+2]>le&&(jn+=Ve[er+Vt])}if(jn>Dn&&jn>=Be){let qn,er=Bt*Dn,Ci=Ht*Dn,nr=-1;const Zr=(tt/ft<<5)+(le+1)+this.points.length;for(const _r of rn){const Xr=_r*ft;if(Ve[Xr+2]<=le)continue;Ve[Xr+2]=le;const ni=Ve[Xr+Vt];er+=Ve[Xr]*ni,Ci+=Ve[Xr+1]*ni,Ve[Xr+4]=Zr,Ce&&(qn||(qn=this._map(Ve,tt,!0),nr=this.clusterProps.length,this.clusterProps.push(qn)),Ce(qn,this._map(Ve,Xr)))}Ve[tt+4]=Zr,rt.push(er/jn,Ci/jn,1/0,Zr,-1,jn),Ce&&rt.push(nr)}else{for(let qn=0;qn<ft;qn++)rt.push(Ve[tt+qn]);if(jn>1)for(const qn of rn){const er=qn*ft;if(!(Ve[er+2]<=le)){Ve[er+2]=le;for(let Ci=0;Ci<ft;Ci++)rt.push(Ve[er+Ci])}}}}return rt}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,le,Te){if(ne[le+Vt]>1){const Be=this.clusterProps[ne[le+lr]];return Te?Object.assign({},Be):Be}const Oe=this.points[ne[le+Cn]].properties,Ce=this.options.map(Oe);return Te&&Ce===Oe?Object.assign({},Ce):Ce}}function gn(it,ne,le){return{type:"Feature",id:it[ne+Cn],properties:xn(it,ne,le),geometry:{type:"Point",coordinates:[(Te=it[ne],360*(Te-.5)),fr(it[ne+1])]}};var Te}function xn(it,ne,le){const Te=it[ne+Vt],Oe=Te>=1e4?`${Math.round(Te/1e3)}k`:Te>=1e3?Math.round(Te/100)/10+"k":Te,Ce=it[ne+lr],Be=Ce===-1?{}:Object.assign({},le[Ce]);return Object.assign(Be,{cluster:!0,cluster_id:it[ne+Cn],point_count:Te,point_count_abbreviated:Oe})}function kt(it){return it/360+.5}function zn(it){const ne=Math.sin(it*Math.PI/180),le=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return le<0?0:le>1?1:le}function fr(it){const ne=(180-360*it)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function hi(it,ne,le,Te){let Oe=Te;const Ce=ne+(le-ne>>1);let Be,Ue=le-ne;const Ve=it[ne],rt=it[ne+1],ft=it[le],tt=it[le+1];for(let Bt=ne+3;Bt<le;Bt+=3){const Ht=br(it[Bt],it[Bt+1],Ve,rt,ft,tt);if(Ht>Oe)Be=Bt,Oe=Ht;else if(Ht===Oe){const rn=Math.abs(Bt-Ce);rn<Ue&&(Be=Bt,Ue=rn)}}Oe>Te&&(Be-ne>3&&hi(it,ne,Be,Te),it[Be+2]=Oe,le-Be>3&&hi(it,Be,le,Te))}function br(it,ne,le,Te,Oe,Ce){let Be=Oe-le,Ue=Ce-Te;if(Be!==0||Ue!==0){const Ve=((it-le)*Be+(ne-Te)*Ue)/(Be*Be+Ue*Ue);Ve>1?(le=Oe,Te=Ce):Ve>0&&(le+=Be*Ve,Te+=Ue*Ve)}return Be=it-le,Ue=ne-Te,Be*Be+Ue*Ue}function Pi(it,ne,le,Te){const Oe={id:it??null,type:ne,geometry:le,tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")Ye(Oe,le);else if(ne==="Polygon")Ye(Oe,le[0]);else if(ne==="MultiLineString")for(const Ce of le)Ye(Oe,Ce);else if(ne==="MultiPolygon")for(const Ce of le)Ye(Oe,Ce[0]);return Oe}function Ye(it,ne){for(let le=0;le<ne.length;le+=3)it.minX=Math.min(it.minX,ne[le]),it.minY=Math.min(it.minY,ne[le+1]),it.maxX=Math.max(it.maxX,ne[le]),it.maxY=Math.max(it.maxY,ne[le+1])}function wt(it,ne,le,Te){if(!ne.geometry)return;const Oe=ne.geometry.coordinates;if(Oe&&Oe.length===0)return;const Ce=ne.geometry.type,Be=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2);let Ue=[],Ve=ne.id;if(le.promoteId?Ve=ne.properties[le.promoteId]:le.generateId&&(Ve=Te||0),Ce==="Point")Rt(Oe,Ue);else if(Ce==="MultiPoint")for(const rt of Oe)Rt(rt,Ue);else if(Ce==="LineString")pn(Oe,Ue,Be,!1);else if(Ce==="MultiLineString"){if(le.lineMetrics){for(const rt of Oe)Ue=[],pn(rt,Ue,Be,!1),it.push(Pi(Ve,"LineString",Ue,ne.properties));return}dn(Oe,Ue,Be,!1)}else if(Ce==="Polygon")dn(Oe,Ue,Be,!0);else{if(Ce!=="MultiPolygon"){if(Ce==="GeometryCollection"){for(const rt of ne.geometry.geometries)wt(it,{id:Ve,geometry:rt,properties:ne.properties},le,Te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const rt of Oe){const ft=[];dn(rt,ft,Be,!0),Ue.push(ft)}}it.push(Pi(Ve,Ce,Ue,ne.properties))}function Rt(it,ne){ne.push(sn(it[0]),Ln(it[1]),0)}function pn(it,ne,le,Te){let Oe,Ce,Be=0;for(let Ve=0;Ve<it.length;Ve++){const rt=sn(it[Ve][0]),ft=Ln(it[Ve][1]);ne.push(rt,ft,0),Ve>0&&(Be+=Te?(Oe*ft-rt*Ce)/2:Math.sqrt(Math.pow(rt-Oe,2)+Math.pow(ft-Ce,2))),Oe=rt,Ce=ft}const Ue=ne.length-3;ne[2]=1,hi(ne,0,Ue,le),ne[Ue+2]=1,ne.size=Math.abs(Be),ne.start=0,ne.end=ne.size}function dn(it,ne,le,Te){for(let Oe=0;Oe<it.length;Oe++){const Ce=[];pn(it[Oe],Ce,le,Te),ne.push(Ce)}}function sn(it){return it/360+.5}function Ln(it){const ne=Math.sin(it*Math.PI/180),le=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return le<0?0:le>1?1:le}function ur(it,ne,le,Te,Oe,Ce,Be,Ue){if(Te/=ne,Ce>=(le/=ne)&&Be<Te)return it;if(Be<le||Ce>=Te)return null;const Ve=[];for(const rt of it){const ft=rt.geometry;let tt=rt.type;const Bt=Oe===0?rt.minX:rt.minY,Ht=Oe===0?rt.maxX:rt.maxY;if(Bt>=le&&Ht<Te){Ve.push(rt);continue}if(Ht<le||Bt>=Te)continue;let rn=[];if(tt==="Point"||tt==="MultiPoint")li(ft,rn,le,Te,Oe);else if(tt==="LineString")Si(ft,rn,le,Te,Oe,!1,Ue.lineMetrics);else if(tt==="MultiLineString")La(ft,rn,le,Te,Oe,!1);else if(tt==="Polygon")La(ft,rn,le,Te,Oe,!0);else if(tt==="MultiPolygon")for(const Dn of ft){const jn=[];La(Dn,jn,le,Te,Oe,!0),jn.length&&rn.push(jn)}if(rn.length){if(Ue.lineMetrics&&tt==="LineString"){for(const Dn of rn)Ve.push(Pi(rt.id,tt,Dn,rt.tags));continue}tt!=="LineString"&&tt!=="MultiLineString"||(rn.length===1?(tt="LineString",rn=rn[0]):tt="MultiLineString"),tt!=="Point"&&tt!=="MultiPoint"||(tt=rn.length===3?"Point":"MultiPoint"),Ve.push(Pi(rt.id,tt,rn,rt.tags))}}return Ve.length?Ve:null}function li(it,ne,le,Te,Oe){for(let Ce=0;Ce<it.length;Ce+=3){const Be=it[Ce+Oe];Be>=le&&Be<=Te&&Uo(ne,it[Ce],it[Ce+1],it[Ce+2])}}function Si(it,ne,le,Te,Oe,Ce,Be){let Ue=la(it);const Ve=Oe===0?vo:ws;let rt,ft,tt=it.start;for(let jn=0;jn<it.length-3;jn+=3){const qn=it[jn],er=it[jn+1],Ci=it[jn+2],nr=it[jn+3],Zr=it[jn+4],_r=Oe===0?qn:er,Xr=Oe===0?nr:Zr;let ni=!1;Be&&(rt=Math.sqrt(Math.pow(qn-nr,2)+Math.pow(er-Zr,2))),_r<le?Xr>le&&(ft=Ve(Ue,qn,er,nr,Zr,le),Be&&(Ue.start=tt+rt*ft)):_r>Te?Xr<Te&&(ft=Ve(Ue,qn,er,nr,Zr,Te),Be&&(Ue.start=tt+rt*ft)):Uo(Ue,qn,er,Ci),Xr<le&&_r>=le&&(ft=Ve(Ue,qn,er,nr,Zr,le),ni=!0),Xr>Te&&_r<=Te&&(ft=Ve(Ue,qn,er,nr,Zr,Te),ni=!0),!Ce&&ni&&(Be&&(Ue.end=tt+rt*ft),ne.push(Ue),Ue=la(it)),Be&&(tt+=rt)}let Bt=it.length-3;const Ht=it[Bt],rn=it[Bt+1],Dn=Oe===0?Ht:rn;Dn>=le&&Dn<=Te&&Uo(Ue,Ht,rn,it[Bt+2]),Bt=Ue.length-3,Ce&&Bt>=3&&(Ue[Bt]!==Ue[0]||Ue[Bt+1]!==Ue[1])&&Uo(Ue,Ue[0],Ue[1],Ue[2]),Ue.length&&ne.push(Ue)}function la(it){const ne=[];return ne.size=it.size,ne.start=it.start,ne.end=it.end,ne}function La(it,ne,le,Te,Oe,Ce){for(const Be of it)Si(Be,ne,le,Te,Oe,Ce,!1)}function Uo(it,ne,le,Te){it.push(ne,le,Te)}function vo(it,ne,le,Te,Oe,Ce){const Be=(Ce-ne)/(Te-ne);return Uo(it,Ce,le+(Oe-le)*Be,1),Be}function ws(it,ne,le,Te,Oe,Ce){const Be=(Ce-le)/(Oe-le);return Uo(it,ne+(Te-ne)*Be,Ce,1),Be}function Ta(it,ne){const le=[];for(let Te=0;Te<it.length;Te++){const Oe=it[Te],Ce=Oe.type;let Be;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")Be=Lo(Oe.geometry,ne);else if(Ce==="MultiLineString"||Ce==="Polygon"){Be=[];for(const Ue of Oe.geometry)Be.push(Lo(Ue,ne))}else if(Ce==="MultiPolygon"){Be=[];for(const Ue of Oe.geometry){const Ve=[];for(const rt of Ue)Ve.push(Lo(rt,ne));Be.push(Ve)}}le.push(Pi(Oe.id,Ce,Be,Oe.tags))}return le}function Lo(it,ne){const le=[];le.size=it.size,it.start!==void 0&&(le.start=it.start,le.end=it.end);for(let Te=0;Te<it.length;Te+=3)le.push(it[Te]+ne,it[Te+1],it[Te+2]);return le}function ns(it,ne){if(it.transformed)return it;const le=1<<it.z,Te=it.x,Oe=it.y;for(const Ce of it.features){const Be=Ce.geometry,Ue=Ce.type;if(Ce.geometry=[],Ue===1)for(let Ve=0;Ve<Be.length;Ve+=2)Ce.geometry.push(za(Be[Ve],Be[Ve+1],ne,le,Te,Oe));else for(let Ve=0;Ve<Be.length;Ve++){const rt=[];for(let ft=0;ft<Be[Ve].length;ft+=2)rt.push(za(Be[Ve][ft],Be[Ve][ft+1],ne,le,Te,Oe));Ce.geometry.push(rt)}}return it.transformed=!0,it}function za(it,ne,le,Te,Oe,Ce){return[Math.round(le*(it*Te-Oe)),Math.round(le*(ne*Te-Ce))]}function Ou(it,ne,le,Te,Oe){const Ce=ne===Oe.maxZoom?0:Oe.tolerance/((1<<ne)*Oe.extent),Be={features:[],numPoints:0,numSimplified:0,numFeatures:it.length,source:null,x:le,y:Te,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ue of it)di(Be,Ue,Ce,Oe);return Be}function di(it,ne,le,Te){const Oe=ne.geometry,Ce=ne.type,Be=[];if(it.minX=Math.min(it.minX,ne.minX),it.minY=Math.min(it.minY,ne.minY),it.maxX=Math.max(it.maxX,ne.maxX),it.maxY=Math.max(it.maxY,ne.maxY),Ce==="Point"||Ce==="MultiPoint")for(let Ue=0;Ue<Oe.length;Ue+=3)Be.push(Oe[Ue],Oe[Ue+1]),it.numPoints++,it.numSimplified++;else if(Ce==="LineString")rs(Be,Oe,it,le,!1,!1);else if(Ce==="MultiLineString"||Ce==="Polygon")for(let Ue=0;Ue<Oe.length;Ue++)rs(Be,Oe[Ue],it,le,Ce==="Polygon",Ue===0);else if(Ce==="MultiPolygon")for(let Ue=0;Ue<Oe.length;Ue++){const Ve=Oe[Ue];for(let rt=0;rt<Ve.length;rt++)rs(Be,Ve[rt],it,le,!0,rt===0)}if(Be.length){let Ue=ne.tags||null;if(Ce==="LineString"&&Te.lineMetrics){Ue={};for(const rt in ne.tags)Ue[rt]=ne.tags[rt];Ue.mapbox_clip_start=Oe.start/Oe.size,Ue.mapbox_clip_end=Oe.end/Oe.size}const Ve={geometry:Be,type:Ce==="Polygon"||Ce==="MultiPolygon"?3:Ce==="LineString"||Ce==="MultiLineString"?2:1,tags:Ue};ne.id!==null&&(Ve.id=ne.id),it.features.push(Ve)}}function rs(it,ne,le,Te,Oe,Ce){const Be=Te*Te;if(Te>0&&ne.size<(Oe?Be:Te))return void(le.numPoints+=ne.length/3);const Ue=[];for(let Ve=0;Ve<ne.length;Ve+=3)(Te===0||ne[Ve+2]>Be)&&(le.numSimplified++,Ue.push(ne[Ve],ne[Ve+1])),le.numPoints++;Oe&&function(Ve,rt){let ft=0;for(let tt=0,Bt=Ve.length,Ht=Bt-2;tt<Bt;Ht=tt,tt+=2)ft+=(Ve[tt]-Ve[Ht])*(Ve[tt+1]+Ve[Ht+1]);if(ft>0===rt)for(let tt=0,Bt=Ve.length;tt<Bt/2;tt+=2){const Ht=Ve[tt],rn=Ve[tt+1];Ve[tt]=Ve[Bt-2-tt],Ve[tt+1]=Ve[Bt-1-tt],Ve[Bt-2-tt]=Ht,Ve[Bt-1-tt]=rn}}(Ue,Ce),it.push(Ue)}const Kl={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Na{constructor(ne,le){const Te=(le=this.options=function(Ce,Be){for(const Ue in Be)Ce[Ue]=Be[Ue];return Ce}(Object.create(Kl),le)).debug;if(Te&&console.time("preprocess data"),le.maxZoom<0||le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(le.promoteId&&le.generateId)throw new Error("promoteId and generateId cannot be used together.");let Oe=function(Ce,Be){const Ue=[];if(Ce.type==="FeatureCollection")for(let Ve=0;Ve<Ce.features.length;Ve++)wt(Ue,Ce.features[Ve],Be,Ve);else wt(Ue,Ce.type==="Feature"?Ce:{geometry:Ce},Be);return Ue}(ne,le);this.tiles={},this.tileCoords=[],Te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",le.indexMaxZoom,le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Oe=function(Ce,Be){const Ue=Be.buffer/Be.extent;let Ve=Ce;const rt=ur(Ce,1,-1-Ue,Ue,0,-1,2,Be),ft=ur(Ce,1,1-Ue,2+Ue,0,-1,2,Be);return(rt||ft)&&(Ve=ur(Ce,1,-Ue,1+Ue,0,-1,2,Be)||[],rt&&(Ve=Ta(rt,1).concat(Ve)),ft&&(Ve=Ve.concat(Ta(ft,-1)))),Ve}(Oe,le),Oe.length&&this.splitTile(Oe,0,0,0),Te&&(Oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ne,le,Te,Oe,Ce,Be,Ue){const Ve=[ne,le,Te,Oe],rt=this.options,ft=rt.debug;for(;Ve.length;){Oe=Ve.pop(),Te=Ve.pop(),le=Ve.pop(),ne=Ve.pop();const tt=1<<le,Bt=Yl(le,Te,Oe);let Ht=this.tiles[Bt];if(!Ht&&(ft>1&&console.time("creation"),Ht=this.tiles[Bt]=Ou(ne,le,Te,Oe,rt),this.tileCoords.push({z:le,x:Te,y:Oe}),ft)){ft>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",le,Te,Oe,Ht.numFeatures,Ht.numPoints,Ht.numSimplified),console.timeEnd("creation"));const ni=`z${le}`;this.stats[ni]=(this.stats[ni]||0)+1,this.total++}if(Ht.source=ne,Ce==null){if(le===rt.indexMaxZoom||Ht.numPoints<=rt.indexMaxPoints)continue}else{if(le===rt.maxZoom||le===Ce)continue;if(Ce!=null){const ni=Ce-le;if(Te!==Be>>ni||Oe!==Ue>>ni)continue}}if(Ht.source=null,ne.length===0)continue;ft>1&&console.time("clipping");const rn=.5*rt.buffer/rt.extent,Dn=.5-rn,jn=.5+rn,qn=1+rn;let er=null,Ci=null,nr=null,Zr=null,_r=ur(ne,tt,Te-rn,Te+jn,0,Ht.minX,Ht.maxX,rt),Xr=ur(ne,tt,Te+Dn,Te+qn,0,Ht.minX,Ht.maxX,rt);ne=null,_r&&(er=ur(_r,tt,Oe-rn,Oe+jn,1,Ht.minY,Ht.maxY,rt),Ci=ur(_r,tt,Oe+Dn,Oe+qn,1,Ht.minY,Ht.maxY,rt),_r=null),Xr&&(nr=ur(Xr,tt,Oe-rn,Oe+jn,1,Ht.minY,Ht.maxY,rt),Zr=ur(Xr,tt,Oe+Dn,Oe+qn,1,Ht.minY,Ht.maxY,rt),Xr=null),ft>1&&console.timeEnd("clipping"),Ve.push(er||[],le+1,2*Te,2*Oe),Ve.push(Ci||[],le+1,2*Te,2*Oe+1),Ve.push(nr||[],le+1,2*Te+1,2*Oe),Ve.push(Zr||[],le+1,2*Te+1,2*Oe+1)}}getTile(ne,le,Te){ne=+ne,le=+le,Te=+Te;const Oe=this.options,{extent:Ce,debug:Be}=Oe;if(ne<0||ne>24)return null;const Ue=1<<ne,Ve=Yl(ne,le=le+Ue&Ue-1,Te);if(this.tiles[Ve])return ns(this.tiles[Ve],Ce);Be>1&&console.log("drilling down to z%d-%d-%d",ne,le,Te);let rt,ft=ne,tt=le,Bt=Te;for(;!rt&&ft>0;)ft--,tt>>=1,Bt>>=1,rt=this.tiles[Yl(ft,tt,Bt)];return rt&&rt.source?(Be>1&&(console.log("found parent tile z%d-%d-%d",ft,tt,Bt),console.time("drilling down")),this.splitTile(rt.source,ft,tt,Bt,ne,le,Te),Be>1&&console.timeEnd("drilling down"),this.tiles[Ve]?ns(this.tiles[Ve],Ce):null):null}}function Yl(it,ne,le){return 32*((1<<it)*le+ne)+it}function is(it,ne){const le=it.tileID.canonical;if(!this._geoJSONIndex)return void ne(null,null);const Te=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!Te)return void ne(null,null);const Oe=new se(Te.features);let Ce=Ft(Oe);Ce.byteOffset===0&&Ce.byteLength===Ce.buffer.byteLength||(Ce=new Uint8Array(Ce)),ne(null,{vectorTile:Oe,rawData:Ce.buffer})}class ku extends j{constructor(ne,le,Te,Oe,Ce,Be,Ue){super(ne,le,Te,Oe,Ce,is,Ue),Be&&(this.loadGeoJSON=Be),this._dynamicIndex=new ze}loadData(ne,le){const Te=ne&&ne.request,Oe=Te&&Te.collectResourceTiming;this.loadGeoJSON(ne,(Ce,Be)=>{if(Ce||!Be)return le(Ce);if(typeof Be!="object")return le(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));{try{if(ne.filter){const Ve=i.X(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ve.result==="error")throw new Error(Ve.value.map(rt=>`${rt.key}: ${rt.message}`).join(", "));Be.features=Be.features.filter(rt=>Ve.value.evaluate({zoom:0},rt))}ne.dynamic?(Be.type==="Feature"&&(Be={type:"FeatureCollection",features:[Be]}),ne.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Be.features,this.loaded),ne.cluster&&(Be.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ne.cluster?new Nt(function({superclusterOptions:Ve,clusterProperties:rt}){if(!rt||!Ve)return Ve;const ft={},tt={},Bt={accumulated:null,zoom:0},Ht={properties:null},rn=Object.keys(rt);for(const Dn of rn){const[jn,qn]=rt[Dn],er=i.X(qn),Ci=i.X(typeof jn=="string"?[jn,["accumulated"],["get",Dn]]:jn);ft[Dn]=er.value,tt[Dn]=Ci.value}return Ve.map=Dn=>{Ht.properties=Dn;const jn={};for(const qn of rn)jn[qn]=ft[qn].evaluate(Bt,Ht);return jn},Ve.reduce=(Dn,jn)=>{Ht.properties=jn;for(const qn of rn)Bt.accumulated=Dn[qn],Dn[qn]=tt[qn].evaluate(Bt,Ht)},Ve}(ne)).load(Be.features):ne.dynamic?this._dynamicIndex:function(Ve,rt){return new Na(Ve,rt)}(Be,ne.geojsonVtOptions)}catch(Ve){return le(Ve)}const Ue={};if(Oe){const Ve=v(Te);Ve&&(Ue.resourceTiming={},Ue.resourceTiming[ne.source]=JSON.parse(JSON.stringify(Ve)))}le(null,Ue)}})}reloadTile(ne,le){const Te=this.loaded;return Te&&Te[ne.uid]?ne.partial?le(null,void 0):super.reloadTile(ne,le):this.loadTile(ne,le)}loadGeoJSON(ne,le){if(ne.request)i.n(ne.request,le);else{if(typeof ne.data!="string")return le(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(ne.data))}catch{return le(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ne,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId))}catch(Te){le(Te)}}getClusterChildren(ne,le){try{le(null,this._geoJSONIndex.getChildren(ne.clusterId))}catch(Te){le(Te)}}getClusterLeaves(ne,le){try{le(null,this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset))}catch(Te){le(Te)}}}class yt{constructor(ne,le){this.tileID=new i.aM(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.tileZoom=ne.tileZoom,this.uid=ne.uid,this.zoom=ne.zoom,this.canonical=ne.tileID.canonical,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ne.projection,this.brightness=le}parse(ne,le,Te,Oe){this.status="parsing";const Ce=new i.aM(Te.tileID.overscaledZ,Te.tileID.wrap,Te.tileID.canonical.z,Te.tileID.canonical.x,Te.tileID.canonical.y),Be=[],Ue=le.familiesBySource[Te.source],Ve=new i.f0(Ce,Te.promoteId);Ve.bucketLayerIDs=[],Ve.is3DTile=!0,i.fi(ne).then(rt=>{if(!rt)return Oe(new Error("Could not parse tile"));const ft=i.fj(rt,1/i.cT(Te.tileID.canonical)),tt=rt.json.extensionsUsed&&rt.json.extensionsUsed.includes("MAPBOX_mesh_features")||rt.json.asset.extras&&rt.json.asset.extras.MAPBOX_mesh_features,Bt=rt.json.extensionsUsed&&rt.json.extensionsUsed.includes("EXT_meshopt_compression"),Ht=new i.aa(this.zoom,{brightness:this.brightness});for(const rn in Ue)for(const Dn of Ue[rn]){const jn=Dn[0];Ve.bucketLayerIDs.push(Dn.map(er=>i.C(er.id,er.scope))),jn.recalculate(Ht,[]);const qn=new i.fk(Dn,ft,Ce,tt,Bt,this.brightness,Ve);tt||(qn.needsUpload=!0),Be.push(qn),qn.evaluate(jn)}this.status="done",Oe(null,{buckets:Be,featureIndex:Ve,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(rt=>Oe(new Error(rt.message)))}}class ti{constructor(ne,le,Te,Oe,Ce,Be,Ue){this.actor=ne,this.layerIndex=le,this.availableImages=Te,this.availableModels=Oe,this.brightness=Ue,this.loading={},this.loaded={}}loadTile(ne,le){const Te=ne.uid,Oe=this.loading[Te]=new yt(ne,this.brightness);i.br(ne.request,(Ce,Be)=>{const Ue=!this.loading[Te];return delete this.loading[Te],Ue||Ce?(Oe.status="done",Ue||(this.loaded[Te]=Oe),le(Ce)):Be&&Be.byteLength!==0?void Oe.parse(Be,this.layerIndex,ne,(Ve,rt)=>{Oe.status="done",this.loaded=this.loaded||{},this.loaded[Te]=Oe,Ve||!rt?le(Ve):le(null,rt)}):(Oe.status="done",this.loaded[Te]=Oe,le())})}reloadTile(ne,le){const Te=this.loaded,Oe=ne.uid;if(Te&&Te[Oe]){const Ce=Te[Oe];Ce.projection=ne.projection,Ce.brightness=ne.brightness;const Be=(Ue,Ve)=>{Ce.reloadCallback&&(delete Ce.reloadCallback,this.loadTile(ne,le)),le(Ue,Ve)};Ce.status==="parsing"?Ce.reloadCallback=Be:Ce.status==="done"&&this.loadTile(ne,le)}}abortTile(ne,le){const Te=ne.uid;this.loading[Te]&&delete this.loading[Te],le()}removeTile(ne,le){const Te=this.loaded,Oe=ne.uid;Te&&Te[Oe]&&delete Te[Oe],le()}}class Fi{constructor(ne){this.self=ne,this.actor=new i.fm(ne,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new i.y,this.projections={},this.defaultProjection=i.ce({name:"mercator"}),this.workerSourceTypes={vector:j,geojson:ku,"raster-dem":V,"raster-array":H,"batched-model":ti},this.workerSources={},this.self.registerWorkerSource=(le,Te)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=Te},this.self.registerRTLTextPlugin=le=>{if(i.fn.isParsed())throw new Error("RTL text plugin already registered.");i.fn.applyArabicShaping=le.applyArabicShaping,i.fn.processBidirectionalText=le.processBidirectionalText,i.fn.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(ne,le,Te){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.availableModels[ne],delete this.workerSources[ne],Te()}checkIfReady(ne,le,Te){Te()}setReferrer(ne,le){this.referrer=le}spriteLoaded(ne,le){this.isSpriteLoaded[ne]||(this.isSpriteLoaded[ne]={});const{scope:Te,isLoaded:Oe}=le;if(this.isSpriteLoaded[ne][Te]=Oe,this.workerSources[ne]&&this.workerSources[ne][Te])for(const Ce in this.workerSources[ne][Te]){const Be=this.workerSources[ne][Te][Ce];for(const Ue in Be){const Ve=Be[Ue];Ve instanceof j&&(Ve.isSpriteLoaded=Oe,Ve.fire(new i.A("isSpriteLoaded")))}}}setImages(ne,le,Te){this.availableImages[ne]||(this.availableImages[ne]={});const{scope:Oe,images:Ce}=le;if(this.availableImages[ne][Oe]=Ce,this.workerSources[ne]&&this.workerSources[ne][Oe]){for(const Be in this.workerSources[ne][Oe]){const Ue=this.workerSources[ne][Oe][Be];for(const Ve in Ue)Ue[Ve].availableImages=Ce}Te()}else Te()}setModels(ne,{scope:le,models:Te},Oe){if(this.availableModels[ne]||(this.availableModels[ne]={}),this.availableModels[ne][le]=Te,this.workerSources[ne]&&this.workerSources[ne][le]){for(const Ce in this.workerSources[ne][le]){const Be=this.workerSources[ne][le][Ce];for(const Ue in Be)Be[Ue].availableModels=Te}Oe()}else Oe()}setProjection(ne,le){this.projections[ne]=i.ce(le)}setBrightness(ne,le,Te){this.brightness=le,Te()}setLayers(ne,le,Te){this.getLayerIndex(ne,le.scope).replace(le.layers,le.options),Te()}updateLayers(ne,le,Te){this.getLayerIndex(ne,le.scope).update(le.layers,le.removedIds,le.options),Te()}loadTile(ne,le,Te){le.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,le.type,le.source,le.scope).loadTile(le,Te)}decodeRasterArray(ne,le,Te){this.getWorkerSource(ne,le.type,le.source,le.scope).decodeRasterArray(le,Te)}reloadTile(ne,le,Te){le.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,le.type,le.source,le.scope).reloadTile(le,Te)}abortTile(ne,le,Te){this.getWorkerSource(ne,le.type,le.source,le.scope).abortTile(le,Te)}removeTile(ne,le,Te){this.getWorkerSource(ne,le.type,le.source,le.scope).removeTile(le,Te)}removeSource(ne,le,Te){if(!(this.workerSources[ne]&&this.workerSources[ne][le.scope]&&this.workerSources[ne][le.scope][le.type]&&this.workerSources[ne][le.scope][le.type][le.source]))return;const Oe=this.workerSources[ne][le.scope][le.type][le.source];delete this.workerSources[ne][le.scope][le.type][le.source],Oe.removeSource!==void 0?Oe.removeSource(le,Te):Te()}loadWorkerSource(ne,le,Te){try{this.self.importScripts(le.url),Te()}catch(Oe){Te(Oe.toString())}}syncRTLPluginState(ne,le,Te){try{i.fn.setState(le);const Oe=i.fn.getPluginURL();if(i.fn.isLoaded()&&!i.fn.isParsed()&&Oe!=null){this.self.importScripts(Oe);const Ce=i.fn.isParsed();Te(Ce?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Oe}`),Ce)}}catch(Oe){Te(Oe.toString())}}setDracoUrl(ne,le){this.dracoUrl=le}getAvailableImages(ne,le){this.availableImages[ne]||(this.availableImages[ne]={});let Te=this.availableImages[ne][le];return Te||(Te=[]),Te}getAvailableModels(ne,le){this.availableModels[ne]||(this.availableModels[ne]={});let Te=this.availableModels[ne][le];return Te||(Te={}),Te}getLayerIndex(ne,le){this.layerIndexes[ne]||(this.layerIndexes[ne]={});let Te=this.layerIndexes[ne][le];return Te||(Te=this.layerIndexes[ne][le]=new A,Te.scope=le),Te}getWorkerSource(ne,le,Te,Oe){const Ce=this.workerSources;return Ce[ne]||(Ce[ne]={}),Ce[ne][Oe]||(Ce[ne][Oe]={}),Ce[ne][Oe][le]||(Ce[ne][Oe][le]={}),this.isSpriteLoaded[ne]||(this.isSpriteLoaded[ne]={}),Ce[ne][Oe][le][Te]||(Ce[ne][Oe][le][Te]=new this.workerSourceTypes[le]({send:(Be,Ue,Ve,rt,ft,tt)=>this.actor.send(Be,Ue,Ve,ne,ft,tt),scheduler:this.actor.scheduler},this.getLayerIndex(ne,Oe),this.getAvailableImages(ne,Oe),this.getAvailableModels(ne,Oe),this.isSpriteLoaded[ne][Oe],void 0,this.brightness)),Ce[ne][Oe][le][Te]}rasterizeImagesWorker(ne,le,Te){const Oe=new Map;for(const[Ce,{image:Be,imageVariant:Ue}]of le.tasks.entries()){const Ve=this.imageRasterizer.rasterize(Ue,Be,le.scope,ne);Oe.set(Ce,Ve)}Te(void 0,Oe)}removeRasterizedImages(ne,le,Te){this.imageRasterizer.removeImagesFromCacheByIds(le.imageIds,le.scope,ne),Te()}enforceCacheSizeLimit(ne,le){i.fo(le)}getWorkerPerformanceMetrics(ne,le,Te){Te(void 0,void 0)}}return i.fl(self)&&(self.worker=new Fi(self)),Fi}),c(["./shared"],function(i){var v="3.12.0";const b={create:"create",load:"load",fullLoad:"fullLoad"},T={mark(m){performance.mark(m)},measure(m,s,h){performance.measure(m,s,h)}};function A(m){const s=m.name.split("?")[0];return i.a(s)&&s.includes("mapbox-gl.js")?"javascript":i.a(s)&&s.includes("mapbox-gl.css")?"css":i.b(s)?"fontRange":i.c(s)?"sprite":i.i(s)?"style":i.d(s)?"tilejson":"other"}var M,R={},B=function(){if(M)return R;function m(g){return!s(g)}function s(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,E,C=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(C);try{E=new Worker(O),w=!0}catch{w=!1}return E&&E.terminate(),URL.revokeObjectURL(O),w}()?function(){var w=document.createElement("canvas");w.width=w.height=1;var E=w.getContext("2d");if(!E)return!1;var C=E.getImageData(0,0,1,1);return C&&C.width===w.width}()?(h[x=g&&g.failIfMajorPerformanceCaveat]===void 0&&(h[x]=function(w){var E,C=function(O){var z=document.createElement("canvas"),F=Object.create(m.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=O,z.getContext("webgl2",F)}(w);if(!C)return!1;try{E=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!E||C.isContextLost())&&(C.shaderSource(E,"void main() {}"),C.compileShader(E),C.getShaderParameter(E,C.COMPILE_STATUS)===!0)}(x)),h[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}M=1,R.supported=m,R.notSupportedReason=s;var h={};return m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},R}();function L(m,s,h){const g=document.createElement(m);return s!=null&&(g.className=s),h&&h.appendChild(g),g}function j(m,s,h){const g=document.createElementNS("http://www.w3.org/2000/svg",m);for(const x of Object.keys(s))g.setAttributeNS(null,x,String(s[x]));return h&&h.appendChild(g),g}const V=typeof document<"u"?document.documentElement&&document.documentElement.style:null,$=V&&V.userSelect!==void 0?"userSelect":"WebkitUserSelect";let H;function K(){V&&$&&(H=V[$],V[$]="none")}function Y(){V&&$&&(V[$]=H)}function se(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",se,!0)}function ce(){window.addEventListener("click",se,!0),window.setTimeout(()=>{window.removeEventListener("click",se,!0)},0)}function ye(m,s){const h=m.getBoundingClientRect();return je(m,h,s)}function ze(m,s){const h=m.getBoundingClientRect(),g=[];for(let x=0;x<s.length;x++)g.push(je(m,h,s[x]));return g}function Le(m){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&m.button===2&&m.ctrlKey?0:m.button}function je(m,s,h){const g=m.offsetWidth===s.width?1:m.offsetWidth/s.width;return new i.P((h.clientX-s.left)*g,(h.clientY-s.top)*g)}const Re="01",$e="NO_ACCESS_TOKEN";class Ge{constructor(s,h,g){this._transformRequestFn=s,this._customAccessToken=h,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const s=function(){let h="";for(let g=0;g<10;g++)h+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Re,h].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,h){return this._transformRequestFn&&this._transformRequestFn(s,h)||{url:s}}normalizeStyleURL(s,h){if(!i.f(s))return s;const g=ot(s);return g.params.push(`sdk=js-${v}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||h)}normalizeGlyphsURL(s,h){if(!i.f(s))return s;const g=ot(s);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||h)}normalizeModelURL(s,h){if(!i.f(s))return s;const g=ot(s);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||h)}normalizeSourceURL(s,h,g,x){if(!i.f(s))return s;const w=ot(s);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),g&&w.params.push(`language=${g}`),x&&w.params.push(`worldview=${x}`),this._makeAPIURL(w,this._customAccessToken||h)}normalizeIconsetURL(s,h){const g=ot(s);return i.f(s)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||h)):Je(g)}normalizeSpriteURL(s,h,g,x){const w=ot(s);return i.f(s)?(w.path=`/styles/v1${w.path}/sprite${h}${g}`,this._makeAPIURL(w,this._customAccessToken||x)):(w.path+=`${h}${g}`,Je(w))}normalizeTileURL(s,h,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!i.f(s))return s;const x=ot(s);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${h||g&&x.authority!=="raster"&&g===512?"@2x":""}${i.m.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${i.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${i.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${i.e.TILE_URL_VERSION}${x.path}`);const w=this._customAccessToken||function(E){for(const C of E){const O=C.match(/^access_token=(.*)$/);if(O)return O[1]}return null}(x.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,w)}canonicalizeTileURL(s,h){const g=ot(s);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return s;let x="mapbox://";g.path.match(/^\/raster\/v1\//)?x+=`raster/${g.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${g.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${g.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let w=g.params;return h&&(w=w.filter(E=>!E.match(/^access_token=/))),w.length&&(x+=`?${w.join("&")}`),x}canonicalizeTileset(s,h){const g=!!h&&i.f(h),x=[];for(const w of s.tiles||[])i.h(w)?x.push(this.canonicalizeTileURL(w,g)):x.push(w);return x}_makeAPIURL(s,h){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=ot(i.e.API_URL);if(s.protocol=x.protocol,s.authority=x.authority,s.protocol==="http"){const w=s.params.indexOf("secure");w>=0&&s.params.splice(w,1)}if(x.path!=="/"&&(s.path=`${x.path}${s.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Je(s);if(h=h||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!h)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if(h[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return s.params=s.params.filter(w=>w.indexOf("access_token")===-1),s.params.push(`access_token=${h||""}`),Je(s)}}const ht=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ot(m){const s=m.match(ht);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function Je(m){const s=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${s}`}const Ne="mapbox.eventData";function Xe(m){if(!m)return null;const s=m.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(i.j(s[1]))}catch{return null}}class pt{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const h=Xe(i.e.ACCESS_TOKEN);let g="";return g=h&&h.u?i.k(h.u):i.e.ACCESS_TOKEN||"",s?`${Ne}.${s}:${g}`:`${Ne}:${g}`}fetchEventData(){const s=i.s("localStorage"),h=this.getStorageKey(),g=this.getStorageKey("uuid");if(s)try{const x=localStorage.getItem(h);x&&(this.eventData=JSON.parse(x));const w=localStorage.getItem(g);w&&(this.anonId=w)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const s=i.s("localStorage"),h=this.getStorageKey(),g=this.getStorageKey("uuid"),x=this.anonId;if(s&&x)try{localStorage.setItem(g,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(h,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,h,g,x){if(!i.e.EVENTS_URL)return;const w=ot(i.e.EVENTS_URL);w.params.push(`access_token=${x||i.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(s).toISOString()},C=h?i.l(E,h):E,O={url:Je(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=i.p(O,z=>{this.pendingRequest=null,g(z),this.saveEventData(),this.processRequests(x)})}queueRequest(s,h){this.queue.push(s),this.processRequests(h)}}const zt=new class extends pt{constructor(m){super("appUserTurnstile"),this._customAccessToken=m}postTurnstileEvent(m,s){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(m)&&m.some(h=>i.f(h)||i.h(h))&&this.queueRequest(Date.now(),s)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Xe(i.e.ACCESS_TOKEN),h=s?s.u:i.e.ACCESS_TOKEN;let g=h!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),g=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),E=new Date(x),C=(x-this.eventData.lastSuccess)/864e5;g=g||C>=1||C<-1||w.getDate()!==E.getDate()}else g=!0;g?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:v,skuId:Re,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=x,this.eventData.tokenU=h)},m):this.processRequests()}},Ft=zt.postTurnstileEvent.bind(zt),un=new class extends pt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(m,s,h,g){this.skuToken=s,this.errorCb=g,i.e.EVENTS_URL&&(h||i.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},h):this.errorCb(new Error($e)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:h}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:v,skuId:Re,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},m))}remove(){this.errorCb=null}},Tn=un.postMapLoadEvent.bind(un),fn=new class extends pt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(m){let s=this.mapInstanceIdMap.get(m);return s||(s=i.u(),this.mapInstanceIdMap.set(m,s)),s}getEventId(m){const s=this.eventIdPerMapInstanceMap.get(m)||0;return this.eventIdPerMapInstanceMap.set(m,s+1),s}postStyleLoadEvent(m,s){const{map:h,style:g,importedStyles:x}=s;if(!i.e.EVENTS_URL||!m&&!i.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(h),E={mapInstanceId:w,eventId:this.getEventId(w),style:g};x.length&&(E.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:E},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:h}=this.queue.shift();this.postEvent(s,h,()=>{},m)}},Cn=fn.postStyleLoadEvent.bind(fn),Vt=new class extends pt{constructor(){super("gljs.performance")}postPerformanceEvent(m,s){i.e.EVENTS_URL&&(m||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:h}=this.queue.shift(),g=function(x){const w=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),C=function(Z){const te={};if(Z){for(const ee in Z)if(ee!=="other")for(const oe of Z[ee]){const re=`${ee}ResolveRangeMin`,fe=`${ee}ResolveRangeMax`,_e=`${ee}RequestCount`,be=`${ee}RequestCachedCount`;te[re]=Math.min(te[re]||1/0,oe.startTime),te[fe]=Math.max(te[fe]||-1/0,oe.responseEnd);const Pe=Ee=>{te[Ee]===void 0&&(te[Ee]=0),++te[Ee]};oe.transferSize!==void 0&&oe.transferSize===0&&Pe(be),Pe(_e)}}return te}(function(Z,te){const ee={};if(Z)for(const oe of Z){const re=te(oe);ee[re]===void 0&&(ee[re]=[]),ee[re].push(oe)}return ee}(w,A)),O=window.devicePixelRatio,z=navigator.connection||navigator.mozConnection||navigator.webkitConnection,F=z?z.effectiveType:void 0,G={counters:[],metadata:[],attributes:[]},U=(Z,te,ee)=>{ee!=null&&Z.push({name:te,value:ee.toString()})};for(const Z in C)U(G.counters,Z,C[Z]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(U(G.counters,"interactionRangeMin",x.interactionRange[0]),U(G.counters,"interactionRangeMax",x.interactionRange[1])),E)for(const Z of Object.keys(b)){const te=b[Z],ee=E.find(oe=>oe.name===te);ee&&U(G.counters,te,ee.startTime)}return U(G.counters,"visibilityHidden",x.visibilityHidden),U(G.attributes,"style",function(Z){if(Z)for(const te of Z){const ee=te.name.split("?")[0];if(i.i(ee)){const oe=ee.split("/").slice(-2);if(oe.length===2)return`mapbox://styles/${oe[0]}/${oe[1]}`}}}(w)),U(G.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),U(G.attributes,"fogEnabled",x.fogEnabled?"true":"false"),U(G.attributes,"projection",x.projection),U(G.attributes,"zoom",x.zoom),U(G.metadata,"devicePixelRatio",O),U(G.metadata,"connectionEffectiveType",F),U(G.metadata,"navigatorUserAgent",navigator.userAgent),U(G.metadata,"screenWidth",window.screen.width),U(G.metadata,"screenHeight",window.screen.height),U(G.metadata,"windowWidth",window.innerWidth),U(G.metadata,"windowHeight",window.innerHeight),U(G.metadata,"mapWidth",x.width/O),U(G.metadata,"mapHeight",x.height/O),U(G.metadata,"webglRenderer",x.renderer),U(G.metadata,"webglVendor",x.vendor),U(G.metadata,"sdkVersion",v),U(G.metadata,"sdkIdentifier","mapbox-gl-js"),G}(h);for(const x of g.metadata);for(const x of g.counters);for(const x of g.attributes);this.postEvent(s,g,()=>{},m)}},lr=Vt.postPerformanceEvent.bind(Vt),Nt=new class extends pt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(m,s,h,g){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const x=ot(i.e.API_URL+i.e.SESSION_PATH);x.params.push(`sku=${s||""}`),x.params.push(`access_token=${g||i.e.ACCESS_TOKEN||""}`);const w={url:Je(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(w,E=>{this.pendingRequest=null,h(E),this.saveEventData(),this.processRequests(g)})}getSessionAPI(m,s,h,g){this.skuToken=s,this.errorCb=g,i.e.SESSION_PATH&&i.e.API_URL&&(h||i.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},h):this.errorCb(new Error($e)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:h}=this.queue.shift();s&&this.success[s]||this.getSession(h,this.skuToken,g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},m)}remove(){this.errorCb=null}},gn=Nt.getSessionAPI.bind(Nt),xn=new Set;function kt(m,s){s?xn.add(m):xn.delete(m)}class zn{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,h){this._updatedSourceCaches[s]=h,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const h=s.scope;this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._updatedLayers[h].add(s.id),this.setDirty()}removeLayer(s){const h=s.scope;this._removedLayers[h]=this._removedLayers[h]||{},this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._removedLayers[h][s.id]=s,this._updatedLayers[h].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const h in this._updatedLayers)s[h]=s[h]||{},s[h].updatedIds=Array.from(this._updatedLayers[h].values());for(const h in this._removedLayers)s[h]=s[h]||{},s[h].removedIds=Object.keys(this._removedLayers[h]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(s){return this._updatedImages[s]?Array.from(this._updatedImages[s].values()):[]}updateImage(s,h){this._updatedImages[h]=this._updatedImages[h]||new Set,this._updatedImages[h].add(i.I.toString(s)),this.setDirty()}resetUpdatedImages(s){this._updatedImages[s]&&this._updatedImages[s].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function fr(m){const{userImage:s}=m;return!!(s&&s.render&&s.render())&&(m.data.replace(new Uint8Array(s.data.buffer)),!0)}class hi extends i.E{constructor(s){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=s,s!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}addScope(s){this.loaded.set(s,!1),this.imageProviders.set(s,new Map),this.images.set(s,new Map),this.updatedImages.set(s,new Set),this.callbackDispatchedThisFrame.set(s,new Set),this.patterns.set(s,new Map),this.atlasImage.set(s,new i.r({width:1,height:1}))}removeScope(s){this.loaded.delete(s),this.imageProviders.delete(s),this.images.delete(s),this.updatedImages.delete(s),this.callbackDispatchedThisFrame.delete(s),this.patterns.delete(s),this.atlasImage.delete(s);const h=this.atlasTexture.get(s);h&&(h.destroy(),this.atlasTexture.delete(s))}addImageProvider(s,h){this.imageProviders.has(h)||this.imageProviders.set(h,new Map),this.imageProviders.get(h).set(s.id,s)}removeImageProvider(s,h){this.imageProviders.has(h)&&this.imageProviders.get(h).delete(s)}getPendingImageProviders(){const s=[];for(const h of this.imageProviders.values())for(const g of h.values())g.hasPendingRequests()&&s.push(g);return s}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.y),this._imageRasterizer}isLoaded(){for(const s of this.loaded.keys())if(!this.loaded.get(s))return!1;return!0}setLoaded(s,h){if(this.loaded.get(h)!==s&&(this.loaded.set(h,s),s)){for(const{ids:g,callback:x}of this.requestors)this._notify(g,h,x);this.requestors=[]}}hasImage(s,h){return!!this.getImage(s,h)}getImage(s,h){return this.images.get(h).get(s.toString())}addImage(s,h,g){this._validate(s,g)&&this.images.get(h).set(s.toString(),g)}_validate(s,h){let g=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "stretchX" value`))),g=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "stretchY" value`))),g=!1),this._validateContent(h.content,h)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "content" value`))),g=!1),g}_validateStretch(s,h){if(!s)return!0;let g=0;for(const x of s){if(x[0]<g||x[1]<x[0]||h<x[1])return!1;g=x[1]}return!0}_validateContent(s,h){return s?s.length!==4||!h.usvg&&(s[0]<0||h.data.width<s[0]||s[1]<0||h.data.height<s[1]||s[2]<0||h.data.width<s[2]||s[3]<0||h.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,h,g){const x=this.images.get(h).get(s.toString());g.version=x.version+1,this.images.get(h).set(s.toString(),g),this.updatedImages.get(h).add(s),this.removeFromImageRasterizerCache(s,h)}clearUpdatedImages(s){this.updatedImages.get(s).clear()}removeFromImageRasterizerCache(s,h){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[s],scope:h}):this.imageRasterizer.removeImagesFromCacheByIds([s],h))}removeImage(s,h){const g=this.images.get(h),x=g.get(s.toString());g.delete(s.toString()),this.patterns.get(h).delete(s.toString()),this.removeFromImageRasterizerCache(s,h),x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(s){return Array.from(this.images.get(s).keys()).map(h=>i.I.from(h))}getImages(s,h,g){const x=[],w=[],E=this.imageProviders.get(h);for(const F of s){if(!F.iconsetId){x.push(F);continue}const G=E.get(F.iconsetId);G&&(this.getImage(F,h)?w.push(F):G.addPendingRequest(F))}if(x.length===0)return void this._notify(w,h,g);let C=!0;const O=!!this.loaded.get(h),z=this.images.get(h);if(!O)for(const F of x)z.has(F.toString())||(C=!1);O||C?this._notify(x,h,g):this.requestors.push({ids:x,scope:h,callback:g})}rasterizeImages(s,h){const g=new Map,{tasks:x,scope:w}=s;for(const[E,C]of x.entries()){const O=this.getImage(C.id,w);O&&g.set(E,{image:O,imageVariant:C})}this._rasterizeImages(w,g,h)}_rasterizeImages(s,h,g){if(i.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:h,scope:s},g);else{const x=new Map;for(const[w,{image:E,imageVariant:C}]of h.entries())x.set(w,this.imageRasterizer.rasterize(C,E,s,0));g(void 0,x)}}getUpdatedImages(s){return this.updatedImages.get(s)||new Set}_notify(s,h,g){const x=this.images.get(h),w=new Map;for(const E of s){if(!x.get(E.toString())){if(E.iconsetId)continue;this.fire(new i.A("styleimagemissing",{id:E.name}))}const C=x.get(E.toString());if(!C){i.w(`Image "${E.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const O={data:C.usvg?null:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,usvg:C.usvg,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)};C.usvg&&Object.assign(O,{width:C.icon.usvg_tree.width,height:C.icon.usvg_tree.height}),w.set(i.I.toString(E),O)}g(null,w)}getPixelSize(s){const{width:h,height:g}=this.atlasImage.get(s);return{width:h,height:g}}getPattern(s,h,g){const x=s.toString(),w=this.patterns.get(h),E=w.get(x),C=this.getImage(s,h);if(!C)return null;if(E){if(E.position.version===C.version)return E.position;E.position.version=C.version}else{if(C.usvg&&!C.data){const O=this.getPatternInFlightId(x,h);if(this.patternsInFlight.has(O))return null;this.patternsInFlight.add(O);const z=new i.B(s).scaleSelf(i.q.devicePixelRatio),F=new Map([[z.toString(),{image:C,imageVariant:z}]]);return this._rasterizeImages(h,F,(G,U)=>this.storePatternImage(z,h,C,g,U)),null}this.storePattern(s,h,C)}return this._updatePatternAtlas(h,g),w.get(x).position}getPatternInFlightId(s,h){return i.C(s,h)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(s,h,g,x,w){const E=s.toString(),C=w?w.get(E):void 0;C&&(g.data=C,this.storePattern(s.id,h,g),this._updatePatternAtlas(h,x),this.patternsInFlight.delete(this.getPatternInFlightId(s.id.toString(),h)))}storePattern(s,h,g){const x={w:g.data.width+2*i.F,h:g.data.height+2*i.F,x:0,y:0},w=new i.G(x,g,i.F);this.patterns.get(h).set(s.toString(),{bin:x,position:w})}bind(s,h){const g=s.gl;let x=this.atlasTexture.get(h);x?this.dirty&&(x.update(this.atlasImage.get(h)),this.dirty=!1):(x=new i.T(s,this.atlasImage.get(h),g.RGBA8),this.atlasTexture.set(h,x)),x.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(s,h){const g=this.patterns.get(s),x=Array.from(g.values()).map(({bin:z})=>z),{w,h:E}=i.H(x),C=this.atlasImage.get(s);C.resize({width:w||1,height:E||1});const O=this.images.get(s);for(const[z,{bin:F,position:G}]of g.entries()){let U=G.padding;const Z=F.x+U,te=F.y+U,ee=O.get(z).data,oe=ee.width,re=ee.height;U=U>1?U-1:U,i.r.copy(ee,C,{x:0,y:0},{x:Z,y:te},{width:oe,height:re},h),i.r.copy(ee,C,{x:0,y:re-U},{x:Z,y:te-U},{width:oe,height:U},h),i.r.copy(ee,C,{x:0,y:0},{x:Z,y:te+re},{width:oe,height:U},h),i.r.copy(ee,C,{x:oe-U,y:0},{x:Z-U,y:te},{width:U,height:re},h),i.r.copy(ee,C,{x:0,y:0},{x:Z+oe,y:te},{width:U,height:re},h),i.r.copy(ee,C,{x:oe-U,y:re-U},{x:Z-U,y:te-U},{width:U,height:U},h),i.r.copy(ee,C,{x:0,y:re-U},{x:Z+oe,y:te-U},{width:U,height:U},h),i.r.copy(ee,C,{x:0,y:0},{x:Z+oe,y:te+re},{width:U,height:U},h),i.r.copy(ee,C,{x:oe-U,y:0},{x:Z-U,y:te+re},{width:U,height:U},h)}this.dirty=!0}beginFrame(){for(const s of this.images.keys())this.callbackDispatchedThisFrame.set(s,new Set)}dispatchRenderCallbacks(s,h){const g=this.images.get(h);for(const x of s){if(this.callbackDispatchedThisFrame.get(h).has(x.toString()))continue;this.callbackDispatchedThisFrame.get(h).add(x.toString());const w=g.get(x.toString());fr(w)&&this.updateImage(x,h,w)}}}function br(m){const s=m.key,h=m.value,g=m.valueSpec||{},x=m.objectElementValidators||{},w=m.style,E=m.styleSpec;let C=[];const O=i.K(h);if(O!=="object")return[new i.V(s,h,`object expected, ${O} found`)];for(const z in h){const F=z.split(".")[0];let G;x[F]?G=x[F]:g[F]?G=di:x["*"]?G=x["*"]:g["*"]&&(G=di),G?C=C.concat(G({key:(s&&`${s}.`)+z,value:h[z],valueSpec:g[F]||g["*"],style:w,styleSpec:E,object:h,objectKey:z},h)):C.push(new i.J(s,h[z],`unknown property "${z}"`))}for(const z in g)x[z]||g[z].required&&g[z].default===void 0&&h[z]===void 0&&C.push(new i.V(s,h,`missing required property "${z}"`));return C}function Pi(m){const s=m.value,h=m.valueSpec,g=m.style,x=m.styleSpec,w=m.key,E=m.arrayElementValidator||di;if(i.K(s)!=="array")return[new i.V(w,s,`array expected, ${i.K(s)} found`)];if(h.length&&s.length!==h.length)return[new i.V(w,s,`array length ${h.length} expected, length ${s.length} found`)];if(h["min-length"]&&s.length<h["min-length"])return[new i.V(w,s,`array length at least ${h["min-length"]} expected, length ${s.length} found`)];let C={type:h.value,values:h.values,minimum:h.minimum,maximum:h.maximum,function:void 0};x.$version<7&&(C.function=h.function),i.K(h.value)==="object"&&(C=h.value);let O=[];for(let z=0;z<s.length;z++)O=O.concat(E({array:s,arrayIndex:z,value:s[z],valueSpec:C,style:g,styleSpec:x,key:`${w}[${z}]`},!0));return O}function Ye(m){const s=m.key,h=m.value,g=m.valueSpec;let x=i.K(h);if(x==="number"&&h!=h&&(x="NaN"),x!=="number")return[new i.V(s,h,`number expected, ${x} found`)];if("minimum"in g){let w=g.minimum;if(i.K(g.minimum)==="array"&&(w=g.minimum[m.arrayIndex]),h<w)return[new i.V(s,h,`${h} is less than the minimum value ${w}`)]}if("maximum"in g){let w=g.maximum;if(i.K(g.maximum)==="array"&&(w=g.maximum[m.arrayIndex]),h>w)return[new i.V(s,h,`${h} is greater than the maximum value ${w}`)]}return[]}function wt(m){const s=m.valueSpec,h=i.M(m.value.type);let g,x,w,E={};const C=h!=="categorical"&&m.value.property===void 0,O=!C,z=i.K(m.value.stops)==="array"&&i.K(m.value.stops[0])==="array"&&i.K(m.value.stops[0][0])==="object",F=br({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(Z){if(h==="identity")return[new i.V(Z.key,Z.value,'identity function may not have a "stops" property')];let te=[];const ee=Z.value;return te=te.concat(Pi({key:Z.key,value:ee,valueSpec:Z.valueSpec,style:Z.style,styleSpec:Z.styleSpec,arrayElementValidator:G})),i.K(ee)==="array"&&ee.length===0&&te.push(new i.V(Z.key,ee,"array must have at least one stop")),te},default:function(Z){return di({key:Z.key,value:Z.value,valueSpec:s,style:Z.style,styleSpec:Z.styleSpec})}}});return h==="identity"&&C&&F.push(new i.V(m.key,m.value,'missing required property "property"')),h==="identity"||m.value.stops||F.push(new i.V(m.key,m.value,'missing required property "stops"')),h==="exponential"&&m.valueSpec.expression&&!i.N(m.valueSpec)&&F.push(new i.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(O&&!i.O(m.valueSpec)?F.push(new i.V(m.key,m.value,"property functions not supported")):C&&!i.Q(m.valueSpec)&&F.push(new i.V(m.key,m.value,"zoom functions not supported"))),h!=="categorical"&&!z||m.value.property!==void 0||F.push(new i.V(m.key,m.value,'"property" property is required')),F;function G(Z){let te=[];const ee=Z.value,oe=Z.key;if(i.K(ee)!=="array")return[new i.V(oe,ee,`array expected, ${i.K(ee)} found`)];if(ee.length!==2)return[new i.V(oe,ee,`array length 2 expected, length ${ee.length} found`)];if(z){if(i.K(ee[0])!=="object")return[new i.V(oe,ee,`object expected, ${i.K(ee[0])} found`)];if(ee[0].zoom===void 0)return[new i.V(oe,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new i.V(oe,ee,"object stop key must have value")];const re=i.M(ee[0].zoom);if(typeof re!="number")return[new i.V(oe,ee[0].zoom,"stop zoom values must be numbers")];if(w&&w>re)return[new i.V(oe,ee[0].zoom,"stop zoom values must appear in ascending order")];re!==w&&(w=re,x=void 0,E={}),te=te.concat(br({key:`${oe}[0]`,value:ee[0],valueSpec:{zoom:{}},style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{zoom:Ye,value:U}}))}else te=te.concat(U({key:`${oe}[0]`,value:ee[0],valueSpec:{},style:Z.style,styleSpec:Z.styleSpec},ee));return i.S(i.U(ee[1]))?te.concat([new i.V(`${oe}[1]`,ee[1],"expressions are not allowed in function stops.")]):te.concat(di({key:`${oe}[1]`,value:ee[1],valueSpec:s,style:Z.style,styleSpec:Z.styleSpec}))}function U(Z,te){const ee=i.K(Z.value),oe=i.M(Z.value),re=Z.value!==null?Z.value:te;if(g){if(ee!==g)return[new i.V(Z.key,re,`${ee} stop domain type must match previous stop domain type ${g}`)]}else g=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean"&&typeof oe!="number"&&typeof oe!="string"&&typeof oe!="boolean")return[new i.V(Z.key,re,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&h!=="categorical"){let fe=`number expected, ${ee} found`;return i.O(s)&&h===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(Z.key,re,fe)]}return h!=="categorical"||ee!=="number"||typeof oe=="number"&&isFinite(oe)&&Math.floor(oe)===oe?h!=="categorical"&&ee==="number"&&typeof oe=="number"&&typeof x=="number"&&x!==void 0&&oe<x?[new i.V(Z.key,re,"stop domain values must appear in ascending order")]:(x=oe,h==="categorical"&&oe in E?[new i.V(Z.key,re,"stop domain values must be unique")]:(E[oe]=!0,[])):[new i.V(Z.key,re,`integer expected, found ${String(oe)}`)]}}function Rt(m){const s=(m.expressionContext==="property"?i.W:i.X)(i.U(m.value),m.valueSpec);if(s.result==="error")return s.value.map(g=>new i.V(`${m.key}${g.key}`,m.value,g.message));const h=s.value.expression||s.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!h.outputDefined())return[new i.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!i.Y(h))return[new i.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return pn(h,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!i.Z(h,["zoom","feature-state"]))return[new i.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!i._(h))return[new i.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function pn(m,s){const h=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const x of s.valueSpec.expression.parameters)h.delete(x);if(h.size===0)return[];const g=[];return m instanceof i.$&&h.has(m.name)?[new i.V(s.key,s.value,`["${m.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(m.eachChild(x=>{g.push(...pn(x,s))}),g)}function dn(m){const s=m.key,h=m.value,g=m.valueSpec,x=[];return Array.isArray(g.values)?g.values.indexOf(i.M(h))===-1&&x.push(new i.V(s,h,`expected one of [${g.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(g.values).indexOf(i.M(h))===-1&&x.push(new i.V(s,h,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(h)} found`)),x}function sn(m){return i.a1(i.U(m.value))?Rt(i.L({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):Ln(m)}function Ln(m){const s=m.value,h=m.key;if(i.K(s)!=="array")return[new i.V(h,s,`array expected, ${i.K(s)} found`)];const g=m.styleSpec;let x,w=[];if(s.length<1)return[new i.V(h,s,"filter array must have at least 1 element")];switch(w=w.concat(dn({key:`${h}[0]`,value:s[0],valueSpec:g.filter_operator,style:m.style,styleSpec:m.styleSpec})),i.M(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&i.M(s[1])==="$type"&&w.push(new i.V(h,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&w.push(new i.V(h,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(x=i.K(s[1]),x!=="string"&&w.push(new i.V(`${h}[1]`,s[1],`string expected, ${x} found`)));for(let E=2;E<s.length;E++)x=i.K(s[E]),i.M(s[1])==="$type"?w=w.concat(dn({key:`${h}[${E}]`,value:s[E],valueSpec:g.geometry_type,style:m.style,styleSpec:m.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&w.push(new i.V(`${h}[${E}]`,s[E],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let E=1;E<s.length;E++)w=w.concat(Ln({key:`${h}[${E}]`,value:s[E],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":x=i.K(s[1]),s.length!==2?w.push(new i.V(h,s,`filter array for "${s[0]}" operator must have 2 elements`)):x!=="string"&&w.push(new i.V(`${h}[1]`,s[1],`string expected, ${x} found`))}return w}function ur(m,s){const h=m.key,g=m.style,x=m.layer,w=m.styleSpec,E=m.value,C=m.objectKey,O=w[`${s}_${m.layerType}`];if(!O)return[];const z=C.match(/^(.*)-use-theme$/);if(s==="paint"&&z&&O[z[1]])return i.S(E)?[].concat(di({key:m.key,value:E,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:g,styleSpec:w,expressionContext:"property",propertyType:s,propertyKey:C})):di({key:h,value:E,valueSpec:{type:"string"},style:g,styleSpec:w});const F=C.match(/^(.*)-transition$/);if(s==="paint"&&F&&O[F[1]]&&O[F[1]].transition)return di({key:h,value:E,valueSpec:w.transition,style:g,styleSpec:w});const G=m.valueSpec||O[C];if(!G)return[new i.J(h,E,`unknown property "${C}"`)];let U;if(i.K(E)==="string"&&i.O(G)&&!G.tokens&&(U=/^{([^}]+)}$/.exec(E))){const te=`\`{ "type": "identity", "property": ${U?JSON.stringify(U[1]):'"_"'} }\``;return[new i.V(h,E,`"${C}" does not support interpolation syntax
Use an identity property function instead: ${te}.`)]}const Z=[];if(m.layerType==="symbol")C!=="text-field"||!g||g.glyphs||g.imports||Z.push(new i.V(h,E,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&i.a2(i.U(E))&&i.M(E.type)==="identity"&&Z.push(new i.V(h,E,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&s==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&i.O(G)&&(i.a3(G)||i.Q(G))){const te=i.W(i.U(E),G),ee=te.value.expression||te.value._styleExpression.expression;ee&&!i.Z(ee,["measure-light"])&&(C==="model-emissive-strength"&&i._(ee)&&i.Y(ee)||Z.push(new i.V(h,E,`${C} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Z.concat(di({key:m.key,value:E,valueSpec:G,style:g,styleSpec:w,expressionContext:"property",propertyType:s,propertyKey:C}))}function li(m){return ur(m,"paint")}function Si(m){return ur(m,"layout")}function la(m){let s=[];const h=m.value,g=m.key,x=m.style,w=m.styleSpec;h.type||h.ref||s.push(new i.V(g,h,'either "type" or "ref" is required'));let E=i.M(h.type);const C=i.M(h.ref);if(h.id){const O=i.M(h.id);for(let z=0;z<m.arrayIndex;z++){const F=x.layers[z];i.M(F.id)===O&&s.push(new i.V(g,h.id,`duplicate layer id "${h.id}", previously used at line ${F.id.__line__}`))}}if("ref"in h){let O;["type","source","source-layer","filter","layout"].forEach(z=>{z in h&&s.push(new i.V(g,h[z],`"${z}" is prohibited for ref layers`))}),x.layers.forEach(z=>{i.M(z.id)===C&&(O=z)}),O?O.ref?s.push(new i.V(g,h.ref,"ref cannot reference another ref layer")):E=i.M(O.type):typeof C=="string"&&s.push(new i.V(g,h.ref,`ref layer "${C}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(h.source){const O=x.sources&&x.sources[h.source],z=O&&i.M(O.type);O?z==="vector"&&E==="raster"?s.push(new i.V(g,h.source,`layer "${h.id}" requires a raster source`)):z==="raster"&&E!=="raster"?s.push(new i.V(g,h.source,`layer "${h.id}" requires a vector source`)):z!=="vector"||h["source-layer"]?z==="raster-dem"&&E!=="hillshade"?s.push(new i.V(g,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):z!=="raster-array"||["raster","raster-particle"].includes(E)?E==="line"&&h.paint&&(h.paint["line-gradient"]||h.paint["line-trim-offset"])&&z==="geojson"&&!O.lineMetrics?s.push(new i.V(g,h,`layer "${h.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):E==="raster-particle"&&z!=="raster-array"&&s.push(new i.V(g,h.source,`layer "${h.id}" requires a 'raster-array' source.`)):s.push(new i.V(g,h.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new i.V(g,h,`layer "${h.id}" must specify a "source-layer"`)):s.push(new i.V(g,h.source,`source "${h.source}" not found`))}else s.push(new i.V(g,h,'missing required property "source"'));return s=s.concat(br({key:g,value:h,valueSpec:w.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>di({key:`${g}.type`,value:h.type,valueSpec:w.layer.type,style:m.style,styleSpec:m.styleSpec,object:h,objectKey:"type"}),filter:O=>sn(i.L({layerType:E},O)),layout:O=>br({layer:h,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":z=>Si(i.L({layerType:E},z))}}),paint:O=>br({layer:h,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":z=>li(i.L({layerType:E,layer:h},z))}})}})),s}function La(m){const s=m.value,h=m.key,g=i.K(s);return g!=="string"?[new i.V(h,s,`string expected, ${g} found`)]:[]}const Uo={promoteId:function m({key:s,value:h}){if(i.K(h)==="string")return La({key:s,value:h});if(Array.isArray(h)){const g=[],x=i.U(h),w=i.X(x);return w.result==="error"&&w.value.forEach(E=>{g.push(new i.V(`${s}${E.key}`,null,`${E.message}`))}),i.Z(w.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||g.push(new i.V(`${s}`,null,"promoteId expression should be only feature dependent")),g}{const g=[];for(const x in h)g.push(...m({key:`${s}.${x}`,value:h[x]}));return g}}};function vo(m){const s=m.value,h=m.key,g=m.styleSpec,x=m.style;if(!s.type)return[new i.V(h,s,'"type" is required')];const w=i.M(s.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&(s.url||s.tiles||E.push(new i.J(h,s,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(br({key:h,value:s,valueSpec:g[`source_${w.replace("-","_")}`],style:m.style,styleSpec:g,objectElementValidators:Uo})),E;case"geojson":if(E=br({key:h,value:s,valueSpec:g.source_geojson,style:x,styleSpec:g,objectElementValidators:Uo}),s.cluster)for(const C in s.clusterProperties){const[O,z]=s.clusterProperties[C],F=typeof O=="string"?[O,["accumulated"],["get",C]]:O;E.push(...Rt({key:`${h}.${C}.map`,value:z,expressionContext:"cluster-map"})),E.push(...Rt({key:`${h}.${C}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return E;case"video":return br({key:h,value:s,valueSpec:g.source_video,style:x,styleSpec:g});case"image":return br({key:h,value:s,valueSpec:g.source_image,style:x,styleSpec:g});case"canvas":return[new i.V(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return dn({key:`${h}.type`,value:s.type,valueSpec:{values:ws(g)},style:x,styleSpec:g})}}function ws(m){return m.source.reduce((s,h)=>{const g=m[h];return g.type.type==="enum"&&(s=s.concat(Object.keys(g.type.values))),s},[])}function Ta(m){const s=m.value,h=m.styleSpec,g=h.light,x=m.style;let w=[];const E=i.K(s);if(s===void 0)return w;if(E!=="object")return w=w.concat([new i.V("light",s,`object expected, ${E} found`)]),w;for(const C in s){const O=C.match(/^(.*)-transition$/),z=C.match(/^(.*)-use-theme$/);w=w.concat(z&&g[z[1]]?di({key:C,value:s[C],valueSpec:{type:"string"},style:x,styleSpec:h}):O&&g[O[1]]&&g[O[1]].transition?di({key:C,value:s[C],valueSpec:h.transition,style:x,styleSpec:h}):g[C]?di({key:C,value:s[C],valueSpec:g[C],style:x,styleSpec:h}):[new i.V(C,s[C],`unknown property "${C}"`)])}return w}function Lo(m){const s=m.value;let h=[];if(!s)return h;const g=i.K(s);if(g!=="object")return h=h.concat([new i.V("light-3d",s,`object expected, ${g} found`)]),h;const x=m.styleSpec,w=x["light-3d"],E=m.key,C=m.style,O=m.style.lights;for(const G of["type","id"])if(!(G in s))return h=h.concat([new i.V("light-3d",s,`missing property ${G} on light`)]),h;if(s.type&&O)for(let G=0;G<m.arrayIndex;G++){const U=i.M(s.type),Z=O[G];i.M(Z.type)===U&&h.push(new i.V(E,s.id,`duplicate light type "${s.type}", previously defined at line ${Z.id.__line__}`))}const z=`properties_light_${s.type}`;if(!(z in x))return h=h.concat([new i.V("light-3d",s,`Invalid light type ${s.type}`)]),h;const F=x[z];for(const G in s)if(G==="properties"){const U=s[G],Z=i.K(U);if(Z!=="object")return h=h.concat([new i.V("properties",U,`object expected, ${Z} found`)]),h;for(const te in U)h=h.concat(F[te]?di({key:te,value:U[te],valueSpec:F[te],style:C,styleSpec:x}):[new i.J(m.key,U[te],`unknown property "${te}"`)])}else{const U=G.match(/^(.*)-transition$/),Z=G.match(/^(.*)-use-theme$/);h=h.concat(Z&&w[Z[1]]?di({key:G,value:s[G],valueSpec:{type:"string"},style:C,styleSpec:x}):U&&w[U[1]]&&w[U[1]].transition?di({key:G,value:s[G],valueSpec:x.transition,style:C,styleSpec:x}):w[G]?di({key:G,value:s[G],valueSpec:w[G],style:C,styleSpec:x}):[new i.J(G,s[G],`unknown property "${G}"`)])}return h}function ns(m){const s=m.value,h=m.key,g=m.style,x=m.styleSpec,w=x.terrain;let E=[];const C=i.K(s);if(s===void 0||C==="null")return E;if(C!=="object")return E=E.concat([new i.V("terrain",s,`object expected, ${C} found`)]),E;for(const O in s){const z=O.match(/^(.*)-transition$/),F=O.match(/^(.*)-use-theme$/);E=E.concat(F&&w[F[1]]?di({key:O,value:s[O],valueSpec:{type:"string"},style:g,styleSpec:x}):z&&w[z[1]]&&w[z[1]].transition?di({key:O,value:s[O],valueSpec:x.transition,style:g,styleSpec:x}):w[O]?di({key:O,value:s[O],valueSpec:w[O],style:g,styleSpec:x}):[new i.J(O,s[O],`unknown property "${O}"`)])}if(s.source){const O=g.sources&&g.sources[s.source],z=O&&i.M(O.type);O?z!=="raster-dem"&&E.push(new i.V(h,s.source,`terrain cannot be used with a source of type ${String(z)}, it only be used with a "raster-dem" source type`)):E.push(new i.V(h,s.source,`source "${s.source}" not found`))}else E.push(new i.V(h,s,'terrain is missing required property "source"'));return E}function za(m){const s=m.value,h=m.style,g=m.styleSpec,x=g.fog;let w=[];const E=i.K(s);if(s===void 0)return w;if(E!=="object")return w=w.concat([new i.V("fog",s,`object expected, ${E} found`)]),w;for(const C in s){const O=C.match(/^(.*)-transition$/),z=C.match(/^(.*)-use-theme$/);w=w.concat(z&&x[z[1]]?di({key:C,value:s[C],valueSpec:{type:"string"},style:h,styleSpec:g}):O&&x[O[1]]&&x[O[1]].transition?di({key:C,value:s[C],valueSpec:g.transition,style:h,styleSpec:g}):x[C]?di({key:C,value:s[C],valueSpec:x[C],style:h,styleSpec:g}):[new i.J(C,s[C],`unknown property "${C}"`)])}return w}const Ou={"*":()=>[],array:Pi,boolean:function(m){const s=m.value,h=m.key,g=i.K(s);return g!=="boolean"?[new i.V(h,s,`boolean expected, ${g} found`)]:[]},number:Ye,color:function(m){const s=m.key,h=m.value,g=i.K(h);return g!=="string"?[new i.V(s,h,`color expected, ${g} found`)]:i.a0.parseCSSColor(h)===null?[new i.V(s,h,`color expected, "${h}" found`)]:[]},enum:dn,filter:sn,function:wt,layer:la,object:br,source:vo,model:i.a4,light:Ta,"light-3d":Lo,terrain:ns,fog:za,string:La,formatted:function(m){return La(m).length===0?[]:Rt(m)},resolvedImage:function(m){return La(m).length===0?[]:Rt(m)},projection:function(m){const s=m.value,h=m.styleSpec,g=h.projection,x=m.style;let w=[];const E=i.K(s);if(E==="object")for(const C in s)w=w.concat(di({key:C,value:s[C],valueSpec:g[C],style:x,styleSpec:h}));else E!=="string"&&(w=w.concat([new i.V("projection",s,`object or string expected, ${E} found`)]));return w},import:function(m){const{value:s,styleSpec:h}=m,{data:g,...x}=s;Object.defineProperty(x,"__line__",{value:s.__line__,enumerable:!1});let w=br(i.L({},m,{value:x,valueSpec:h.import}));return i.M(x.id)===""&&w.push(new i.V(`${m.key}.id`,x,"import id can't be an empty string")),g&&(w=w.concat(Kl(g,h,{key:`${m.key}.data`}))),w},iconset:function(m){const s=m.value,h=m.key,g=m.styleSpec,x=m.style;if(!s.type)return[new i.V(h,s,'"type" is required')];const w=i.M(s.type);let E=[];if(E=E.concat(br({key:h,value:s,valueSpec:g[`iconset_${w}`],style:x,styleSpec:g})),w==="source"&&s.source){const C=x.sources&&x.sources[s.source],O=C&&i.M(C.type);C?O!=="raster-array"&&E.push(new i.V(h,s.source,`iconset cannot be used with a source of type ${String(O)}, it only be used with a "raster-array" source type`)):E.push(new i.V(h,s.source,`source "${s.source}" not found`))}return E}};function di(m,s=!1){const h=m.value,g=m.valueSpec,x=m.styleSpec;if(g.expression&&i.a2(i.M(h)))return wt(m);if(g.expression&&i.S(i.U(h)))return Rt(m);if(g.type&&Ou[g.type]){const w=Ou[g.type](m);return s===!0&&w.length>0&&i.K(m.value)==="array"?Rt(m):w}return br(i.L({},m,{valueSpec:g.type?x[g.type]:g}))}function rs(m){const s=m.value,h=m.key,g=La(m);return g.length||(s.indexOf("{fontstack}")===-1&&g.push(new i.V(h,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&g.push(new i.V(h,s,'"glyphs" url must include a "{range}" token'))),g}function Kl(m,s=i.a5,h={}){return di({key:h.key||"",value:m,valueSpec:s.$root,styleSpec:s,style:m,objectElementValidators:{glyphs:rs,"*":()=>[]}})}function Na(m,s=i.a5){return Be(Kl(m,s))}const Yl=m=>Be(vo(m)),is=m=>Be(Ta(m)),ku=m=>Be(Lo(m)),yt=m=>Be(ns(m)),ti=m=>Be(za(m)),Fi=m=>Be(function(s){const h=s.value,g=s.style,x=s.styleSpec,w=x.snow;let E=[];const C=i.K(h);if(h===void 0)return E;if(C!=="object")return E=E.concat([new i.V("snow",h,`object expected, ${C} found`)]),E;for(const O in h){const z=O.match(/^(.*)-transition$/);E=E.concat(z&&w[z[1]]&&w[z[1]].transition?di({key:O,value:h[O],valueSpec:x.transition,style:g,styleSpec:x}):w[O]?di({key:O,value:h[O],valueSpec:w[O],style:g,styleSpec:x}):[new i.J(O,h[O],`unknown property "${O}"`)])}return E}(m)),it=m=>Be(function(s){const h=s.value,g=s.style,x=s.styleSpec,w=x.rain;let E=[];const C=i.K(h);if(h===void 0)return E;if(C!=="object")return E=E.concat([new i.V("rain",h,`object expected, ${C} found`)]),E;for(const O in h){const z=O.match(/^(.*)-transition$/);E=E.concat(z&&w[z[1]]&&w[z[1]].transition?di({key:O,value:h[O],valueSpec:x.transition,style:g,styleSpec:x}):w[O]?di({key:O,value:h[O],valueSpec:w[O],style:g,styleSpec:x}):[new i.J(O,h[O],`unknown property "${O}"`)])}return E}(m)),ne=m=>Be(la(m)),le=m=>Be(sn(m)),Te=m=>Be(li(m)),Oe=m=>Be(Si(m)),Ce=m=>Be(i.a4(m));function Be(m){return m.slice().sort((s,h)=>s.line&&h.line?s.line-h.line:0)}function Ue(m,s){let h=!1;if(s&&s.length)for(const g of s)g instanceof i.J?i.w(g.message):(m.fire(new i.z(new Error(g.message))),h=!0);return h}let Ve;class rt extends i.E{constructor(s,h="flat"){super(),this._transitionable=new i.a6(Ve||(Ve=new i.a7({anchor:new i.a8(i.a5.light.anchor),position:new i.a9(i.a5.light.position),color:new i.a8(i.a5.light.color),intensity:new i.a8(i.a5.light.intensity)}))),this.setLight(s,h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,h,g={}){this._validate(is,s,g)||(this._transitionable.setTransitionOrValue(s),this.id=h)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,g){return(!g||g.validate!==!1)&&Ue(this,s.call(Na,i.l({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let ft=class extends i.E{constructor(m,s,h,g){super(),this.scope=h,this._transitionable=new i.a6(new i.a7({source:new i.a8(i.a5.terrain.source),exaggeration:new i.a8(i.a5.terrain.exaggeration)}),h,g),this._transitionable.setTransitionOrValue(m,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(m,s){this._transitionable.setTransitionOrValue(m,s)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new i.aa(m)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const m=this._transitionable._values.exaggeration;if(!m)return null;const s=m.value.expression;if(!s)return null;let h=-1,g=-1,x=1;for(const w of s.zoomStops)x=s.evaluate(new i.aa(w)),x>.01?(h=w,g=-1):g=w;return x<.01&&h>0&&g>h?[h,g]:null}isZoomDependent(){const m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof i.ab}};const tt=45,Bt=65,Ht=.05;function rn(m,s,h,g){const x=i.af(tt,Bt,h),[w,E]=Dn(m,g);let C=1-Math.min(1,Math.exp((s-w)/(E-w)*-6));return C*=C*C,C=Math.min(1,1.00747*C),C*x*m.alpha}function Dn(m,s){const h=.5/Math.tan(.5*s);return[m.range[0]+h,m.range[1]+h]}function jn(m,s,h,g,x){const w=i.ad([],[s,h,g],x.mercatorFogMatrix);return rn(m,i.ae(w),x.pitch,x._fov)}function qn(m,s,h,g,x,w,E){const C=[[h,g,0],[x,g,0],[x,w,0],[h,w,0]];let O=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(const F of C){const G=i.ad([],F,s),U=i.ae(G);O=Math.min(O,U),z=Math.max(z,U)}return[rn(m,O,E.pitch,E._fov),rn(m,z,E.pitch,E._fov)]}class er extends i.E{constructor(s,h,g,x){super();const w=new i.a7({range:new i.a8(i.a5.fog.range),color:new i.a8(i.a5.fog.color),"color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a8(i.a5.fog["high-color"]),"high-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a8(i.a5.fog["space-color"]),"space-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a8(i.a5.fog["horizon-blend"]),"star-intensity":new i.a8(i.a5.fog["star-intensity"]),"vertical-range":new i.a8(i.a5.fog["vertical-range"])});this._transitionable=new i.a6(w,g,new Map(x)),this.set(s,x),this._transitioning=this._transitionable.untransitioned(),this._transform=h,this.properties=new i.ag(w),this.scope=g}get state(){const s=this._transform,h=s.projection.name==="globe",g=i.ah(s.zoom),x=this.properties.get("range"),w=[.5,3];return{range:h?[i.ai(w[0],x[0],g),i.ai(w[1],x[1],g)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,h,g={}){if(this._validate(ti,s,g))return;const x=i.l({},s);for(const w of Object.keys(i.a5.fog))x[w]===void 0&&(x[w]=i.a5.fog[w].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,h)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.af(tt,Bt,s))*h.a}getOpacityAtLatLng(s,h){return this._transform.projection.supportsFog?function(g,x,w){const E=i.ac.fromLngLat(x),C=w.elevation?w.elevation.getAtPointOrZero(E):0;return jn(g,E.x,E.y,C,w)}(this.state,s,h):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const h=this._transform.calculateFogTileMatrix(s.toUnwrapped());return qn(this.state,h,0,0,i.aj,i.aj,this._transform)}getOpacityForBounds(s,h,g,x,w){return this._transform.projection.supportsFog?qn(this.state,s,h,g,x,w,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?Dn(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const h=[4,5,6,7];for(const g of h){const x=s.points[g];let w;if(x[2]>=0)w=x;else{const E=s.points[g-4];w=i.ak(E,x,E[2]/(E[2]-x[2]))}if(jn(this.state,w[0],w[1],0,this._transform)>=Ht)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,g){return(!g||g.validate!==!1)&&Ue(this,s.call(Na,i.l({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let Ci,nr,Zr,_r,Xr=class extends i.E{constructor(m,s,h,g){super();const x=Ci||(Ci=new i.a7({density:new i.a8(i.a5.snow.density),intensity:new i.a8(i.a5.snow.intensity),color:new i.a8(i.a5.snow.color),opacity:new i.a8(i.a5.snow.opacity),vignette:new i.a8(i.a5.snow.vignette),"vignette-color":new i.a8(i.a5.snow["vignette-color"]),"center-thinning":new i.a8(i.a5.snow["center-thinning"]),direction:new i.a8(i.a5.snow.direction),"flake-size":new i.a8(i.a5.snow["flake-size"])}));this._transitionable=new i.a6(x,h,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ag(x),this.scope=h}get state(){const m=this.properties.get("opacity"),s=this.properties.get("color"),h=this.properties.get("direction"),g=i.al(h[0]),x=-Math.max(i.al(h[1]),.01),w=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],E=this.properties.get("vignette"),C=this.properties.get("vignette-color");return C.a=E,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.am(s.r,s.g,s.b,s.a*m),direction:w,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:C}}get(){return this._transitionable.serialize()}set(m,s,h={}){if(this._validate(Fi,m,h))return;const g=i.l({},m);for(const x of Object.keys(i.a5.snow))g[x]===void 0&&(g[x]=i.a5.snow[x].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,s,h){return(!h||h.validate!==!1)&&Ue(this,m.call(Na,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}},ni=class extends i.E{constructor(m,s,h,g){super();const x=nr||(nr=new i.a7({density:new i.a8(i.a5.rain.density),intensity:new i.a8(i.a5.rain.intensity),color:new i.a8(i.a5.rain.color),opacity:new i.a8(i.a5.rain.opacity),vignette:new i.a8(i.a5.rain.vignette),"vignette-color":new i.a8(i.a5.rain["vignette-color"]),"center-thinning":new i.a8(i.a5.rain["center-thinning"]),direction:new i.a8(i.a5.rain.direction),"droplet-size":new i.a8(i.a5.rain["droplet-size"]),"distortion-strength":new i.a8(i.a5.rain["distortion-strength"])}));this._transitionable=new i.a6(x,h,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ag(x),this.scope=h}get state(){const m=this.properties.get("opacity"),s=this.properties.get("color"),h=this.properties.get("direction"),g=i.al(h[0]),x=-Math.max(i.al(h[1]),.01),w=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],E=this.properties.get("vignette-color");return E.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.am(s.r,s.g,s.b,s.a*m),direction:w,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(m,s,h={}){if(this._validate(it,m,h))return;const g=i.l({},m);for(const x of Object.keys(i.a5.rain))g[x]===void 0&&(g[x]=i.a5.rain[x].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,s,h){return(!h||h.validate!==!1)&&Ue(this,m.call(Na,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}};class ji extends i.E{constructor(s,h,g,x){super(),this.scope=g,this._options=s,this.properties=new i.ag(h),this._transitionable=new i.a6(h,g,new Map(x)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,h){this._options=s,this._transitionable.setTransitionOrValue(s.properties,h)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Ji{constructor(s,h,g,x){this.screenBounds=s,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(s,h){let g,x;if(s instanceof i.P||typeof s[0]=="number"){const w=i.P.convert(s);g=[w],x=h.isPointAboveHorizon(w)}else{const w=i.P.convert(s[0]),E=i.P.convert(s[1]),C=w.add(E)._div(2);g=[w,E],x=i.ao(w,E).every(O=>h.isPointAboveHorizon(O))&&h.isPointAboveHorizon(C)}return new Ji(g,h.getCameraPoint(),x,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return i.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const h=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.ao(h,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(x[3]=this.cameraPoint)),i.ap(x,s)}bufferedCameraGeometryGlobe(s){const h=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.ao(h,g,s),w=this.cameraPoint.clone();switch(3*((w.y>h.y)+(w.y>g.y))+((w.x>h.x)+(w.x>g.x))){case 0:x[0]=w,x[4]=w.clone();break;case 1:x.splice(1,0,w);break;case 2:x[1]=w;break;case 3:x.splice(4,0,w);break;case 5:x.splice(2,0,w);break;case 6:x[3]=w;break;case 7:x.splice(3,0,w);break;case 8:x[2]=w}return x}containsTile(s,h,g,x=0){const w=s.queryPadding/h._pixelsPerMercatorPixel+1,E=g?this._bufferedCameraMercator(w,h):this._bufferedScreenMercator(w,h);let C=s.tileID.wrap+(E.unwrapped?x:0);const O=E.polygon.map(oe=>i.aq(s.tileTransform,oe,C));if(!i.ar(O,0,0,i.aj,i.aj))return;C=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const z=this.screenGeometryMercator.polygon.map(oe=>i.as(s.tileTransform,oe,C)),F=z.map(oe=>new i.P(oe[0],oe[1])),G=h.getFreeCameraOptions().position||new i.ac(0,0,0),U=i.as(s.tileTransform,G,C),Z=z.map(oe=>{const re=i.at(oe,oe,U);return i.au(re,re),new i.av(U,re)}),te=i.aw(s,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:Z,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(ee=i.ax(O),ee.min.x=i.aD(ee.min.x,0,i.aj),ee.min.y=i.aD(ee.min.y,0,i.aj),ee.max.x=i.aD(ee.max.x,0,i.aj),ee.max.y=i.aD(ee.max.y,0,i.aj),ee),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:te};var ee}_bufferedScreenMercator(s,h){const g=Jl(s);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let x;return x=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),h):{polygon:this.bufferedScreenGeometry(s).map(w=>h.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(s,h){const g=Jl(s);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let x;return x=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),h):{polygon:this.bufferedCameraGeometry(s).map(w=>h.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[g]=x,x}}_projectAndResample(s,h){const g=function(w,E){const C=i.az([],E.pixelMatrix,E.globeMatrix),O=[0,-i.aE,0,1],z=[0,i.aE,0,1],F=[0,0,0,1];i.aA(O,O,C),i.aA(z,z,C),i.aA(F,F,C);const G=new i.P(O[0]/O[3],O[1]/O[3]),U=new i.P(z[0]/z[3],z[1]/z[3]),Z=i.aB(w,G)&&O[3]<F[3],te=i.aB(w,U)&&z[3]<F[3];if(!Z&&!te)return null;const ee=function(Ae,we,Me){for(let ke=1;ke<Ae.length;ke++){const Qe=zo(we.pointCoordinate3D(Ae[ke-1]).x),qe=zo(we.pointCoordinate3D(Ae[ke]).x);if(Me<0){if(Qe<qe)return{idx:ke,t:-Qe/(qe-1-Qe)}}else if(qe<Qe)return{idx:ke,t:(1-Qe)/(qe+1-Qe)}}return null}(w,E,Z?-1:1);if(!ee)return null;const{idx:oe,t:re}=ee;let fe=oe>1?xo(w.slice(0,oe),E):[],_e=oe<w.length?xo(w.slice(oe),E):[];fe=fe.map(Ae=>new i.P(zo(Ae.x),Ae.y)),_e=_e.map(Ae=>new i.P(zo(Ae.x),Ae.y));const be=[...fe];be.length===0&&be.push(_e[_e.length-1]);const Pe=i.ai(be[be.length-1].y,(_e.length===0?fe[0]:_e[0]).y,re);let Ee;return Ee=Z?[new i.P(0,Pe),new i.P(0,0),new i.P(1,0),new i.P(1,Pe)]:[new i.P(1,Pe),new i.P(1,1),new i.P(0,1),new i.P(0,Pe)],be.push(...Ee),_e.length===0?be.push(fe[0]):be.push(..._e),{polygon:be.map(Ae=>new i.ac(Ae.x,Ae.y)),unwrapped:!1}}(s,h);if(g)return g;const x=function(w,E){let C=!1,O=-1/0,z=0;for(let G=0;G<w.length-1;G++)w[G].x>O&&(O=w[G].x,z=G);for(let G=0;G<w.length-1;G++){const U=(z+G)%(w.length-1),Z=w[U],te=w[U+1];Math.abs(Z.x-te.x)>.5&&(Z.x<te.x?(Z.x+=1,U===0&&(w[w.length-1].x+=1)):(te.x+=1,U+1===w.length-1&&(w[0].x+=1)),C=!0)}const F=i.ay(E.center.lng);return C&&F<Math.abs(F-1)&&w.forEach(G=>{G.x-=1}),{polygon:w,unwrapped:C}}(xo(s,h).map(w=>new i.P(zo(w.x),w.y)),h);return{polygon:x.polygon.map(w=>new i.ac(w.x,w.y)),unwrapped:x.unwrapped}}}function xo(m,s){return i.aC(m,h=>{const g=s.pointCoordinate3D(h);h.x=g.x,h.y=g.y},1/256)}function zo(m){return m<0?1+m%1:m%1}function Jl(m){return 100*m|0}function Jo(m,s,h,g,x){const w=function(C,O){if(C)return x(C);if(O){if(m.url&&O.tiles&&m.tiles&&delete m.tiles,O.variants){if(!Array.isArray(O.variants))return x(new Error("variants must be an array"));for(const F of O.variants){if(F==null||typeof F!="object"||F.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(F.capabilities))return x(new Error("capabilities must be an array"));if(F.capabilities.length===1&&F.capabilities[0]==="meshopt"){O=i.l(O,F);break}}}const z=i.aF(i.l({},O,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);z.tiles=s.canonicalizeTileset(z,m.url),x(null,z)}},E=function(C,O,z){if(!C)return null;if(!O&&!z)return C;z=z||C.worldview_default;const F=Object.values(C.language||{});if(F.length===0)return null;const G=Object.values(C.worldview||{});if(G.length===0)return null;const U=F.every(te=>te===O),Z=G.every(te=>te===z);return U&&Z?C:O in(C.language_options||{})||z in(C.worldview_options||{})?null:C.language_options&&C.worldview_options?C:null}(m.data,h,g);return E?i.q.frame(()=>w(null,E)):m.url?i.n(s.transformRequest(s.normalizeSourceURL(m.url,null,h,g),i.R.Source),w):i.q.frame(()=>{const{data:C,...O}=m;w(null,O)})}function Qo(m,s){const h=Math.pow(2,s.z),g=Math.floor(i.ay(m.getWest())*h),x=Math.floor(i.aH(m.getNorth())*h),w=Math.ceil(i.ay(m.getEast())*h),E=Math.ceil(i.aH(m.getSouth())*h);return s.x>=g&&s.x<w&&s.y>=x&&s.y<E}class Io{constructor(s,h,g){this.bounds=s?i.aG.convert(this.validateBounds(s)):null,this.minzoom=h||0,this.maxzoom=g||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}addExtraBounds(s){if(s){this.extraBounds||(this.extraBounds=[]);for(const h of s)this.extraBounds.push(i.aG.convert(this.validateBounds(h)))}}contains(s){if(s.z>this.maxzoom||s.z<this.minzoom||this.bounds&&!Qo(this.bounds,s))return!1;if(!this.extraBounds)return!0;for(const h of this.extraBounds)if(Qo(h,s))return!0;return!1}static fromTileJSON(s){if(!s.bounds&&!s.extra_bounds)return null;const h=new Io(s.bounds,s.minzoom,s.maxzoom);return h.addExtraBounds(s.extra_bounds),h}}class Vo extends i.E{constructor(s,h,g,x){if(super(),this.id=s,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.aF(h,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},h),this._collectResourceTiming=!!h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new i.aI}load(s){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=Jo(this._options,this.map._requestManager,h,g,(x,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new i.z(x));else if(w){if(i.l(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const E of w.vector_layers)this.vectorLayerIds.push(E.id),w.worldview&&w.worldview[E.source]&&this.localizableLayerIds.add(E.id)}this.tileBounds=Io.fromTileJSON(w),Ft(w.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}s&&s(x)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(s,h){const g=s.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(g),w=this.map._requestManager.transformRequest(x,i.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,C=E?{image:E.image.clone()}:null,O={request:w,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:C,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(g)&&(O.worldview=this.map.getWorldview()||this.worldviewDefault,O.localizableLayerIds=this.localizableLayerIds),O.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=h:s.request=s.actor.send("reloadTile",O,z.bind(this));else if(s.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",O,z.bind(this),void 0,!0);else{const F=i.aJ.call({deduped:this._deduped},O,(G,U)=>{G||!U?z.call(this,G):(O.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},s.actor&&s.actor.send("loadTile",O,z.bind(this),void 0,!0))},!0);s.request={cancel:F}}function z(F,G){return delete s.request,s.aborted?h(null):F&&F.status!==404?h(F):(G&&G.resourceTiming&&(s.resourceTiming=G.resourceTiming),this.map._refreshExpiredTiles&&G&&s.setExpiryData(G),s.loadVectorData(G,this.map.painter),i.aK(this.dispatcher),h(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,h){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class wl extends i.E{constructor(s,h,g,x){super(),this.id=s,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},h),i.l(this,i.aF(h,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._tileJSONRequest=Jo(this._options,this.map._requestManager,null,null,(h,g)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new i.z(h)):g&&(i.l(this,g),g.raster_layers&&(this.rasterLayers=g.raster_layers,this.rasterLayerIds=this.rasterLayers.map(x=>x.id)),this.tileBounds=Io.fromTileJSON(g),Ft(g.tiles),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),s&&s(h)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,h){const g=i.q.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);s.request=i.o(this.map._requestManager.transformRequest(x,i.R.Tile),(w,E,C,O)=>(delete s.request,s.aborted?(s.state="unloaded",h(null)):w?(s.state="errored",h(w)):E?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:C,expires:O}),s.setTexture(E,this.map.painter),s.state="loaded",i.aK(this.dispatcher),void h(null)):h(null)))}abortTile(s,h){s.request&&(s.request.cancel(),delete s.request),h&&h()}unloadTile(s,h){s.texture&&s.texture instanceof i.T?(s.destroy(!0),s.texture&&s.texture instanceof i.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),h&&h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ru extends wl{constructor(s,h,g,x){super(s,h,g,x),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=i.l({type:"raster-array"},h)}triggerRepaint(s){const h=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);h&&h.enabled&&g&&h._clearRenderCacheForTile(g.id,s.tileID),this.map.triggerRepaint()}loadTile(s,h){const g=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(g,i.R.Tile),w={request:x,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};s.source=this.id,s.scope=this.scope,s.requestParams=x,s.actor||(s.actor=this.dispatcher.getActor());const E=(C,O,z,F)=>{if(delete s.request,s.aborted)return s.state="unloaded",h(null);if(C)return C.name==="AbortError"?void 0:(s.state="errored",h(C));if(this.map._refreshExpiredTiles&&O&&s.setExpiryData({cacheControl:z,expires:F}),this.partial)s.state="empty";else{if(!O)return h(null);s.state="loaded",s._isHeaderLoaded=!0,s._mrt=O}h(null)};s.request=this.partial?s.fetchHeader(void 0,E.bind(this)):s.actor.send("loadTile",w,E.bind(this),void 0,!0)}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,h){const g=s.texture;g&&g instanceof i.T?(s.destroy(!0),this.map.painter.saveTileTexture(g)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,h,g){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBand(h,g,(x,w)=>{if(x)return s.state="errored",this.fire(new i.z(x)),void this.triggerRepaint(s);w&&(s._isHeaderLoaded=!0,s.setTexture(w,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const h=this.rasterLayers.find(({id:w})=>w===s),g=h&&h.fields,x=g&&g.bands&&g.bands;return x?x[0]:0}getTextureDescriptor(s,h,g){if(!s)return;const x=h.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let w=null;h instanceof i.aN?w=h.paint.get("raster-array-band"):h instanceof i.aO&&(w=h.paint.get("raster-particle-array-band"));const E=w||this.getInitialBand(x);if(E!=null)if(s.textureDescriptor){if(!s.updateNeeded(x,E)||g)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,x,E)}getImages(s,h){const g=new Map;for(const x of s)for(const w of h){const[E,C]=w.split("/"),O=x.getLayer(E);if(!O||!O.hasBand(C)||!O.hasDataForBand(C))continue;const{bytes:z,tileSize:F,buffer:G}=O.getBandView(C),U=F+2*G,Z={data:new i.r({width:U,height:U},z),pixelRatio:2,sdf:!1,usvg:!1,version:0};g.set(w,Z)}return g}}const Qf={vector:Vo,raster:wl,"raster-dem":class extends wl{constructor(m,s,h,g){super(m,s,h,g),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(m,s){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,w){x&&(m.state="errored",s(x)),w&&(m.dem=w,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",s(null))}m.request=i.o(this.map._requestManager.transformRequest(h,i.R.Tile),(function(x,w,E,C){if(delete m.request,m.aborted)m.state="unloaded",s(null);else if(x)m.state="errored",s(x);else if(w){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:E,expires:C});const O=ImageBitmap&&w instanceof ImageBitmap&&i.t(),z=1-(w.width-i.aL(w.width))/2;z<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const F=O?w:i.q.getImageData(w,z),G={uid:m.uid,tileID:m.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:F,encoding:this.encoding,padding:z};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadTile",G,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const s=m.canonical,h=Math.pow(2,s.z),g=(s.x-1+h)%h,x=s.x===0?m.wrap-1:m.wrap,w=(s.x+1+h)%h,E=s.x+1===h?m.wrap+1:m.wrap,C={};return C[new i.aM(m.overscaledZ,x,s.z,g,s.y).key]={backfilled:!1},C[new i.aM(m.overscaledZ,E,s.z,w,s.y).key]={backfilled:!1},s.y>0&&(C[new i.aM(m.overscaledZ,x,s.z,g,s.y-1).key]={backfilled:!1},C[new i.aM(m.overscaledZ,m.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},C[new i.aM(m.overscaledZ,E,s.z,w,s.y-1).key]={backfilled:!1}),s.y+1<h&&(C[new i.aM(m.overscaledZ,x,s.z,g,s.y+1).key]={backfilled:!1},C[new i.aM(m.overscaledZ,m.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},C[new i.aM(m.overscaledZ,E,s.z,w,s.y+1).key]={backfilled:!1}),C}},"raster-array":Ru,geojson:class extends i.E{constructor(m,s,h,g){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(g),this._data=s.data,this._options=i.l({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const x=i.aj/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*x,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*x,extent:i.aj,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:i.aj,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*x,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){if(!this._options.dynamic)return this.fire(new i.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection"))return this.fire(new i.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const s=new Map;for(const h of this._data.features)s.set(h.id,h);for(const h of m.features)s.set(h.id,h);this._data.features=[...s.values()]}else this._data=m;return this._updateWorkerData(!0),this}getClusterExpansionZoom(m,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterChildren(m,s){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterLeaves(m,s,h,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:s,offset:h},g),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.A("dataloading",{dataType:"source"})),this._loaded=!1;const s=i.l({append:m},this.workerOptions);s.scope=this.scope;const h=this._data;typeof h=="string"?(s.request=this.map._requestManager.transformRequest(i.q.resolveURL(h),i.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(g,x)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new i.z(g));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(w.resourceTiming=x.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new i.A("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const m=i.C(this.id,this.scope);this.map.style.clearSource(m),this._updateWorkerData()}loadTile(m,s){const h=m.actor?"reloadTile":"loadTile";m.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,x=g?{image:g.image.clone()}:null,w=this._partialReload,E={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:m.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:w};m.request=this.actor.send(h,E,(C,O)=>w&&!O?(m.state="loaded",s(null)):(delete m.request,m.destroy(),m.aborted?s(null):C?s(C):(m.loadVectorData(O,this.map.painter,h==="reloadTile"),s(null))),void 0,h==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,s){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aP{constructor(m,s,h,g){super(m,s,h,g),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const s of m.urls)this.urls.push(this.map._requestManager.transformRequest(s,i.R.Source).url);i.aQ(this.urls,(s,h)=>{this._loaded=!0,s?this.fire(new i.z(s)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const s=this.video.seekable;m<s.start(0)||m>s.end(0)?this.fire(new i.z(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,s=m.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(m,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aP,model:class extends i.E{constructor(m,s,h,g){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const m=[];for(const s in this._options.models){const h=this._options.models[s],g=i.aS(this.map._requestManager.transformRequest(h.uri,i.R.Model).url).then(x=>{if(!x)return;const w=i.aT(x),E=new i.aU(s,h.position,h.orientation,w);E.computeBoundsAndApplyParent(),this.models.push(E)}).catch(x=>{this.fire(new i.z(new Error(`Could not load model ${s} from ${h.uri}: ${x.message}`)))});m.push(g)}Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this._loaded=!0,this.fire(new i.z(new Error(`Could not load models: ${s.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,s){}serialize(){return this._options}},"batched-model":class extends i.E{constructor(m,s,h,g){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=h,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest();const m=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(m))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(m){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map.getWorldview();this._tileJSONRequest=Jo(this._options,this.map._requestManager,s,h,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new i.z(g))):x&&(i.l(this,x),x.bounds&&(this.tileBounds=new Io(x.bounds,this.minzoom,this.maxzoom)),Ft(x.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),m&&m(g)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,s){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(h,i.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.q.devicePixelRatio,promoteId:this.promoteId};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=s;else{if(m.buckets){const w=Object.values(m.buckets);for(const E of w)E.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",g,x.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",g,x.bind(this),void 0,!0);function x(w,E){return m.aborted?s(null):w&&w.status!==404?s(w):(this.map._refreshExpiredTiles&&E&&m.setExpiryData(E),m.loadModelData(E,this.map.painter),m.state="loaded",void s(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aP{constructor(m,s,h,g){super(m,s,h,g),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(w=>typeof w!="number"))||this.fire(new i.z(new i.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.z(new i.V(`sources.${m}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new i.z(new i.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new i.z(new i.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.z(new i.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof i.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends i.E{constructor(m,s,h,g){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=s,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Io(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.aF(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this.map=m,this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:s,y:h,z:g}=m.canonical;return this._implementation.hasTile({x:s,y:h,z:g})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,s){const{x:h,y:g,z:x}=m.tileID.canonical,w=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:h,y:g,z:x},{signal:w.signal})).then((function(E){return delete m.request,m.aborted?(m.state="unloaded",s(null)):E===void 0?(m.state="errored",s(null)):E===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",s(null)):function(C){return C instanceof ImageData||C instanceof HTMLCanvasElement||C instanceof ImageBitmap||C instanceof HTMLImageElement}(E)?(this.loadTileData(m,E),m.state="loaded",void s(null)):(m.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(E=>{E.name!=="AbortError"&&(m.state="errored",s(E))}),m.request.cancel=()=>w.abort()}loadTileData(m,s){m.setTexture(s,this.map.painter)}unloadTile(m,s){if(m.texture&&m.texture instanceof i.T?(m.destroy(!0),m.texture&&m.texture instanceof i.T&&this.map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){const{x:h,y:g,z:x}=m.tileID.canonical;this._implementation.unloadTile({x:h,y:g,z:x})}s&&s()}abortTile(m,s){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){const m=i.C(this.id,this.scope);this.map.style.clearSource(m)}_update(){this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}}},Zh=function(m,s,h,g){const x=new Qf[s.type](m,s,h,g);if(x.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${x.id}`);return i.aV(["load","abort","unload","serialize","prepare"],x),x};function ig(m,s,h=""){return`${h}:${s.id||""}:${s.layer.id}:${function(g){if("layerId"in g)return`layer:${g.layerId}`;{const{featuresetId:x,importId:w}=g;return`featureset:${x}${w?`:import:${w}`:""}`}}(m.target)}`}function ep(m,s,h,g=""){if(m.uniqueFeatureID){const x=ig(m,s,g);if(h.has(x))return!0;h.add(x)}return!1}function Du(m,s,h,g,x=!1){const w=s.sourceCache.transform,E=s.sourceCache.tilesIn(m,s.has3DLayers,x);E.sort(Xs);const C=[];for(const O of E){const z=O.tile.queryRenderedFeatures(s,O,h,g,w,x);Object.keys(z).length&&C.push({wrappedTileID:O.tile.tileID.wrapped().key,queryResults:z})}return C.length===0?{}:function(O){const z={},F={};for(const G of O){const U=G.queryResults,Z=G.wrappedTileID,te=F[Z]=F[Z]||{};for(const ee in U){const oe=U[ee],re=te[ee]=te[ee]||{},fe=z[ee]=z[ee]||[];for(const _e of oe)re[_e.featureIndex]||(re[_e.featureIndex]=!0,fe.push(_e))}}return z}(C)}function tp(m,s,h,g,x){const w={},E=g.queryRenderedSymbols(m),C=[];for(const O of Object.keys(E).map(Number))C.push(x[O]);C.sort(Xs);for(const O of C){const z=O.featureIndex.lookupSymbolFeatures(E[O.bucketInstanceId],O.bucketIndex,O.sourceLayerIndex,s,h);for(const F in z){const G=w[F]=w[F]||[],U=z[F];U.sort((Z,te)=>{const ee=O.featureSortOrder;if(ee){const oe=ee.indexOf(Z.featureIndex);return ee.indexOf(te.featureIndex)-oe}return te.featureIndex-Z.featureIndex});for(const Z of U)G.push(Z)}}return w}function Wv(m,s){const h=m.getRenderableIds().map(w=>m.getTileByID(w)),g=[],x={};for(let w=0;w<h.length;w++){const E=h[w],C=E.tileID.canonical.key;x[C]||(x[C]=!0,E.querySourceFeatures(g,s))}return g}function Xs(m,s){const h=m.tileID,g=s.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}function Hv(m,s){const h={};if(!s)return h;for(const g of m){const x=g.layerIds.map(w=>s.getLayer(w)).filter(Boolean);if(x.length!==0){g.layers=x,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(w=>x.filter(E=>E.id===w)[0]));for(const w of x)h[w.fqid]=g}}return h}const Fa=32,Ks=33,Ql=new Uint16Array(8184);for(let m=0;m<2046;m++){let s=m+2,h=0,g=0,x=0,w=0,E=0,C=0;for(1&s?x=w=E=Fa:h=g=C=Fa;(s>>=1)>1;){const z=h+x>>1,F=g+w>>1;1&s?(x=h,w=g,h=E,g=C):(h=x,g=w,x=E,w=C),E=z,C=F}const O=4*m;Ql[O+0]=h,Ql[O+1]=g,Ql[O+2]=x,Ql[O+3]=w}const Ys=new Uint16Array(2178),ec=new Uint8Array(1089),Ss=new Uint16Array(1089);function np(m){return m===0?-.03125:m===32?.03125:0}const qv={type:2,extent:i.aj,loadGeometry:()=>[[new i.P(0,0),new i.P(i.aj+1,0),new i.P(i.aj+1,i.aj+1),new i.P(0,i.aj+1),new i.P(0,0)]]};class tc{constructor(s,h,g,x,w){this.tileID=s,this.uid=i.a$(),this.uses=0,this.tileSize=h,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection)}registerFadeDuration(s){const h=s+this.timeAdded;h<i.q.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,h,g){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=Hv(s.buckets,h.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const w=this.buckets[x];if(w instanceof i.b1){if(this.hasSymbolBuckets=!0,!g)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const w=this.buckets[x];if(w instanceof i.b1&&w.hasRTLText){this.hasRTLText=!0,i.b2();break}}this.queryPadding=0;for(const x in this.buckets){const w=this.buckets[x],E=h.style.getOwnLayer(x);if(!E)continue;const C=E.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,C)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new i.b0}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,h,g){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,Hv(s.buckets,h.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const x in this.buckets){const w=this.buckets[x];w.uploadPending()&&w.upload(s)}const h=s.gl,g=this.imageAtlas;g&&!g.uploaded&&(this.imageAtlasTexture=new i.T(s,g.image,h.RGBA8,{useMipmap:!!g.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(s,this.glyphAtlasImage,h.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(s,this.lineAtlas.image,h.R8),this.lineAtlas.uploaded=!0)}prepare(s,h,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,g),!h||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=h.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(h,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}queryRenderedFeatures(s,h,g,x,w,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const C=function(O,z){const F=i.bn([],[.5*O.width,.5*-O.height,1]);return i.bo(F,F,[1,-1,0]),i.az(F,F,O.calculateProjMatrix(z.toUnwrapped())),Float32Array.from(F)}(w,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:h,pixelPosMatrix:C,transform:x,availableImages:g,tileTransform:this.tileTransform})}querySourceFeatures(s,h){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const x=g.loadVTLayers(),w=h?h.sourceLayer:"",E=x._geojsonTileLayer||x[w];if(!E)return;const C=i.b3(h&&h.filter),{z:O,x:z,y:F}=this.tileID.canonical,G={z:O,x:z,y:F};for(let U=0;U<E.length;U++){const Z=E.feature(U);if(C.needGeometry){const oe=i.b4(Z,!0);if(!C.filter(new i.aa(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!C.filter(new i.aa(this.tileID.overscaledZ),Z))continue;const te=g.getId(Z,w),ee=new i.b5(Z,O,z,F,te);ee.tile=G,s.push(ee)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(s){const h=this.expirationTime;if(s.cacheControl){const g=i.b6(s.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const g=Date.now();let x=!1;if(this.expirationTime>g)x=!1;else if(h)if(this.expirationTime<h)x=!0;else{const w=this.expirationTime-h;w?this.expirationTime=g+Math.max(w,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,h){if(!this.latestFeatureIndex||!s.style)return;const g=this.latestFeatureIndex.loadVTLayers(),x=s.style.listImages(),w=s.style.getBrightness();for(const E in this.buckets){if(!s.style.hasLayer(E))continue;const C=this.buckets[E],O=C.layers[0],z=O.sourceLayer||"_geojsonTileLayer",F=g[z],G=s.style.getLayerSourceCache(O);let U={};G&&(U=G._state.getState(z,void 0));const Z=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},te=Object.keys(U).length>0&&!h;te&&!C.stateDependentLayers.length&&!h||C.update(U,F,x,Z,te?C.stateDependentLayers:C.layers,h,w),(C instanceof i.b7||C instanceof i.b8)&&s._terrain&&s._terrain.enabled&&G&&C.uploadPending()&&s._terrain._clearRenderCacheForTile(G.id,this.tileID);const ee=s&&s.style&&s.style.getOwnLayer(E);ee&&(this.queryPadding=Math.max(this.queryPadding,ee.queryRadius(C)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=i.q.now()+s}setTexture(s,h){const g=h.context,x=g.gl;this.texture=this.texture||h.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s):(this.texture=new i.T(g,s,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(s,h){const g={};for(const x of h)g[x]=!0;this.dependencies[s]=g}hasDependency(s,h){for(const g of s){const x=this.dependencies[g];if(x){for(const w of h)if(x[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,h){if(!h||h.name==="mercator"||this._tileDebugBuffer)return;const g=i.b9(qv,this.tileID.canonical,this.tileTransform)[0],x=new i.ba,w=new i.bb;for(let E=0;E<g.length;E++){const{x:C,y:O}=g[E];x.emplaceBack(C,O),w.emplaceBack(E)}w.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(w),this._tileDebugBuffer=s.createVertexBuffer(x,i.bc.members),this._tileDebugSegments=i.bd.simpleSegment(0,0,x.length,w.length)}_makeTileBoundsBuffers(s,h){if(this._tileBoundsBuffer||!h||h.name==="mercator")return;const g=i.b9(qv,this.tileID.canonical,this.tileTransform)[0];let x,w;if(this.isRaster){const E=function(C,O){const z=i.aW(C,O),F=Math.pow(2,C.z);for(let oe=0;oe<Ks;oe++)for(let re=0;re<Ks;re++){const fe=i.aX((C.x+(re+np(re))/Fa)/F),_e=i.aY((C.y+(oe+np(oe))/Fa)/F),be=O.project(fe,_e),Pe=oe*Ks+re;Ys[2*Pe+0]=Math.round((be.x*z.scale-z.x)*i.aj),Ys[2*Pe+1]=Math.round((be.y*z.scale-z.y)*i.aj)}ec.fill(0),Ss.fill(0);for(let oe=2045;oe>=0;oe--){const re=4*oe,fe=Ql[re+0],_e=Ql[re+1],be=Ql[re+2],Pe=Ql[re+3],Ee=fe+be>>1,Ae=_e+Pe>>1,we=Ee+Ae-_e,Me=Ae+fe-Ee,ke=_e*Ks+fe,Qe=Pe*Ks+be,qe=Ae*Ks+Ee,mt=Math.hypot((Ys[2*ke+0]+Ys[2*Qe+0])/2-Ys[2*qe+0],(Ys[2*ke+1]+Ys[2*Qe+1])/2-Ys[2*qe+1])>=16;ec[qe]=ec[qe]||(mt?1:0),oe<1022&&(ec[qe]=ec[qe]||ec[(_e+Me>>1)*Ks+(fe+we>>1)]||ec[(Pe+Me>>1)*Ks+(be+we>>1)])}const G=new i.aZ,U=new i.a_;let Z=0;function te(oe,re){const fe=re*Ks+oe;return Ss[fe]===0&&(G.emplaceBack(Ys[2*fe+0],Ys[2*fe+1],oe*i.aj/Fa,re*i.aj/Fa),Ss[fe]=++Z),Ss[fe]-1}function ee(oe,re,fe,_e,be,Pe){const Ee=oe+fe>>1,Ae=re+_e>>1;if(Math.abs(oe-be)+Math.abs(re-Pe)>1&&ec[Ae*Ks+Ee])ee(be,Pe,oe,re,Ee,Ae),ee(fe,_e,be,Pe,Ee,Ae);else{const we=te(oe,re),Me=te(fe,_e),ke=te(be,Pe);U.emplaceBack(we,Me,ke)}}return ee(0,0,Fa,Fa,Fa,0),ee(Fa,Fa,0,0,0,Fa),{vertices:G,indices:U}}(this.tileID.canonical,h);x=E.vertices,w=E.indices}else{x=new i.aZ,w=new i.a_;for(const{x:C,y:O}of g)x.emplaceBack(C,O,0,0);const E=i.be(x.int16.subarray(0,4*x.length),void 0,4);for(let C=0;C<E.length;C+=3)w.emplaceBack(E[C],E[C+1],E[C+2])}this._tileBoundsBuffer=s.createVertexBuffer(x,i.bf.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(w),this._tileBoundsSegments=i.bd.simpleSegment(0,0,x.length,w.length)}_makeGlobeTileDebugBuffers(s,h){const g=h.projection;if(!g||g.name!=="globe"||h.freezeTileCoverage)return;const x=this.tileID.canonical,w=i.bg(x,h),E=i.bh(w),C=i.ah(h.zoom);let O;C>0&&(O=i.bi(new Float64Array(16),h.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,x,h,E,O,C),this._makeGlobeTileDebugTextBuffer(s,x,h,E,O,C)}_globePoint(s,h,g,x,w,E,C){let O=i.bj(s,h,g);if(E){const z=1<<g.z,F=i.ay(x.center.lng),G=i.aH(x.center.lat),U=(g.x+.5)/z-F;let Z=0;U>.5?Z=-1:U<-.5&&(Z=1);let te=(s/i.aj+g.x)/z+Z,ee=(h/i.aj+g.y)/z;te=(te-F)*x._pixelsPerMercatorPixel+F,ee=(ee-G)*x._pixelsPerMercatorPixel+G;const oe=[te*x.worldSize,ee*x.worldSize,0];i.ad(oe,oe,E),O=i.bk(O,oe,C)}return i.ad(O,O,w)}_makeGlobeTileDebugBorderBuffer(s,h,g,x,w,E){const C=new i.ba,O=new i.bb,z=new i.bl,F=(U,Z,te,ee,oe)=>{const re=(te-U)/(oe-1),fe=(ee-Z)/(oe-1),_e=C.length;for(let be=0;be<oe;be++){const Pe=U+be*re,Ee=Z+be*fe;C.emplaceBack(Pe,Ee);const Ae=this._globePoint(Pe,Ee,h,g,x,w,E);z.emplaceBack(Ae[0],Ae[1],Ae[2]),O.emplaceBack(_e+be)}},G=i.aj;F(0,0,G,0,16),F(G,0,G,G,16),F(G,G,0,G,16),F(0,G,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(O),this._tileDebugBuffer=s.createVertexBuffer(C,i.bc.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(z,i.bm.members),this._tileDebugSegments=i.bd.simpleSegment(0,0,C.length,O.length)}_makeGlobeTileDebugTextBuffer(s,h,g,x,w,E){const C=i.aj/4,O=new i.ba,z=new i.a_,F=new i.bl,G=25;z.reserve(32),O.reserve(G),F.reserve(G);const U=(Z,te)=>G*Z+te;for(let Z=0;Z<G;Z++){const te=Z*C;for(let ee=0;ee<G;ee++){const oe=ee*C;O.emplaceBack(oe,te);const re=this._globePoint(oe,te,h,g,x,w,E);F.emplaceBack(re[0],re[1],re[2])}}for(let Z=0;Z<4;Z++)for(let te=0;te<4;te++){const ee=U(Z,te),oe=U(Z,te+1),re=U(Z+1,te),fe=U(Z+1,te+1);z.emplaceBack(ee,oe,re),z.emplaceBack(re,oe,fe)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(z),this._tileDebugTextBuffer=s.createVertexBuffer(O,i.bc.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(F,i.bm.members),this._tileDebugTextSegments=i.bd.simpleSegment(0,0,G,32)}destroy(s=!1){for(const h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bp.setPbf(i.bq);class rp extends tc{constructor(s,h,g,x,w){super(s,h,g,x,w),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(s){return this._mrt&&this._mrt.getLayer(s)}setTexture(s,h){const g=h.context,x=g.gl;this.texture=this.texture||h.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s,{premultiply:!1}):this.texture=new i.T(g,s,x.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(s=16384,h){const g=this._mrt=new i.bp(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=i.br(x,(w,E,C,O)=>{if(w)h(w);else try{const z=g.getHeaderLength(E);if(z>s)return void(this.request=this.fetchHeader(z,h));g.parseHeader(E),this._isHeaderLoaded=!0;let F=0;for(const G of Object.values(g.layers))F=Math.max(F,G.dataIndex[G.dataIndex.length-1].lastByte);E.byteLength>=F&&(this.entireBuffer=E),h(null,this.entireBuffer||E,C,O)}catch(z){h(z)}}),this.request}fetchBand(s,h,g){const x=this._mrt;if(!this._isHeaderLoaded||!x)return void g(new Error("Tile header is not ready"));const w=this.actor;if(!w)return void g(new Error("Can't fetch tile band without an actor"));let E;const C=(G,U)=>{E.complete(G,U),G?g(G):(this.updateTextureDescriptor(s,h),g(null,this.textureDescriptor&&this.textureDescriptor.img))},O=(G,U)=>{if(G)return g(G);const Z=w.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:U,task:E},C,void 0,!0);this._workQueue.push(()=>{Z&&Z.cancel(),E.cancel()})},z=x.getLayer(s);if(!z)return void g(new Error(`Unknown sourceLayer "${s}"`));if(z.hasDataForBand(h))return this.updateTextureDescriptor(s,h),void g(null,this.textureDescriptor?this.textureDescriptor.img:null);const F=z.getDataRange([h]);if(E=x.createDecodingTask(F),!E||E.tasks.length)if(this.flushQueues(),this.entireBuffer)O(null,this.entireBuffer.slice(F.firstByte,F.lastByte+1));else{const G=Object.assign({},this.requestParams,{headers:{Range:`bytes=${F.firstByte}-${F.lastByte}`}}),U=i.br(G,O);this._fetchQueue.push(()=>{U.cancel(),E.cancel()})}else g(null)}updateNeeded(s,h){return(!this.textureDescriptor||this.textureDescriptor.band!==h||this.textureDescriptor.layer!==s)&&this.state!=="errored"}updateTextureDescriptor(s,h){if(!this._mrt)return;const g=this._mrt.getLayer(s);if(!g||!g.hasBand(h)||!g.hasDataForBand(h))return;const{bytes:x,tileSize:w,buffer:E,offset:C,scale:O}=g.getBandView(h),z=w+2*E,F=new i.r({width:z,height:z},x),G=this.texture;G&&G instanceof i.T&&G.update(F,{premultiply:!1}),this.textureDescriptor={layer:s,band:h,img:F,buffer:E,offset:C,tileSize:w,format:g.pixelFormat,mix:[O,256*O,65536*O,16777216*O]}}}class Zv{constructor(s,h){this.max=s,this.onRemove=h,this.reset()}reset(){for(const s in this.data)for(const h of this.data[s])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(s,h,g){const x=s.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const w={value:h,timeout:void 0};if(g!==void 0&&(w.timeout=setTimeout(()=>{this.remove(s,w)},g)),this.data[x].push(w),this.order.push(x),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const h=this.data[s].shift();return h.timeout&&clearTimeout(h.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),h.value}getByKey(s){const h=this.data[s];return h?h[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,h){if(!this.has(s))return this;const g=s.wrapped().key,x=h===void 0?0:this.data[g].indexOf(h),w=this.data[g][x];return this.data[g].splice(x,1),w.timeout&&clearTimeout(w.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(w.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(s){const h=[];for(const g in this.data)for(const x of this.data[g])s(x.value)||h.push(x);for(const g of h)this.remove(g.value.tileID,g)}}class ip{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,h,g){const x=String(h);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][x]=this.stateChanges[s][x]||{},i.l(this.stateChanges[s][x],g),this.deletedStates[s]===null){this.deletedStates[s]={};for(const w in this.state[s])w!==x&&(this.deletedStates[s][w]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][x]===null){this.deletedStates[s][x]={};for(const w in this.state[s][x])g[w]||(this.deletedStates[s][x][w]=null)}else for(const w in g)this.deletedStates[s]&&this.deletedStates[s][x]&&this.deletedStates[s][x][w]===null&&delete this.deletedStates[s][x][w]}removeFeatureState(s,h,g){if(this.deletedStates[s]===null)return;const x=String(h);if(this.deletedStates[s]=this.deletedStates[s]||{},g&&h!==void 0)this.deletedStates[s][x]!==null&&(this.deletedStates[s][x]=this.deletedStates[s][x]||{},this.deletedStates[s][x][g]=null);else if(h!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][x])for(g in this.deletedStates[s][x]={},this.stateChanges[s][x])this.deletedStates[s][x][g]=null;else this.deletedStates[s][x]=null;else this.deletedStates[s]=null}getState(s,h){const g=this.state[s]||{},x=this.stateChanges[s]||{},w=this.deletedStates[s];if(w===null)return{};if(h!==void 0){const C=String(h),O=i.l({},g[C],x[C]);if(w){const z=w[h];if(z===null)return{};for(const F in z)delete O[F]}return O}const E=i.l({},g,x);if(w)for(const C in w)delete E[C];return E}initializeTileState(s,h){s.refreshFeatureState(h)}coalesceChanges(s,h){const g={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const w={};for(const E in this.stateChanges[x])this.state[x][E]||(this.state[x][E]={}),i.l(this.state[x][E],this.stateChanges[x][E]),w[E]=this.state[x][E];g[x]=w}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const w={};if(this.deletedStates[x]===null)for(const E in this.state[x])w[E]={},this.state[x][E]={};else for(const E in this.deletedStates[x]){if(this.deletedStates[x][E]===null)this.state[x][E]={};else if(this.state[x][E])for(const C of Object.keys(this.deletedStates[x][E]))delete this.state[x][E][C];w[E]=this.state[x][E]}g[x]=g[x]||{},i.l(g[x],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const x in s)s[x].refreshFeatureState(h)}}class ca extends i.E{constructor(s,h,g){super(),this.id=s,this._onlySymbols=g,h.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),h.on("error",()=>{this._sourceErrored=!0}),this._source=h,this._tiles={},this._cache=new Zv(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new ip,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles)if(!this._tiles[s].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,h){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,h)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const g=this._tiles[h];g.upload(s),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(og).map(s=>s.key)}getRenderableIds(s,h){const g=[];for(const x in this._tiles)this._isIdRenderable(+x,s,h)&&g.push(this._tiles[x]);return s?g.sort((x,w)=>{const E=x.tileID,C=w.tileID,O=new i.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),z=new i.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-C.overscaledZ||z.y-O.y||z.x-O.x}).map(x=>x.tileID.key):g.map(x=>x.tileID).sort(og).map(x=>x.key)}hasRenderableParent(s){const h=this.findLoadedParent(s,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(s,h,g){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(h||!this._tiles[s].holdingForFade())&&(g||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,h){const g=this._tiles[s];g&&(g.state!=="loading"&&(g.state=h),this._loadTile(g,this._tileLoaded.bind(this,g,s,h)))}_tileLoaded(s,h,g,x){if(x)if(s.state="errored",x.status!==404)this._source.fire(new i.z(x,{tile:s}));else{if(this._source.fire(new i.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=i.q.now(),g==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(h,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new i.A("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const h=this.getRenderableIds();for(let x=0;x<h.length;x++){const w=h[x];if(s.neighboringTiles&&s.neighboringTiles[w]){const E=this.getTileByID(w);g(s,E),g(E,s)}}function g(x,w){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let E=w.tileID.canonical.x-x.tileID.canonical.x;const C=w.tileID.canonical.y-x.tileID.canonical.y,O=Math.pow(2,x.tileID.canonical.z),z=w.tileID.key;E===0&&C===0||Math.abs(C)>1||(Math.abs(E)>1&&(Math.abs(E+O)===1?E+=O:Math.abs(E-O)===1&&(E-=O)),w.dem&&x.dem&&(x.dem.backfillBorder(w.dem,E,C),x.neighboringTiles&&x.neighboringTiles[z]&&(x.neighboringTiles[z].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,h,g,x){for(const w in this._tiles){let E=this._tiles[w];if(x[w]||!E.hasData()||E.tileID.overscaledZ<=h||E.tileID.overscaledZ>g)continue;let C=E.tileID;for(;E&&E.tileID.overscaledZ>h+1;){const z=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[z.key],E&&E.hasData()&&(C=z)}let O=C;for(;O.overscaledZ>h;)if(O=O.scaledTo(O.overscaledZ-1),s[O.key]){x[C.key]=C;break}}}findLoadedParent(s,h){if(s.key in this._loadedParentTiles){const g=this._loadedParentTiles[s.key];return g&&g.tileID.overscaledZ>=h?g:null}for(let g=s.overscaledZ-1;g>=h;g--){const x=s.scaledTo(g),w=this._getLoadedTile(x);if(w)return w}}_getLoadedTile(s){const h=this._tiles[s.key];return h&&h.hasData()?h:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,h){h=h||this._source.tileSize;const g=Math.ceil(s.width/h)+1,x=Math.ceil(s.height/h)+1,w=Math.floor(g*x*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(C)}handleWrapJump(s){const h=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,h){const g={};for(const x in this._tiles){const w=this._tiles[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+h),g[w.tileID.key]=w}this._tiles=g;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(s,h,g,x,w){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(s,h),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const E=this._source.type==="batched-model";let C,O=this._source.maxzoom;const z=this.map&&this.map.painter?this.map.painter._terrain:null;if(z&&z.sourceCache===this&&z.attenuationRange()){const U=z.attenuationRange()[0],Z=Math.floor(U)-Math.log2(z.getDemUpscale());O>Z&&(O=Z)}if(this.used||this.usedForTerrain){if(this._source.tileID)C=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new i.aM(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y));else if(this.tileCoverLift!==0){const U=s.clone();U.tileCoverLift=this.tileCoverLift,C=U.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:O,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:E}),this._source.minzoom<=1&&s.projection.name==="globe"&&(C.push(new i.aM(1,0,1,0,0)),C.push(new i.aM(1,0,1,1,0)),C.push(new i.aM(1,0,1,0,1)),C.push(new i.aM(1,0,1,1,1)))}else if(C=s.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:O,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:E}),this._source.hasTile){const U=this._source.hasTile.bind(this._source);C=C.filter(Z=>U(Z))}}else C=[];if(C.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!ag(this._source.type)){const U=s.coveringZoomLevel({tileSize:h||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),Z=Math.min(U,this._source.maxzoom);if(E){const te=s.extendTileCover(C,Z);for(const ee of te)C.push(ee)}else if(w){const te=s.extendTileCover(C,Z,this.transform._camera.forward());for(const ee of te)C.push(ee)}else if(this.castsShadows&&x){const te=s.extendTileCover(C,Z,x);for(const ee of te)this._shadowCasterTiles[ee.key]=!0,C.push(ee)}}const F=this._updateRetainedTiles(C);if(ag(this._source.type)&&C.length!==0){const U={},Z={},te=Object.keys(F);for(const oe of te){const re=F[oe],fe=this._tiles[oe];if(!fe||fe.fadeEndTime&&fe.fadeEndTime<=i.q.now())continue;const _e=this.findLoadedParent(re,Math.max(re.overscaledZ-ca.maxOverzooming,this._source.minzoom));_e&&(this._addTile(_e.tileID),U[_e.tileID.key]=_e.tileID),Z[oe]=re}const ee=C[C.length-1].overscaledZ;for(const oe in this._tiles){const re=this._tiles[oe];if(F[oe]||!re.hasData())continue;let fe=re.tileID;for(;fe.overscaledZ>ee;){fe=fe.scaledTo(fe.overscaledZ-1);const _e=this._tiles[fe.key];if(_e&&_e.hasData()&&Z[fe.key]){F[oe]=re.tileID;break}}}for(const oe in U)F[oe]||(this._coveredTiles[oe]=!0,F[oe]=U[oe])}for(const U in F)this._tiles[U].clearFadeHold();const G=i.bs(this._tiles,F);for(const U of G){const Z=this._tiles[U];Z.hasSymbolBuckets&&!Z.holdingForFade()?Z.setHoldDuration(this.map._fadeDuration):Z.hasSymbolBuckets&&!Z.symbolFadeFinished()||this._removeTile(+U)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const h={};if(s.length===0)return h;const g={},x=s.reduce((z,F)=>Math.min(z,F.overscaledZ),1/0),w=s[0].overscaledZ,E=Math.max(w-ca.maxOverzooming,this._source.minzoom),C=Math.max(w+ca.maxUnderzooming,this._source.minzoom),O={};for(const z of s){const F=this._addTile(z);h[z.key]=z,F.hasData()||x<this._source.maxzoom&&(O[z.key]=z)}this._retainLoadedChildren(O,x,C,h);for(const z of s){let F=this._tiles[z.key];if(F.hasData())continue;if(z.canonical.z>=this._source.maxzoom){const U=z.children(this._source.maxzoom)[0],Z=this.getTile(U);if(Z&&Z.hasData()){h[U.key]=U;continue}}else{const U=z.children(this._source.maxzoom);if(h[U[0].key]&&h[U[1].key]&&h[U[2].key]&&h[U[3].key])continue}let G=F.wasRequested();for(let U=z.overscaledZ-1;U>=E;--U){const Z=z.scaledTo(U);if(g[Z.key]||(g[Z.key]=!0,F=this.getTile(Z),!F&&G&&(F=this._addTile(Z)),F&&(h[Z.key]=Z,G=F.wasRequested(),F.hasData())))break}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const h=[];let g,x=this._tiles[s].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){g=this._loadedParentTiles[x.key];break}h.push(x.key);const w=x.scaledTo(x.overscaledZ-1);if(g=this._getLoadedTile(w),g)break;x=w}for(const w of h)this._loadedParentTiles[w]=g}}_addTile(s){let h=this._tiles[s.key];if(h)return h.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),h;h=this._cache.getAndRemove(s),h&&(this._setTileReloadTimer(s.key,h),h.tileID=s,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,h)));const g=!!h;if(!g){const x=this.map?this.map.painter:null,w=this._source.tileSize*s.overscaleFactor();h=this._source.type==="raster-array"?new rp(s,w,this.transform.tileZoom,x,this._isRaster):new tc(s,w,this.transform.tileZoom,x,this._isRaster),this._loadTile(h,this._tileLoaded.bind(this,h,s.key,h.state))}return h.uses++,this._tiles[s.key]=h,g||this._source.fire(new i.A("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(s,h){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const g=h.getExpiryTimeout();g&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},g))}_removeTile(s){const h=this._tiles[s];h&&(h.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),h.uses>0||(h.hasData()&&h.state!=="reloading"||h.state==="empty"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,h,g){const x=[],w=this.transform;if(!w)return x;const E=w.projection.name==="globe",C=i.ay(w.center.lng);for(const O in this._tiles){const z=this._tiles[O];if(g&&z.clearQueryDebugViz(),z.holdingForFade())continue;let F;if(E){const G=z.tileID.canonical;if(G.z===0){const U=[Math.abs(i.aD(C,...Xh(G,-1))-C),Math.abs(i.aD(C,...Xh(G,1))-C)];F=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(i.aD(C,...Xh(G,-1))-C),Math.abs(i.aD(C,...Xh(G,0))-C),Math.abs(i.aD(C,...Xh(G,1))-C)];F=[U.indexOf(Math.min(...U))-1]}}else F=[0];for(const G of F){const U=s.containsTile(z,w,h,G);U&&x.push(U)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,h){const g=this.getRenderableIds(s,h).map(w=>this._tiles[w].tileID),x=this.transform.projection.name==="globe";for(const w of g)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=x?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return g}sortCoordinatesByDistance(s){const h=s.slice(),g=this.transform._camera.position,x=this.transform._camera.forward(),w={};for(const E of h){const C=1/(1<<E.canonical.z);w[E.key]=((E.canonical.x+.5)*C+E.wrap-g[0])*x[0]+((E.canonical.y+.5)*C-g[1])*x[1]-g[2]*x[2]}return h.sort((E,C)=>w[E.key]-w[C.key]),h}hasTransition(){if(this._source.hasTransition())return!0;if(ag(this._source.type))for(const s in this._tiles){const h=this._tiles[s];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(s,h,g){this._state.updateState(s=s||"_geojsonTileLayer",h,g)}removeFeatureState(s,h,g){this._state.removeFeatureState(s=s||"_geojsonTileLayer",h,g)}getFeatureState(s,h){return this._state.getState(s=s||"_geojsonTileLayer",h)}setDependencies(s,h,g){const x=this._tiles[s];x&&x.setDependencies(h,g)}reloadTilesForDependencies(s,h){for(const g in this._tiles)this._tiles[g].hasDependency(s,h)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(s,h))}_preloadTiles(s,h){if(!this._sourceLoaded){const O=()=>{this._sourceLoaded&&(this._source.off("data",O),this._preloadTiles(s,h))};return void this._source.on("data",O)}const g=new Map,x=Array.isArray(s)?s:[s],w=this.map.painter.terrain,E=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const O of x){const z=O.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const F of z)g.set(F.key,F);this.usedForTerrain&&O.updateElevation(!1)}const C=Array.from(g.values());i.bt(C,(O,z)=>{const F=new tc(O,this._source.tileSize*O.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(F,G=>{this._source.type==="raster-dem"&&F.dem&&this._backfillDEM(F),z(G,F)})},h)}}function og(m,s){const h=Math.abs(2*m.wrap)-+(m.wrap<0),g=Math.abs(2*s.wrap)-+(s.wrap<0);return m.overscaledZ-s.overscaledZ||g-h||s.canonical.y-m.canonical.y||s.canonical.x-m.canonical.x}function ag(m){return m==="raster"||m==="image"||m==="video"||m==="custom"}function Xh(m,s){const h=1<<m.z;return[m.x/h+s,(m.x+1)/h+s]}ca.maxOverzooming=10,ca.maxUnderzooming=3;class qw{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,h=!1;for(const g in this.style._mergedLayers){const x=this.style._mergedLayers[g];if(x.type==="fill-extrusion")this.layers.push({layer:x,visible:s,visibilityChanged:h});else if(x.type==="model"){const w=this.style.getLayerSource(x);w&&w.type==="batched-model"&&this.layers.push({layer:x,visible:s,visibilityChanged:h})}}}onNewFrame(s){this.layersGotHidden=!1;for(const h of this.layers){const g=h.layer;let x=!1;g.type==="fill-extrusion"?x=!g.isHidden(s)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="model"&&(x=!g.isHidden(s)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&h.visible,h.visible=x}}updateZOffset(s,h){this.currentBuildingBuckets=[];for(const x of this.layers){const w=x.layer,E=this.style.getLayerSourceCache(w);let C=1;w.type==="fill-extrusion"&&(C=x.visible?w.paint.get("fill-extrusion-vertical-scale"):0);let O=E?E.getTile(h):null;if(!O&&E&&h.canonical.z>E.getSource().minzoom){let z=h.scaledTo(Math.min(E.getSource().maxzoom,h.overscaledZ-1));for(;z.overscaledZ>=E.getSource().minzoom&&(O=E.getTile(z),!O&&z.overscaledZ!==0);)z=z.scaledTo(z.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:O?O.getBucket(w):null,tileID:O?O.tileID:h,verticalScale:C})}s.hasAnyZOffset=!1;let g=!1;for(let x=0;x<s.symbolInstances.length;x++){const w=s.symbolInstances.get(x),E=w.zOffset,C=this._getHeightAtTileOffset(h,w.tileAnchorX,w.tileAnchorY);w.zOffset=C!==Number.NEGATIVE_INFINITY?C:E,g||E===w.zOffset||(g=!0),s.hasAnyZOffset||w.zOffset===0||(s.hasAnyZOffset=!0)}g&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,h,g,x){let w=h,E=g;if(s.canonical.z!==x.canonical.z){const C=x.canonical,O=1/(1<<s.canonical.z-C.z);w=(h+s.canonical.x*i.aj)*O-C.x*i.aj|0,E=(g+s.canonical.y*i.aj)*O-C.y*i.aj|0}return{tileX:w,tileY:E}}_getHeightAtTileOffset(s,h,g){let x,w;for(let E=0;E<this.layers.length;++E){if(this.layers[E].layer.type!=="fill-extrusion")continue;const{bucket:C,tileID:O,verticalScale:z}=this.currentBuildingBuckets[E];if(!C)continue;const{tileX:F,tileY:G}=this._mapCoordToOverlappingTile(s,h,g,O),U=C.getHeightAtTileCoord(F,G);U&&U.height!==void 0&&(U.hidden?x=U.height:w=Math.max(U.height*z,w||0))}if(w!==void 0)return w;for(let E=0;E<this.layers.length;++E){const C=this.layers[E];if(C.layer.type!=="model"||!C.visible)continue;const{bucket:O,tileID:z}=this.currentBuildingBuckets[E];if(!O)continue;const{tileX:F,tileY:G}=this._mapCoordToOverlappingTile(s,h,g,z),U=O.getHeightAtTileCoord(F,G);if(U&&!U.hidden)return U.height===void 0&&x!==void 0?Math.min(U.maxHeight,x)*U.verticalScale:U.height?U.height*U.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function sg(m,s){const h={};for(const g in m)g!=="ref"&&(h[g]=m[g]);return i.bu.forEach(g=>{g in s&&(h[g]=s[g])}),h}function lg(m){m=m.slice();const s=Object.create(null);for(let h=0;h<m.length;h++)s[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=sg(m[h],s[m[h].ref]));return m}const gr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Kh(m,s,h){h.push({command:gr.addSource,args:[m,s[m]]})}function Yh(m,s,h){s.push({command:gr.removeSource,args:[m]}),h[m]=!0}function uI(m,s,h,g){Yh(m,h,g),Kh(m,s,h)}function Zw(m,s,h){let g;for(g in m[h])if(m[h].hasOwnProperty(g)&&g!=="data"&&!i.bv(m[h][g],s[h][g]))return!1;for(g in s[h])if(s[h].hasOwnProperty(g)&&g!=="data"&&!i.bv(m[h][g],s[h][g]))return!1;return!0}function Lu(m,s,h,g,x,w){let E;for(E in s=s||{},m=m||{})m.hasOwnProperty(E)&&(i.bv(m[E],s[E])||h.push({command:w,args:[g,E,s[E],x]}));for(E in s)s.hasOwnProperty(E)&&!m.hasOwnProperty(E)&&(i.bv(m[E],s[E])||h.push({command:w,args:[g,E,s[E],x]}))}function Uc(m){return m.id}function Jh(m,s){return m[s.id]=s,m}class Xw{constructor(s,h){this.reset(s,h)}reset(s,h){this.points=s||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=i.aD(s,0,1);let h=1,g=this._distances[h];const x=s*this.paddedLength+this.padding;for(;g<x&&h<this._distances.length;)g=this._distances[++h];const w=h-1,E=this._distances[w],C=g-E,O=C>0?(x-E)/C:0;return this.points[w].mult(1-O).add(this.points[h].mult(O))}}class Xv{constructor(s,h,g){const x=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(s/g),this.yCellCount=Math.ceil(h/g);for(let E=0;E<this.xCellCount*this.yCellCount;E++)x.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=h,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,h,g,x,w){this._forEachCell(h,g,x,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(w)}insertCircle(s,h,g,x){this._forEachCell(h-x,g-x,h+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(h),this.circles.push(g),this.circles.push(x)}_insertBoxCell(s,h,g,x,w,E){this.boxCells[w].push(E)}_insertCircleCell(s,h,g,x,w,E){this.circleCells[w].push(E)}_query(s,h,g,x,w,E){if(g<0||s>this.width||x<0||h>this.height)return!w&&[];const C=[];if(s<=0&&h<=0&&this.width<=g&&this.height<=x){if(w)return!0;for(let O=0;O<this.boxKeys.length;O++)C.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const z=this.circles[3*O],F=this.circles[3*O+1],G=this.circles[3*O+2];C.push({key:this.circleKeys[O],x1:z-G,y1:F-G,x2:z+G,y2:F+G})}return E?C.filter(E):C}return this._forEachCell(s,h,g,x,this._queryCell,C,{hitTest:w,seenUids:{box:{},circle:{}}},E),w?C.length>0:C}_queryCircle(s,h,g,x,w){const E=s-g,C=s+g,O=h-g,z=h+g;if(C<0||E>this.width||z<0||O>this.height)return!x&&[];const F=[];return this._forEachCell(E,O,C,z,this._queryCellCircle,F,{hitTest:x,circle:{x:s,y:h,radius:g},seenUids:{box:{},circle:{}}},w),x?F.length>0:F}query(s,h,g,x,w){return this._query(s,h,g,x,!1,w)}hitTest(s,h,g,x,w){return this._query(s,h,g,x,!0,w)}hitTestCircle(s,h,g,x){return this._queryCircle(s,h,g,!0,x)}_queryCell(s,h,g,x,w,E,C,O){const z=C.seenUids,F=this.boxCells[w];if(F!==null){const U=this.bboxes;for(const Z of F)if(!z.box[Z]){z.box[Z]=!0;const te=4*Z;if(s<=U[te+2]&&h<=U[te+3]&&g>=U[te+0]&&x>=U[te+1]&&(!O||O(this.boxKeys[Z]))){if(C.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[Z],x1:U[te],y1:U[te+1],x2:U[te+2],y2:U[te+3]})}}}const G=this.circleCells[w];if(G!==null){const U=this.circles;for(const Z of G)if(!z.circle[Z]){z.circle[Z]=!0;const te=3*Z;if(this._circleAndRectCollide(U[te],U[te+1],U[te+2],s,h,g,x)&&(!O||O(this.circleKeys[Z]))){if(C.hitTest)return E.push(!0),!0;{const ee=U[te],oe=U[te+1],re=U[te+2];E.push({key:this.circleKeys[Z],x1:ee-re,y1:oe-re,x2:ee+re,y2:oe+re})}}}}}_queryCellCircle(s,h,g,x,w,E,C,O){const z=C.circle,F=C.seenUids,G=this.boxCells[w];if(G!==null){const Z=this.bboxes;for(const te of G)if(!F.box[te]){F.box[te]=!0;const ee=4*te;if(this._circleAndRectCollide(z.x,z.y,z.radius,Z[ee+0],Z[ee+1],Z[ee+2],Z[ee+3])&&(!O||O(this.boxKeys[te])))return E.push(!0),!0}}const U=this.circleCells[w];if(U!==null){const Z=this.circles;for(const te of U)if(!F.circle[te]){F.circle[te]=!0;const ee=3*te;if(this._circlesCollide(Z[ee],Z[ee+1],Z[ee+2],z.x,z.y,z.radius)&&(!O||O(this.circleKeys[te])))return E.push(!0),!0}}}_forEachCell(s,h,g,x,w,E,C,O){const z=this._convertToXCellCoord(s),F=this._convertToYCellCoord(h),G=this._convertToXCellCoord(g),U=this._convertToYCellCoord(x);for(let Z=z;Z<=G;Z++)for(let te=F;te<=U;te++)if(w.call(this,s,h,g,x,this.xCellCount*te+Z,E,C,O))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,h,g,x,w,E){const C=x-s,O=w-h,z=g+E;return z*z>C*C+O*O}_circleAndRectCollide(s,h,g,x,w,E,C){const O=(E-x)/2,z=Math.abs(s-(x+O));if(z>O+g)return!1;const F=(C-w)/2,G=Math.abs(h-(w+F));if(G>F+g)return!1;if(z<=O||G<=F)return!0;const U=z-O,Z=G-F;return U*U+Z*Z<=g*g}}const zu={unknown:0,flipRequired:1,flipNotRequired:2},op=Math.tan(85*Math.PI/180);function Qh(m,s,h,g,x,w,E){const C=i.bz();if(h)if(w.name==="globe"){const O=i.bA(x,s);i.az(C,C,O)}else{const O=i.bB([],E);C[0]=O[0],C[1]=O[1],C[4]=O[2],C[5]=O[3],g||i.by(C,C,x.angle)}else i.az(C,x.labelPlaneMatrix,m);return C}function cg(m,s,h,g,x,w,E){const C=Qh(m,s,h,g,x,w,E);return w.name==="globe"&&h||(C[2]=C[6]=C[10]=C[14]=0),C}function Kv(m,s,h,g,x,w,E){if(h){if(w.name==="globe"){const C=Qh(m,s,h,g,x,w,E);return i.bi(C,C),i.az(C,m,C),C}{const C=i.bw(m),O=i.bx([]);return O[0]=E[0],O[1]=E[1],O[4]=E[2],O[5]=E[3],i.az(C,C,O),g||i.by(C,C,-x.angle),C}}return x.glCoordMatrix}function Ba(m,s,h,g){const x=[m,s,h,1];h?i.aA(x,x,g):Kw(x,x,g);const w=x[3];return x[0]/=w,x[1]/=w,x[2]/=w,x}function Vc(m,s){return Math.min(.5+m/s*.5,1.5)}function Yv(m,s){const h=m[0]/m[3],g=m[1]/m[3];return h>=-s[0]&&h<=s[0]&&g>=-s[1]&&g<=s[1]}function Jv(m,s,h,g,x,w,E,C,O,z){const F=h.transform,G=g?m.textSizeData:m.iconSizeData,U=i.bH(G,h.transform.zoom),Z=F.projection.name==="globe",te=[256/h.width*2+1,256/h.height*2+1],ee=g?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ee.clear();let oe=null;Z&&(oe=g?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const re=m.lineVertexArray,fe=g?m.text.placedSymbolArray:m.icon.placedSymbolArray,_e=h.transform.width/h.transform.height;let be,Pe=!1;for(let Ee=0;Ee<fe.length;Ee++){const Ae=fe.get(Ee),{numGlyphs:we,writingMode:Me}=Ae;if(Me!==i.bI.vertical||Pe||be===i.bI.horizontal||(Pe=!0),be=Me,(Ae.hidden||Me===i.bI.vertical)&&!Pe){wr(we,ee);continue}Pe=!1;const ke=new i.P(Ae.tileAnchorX,Ae.tileAnchorY);let{x:Qe,y:qe,z:mt}=F.projection.projectTilePoint(ke.x,ke.y,z.canonical);if(O){const[Yt,an,Xt]=O(ke);Qe+=Yt,qe+=an,mt+=Xt}const dt=[Qe,qe,mt,1];if(i.aA(dt,dt,s),!Yv(dt,te)){wr(we,ee);continue}const Ot=dt[3],Ze=Vc(h.transform.getCameraToCenterDistance(F.projection),Ot),et=i.bJ(G,U,Ae),We=E?et/Ze:et*Ze,vt=Ba(Qe,qe,mt,x);if(vt[3]<=0){wr(we,ee);continue}let at={};const Tt=i.al(m.layers[0].layout.get("text-max-angle")),gt=Math.cos(Tt),Et=E?null:O,At=ja(Ae,We,!1,C,s,x,w,m.glyphOffsetArray,re,ee,oe,vt,ke,at,_e,Et,F.projection,z,E,gt);Pe=At.useVertical,Et&&At.needsFlipping&&(at={}),(At.notEnoughRoom||Pe||At.needsFlipping&&ja(Ae,We,!0,C,s,x,w,m.glyphOffsetArray,re,ee,oe,vt,ke,at,_e,Et,F.projection,z,E,gt).notEnoughRoom)&&wr(we,ee)}g?(m.text.dynamicLayoutVertexBuffer.updateData(ee),oe&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(oe)):(m.icon.dynamicLayoutVertexBuffer.updateData(ee),oe&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(oe))}function ug(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe){const{lineStartIndex:re,glyphStartIndex:fe,segment:_e}=C,be=fe+C.numGlyphs,Pe=re+C.lineLength,Ee=s.getoffsetX(fe),Ae=s.getoffsetX(be-1),we=ap(m*Ee,h,g,x,w,E,_e,re,Pe,O,z,F,G,U,!0,Z,te,ee,oe);if(!we)return null;const Me=ap(m*Ae,h,g,x,w,E,_e,re,Pe,O,z,F,G,U,!0,Z,te,ee,oe);return Me?{first:we,last:Me}:null}function Nu(m,s,h,g){return m===i.bI.horizontal&&Math.abs(g)>Math.abs(h)?{useVertical:!0}:m===i.bI.vertical?g>0?{needsFlipping:!0}:null:s!==zu.unknown&&function(x,w){return x===0||Math.abs(w/x)>op}(h,g)?s===zu.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function ja(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe,re,fe,_e){const be=s/24,Pe=m.lineOffsetX*be,Ee=m.lineOffsetY*be,{lineStartIndex:Ae,glyphStartIndex:we,numGlyphs:Me,segment:ke,writingMode:Qe,flipState:qe}=m,mt=Ae+m.lineLength,dt=Ot=>{if(F){const[vt,at,Tt]=Ot.up,gt=z.length;i.bK(F,gt+0,vt,at,Tt),i.bK(F,gt+1,vt,at,Tt),i.bK(F,gt+2,vt,at,Tt),i.bK(F,gt+3,vt,at,Tt)}const[Ze,et,We]=Ot.point;i.bL(z,Ze,et,We,Ot.angle)};if(Me>1){const Ot=ug(be,C,Pe,Ee,h,G,U,m,O,w,Z,ee,!1,oe,re,fe,_e);if(!Ot)return{notEnoughRoom:!0};if(g&&!h){let[Ze,et,We]=Ot.first.point,[vt,at,Tt]=Ot.last.point;[Ze,et]=Ba(Ze,et,We,E),[vt,at]=Ba(vt,at,Tt,E);const gt=Nu(Qe,qe,(vt-Ze)*te,at-et);if(m.flipState=gt&&gt.needsFlipping?zu.flipRequired:zu.flipNotRequired,gt)return gt}dt(Ot.first);for(let Ze=we+1;Ze<we+Me-1;Ze++){const et=ap(be*C.getoffsetX(Ze),Pe,Ee,h,G,U,ke,Ae,mt,O,w,Z,ee,!1,!1,oe,re,fe,_e);if(!et)return z.length-=4*(Ze-we),{notEnoughRoom:!0};dt(et)}dt(Ot.last)}else{if(g&&!h){const Ze=Ba(U.x,U.y,0,x),et=Ae+ke+1,We=new i.P(O.getx(et),O.gety(et)),vt=Ba(We.x,We.y,0,x),at=vt[3]>0?vt:hg(U,We,Ze,1,x,void 0,oe,re.canonical),Tt=Nu(Qe,qe,(at[0]-Ze[0])*te,at[1]-Ze[1]);if(m.flipState=Tt&&Tt.needsFlipping?zu.flipRequired:zu.flipNotRequired,Tt)return Tt}const Ot=ap(be*C.getoffsetX(we),Pe,Ee,h,G,U,ke,Ae,mt,O,w,Z,ee,!1,!1,oe,re,fe,_e);if(!Ot)return{notEnoughRoom:!0};dt(Ot)}return{}}function Qv(m,s,h,g,x){const{x:w,y:E,z:C}=g.projectTilePoint(m.x,m.y,s);if(!x)return Ba(w,E,C,h);const[O,z,F]=x(m);return Ba(w+O,E+z,C+F,h)}function hg(m,s,h,g,x,w,E,C){const O=Qv(m.sub(s)._unit()._add(m),C,x,E,w);return i.at(O,h,O),i.au(O,O),i.bF(O,h,O,g)}function ap(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe,re,fe){const _e=g?m-s:m+s;let be=_e>0?1:-1,Pe=0;g&&(be*=-1,Pe=Math.PI),be<0&&(Pe+=Math.PI);let Ee=C+E+(be>0?0:1)|0,Ae=x,we=x,Me=0,ke=0;const Qe=Math.abs(_e),qe=[],mt=[];let dt=w,Ot=dt,Ze=i.bC([]);const et=()=>hg(Ot,dt,we,Qe-Me+1,F,U,ee,oe.canonical);for(;Me+ke<=Qe;){if(Ee+=be,Ee<C||Ee>=O)return null;if(we=Ae,Ot=dt,qe.push(we),Z&&mt.push(Ot),dt=new i.P(z.getx(Ee),z.gety(Ee)),Ae=G[Ee],!Ae){const Xt=Qv(dt,oe.canonical,F,ee,U);Ae=Xt[3]>0?G[Ee]=Xt:et()}Me+=ke;const Yt=i.at([],Ae,we),an=i.bD(we,Ae);if(h&&an>0&&ke>0&&i.bE(Ze,Yt)/(ke*an)<fe)return null;ke=an,Ze=Yt}te&&U&&(G[Ee]&&(Ae=et(),ke=i.bD(we,Ae),Ze=i.at([],Ae,we)),G[Ee]=Ae);const We=(Qe-Me)/ke,vt=dt.sub(Ot)._mult(We)._add(Ot),at=i.bF([],we,Ze,We);let Tt=[0,0,1],gt=Ze[0],Et=Ze[1];if(re&&(Tt=ee.upVector(oe.canonical,vt.x,vt.y),Tt[0]!==0||Tt[1]!==0||Tt[2]!==1)){const Yt=[Tt[2],0,-Tt[0]],an=i.bG([],Tt,Yt);i.au(Yt,Yt),i.au(an,an),gt=i.bE(Ze,Yt),Et=i.bE(Ze,an)}if(h){const Yt=i.bG([],Tt,Ze);i.au(Yt,Yt),i.bF(at,at,Yt,h*be)}const At=Pe+Math.atan2(Et,gt);return qe.push(at),Z&&mt.push(vt),{point:at,angle:At,path:qe,tilePath:mt,up:Tt}}function wr(m,s){const h=s.length,g=h+4*m;s.resize(g),s.float32.fill(-1/0,4*h,4*g)}function Kw(m,s,h){const g=s[0],x=s[1];return m[0]=h[0]*g+h[4]*x+h[12],m[1]=h[1]*g+h[5]*x+h[13],m[3]=h[3]*g+h[7]*x+h[15],m}const yn=100;class Yw{constructor(s,h,g=new Xv(s.width+200,s.height+200,25),x=new Xv(s.width+200,s.height+200,25)){this.transform=s,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+yn,this.screenBottomBoundary=s.height+yn,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=h}placeCollisionBox(s,h,g,x,w,E,C,O){let z=g.projectedAnchorX,F=g.projectedAnchorY,G=g.projectedAnchorZ;const U=g.elevation,Z=g.tileID,te=s.getProjection();if(U&&Z){const[Ee,Ae,we]=te.upVector(Z.canonical,g.tileAnchorX,g.tileAnchorY),Me=te.upVectorScale(Z.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=Ee*U*Me,F+=Ae*U*Me,G+=we*U*Me}const ee=this.projectAndGetPerspectiveRatio(C,z,F,G,g.tileID,te.name==="globe"||!!U||this.transform.pitch>0,te),oe=E*ee.perspectiveRatio,re=(g.x1*h+x.x-g.padding)*oe+ee.point.x,fe=(g.y1*h+x.y-g.padding)*oe+ee.point.y,_e=(g.x2*h+x.x+g.padding)*oe+ee.point.x,be=(g.y2*h+x.y+g.padding)*oe+ee.point.y,Pe=ee.perspectiveRatio<=.55||ee.occluded;return!this.isInsideGrid(re,fe,_e,be)||!w&&this.grid.hitTest(re,fe,_e,be,O)||Pe?{box:[],offscreen:!1,occluded:ee.occluded}:{box:[re,fe,_e,be],offscreen:this.isOffscreen(re,fe,_e,be),occluded:!1}}placeCollisionCircles(s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee){const oe=[],re=this.transform.elevation,fe=s.getProjection(),_e=re?re.getAtTileOffsetFunc(ee,this.transform.center.lat,this.transform.worldSize,fe):null,be=new i.P(g.tileAnchorX,g.tileAnchorY);let{x:Pe,y:Ee,z:Ae}=fe.projectTilePoint(be.x,be.y,ee.canonical);if(_e){const[Tt,gt,Et]=_e(be);Pe+=Tt,Ee+=gt,Ae+=Et}const we=fe.name==="globe",Me=this.projectAndGetPerspectiveRatio(C,Pe,Ee,Ae,ee,we||!!re||this.transform.pitch>0,fe),{perspectiveRatio:ke}=Me,Qe=(G?E/ke:E*ke)/i.bO,qe=Ba(Pe,Ee,Ae,O),mt=g.lineOffsetX*Qe,dt=g.lineOffsetY*Qe,Ot=i.al(s.layers[0].layout.get("text-max-angle")),Ze=Math.cos(Ot),et=Me.signedDistanceFromCamera>0?ug(Qe,w,mt,dt,!1,qe,be,g,x,O,{},re&&!G?_e:null,G&&!!re,fe,ee,G,Ze):null;let We=!1,vt=!1,at=!0;if(et&&!Me.occluded){const Tt=.5*Z*ke+te,gt=new i.P(-100,-100),Et=new i.P(this.screenRightBoundary,this.screenBottomBoundary),At=new Xw,{first:Yt,last:an}=et,Xt=Yt.path.length;let ln=[];for(let Rn=Xt-1;Rn>=1;Rn--)ln.push(Yt.path[Rn]);for(let Rn=1;Rn<an.path.length;Rn++)ln.push(an.path[Rn]);const Qt=2.5*Tt;z&&(ln=ln.map(([Rn,tr,Nr],kr)=>(_e&&!we&&(Nr=_e(kr<Xt-1?Yt.tilePath[Xt-1-kr]:an.tilePath[kr-Xt+2])[2]),Ba(Rn,tr,Nr,z))),ln.some(Rn=>Rn[3]<=0)&&(ln=[]));let Sn=[];if(ln.length>0){let Rn=1/0,tr=-1/0,Nr=1/0,kr=-1/0;for(const rr of ln)Rn=Math.min(Rn,rr[0]),Nr=Math.min(Nr,rr[1]),tr=Math.max(tr,rr[0]),kr=Math.max(kr,rr[1]);tr>=gt.x&&Rn<=Et.x&&kr>=gt.y&&Nr<=Et.y&&(Sn=[ln.map(rr=>new i.P(rr[0],rr[1]))],(Rn<gt.x||tr>Et.x||Nr<gt.y||kr>Et.y)&&(Sn=i.bM(Sn,gt.x,gt.y,Et.x,Et.y)))}for(const Rn of Sn){At.reset(Rn,.25*Tt);let tr=0;tr=At.length<=.5*Tt?1:Math.ceil(At.paddedLength/Qt)+1;for(let Nr=0;Nr<tr;Nr++){const kr=Nr/Math.max(tr-1,1),rr=At.lerp(kr),Oi=rr.x+yn,wi=rr.y+yn;oe.push(Oi,wi,Tt,0);const Fn=Oi-Tt,hr=wi-Tt,yr=Oi+Tt,Fr=wi+Tt;if(at=at&&this.isOffscreen(Fn,hr,yr,Fr),vt=vt||this.isInsideGrid(Fn,hr,yr,Fr),!h&&this.grid.hitTestCircle(Oi,wi,Tt,U)&&(We=!0,!F))return{circles:[],offscreen:!1,collisionDetected:We,occluded:!1}}}}return{circles:!F&&We||!vt?[]:oe,offscreen:at,collisionDetected:We,occluded:Me.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let g=1/0,x=1/0,w=-1/0,E=-1/0;for(const F of s){const G=new i.P(F.x+yn,F.y+yn);g=Math.min(g,G.x),x=Math.min(x,G.y),w=Math.max(w,G.x),E=Math.max(E,G.y),h.push(G)}const C=this.grid.query(g,x,w,E).concat(this.ignoredGrid.query(g,x,w,E)),O={},z={};for(const F of C){const G=F.key;if(O[G.bucketInstanceId]===void 0&&(O[G.bucketInstanceId]={}),O[G.bucketInstanceId][G.featureIndex])continue;const U=[new i.P(F.x1,F.y1),new i.P(F.x2,F.y1),new i.P(F.x2,F.y2),new i.P(F.x1,F.y2)];i.bN(h,U)&&(O[G.bucketInstanceId][G.featureIndex]=!0,z[G.bucketInstanceId]===void 0&&(z[G.bucketInstanceId]=[]),z[G.bucketInstanceId].push(G.featureIndex))}return z}insertCollisionBox(s,h,g,x,w){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:w},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,h,g,x,w){const E=h?this.ignoredGrid:this.grid,C={bucketInstanceId:g,featureIndex:x,collisionGroupID:w};for(let O=0;O<s.length;O+=4)E.insertCircle(C,s[O],s[O+1],s[O+2])}projectAndGetPerspectiveRatio(s,h,g,x,w,E,C){const O=[h,g,x,1];let z=!1;x||this.transform.pitch>0?(i.aA(O,O,s),this.fogState&&w&&C.name!=="globe"&&(z=function(U,Z,te,ee,oe,re){const fe=re.calculateFogTileMatrix(oe),_e=[Z,te,ee];return i.ad(_e,_e,fe),rn(U,i.ae(_e),re.pitch,re._fov)}(this.fogState,h,g,x,w.toUnwrapped(),this.transform)>.9)):Kw(O,O,s);const F=O[3];return{point:new i.P((O[0]/F+1)/2*this.transform.width+yn,(-O[1]/F+1)/2*this.transform.height+yn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(C)/F*.5,1.5),signedDistanceFromCamera:F,occluded:E&&O[2]>F||z}}isOffscreen(s,h,g,x){return g<yn||s>=this.screenRightBoundary||x<yn||h>this.screenBottomBoundary}isInsideGrid(s,h,g,x){return g>=0&&s<this.gridRightBoundary&&x>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const s=i.bx([]);return i.bo(s,s,[-100,-100,0]),s}}function dg(m,s,h){const g=s.createTileMatrix(m,m.worldSize,h.toUnwrapped());return i.az(new Float32Array(16),m.projMatrix,g)}function fg(m,s,h){if(s.projection.name===h.projection.name)return m.projMatrix;const g=h.clone();return g.setProjection(s.projection),dg(g,s.getProjection(),m)}function sp(m,s,h){return s.name===h.projection.name?m.projMatrix:dg(h,s,m)}class Ts{constructor(s,h,g,x){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?h:-h))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Fu{constructor(s,h,g,x,w,E=!1){this.text=new Ts(s?s.text:null,h,g,w),this.icon=new Ts(s?s.icon:null,h,x,w),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Gc{constructor(s,h,g,x=!1){this.text=s,this.icon=h,this.skipFade=g,this.clipped=x}}class cn{constructor(){this.invProjMatrix=i.bz(),this.viewportMatrix=i.bz(),this.circles=[]}}class $r{constructor(s,h,g,x,w){this.bucketInstanceId=s,this.featureIndex=h,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=w}}class Or{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const h=++this.maxGroupID;this.collisionGroups[s]={ID:h,predicate:g=>g.collisionGroupID===h}}return this.collisionGroups[s]}}function Ea(m,s,h,g,x){const{horizontalAlign:w,verticalAlign:E}=i.bV(m),C=-(w-.5)*s,O=-(E-.5)*h,z=i.bU(m,g);return new i.P(C+z[0]*x,O+z[1]*x)}function Wc(m,s,h,g,x){const w=new i.P(m,s);return h&&w._rotate(g?x:-x),w}class Ir{constructor(s,h,g,x,w,E){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new Yw(this.transform,w),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Or(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,h,g,x,w=1){const E=g.getBucket(h),C=g.latestFeatureIndex;if(!E||!C||h.fqid!==E.layerIds[0])return;const O=E.layers[0].layout,z=E.layers[0].paint,F=g.collisionBoxArray,G=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),U=g.tileSize/i.aj,Z=g.tileID.toUnwrapped();this.transform.setProjection(E.projection);const te=(ee=g.tileID,oe=E.getProjection(),re=this.transform,oe.name===this.projection?re.calculateProjMatrix(ee.toUnwrapped()):dg(re,oe,ee));var ee,oe,re;const fe=O.get("text-pitch-alignment")==="map",_e=O.get("text-rotation-alignment")==="map";h.compileFilter(h.options);const be=h.dynamicFilter(),Pe=h.dynamicFilterNeedsFeature(),Ee=this.transform.calculatePixelsToTileUnitsMatrix(g),Ae=cg(te,g.tileID.canonical,fe,_e,this.transform,E.getProjection(),Ee);let we=null;if(fe){const et=Kv(te,g.tileID.canonical,fe,_e,this.transform,E.getProjection(),Ee);we=i.az([],this.transform.labelPlaneMatrix,et)}let Me=null;be&&g.latestFeatureIndex&&(Me={unwrappedTileID:Z,dynamicFilter:be,dynamicFilterNeedsFeature:Pe}),this.retainedQueryData[E.bucketInstanceId]=new $r(E.bucketInstanceId,C,E.sourceLayerIndex,E.index,g.tileID);const[ke,Qe]=E.layers[0].layout.get("text-size-scale-range"),qe=i.aD(w,ke,Qe),[mt,dt]=O.get("icon-size-scale-range"),Ot=i.aD(w,mt,dt),Ze={bucket:E,layout:O,paint:z,posMatrix:te,textLabelPlaneMatrix:Ae,labelToScreenMatrix:we,clippingData:Me,scale:G,textPixelRatio:U,holdingForFade:g.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:i.bH(E.textSizeData,this.transform.zoom,qe),partiallyEvaluatedIconSize:i.bH(E.iconSizeData,this.transform.zoom,Ot),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(x)for(const et of E.sortKeyRanges){const{sortKey:We,symbolInstanceStart:vt,symbolInstanceEnd:at}=et;s.push({sortKey:We,symbolInstanceStart:vt,symbolInstanceEnd:at,parameters:Ze})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Ze})}attemptAnchorPlacement(s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe,re,fe){const{textOffset0:_e,textOffset1:be,crossTileID:Pe}=U,Ee=[_e,be],Ae=Ea(s,g,x,Ee,w),we=this.collisionIndex.placeCollisionBox(te,w,h,Wc(Ae.x,Ae.y,E,C,this.transform.angle),G,O,z,F.predicate);if(oe){const Me=te.getSymbolInstanceIconSize(fe,this.transform.zoom,U.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(te,Me,oe,Wc(Ae.x,Ae.y,E,C,this.transform.angle),G,O,z,F.predicate).box.length===0)return}if(we.box.length>0){let Me;return this.prevPlacement&&this.prevPlacement.variableOffsets[Pe]&&this.prevPlacement.placements[Pe]&&this.prevPlacement.placements[Pe].text&&(Me=this.prevPlacement.variableOffsets[Pe].anchor),this.variableOffsets[Pe]={textOffset:Ee,width:g,height:x,anchor:s,textScale:w,prevAnchor:Me},this.markUsedJustification(te,s,U,ee),te.allowVerticalPlacement&&(this.markUsedOrientation(te,ee,U),this.placedOrientations[Pe]=ee),{shift:Ae,placedGlyphBoxes:we}}}placeLayerBucketPart(s,h,g,x,w=1){const{bucket:E,layout:C,paint:O,posMatrix:z,textLabelPlaneMatrix:F,labelToScreenMatrix:G,clippingData:U,textPixelRatio:Z,holdingForFade:te,collisionBoxArray:ee,partiallyEvaluatedTextSize:oe,partiallyEvaluatedIconSize:re,collisionGroup:fe,latestFeatureIndex:_e}=s.parameters,be=C.get("text-optional"),Pe=C.get("icon-optional"),Ee=C.get("text-allow-overlap"),Ae=C.get("icon-allow-overlap"),we=C.get("text-rotation-alignment")==="map",Me=C.get("text-pitch-alignment")==="map",ke=O.get("symbol-z-offset"),Qe=C.get("symbol-elevation-reference")==="sea",[qe,mt]=C.get("text-size-scale-range"),[dt,Ot]=C.get("icon-size-scale-range"),Ze=i.aD(w,qe,mt),et=i.aD(w,dt,Ot);this.transform.setProjection(E.projection);let We=Ee&&(Ae||!E.hasIconData()||Pe),vt=Ae&&(Ee||!E.hasTextData()||be);const at=!ke.isConstant();!E.collisionArrays&&ee&&E.deserializeCollisionBoxes(ee),g&&x&&E.updateCollisionDebugBuffers(this.transform.zoom,ee,Ze,et);const Tt=(gt,Et,At)=>{const{crossTileID:Yt,numVerticalGlyphVertices:an}=gt;let Xt=null;if(U&&U.dynamicFilterNeedsFeature||at){const mr=this.retainedQueryData[E.bucketInstanceId];Xt=_e.loadFeature({featureIndex:gt.featureIndex,bucketIndex:mr.bucketIndex,sourceLayerIndex:mr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(U&&!(0,U.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Xt,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new i.P(gt.tileAnchorX,gt.tileAnchorY),this.transform.calculateDistanceTileData(U.unwrappedTileID)))return this.placements[Yt]=new Gc(!1,!1,!1,!0),void h.add(Yt);const ln=ke.evaluate(Xt,{});if(h.has(Yt))return;if(te)return void(this.placements[Yt]=new Gc(!1,!1,!1));let Qt=!1,Sn=!1,Rn=!0,tr=!1,Nr=!1,kr=null,rr={box:null,offscreen:null,occluded:null},Oi={box:null,offscreen:null,occluded:null},wi=null,Fn=null,hr=null,yr=0,Fr=0,Xi=0;At.textFeatureIndex?yr=At.textFeatureIndex:gt.useRuntimeCollisionCircles&&(yr=gt.featureIndex),At.verticalTextFeatureIndex&&(Fr=At.verticalTextFeatureIndex);const Li=mr=>{mr.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const pi=this.transform.elevation;mr.elevation=Qe?ln:ln+(pi?pi.getAtTileOffset(mr.tileID,mr.tileAnchorX,mr.tileAnchorY):0),mr.elevation+=gt.zOffset},qi=At.textBox;if(qi){Li(qi);const mr=Sr=>{let vi=i.bI.horizontal;if(E.allowVerticalPlacement&&!Sr&&this.prevPlacement){const wo=this.prevPlacement.placedOrientations[Yt];wo&&(this.placedOrientations[Yt]=wo,vi=wo,this.markUsedOrientation(E,vi,gt))}return vi},pi=(Sr,vi)=>{if(E.allowVerticalPlacement&&an>0&&At.verticalTextBox){for(const wo of E.writingModes)if(wo===i.bI.vertical?(rr=vi(),Oi=rr):rr=Sr(),rr&&rr.box&&rr.box.length)break}else rr=Sr()};if(C.get("text-variable-anchor")){let Sr=C.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Yt]){const ri=this.prevPlacement.variableOffsets[Yt];Sr.indexOf(ri.anchor)>0&&(Sr=Sr.filter(Mo=>Mo!==ri.anchor),Sr.unshift(ri.anchor))}const vi=(ri,Mo,Ui)=>{const No=E.getSymbolInstanceTextSize(oe,gt,this.transform.zoom,Et),il=(ri.x2-ri.x1)*No+2*ri.padding,lc=(ri.y2-ri.y1)*No+2*ri.padding,Ua=gt.hasIconTextFit&&!Ae?Mo:null;Ua&&Li(Ua);let Is={box:[],offscreen:!1,occluded:!1};const Pl=Ee?2*Sr.length:Sr.length;for(let Cl=0;Cl<Pl;++Cl){const ol=this.attemptAnchorPlacement(Sr[Cl%Sr.length],ri,il,lc,No,we,Me,Z,z,fe,Cl>=Sr.length,gt,Et,E,Ui,Ua,oe,re);if(ol&&(Is=ol.placedGlyphBoxes,Is&&Is.box&&Is.box.length)){Qt=!0,kr=ol.shift;break}}return Is};pi(()=>vi(qi,At.iconBox,i.bI.horizontal),()=>{const ri=At.verticalTextBox;return ri&&Li(ri),E.allowVerticalPlacement&&!(rr&&rr.box&&rr.box.length)&&an>0&&ri?vi(ri,At.verticalIconBox,i.bI.vertical):{box:null,offscreen:null,occluded:null}}),rr&&(Qt=rr.box,Rn=rr.offscreen,tr=rr.occluded);const wo=mr(!(!rr||!rr.box));if(!Qt&&this.prevPlacement){const ri=this.prevPlacement.variableOffsets[Yt];ri&&(this.variableOffsets[Yt]=ri,this.markUsedJustification(E,ri.anchor,gt,wo))}}else{const Sr=(vi,wo)=>{const ri=E.getSymbolInstanceTextSize(oe,gt,this.transform.zoom,Et,w),Mo=this.collisionIndex.placeCollisionBox(E,ri,vi,new i.P(0,0),Ee,Z,z,fe.predicate);return Mo&&Mo.box&&Mo.box.length&&(this.markUsedOrientation(E,wo,gt),this.placedOrientations[Yt]=wo),Mo};pi(()=>Sr(qi,i.bI.horizontal),()=>{const vi=At.verticalTextBox;return E.allowVerticalPlacement&&an>0&&vi?(Li(vi),Sr(vi,i.bI.vertical)):{box:null,offscreen:null,occluded:null}}),mr(!!(rr&&rr.box&&rr.box.length))}}if(wi=rr,Qt=wi&&wi.box&&wi.box.length>0,Rn=wi&&wi.offscreen,tr=wi&&wi.occluded,gt.useRuntimeCollisionCircles){const mr=E.text.placedSymbolArray.get(gt.centerJustifiedTextSymbolIndex>=0?gt.centerJustifiedTextSymbolIndex:gt.verticalPlacedTextSymbolIndex),pi=i.bJ(E.textSizeData,oe,mr),Sr=C.get("text-padding");Fn=this.collisionIndex.placeCollisionCircles(E,Ee,mr,E.lineVertexArray,E.glyphOffsetArray,pi,z,F,G,g,Me,fe.predicate,gt.collisionCircleDiameter*pi/i.bO,Sr,this.retainedQueryData[E.bucketInstanceId].tileID),Qt=Ee||Fn.circles.length>0&&!Fn.collisionDetected,Rn=Rn&&Fn.offscreen,tr=Fn.occluded}if(At.iconFeatureIndex&&(Xi=At.iconFeatureIndex),At.iconBox){const mr=pi=>{Li(pi);const Sr=gt.hasIconTextFit&&kr?Wc(kr.x,kr.y,we,Me,this.transform.angle):new i.P(0,0),vi=E.getSymbolInstanceIconSize(re,this.transform.zoom,gt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,vi,pi,Sr,Ae,Z,z,fe.predicate)};Oi&&Oi.box&&Oi.box.length&&At.verticalIconBox?(hr=mr(At.verticalIconBox),Sn=hr.box.length>0):(hr=mr(At.iconBox),Sn=hr.box.length>0),Rn=Rn&&hr.offscreen,Nr=hr.occluded}const _i=be||gt.numHorizontalGlyphVertices===0&&an===0,Vn=Pe||gt.numIconVertices===0;if(_i||Vn?Vn?_i||(Sn=Sn&&Qt):Qt=Sn&&Qt:Sn=Qt=Sn&&Qt,Qt&&wi&&wi.box&&this.collisionIndex.insertCollisionBox(wi.box,C.get("text-ignore-placement"),E.bucketInstanceId,Oi&&Oi.box&&Fr?Fr:yr,fe.ID),Sn&&hr&&this.collisionIndex.insertCollisionBox(hr.box,C.get("icon-ignore-placement"),E.bucketInstanceId,Xi,fe.ID),Fn&&(Qt&&this.collisionIndex.insertCollisionCircles(Fn.circles,C.get("text-ignore-placement"),E.bucketInstanceId,yr,fe.ID),g)){const mr=E.bucketInstanceId;let pi=this.collisionCircleArrays[mr];pi===void 0&&(pi=this.collisionCircleArrays[mr]=new cn);for(let Sr=0;Sr<Fn.circles.length;Sr+=4)pi.circles.push(Fn.circles[Sr+0]),pi.circles.push(Fn.circles[Sr+1]),pi.circles.push(Fn.circles[Sr+2]),pi.circles.push(Fn.collisionDetected?1:0)}const fi=E.projection.name!=="globe";We=We&&(fi||!tr),vt=vt&&(fi||!Nr),this.placements[Yt]=new Gc(Qt||We,Sn||vt,Rn||E.justReloaded),h.add(Yt)};if(E.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.elevationType==="road"&&E.updateRoadElevation(),E.updateZOffset(),E.sortFeaturesByY){const gt=E.getSortedSymbolIndexes(this.transform.angle);for(let Et=gt.length-1;Et>=0;--Et){const At=gt[Et];Tt(E.symbolInstances.get(At),At,E.collisionArrays[At])}E.hasAnyZOffset&&i.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const gt=E.getSortedIndexesByZOffset();for(let Et=0;Et<gt.length;++Et){const At=gt[Et];Tt(E.symbolInstances.get(At),At,E.collisionArrays[At])}}else for(let gt=s.symbolInstanceStart;gt<s.symbolInstanceEnd;gt++)Tt(E.symbolInstances.get(gt),gt,E.collisionArrays[gt]);if(g&&E.bucketInstanceId in this.collisionCircleArrays){const gt=this.collisionCircleArrays[E.bucketInstanceId];i.bi(gt.invProjMatrix,z),gt.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(s,h,g,x){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:O,crossTileID:z}=g,F=i.bT(h),G=x===i.bI.vertical?O:F==="left"?w:F==="center"?E:F==="right"?C:-1;w>=0&&(s.text.placedSymbolArray.get(w).crossTileID=G>=0&&w!==G?0:z),E>=0&&(s.text.placedSymbolArray.get(E).crossTileID=G>=0&&E!==G?0:z),C>=0&&(s.text.placedSymbolArray.get(C).crossTileID=G>=0&&C!==G?0:z),O>=0&&(s.text.placedSymbolArray.get(O).crossTileID=G>=0&&O!==G?0:z)}markUsedOrientation(s,h,g){const x=h===i.bI.horizontal||h===i.bI.horizontalOnly?h:0,w=h===i.bI.vertical?h:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:z}=g,F=s.text.placedSymbolArray;E>=0&&(F.get(E).placedOrientation=x),C>=0&&(F.get(C).placedOrientation=x),O>=0&&(F.get(O).placedOrientation=x),z>=0&&(F.get(z).placedOrientation=w)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let g=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const x=h?h.symbolFadeChange(s):1,w=h?h.opacities:{},E=h?h.variableOffsets:{},C=h?h.placedOrientations:{};for(const O in this.placements){const z=this.placements[O],F=w[O];F?(this.opacities[O]=new Fu(F,x,z.text,z.icon,null,z.clipped),g=g||z.text!==F.text.placed||z.icon!==F.icon.placed):(this.opacities[O]=new Fu(null,x,z.text,z.icon,z.skipFade,z.clipped),g=g||z.text||z.icon)}for(const O in w){const z=w[O];if(!this.opacities[O]){const F=new Fu(z,x,!1,!1);F.isHidden()||(this.opacities[O]=F,g=g||z.text.placed||z.icon.placed)}}for(const O in E)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=E[O]);for(const O in C)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=C[O]);g?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:s)}updateLayerOpacities(s,h,g,x){const w=new Set;for(const E of h){const C=E.getBucket(s);C&&E.latestFeatureIndex&&s.fqid===C.layerIds[0]&&(this.updateBucketOpacities(C,w,E,E.collisionBoxArray,g,x,E.tileID,s.scope),C.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(C,E.tileID),C.elevationType==="road"&&C.updateRoadElevation(),C.updateZOffset())}}updateBucketOpacities(s,h,g,x,w,E,C,O){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const z=s.layers[0].layout,F=s.layers[0].paint,G=!!s.layers[0].dynamicFilter(),U=new Fu(null,0,!1,!1,!0),Z=z.get("text-allow-overlap"),te=z.get("icon-allow-overlap"),ee=z.get("text-variable-anchor"),oe=z.get("text-rotation-alignment")==="map",re=z.get("text-pitch-alignment")==="map",fe=F.get("symbol-z-offset"),_e=z.get("symbol-elevation-reference")==="sea",be=!fe.isConstant(),Pe=new Fu(null,0,Z&&(te||!s.hasIconData()||z.get("icon-optional")),te&&(Z||!s.hasTextData()||z.get("text-optional")),!0);!s.collisionArrays&&x&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(x);const Ee=(we,Me,ke)=>{for(let Qe=0;Qe<Me/4;Qe++)we.opacityVertexArray.emplaceBack(ke)};let Ae=0;E&&s.updateReplacement(C,E);for(let we=0;we<s.symbolInstances.length;we++){const Me=s.symbolInstances.get(we),{numHorizontalGlyphVertices:ke,numVerticalGlyphVertices:Qe,crossTileID:qe,numIconVertices:mt,tileAnchorX:dt,tileAnchorY:Ot}=Me;let Ze=null;const et=this.retainedQueryData[s.bucketInstanceId];be&&Me&&et&&(Ze=g.latestFeatureIndex.loadFeature({featureIndex:Me.featureIndex,bucketIndex:et.bucketIndex,sourceLayerIndex:et.sourceLayerIndex,layoutVertexArrayOffset:0}));const We=fe.evaluate(Ze,{}),vt=h.has(qe);let at=this.opacities[qe];vt?at=U:at||(at=Pe,this.opacities[qe]=at),h.add(qe);const Tt=ke>0||Qe>0,gt=mt>0,Et=this.placedOrientations[qe],At=Et===i.bI.vertical,Yt=Et===i.bI.horizontal||Et===i.bI.horizontalOnly;!Tt&&!gt||at.isHidden()||Ae++;let an=!1;if((Tt||gt)&&E)for(const Xt of s.activeReplacements){if(i.bP(Xt,w,i.bQ.Symbol,O)||Xt.min.x>dt||dt>Xt.max.x||Xt.min.y>Ot||Ot>Xt.max.y)continue;const ln=i.bR(dt,Ot,C.canonical,Xt.footprintTileId.canonical);if(an=i.bS(ln,Xt.footprint),an)break}if(Tt){const Xt=an?Hc:ed(at.text);Ee(s.text,ke,At?Hc:Xt),Ee(s.text,Qe,Yt?Hc:Xt);const ln=at.text.isHidden(),{leftJustifiedTextSymbolIndex:Qt,centerJustifiedTextSymbolIndex:Sn,rightJustifiedTextSymbolIndex:Rn,verticalPlacedTextSymbolIndex:tr}=Me,Nr=s.text.placedSymbolArray,kr=ln||At?1:0;Qt>=0&&(Nr.get(Qt).hidden=kr),Sn>=0&&(Nr.get(Sn).hidden=kr),Rn>=0&&(Nr.get(Rn).hidden=kr),tr>=0&&(Nr.get(tr).hidden=ln||Yt?1:0);const rr=this.variableOffsets[qe];rr&&this.markUsedJustification(s,rr.anchor,Me,Et);const Oi=this.placedOrientations[qe];Oi&&(this.markUsedJustification(s,"left",Me,Oi),this.markUsedOrientation(s,Oi,Me))}if(gt){const Xt=an?Hc:ed(at.icon),{placedIconSymbolIndex:ln,verticalPlacedIconSymbolIndex:Qt}=Me,Sn=s.icon.placedSymbolArray,Rn=at.icon.isHidden()?1:0;ln>=0&&(Ee(s.icon,mt,At?Hc:Xt),Sn.get(ln).hidden=Rn),Qt>=0&&(Ee(s.icon,Me.numVerticalIconVertices,Yt?Hc:Xt),Sn.get(Qt).hidden=Rn)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const Xt=s.collisionArrays[we];if(Xt){let ln=new i.P(0,0),Qt=!0;if(Xt.textBox||Xt.verticalTextBox){if(ee){const Rn=this.variableOffsets[qe];Rn?(ln=Ea(Rn.anchor,Rn.width,Rn.height,Rn.textOffset,Rn.textScale),oe&&ln._rotate(re?this.transform.angle:-this.transform.angle)):Qt=!1}G&&(Qt=!at.clipped),Xt.textBox&&Bu(s.textCollisionBox.collisionVertexArray,at.text.placed,!Qt||At,We,_e,ln.x,ln.y),Xt.verticalTextBox&&Bu(s.textCollisionBox.collisionVertexArray,at.text.placed,!Qt||Yt,We,_e,ln.x,ln.y)}const Sn=Qt&&!!(!Yt&&Xt.verticalIconBox);Xt.iconBox&&Bu(s.iconCollisionBox.collisionVertexArray,at.icon.placed,Sn,We,_e,Me.hasIconTextFit?ln.x:0,Me.hasIconTextFit?ln.y:0),Xt.verticalIconBox&&Bu(s.iconCollisionBox.collisionVertexArray,at.icon.placed,!Sn,We,_e,Me.hasIconTextFit?ln.x:0,Me.hasIconTextFit?ln.y:0)}}}if(s.fullyClipped=Ae===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const we=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=we.invProjMatrix,s.placementViewportMatrix=we.viewportMatrix,s.collisionCircleArray=we.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,h){const g=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*g>s}setStale(){this.stale=!0}}function Bu(m,s,h,g,x,w,E){m.emplaceBack(s?1:0,h?1:0,w||0,E||0,g,x?1:0),m.emplaceBack(s?1:0,h?1:0,w||0,E||0,g,x?1:0),m.emplaceBack(s?1:0,h?1:0,w||0,E||0,g,x?1:0),m.emplaceBack(s?1:0,h?1:0,w||0,E||0,g,x?1:0)}const lp=Math.pow(2,25),cp=Math.pow(2,24),ua=Math.pow(2,17),Qi=Math.pow(2,16),hI=Math.pow(2,9),up=Math.pow(2,8),e0=Math.pow(2,1);function ed(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const s=m.placed?1:0,h=Math.floor(127*m.opacity);return h*lp+s*cp+h*ua+s*Qi+h*hI+s*up+h*e0+s}const Hc=0;class pg{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,h,g,x,w,E){const C=this._bucketParts;for(;this._currentTileIndex<s.length;)if(h.getBucketParts(C,x,s[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort((O,z)=>O.sortKey-z.sortKey));this._currentPartIndex<C.length;){const O=C[this._currentPartIndex];if(h.placeLayerBucketPart(O,this._seenCrossTileIDs,g,O.symbolInstanceStart===0,E),this._currentPartIndex++,w())return!0}return!1}}class ha{constructor(s,h,g,x,w,E,C,O,z){this.placement=new Ir(s,w,E,C,O,z),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(s,h,g,x,w){const E=i.q.now(),C=()=>{const O=i.q.now()-E;return!this._forceFullPlacement&&O>2};for(;this._currentPlacementIndex>=0;){const O=h[s[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=z)&&(!O.maxzoom||O.maxzoom>z)){const F=O,G=F.layout.get("symbol-z-elevate"),U=F.layout.get("symbol-sort-key").constantOr(1)!==void 0,Z=F.layout.get("symbol-z-order"),te=Z==="viewport-y"||Z==="auto"&&!(Z!=="viewport-y"&&U),ee=F.layout.get("text-allow-overlap")||F.layout.get("icon-allow-overlap")||F.layout.get("text-ignore-placement")||F.layout.get("icon-ignore-placement"),oe=te&&ee,re=this._inProgressLayer=this._inProgressLayer||new pg(F),fe=i.C(O.source,O.scope);if(re.continuePlacement(G||oe?x[fe]:g[fe],this.placement,this._showCollisionBoxes,O,C,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Js=512/i.aj/2;class Aa{constructor(s,h,g){this.tileID=s,this.bucketInstanceId=g,this.index=new i.bW(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=s.canonical.x*i.aj,w=s.canonical.y*i.aj;for(let E=0;E<h.length;E++){const{key:C,crossTileID:O,tileAnchorX:z,tileAnchorY:F}=h.get(E),G=Math.floor((x+z)*Js),U=Math.floor((w+F)*Js);this.index.add(G,U),this.keys.push(C),this.crossTileIDs.push(O)}this.index.finish()}findMatches(s,h,g){const x=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),w=Js/Math.pow(2,h.canonical.z-this.tileID.canonical.z),E=h.canonical.x*i.aj,C=h.canonical.y*i.aj;for(let O=0;O<s.length;O++){const z=s.get(O);if(z.crossTileID)continue;const{key:F,tileAnchorX:G,tileAnchorY:U}=z,Z=Math.floor((E+G)*w),te=Math.floor((C+U)*w),ee=this.index.range(Z-x,te-x,Z+x,te+x).sort((oe,re)=>oe-re);for(const oe of ee){const re=this.crossTileIDs[oe];if(this.keys[oe]===F&&!g.has(re)){g.add(re),z.crossTileID=re;break}}}}}class Jw{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class td{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const h=Math.round((s-this.lng)/360);if(h!==0)for(const g in this.indexes){const x=this.indexes[g],w={};for(const E in x){const C=x[E];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+h),w[C.tileID.key]=C}this.indexes[g]=w}this.lng=s}addBucket(s,h,g){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let w=0;w<h.symbolInstances.length;w++)h.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const x=this.usedCrossTileIDs[s.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>s.overscaledZ)for(const C in E){const O=E[C];O.tileID.isChildOf(s)&&O.findMatches(h.symbolInstances,s,x)}else{const C=E[s.scaledTo(Number(w)).key];C&&C.findMatches(h.symbolInstances,s,x)}}for(let w=0;w<h.symbolInstances.length;w++){const E=h.symbolInstances.get(w);E.crossTileID||(E.crossTileID=g.generate(),x.add(E.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Aa(s,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(s,h){for(const g of h.crossTileIDs)this.usedCrossTileIDs[s].delete(g)}removeStaleBuckets(s){let h=!1;for(const g in this.indexes){const x=this.indexes[g];for(const w in x)s[x[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[w]),delete x[w],h=!0)}return h}}class mo{constructor(){this.layerIndexes={},this.crossTileIDs=new Jw,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,h,g,x){let w=this.layerIndexes[s.fqid];w===void 0&&(w=this.layerIndexes[s.fqid]=new td);let E=!1;const C={};x.name!=="globe"&&w.handleWrapJump(g);for(const O of h){const z=O.getBucket(s);z&&s.fqid===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(O.tileID,z,this.crossTileIDs)&&(E=!0),C[z.bucketInstanceId]=!0)}return w.removeStaleBuckets(C)&&(E=!0),E}pruneUnusedLayers(s){const h={};s.forEach(g=>{h[g]=!0});for(const g in this.layerIndexes)h[g]||delete this.layerIndexes[g]}}const da=771;class Zn{constructor(s,h,g,x){this.blendFunction=s,this.blendColor=h,this.mask=g,this.blendEquation=x}}Zn.Replace=[1,0,1,0],Zn.disabled=new Zn(Zn.Replace,i.am.transparent,[!1,!1,!1,!1]),Zn.unblended=new Zn(Zn.Replace,i.am.transparent,[!0,!0,!0,!0]),Zn.alphaBlended=new Zn([1,da,1,da],i.am.transparent,[!0,!0,!0,!0]),Zn.alphaBlendedNonPremultiplied=new Zn([770,da,770,da],i.am.transparent,[!0,!0,!0,!0]),Zn.multiply=new Zn([774,0,774,0],i.am.transparent,[!0,!0,!0,!0]);class Jt{constructor(s,h,g){this.func=s,this.mask=h,this.range=g}}Jt.ReadOnly=!1,Jt.ReadWrite=!0,Jt.disabled=new Jt(519,Jt.ReadOnly,[0,1]);const hp=7680;class In{constructor(s,h,g,x,w,E){this.test=s,this.ref=h,this.mask=g,this.fail=x,this.depthFail=w,this.pass=E}}In.disabled=new In({func:519,mask:0},0,0,hp,hp,hp);const ju=1029,nd=2305;class Mn{constructor(s,h,g){this.enable=s,this.mode=h,this.frontFace=g}}function Qw(m,s){const h=i.c1(m,3);i.c3(m,s),i.c7(m,3,h)}function Qs(m,s){const h=i.bY([]);return i.bZ(h,h,-s),i.b_(h,h,-m),h}function eS(m,s){const h=[m[0],m[1],0],g=[s[0],s[1],0];if(i.ae(h)>=1e-15){const E=i.au([],h);i.b$(g,E,i.bE(g,E)),s[0]=g[0],s[1]=g[1]}const x=i.bG([],s,m);if(i.c0(x)<1e-15)return null;const w=Math.atan2(-x[1],x[0]);return Qs(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),w)}Mn.disabled=new Mn(!1,ju,nd),Mn.backCCW=new Mn(!0,ju,nd),Mn.backCW=new Mn(!0,ju,2304),Mn.frontCW=new Mn(!0,1028,2304),Mn.frontCCW=new Mn(!0,1028,nd);class mg{constructor(s,h){this.position=s,this.orientation=h}get position(){return this._position}set position(s){if(s){const h=s instanceof i.ac?s:new i.ac(s[0],s[1],s[2]);this._renderWorldCopies&&(h.x=i.bX(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(s,h){if(this.orientation=null,!this.position)return;const g=this.position,x=this._elevation?this._elevation.getAtPointOrZero(i.ac.fromLngLat(s)):0,w=i.ac.fromLngLat(s,x),E=[w.x-g.x,w.y-g.y,w.z-g.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=eS(E,h)}setPitchBearing(s,h){this.orientation=Qs(i.al(s),i.al(-h))}}class ea{constructor(s,h){this._transform=i.bx([]),this.orientation=h,this.position=s}get mercatorPosition(){const s=this.position;return new i.ac(s[0],s[1],s[2])}get position(){const s=i.c1(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var h;s&&i.c7(this._transform,3,[(h=s)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||i.bY([]),s&&Qw(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,h){this._orientation=Qs(s,h),Qw(this._transform,this._orientation)}forward(){const s=i.c1(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=i.c1(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=i.c1(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,h){const g=new Float64Array(16);return i.bi(g,this.getWorldToCamera(s,h)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,h,g){const x=this.position;i.b$(x,x,-s);const w=new Float64Array(16);return i.bn(w,[g,g,g]),i.bo(w,w,x),w[10]*=h,w}getWorldToCamera(s,h){const g=new Float64Array(16),x=new Float64Array(4),w=this.position;return i.c2(x,this._orientation),i.b$(w,w,-s),i.c3(g,x),i.bo(g,g,w),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=h,g[9]*=h,g[10]*=h,g[11]*=h,g}getCameraToClipPerspective(s,h,g,x){const w=new Float64Array(16);return i.c4(w,s,h,g,x),w}getCameraToClipOrthographic(s,h,g,x,w,E){const C=new Float64Array(16);return i.c5(C,s,h,g,x,w,E),C}getDistanceToElevation(s,h=!1){const g=s===0?0:i.c6(s,h?i.aY(this.position[1]):this.position[1]),x=this.forward();return(g-this.position[2])/x[2]}clone(){return new ea([...this.position],[...this.orientation])}}const fa={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class rd{constructor(s=0,h=0,g=0,x=0){if(isNaN(s)||s<0||isNaN(h)||h<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=h,this.left=g,this.right=x}interpolate(s,h,g){return h.top!=null&&s.top!=null&&(this.top=i.ai(s.top,h.top,g)),h.bottom!=null&&s.bottom!=null&&(this.bottom=i.ai(s.bottom,h.bottom,g)),h.left!=null&&s.left!=null&&(this.left=i.ai(s.left,h.left,g)),h.right!=null&&s.right!=null&&(this.right=i.ai(s.right,h.right,g)),this}getCenter(s,h){const g=i.aD((this.left+s-this.right)/2,0,s),x=i.aD((this.top+h-this.bottom)/2,0,h);return new i.P(g,x)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new rd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const qc=15;class $u{constructor(s,h,g,x,w,E,C){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=s||0,this._maxZoom=h||22,this._minPitch=g??0,this._maxPitch=x??60,this.setProjection(E),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new i.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new rd,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ea,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const s=new $u(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s._allowWorldUnderZoom=this._allowWorldUnderZoom,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<qc}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,h=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(s||g)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return i.aF(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=i.ce(this.projectionOptions);const g=this.getProjection(),x=!i.bv(h,g);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.ce({name:"mercator"});const h=s!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bX(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const h=-s*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=i.cf(),i.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const h=i.aD(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=i.al(s),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const h=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,h=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!h||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;h||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let x=0,w=0;for(let E=0;E<h.length;E++){const C=new i.P(h[E][0]*this.width,g+h[E][1]*(this.height-g)),O=s.pointCoordinate(C);if(!O)continue;const z=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);x+=O[3]*z,w+=z}return w===0?NaN:x/w}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*h,x=this._mercatorZfromZoom(s),w=this._mercatorZfromZoom(this._maxZoom),E=Math.max(x-g,w);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let g;g=s.z<this._camera.position[2]?[h.x,h.y,h.z]:[s.x,s.y,s.z];const x=i.ae(i.at([],this._camera.position,g));return i.aD(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let h=!1;if(s.orientation&&!i.ch(s.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(s.orientation)),s.position){const g=[s.position.x,s.position.y,s.position.z];i.ci(g,this._camera.position)||(this._setCameraPosition(g),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,h=new mg;return h.position=new i.ac(s[0],s[1],s[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(s){if(!i.cj(s))return!1;i.ck(s,s);const h=i.cl([],[0,0,-1],s),g=i.cl([],[0,-1,0],s);if(g[2]<0)return!1;const x=eS(h,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(s){const h=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;s[2]=i.aD(s[2],x/g,x/h),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,h,g){this._unmodified=!1,this._edgeInsets.interpolate(s,h,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const h=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(s){const h=[new i.cm(0,s)];if(this.renderWorldCopies){const g=this.pointCoordinate(new i.P(0,0)),x=this.pointCoordinate(new i.P(this.width,0)),w=this.pointCoordinate(new i.P(this.width,this.height)),E=this.pointCoordinate(new i.P(0,this.height)),C=Math.floor(Math.min(g.x,x.x,w.x,E.x)),O=Math.floor(Math.max(g.x,x.x,w.x,E.x)),z=1;for(let F=C-z;F<=O+z;F++)F!==0&&h.push(new i.cm(F,s))}return h}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,h,g){let x=[];const w=g!=null,E=!w;if(E&&this.zoom<h||w&&g[0]===0&&g[1]===0)return x;const C=new Set,O=(F,G,U,Z,te)=>{const ee=i.cK(G,F,U,Z,te);C.has(ee)||(x.push(new i.aM(F,G,U,Z,te)),C.add(ee))};for(let F=0;F<s.length;F++){const G=s[F];if(E&&G.canonical.z!==h)continue;const U=G.canonical,Z=G.overscaledZ,te=G.wrap,ee=1<<U.z,oe=U.x+1<ee,re=U.x>0,fe=U.y+1<ee,_e=U.y>0,be=G.wrap-(re?0:1),Pe=G.wrap+(oe?0:1),Ee=re?U.x-1:ee-1,Ae=oe?U.x+1:0;if(w)g[0]<0?(O(Z,Pe,U.z,Ae,U.y),g[1]<0&&fe&&(O(Z,te,U.z,U.x,U.y+1),O(Z,Pe,U.z,Ae,U.y+1)),g[1]>0&&_e&&(O(Z,te,U.z,U.x,U.y-1),O(Z,Pe,U.z,Ae,U.y-1))):g[0]>0?(O(Z,be,U.z,Ee,U.y),g[1]<0&&fe&&(O(Z,te,U.z,U.x,U.y+1),O(Z,be,U.z,Ee,U.y+1)),g[1]>0&&_e&&(O(Z,te,U.z,U.x,U.y-1),O(Z,be,U.z,Ee,U.y-1))):g[1]<0&&fe?O(Z,te,U.z,U.x,U.y+1):_e&&O(Z,te,U.z,U.x,U.y-1);else{const we=G.visibleQuadrants;1&we&&(O(Z,be,U.z,Ee,U.y),_e&&(O(Z,te,U.z,U.x,U.y-1),O(Z,be,U.z,Ee,U.y-1))),2&we&&(O(Z,Pe,U.z,Ae,U.y),_e&&(O(Z,te,U.z,U.x,U.y-1),O(Z,Pe,U.z,Ae,U.y-1))),4&we&&(O(Z,be,U.z,Ee,U.y),fe&&(O(Z,te,U.z,U.x,U.y+1),O(Z,be,U.z,Ee,U.y+1))),8&we&&(O(Z,Pe,U.z,Ae,U.y),fe&&(O(Z,te,U.z,U.x,U.y+1),O(Z,Pe,U.z,Ae,U.y+1)))}}const z=[];for(const F of x)x.some(G=>F.isChildOf(G))||z.push(F);if(x=z.filter(F=>!s.some(G=>!!(F.overscaledZ<h&&G.isChildOf(F))||F.equals(G)||F.isChildOf(G))),E){const F=1<<h,G=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),U=[F*G.x,F*G.y],Z=4,te=Z*Z;x=x.filter(ee=>{const oe=ee.canonical.x+.5-U[0],re=ee.canonical.y+.5-U[1];return oe*oe+re*re<te})}return x}coveringTiles(s){let h=this.coveringZoomLevel(s);const g=h,x=this.elevation&&this.elevation.exaggeration(),w=x&&!s.isTerrainDEM,E=this.projection.name==="mercator";if(s.minzoom!==void 0&&h<s.minzoom)return[];s.maxzoom!==void 0&&h>s.maxzoom&&(h=s.maxzoom);const C=this.locationCoordinate(this.center),O=this.center.lat,z=1<<h,F=[z*C.x,z*C.y,0],G=this.projection.name==="globe",U=!G,Z=i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,U),te=G?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ee=z*i.c6(1,this.center.lat),oe=this._camera.position[2]/i.c6(1,this.center.lat),re=[z*te.x,z*te.y,oe*(U?1:ee)],fe=G||x,_e=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),be=this.isLODDisabled(!0)?h:0;let Pe;if(this._elevation&&s.isTerrainDEM)Pe=1e4*this._elevation.exaggeration();else if(this._elevation){const We=this._elevation.getMinMaxForVisibleTiles();Pe=We?We.max:this._centerAltitude}else Pe=this._centerAltitude;const Ee=s.isTerrainDEM?-Pe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ae=this.projection.isReprojectedInTileSpace?i.co(this):1,we=We=>{const at=new i.ac(We.x+25e-6,We.y,We.z),Tt=new i.ac(We.x,We.y+25e-6,We.z),gt=We.toLngLat(),Et=at.toLngLat(),At=Tt.toLngLat(),Yt=this.locationCoordinate(gt),an=this.locationCoordinate(Et),Xt=this.locationCoordinate(At),ln=Math.hypot(an.x-Yt.x,an.y-Yt.y),Qt=Math.hypot(Xt.x-Yt.x,Xt.y-Yt.y);return Math.sqrt(ln*Qt)*Ae/25e-6},Me=We=>{const vt=Pe,at=Ee;return{aabb:i.cr(this,z,0,0,0,We,at,vt,this.projection),zoom:0,x:0,y:0,minZ:at,maxZ:vt,wrap:We,fullyVisible:!1}},ke=[];let Qe=[];const qe=h,mt=s.reparseOverscaled?g:h,dt=(oe-this._centerAltitude)*ee,Ot=We=>{if(!this._elevation||!We.tileID||!E)return;const vt=this._elevation.getMinMaxForTile(We.tileID),at=We.aabb;vt?(at.min[2]=vt.min,at.max[2]=vt.max,at.center[2]=(at.min[2]+at.max[2])/2):(We.shouldSplit=et(We),We.shouldSplit||(at.min[2]=at.max[2]=at.center[2]=this._centerAltitude))},Ze=(We,vt)=>{if(.707*vt<We)return 1;const at=vt/We;return at/(1.4144271570014144+(Math.pow(1.1,at-1.4144271570014144+1)-1)/(1.1-1)-1)},et=We=>{if(We.zoom<be)return!0;if(We.zoom===qe)return!1;if(We.shouldSplit!=null)return We.shouldSplit;const vt=We.aabb.distanceX(re),at=We.aabb.distanceY(re);let Tt=dt,gt=1;if(G){Tt=We.aabb.distanceZ(re);const Qt=Math.pow(2,We.zoom),Sn=i.aY((We.y+1)/Qt),Rn=i.aY(We.y/Qt),tr=Math.min(Math.max(O,Sn),Rn),Nr=i.cP(tr)/i.cP(O);if(gt=tr===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Nr/this._mercatorScaleRatio),this.zoom<=i.cL&&We.zoom===qe-1&&Nr>=.9)return!0}else if(w&&(Tt=We.aabb.distanceZ(re)*ee),this.projection.isReprojectedInTileSpace&&g<=5){const Qt=Math.pow(2,We.zoom),Sn=we(new i.ac((We.x+.5)/Qt,(We.y+.5)/Qt));gt=Sn>.85?1:Sn}if(!E){const Qt=Math.sqrt(vt*vt+at*at+Tt*Tt);let Sn=(1<<qe-We.zoom)*_e*gt;return Sn*=Ze(Math.max(Tt,dt),Qt),Qt<Sn}let Et=Number.MAX_VALUE,At=0;const Yt=We.aabb.getCorners(),an=[];for(const Qt of Yt){i.at(an,Qt,re),G||(w?an[2]*=ee:an[2]=dt);const Sn=i.bE(an,this._camera.forward());Sn<Et&&(Et=Sn,At=Math.abs(an[2]))}let Xt=(1<<qe-We.zoom)*_e*gt;if(Xt*=Ze(Math.max(At,dt),Et),Et<Xt)return!0;const ln=We.aabb.closestPoint(F);return ln[0]===F[0]&&ln[1]===F[1]};if(this.renderWorldCopies)for(let We=1;We<=3;We++)ke.push(Me(-We)),ke.push(Me(We));for(ke.push(Me(0));ke.length>0;){const We=ke.pop(),vt=We.x,at=We.y;let Tt=We.fullyVisible;const gt=()=>this.projection.name==="globe"&&(We.y===0||We.y===(1<<We.zoom)-1);if(!Tt){let Et=fe?We.aabb.intersects(Z):We.aabb.intersectsFlat(Z);if(Et===0&&gt()){const At=new i.cp(We.zoom,vt,at);Et=i.cq(this,z,At,!0).intersects(Z)}if(Et===0)continue;Tt=Et===2}if(We.zoom!==qe&&et(We))for(let Et=0;Et<4;Et++){const At=(vt<<1)+Et%2,Yt=(at<<1)+(Et>>1),an={aabb:E?We.aabb.quadrant(Et):i.cr(this,z,We.zoom+1,At,Yt,We.wrap,We.minZ,We.maxZ,this.projection),zoom:We.zoom+1,x:At,y:Yt,wrap:We.wrap,fullyVisible:Tt,tileID:void 0,shouldSplit:void 0,minZ:We.minZ,maxZ:We.maxZ};w&&!G&&(an.tileID=new i.aM(We.zoom+1===qe?mt:We.zoom+1,We.wrap,We.zoom+1,At,Yt),Ot(an)),ke.push(an)}else{const Et=We.zoom===qe?mt:We.zoom;if(s.minzoom&&s.minzoom>Et)continue;let At=0;if(!Tt){let ln=fe?We.aabb.intersectsPrecise(Z):We.aabb.intersectsPreciseFlat(Z);if(ln===0&&gt()){const Qt=new i.cp(We.zoom,vt,at);ln=i.cq(this,z,Qt,!0).intersectsPrecise(Z)}if(ln===0)continue;if(s.calculateQuadrantVisibility)if(Z.containsPoint(We.aabb.center))At=15;else for(let Qt=0;Qt<4;Qt++)We.aabb.quadrant(Qt).intersects(Z)!==0&&(At|=1<<Qt)}const Yt=F[0]-(.5+vt+(We.wrap<<We.zoom))*(1<<h-We.zoom),an=F[1]-.5-at,Xt=We.tileID?We.tileID:new i.aM(Et,We.wrap,We.zoom,vt,at);s.calculateQuadrantVisibility&&(Xt.visibleQuadrants=At),Qe.push({tileID:Xt,distanceSq:Yt*Yt+an*an})}}if(this.fogCullDistSq){const We=this.fogCullDistSq,vt=this.horizonLineFromTop();Qe=Qe.filter(at=>{const Tt=[0,0,0,1],gt=[i.aj,i.aj,0,1],Et=this.calculateFogTileMatrix(at.tileID.toUnwrapped());i.aA(Tt,Tt,Et),i.aA(gt,gt,Et);const At=i.cs([],Tt,gt),Yt=i.ct([],Tt,gt),an=i.cM(At,Yt);if(an===0)return!0;let Xt=!1;const ln=this._elevation;if(ln&&an>We&&vt!==0){const Qt=this.calculateProjMatrix(at.tileID.toUnwrapped());let Sn;s.isTerrainDEM||(Sn=ln.getMinMaxForTile(at.tileID)),Sn||(Sn={min:Ee,max:Pe});const Rn=i.cu(this.rotation),tr=[Rn[0]*i.aj,Rn[1]*i.aj,Sn.max];i.ad(tr,tr,Qt),Xt=(1-tr[1])*this.height*.5<vt}return an<We||Xt})}return Qe.sort((We,vt)=>We.distanceSq-vt.distanceSq).map(We=>We.tileID)}resize(s,h){this.width=s,this.height=h,this.pixelsToGLUnits=[2/s,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const h=i.aD(s.lat,-i.cv,i.cv),g=this.projection.project(s.lng,h);return new i.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,h){let g,x;const w=this.centerPoint;if(this.projection.name==="globe"){const C=this.worldSize;g=(h.x-w.x)/C,x=(h.y-w.y)/C}else{const C=this.pointCoordinate(h),O=this.pointCoordinate(w);g=C.x-O.x,x=C.y-O.y}const E=this.locationCoordinate(s);this.setLocation(new i.ac(E.x-g,E.y-x))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s,h){return this.projection.locationPoint(this,s,h)}locationPoint3D(s,h){return this.projection.locationPoint(this,s,h,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s,h){return this.coordinateLocation(this.pointCoordinate3D(s,h))}locationCoordinate(s,h){const g=h?i.c6(h,s.lat):void 0,x=this.projection.project(s.lng,s.lat);return new i.ac(x.x,x.y,g)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,h){const g=h??this._centerAltitude,x=[s.x,s.y,0,1],w=[s.x,s.y,1,1];i.aA(x,x,this.pixelMatrixInverse),i.aA(w,w,this.pixelMatrixInverse);const E=w[3];i.cw(x,x,1/x[3]),i.cw(w,w,1/E);const C=x[2],O=w[2];return{p0:x,p1:w,t:C===O?0:(g-C)/(O-C)}}screenPointToMercatorRay(s){const h=[s.x,s.y,0,1],g=[s.x,s.y,1,1];return i.aA(h,h,this.pixelMatrixInverse),i.aA(g,g,this.pixelMatrixInverse),i.cw(h,h,1/h[3]),i.cw(g,g,1/g[3]),h[2]=i.c6(h[2],this._center.lat)*this.worldSize,g[2]=i.c6(g[2],this._center.lat)*this.worldSize,i.cw(h,h,1/this.worldSize),i.cw(g,g,1/this.worldSize),new i.av([h[0],h[1],h[2]],i.au([],i.at([],g,h)))}rayIntersectionCoordinate(s){const{p0:h,p1:g,t:x}=s,w=i.c6(h[2],this._center.lat),E=i.c6(g[2],this._center.lat);return new i.ac(i.ai(h[0],g[0],x)/this.worldSize,i.ai(h[1],g[1],x)/this.worldSize,i.ai(w,E,x))}pointCoordinate(s,h=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,h)}pointCoordinate3D(s,h){if(!this.elevation)return this.pointCoordinate(s,h);let g=this.projection.pointCoordinate3D(this,s.x,s.y);if(g)return new i.ac(g[0],g[1],g[2]);let x=0,w=this.horizonLineFromTop();if(s.y>w)return this.pointCoordinate(s,h);const E=.02*w,C=s.clone();for(let O=0;O<10&&w-x>E;O++){C.y=i.ai(x,w,.66);const z=this.projection.pointCoordinate3D(this,C.x,C.y);z?(w=C.y,g=z):x=C.y}return g?new i.ac(g[0],g[1],g[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=i.cx)return!this.isPointAboveHorizon(s);const h=this.pointCoordinate(s);return h.y>=0&&h.y<=1}_coordinatePoint(s,h){const g=h&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,x=[s.x*this.worldSize,s.y*this.worldSize,g+s.toAltitude(),1];return i.aA(x,x,this.pixelMatrix),x[3]>0?new i.P(x[0]/x[3],x[1]/x[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:h}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,w=this.pointLocation3D(new i.P(h,s)),E=this.pointLocation3D(new i.P(x,s)),C=this.pointLocation3D(new i.P(x,g)),O=this.pointLocation3D(new i.P(h,g));let z=Math.min(w.lng,E.lng,C.lng,O.lng),F=Math.max(w.lng,E.lng,C.lng,O.lng),G=Math.min(w.lat,E.lat,C.lat,O.lat),U=Math.max(w.lat,E.lat,C.lat,O.lat);const Z=Math.pow(2,-this.zoom)/16*270,te=this.projection.name==="globe"?1:4,ee=(oe,re,fe,_e,be)=>{const Pe=(oe+fe)/2,Ee=(re+_e)/2,Ae=new i.P(Pe,Ee),{lng:we,lat:Me}=this.pointLocation3D(Ae),ke=Math.max(0,z-we,G-Me,we-F,Me-U);z=Math.min(z,we),F=Math.max(F,we),G=Math.min(G,Me),U=Math.max(U,Me),(be<te||ke>Z)&&(ee(oe,re,Pe,Ee,be+1),ee(Pe,Ee,fe,_e,be+1))};if(ee(h,s,x,s,1),ee(x,s,x,g,1),ee(x,g,h,g,1),ee(h,g,h,s,1),this.projection.name==="globe"){const[oe,re]=i.cy(this);oe?(U=90,F=180,z=-180):re&&(G=-90,F=180,z=-180)}return new i.aG(new i.cd(z,G),new i.cd(F,U))}_getBoundsRectangular(s,h){const{top:g,left:x}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,C=new i.P(x,g),O=new i.P(E,g),z=new i.P(E,w),F=new i.P(x,w);let G=this.pointCoordinate(C,s),U=this.pointCoordinate(O,s);const Z=this.pointCoordinate(z,h),te=this.pointCoordinate(F,h),ee=(oe,re)=>(re.y-oe.y)/(re.x-oe.x);return G.y>1&&U.y>=0?G=new i.ac((1-te.y)/ee(te,G)+te.x,1):G.y<0&&U.y<=1&&(G=new i.ac(-te.y/ee(te,G)+te.x,0)),U.y>1&&G.y>=0?U=new i.ac((1-Z.y)/ee(Z,U)+Z.x,1):U.y<0&&G.y<=1&&(U=new i.ac(-Z.y/ee(Z,U)+Z.x,0)),new i.aG().extend(this.coordinateLocation(G)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(te)).extend(this.coordinateLocation(Z))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=s.visibleDemTiles.reduce((g,x)=>{if(x.dem){const w=x.dem.tree;g.min=Math.min(g.min,w.minimums[0]),g.max=Math.max(g.max,w.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*s.exaggeration(),h.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-h*(1-this._horizonShift);return s?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-i.cv,this.maxLat=i.cv,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.ay(this.minLng)*this.tileSize,this.worldMaxX=i.ay(this.maxLng)*this.tileSize,this.worldMinY=i.aH(this.maxLat)*this.tileSize,this.worldMaxY=i.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,h){return this.projection.createTileMatrix(this,h,s)}calculateDistanceTileData(s){const h=s.key,g=this._distanceTileDataCache;if(g[h])return g[h];const x=s.canonical,w=1/this.height,E=this.cameraWorldSize,C=E/this.zoomScale(x.z),O=(x.x+Math.pow(2,x.z)*s.wrap)*C,z=x.y*C,F=this.point;F.x*=E/this.worldSize,F.y*=E/this.worldSize;const G=this.angle,U=Math.sin(-G),Z=-Math.cos(-G);return g[h]={bearing:[U,Z],center:[(F.x-O)*w,(F.y-z)*w],scale:C/i.aj*w},g[h]}calculateFogTileMatrix(s){const h=s.key,g=this._fogTileMatrixCache;if(g[h])return g[h];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return i.az(x,this.worldToFogMatrix,x),g[h]=new Float32Array(x),g[h]}calculateProjMatrix(s,h=!1,g=!1){const x=s.key;let w;if(w=g?this._expandedProjMatrixCache:h?this._alignedProjMatrixCache:this._projMatrixCache,w[x])return w[x];const E=this.calculatePosMatrix(s,this.worldSize);let C;return C=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:h?this.alignedProjMatrix:this.projMatrix,i.az(E,C,E),w[x]=new Float32Array(E),w[x]}calculatePixelsToTileUnitsMatrix(s){const h=s.tileID.key,g=this._pixelsToTileUnitsCache;if(g[h])return g[h];const x=i.cz(s,this);return g[h]=x,g[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,h=i.bn([],[s,s,s]);return i.az(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const h=i.c6(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(h),x=this._camera.forward(),w=i.c6(1,this._center.lat);g[2]/=w,x[2]/=w,i.au(x,x);const E=s.raycast(g,x,s.exaggeration());if(E){const C=i.bF([],g,x,E),O=new i.ac(C[0],C[1],i.c6(C[2],i.aY(C[1]))),z=(O.z+i.ae([O.x-g[0],O.y-g[1],O.z-g[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=O.toAltitude(),this._center=this.coordinateLocation(O),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const h=this._elevation,g=i.c6(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(g),w=h.getAtPointOrZero(new i.ac(...x)),E=this.pixelsPerMeter/this.worldSize*w,C=this._minimumHeightOverTerrain(),O=x[2]-E;if(O<=C)if(O<0||s){const z=this.locationCoordinate(this._center,this._centerAltitude),F=[x[0],x[1],z.z-x[2]],G=i.ae(F);F[2]-=(C-O)/this._pixelsPerMercatorPixel;const U=i.ae(F);if(U===0)return;i.b$(F,F,G/U*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],z.z*this._pixelsPerMercatorPixel-F[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const U=this.center;return U.lat=i.aD(U.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(U.lng=i.aD(U.lng,this.minLng,this.maxLng)),this.center=U,void(this._constraining=!1)}const h=this._unmodified,{x:g,y:x}=this.point;let w=0,E=g,C=x;const O=this.width/2,z=this.height/2,F=this.worldMinY*this.scale,G=this.worldMaxY*this.scale;if(x-z<F&&(C=F+z),x+z>G&&(C=G-z),G-F<this.height&&(w=Math.max(w,this.height/(G-F)),C=(G+F)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const U=this.worldMinX*this.scale,Z=this.worldMaxX*this.scale,te=this.worldSize/2-(U+Z)/2;E=(g+te+this.worldSize)%this.worldSize-te,E-O<U&&(E=U+O),E+O>Z&&(E=Z-O),Z-U<this.width&&(w=Math.max(w,this.width/(Z-U)),E=(Z+U)/2)}E===g&&C===x||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(E,C))),w&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,h=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.c6(1,this.center.lat)/i.c6(1,i.cN));const x=i.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?g:1,E=this._camera.getWorldToCamera(this.worldSize,w);let C;const O=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(O[8]=2*-s.x/this.width,O[9]=2*s.y/this.height,this.isOrthographic){let Me=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ke=Me*this.aspect,Qe=-ke,qe=-Me;ke-=s.x,Qe-=s.x,Me+=s.y,qe+=s.y,C=this._camera.getCameraToClipOrthographic(Qe,ke,qe,Me,this._nearZ,this._farZ),((mt,dt,Ot,Ze)=>{for(let et=0;et<16;et++)mt[et]=i.ai(dt[et],Ot[et],Ze)})(C,C,O,i.cO(this.pitch>=qc?1:this.pitch/qc))}else C=O;const z=i.cB([],O,E);let F=i.cB([],C,E);if(this.projection.isReprojectedInTileSpace){const Me=this.locationCoordinate(this.center),ke=i.bx([]);i.bo(ke,ke,[Me.x*this.worldSize,Me.y*this.worldSize,0]),i.az(ke,ke,i.cC(this)),i.bo(ke,ke,[-Me.x*this.worldSize,-Me.y*this.worldSize,0]),i.az(F,F,ke),i.az(z,z,ke),this.inverseAdjustmentMatrix=i.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.cE([],F,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=F,this.invProjMatrix=i.bi(new Float64Array(16),this.projMatrix),h){const Me=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Me[8]=2*-s.x/this.width,Me[9]=2*s.y/this.height,this.expandedFarZProjMatrix=i.cB([],Me,E)}else this.expandedFarZProjMatrix=this.projMatrix;const G=i.bi([],C);this.frustumCorners=i.cF.fromInvProjectionMatrix(G,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!h);const U=new Float32Array(16);i.bx(U),i.cE(U,U,[1,-1,1]),i.cG(U,U,this._pitch),i.by(U,U,this.angle);const Z=i.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.bw(Z);const te=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Z[8]=2*-s.x/this.width,Z[9]=2*(s.y+te)/this.height,this.skyboxMatrix=i.az(U,Z,U);const ee=this.point,oe=ee.x,re=ee.y,fe=this.width%2/2,_e=this.height%2/2,be=Math.cos(this.angle),Pe=Math.sin(this.angle),Ee=oe-Math.round(oe)+be*fe+Pe*_e,Ae=re-Math.round(re)+be*_e+Pe*fe,we=new Float64Array(F);if(i.bo(we,we,[Ee>.5?Ee-1:Ee,Ae>.5?Ae-1:Ae,0]),this.alignedProjMatrix=we,F=i.bz(),i.cE(F,F,[this.width/2,-this.height/2,1]),i.bo(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=i.bz(),i.cE(F,F,[1,-1,1]),i.bo(F,F,[-1,-1,0]),i.cE(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=i.az(new Float64Array(16),this.labelPlaneMatrix,z),this._calcFogMatrices(),this._distanceTileDataCache={},F=i.bi(new Float64Array(16),this.pixelMatrix),!F)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=F,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.cH(this);const Me=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ad(Me,Me,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=F;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,w=[s,s,h];i.b$(w,w,x),i.b$(g,g,-1),i.cI(g,g,w);const E=i.bz();i.bo(E,E,g),i.cE(E,E,w),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,h,x)}_computeCameraPosition(s){const h=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-s/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*w,x.y/this.worldSize-g[1]*w,s/this.worldSize*this._centerAltitude-g[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],x=s[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(w=Math.min((h-g)/x,1)),this._camera.position=i.bF([],this._camera.position,s,w),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,h=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),w=i.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.al(this._maxPitch)),C=Math.max((s[2]-w)/Math.cos(g),E),O=this._zoomFromMercatorZ(C);i.bF(s,s,h,C),this._pitch=i.aD(g,i.al(this.minPitch),i.al(this.maxPitch)),this.angle=i.bX(x,-Math.PI,Math.PI),this._setZoom(i.aD(O,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ac(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let h=0,g=i.cx,x=0,w=1/0;for(;g-h>1e-6&&g>h;){const E=h+.5*(g-h),C=this.tileSize*Math.pow(2,E),O=this.getCameraToCenterDistance(this.projection,E,C),z=this.scaleZoom(O/(s*this.tileSize)),F=Math.abs(E-z);F<w&&(w=F,x=E),E<z?h=E:g=E}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,h){const g=Math.min(s.x,h.x),x=Math.max(s.x,h.x),w=Math.min(s.y,h.y),E=Math.max(s.y,h.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const C=[new i.P(g,w),new i.P(x,E),new i.P(g,E),new i.P(x,w)],O=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const F of C){const G=this.pointRayIntersection(F);if(G.t<0)return!0;const U=this.rayIntersectionCoordinate(G);if(U.x<O||U.y<0||U.x>z||U.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(s,h){const g=i.ae(i.at([],this._camera.position,s)),x=this._zoomFromMercatorZ(g)+h;return g-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([h,g,x],w){const E=[h,g,x,1];i.aA(E,E,w);const C=E[3]=Math.max(E[3],1e-6);return E[0]/=C,E[1]/=C,E[2]/=C,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,s))}}getCameraToCenterDistance(s,h=this.zoom,g=this.worldSize){const x=i.cA(s,h,this.width,this.height,1024),w=s.pixelSpaceConversion(this.center.lat,g,x);let E=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(E=i.ai(1,E,i.cO(this.pitch>=qc?1:this.pitch/qc))),E}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.az(s,s,this.globeMatrix),s}getFrustum(s){return i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}const Uu=(m,s)=>{if(s>0&&m.terrain&&i.w("Cutoff is currently disabled on terrain"),s<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const h=m.transform,g=Math.max(Math.abs(h._zoom-(m.minCutoffZoom-1)),1),x=h.isLODDisabled(!1)?i.af(60,45,h.pitch):i.af(30,15,h.pitch),w=h._farZ-h._nearZ,E=s*h.height,C=((1-(O=x))*h.cameraToCenterDistance+O*(h._farZ+E))*g;var O;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[h._nearZ,h._farZ,(C-h._nearZ)/w,(C-E-h._nearZ)/w]}}},pa={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class dp{constructor(s,h){this.aabb=s,this.lastCascade=h}}class fp{add(s,h){const g=this.receivers[s.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],h.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],h.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],h.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],h.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],h.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],h.max[2])):this.receivers[s.key]=new dp(h,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,h,g){const x=i.cV.fromPoints(s.points);let w=0;for(const E in this.receivers){const C=this.receivers[E];if(!C||!x.intersectsAabb(C.aabb))continue;C.aabb.min=x.closestPoint(C.aabb.min),C.aabb.max=x.closestPoint(C.aabb.max);const O=C.aabb.getCorners();for(let z=0;z<g.length;z++){let F=!0;for(const G of O){const U=[G[0]*h,G[1]*h,G[2]];if(i.ad(U,U,g[z].matrix),U[0]<-1||U[0]>1||U[1]<-1||U[1]>1){F=!1;break}}if(C.lastCascade=z,w=Math.max(w,z),F)break}}return w+1}}class dI{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new fp,this._depthMode=new Jt(s.context.gl.LEQUAL,Jt.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(pa,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(pa,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(pa,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,h){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!h||!h.properties)return;const x=h.properties.get("shadow-intensity");if(!h.shadowsEnabled()||x<=0||(this._shadowLayerCount=g.style.order.reduce((te,ee)=>{const oe=g.style._mergedLayers[ee];return te+(oe.hasShadowPass()&&!oe.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=g.context,E=pa.shadowMapResolution,C=pa.shadowMapResolution;if(this._cascades.length===0||pa.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let te=0;te<pa.cascadeCount;++te){const ee=g._shadowMapDebug,oe=w.gl,re=w.createFramebuffer(E,C,ee,"texture"),fe=new i.T(w,{width:E,height:C,data:null},oe.DEPTH_COMPONENT16);if(re.depthAttachment.set(fe.texture),ee){const _e=new i.T(w,{width:E,height:C,data:null},oe.RGBA8);re.colorAttachment.set(_e.texture)}this._cascades.push({framebuffer:re,texture:fe,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.cn,scale:0})}}this.shadowDirection=t0(h);let O=0;if(s.elevation){const te=s.elevation,ee=[1e4,-1e4];te.visibleDemTiles.filter(oe=>oe.dem).forEach(oe=>{const re=oe.dem.tree;ee[0]=Math.min(ee[0],re.minimums[0]),ee[1]=Math.max(ee[1],re.maximums[0])}),ee[0]!==1e4&&(O=(ee[1]-ee[0])*te.exaggeration())}const z=1.5*s.cameraToCenterDistance,F=3*z,G=new Float64Array(16);for(let te=0;te<this._cascades.length;++te){const ee=this._cascades[te];let oe=s.height/50,re=1;pa.cascadeCount===1?re=F:te===0?re=z:(oe=z,re=F);const[fe,_e]=n0(s,this.shadowDirection,oe,re,pa.shadowMapResolution,O);ee.scale=s.scale,ee.matrix=fe,ee.boundingSphereRadius=_e,i.bi(G,ee.matrix),ee.frustum=i.cn.fromInvProjectionMatrix(G,1,0,!0),ee.far=re}const U=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[U].far,this._cascades[U].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/pa.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=pa.shadowMapResolution,this._uniformValues.u_shadowmap_0=fa.ShadowMap0,this._uniformValues.u_shadowmap_1=fa.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Z=g.transform.elevation;for(const te of this._groundShadowTiles){let ee={min:0,max:0};if(Z){const oe=Z.getMinMaxForTile(te);oe&&(ee=oe)}this.addShadowReceiver(te.toUnwrapped(),ee.min,ee.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,h){if(!this.enabled)return;const g=this.painter,x=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),x.viewport.set([0,0,pa.shadowMapResolution,pa.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){g.currentShadowCascade=w,x.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),x.clear({color:i.am.white,depth:1});for(const E of s.order){const C=s._mergedLayers[E];if(!C.hasShadowPass()||C.isHidden(g.transform.zoom))continue;const O=s.getLayerSourceCache(C),z=O?h[O.id]:void 0;(C.type==="model"||z&&z.length)&&g.renderLayer(g,O,C,z)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,h=s.style,g=s.context,x=h.directionalLight,w=h.ambientLight;if(!x||!w)return;const E=[],C=Uu(s,s.longestCutoffRange);C.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),E.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&E.push("NORMAL_OFFSET");const O=Sl(h,x,w),z=new Jt(g.gl.LEQUAL,Jt.ReadOnly,s.depthRangeFor3D);for(const F of this._groundShadowTiles){const G=F.toUnwrapped(),U=s.isTileAffectedByFog(F),Z=s.getOrCreateProgram("groundShadow",{defines:E,overrideFog:U});this.setupShadows(G,Z),s.uploadCommonUniforms(g,Z,G,null,C);const te={u_matrix:s.transform.calculateProjMatrix(G),u_ground_shadow_factor:O};Z.draw(s,g.gl.TRIANGLES,z,In.disabled,Zn.multiply,Mn.disabled,te,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,null,s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Zn.unblended:Zn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const h=this.painter.transform,g=h.calculatePosMatrix(s,h.worldSize);return i.az(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(s){return i.az(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,h,g,x=0){if(!this.enabled)return;const w=this.painter.transform,E=this.painter.context,C=E.gl,O=this._uniformValues,z=new Float64Array(16),F=w.calculatePosMatrix(s,w.worldSize);for(let G=0;G<this._cascades.length;G++)i.az(z,this._cascades[G].matrix,F),O[G===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(z),E.activeTexture.set(C.TEXTURE0+fa.ShadowMap0+G),this._cascades[G].texture.bind(C.NEAREST,C.CLAMP_TO_EDGE);if(this.useNormalOffset=!!g,this.useNormalOffset){const G=i.cT(s.canonical),U=2/w.tileSize*i.aj/pa.shadowMapResolution,Z=U*this._cascades[0].boundingSphereRadius,te=U*this._cascades[this._cascades.length-1].boundingSphereRadius,ee=(g==="vector-tile"?1:3)/Math.pow(2,x-s.canonical.z-(1-w.zoom+Math.floor(w.zoom)));O.u_shadow_normal_offset=[G,Z*ee,te*ee],O.u_shadow_bias=[6e-5,.0012,.012]}else O.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(E,O)}setupShadowsFromMatrix(s,h,g=!1){if(!this.enabled)return;const x=this.painter.context,w=x.gl,E=this._uniformValues,C=new Float64Array(16);for(let O=0;O<pa.cascadeCount;O++)i.az(C,this._cascades[O].matrix,s),E[O===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(C),x.activeTexture.set(w.TEXTURE0+fa.ShadowMap0+O),this._cascades[O].texture.bind(w.NEAREST,w.CLAMP_TO_EDGE);if(this.useNormalOffset=g,g){const O=pa.normalOffset;E.u_shadow_normal_offset=[1,O,O],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(x,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,h,g,x){if(x[2]>=0)return{};const w=function(O,z,F){const G=F/(1<<O.canonical.z);return new i.cV([O.canonical.x*G+O.wrap*F,O.canonical.y*G+O.wrap*F,0],[(O.canonical.x+1)*G+O.wrap*F,(O.canonical.y+1)*G+O.wrap*F,z])}(s,h,g).getCorners(),E=h/-x[2];x[0]<0?(i.cU(w[0],w[0],[x[0]*E,0,0]),i.cU(w[3],w[3],[x[0]*E,0,0])):x[0]>0&&(i.cU(w[1],w[1],[x[0]*E,0,0]),i.cU(w[2],w[2],[x[0]*E,0,0])),x[1]<0?(i.cU(w[0],w[0],[0,x[1]*E,0]),i.cU(w[1],w[1],[0,x[1]*E,0])):x[1]>0&&(i.cU(w[2],w[2],[0,x[1]*E,0]),i.cU(w[3],w[3],[0,x[1]*E,0]));const C={};return C.vertices=w,C.planes=[nc(w[1],w[0],w[4]),nc(w[2],w[1],w[5]),nc(w[3],w[2],w[6]),nc(w[0],w[3],w[7])],C}addShadowReceiver(s,h,g){this._receivers.add(s,i.cV.fromTileIdAndHeight(s,h,g))}getMaxCascadeForTile(s){const h=this._receivers.get(s);return h&&h.lastCascade?h.lastCascade:0}}function nc(m,s,h){const g=i.at([],h,s),x=i.at([],m,s),w=i.bG([],g,x),E=i.ae(w);return E===0?[0,0,1,0]:(i.b$(w,w,1/E),[w[0],w[1],w[2],-i.bE(w,s)])}function t0(m){const s=m.properties.get("direction"),h=i.cR(s.x,s.y,s.z);h[2]=i.aD(h[2],0,75);const g=i.cW([h[0],h[1],h[2]]);return i.cS(g.x,g.y,g.z)}function Sl(m,s,h){const g=s.properties.get("color-use-theme")==="none",x=s.properties.get("color"),w=s.properties.get("intensity"),E=s.properties.get("direction"),C=[E.x,E.y,E.z],O=h.properties.get("color-use-theme")==="none",z=h.properties.get("color"),F=h.properties.get("intensity"),G=Math.max(i.bE([0,0,1],C),0),U=[0,0,0];i.b$(U,z.toRenderColor(O?null:m.getLut(s.scope)).toArray01Linear().slice(0,3),F);const Z=[0,0,0];return i.b$(Z,x.toRenderColor(g?null:m.getLut(h.scope)).toArray01Linear().slice(0,3),G*w),i.cX([U[0]>0?U[0]/(U[0]+Z[0]):0,U[1]>0?U[1]/(U[1]+Z[1]):0,U[2]>0?U[2]/(U[2]+Z[2]):0])}function n0(m,s,h,g,x,w){const E=m.zoom,C=m.scale,O=m.worldSize,z=1/O,F=m.aspect,G=Math.sqrt(1+F*F)*Math.tan(.5*m.fovX),U=G*G,Z=g-h,te=g+h;let ee,oe;U>Z/te?(ee=g,oe=g*G):(ee=.5*te*(1+U),oe=.5*Math.sqrt(Z*Z+2*(g*g+h*h)*U+te*te*U*U));const re=m.projection.pixelsPerMeter(m.center.lat,O),fe=m._camera.getCameraToWorldMercator(),_e=[0,0,-ee*z];i.ad(_e,_e,fe);let be=oe*z;const Pe=m._edgeInsets;if(!(Pe.left===0&&Pe.top===0&&Pe.right===0&&Pe.bottom===0||Pe.left===Pe.right&&Pe.top===Pe.bottom)){const Tt=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?re:1),gt=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,h,g);gt[8]=2*-m.centerOffset.x/m.width,gt[9]=2*m.centerOffset.y/m.height;const Et=new Float64Array(16);i.cB(Et,gt,Tt);const At=new Float64Array(16);i.bi(At,Et);const Yt=i.cn.fromInvProjectionMatrix(At,O,E,!0);for(const an of Yt.points){const Xt=((Ee=an)[0]/=C,Ee[1]/=C,Ee[2]=i.c6(Ee[2],m._center.lat),Ee);be=Math.max(be,i.c0(i.cY([],_e,Xt)))}}var Ee;be*=x/(x-1);const Ae=Math.acos(s[2]),we=Math.atan2(-s[0],-s[1]),Me=new ea;Me.position=_e,Me.setPitchBearing(Ae,we);const ke=Me.getWorldToCamera(O,re),Qe=be*O,qe=Math.min(m._mercatorZfromZoom(17)*O*-2,-2*Qe),mt=Me.getCameraToClipOrthographic(-Qe,Qe,-Qe,Qe,qe,(Qe+w*re)/s[2]),dt=new Float64Array(16);i.az(dt,mt,ke);const Ot=i.cS(Math.floor(1e6*_e[0])/1e6*O,Math.floor(1e6*_e[1])/1e6*O,0),Ze=.5*x,et=[0,0,0];i.ad(et,Ot,dt),i.b$(et,et,Ze);const We=[Math.floor(et[0]),Math.floor(et[1]),Math.floor(et[2])],vt=[0,0,0];i.at(vt,et,We),i.b$(vt,vt,-1/Ze);const at=new Float64Array(16);return i.bx(at),i.bo(at,at,vt),i.az(dt,at,dt),[dt,Qe]}class Zc extends i.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(s,h){return i.aS(this.requestManager.transformRequest(h,i.R.Model).url).then(g=>{if(!g)return;const x=i.aT(g),w=new i.aU(s,void 0,void 0,x);return w.computeBoundsAndApplyParent(),w}).catch(g=>{if(g&&g.status===404)return null;this.fire(new i.z(new Error(`Could not load model ${s} from ${h}: ${g.message}`)))})}load(s,h,g={forceReload:!1}){this.models[h]||(this.models[h]={});const x=Object.keys(s),w=[],E=[];for(const C of x){const O=s[C];this.hasURLBeenRequested(O)&&!g.forceReload||(this.modelByURL[O]={modelId:C,scope:h},w.push(this.loadModel(C,O)),E.push(C)),this.models[h][C]||(this.models[h][C]={model:null,numReferences:1})}this.numModelsLoading[h]=(this.numModelsLoading[h]||0)+E.length,Promise.allSettled(w).then(C=>{for(let O=0;O<C.length;O++){const{status:z}=C[O];if(z==="rejected")continue;const{value:F}=C[O];this.models[h][E[O]]||(this.models[h][E[O]]={model:null,numReferences:1}),this.models[h][E[O]].model=F}this.numModelsLoading[h]-=E.length,this.fire(new i.A("data",{dataType:"style"}))}).catch(C=>{this.fire(new i.z(new Error(`Could not load models: ${C.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,h,g={exactIdMatch:!1}){return!!(g.exactIdMatch?this.getModel(s,h):this.getModelByURL(this.modelUris[h][s]))}getModel(s,h){return this.models[h]||(this.models[h]={}),this.models[h][s]?this.models[h][s].model:void 0}getModelByURL(s){if(!s)return null;const h=this.modelByURL[s];return h?this.models[h.scope][h.modelId].model:null}hasModelBeenAdded(s,h){return this.models[h]&&this.models[h][s]!==void 0}getModelURIs(s){return this.modelUris[s]||{}}addModel(s,h,g){this.models[g]||(this.models[g]={}),this.modelUris[g]||(this.modelUris[g]={});const x=this.requestManager.normalizeModelURL(h);if((this.hasModel(s,g,{exactIdMatch:!0})||this.hasModelBeenAdded(s,g))&&this.modelUris[g][s]===x)this.models[g][s].numReferences++;else if(this.hasURLBeenRequested(x)){const{scope:w,modelId:E}=this.modelByURL[x];this.models[w][E].numReferences++}else this.modelUris[g][s]=x,this.load({[s]:this.modelUris[g][s]},g)}addModelURLs(s,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const g=this.modelUris[h];for(const x in s)g[x]=this.requestManager.normalizeModelURL(s[x])}reloadModels(s){this.load(this.modelUris[s],s,{forceReload:!0})}addModelsFromBucket(s,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const g={};for(const x of s)this.hasModel(x,h,{exactIdMatch:!0})||this.hasURLBeenRequested(x)?this.models[h][x].numReferences++:this.modelUris[h][x]&&!this.hasURLBeenRequested(x)?g[x]=this.modelUris[h][x]:!this.hasURLBeenRequested(x)&&i.cZ(x,!1)&&(this.modelUris[h][x]=this.requestManager.normalizeModelURL(x),g[x]=this.modelUris[h][x]);this.load(g,h)}hasURLBeenRequested(s){return this.modelByURL[s]!==void 0}removeModel(s,h,g=!1){if(this.models[h]&&this.models[h][s]&&(this.models[h][s].numReferences--,this.models[h][s].numReferences===0)){const x=this.modelUris[h][s];g||delete this.modelUris[h][s],delete this.modelByURL[x];const w=this.models[h][s].model;if(!w)return;delete this.models[h][s],w.destroy()}}destroy(){for(const s of Object.keys(this.models))for(const h of Object.keys(this.models[s])){const g=this.models[s][h].model;delete this.models[s][h],g&&g.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,h){this.models[h]||(this.models[h]={});for(const g in this.models[h])this.models[h][g].model&&this.models[h][g].model.upload(s.context)}}const fI=new i.a7({data:new i.a8(i.a5.colorTheme.data)}),pI={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function tS(m){return m=m||{},Object.assign(m,pI)}class nS extends i.E{constructor(s){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=s,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=s.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=s.stylesheet.indoor.buildingFeaturesetId,this._scope=s.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:s=>(s.feature&&s.feature.properties.floorplan&&this.selectFloorplan(s.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(s){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(E,C){const[O,z]=E,{center:F,radius:G}=C,[U,Z]=F,te=Math.abs(O-U);return Math.sqrt((te>180?360-te:te)**2+(z-Z)**2)<=G}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.A("floorplangone")));const h={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=new i.P(this._map.transform.width/2,this._map.transform.height/2),x=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],w=this._map.queryRenderedFeatures(s?x:g,h);w.length>0&&(this._selectedFloorplan&&w[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=w[0],this._floorplanSelected(!1)))}_floorplanSelected(s){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(w){const[[E,C],[O,z]]=w,F=(O-E+360)%360,G=F>180?360-F:F;return{center:[(E+G/2+360)%360,(C+z)/2],radius:Math.sqrt(G**2+(z-C)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const h=this._floorplanStates[this._indoorData.id].selectedBuilding,g=this._floorplanStates[this._indoorData.id].selectedLevel;let x;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const w of this._indoorData.levels)w.id===this._selectedLevel.id&&(x=w.id);if(this.fire(new i.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:x})),h){const w=this._indoorData.buildings.find(E=>E.id===h);this._buildingSelected(w,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(g){const w=this._indoorData.levels.find(E=>E.id===g);this._updateLevels(w,s)}else s&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(s,h){h&&s&&s.extent&&this._map.fitBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=s?s.id:void 0;const g=this._indoorData.levels.filter(x=>s.levels.includes(x.id));this.fire(new i.A("buildingselected",{buildingId:s.id,levels:g}))}_levelSelected(s){if(s==="overview")this._updateLevels(void 0,!0);else{const h=this._indoorData.levels.find(g=>g.id===s);this._updateLevels(h,!0)}this.fire(new i.A("levelselected",{levelId:s==="overview"?void 0:s}))}_updateLevels(s,h){if(!s)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(h&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function g(z){const F=z.indexOf("/floor/");if(F===-1)return z;const G=F+7,U=z.indexOf("/",G);return U===-1?z.slice(G):z.slice(G,U)}this._selectedLevel=s,this._floorplanStates[this._indoorData.id].selectedLevel=s?s.id:void 0;const x=[],w={},E={},C={},O={};for(const z of this._indoorData.levels)if(x.push(z.id),w[z.id]=z.height,E[z.id]=z.base,s){if(this.mergeFloors){const F=g(s.id),G=g(z.id);C[z.id]=G===F?"true":"false"}else C[z.id]=z.id===s.id?"true":"false";O[z.id]=z.base<s.base?"true":"false"}else O[z.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",E]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",C]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",O]),s&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!s.isUnderground),h&&s.extent)){const z=this._map.cameraForBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),F=this._map.getZoom(),G=z.zoom?Math.abs(F-z.zoom):0;this._map.fitBounds(s.extent,G>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:F})}}selectFloorplan(s){const h={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(g,h);if(x.length>0){for(const w of x)if(JSON.parse(w.properties["indoor-data"]).floorplanIDs.includes(s)){this._selectedFloorplan=w,this._floorplanSelected(!0);break}}}selectBuilding(s){const h=this._indoorData.buildings.find(g=>g.id===s);this._buildingSelected(h,!0)}selectLevel(s){this._levelSelected(s)}}function mI(m){if(!m.metadata||!m.metadata.content_area)return;const s=i.q.devicePixelRatio,{left:h,top:g,width:x,height:w}=m.metadata.content_area,E=h*s,C=g*s;return[E,C,E+x*s,C+w*s]}function gg(m){if(m)return m.map(([s,h])=>[s*i.q.devicePixelRatio,h*i.q.devicePixelRatio])}class rS{constructor(s,h,g){this.id=s,this.scope=h,this.sourceCache=g,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(s){this.missingRequests.has(s.name)||this.pendingRequests.has(s.name)||this.pendingRequests.add(s.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const s=new Map;if(!this.sourceCache.loaded())return s;const h=this.sourceCache.getVisibleCoordinates();if(h.length===0)return s;const g=this.sourceCache.getSource();if(!(g instanceof Ru))return s;const x=h.map(E=>this.sourceCache.getTile(E)),w=g.getImages(x,Array.from(this.pendingRequests));for(const[E,C]of w)s.set(i.I.from({name:E,iconsetId:this.id}),C),this.pendingRequests.delete(E);for(const E of this.pendingRequests)this.missingRequests.add(E);return this.pendingRequests.clear(),s}}const Xc=(m,s)=>Ue(m,s&&s.filter(h=>h.identifier!=="source.canvas")),iS=i.aF(gr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),oS=i.aF(gr,["setCenter","setZoom","setBearing","setPitch"]),rc=new Set(["background","sky","slot","custom"]),pp={version:8,layers:[],sources:{}},r0={duration:300,delay:0};class Es extends i.E{constructor(s,h={}){super(),this.map=s,this.scope=h.scope||"",this.globalId=null,this.fragments=[],this.importDepth=h.importDepth||0,this.importsCache=h.importsCache||new Map,this.resolvedImports=h.resolvedImports||new Set,this.transition=i.l({},r0),this._buildingIndex=new qw(this),this.crossTileSymbolIndex=new mo,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=h.styleChanges||new zn,this.dispatcher=h.dispatcher?h.dispatcher:new i.D(i.d0(),this),h.imageManager?this.imageManager=h.imageManager:(this.imageManager=new hi(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=h.glyphManager?h.glyphManager:new i.d1(s._requestManager,h.localFontFamily?i.d2.all:h.localIdeographFontFamily?i.d2.ideographs:i.d2.none,h.localFontFamily||h.localIdeographFontFamily),h.modelManager?this.modelManager=h.modelManager:(this.modelManager=new Zc(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=h.configOptions?h.configOptions:new Map,this._configDependentLayers=h.configDependentLayers?h.configDependentLayers:new Set,this._config=h.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:h.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=h.initialConfig,this.dispatcher.broadcast("setReferrer",i.d3());const g=this;this._rtlTextPluginCallback=Es.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(w,E)=>{if(i.d4(w),E&&E.every(C=>C))for(const C in g._sourceCaches){const O=g._sourceCaches[C],z=O.getSource().type;z!=="vector"&&z!=="geojson"||O.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const w=this.getOwnSource(x.sourceId);if(w&&w.vectorLayerIds)for(const E in this._layers){const C=this._layers[E];C.source===w.id&&this._validateLayer(C)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(i.f(s))return s;const h=i.d5(s);if(!h.startsWith("http"))try{return new URL(h,location.href).toString()}catch{return h}return h}return`json://${i.d6(JSON.stringify(s))}`}_diffStyle(s,h,g){this.globalId=this._getGlobalId(s);const x=(w,E)=>{try{E(null,this.setState(w,g))}catch(C){E(C,!1)}};if(typeof s=="string"){const w=this.map._requestManager.normalizeStyleURL(s),E=this.map._requestManager.transformRequest(w,i.R.Style);i.n(E,(C,O)=>{C?this.fire(new i.z(C)):O&&x(O,h)})}else typeof s=="object"&&x(s,h)}loadURL(s,h={}){this.fire(new i.A("dataloading",{dataType:"style"}));const g=typeof h.validate=="boolean"?h.validate:!i.f(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,h.accessToken),this.resolvedImports.add(s);const x=this.importsCache.get(s);if(x)return this._load(x,g);const w=this.map._requestManager.transformRequest(s,i.R.Style);this._request=i.n(w,(E,C)=>{if(this._request=null,E)this.fire(new i.z(E));else if(C)return this.importsCache.set(s,C),this._load(C,g)})}loadJSON(s,h={}){this.fire(new i.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=i.q.frame(()=>{this._request=null,this._load(s,h.validate!==!1)})}loadEmpty(){this.fire(new i.A("dataloading",{dataType:"style"})),this._load(pp,!1)}_loadImports(s,h,g){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const w of s){const E=this._createFragmentStyle(w),C=new Promise(F=>{E.once("style.import.load",F),E.once("error",F)}).then(()=>this.mergeAll());if(x.push(C),this.resolvedImports.has(w.url)){E.loadEmpty();continue}const O=w.data||this.importsCache.get(w.url);O?(E.loadJSON(O,{validate:h}),this._isInternalStyle(O)&&(E.globalId=null)):w.url?E.loadURL(w.url,{validate:h}):E.loadEmpty();const z={style:E,id:w.id,config:w.config};if(g){const F=this.fragments.findIndex(({id:G})=>G===g);this.fragments=this.fragments.slice(0,F).concat(z).concat(this.fragments.slice(F))}else this.fragments.push(z)}return Promise.allSettled(x)}getImportGlobalIds(s=this,h=new Set){for(const g of s.fragments)g.style.globalId&&h.add(g.style.globalId),this.getImportGlobalIds(g.style,h);return[...h.values()]}_createFragmentStyle(s){const h=this.scope?i.C(s.id,this.scope):s.id;let g;const x=this._initialConfig&&this._initialConfig[h];(s.config||x)&&(g=i.l({},s.config,x));const w=new Es(this.map,{scope:h,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,h){const g=s.indoor?tS(s.schema):s.schema;if(this._isInternalStyle(s)){const E=i.l({},pp,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(E,h)}if(this.updateConfig(this._config,g),h&&Xc(this,Na(s)))return;this._loaded=!0,this.stylesheet=i.d7(s);const x=()=>{for(const z in s.sources)this.addSource(z,s.sources[z],{validate:!1,isInitialLoad:!0});if(s.iconsets)for(const z in s.iconsets)this.addIconset(z,s.iconsets[z]);s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(s.glyphs);const E=lg(this.stylesheet.layers);if(this._order=E.map(z=>z.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const z=this.stylesheet.lights[0];this.light=new rt(z.properties,z.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new rt(this.stylesheet.light)),this._layers={};for(const z of E){const F=i.dc(z,this.scope,this._styleColorTheme.lut,this.options);F.configDependencies.size!==0&&this._configDependentLayers.add(F.fqid),F.setEventedParent(this,{layer:{id:F.id}}),this._layers[F.id]=F;const G=this.getOwnLayerSourceCache(F),U=!!this.directionalLight&&this.directionalLight.shadowsEnabled();G&&F.canCastShadows()&&U&&(G.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const C=this.stylesheet.terrain;C&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(C,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.A("data",{dataType:"style"}));const O=this.isRootStyle();s.imports?this._loadImports(s.imports,h).then(()=>{this._reloadImports(),this.fire(new i.A(O?"style.load":"style.import.load"))}).catch(z=>{this.fire(new i.z(new Error("Failed to load imports",z))),this.fire(new i.A(O?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.A(O?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const w=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(w){const E=this._evaluateColorThemeData(w);this._loadColorTheme(E).then(()=>{x()}).catch(C=>{i.w(`Couldn't load color theme from the stylesheet: ${C}`),x()})}else this._styleColorTheme.lut=null,x()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,h,g,x,w,E,C,O,z,F;const G={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(U=>{if(U.stylesheet){if(U.light!=null&&(s=U.light),U.stylesheet.lights)for(const Z of U.stylesheet.lights)Z.type==="ambient"&&U.ambientLight!=null&&(h=U.ambientLight),Z.type==="directional"&&U.directionalLight!=null&&(g=U.directionalLight);x=this._prioritizeTerrain(x,U.terrain,U.stylesheet.terrain),U.stylesheet.fog&&U.fog!=null&&(w=U.fog),U.stylesheet.snow&&U.snow!=null&&(E=U.snow),U.stylesheet.rain&&U.rain!=null&&(C=U.rain),U.stylesheet.camera!=null&&(F=U.stylesheet.camera),U.stylesheet.projection!=null&&(O=U.stylesheet.projection),U.stylesheet.transition!=null&&(z=U.stylesheet.transition),G[U.scope]=U._styleColorTheme}}),this.light=s,this.ambientLight=h,this.directionalLight=g,this.fog=w,this.snow=E,this.rain=C,this._styleColorThemeForScope=G,x===null?delete this.terrain:this.terrain=x,this.camera=F||{"camera-projection":"perspective"},this.projection=O||{name:"mercator"},this.transition=i.l({},r0,z),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const h=g=>{for(const x of g.fragments)h(x.style);s(g)};h(this)}_prioritizeTerrain(s,h,g){const x=s&&s.drapeRenderMode===0;return g===null?h&&h.drapeRenderMode===0?h:x?s:null:h!=null&&(!s||x||h&&h.drapeRenderMode===1)?h:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(h=>{s=this._prioritizeTerrain(s,h.terrain,h.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(h=>{h.stylesheet.projection!=null&&(s=h.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},h={},g={};this.forEachFragmentStyle(x=>{for(const w in x._sourceCaches){const E=i.C(w,x.scope);s[E]=x._sourceCaches[w]}for(const w in x._otherSourceCaches){const E=i.C(w,x.scope);h[E]=x._otherSourceCaches[w]}for(const w in x._symbolSourceCaches){const E=i.C(w,x.scope);g[E]=x._symbolSourceCaches[w]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=h,this._mergedSymbolSourceCaches=g}mergeLayers(){const s={},h=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(w=>{for(const E of w._order){const C=w._layers[E];if(C.type==="slot"){const O=i.d8(E);if(s[O])continue;s[O]=[]}C.slot&&s[C.slot]?s[C.slot].push(C):h.push(C)}}),this._mergedOrder=[];const x=(w=[])=>{for(const E of w)if(E.type==="slot"){const C=i.d8(E.id);s[C]&&x(s[C]),this._mergedSlots.push(C)}else{const C=i.C(E.id,E.scope);this._mergedOrder.push(C),g[C]=E,E.is3D(!!this.terrain)&&(this._has3DLayers=!0),E.type==="circle"&&(this._hasCircleLayers=!0),E.type==="symbol"&&(this._hasSymbolLayers=!0),E.type==="clip"&&(this._clipLayerPresent=!0)}};x(h),this._mergedOrder.sort((w,E)=>{const C=g[w],O=g[E];return C.hasInitialOcclusionOpacityProperties?O.is3D(!!this.terrain)?1:0:C.is3D(!!this.terrain)&&O.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=i.l({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(h,g,x){const w=i.l({},g);for(const C of Object.keys(i.a5.colorTheme))w[C]===void 0&&(w[C]=i.a5.colorTheme[C].default);const E=new i.a6(fI,h,new Map(x));return E.setTransitionOrValue(w,x),E.untransitioned().possiblyEvaluate(new i.aa(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const h=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,x)=>{const w="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let E=s;E.startsWith(w)||(E=w+E);const C=i.I.from("mapbox-reserved-lut"),O=new Image;O.src=E,O.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},O.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==h)return void g();this._styleColorTheme.lutLoading=!1;const{width:z,height:F,data:G}=i.q.getImageData(O);if(F>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(z!==F*F)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(C)&&this.removeImage(C),this.addImage(C,{data:new i.r({width:z,height:F},G),pixelRatio:1,sdf:!1,usvg:!1,version:0});const U=this.imageManager.getImage(C,this.scope);U?(this._styleColorTheme.lut={image:U.data,data:s},g()):x(new Error("Missing LUT image."))}})}getLut(s){const h=this._styleColorThemeForScope[s];return h?h.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(h,g,x){let w,E,C;const O=i.q.devicePixelRatio>1?"@2x":"";let z=i.n(g.transformRequest(g.normalizeSpriteURL(h,O,".json"),i.R.SpriteJSON),(U,Z)=>{z=null,C||(C=U,w=Z,G())}),F=i.o(g.transformRequest(g.normalizeSpriteURL(h,O,".png"),i.R.SpriteImage),(U,Z)=>{F=null,C||(C=U,E=Z,G())});function G(){if(C)x(C);else if(w&&E){const U=i.q.getImageData(E),Z={};for(const te in w){const{width:ee,height:oe,x:re,y:fe,sdf:_e,pixelRatio:be,stretchX:Pe,stretchY:Ee,content:Ae}=w[te],we=new i.r({width:ee,height:oe});i.r.copy(U,we,{x:re,y:fe},{x:0,y:0},{width:ee,height:oe},null),Z[te]={data:we,pixelRatio:be,sdf:_e,stretchX:Pe,stretchY:Ee,content:Ae,usvg:!1}}x(null,Z)}}return{cancel(){z&&(z.cancel(),z=null),F&&(F.cancel(),F=null)}}}(s,this.map._requestManager,(h,g)=>{if(this._spriteRequest=null,h)this.fire(new i.z(h));else if(g){const x=new Map;for(const w in g)x.set(i.I.from(w),g[w]);this.addImages(x)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))})}addIconset(s,h){if(h.type==="sprite")return void this._loadSprite(h.url);const g=this.getOwnSourceCache(h.source);if(!g)return void this.fire(new i.z(new Error(`Source "${h.source}" as specified by iconset "${s}" does not exist and cannot be used as an iconset source`)));const x=g.getSource();if(x.type!=="raster-array")return void this.fire(new i.z(new Error(`Source "${h.source}" as specified by iconset "${s}" is not a "raster-array" source and cannot be used as an iconset source`)));x.partial=!1;const w=new rS(s,this.scope,g);this.imageManager.addImageProvider(w,this.scope)}removeIconset(s){this.imageManager.removeImageProvider(s,this.scope)}_loadIconset(s){if(!i.f(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);const h=this.map._spriteFormat==="auto";var g,x;this._spriteRequest=(x=(w,E)=>{if(this._spriteRequest=null,w)h?this._loadSprite(s):this.fire(new i.z(w));else if(E){const C=new Map;for(const O in E)C.set(i.I.from(O),E[O]);this.addImages(C)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))},i.br((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(s),i.R.Iconset),(w,E)=>{if(w)return void x(w);const C={},O=i.c_(new i.bq(E));for(const z of O.icons){const F={version:1,pixelRatio:i.q.devicePixelRatio,content:mI(z),stretchX:z.metadata?gg(z.metadata.stretch_x_areas):void 0,stretchY:z.metadata?gg(z.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:z};C[z.name]=F}x(null,C)}))}_validateLayer(s){const h=this.getOwnSource(s.source);if(!h)return;const g=s.sourceLayer;g&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(g)===-1)&&this.fire(new i.z(new Error(`Source layer "${g}" does not exist on source "${h.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,h)=>{const g=this.fragments[h];return g&&g.style&&(s.data=g.style.serialize()),s})}_serializeSources(){const s={};for(const h in this._sourceCaches){const g=this._sourceCaches[h].getSource();s[g.id]||(s[g.id]=g.serialize())}return s}_serializeLayers(s){const h=[];for(const g of s){const x=this._layers[g];x&&x.type!=="custom"&&h.push(x.serialize())}return h}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const h=this.getOwnLayer(s);if(h)return h;this.fire(new i.z(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const h=this.getOwnSource(s);if(h)return h;this.fire(new i.z(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,h){const g=this.map.painter;if(g)for(let x=s.minzoom||0;x<(s.maxzoom||25.5);x++){const w=s.getProgramIds();if(w)for(const E of w){const C=s.getDefaultProgramParams(E,h.zoom,this._styleColorTheme.lut);C&&(g.style=this,this.fog&&(g._fogVisible=!0,C.overrideFog=!0,g.getOrCreateProgram(E,C)),g._fogVisible=!1,C.overrideFog=!1,g.getOrCreateProgram(E,C),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(C.overrideRtt=!0,g.getOrCreateProgram(E,C)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const h=this.calculateLightsBrightness();s.brightness=h||0,h!==this._brightness&&(this._brightness=h,this.dispatcher.broadcast("setBrightness",h));const g=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const C=this._changes.getLayerUpdatesByScope();for(const O in C){const{updatedIds:z,removedIds:F}=C[O];(z||F)&&(this._updateWorkerLayers(O,z,F),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const w={};for(const C in this._mergedSourceCaches){const O=this._mergedSourceCaches[C];w[C]=O.used,O.used=!1,O.tileCoverLift=0}for(const C of this._mergedOrder){const O=this._mergedLayers[C];if(O.recalculate(s,this._availableImages),!O.isHidden(s.zoom)){const z=this.getLayerSourceCache(O);z&&(z.used=!0,z.tileCoverLift=Math.max(z.tileCoverLift,O.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(O,s)}):this.precompilePrograms(O,s))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();const E=this.imageManager.getPendingImageProviders();for(const C of E)C.sourceCache.used=!0;for(const C in w){const O=this._mergedSourceCaches[C];w[C]!==O.used&&O.getSource().fire(new i.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:O.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),g&&this.fire(new i.A("data",{dataType:"style"}))}updateImageProviders(){const s=this.imageManager.getPendingImageProviders();for(const h of s){const g=h.resolvePendingRequests(),x=this.getFragmentStyle(h.scope);x&&x.addImages(g)}}_updateTilesForChangedImages(){const s={};for(const h in this._mergedSourceCaches){const g=this._mergedSourceCaches[h].getSource().scope;s[g]=s[g]||this._changes.getUpdatedImages(g),s[g].length!==0&&this._mergedSourceCaches[h].reloadTilesForDependencies(["icons","patterns"],s[g])}for(const h in s)this._changes.resetUpdatedImages(h)}_updateWorkerLayers(s,h,g){const x=this.getFragmentStyle(s);x&&this.dispatcher.broadcast("updateLayers",{layers:h?x._serializeLayers(h):[],scope:s,removedIds:g||[],options:x.options})}setState(s,h){if(this._checkLoaded(),Xc(this,Na(s)))return!1;(s=i.d7(s)).layers=lg(s.layers);const g=function(E,C){if(!E)return[{command:gr.setStyle,args:[C]}];let O=[];try{if(!i.bv(E.version,C.version))return[{command:gr.setStyle,args:[C]}];if(i.bv(E.center,C.center)||O.push({command:gr.setCenter,args:[C.center]}),i.bv(E.zoom,C.zoom)||O.push({command:gr.setZoom,args:[C.zoom]}),i.bv(E.bearing,C.bearing)||O.push({command:gr.setBearing,args:[C.bearing]}),i.bv(E.pitch,C.pitch)||O.push({command:gr.setPitch,args:[C.pitch]}),i.bv(E.sprite,C.sprite)||O.push({command:gr.setSprite,args:[C.sprite]}),i.bv(E.glyphs,C.glyphs)||O.push({command:gr.setGlyphs,args:[C.glyphs]}),i.bv(E.imports,C.imports)||function(Z=[],te=[],ee){te=te||[];const oe=(Z=Z||[]).map(Uc),re=te.map(Uc),fe=Z.reduce(Jh,{}),_e=te.reduce(Jh,{}),be=oe.slice();let Pe,Ee,Ae,we;for(Pe=0,Ee=0;Pe<oe.length;Pe++)Ae=oe[Pe],_e.hasOwnProperty(Ae)?Ee++:(ee.push({command:gr.removeImport,args:[Ae]}),be.splice(be.indexOf(Ae,Ee),1));for(Pe=0,Ee=0;Pe<re.length;Pe++)Ae=re[re.length-1-Pe],be[be.length-1-Pe]!==Ae&&(fe.hasOwnProperty(Ae)?(ee.push({command:gr.removeImport,args:[Ae]}),be.splice(be.lastIndexOf(Ae,be.length-Ee),1)):Ee++,we=be[be.length-Pe],ee.push({command:gr.addImport,args:[_e[Ae],we]}),be.splice(be.length-Pe,0,Ae));for(const Me of te){const ke=fe[Me.id];ke&&!i.bv(ke,Me)&&ee.push({command:gr.updateImport,args:[Me.id,Me]})}}(E.imports,C.imports,O),i.bv(E.transition,C.transition)||O.push({command:gr.setTransition,args:[C.transition]}),i.bv(E.light,C.light)||O.push({command:gr.setLight,args:[C.light]}),i.bv(E.fog,C.fog)||O.push({command:gr.setFog,args:[C.fog]}),i.bv(E.snow,C.snow)||O.push({command:gr.setSnow,args:[C.snow]}),i.bv(E.rain,C.rain)||O.push({command:gr.setRain,args:[C.rain]}),i.bv(E.projection,C.projection)||O.push({command:gr.setProjection,args:[C.projection]}),i.bv(E.lights,C.lights)||O.push({command:gr.setLights,args:[C.lights]}),i.bv(E.camera,C.camera)||O.push({command:gr.setCamera,args:[C.camera]}),i.bv(E.iconsets,C.iconsets)||function(Z,te,ee){let oe;for(oe in te=te||{},Z=Z||{})Z.hasOwnProperty(oe)&&(te.hasOwnProperty(oe)||ee.push({command:gr.removeIconset,args:[oe]}));for(oe in te){if(!te.hasOwnProperty(oe))continue;const re=te[oe];Z.hasOwnProperty(oe)?i.bv(Z[oe],re)||(ee.push({command:gr.removeIconset,args:[oe]}),ee.push({command:gr.addIconset,args:[oe,re]})):ee.push({command:gr.addIconset,args:[oe,re]})}}(E.iconsets,C.iconsets,O),!i.bv(E["color-theme"],C["color-theme"]))return[{command:gr.setStyle,args:[C]}];const z={},F=[];(function(Z,te,ee,oe){let re;for(re in te=te||{},Z=Z||{})Z.hasOwnProperty(re)&&(te.hasOwnProperty(re)||Yh(re,ee,oe));for(re in te){if(!te.hasOwnProperty(re))continue;const fe=te[re];Z.hasOwnProperty(re)?i.bv(Z[re],fe)||(Z[re].type==="geojson"&&fe.type==="geojson"&&Zw(Z,te,re)?ee.push({command:gr.setGeoJSONSourceData,args:[re,fe.data]}):uI(re,te,ee,oe)):Kh(re,te,ee)}})(E.sources,C.sources,F,z);const G=[];E.layers&&E.layers.forEach(Z=>{Z.source&&z[Z.source]?O.push({command:gr.removeLayer,args:[Z.id]}):G.push(Z)});let U=E.terrain;U&&z[U.source]&&(O.push({command:gr.setTerrain,args:[void 0]}),U=void 0),O=O.concat(F),i.bv(U,C.terrain)||O.push({command:gr.setTerrain,args:[C.terrain]}),function(Z,te,ee){te=te||[];const oe=(Z=Z||[]).map(Uc),re=te.map(Uc),fe=Z.reduce(Jh,{}),_e=te.reduce(Jh,{}),be=oe.slice(),Pe=Object.create(null);let Ee,Ae,we,Me,ke,Qe,qe;for(Ee=0,Ae=0;Ee<oe.length;Ee++)we=oe[Ee],_e.hasOwnProperty(we)?Ae++:(ee.push({command:gr.removeLayer,args:[we]}),be.splice(be.indexOf(we,Ae),1));for(Ee=0,Ae=0;Ee<re.length;Ee++)we=re[re.length-1-Ee],be[be.length-1-Ee]!==we&&(fe.hasOwnProperty(we)?(ee.push({command:gr.removeLayer,args:[we]}),be.splice(be.lastIndexOf(we,be.length-Ae),1)):Ae++,Qe=be[be.length-Ee],ee.push({command:gr.addLayer,args:[_e[we],Qe]}),be.splice(be.length-Ee,0,we),Pe[we]=!0);for(Ee=0;Ee<re.length;Ee++)if(we=re[Ee],Me=fe[we],ke=_e[we],!Pe[we]&&!i.bv(Me,ke))if(i.bv(Me.source,ke.source)&&i.bv(Me["source-layer"],ke["source-layer"])&&i.bv(Me.type,ke.type)){for(qe in Lu(Me.layout,ke.layout,ee,we,null,gr.setLayoutProperty),Lu(Me.paint,ke.paint,ee,we,null,gr.setPaintProperty),i.bv(Me.slot,ke.slot)||ee.push({command:gr.setSlot,args:[we,ke.slot]}),i.bv(Me.filter,ke.filter)||ee.push({command:gr.setFilter,args:[we,ke.filter]}),i.bv(Me.minzoom,ke.minzoom)&&i.bv(Me.maxzoom,ke.maxzoom)||ee.push({command:gr.setLayerZoomRange,args:[we,ke.minzoom,ke.maxzoom]}),Me)Me.hasOwnProperty(qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&qe!=="slot"&&(qe.indexOf("paint.")===0?Lu(Me[qe],ke[qe],ee,we,qe.slice(6),gr.setPaintProperty):i.bv(Me[qe],ke[qe])||ee.push({command:gr.setLayerProperty,args:[we,qe,ke[qe]]}));for(qe in ke)ke.hasOwnProperty(qe)&&!Me.hasOwnProperty(qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&qe!=="slot"&&(qe.indexOf("paint.")===0?Lu(Me[qe],ke[qe],ee,we,qe.slice(6),gr.setPaintProperty):i.bv(Me[qe],ke[qe])||ee.push({command:gr.setLayerProperty,args:[we,qe,ke[qe]]}))}else ee.push({command:gr.removeLayer,args:[we]}),Qe=be[be.lastIndexOf(we)+1],ee.push({command:gr.addLayer,args:[ke,Qe]})}(G,C.layers,O)}catch(z){console.warn("Unable to compute style diff:",z),O=[{command:gr.setStyle,args:[C]}]}return O}(this.serialize(),s).filter(E=>!(E.command in oS));if(g.length===0)return!1;const x=g.filter(E=>!(E.command in iS));if(x.length>0)throw new Error(`Unimplemented: ${x.map(E=>E.command).join(", ")}.`);const w=[];return g.forEach(E=>{w.push(this[E.command](...E.args))}),h&&Promise.all(w).then(h).catch(h),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(s){for(const[h,g]of s.entries()){if(this.getImage(h))return this.fire(new i.z(new Error(`An image with the name "${h.name}" already exists.`)));this.imageManager.addImage(h,this.scope,g),this._changes.updateImage(h,this.scope)}return this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this}addImage(s,h){return this.getImage(s)?this.fire(new i.z(new Error(`An image with the name "${s.name}" already exists.`))):(this.imageManager.addImage(s,this.scope,h),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this)}updateImage(s,h,g=!1){this.imageManager.updateImage(s,this.scope,h),g&&(this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})))}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this):this.fire(new i.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(s){return this.modelManager.addModelURLs(s,this.scope),this._updateWorkerModels(),this.fire(new i.A("data",{dataType:"style"})),this}addModel(s,h,g={}){return this._checkLoaded(),this._validate(Ce,`models.${s}`,h,null,g)||(this.modelManager.addModel(s,h,this.scope),this.fire(new i.A("data",{dataType:"style"}))),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this.fire(new i.A("data",{dataType:"style"})),this):this.fire(new i.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,h,g={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(Yl,`sources.${s}`,h,null,g))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const x=Zh(s,h,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const w=E=>{const C=(E?"symbol:":"other:")+x.id,O=i.C(C,this.scope),z=this._sourceCaches[C]=new ca(O,x,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=z,z.onAdd(this.map)};w(!1),h.type!=="vector"&&h.type!=="geojson"||w(!0),x.onAdd&&x.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const h=this.getOwnSource(s);if(!h)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===s)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const x=Object.entries(this.stylesheet.iconsets).find(([w,E])=>E.type==="source"&&E.source===s);if(x)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while iconset "${x[0]}" is using it.`)))}const g=this.getOwnSourceCaches(s);for(const x of g){const w=i.d8(x.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(x.id),x.fire(new i.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,h){this._checkLoaded(),this.getOwnSource(s).setData(h),this._changes.setDirty()}getOwnSource(s){const h=this.getOwnSourceCache(s);return h&&h.getSource()}getOwnSources(){const s=[];for(const h in this._otherSourceCaches){const g=this.getOwnSourceCache(h);g&&s.push(g.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const h in s){const g=s[h]._tiles;for(const x in g){const w=g[x];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const h=this._getTransitionParameters();for(const x of s){if(this._validate(ku,"lights",x))return;switch(x.type){case"ambient":if(this.ambientLight){const w=this.ambientLight;w.set(x),w.updateTransitions(h)}else this.ambientLight=new ji(x,Zr||(Zr=new i.a7({color:new i.a8(i.a5.properties_light_ambient.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const w=this.directionalLight;w.set(x),w.updateTransitions(h)}else this.directionalLight=new ji(x,_r||(_r=new i.a7({direction:new i.an(i.a5.properties_light_directional.direction),color:new i.a8(i.a5.properties_light_directional.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_directional.intensity),"cast-shadows":new i.a8(i.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a8(i.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a8(i.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=new i.aa(this.z||0,h);this.ambientLight&&this.ambientLight.recalculate(g),this.directionalLight&&this.directionalLight.recalculate(g),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,h=this.ambientLight;if(!s||!h)return;const g=U=>.2126*(U[0]<=.03928?U[0]/12.92:Math.pow((U[0]+.055)/1.055,2.4))+.7152*(U[1]<=.03928?U[1]/12.92:Math.pow((U[1]+.055)/1.055,2.4))+.0722*(U[2]<=.03928?U[2]/12.92:Math.pow((U[2]+.055)/1.055,2.4)),x=s.properties.get("color").toRenderColor(null).toArray01(),w=s.properties.get("intensity"),E=s.properties.get("direction"),C=1-i.cR(E.x,E.y,E.z)[2]/90,O=g(x)*w*C,z=h.properties.get("color").toRenderColor(null).toArray01(),F=h.properties.get("intensity"),G=g(z)*F;return Number(((O+G)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(s==null||s===""&&this.isRootStyle())return this;if(i.d9(s)){const h=i.da(s),g=this.fragments.find(({id:w})=>w===h);if(!g)return;const x=i.d8(s);return g.style.getFragmentStyle(x)}{const h=this.fragments.find(({id:g})=>g===s);return h?h.style:void 0}}setFeaturesetSelectors(s){if(!s)return;const h={},g=(x,w="")=>`${x}::${w}`;this._featuresetSelectors={};for(const x in s){const w=this._featuresetSelectors[x]=[];for(const E of s[x].selectors){if(E.featureNamespace){const O=this.getOwnLayer(E.layer);if(!O){i.w(`Layer is undefined for selector: ${E.layer}`);continue}const z=g(O.source,O.sourceLayer);if(z in h&&h[z]!==E.featureNamespace){i.w(`"featureNamespace ${E.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}h[z]=E.featureNamespace}let C;if(E.properties)for(const O in E.properties){const z=i.X(E.properties[O]);z.result==="success"&&(C=C||{},C[O]=z.value)}w.push({layerId:E.layer,namespace:E.featureNamespace,properties:C,uniqueFeatureID:E._uniqueFeatureID})}}}getFeaturesetDescriptors(s){const h=this.getFragmentStyle(s);if(!h||!h.stylesheet.featuresets)return[];const g=[];for(const x in h.stylesheet.featuresets)g.push({featuresetId:x,importId:h.scope?h.scope:void 0});return g}getFeaturesetLayers(s,h){const g=this.getFragmentStyle(h),x=g.stylesheet.featuresets;if(!x||!x[s])return this.fire(new i.z(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const E of x[s].selectors){const C=g.getOwnLayer(E.layer);C&&w.push(C)}return w}getConfigProperty(s,h){const g=this.getFragmentStyle(s);if(!g)return null;const x=i.C(h,g.scope),w=g.options.get(x),E=w?w.value||w.default:null;return E?E.serialize():null}setConfigProperty(s,h,g){const x=this.getFragmentStyle(s);if(!x)return;const w=x.stylesheet.indoor?tS(x.stylesheet.schema):x.stylesheet.schema;if(!w||!w[h])return;const E=i.X(g);if(E.result!=="success")return void Xc(this,E.value);const C=E.value.expression,O=i.C(h,x.scope),z=x.options.get(O);if(!z)return;let F;const{minValue:G,maxValue:U,stepValue:Z,type:te,values:ee}=w[h],oe=i.X(w[h].default);oe.result==="success"&&(F=oe.value.expression),F?(this.options.set(O,Object.assign({},z,{value:C,default:F,minValue:G,maxValue:U,stepValue:Z,type:te,values:ee})),this.updateConfigDependencies(h)):this.fire(new i.z(new Error(`No schema defined for the config option "${h}" in the "${s}" fragment.`)))}getConfig(s){const h=this.getFragmentStyle(s);if(!h)return null;const g=h.stylesheet.schema;if(!g)return null;const x={};for(const w in g){const E=i.C(w,h.scope),C=h.options.get(E),O=C?C.value||C.default:null;x[w]=O?O.serialize():null}return x}setConfig(s,h){const g=this.getFragmentStyle(s);g&&(g.updateConfig(h,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const h=this.getFragmentStyle(s);return h?h.stylesheet.schema:null}setSchema(s,h){const g=this.getFragmentStyle(s);g&&(g.stylesheet.schema=h,g.updateConfig(g._config,h),this.updateConfigDependencies())}updateConfig(s,h){if(this._config=s,s||h)if(h)for(const g in h){let x,w;const E=i.X(h[g].default);if(E.result==="success"&&(x=E.value.expression),s&&s[g]!==void 0){const U=i.X(s[g]);U.result==="success"&&(w=U.value.expression)}const{minValue:C,maxValue:O,stepValue:z,type:F,values:G}=h[g];if(x){const U=i.C(g,this.scope);this.options.set(U,{default:x,value:w,minValue:C,maxValue:O,stepValue:z,type:F,values:G})}else this.fire(new i.z(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new i.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const h of this._configDependentLayers){const g=this.getLayer(h);if(g){if(s&&!g.configDependencies.has(s))continue;g.possiblyEvaluateVisibility(),this._updateLayer(g)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(h=>{const g=h._styleColorTheme.colorThemeOverride?h._styleColorTheme.colorThemeOverride:h._styleColorTheme.colorTheme;if(g){const x=h._evaluateColorThemeData(g);(!h._styleColorTheme.lut&&x!==""||h._styleColorTheme.lut&&x!==h._styleColorTheme.lut.data)&&h.setColorTheme(g)}}),this._changes.setDirty()}addLayer(s,h,g={}){this._checkLoaded();const x=s.id;if(this._layers[x])return void this.fire(new i.z(new Error(`Layer with id "${x}" already exists on this map`)));let w;if(s.type==="custom"){if(Xc(this,i.db(s)))return;w=i.dc(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(x,s.source),s=i.d7(s),s=i.l(s,{source:x})),this._validate(ne,`layers.${x}`,s,{arrayIndex:-1},g))return;w=i.dc(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:x}})}w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid);let E=this._order.length;if(h){const F=this._order.indexOf(h);if(F===-1)return void this.fire(new i.z(new Error(`Layer with id "${h}" does not exist on this map.`)));w.slot===this._layers[h].slot?E=F:i.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,x),this._layerOrderChanged=!0,this._layers[x]=w;const C=this.getOwnLayerSourceCache(w),O=!!this.directionalLight&&this.directionalLight.shadowsEnabled();C&&w.canCastShadows()&&O&&(C.castsShadows=!0);const z=this._changes.getRemovedLayer(w);if(z&&w.source&&C&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const F=i.C(w.source,w.scope);z.type!==w.type?this._changes.updateSourceCache(F,"clear"):(this._changes.updateSourceCache(F,"reload"),C.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(s,h){this._checkLoaded();const g=this._checkLayer(s);if(!g||s===h)return;const x=this._order.indexOf(s);this._order.splice(x,1);let w=this._order.length;if(h){const E=this._order.indexOf(h);if(E===-1)return void this.fire(new i.z(new Error(`Layer with id "${h}" does not exist on this map.`)));g.slot===this._layers[h].slot?w=E:i.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const h=this._checkLayer(s);if(!h)return;h.setEventedParent(null);const g=this._order.indexOf(s);this._order.splice(g,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(h.fqid),this._changes.removeLayer(h);const x=this.getOwnLayerSourceCache(h);if(x&&x.castsShadows){let w=!1;for(const E in this._layers)if(this._layers[E].source===h.source&&this._layers[E].canCastShadows()){w=!0;break}x.castsShadows=w}h.onRemove&&h.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const h in this._layers)if(this._layers[h].type===s)return!0;return!1}setLayerZoomRange(s,h,g){this._checkLoaded();const x=this._checkLayer(s);x&&(x.minzoom===h&&x.maxzoom===g||(h!=null&&(x.minzoom=h),g!=null&&(x.maxzoom=g),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,h){this._checkLoaded();const g=this._checkLayer(s);g&&g.slot!==h&&(g.slot=h,this._updateLayer(g))}setFilter(s,h,g={}){this._checkLoaded();const x=this._checkLayer(s);if(x&&!i.bv(x.filter,h))return h==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(le,`layers.${x.id}.filter`,h,{layerType:x.type},g)||(x.filter=i.d7(h),this._updateLayer(x)))}getFilter(s){const h=this._checkLayer(s);if(h)return i.d7(h.filter)}setLayoutProperty(s,h,g,x={}){this._checkLoaded();const w=this._checkLayer(s);if(w&&!i.bv(w.getLayoutProperty(h),g)){if(g!=null&&(!x||x.validate!==!1)&&Xc(w,Oe.call(Na,{key:`layers.${s}.layout.${h}`,layerType:w.type,objectKey:h,value:g,styleSpec:i.a5,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(h,g),w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),this._updateLayer(w)}}getLayoutProperty(s,h){const g=this._checkLayer(s);if(g)return g.getLayoutProperty(h)}setPaintProperty(s,h,g,x={}){this._checkLoaded();const w=this._checkLayer(s);if(!w||i.bv(w.getPaintProperty(h),g)||g!=null&&(!x||x.validate!==!1)&&Xc(w,Te.call(Na,{key:`layers.${s}.paint.${h}`,layerType:w.type,objectKey:h,value:g,styleSpec:i.a5})))return;const E=w.setPaintProperty(h,g);w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),E&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(s,h){const g=this._checkLayer(s);if(g)return g.getPaintProperty(h)}setFeatureState(s,h){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:O,importId:z}=s.target,F=this.getFragmentStyle(z),G=F.getFeaturesetLayers(O);for(const{source:U,sourceLayer:Z}of G)F.setFeatureState({id:s.id,source:U,sourceLayer:Z},h)}else if("layerId"in s.target){const{layerId:O}=s.target,z=this.getLayer(O);this.setFeatureState({id:s.id,source:z.source,sourceLayer:z.sourceLayer},h)}return}const g=s.source,x=s.sourceLayer,w=this._checkSource(g);if(!w)return;const E=w.type;if(E==="geojson"&&x)return void this.fire(new i.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!x)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided.")));const C=this.getOwnSourceCaches(g);for(const O of C)O.setFeatureState(x,s.id,h)}removeFeatureState(s,h){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:O,importId:z}=s.target,F=this.getFragmentStyle(z),G=F.getFeaturesetLayers(O);for(const{source:U,sourceLayer:Z}of G)F.removeFeatureState({id:s.id,source:U,sourceLayer:Z},h)}else if("layerId"in s.target){const{layerId:O}=s.target,z=this.getLayer(O);this.removeFeatureState({id:s.id,source:z.source,sourceLayer:z.sourceLayer},h)}return}const g=s.source,x=this._checkSource(g);if(!x)return;const w=x.type,E=w==="vector"?s.sourceLayer:void 0;if(w==="vector"&&!E)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new i.z(new Error("A feature id is required to remove its specific state property.")));const C=this.getOwnSourceCaches(g);for(const O of C)O.removeFeatureState(E,s.id,h)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let w;if("featuresetId"in s.target){const{featuresetId:E,importId:C}=s.target,O=this.getFragmentStyle(C),z=O.getFeaturesetLayers(E);for(const{source:F,sourceLayer:G}of z){const U=O.getFeatureState({id:s.id,source:F,sourceLayer:G});if(U&&!w)w=U;else if(!i.bv(w,U))return void this.fire(new i.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:E}=s.target,C=this.getLayer(E);w=this.getFeatureState({id:s.id,source:C.source,sourceLayer:C.sourceLayer})}return w}const h=s.source,g=s.sourceLayer,x=this._checkSource(h);if(x){if(x.type!=="vector"||g)return s.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(h)[0].getFeatureState(g,s.id);this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=i.l({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),h=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return i.dd({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:h,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateFilteredLayers(s){for(const h of Object.values(this._mergedLayers))s(h)&&this._updateLayer(h)}_updateLayer(s){this._changes.updateLayer(s);const h=this.getLayerSourceCache(s),g=i.C(s.source,s.scope),x=this._changes.getUpdatedSourceCaches();s.source&&!x[g]&&h&&h.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),h.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const h=C=>this._mergedLayers[C].is3D(!!this.terrain),g=this.order,x={},w=[];for(let C=g.length-1;C>=0;C--){const O=g[C];if(h(O)){x[O]=C;for(const z of s){const F=z[O];if(F)for(const G of F)w.push(G)}}}w.sort((C,O)=>O.intersectionZ-C.intersectionZ);const E=[];for(let C=g.length-1;C>=0;C--){const O=g[C];if(h(O))for(let z=w.length-1;z>=0;z--){const F=w[z].feature;if(F.layer&&x[F.layer.id]<C)break;E.push(F),w.pop()}else for(const z of s){const F=z[O];if(F)for(const G of F)E.push(G.feature)}}return E}queryRenderedFeatures(s,h,g){let x;h&&!Array.isArray(h)&&h.filter&&(this._validate(le,"queryRenderedFeatures.filter",h.filter,null,h),x=i.b3(h.filter));const w={},E=F=>{if(rc.has(F.type))return;const G=this.getOwnLayerSourceCache(F),U=w[G.id]=w[G.id]||{sourceCache:G,layers:{},has3DLayers:!1};F.is3D(!!this.terrain)&&(U.has3DLayers=!0),U.layers[F.fqid]=U.layers[F.fqid]||{styleLayer:F,targets:[]},U.layers[F.fqid].targets.push({filter:x})};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new i.z(new Error("parameters.layers must be an Array."))),[];for(const F of h.layers){const G=this._layers[F];if(!G)return this.fire(new i.z(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];E(G)}}else for(const F in this._layers)E(this._layers[F]);const C=this._queryRenderedFeatures(s,w,g),O=this._flattenAndSortRenderedFeatures(C),z=[];for(const F of O)i.de(F.layer.id)===this.scope&&z.push(F);return z}queryRenderedFeatureset(s,h,g){let x;h&&!Array.isArray(h)&&h.filter&&(this._validate(le,"queryRenderedFeatures.filter",h.filter,null,h),x=i.b3(h.filter));const w="mock",E=[];if(h&&h.target)E.push(Object.assign({},h,{targetId:w,filter:x}));else{const F=this.getFeaturesetDescriptors();for(const G of F)E.push({targetId:w,filter:x,target:G});for(const{style:G}of this.fragments){const U=G.getFeaturesetDescriptors();for(const Z of U)E.push({targetId:w,filter:x,target:Z})}}const C=this.queryRenderedTargets(s,E,g),O=[],z=new Set;for(const F of C)for(const G of F.variants[w])ep(G,F,z)||O.push(new i.df(F,G));return O}queryRenderedTargets(s,h,g){const x={},w=(C,O,z,F)=>{const G=x[O.id]=x[O.id]||{sourceCache:O,layers:{},has3DLayers:!1};if(G.layers[C.fqid]=G.layers[C.fqid]||{styleLayer:C,targets:[]},C.is3D(!!this.terrain)&&(G.has3DLayers=!0),!F)return z.uniqueFeatureID=!1,void G.layers[C.fqid].targets.push(z);G.layers[C.fqid].targets.push(Object.assign({},z,{namespace:F.namespace,properties:F.properties,uniqueFeatureID:F.uniqueFeatureID}))};for(const C of h)if("featuresetId"in C.target){const{featuresetId:O,importId:z}=C.target,F=this.getFragmentStyle(z);if(!F||!F._featuresetSelectors)continue;const G=F._featuresetSelectors[O];if(!G){this.fire(new i.z(new Error(`The featureset '${O}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const U of G){const Z=F.getOwnLayer(U.layerId);Z&&!rc.has(Z.type)&&w(Z,F.getOwnLayerSourceCache(Z),C,U)}}else if("layerId"in C.target){const{layerId:O}=C.target,z=this.getLayer(O);if(!z||rc.has(z.type))continue;w(z,this.getLayerSourceCache(z),C)}const E=this._queryRenderedFeatures(s,x,g);return this._flattenAndSortRenderedFeatures(E)}_queryRenderedFeatures(s,h,g){const x=[],w=!!this.map._showQueryGeometry,E=Ji.createFromScreenPoints(s,g);for(const C in h){const O=Du(E,h[C],this._availableImages,g,w);Object.keys(O).length&&x.push(O)}if(this.placement)for(const C in h){if(!h[C].sourceCache._onlySymbols)continue;const O=tp(E.screenGeometry,h[C],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(O).length&&x.push(O)}return x}querySourceFeatures(s,h){const g=h&&h.filter;g&&this._validate(le,"querySourceFeatures.filter",g,null,h);let x=[];const w=this.getOwnSourceCaches(s);for(const E of w)x=x.concat(Wv(E,h));return x}addSourceType(s,h,g){return Es.getSourceType(s)?g(new Error(`A source type called "${s}" already exists.`)):(Es.setSourceType(s,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:h.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,h,g={}){this._checkLoaded();const x=this.light.getLight();let w=!1;for(const C in s)if(!i.bv(s[C],x[C])){w=!0;break}if(!w)return;const E=this._getTransitionParameters();this.light.setLight(s,h,g),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,h=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),h===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=s;const x=s.source==null;if(h===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){const C="terrain-dem-src";this.addSource(C,g.source),g=i.d7(g),g=i.l(g,{source:C})}const w=i.l({},g),E={};if(this.terrain&&x){w.source=this.terrain.get().source;const C=this.terrain?this.getFragmentStyle(this.terrain.scope):null;C&&(E.style=C.serialize())}if(this._validate(yt,"terrain",w,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&h!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,h),this.fire(new i.A("data",{dataType:"style"}))}else{const w=this.terrain,E=w.get();for(const C of Object.keys(i.a5.terrain))!g.hasOwnProperty(C)&&i.a5.terrain[C].default&&(g[C]=i.a5.terrain[C].default);for(const C in s)if(!i.bv(s[C],E[C])){w.set(s,this.options),this.stylesheet.terrain=s;const O=this._getTransitionParameters({duration:0});w.updateTransitions(O),this.fire(new i.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const h=this.fog=new er(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}_createSnow(s){const h=this.snow=new Xr(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}_createRain(s){const h=this.rain=new ni(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog;if(!i.bv(h.get(),s)){h.set(s,this.options),this.stylesheet.fog=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const h=this.snow;if(!i.bv(h.get(),s)){h.set(s,this.options),this.stylesheet.snow=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const h=this.rain;if(!i.bv(h.get(),s)){h.set(s,this.options),this.stylesheet.rain=h.get();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},h=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!h)return this._styleColorTheme.lut=null,void s();const g=this._evaluateColorThemeData(h);this._loadColorTheme(g).then(()=>{this.fire(new i.A("colorthemeset")),s()}).catch(x=>{i.w(`Couldn't set color theme: ${x}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,h){const g=this.getFragmentStyle(s);g&&(g._styleColorTheme.colorThemeOverride=h,g._reloadColorTheme())}_getTransitionParameters(s){return{now:i.q.now(),transition:i.l(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],h=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?s.push(g):h.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...h)}_createTerrain(s,h){const g=this.terrain=new ft(s,h,this.scope,this.options);h===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});g.updateTransitions(x)}_force3DLayerUpdate(){for(const s in this._layers){const h=this._layers[s];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const h=this._layers[s];h.type==="symbol"&&this._updateLayer(h)}}_validate(s,h,g,x,w={}){if(w&&w.validate===!1)return!1;const E=i.l({},this.serialize());return Xc(this,s.call(Na,i.l({key:h,style:E,value:g,styleSpec:i.a5},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.dg.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(s){const h=this.getSourceCaches(s);for(const g of h)g.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){const h=this.getSourceCaches(s);for(const g of h)g.resume(),g.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let h;this.directionalLight&&(h=t0(this.directionalLight));const g=new Set;for(const x in this._mergedLayers){const w=this._mergedLayers[x];w.hasElevation()&&!g.has(w.source)&&g.add(w.source)}for(const x in this._mergedSourceCaches){const w=this._mergedSourceCaches[x],E=g.has(w._source.id);w.update(s,void 0,void 0,h,E)}}_generateCollisionBoxes(){for(const s in this._sourceCaches){const h=this._sourceCaches[s];h.resume(),h.reload()}}_updatePlacement(s,h,g,x,w,E,C=!1){let O=!1,z=!1;const F={},G={};for(const U of this._mergedOrder){const Z=this._mergedLayers[U];if(Z.type!=="symbol")continue;const te=i.C(Z.source,Z.scope);let ee=F[te];if(!ee){const re=this.getLayerSourceCache(Z);if(!re)continue;const fe=re.getRenderableIds(!0).map(_e=>re.getTileByID(_e));G[te]=fe.slice(),ee=F[te]=fe.sort((_e,be)=>be.tileID.overscaledZ-_e.tileID.overscaledZ||(_e.tileID.isLessThan(be.tileID)?-1:1))}const oe=this.crossTileSymbolIndex.addLayer(Z,ee,h.center.lng,h.projection);O=O||oe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),C=C||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new i.A("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),h.zoom))&&(this.pauseablePlacement=new ha(h,this._mergedOrder,C,g,x,w,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,F,G,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),z=!0),O&&this.pauseablePlacement.placement.setStale()),z||O){this._buildingIndex.onNewFrame(h.zoom);for(let U=0;U<this._mergedOrder.length;U++){const Z=this._mergedLayers[this._mergedOrder[U]];if(Z.type!=="symbol")continue;const te=this.isLayerClipped(Z);this.placement.updateLayerOpacities(Z,F[i.C(Z.source,Z.scope)],U,te?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,h){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:w})=>w===s.id)!==-1)return void this.fire(new i.z(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!h)return g.push(s),this._loadImports([s],!0);const x=g.findIndex(({id:w})=>w===h);return x===-1&&this.fire(new i.z(new Error(`Import with id "${h}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,x).concat(s).concat(g.slice(x)),this._loadImports([s],!0,h)}updateImport(s,h){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(s);return x===-1?this:typeof h=="string"?(this.setImportUrl(s,h),this):(h.url&&h.url!==g[x].url&&this.setImportUrl(s,h.url),i.bv(h.config,g[x].config)||this.setImportConfig(s,h.config,h.data.schema),i.bv(h.data,g[x].data)||this.setImportData(s,h.data),this)}moveImport(s,h){this._checkLoaded();let g=this.stylesheet.imports||[];const x=this.getImportIndex(s);if(x===-1)return this;const w=this.getImportIndex(h);if(w===-1)return this;const E=g[x],C=this.fragments[x];return g=g.filter(({id:O})=>O!==s),this.fragments=this.fragments.filter(({id:O})=>O!==s),this.stylesheet.imports=g.slice(0,w).concat(E).concat(g.slice(w)),this.fragments=this.fragments.slice(0,w).concat(C).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(s,h){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(s);if(x===-1)return this;g[x].url=h;const w=this.fragments[x];return w.style=this._createFragmentStyle(g[x]),w.style.on("style.import.load",()=>this.mergeAll()),w.style.loadURL(h),this}setImportData(s,h){this._checkLoaded();const g=this.getImportIndex(s),x=this.stylesheet.imports||[];return g===-1?this:h?(this.fragments[g].style.setState(h),this._reloadImports(),this):(delete x[g].data,this.setImportUrl(s,x[g].url))}setImportConfig(s,h,g){this._checkLoaded();const x=this.getImportIndex(s),w=this.stylesheet.imports||[];if(x===-1)return this;h?w[x].config=h:delete w[x].config;const E=this.fragments[x];g&&E.style.stylesheet&&(E.style.stylesheet.schema=g);const C=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=h,E.style.updateConfig(h,C),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const h=this.stylesheet.imports||[],g=this.getImportIndex(s);g!==-1&&(h.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(s){const h=(this.stylesheet.imports||[]).findIndex(g=>g.id===s);return h===-1&&this.fire(new i.z(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),h}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const h in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[h];g&&s.push(g.getSource())}return s}getSource(s,h){const g=this.getSourceCache(s,h);return g&&g.getSource()}getLayerSource(s){const h=this.getLayerSourceCache(s);return h&&h.getSource()}getSourceCache(s,h){const g=i.C(s,h);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(s){const h=i.C(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[h]:this._mergedOtherSourceCaches[h]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);const h=[];return this._mergedOtherSourceCaches[s]&&h.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&h.push(this._mergedSymbolSourceCaches[s]),h}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const h in s){const g=s[h];g==="reload"?this.reloadSource(h):g==="clear"&&this.clearSource(h)}}updateLayers(s){const h=this._changes.getUpdatedPaintProperties();for(const g of h){const x=this.getLayer(g);x&&x.updateTransitions(s)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(s){this.stylesheet.glyphs=s,this.glyphManager.setURL(s,this.scope)}getImages(s,h,g){this.imageManager.getImages(h.images,h.scope,g),this._updateTilesForChangedImages();const x=E=>{if(E){const C=h.images.map(O=>i.I.toString(O));E.setDependencies(h.tileID.key,h.type,C)}},w=i.C(h.source,h.scope);x(this._mergedOtherSourceCaches[w]),x(this._mergedSymbolSourceCaches[w])}rasterizeImages(s,h,g){this.imageManager.rasterizeImages(h,g)}getGlyphs(s,h,g){this.glyphManager.getGlyphs(h.stacks,h.scope,g)}getResource(s,h,g){return i.dh(h,g)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const h=[];return this._otherSourceCaches[s]&&h.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&h.push(this._symbolSourceCaches[s]),h}_isSourceCacheLoaded(s){const h=this.getOwnSourceCaches(s);return h.length===0?(this.fire(new i.z(new Error(`There is no source with ID '${s}'`))),!1):h.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,h){if(!this._clipLayerPresent&&s.type!=="fill-extrusion")return!1;const g=s.type==="fill-extrusion"&&s.sourceLayer==="building";if(s.is3D(!!this.terrain)){if(g||h&&h.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Es.getSourceType=function(m){return Qf[m]},Es.setSourceType=function(m,s){Qf[m]=s},Es.registerForPluginStateChange=i.c$;var id=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,od=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,i0=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,yg="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",os=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,_g=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,jt=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,o0=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,vg=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,xg=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,a0=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Vu=[];sd(id,Vu),sd(i0,Vu),sd(od,Vu);const As={"_prelude_fog.vertex.glsl":_g,"_prelude_terrain.vertex.glsl":os,"_prelude_shadow.vertex.glsl":xg,"_prelude_fog.fragment.glsl":jt,"_prelude_shadow.fragment.glsl":a0,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":o0,"_prelude_raster_particle.glsl":vg},ad={};dr("",os),dr(jt,_g),dr(a0,xg),dr(o0,""),dr(vg,"");const Kc=dr(od,i0),mp=id;var Gu={background:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);color*=u_opacity;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=vec4(linearTosRGB(color.rgb),color.a);
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:dr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:dr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:dr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:dr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:dr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:dr(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:dr(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:dr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:dr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:dr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:dr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:dr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:dr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:dr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:dr(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(abs(v_z_offset) > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:dr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:dr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,yg),skyboxGradient:dr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,yg),skyboxCapture:dr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:dr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:dr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:dr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:dr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:dr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:dr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:dr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:dr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function sd(m,s){const h=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of h)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=g.split(" ");for(const w of x)s.includes(w)||s.push(w)}}function dr(m,s){const h=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let x=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(z=>{const F=z.split(" ");return F[F.length-1]}),x=[...new Set(x)]);const w={},E=[],C=[];if(m=m.replace(h,(z,F)=>(C.push(F),"")),(s=s.replace(h,(z,F)=>(E.push(F),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let O=[...Vu];sd(m,O),sd(s,O);for(const z of[...E,...C])As[z]||console.error(`Undefined include: ${z}`),ad[z]||(ad[z]=[],sd(As[z],ad[z])),O=[...O,...ad[z]];return{fragmentSource:m=m.replace(g,(z,F,G,U,Z)=>(w[Z]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
in ${G} ${U} ${Z};
#else
uniform ${G} ${U} u_${Z};
#endif
`:F==="initialize"?`
#ifdef HAS_UNIFORM_u_${Z}
    ${G} ${U} ${Z} = u_${Z};
#endif
`:F==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Z}
    in ${G} ${U} ${Z};
#endif
`:F==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(g,(z,F,G,U,Z)=>{const te=U==="float"?"vec2":U,ee=Z.match(/color/)?"color":te;return F==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${Z}
in ${G} ${U} a_${Z};
#endif
`:w[Z]?F==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
in ${G} ${te} a_${Z};
out ${G} ${U} ${Z};
#else
uniform ${G} ${U} u_${Z};
#endif
`:F==="initialize"?ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = a_${Z};
#else
    ${G} ${U} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = unpack_mix_${ee}(a_${Z}, u_${Z}_t);
#else
    ${G} ${U} ${Z} = u_${Z};
#endif
`:F==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Z}
    in ${G} ${U} a_${Z};
    out ${G} ${U} ${Z};
#endif
`:F==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Z}
    ${Z} = a_${Z};
#endif
`:void 0:F==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
in ${G} ${te} a_${Z};
#else
uniform ${G} ${U} u_${Z};
#endif
`:F==="define-instanced"?ee==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${Z}0;
in vec4 a_${Z}1;
in vec4 a_${Z}2;
in vec4 a_${Z}3;
#else
uniform ${G} ${U} u_${Z};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${G} ${te} a_${Z};
#else
uniform ${G} ${U} u_${Z};
#endif
`:F==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${Z}
    ${G} ${U} ${Z} = a_${Z};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${G} ${U} ${Z} = a_${Z};
#else
    ${G} ${U} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${G} ${U} ${Z} = unpack_mix_${ee}(a_${Z}, u_${Z}_t);
#else
    ${G} ${U} ${Z} = u_${Z};
#endif
`}),staticAttributes:x,usedDefines:O,vertexIncludes:E,fragmentIncludes:C}}class s0{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,h,g,x,w,E,C,O){this.context=s;let z=this.boundPaintVertexBuffers.length!==x.length;for(let G=0;!z&&G<x.length;G++)this.boundPaintVertexBuffers[G]!==x[G]&&(z=!0);let F=this.boundDynamicVertexBuffers.length!==C.length;for(let G=0;!F&&G<C.length;G++)this.boundDynamicVertexBuffers[G]!==C[G]&&(F=!0);if(!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==g||z||F||this.boundIndexBuffer!==w||this.boundVertexOffset!==E)this.freshBind(h,g,x,w,E,C,O);else{s.bindVertexArrayOES.set(this.vao);for(const G of C)G&&(G.bind(),O&&G.instanceCount&&G.setVertexAttribDivisor(s.gl,h,O));w&&w.dynamicDraw&&w.bind()}}freshBind(s,h,g,x,w,E,C){const O=s.numAttributes,z=this.context,F=z.gl;this.vao&&this.destroy(),this.vao=z.gl.createVertexArray(),z.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=E,h.enableAttributes(F,s),h.bind(),h.setVertexAttribPointers(F,s,w);for(const G of g)G.enableAttributes(F,s),G.bind(),G.setVertexAttribPointers(F,s,w);for(const G of E)G&&(G.enableAttributes(F,s),G.bind(),G.setVertexAttribPointers(F,s,w),C&&G.instanceCount&&G.setVertexAttribDivisor(F,s,C));x&&x.bind(),z.currentNumAttributes=O}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function gI(m,s){const h=Math.pow(2,s.canonical.z),g=s.canonical.y;return[new i.ac(0,g/h).toLngLat().lat,new i.ac(0,(g+1)/h).toLngLat().lat]}function aS(m,s,h,g,x,w,E){const C=m.context,O=C.gl,z=h.hillshadeFBO;if(!z)return;m.prepareDrawTile();const F=m.isTileAffectedByFog(s),G=m.getOrCreateProgram("hillshade",{overrideFog:F});C.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,z.colorAttachment.get());const U=((oe,re,fe,_e)=>{const be=fe.paint.get("hillshade-shadow-color"),Pe=fe.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ee=fe.paint.get("hillshade-highlight-color"),Ae=fe.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",we=fe.paint.get("hillshade-accent-color"),Me=fe.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",ke=fe.paint.get("hillshade-emissive-strength");let Qe=i.al(fe.paint.get("hillshade-illumination-direction"));if(fe.paint.get("hillshade-illumination-anchor")==="viewport")Qe-=oe.transform.angle;else if(oe.style&&oe.style.enable3dLights()&&oe.style.directionalLight){const mt=oe.style.directionalLight.properties.get("direction"),dt=i.cR(mt.x,mt.y,mt.z);Qe=i.al(dt[1])}const qe=!oe.options.moving;return{u_matrix:_e||oe.transform.calculateProjMatrix(re.tileID.toUnwrapped(),qe),u_image:0,u_latrange:gI(0,re.tileID),u_light:[fe.paint.get("hillshade-exaggeration"),Qe],u_shadow:be.toRenderColor(Pe?null:fe.lut),u_highlight:Ee.toRenderColor(Ae?null:fe.lut),u_emissive_strength:ke,u_accent:we.toRenderColor(Me?null:fe.lut)}})(m,h,g,m.terrain?s.projMatrix:null);m.uploadCommonUniforms(C,G,s.toUnwrapped());const{tileBoundsBuffer:Z,tileBoundsIndexBuffer:te,tileBoundsSegments:ee}=m.getTileBoundsBuffers(h);G.draw(m,O.TRIANGLES,x,w,E,Mn.disabled,U,g.id,Z,te,ee)}function l0(m,s,h){if(!s.needsDEMTextureUpload)return;const g=m.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||m.getTileTexture(h.stride);const w=h.getPixels();s.demTexture?s.demTexture.update(w,{premultiply:!1}):s.demTexture=new i.T(g,w,x.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function c0(m,s,h){const g=m.context,x=g.gl;if(!s.dem)return;const w=s.dem;if(g.activeTexture.set(x.TEXTURE1),l0(m,s,w),!s.demTexture)return;s.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const E=w.dim;g.activeTexture.set(x.TEXTURE0);let C=s.hillshadeFBO;if(!C){const U=new i.T(g,{width:E,height:E,data:null},x.RGBA8);U.bind(x.LINEAR,x.CLAMP_TO_EDGE),C=s.hillshadeFBO=g.createFramebuffer(E,E,!0,"renderbuffer"),C.colorAttachment.set(U.texture)}g.bindFramebuffer.set(C.framebuffer),g.viewport.set([0,0,E,E]);const{tileBoundsBuffer:O,tileBoundsIndexBuffer:z,tileBoundsSegments:F}=m.getMercatorTileBoundsBuffers(),G=[];m.linearFloatFilteringSupported()&&G.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:G}).draw(m,x.TRIANGLES,Jt.disabled,In.disabled,Zn.unblended,Mn.disabled,((U,Z)=>{const te=Z.stride,ee=i.bz();return i.c5(ee,0,i.aj,-i.aj,0,0,1),i.bo(ee,ee,[0,-i.aj,0]),{u_matrix:ee,u_image:1,u_dimension:[te,te],u_zoom:U.overscaledZ}})(s.tileID,w),h.id,O,z,F),s.needsHillshadePrepare=!1}class Ii{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class yI extends Ii{getDefault(){return i.am.transparent}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class _I extends Ii{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class vI extends Ii{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class sS extends Ii{getDefault(){return[!0,!0,!0,!0]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class xI extends Ii{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class bg extends Ii{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class bI extends Ii{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const h=this.current;(s.func!==h.func||s.ref!==h.ref||s.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class lS extends Ii{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class u0 extends Ii{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=s,this.dirty=!1}}class wg extends Ii{getDefault(){return[0,1]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class h0 extends Ii{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=s,this.dirty=!1}}class Wu extends Ii{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class d0 extends Ii{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.BLEND):h.disable(h.BLEND),this.current=s,this.dirty=!1}}class cS extends Ii{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class ld extends Ii{getDefault(){return i.am.transparent}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class gp extends Ii{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class Sg extends Ii{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=s,this.dirty=!1}}class Tg extends Ii{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class cd extends Ii{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let Eg=class extends Ii{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class f0 extends Ii{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class uS extends Ii{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class p0 extends Ii{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Ag extends Ii{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class yp extends Ii{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class hS extends Ii{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class dS extends Ii{getDefault(){return null}set(s){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class fS extends Ii{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class ud extends Ii{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class pS extends Ii{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class wI extends Ii{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class m0 extends Ii{constructor(s,h){super(s),this.context=s,this.parent=h}getDefault(){return null}}class SI extends m0{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Pg extends m0{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class g0 extends m0{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,this.attachment(),h.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class y0 extends Pg{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const _0=(m,s,h)=>({u_matrix:m,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:h}),v0=(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:h,u_zoom_transition:x,u_merc_center:w,u_image0:0,u_frustum_tl:E,u_frustum_tr:C,u_frustum_br:O,u_frustum_bl:z,u_globe_pos:F,u_globe_radius:G,u_viewport:U,u_grid_matrix:ee?Float32Array.from(ee):new Float32Array(9),u_skirt_height:Z,u_far_z_cutoff:te});function x0(m,s){return m!=null&&s!=null&&!(!m.hasData()||!s.hasData())&&m.demTexture!=null&&s.demTexture!=null&&m.tileID.key!==s.tileID.key}const hd=new class{constructor(){this.operations={}}newMorphing(m,s,h,g,x){if(m in this.operations){const w=this.operations[m];w.to.tileID.key!==h.tileID.key&&(w.queued=h)}else this.operations[m]={startTime:g,phase:0,duration:x,from:s,to:h,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const s=this.operations[m];return{from:s.from,to:s.to,phase:s.phase}}update(m){for(const s in this.operations){const h=this.operations[s];for(h.phase=(m-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,m)){delete this.operations[s];break}}}_nextOp(m,s){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=s,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},dd={0:null,1:"TERRAIN_VERTEX_MORPHING"};function fd(m,s,h){if(s===0)return 0;const g=s<1&&h===514?.25/s:1;return 6*Math.pow(1.5,22-m)*Math.max(s,1)*g}function mS(m,s){const h=1<<m.z;return!s&&(m.x===0||m.x===h-1)||m.y===0||m.y===h-1}const Pa=m=>({u_matrix:m});function _p(m,s,h,g,x){if(x>0){const w=i.q.now(),E=(w-m.timeAdded)/x,C=s?(w-s.timeAdded)/x:-1,O=h.getSource(),z=g.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),F=!s||Math.abs(s.tileID.overscaledZ-z)>Math.abs(m.tileID.overscaledZ-z),G=F&&m.refreshedUponExpiration?1:i.aD(F?E:1-C,0,1);return m.refreshedUponExpiration&&E>=1&&(m.refreshedUponExpiration=!1),s?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}class Cg extends ca{constructor(s){const h={type:"raster-dem",maxzoom:s.transform.maxZoom},g=new i.D(i.d0(),null),x=Zh("mock-dem",h,g,s.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,h){s.state="loaded",h(null)}}class Ig extends ca{constructor(s){const h=Zh("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new i.D(i.d0(),null),s.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,h,g){if(s.freezeTileCoverage)return;this.transform=s;const x=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,E)=>{if(w[E.key]="",!this._tiles[E.key]){const C=new tc(E,this._source.tileSize*E.overscaleFactor(),s.tileZoom);C.state="loaded",this._tiles[E.key]=C}return w},{});for(const w in this._tiles)w in x||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(s){const h=this.proxyCachedFBO[s];if(h!==void 0){const g=Object.values(h);this.renderCachePool.push(...g),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Mg extends i.aM{constructor(s,h,g){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=h,this.projMatrix=g}}class Og extends i.dt{constructor(s,h){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,x,w]=function(O){const z=new i.ba,F=new i.a_,G=131;z.reserve(17161),F.reserve(33800);const U=i.aj/128,Z=i.aj+U/2,te=Z+U;for(let oe=-U;oe<te;oe+=U)for(let re=-U;re<te;re+=U){const fe=re<0||re>Z||oe<0||oe>Z?24575:0,_e=i.aD(Math.round(re),0,i.aj),be=i.aD(Math.round(oe),0,i.aj);z.emplaceBack(_e+fe,be)}const ee=(oe,re)=>{const fe=re*G+oe;F.emplaceBack(fe+1,fe,fe+G),F.emplaceBack(fe+G,fe+G+1,fe+1)};for(let oe=1;oe<129;oe++)for(let re=1;re<129;re++)ee(re,oe);return[0,129].forEach(oe=>{for(let re=0;re<130;re++)ee(re,oe),ee(oe,re)}),[z,F,32768]}(),E=s.context;this.gridBuffer=E.createVertexBuffer(g,i.bc.members),this.gridIndexBuffer=E.createIndexBuffer(x),this.gridSegments=i.bd.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=i.bd.simpleSegment(0,0,g.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ig(h.map),this.orthoMatrix=i.bz(),i.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.aj,0,i.aj,0,1);const C=E.gl;this._overlapStencilMode=new In({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Cg(h.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,h,g){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const x=s.terrain.properties,w=s.terrain.drapeRenderMode===0,E=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const C=s.terrain&&s.terrain.scope,O=x.get("source"),z=w?this._mockSourceCache:s.getSourceCache(O,C);if(!z)return void i.w(`Couldn't find terrain source "${O}".`);if(this.sourceCache=z,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(h):x.get("exaggeration"),!h.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const F=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const G=this.getScaledDemTileSize();this.sourceCache.update(h,G,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,F(),this._initializing=!0),F(),h.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0,this._previousZoom=h.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const h=this._previousCameraAltitude,g=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=g;const x=h!=null?g-h:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const w=s.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(w);let C=w-this._previousZoom;const O=this._previousUpdateTimestamp;let z=w;this._evaluationZoom!=null&&(z=this._evaluationZoom,Math.abs(w-z)>.5&&(C=.5*(w-z+C)),C*x<0&&(z+=C)),this._evaluationZoom=z;const F=E.getExaggeration(z),G=F===E.getExaggeration(Math.max(0,z-.1));if(G&&Math.abs(F-this._exaggeration)<.01)return F;let U=Math.min(.1,.00375*(this._updateTimestamp-O));return(G||F<.1||Math.abs(C)<1e-4)&&(U=Math.min(.2,4*U)),i.ai(this._exaggeration,F,U)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(i.ac.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=h.getIds().map(O=>{const z=h.getTileByID(O).tileID;return z.projMatrix=g.calculateProjMatrix(z.toUnwrapped()),z});(function(O,z){const F=z.transform.pointCoordinate(z.transform.getCameraPoint()),G=new i.P(F.x,F.y);O.sort((U,Z)=>{if(Z.overscaledZ-U.overscaledZ)return Z.overscaledZ-U.overscaledZ;const te=new i.P(U.canonical.x+(1<<U.canonical.z)*U.wrap,U.canonical.y),ee=new i.P(Z.canonical.x+(1<<Z.canonical.z)*Z.wrap,Z.canonical.y),oe=G.mult(1<<U.canonical.z);return oe.x-=.5,oe.y-=.5,oe.distSqr(te)-oe.distSqr(ee)})})(x,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},x.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const O in E){const z=E[O];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,s[O],w),z.usedForTerrain))continue;const F=s[O];z.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[h.id]=x.map(O=>new Mg(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const C={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const z=this.terrainTileForTile[O.key];if(!z)continue;const F=z.tileID.key;F in C||(this._visibleDemTiles.push(z),C[F]=F)}}_assignTerrainTiles(s){this._initializing||s.forEach(h=>{if(this.terrainTileForTile[h.key])return;const g=this._findTileCoveringTileID(h,this.sourceCache);g&&(this.terrainTileForTile[h.key]=g)})}_prepareDEMTextures(){const s=this.painter.context,h=s.gl;for(const g in this.terrainTileForTile){const x=this.terrainTileForTile[g],w=x.dem;!w||x.demTexture&&!x.needsDEMTextureUpload||(s.activeTexture.set(h.TEXTURE1),l0(this.painter,x,w))}}_prepareDemTileUniforms(s,h,g,x){if(!h||h.demTexture==null)return!1;const w=s.tileID.canonical,E=Math.pow(2,h.tileID.canonical.z-w.z),C=x||"";return g[`u_dem_tl${C}`]=[w.x*E%1,w.y*E%1],g[`u_dem_scale${C}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const h=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;const w=x.dem.tree.minimums[0];return w>0&&s++,g+w},0);return s?h/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,h=s.gl;s.activeTexture.set(h.TEXTURE2);const g=this._getLoadedAreaMinimum(),x=new i.du({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(x,{premultiply:!1}):w=this._emptyDEMTexture=new i.T(s,x,h.R32F,{premultiply:!1}),w}setupElevationDraw(s,h,g){const x=this.painter.context,w=x.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let C=null,O=null,z=1;if(g&&g.morphing&&this._useVertexMorphing){const Z=g.morphing.srcDemTile,te=g.morphing.dstDemTile;z=g.morphing.phase,Z&&te&&(this._prepareDemTileUniforms(s,Z,E,"_prev")&&(O=Z),this._prepareDemTileUniforms(s,te,E)&&(C=te))}const F=Z=>Z&&Z.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let G=null;var U;if(this.enabled?O&&C?(G=C.demTexture,x.activeTexture.set(w.TEXTURE4),O.demTexture.bind(F(O),w.CLAMP_TO_EDGE),E.u_dem_lerp=z):(C=this.terrainTileForTile[s.tileID.key],G=this._prepareDemTileUniforms(s,C,E)?C.demTexture:this.emptyDEMTexture):G=this.emptyDEMTexture,x.activeTexture.set(w.TEXTURE2),G&&(E.u_dem_size=(U=G).size[0]===1?1:U.size[0]-2,G.bind(F(C),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,h,E),g&&g.useMeterToDem&&C){const Z=(1<<C.tileID.canonical.z)*i.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=Z}if(g&&g.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),h.setTerrainUniformValues(x,E),this.painter.transform.projection.name==="globe"){const Z=this.globeUniformValues(this.painter.transform,s.tileID.canonical,g&&g.useDenormalizedUpVectorScale);h.setGlobeUniformValues(x,Z)}}globeUniformValues(s,h,g){const x=s.projection;return{u_tile_tl_up:x.upVector(h,0,0),u_tile_tr_up:x.upVector(h,i.aj,0),u_tile_br_up:x.upVector(h,i.aj,i.aj),u_tile_bl_up:x.upVector(h,0,i.aj),u_tile_up_scale:g?i.dv(1):x.upVectorScale(h,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const h=this.painter,g=this.painter.context;s.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,w,E,C,O){if(x.transform.projection.name==="globe")(function(z,F,G,U,Z){const te=z.context,ee=te.gl;let oe,re;const fe=z.transform,_e=i.dl(z,te,fe),be=(mt,dt)=>{if(re===dt)return;const Ot=[dd[dt],"PROJECTION_GLOBE_VIEW"];_e&&Ot.push("CUSTOM_ANTIALIASING");const Ze=z.isTileAffectedByFog(mt);oe=z.getOrCreateProgram("globeRaster",{defines:Ot,overrideFog:Ze}),re=dt},Pe=z.colorModeForRenderPass(),Ee=new Jt(ee.LEQUAL,Jt.ReadWrite,z.depthRangeFor3D);hd.update(Z);const Ae=i.dm(fe),we=[i.ay(fe.center.lng),i.aH(fe.center.lat)],Me=z.globeSharedBuffers,ke=[fe.width*i.q.devicePixelRatio,fe.height*i.q.devicePixelRatio],Qe=Float32Array.from(fe.globeMatrix),qe={useDenormalizedUpVectorScale:!0};{const mt=z.transform,dt=fd(mt.zoom,F.exaggeration(),F.sourceCache._source.tileSize);re=-1;const Ot=ee.TRIANGLES;for(const Ze of U){const et=G.getTile(Ze),We=In.disabled,vt=F.prevTerrainTileForTile[Ze.key],at=F.terrainTileForTile[Ze.key];x0(vt,at)&&hd.newMorphing(Ze.key,vt,at,Z,250),te.activeTexture.set(ee.TEXTURE0),et.texture&&et.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const Tt=hd.getMorphValuesForProxy(Ze.key),gt=Tt?1:0;Tt&&i.L(qe,{morphing:{srcDemTile:Tt.from,dstDemTile:Tt.to,phase:i.dk(Tt.phase)}});const Et=i.dn(Ze.canonical),At=i.dp(Et.getCenter().lat),Yt=i.dq(Ze.canonical,Et,At,mt.worldSize/mt._pixelsPerMercatorPixel),an=i.bh(i.dr(Ze.canonical)),Xt=v0(mt.expandedFarZProjMatrix,Qe,Ae,an,i.ah(mt.zoom),we,mt.frustumCorners.TL,mt.frustumCorners.TR,mt.frustumCorners.BR,mt.frustumCorners.BL,mt.globeCenterInViewSpace,mt.globeRadius,ke,dt,mt._farZ,Yt);if(be(Ze,gt),oe&&(F.setupElevationDraw(et,oe,qe),z.uploadCommonUniforms(te,oe,Ze.toUnwrapped()),Me)){const[ln,Qt,Sn]=Me.getGridBuffers(At,dt!==0);oe.draw(z,Ot,Ee,We,Pe,Mn.backCCW,Xt,"globe_raster",ln,Qt,Sn)}}}if(Me&&(z.renderDefaultNorthPole||z.renderDefaultSouthPole)){const mt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];_e&&mt.push("CUSTOM_ANTIALIASING"),oe=z.getOrCreateProgram("globeRaster",{defines:mt});for(const dt of U){const{x:Ot,y:Ze,z:et}=dt.canonical,We=Ze===0,vt=Ze===(1<<et)-1,[at,Tt,gt,Et]=Me.getPoleBuffers(et,!1);if(Et&&(We||vt)){const At=G.getTile(dt);te.activeTexture.set(ee.TEXTURE0),At.texture&&At.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);let Yt=i.ds(et,Ot,fe);const an=i.bh(i.dr(dt.canonical)),Xt=(ln,Qt)=>ln.draw(z,ee.TRIANGLES,Ee,In.disabled,Pe,Mn.disabled,v0(fe.expandedFarZProjMatrix,Yt,Yt,an,0,we,fe.frustumCorners.TL,fe.frustumCorners.TR,fe.frustumCorners.BR,fe.frustumCorners.BL,fe.globeCenterInViewSpace,fe.globeRadius,ke,0,fe._farZ),"globe_pole_raster",Qt,gt,Et);F.setupElevationDraw(At,oe,qe),z.uploadCommonUniforms(te,oe,dt.toUnwrapped()),We&&z.renderDefaultNorthPole&&Xt(oe,at),vt&&z.renderDefaultSouthPole&&(Yt=i.cE(i.bz(),Yt,[1,-1,1]),Xt(oe,Tt))}}}})(x,w,E,C,O);else{const z=x.context,F=z.gl;let G,U;const Z=x.shadowRenderer,te=Uu(x,x.longestCutoffRange),ee=Pe=>{if(U===Pe)return;const Ee=[];Ee.push(dd[Pe]),te.shouldRenderCutoff&&Ee.push("RENDER_CUTOFF"),Z&&(Ee.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Z.useNormalOffset&&Ee.push("NORMAL_OFFSET")),G=x.getOrCreateProgram("terrainRaster",{defines:Ee}),U=Pe},oe=x.colorModeForRenderPass(),re=new Jt(F.LEQUAL,Jt.ReadWrite,x.depthRangeFor3D);hd.update(O);const fe=x.transform,_e=fd(fe.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let be=[0,0,0];if(Z){const Pe=x.style.directionalLight,Ee=x.style.ambientLight;Pe&&Ee&&(be=Sl(x.style,Pe,Ee))}{U=-1;const Pe=F.TRIANGLES,[Ee,Ae]=[w.gridIndexBuffer,w.gridSegments];for(const we of C){const Me=E.getTile(we),ke=In.disabled,Qe=w.prevTerrainTileForTile[we.key],qe=w.terrainTileForTile[we.key];x0(Qe,qe)&&hd.newMorphing(we.key,Qe,qe,O,250),z.activeTexture.set(F.TEXTURE0),Me.texture&&Me.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE);const mt=hd.getMorphValuesForProxy(we.key),dt=mt?1:0;let Ot;mt&&(Ot={morphing:{srcDemTile:mt.from,dstDemTile:mt.to,phase:i.dk(mt.phase)}});const Ze=_0(we.projMatrix,mS(we.canonical,fe.renderWorldCopies)?_e/10:_e,be);if(ee(dt),!G)continue;w.setupElevationDraw(Me,G,Ot);const et=we.toUnwrapped();Z&&Z.setupShadows(et,G),x.uploadCommonUniforms(z,G,et,null,te),G.draw(x,Pe,re,ke,oe,Mn.backCCW,Ze,"terrain_raster",w.gridBuffer,Ee,Ae)}}}}(h,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const h=this.painter,g=this.painter.context,x=this.proxySourceCache,w=this.proxiedCoords[x.id],E=this._drapedRenderBatches.shift(),C=h.style.order,O=[];let z=0;for(const F of w){const G=x.getTileByID(F.proxyTileKey),U=x.proxyCachedFBO[F.key]?x.proxyCachedFBO[F.key][s]:void 0,Z=U!==void 0?x.renderCache[U]:this.pool[z++],te=U!==void 0;if(G.texture=Z.tex,te&&!Z.dirty){O.push(G.tileID);continue}let ee;g.bindFramebuffer.set(Z.fb.framebuffer),this.renderedToTile=!1,Z.dirty&&(g.clear({color:i.am.transparent,stencil:0}),Z.dirty=!1);for(let oe=E.start;oe<=E.end;++oe){const re=h.style._mergedLayers[C[oe]];if(re.isHidden(h.transform.zoom))continue;const fe=h.style.getLayerSourceCache(re),_e=fe?this.proxyToSource[F.key][fe.id]:[F];if(!_e)continue;const be=_e;g.viewport.set([0,0,Z.fb.width,Z.fb.height]),ee!==(fe?fe.id:null)&&(this._setupStencil(Z,_e,re,fe),ee=fe?fe.id:null),h.renderLayer(h,fe,re,be)}if(this._drapedRenderBatches.length===0)for(const oe of this._pendingGroundEffectLayers){const re=h.style._mergedLayers[C[oe]];if(re.isHidden(h.transform.zoom))continue;const fe=h.style.getLayerSourceCache(re),_e=fe?this.proxyToSource[F.key][fe.id]:[F];if(!_e)continue;const be=_e;g.viewport.set([0,0,Z.fb.width,Z.fb.height]),ee!==(fe?fe.id:null)&&(this._setupStencil(Z,_e,re,fe),ee=fe?fe.id:null),h.renderLayer(h,fe,re,be)}this.renderedToTile?(Z.dirty=!0,O.push(G.tileID)):te||--z,z===5&&(z=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,h.width,h.height]),E.end+1}postRender(){}isLayerOrderingCorrect(s){const h=s.order.length;let g=-1,x=h;for(let w=0;w<h;++w)this._style.isLayerDraped(s._mergedLayers[s.order[w]])?g=Math.max(g,w):x=Math.min(x,w);return x>g}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{s=Math.min(s,h.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,h,g){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const E=w.tileID,C=1<<E.overscaledZ,{x:O,y:z}=E.canonical,F=O/C,G=(O+1)/C,U=z/C,Z=(z+1)/C;return{minx:F,miny:U,maxx:G,maxy:Z,t:w.dem.tree.raycastRoot(F,U,G,Z,s,h,g),tile:w}});x.sort((w,E)=>(w.t!==null?w.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const w of x){if(w.t==null)return null;const E=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,s,h,g);if(E!=null)return E}return null}_createFBO(){const s=this.painter.context,h=s.gl,g=this.drapeBufferSize;s.activeTexture.set(h.TEXTURE0);const x=new i.T(s,{width:g[0],height:g[1],data:null},h.RGBA8);x.bind(h.LINEAR,h.CLAMP_TO_EDGE);const w=s.createFramebuffer(g[0],g[1],!0,null);return w.colorAttachment.set(x.texture),w.depthAttachment=new y0(s,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:w,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const h=this._style._mergedLayers[s],g=h.isHidden(this.painter.transform.zoom);return h.type==="hillshade"||h.type==="custom"?!g&&h.shouldRedrape():!g&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const g of this._style.getSources())if(g instanceof Vo){s=!0;break}if(!s)return;const h={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],w=this._style.getLayerSourceCache(x);if(w&&!h[w.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof i.ab){h[w.id]=!0;for(const E of this.proxyCoords){const C=this.proxyToSource[E.key][w.id];if(C)for(const O of C)this._clearRenderCacheForTile(w.id,O)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof wl){s=!0;break}if(!s)return;const h={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],w=this._style.getLayerSourceCache(x);if(!w||h[w.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const E=x.paint.get("raster-fade-duration");for(const C of this.proxyCoords){const O=this.proxyToSource[C.key][w.id];if(O)for(const z of O){const F=_p(w.getTile(z),w.findLoadedParent(z,0),w,this.painter.transform,E);(F.opacity!==1||F.mix!==0)&&this._clearRenderCacheForTile(w.id,z)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,h=s.length;if(h===0)return;const g=[];this._pendingGroundEffectLayers=[];let x,w=0,E=this._style._mergedLayers[s[w]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++w<h;)E=this._style._mergedLayers[s[w]];for(;w<h;++w){const C=this._style._mergedLayers[s[w]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?x===void 0&&(x=w):(C.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),x!==void 0&&(g.push({start:x,end:w-1}),x=void 0)))}if(x!==void 0&&g.push({start:x,end:w-1}),g.length!==0){const C=g[g.length-1];this._pendingGroundEffectLayers.every(O=>O>C.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(s){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const E=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let C=0;C<E.length;++C){const O=Object.values(E[C]);h.renderCachePool.push(...O)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,x=this._tilesDirty;for(let E=g.length-1;E>=0;E--){const C=g[E];if(h.getTileByID(C.key),h.proxyCachedFBO[C.key]!==void 0){const O=s[C.key],z=this.proxyToSource[C.key];let F=0;for(const G in z){const U=z[G],Z=O[G];if(!Z||Z.length!==U.length||U.some((te,ee)=>te!==Z[ee]||x[G]&&x[G].hasOwnProperty(te.key))){F=-1;break}++F}for(const G in h.proxyCachedFBO[C.key])h.renderCache[h.proxyCachedFBO[C.key][G]].dirty=F<0||F!==Object.values(O).length}}const w=[...this._drapedRenderBatches];w.sort((E,C)=>C.end-C.start-(E.end-E.start));for(const E of w)for(const C of g){if(h.proxyCachedFBO[C.key])continue;let O=h.renderCachePool.pop();O===void 0&&h.renderCache.length<50&&(O=h.renderCache.length,h.renderCache.push(this._createFBO())),O!==void 0&&(h.proxyCachedFBO[C.key]={},h.proxyCachedFBO[C.key][E.start]=O,h.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(s,h,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,E=w.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let C;if(g.isTileClipped())C=h.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):In.disabled}_renderTileClippingMasks(s,h){const g=this.painter,x=this.painter.context,w=x.gl;g._tileClippingMaskIDs={},x.setColorMode(Zn.disabled),x.setDepthMode(Jt.disabled);const E=g.getOrCreateProgram("clippingMask");for(const C of s){const O=g._tileClippingMaskIDs[C.key]=--h;E.draw(g,w.TRIANGLES,Jt.disabled,new In({func:w.ALWAYS,mask:0},O,255,w.KEEP,w.KEEP,w.REPLACE),Zn.disabled,Mn.disabled,Pa(C.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(s){const h=this.painter.transform;if(s.x<0||s.x>h.width||s.y<0||s.y>h.height)return null;const g=[s.x,s.y,1,1];i.aA(g,g,h.pixelMatrixInverse),i.cw(g,g,1/g[3]),g[0]/=h.worldSize,g[1]/=h.worldSize;const x=h._camera.position,w=i.c6(1,h.center.lat),E=[x[0],x[1],x[2]/w,0],C=i.cY([],g.slice(0,3),E);i.au(C,C);const O=this.raycast(E,C,this._exaggeration);return O!==null&&O?(i.bF(E,E,C,O),E[3]=E[2],E[2]*=w,E):null}_setupProxiedCoordsForOrtho(s,h,g){if(s.getSource()instanceof i.aP)return this._setupProxiedCoordsForImageSource(s,h,g);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const x=this.proxiedCoords[s.id]=[],w=this.proxyCoords;for(let O=0;O<w.length;O++){const z=w[O],F=this._findTileCoveringTileID(z,s);if(F){const G=this._createProxiedId(z,F,g[z.key]&&g[z.key][s.id]);x.push(G),this.proxyToSource[z.key][s.id]=[G]}}let E=!1;const C=new Set;for(let O=0;O<h.length;O++){const z=s.getTile(h[O]);if(!z||!z.hasData())continue;const F=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if(F&&F.tileID.canonical.z!==z.tileID.canonical.z){const G=this.proxyToSource[F.tileID.key][s.id],U=this._createProxiedId(F.tileID,z,g[F.tileID.key]&&g[F.tileID.key][s.id]);G?G.splice(G.length-1,0,U):this.proxyToSource[F.tileID.key][s.id]=[U];const Z=this.proxyToSource[F.tileID.key][s.id];C.has(Z)||C.add(Z),x.push(U),E=!0}}if(this._sourceTilesOverlap[s.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const O of C)O.sort((z,F)=>F.overscaledZ-z.overscaledZ)}_setupProxiedCoordsForImageSource(s,h,g){if(!s.getSource().loaded())return;const x=this.proxiedCoords[s.id]=[],w=this.proxyCoords,E=s.getSource(),C=E.tileID;if(!C)return;const O=new i.P(C.x,C.y)._div(1<<C.z),z=E.coordinates.map(i.ac.fromLngLat).reduce((G,U)=>(G.min.x=Math.min(G.min.x,U.x-O.x),G.min.y=Math.min(G.min.y,U.y-O.y),G.max.x=Math.max(G.max.x,U.x-O.x),G.max.y=Math.max(G.max.y,U.y-O.y),G),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),F=(G,U)=>{const Z=G.wrap+G.canonical.x/(1<<G.canonical.z),te=G.canonical.y/(1<<G.canonical.z),ee=i.aj/(1<<G.canonical.z),oe=U.wrap+U.canonical.x/(1<<U.canonical.z),re=U.canonical.y/(1<<U.canonical.z);return Z+ee<oe+z.min.x||Z>oe+z.max.x||te+ee<re+z.min.y||te>re+z.max.y};for(let G=0;G<w.length;G++){const U=w[G];for(let Z=0;Z<h.length;Z++){const te=s.getTile(h[Z]);if(!te||!te.hasData()||F(U,te.tileID))continue;const ee=this._createProxiedId(U,te,g[U.key]&&g[U.key][s.id]),oe=this.proxyToSource[U.key][s.id];oe?oe.push(ee):this.proxyToSource[U.key][s.id]=[ee],x.push(ee)}}}_createProxiedId(s,h,g){let x=this.orthoMatrix;if(g){const w=g.find(E=>E.key===h.tileID.key);if(w)return w}if(h.tileID.key!==s.key){const w=s.canonical.z-h.tileID.canonical.z;let E,C,O;x=i.bz();const z=h.tileID.wrap-s.wrap<<s.overscaledZ;w>0?(E=i.aj>>w,C=E*((h.tileID.canonical.x<<w)-s.canonical.x+z),O=E*((h.tileID.canonical.y<<w)-s.canonical.y)):(E=i.aj<<-w,C=i.aj*(h.tileID.canonical.x-(s.canonical.x+z<<-w)),O=i.aj*(h.tileID.canonical.y-(s.canonical.y<<-w))),i.c5(x,0,E,0,E,0,1),i.bo(x,x,[C,O,0])}return new Mg(h.tileID,s.key,x)}_findTileCoveringTileID(s,h){let g=h.getTile(s);if(g&&g.hasData())return g;const x=this._findCoveringTileCache[h.id],w=x[s.key];if(g=w?h.getTileByID(w):null,g&&g.hasData()||w===null)return g;let E=g?g.tileID:s,C=E.overscaledZ;const O=h.getSource().minzoom,z=[];if(!w){const G=h.getSource().maxzoom;if(s.canonical.z>=G){const U=s.canonical.z-G;h.getSource().reparseOverscaled?(C=Math.max(s.canonical.z+2,h.transform.tileZoom),E=new i.aM(C,s.wrap,G,s.canonical.x>>U,s.canonical.y>>U)):U!==0&&(C=G,E=new i.aM(C,s.wrap,G,s.canonical.x>>U,s.canonical.y>>U))}E.key!==s.key&&(z.push(E.key),g=h.getTile(E))}const F=G=>{z.forEach(U=>{x[U]=G}),z.length=0};for(C-=1;C>=O&&(!g||!g.hasData());C--){g&&F(g.tileID.key);const G=E.calculateScaledKey(C);if(g=h.getTileByID(G),g&&g.hasData())break;const U=x[G];if(U===null)break;U===void 0?z.push(G):g=h.getTileByID(U)}return F(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,h){let g=this._tilesDirty[s];g||(g=this._tilesDirty[s]={}),g[h.key]=!0}}function b0(m,s,h){const g=function(C,O,z){const F=i.bE(O,C),G=i.bE(z,[.2126,.7152,.0722]),U=(te,ee,oe)=>(1-oe)*te+oe*ee,Z=U(1-.3*Math.min(G,1),1,Math.min(F+1,1));return U(.92,1,Math.asin(i.aD(O[2],-1,1))/Math.PI+.5)*Z}(m,[0,0,1],s),x=[0,0,0];i.b$(x,h.slice(0,3),g);const w=[0,0,0];i.b$(w,s.slice(0,3),m[2]);const E=[0,0,0];return i.cU(E,x,w),i.cX(E)}const kg=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],w0=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class Rg{static cacheKey(s,h,g,x){let w=`${h}${x?x.cacheKey:""}`;for(const E of g)s.usedDefines.includes(E)&&(w+=`/${E}`);return w}constructor(s,h,g,x,w,E){const C=s.gl;this.program=C.createProgram(),this.configuration=x,this.name=h,this.fixedDefines=[...E];const O=x?x.getBinderAttributes():[],z=(g.staticAttributes||[]).concat(O);let F=x?x.defines():[];F=F.concat(E.map(oe=>`#define ${oe}`));const G=`#version 300 es
`;let U=G+F.concat("precision mediump float;",mp,Kc.fragmentSource).join(`
`);for(const oe of g.fragmentIncludes)U+=`
${As[oe]}`;U+=`
${g.fragmentSource}`;let Z=G+F.concat("precision highp float;",mp,Kc.vertexSource).join(`
`);for(const oe of g.vertexIncludes)Z+=`
${As[oe]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&g.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(Z+=`
uniform int u_instanceID;
`),Z+=`
${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(Z=Z.replaceAll("gl_InstanceID","u_instanceID"));const te=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(te,U),C.compileShader(te),C.attachShader(this.program,te);const ee=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(ee,Z),C.compileShader(ee),C.attachShader(this.program,ee),this.attributes={},this.numAttributes=z.length;for(let oe=0;oe<this.numAttributes;oe++)if(z[oe]){const re=z[oe].startsWith("a_")?z[oe]:`a_${z[oe]}`;C.bindAttribLocation(this.program,oe,re),this.attributes[re]=oe}C.linkProgram(this.program),C.deleteShader(ee),C.deleteShader(te),this.fixedUniforms=w(s),this.binderUniforms=x?x.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(oe=>({u_instanceID:new i.cc(oe)}))(s)),(E.includes("TERRAIN")||h.indexOf("symbol")!==-1||h.indexOf("circle")!==-1)&&(this.terrainUniforms=(oe=>({u_dem:new i.cc(oe),u_dem_prev:new i.cc(oe),u_dem_tl:new i.c9(oe),u_dem_scale:new i.cb(oe),u_dem_tl_prev:new i.c9(oe),u_dem_scale_prev:new i.cb(oe),u_dem_size:new i.cb(oe),u_dem_lerp:new i.cb(oe),u_exaggeration:new i.cb(oe),u_depth:new i.cc(oe),u_depth_size_inv:new i.c9(oe),u_depth_range_unpack:new i.c9(oe),u_occluder_half_size:new i.cb(oe),u_occlusion_depth_offset:new i.cb(oe),u_meter_to_dem:new i.cb(oe),u_label_plane_matrix_inv:new i.c8(oe)}))(s)),E.includes("GLOBE")&&(this.globeUniforms=(oe=>({u_tile_tl_up:new i.ca(oe),u_tile_tr_up:new i.ca(oe),u_tile_br_up:new i.ca(oe),u_tile_bl_up:new i.ca(oe),u_tile_up_scale:new i.cb(oe)}))(s)),E.includes("FOG")&&(this.fogUniforms=(oe=>({u_fog_matrix:new i.c8(oe),u_fog_range:new i.c9(oe),u_fog_color:new i.cQ(oe),u_fog_horizon_blend:new i.cb(oe),u_fog_vertical_limit:new i.c9(oe),u_fog_temporal_offset:new i.cb(oe),u_frustum_tl:new i.ca(oe),u_frustum_tr:new i.ca(oe),u_frustum_br:new i.ca(oe),u_frustum_bl:new i.ca(oe),u_globe_pos:new i.ca(oe),u_globe_radius:new i.cb(oe),u_globe_transition:new i.cb(oe),u_is_globe:new i.cc(oe),u_viewport:new i.c9(oe)}))(s)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(oe=>({u_cutoff_params:new i.cQ(oe)}))(s)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(oe=>({u_lighting_ambient_color:new i.ca(oe),u_lighting_directional_dir:new i.ca(oe),u_lighting_directional_color:new i.ca(oe),u_ground_radiance:new i.ca(oe)}))(s)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(oe=>({u_light_matrix_0:new i.c8(oe),u_light_matrix_1:new i.c8(oe),u_fade_range:new i.c9(oe),u_shadow_normal_offset:new i.ca(oe),u_shadow_intensity:new i.cb(oe),u_shadow_texel_size:new i.cb(oe),u_shadow_map_resolution:new i.cb(oe),u_shadow_direction:new i.ca(oe),u_shadow_bias:new i.ca(oe),u_shadowmap_0:new i.cc(oe),u_shadowmap_1:new i.cc(oe)}))(s))}}setTerrainUniformValues(s,h){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)g[x]&&g[x].set(this.program,x,h[x])}}setGlobeUniformValues(s,h){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)g[x]&&g[x].set(this.program,x,h[x])}}setFogUniformValues(s,h){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)g[x].set(this.program,x,h[x])}}setCutoffUniformValues(s,h){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)g[x].set(this.program,x,h[x])}}setLightsUniformValues(s,h){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in h)g[x].set(this.program,x,h[x])}}setShadowUniformValues(s,h){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;s.program.set(this.program);for(const x in h)g[x].set(this.program,x,h[x])}_drawDebugWireframe(s,h,g,x,w,E,C,O,z,F){const G=s.options.wireframe;if(G.terrain===!1&&G.layers2D===!1&&G.layers3D===!1)return;const U=s.context;if(!(!(!G.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!G.layers2D||s._terrain&&s._terrain.renderingToTexture||!kg.includes(this.name))||!(!G.layers3D||!w0.includes(this.name))))return;const Z=U.gl,te=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,w,U);if(!te)return;const ee=[...this.fixedDefines];ee.push("DEBUG_WIREFRAME");const oe=s.getOrCreateProgram(this.name,{config:this.configuration,defines:ee});U.program.set(oe.program);const re=(be,Pe,Ee)=>{if(Pe[be]&&Ee[be])for(const Ae in Pe[be])Ee[be][Ae]&&Ee[be][Ae].set(Ee.program,Ae,Pe[be][Ae].current)};z&&z.setUniforms(oe.program,U,oe.binderUniforms,C,{zoom:O}),re("fixedUniforms",this,oe),re("terrainUniforms",this,oe),re("globeUniforms",this,oe),re("fogUniforms",this,oe),re("lightsUniforms",this,oe),re("shadowUniforms",this,oe),te.bind(),U.setColorMode(new Zn([Z.ONE,Z.ONE_MINUS_SRC_ALPHA,Z.ZERO,Z.ONE],i.am.transparent,[!0,!0,!0,!1])),U.setDepthMode(new Jt(h.func===Z.LESS?Z.LEQUAL:h.func,Jt.ReadOnly,h.range)),U.setStencilMode(In.disabled);const fe=3*E.primitiveLength*2,_e=3*E.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const be=F||1;for(let Pe=0;Pe<be;++Pe)oe.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Pe),Z.drawElements(Z.LINES,fe,Z.UNSIGNED_SHORT,_e)}else F&&F>1?Z.drawElementsInstanced(Z.LINES,fe,Z.UNSIGNED_SHORT,_e,F):Z.drawElements(Z.LINES,fe,Z.UNSIGNED_SHORT,_e);w.bind(),U.program.set(this.program),U.setDepthMode(h),U.setStencilMode(g),U.setColorMode(x)}checkUniforms(s,h,g){if(this.fixedDefines.includes(h)){for(const x of Object.keys(g))if(!g[x].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${x} not set but required by ${h} being defined`)}}draw(s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe){const re=s.context,fe=re.gl;if(this.failedToCreate)return;re.program.set(this.program),re.setDepthMode(g),re.setStencilMode(x),re.setColorMode(w),re.setCullFace(E);for(const Pe of Object.keys(this.fixedUniforms))this.fixedUniforms[Pe].set(this.program,Pe,C[Pe]);te&&te.setUniforms(this.program,re,this.binderUniforms,U,{zoom:Z});const _e={[fe.POINTS]:1,[fe.LINES]:2,[fe.TRIANGLES]:3,[fe.LINE_STRIP]:1}[h];this.checkUniforms(O,"RENDER_SHADOWS",this.shadowUniforms);const be=oe&&oe>0?1:void 0;for(const Pe of G.get()){const Ee=Pe.vaos||(Pe.vaos={});if((Ee[O]||(Ee[O]=new s0)).bind(re,this,z,te?te.getPaintVertexBuffers():[],F,Pe.vertexOffset,ee||[],be),this.forceManualRenderingForInstanceIDShaders){const Ae=oe||1;for(let we=0;we<Ae;++we)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",we),F?fe.drawElements(h,Pe.primitiveLength*_e,fe.UNSIGNED_SHORT,Pe.primitiveOffset*_e*2):fe.drawArrays(h,Pe.vertexOffset,Pe.vertexLength)}else oe&&oe>1?fe.drawElementsInstanced(h,Pe.primitiveLength*_e,fe.UNSIGNED_SHORT,Pe.primitiveOffset*_e*2,oe):F?fe.drawElements(h,Pe.primitiveLength*_e,fe.UNSIGNED_SHORT,Pe.primitiveOffset*_e*2):fe.drawArrays(h,Pe.vertexOffset,Pe.vertexLength);h===fe.TRIANGLES&&F&&this._drawDebugWireframe(s,g,x,w,F,Pe,U,Z,te,oe)}}}function vp(m,s,h=0){const g=Math.pow(2,s.tileID.overscaledZ),x=s.tileSize*Math.pow(2,m.transform.tileZoom)/g,w=x*(s.tileID.canonical.x+s.tileID.wrap*g),E=x*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.aw(s,1,m.transform.tileZoom),u_pixel_coord_upper:[w>>16,E>>16],u_pixel_coord_lower:[65535&w,65535&E],u_pattern_transition:h}}const xp={terrain:0,flat:1},gS=i.bz(),Hu=(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe,re)=>{const fe=s.style.light,_e=fe.properties.get("position"),be=[_e.x,_e.y,_e.z],Pe=i.dx();fe.properties.get("anchor")==="viewport"&&(i.dy(Pe,-s.transform.angle),i.dz(be,be,Pe));const Ee=fe.properties.get("color"),Ae=s.transform,we={u_matrix:m,u_lightpos:be,u_lightintensity:fe.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+h,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gS,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:xp[z],u_base_type:xp[F],u_ao:x,u_edge_radius:w,u_width_scale:E,u_flood_light_color:te,u_vertical_scale:ee,u_flood_light_intensity:oe,u_ground_shadow_factor:re};return Ae.projection.name==="globe"&&(we.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],we.u_zoom_transition=G,we.u_inv_rot_matrix=Z,we.u_merc_center=U,we.u_up_dir=Ae.projection.upVector(new i.cp(0,0,0),U[0]*i.aj,U[1]*i.aj),we.u_height_lift=O),we},TI=(m,s,h,g,x,w)=>({u_matrix:m,u_edge_radius:s,u_width_scale:h,u_vertical_scale:g,u_height_type:xp[x],u_base_type:xp[w]}),EI=(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe,re)=>{const fe=Hu(m,s,h,g,x,w,E,C,z,F,G,U,Z,te,ee,oe,1,[0,0,0]),_e={u_height_factor:-Math.pow(2,C.overscaledZ)/O.tileSize/8};return i.l(fe,vp(s,O,re),_e)},yS=(m,s,h)=>({u_matrix:m,u_emissive_strength:s,u_ground_shadow_factor:h}),_S=(m,s,h,g,x,w=0)=>i.l(yS(m,s,x),vp(h,g,w)),AI=(m,s,h,g)=>({u_matrix:m,u_world:h,u_emissive_strength:s,u_ground_shadow_factor:g}),PI=(m,s,h,g,x,w,E=0)=>i.l(_S(m,s,h,g,w,E),{u_world:x}),S0=(m,s)=>({u_matrix:m,u_ground_shadow_factor:s}),bp=(m,s,h,g,x)=>({u_matrix:m,u_camera_pos:[s[0],s[1],s[2]],u_depth_bias:h,u_height_scale:g,u_reset_depth:x}),vS=(m,s,h,g)=>{const x=i.aj/h.tileSize;return{u_matrix:m,u_camera_to_center_distance:s.getCameraToCenterDistance(g),u_extrude_scale:[s.pixelsToGLUnits[0]/x,s.pixelsToGLUnits[1]/x]}},qu=(m,s,h=1)=>({u_matrix:m,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:h}),xS=i.bz(),bS=(m,s,h,g,x,w,E)=>{const C=m.transform,O=C.projection.name==="globe",z=O?i.dA(C.zoom,s.canonical)*C._pixelsPerMercatorPixel:i.aw(h,1,w),F={u_matrix:s.projMatrix,u_extrude_scale:z,u_intensity:E,u_inv_rot_matrix:xS,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){F.u_inv_rot_matrix=g,F.u_merc_center=x,F.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],F.u_zoom_transition=i.ah(C.zoom);const G=x[0]*i.aj,U=x[1]*i.aj;F.u_up_dir=C.projection.upVector(new i.cp(0,0,0),G,U)}return F};function T0(m,[s,h,g,x],[w,E]){if(w===E)return[0,0,0,0];const C=255*(m-1)/(m*(E-w));return[s*C,h*C,g*C,x*C]}function Dg(m,s,[h,g]){return h===g?0:.5/m+(s-h)*(m-1)/(m*(g-h))}const Yc=(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe,re,fe,_e,be)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:h,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:w,u_scale_parent:z,u_fade_t:F.mix,u_opacity:F.opacity*G.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:G.paint.get("raster-brightness-min"),u_brightness_high:G.paint.get("raster-brightness-max"),u_saturation_factor:i.dB(G.paint.get("raster-saturation")),u_contrast_factor:i.dC(G.paint.get("raster-contrast")),u_spin_weights:wS(G.paint.get("raster-hue-rotate")),u_perspective_transform:U,u_raster_elevation:Z,u_zoom_transition:E,u_merc_center:C,u_cutoff_params:O,u_colorization_mix:T0(i.dD,ee,re),u_colorization_offset:Dg(i.dD,oe,re),u_color_ramp:te,u_texture_offset:[_e/(fe+2*_e),fe/(fe+2*_e)],u_texture_res:[fe+2*_e,fe+2*_e],u_emissive_strength:be});function wS(m){m*=Math.PI/180;const s=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*s-h+1)/3,(Math.sqrt(3)*s-h+1)/3]}const as=.05,E0=(m,s,h,g,x,w,E,C,O,z,F,G)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:h,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:w,u_scale_parent:z,u_fade_t:F.mix,u_opacity:F.opacity,u_image0:0,u_image1:1,u_raster_elevation:G,u_zoom_transition:E,u_merc_center:C,u_cutoff_params:O}),Lg=(m,s,h,g,x,w,E,C,O,z)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_tile_offset:h,u_velocity:g,u_color_ramp:w,u_velocity_res:x,u_max_speed:E,u_uv_offset:C,u_data_scale:[255*O[0],255*O[1]],u_data_offset:z,u_particle_pos_scale:1.1,u_particle_pos_offset:[as,as]}),SS=(m,s,h,g,x,w,E,C,O,z)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_velocity:h,u_velocity_res:g,u_max_speed:x,u_speed_factor:w,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:C,u_data_scale:[255*O[0],255*O[1]],u_data_offset:z,u_particle_pos_scale:1.1,u_particle_pos_offset:[as,as]}),A0=i.bz(),zg=(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe,re,fe,_e,be,Pe,Ee)=>{const Ae=x.transform,we={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Ae.getCameraToCenterDistance(fe),u_rotate_symbol:+h,u_aspect_ratio:Ae.width/Ae.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:E,u_coord_matrix:C,u_is_text:+z,u_elevation_from_sea:O?1:0,u_pitch_with_map:+g,u_texsize:F,u_texsize_icon:G,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:A0,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:A0,u_up_vector:[0,-1,0],u_color_adj_mat:be,u_icon_transition:Pe||0,u_gamma_scale:g?x.transform.getCameraToCenterDistance(fe)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:+U,u_scale_factor:Ee||1,u_ground_shadow_factor:_e,u_inv_matrix:i.bi(i.bz(),E)};return fe.name==="globe"&&(we.u_tile_id=[Z.canonical.x,Z.canonical.y,1<<Z.canonical.z],we.u_zoom_transition=te,we.u_inv_rot_matrix=oe,we.u_merc_center=ee,we.u_camera_forward=Ae._camera.forward(),we.u_ecef_origin=i.dE(Ae.globeMatrix,Z.toUnwrapped()),we.u_tile_matrix=Float32Array.from(Ae.globeMatrix),we.u_up_vector=re),we},Ng=(m,s,h,g)=>({u_matrix:m,u_emissive_strength:s,u_opacity:h,u_color:g}),TS=(m,s,h,g,x,w,E,C,O)=>i.l(function(z,F,G,U,Z,te){const{width:ee,height:oe}=U.imageManager.getPixelSize(F),re=Math.pow(2,te.tileID.overscaledZ),fe=te.tileSize*Math.pow(2,U.transform.tileZoom)/re,_e=fe*(te.tileID.canonical.x+te.tileID.wrap*re),be=fe*te.tileID.canonical.y;return{u_image:0,u_pattern_tl:G.tl,u_pattern_br:G.br,u_texsize:[ee,oe],u_pattern_size:G.displaySize,u_pattern_units_to_pixels:Z?[U.transform.width,-1*U.transform.height]:[1/i.aw(te,1,U.transform.tileZoom),1/i.aw(te,1,U.transform.tileZoom)],u_pixel_coord_upper:[_e>>16,be>>16],u_pixel_coord_lower:[65535&_e,65535&be]}}(0,w,E,g,C,O),{u_matrix:m,u_emissive_strength:s,u_opacity:h}),Fg=new Float32Array(i.bx([])),Zu=(m,s,h,g,x,w,E,C,O,z,F,G,U,Z=[0,0,0],te)=>{const ee=x.style.light,oe=ee.properties.get("position"),re=[-oe.x,-oe.y,oe.z],fe=i.dx();ee.properties.get("anchor")==="viewport"&&(i.dy(fe,-x.transform.angle),i.dz(re,re,fe));const _e=F.alphaMode==="MASK",be=ee.properties.get("color").toRenderColor(null),Pe=U.paint.get("model-ambient-occlusion-intensity"),Ee=U.paint.get("model-color").constantOr(i.am.white).toRenderColor(null),Ae=U.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:m,u_lighting_matrix:s,u_normal_matrix:h,u_node_matrix:g||Fg,u_lightpos:re,u_lightintensity:ee.properties.get("intensity"),u_lightcolor:[be.r,be.g,be.b],u_camera_pos:Z,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+_e,u_alphaCutoff:F.alphaCutoff,u_baseColorFactor:[E.r,E.g,E.b,E.a],u_emissiveFactor:[C[0],C[1],C[2],1],u_metallicFactor:O,u_roughnessFactor:z,u_baseColorTexture:fa.BaseColor,u_metallicRoughnessTexture:fa.MetallicRoughness,u_normalTexture:fa.Normal,u_occlusionTexture:fa.Occlusion,u_emissionTexture:fa.Emission,u_lutTexture:fa.LUT,u_color_mix:[Ee.r,Ee.g,Ee.b,Ae],u_aoIntensity:Pe,u_emissive_strength:G,u_occlusionTextureTransform:te||[0,0,0,0]}},ES=(m,s=Fg,h=Fg)=>({u_matrix:m,u_instance:s,u_node_matrix:h}),CI={fillExtrusion:m=>({u_matrix:new i.c8(m),u_lightpos:new i.ca(m),u_lightintensity:new i.cb(m),u_lightcolor:new i.ca(m),u_vertical_gradient:new i.cb(m),u_opacity:new i.cb(m),u_edge_radius:new i.cb(m),u_width_scale:new i.cb(m),u_ao:new i.c9(m),u_height_type:new i.cc(m),u_base_type:new i.cc(m),u_tile_id:new i.ca(m),u_zoom_transition:new i.cb(m),u_inv_rot_matrix:new i.c8(m),u_merc_center:new i.c9(m),u_up_dir:new i.ca(m),u_height_lift:new i.cb(m),u_flood_light_color:new i.ca(m),u_vertical_scale:new i.cb(m),u_flood_light_intensity:new i.cb(m),u_ground_shadow_factor:new i.ca(m)}),fillExtrusionDepth:m=>({u_matrix:new i.c8(m),u_edge_radius:new i.cb(m),u_width_scale:new i.cb(m),u_vertical_scale:new i.cb(m),u_height_type:new i.cc(m),u_base_type:new i.cc(m)}),fillExtrusionPattern:m=>({u_matrix:new i.c8(m),u_lightpos:new i.ca(m),u_lightintensity:new i.cb(m),u_lightcolor:new i.ca(m),u_vertical_gradient:new i.cb(m),u_height_factor:new i.cb(m),u_edge_radius:new i.cb(m),u_width_scale:new i.cb(m),u_ao:new i.c9(m),u_height_type:new i.cc(m),u_base_type:new i.cc(m),u_tile_id:new i.ca(m),u_zoom_transition:new i.cb(m),u_inv_rot_matrix:new i.c8(m),u_merc_center:new i.c9(m),u_up_dir:new i.ca(m),u_height_lift:new i.cb(m),u_image:new i.cc(m),u_texsize:new i.c9(m),u_pixel_coord_upper:new i.c9(m),u_pixel_coord_lower:new i.c9(m),u_tile_units_to_pixels:new i.cb(m),u_opacity:new i.cb(m),u_pattern_transition:new i.cb(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new i.c8(m),u_opacity:new i.cb(m),u_ao_pass:new i.cb(m),u_meter_to_tile:new i.cb(m),u_ao:new i.c9(m),u_flood_light_intensity:new i.cb(m),u_flood_light_color:new i.ca(m),u_attenuation:new i.cb(m),u_edge_radius:new i.cb(m),u_fb:new i.cc(m),u_fb_size:new i.cb(m),u_dynamic_offset:new i.cb(m)}),fill:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_ground_shadow_factor:new i.ca(m)}),fillPattern:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_image:new i.cc(m),u_texsize:new i.c9(m),u_pixel_coord_upper:new i.c9(m),u_pixel_coord_lower:new i.c9(m),u_tile_units_to_pixels:new i.cb(m),u_ground_shadow_factor:new i.ca(m),u_pattern_transition:new i.cb(m)}),fillOutline:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_world:new i.c9(m),u_ground_shadow_factor:new i.ca(m)}),fillOutlinePattern:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_world:new i.c9(m),u_image:new i.cc(m),u_texsize:new i.c9(m),u_pixel_coord_upper:new i.c9(m),u_pixel_coord_lower:new i.c9(m),u_tile_units_to_pixels:new i.cb(m),u_ground_shadow_factor:new i.ca(m),u_pattern_transition:new i.cb(m)}),building:m=>({u_matrix:new i.c8(m),u_normal_matrix:new i.c8(m),u_opacity:new i.cb(m)}),buildingDepth:m=>({u_matrix:new i.c8(m)}),elevatedStructuresDepth:m=>({u_matrix:new i.c8(m),u_depth_bias:new i.cb(m)}),elevatedStructures:m=>({u_matrix:new i.c8(m),u_ground_shadow_factor:new i.ca(m)}),elevatedStructuresDepthReconstruct:m=>({u_matrix:new i.c8(m),u_camera_pos:new i.ca(m),u_depth_bias:new i.cb(m),u_height_scale:new i.cb(m),u_reset_depth:new i.cb(m)}),circle:i.dF,collisionBox:m=>({u_matrix:new i.c8(m),u_camera_to_center_distance:new i.cb(m),u_extrude_scale:new i.c9(m)}),collisionCircle:m=>({u_matrix:new i.c8(m),u_inv_matrix:new i.c8(m),u_camera_to_center_distance:new i.cb(m),u_viewport_size:new i.c9(m)}),debug:m=>({u_color:new i.di(m),u_matrix:new i.c8(m),u_overlay:new i.cc(m),u_overlay_scale:new i.cb(m)}),clippingMask:m=>({u_matrix:new i.c8(m)}),heatmap:m=>({u_extrude_scale:new i.cb(m),u_intensity:new i.cb(m),u_matrix:new i.c8(m),u_inv_rot_matrix:new i.c8(m),u_merc_center:new i.c9(m),u_tile_id:new i.ca(m),u_zoom_transition:new i.cb(m),u_up_dir:new i.ca(m)}),heatmapTexture:m=>({u_image:new i.cc(m),u_color_ramp:new i.cc(m),u_opacity:new i.cb(m)}),hillshade:m=>({u_matrix:new i.c8(m),u_image:new i.cc(m),u_latrange:new i.c9(m),u_light:new i.c9(m),u_shadow:new i.di(m),u_highlight:new i.di(m),u_emissive_strength:new i.cb(m),u_accent:new i.di(m)}),hillshadePrepare:m=>({u_matrix:new i.c8(m),u_image:new i.cc(m),u_dimension:new i.c9(m),u_zoom:new i.cb(m)}),line:i.dG,linePattern:i.dH,raster:m=>({u_matrix:new i.c8(m),u_normalize_matrix:new i.c8(m),u_globe_matrix:new i.c8(m),u_merc_matrix:new i.c8(m),u_grid_matrix:new i.dj(m),u_tl_parent:new i.c9(m),u_scale_parent:new i.cb(m),u_fade_t:new i.cb(m),u_opacity:new i.cb(m),u_image0:new i.cc(m),u_image1:new i.cc(m),u_brightness_low:new i.cb(m),u_brightness_high:new i.cb(m),u_saturation_factor:new i.cb(m),u_contrast_factor:new i.cb(m),u_spin_weights:new i.ca(m),u_perspective_transform:new i.c9(m),u_raster_elevation:new i.cb(m),u_zoom_transition:new i.cb(m),u_merc_center:new i.c9(m),u_cutoff_params:new i.cQ(m),u_colorization_mix:new i.cQ(m),u_colorization_offset:new i.cb(m),u_color_ramp:new i.cc(m),u_texture_offset:new i.c9(m),u_texture_res:new i.c9(m),u_emissive_strength:new i.cb(m)}),rasterParticle:m=>({u_matrix:new i.c8(m),u_normalize_matrix:new i.c8(m),u_globe_matrix:new i.c8(m),u_merc_matrix:new i.c8(m),u_grid_matrix:new i.dj(m),u_tl_parent:new i.c9(m),u_scale_parent:new i.cb(m),u_fade_t:new i.cb(m),u_opacity:new i.cb(m),u_image0:new i.cc(m),u_image1:new i.cc(m),u_raster_elevation:new i.cb(m),u_zoom_transition:new i.cb(m),u_merc_center:new i.c9(m),u_cutoff_params:new i.cQ(m)}),rasterParticleTexture:m=>({u_texture:new i.cc(m),u_opacity:new i.cb(m)}),rasterParticleDraw:m=>({u_particle_texture:new i.cc(m),u_particle_texture_side_len:new i.cb(m),u_tile_offset:new i.c9(m),u_velocity:new i.cc(m),u_color_ramp:new i.cc(m),u_velocity_res:new i.c9(m),u_max_speed:new i.cb(m),u_uv_offset:new i.c9(m),u_data_scale:new i.c9(m),u_data_offset:new i.cb(m),u_particle_pos_scale:new i.cb(m),u_particle_pos_offset:new i.c9(m)}),rasterParticleUpdate:m=>({u_particle_texture:new i.cc(m),u_particle_texture_side_len:new i.cb(m),u_velocity:new i.cc(m),u_velocity_res:new i.c9(m),u_max_speed:new i.cb(m),u_speed_factor:new i.cb(m),u_reset_rate:new i.cb(m),u_rand_seed:new i.cb(m),u_uv_offset:new i.c9(m),u_data_scale:new i.c9(m),u_data_offset:new i.cb(m),u_particle_pos_scale:new i.cb(m),u_particle_pos_offset:new i.c9(m)}),symbol:m=>({u_is_size_zoom_constant:new i.cc(m),u_is_size_feature_constant:new i.cc(m),u_size_t:new i.cb(m),u_size:new i.cb(m),u_camera_to_center_distance:new i.cb(m),u_rotate_symbol:new i.cc(m),u_aspect_ratio:new i.cb(m),u_fade_change:new i.cb(m),u_matrix:new i.c8(m),u_label_plane_matrix:new i.c8(m),u_coord_matrix:new i.c8(m),u_is_text:new i.cc(m),u_elevation_from_sea:new i.cc(m),u_pitch_with_map:new i.cc(m),u_texsize:new i.c9(m),u_texsize_icon:new i.c9(m),u_texture:new i.cc(m),u_texture_icon:new i.cc(m),u_gamma_scale:new i.cb(m),u_device_pixel_ratio:new i.cb(m),u_tile_id:new i.ca(m),u_zoom_transition:new i.cb(m),u_inv_rot_matrix:new i.c8(m),u_merc_center:new i.c9(m),u_camera_forward:new i.ca(m),u_tile_matrix:new i.c8(m),u_up_vector:new i.ca(m),u_ecef_origin:new i.ca(m),u_is_halo:new i.cc(m),u_icon_transition:new i.cb(m),u_color_adj_mat:new i.c8(m),u_scale_factor:new i.cb(m),u_ground_shadow_factor:new i.ca(m),u_inv_matrix:new i.c8(m)}),background:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_opacity:new i.cb(m),u_color:new i.di(m)}),backgroundPattern:m=>({u_matrix:new i.c8(m),u_emissive_strength:new i.cb(m),u_opacity:new i.cb(m),u_image:new i.cc(m),u_pattern_tl:new i.c9(m),u_pattern_br:new i.c9(m),u_texsize:new i.c9(m),u_pattern_size:new i.c9(m),u_pixel_coord_upper:new i.c9(m),u_pixel_coord_lower:new i.c9(m),u_pattern_units_to_pixels:new i.c9(m)}),terrainRaster:m=>({u_matrix:new i.c8(m),u_image0:new i.cc(m),u_skirt_height:new i.cb(m),u_ground_shadow_factor:new i.ca(m)}),skybox:m=>({u_matrix:new i.c8(m),u_sun_direction:new i.ca(m),u_cubemap:new i.cc(m),u_opacity:new i.cb(m),u_temporal_offset:new i.cb(m)}),skyboxGradient:m=>({u_matrix:new i.c8(m),u_color_ramp:new i.cc(m),u_center_direction:new i.ca(m),u_radius:new i.cb(m),u_opacity:new i.cb(m),u_temporal_offset:new i.cb(m)}),skyboxCapture:m=>({u_matrix_3f:new i.dj(m),u_sun_direction:new i.ca(m),u_sun_intensity:new i.cb(m),u_color_tint_r:new i.cQ(m),u_color_tint_m:new i.cQ(m),u_luminance:new i.cb(m)}),globeRaster:m=>({u_proj_matrix:new i.c8(m),u_globe_matrix:new i.c8(m),u_normalize_matrix:new i.c8(m),u_merc_matrix:new i.c8(m),u_zoom_transition:new i.cb(m),u_merc_center:new i.c9(m),u_image0:new i.cc(m),u_grid_matrix:new i.dj(m),u_skirt_height:new i.cb(m),u_far_z_cutoff:new i.cb(m),u_frustum_tl:new i.ca(m),u_frustum_tr:new i.ca(m),u_frustum_br:new i.ca(m),u_frustum_bl:new i.ca(m),u_globe_pos:new i.ca(m),u_globe_radius:new i.cb(m),u_viewport:new i.c9(m)}),globeAtmosphere:m=>({u_frustum_tl:new i.ca(m),u_frustum_tr:new i.ca(m),u_frustum_br:new i.ca(m),u_frustum_bl:new i.ca(m),u_horizon:new i.cb(m),u_transition:new i.cb(m),u_fadeout_range:new i.cb(m),u_color:new i.cQ(m),u_high_color:new i.cQ(m),u_space_color:new i.cQ(m),u_temporal_offset:new i.cb(m),u_horizon_angle:new i.cb(m)}),model:m=>({u_matrix:new i.c8(m),u_lighting_matrix:new i.c8(m),u_normal_matrix:new i.c8(m),u_node_matrix:new i.c8(m),u_lightpos:new i.ca(m),u_lightintensity:new i.cb(m),u_lightcolor:new i.ca(m),u_camera_pos:new i.ca(m),u_opacity:new i.cb(m),u_baseColorFactor:new i.cQ(m),u_emissiveFactor:new i.cQ(m),u_metallicFactor:new i.cb(m),u_roughnessFactor:new i.cb(m),u_baseTextureIsAlpha:new i.cc(m),u_alphaMask:new i.cc(m),u_alphaCutoff:new i.cb(m),u_baseColorTexture:new i.cc(m),u_metallicRoughnessTexture:new i.cc(m),u_normalTexture:new i.cc(m),u_occlusionTexture:new i.cc(m),u_emissionTexture:new i.cc(m),u_lutTexture:new i.cc(m),u_color_mix:new i.cQ(m),u_aoIntensity:new i.cb(m),u_emissive_strength:new i.cb(m),u_occlusionTextureTransform:new i.cQ(m)}),modelDepth:m=>({u_matrix:new i.c8(m),u_instance:new i.c8(m),u_node_matrix:new i.c8(m)}),groundShadow:m=>({u_matrix:new i.c8(m),u_ground_shadow_factor:new i.ca(m)}),stars:m=>({u_matrix:new i.c8(m),u_up:new i.ca(m),u_right:new i.ca(m),u_intensity_multiplier:new i.cb(m)}),snowParticle:m=>({u_modelview:new i.c8(m),u_projection:new i.c8(m),u_time:new i.cb(m),u_cam_pos:new i.ca(m),u_velocityConeAperture:new i.cb(m),u_velocity:new i.cb(m),u_horizontalOscillationRadius:new i.cb(m),u_horizontalOscillationRate:new i.cb(m),u_boxSize:new i.cb(m),u_billboardSize:new i.cb(m),u_simpleShapeParameters:new i.c9(m),u_screenSize:new i.c9(m),u_thinningCenterPos:new i.c9(m),u_thinningShape:new i.ca(m),u_thinningAffectedRatio:new i.cb(m),u_thinningParticleOffset:new i.cb(m),u_particleColor:new i.cQ(m),u_direction:new i.ca(m)}),rainParticle:m=>({u_modelview:new i.c8(m),u_projection:new i.c8(m),u_time:new i.cb(m),u_cam_pos:new i.ca(m),u_texScreen:new i.cc(m),u_velocityConeAperture:new i.cb(m),u_velocity:new i.cb(m),u_boxSize:new i.cb(m),u_rainDropletSize:new i.c9(m),u_distortionStrength:new i.cb(m),u_rainDirection:new i.ca(m),u_color:new i.cQ(m),u_screenSize:new i.c9(m),u_thinningCenterPos:new i.c9(m),u_thinningShape:new i.ca(m),u_thinningAffectedRatio:new i.cb(m),u_thinningParticleOffset:new i.cb(m),u_shapeDirectionalPower:new i.cb(m),u_shapeNormalPower:new i.cb(m),u_mode:new i.cb(m)}),vignette:m=>({u_vignetteShape:new i.ca(m),u_vignetteColor:new i.cQ(m)}),occlusion:m=>({u_matrix:new i.c8(m),u_anchorPos:new i.ca(m),u_screenSizePx:new i.c9(m),u_occluderSizePx:new i.c9(m),u_color:new i.cQ(m)})};class ic{constructor(s,h,g,x){this.id=ic.uniqueIdxCounter,ic.uniqueIdxCounter++,this.context=s;const w=s.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||x||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=ic.uniqueIdxCounter,ic.uniqueIdxCounter++;const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}ic.uniqueIdxCounter=0;const II={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class P0{constructor(s,h,g,x,w,E){this.length=h.length,this.attributes=g,this.itemSize=h.bytesPerElement,this.dynamicDraw=x,this.instanceCount=E,this.context=s;const C=s.gl;this.buffer=C.createBuffer(),s.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||w||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,h){for(let g=0;g<this.attributes.length;g++){const x=h.attributes[this.attributes[g].name];x!==void 0&&s.enableVertexAttribArray(x)}}setVertexAttribPointers(s,h,g){for(let x=0;x<this.attributes.length;x++){const w=this.attributes[x],E=h.attributes[w.name];E!==void 0&&s.vertexAttribPointer(E,w.components,s[II[w.type]],!1,this.itemSize,w.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(s,h,g){for(let x=0;x<this.attributes.length;x++){const w=h.attributes[this.attributes[x].name];w!==void 0&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(w,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Bg{constructor(s,h,g,x,w){this.context=s,this.width=h,this.height=g;const E=this.framebuffer=s.gl.createFramebuffer();x&&(this.colorAttachment=new SI(s,E)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new Pg(s,E):new g0(s,E))}destroy(){const s=this.context.gl;if(this.colorAttachment){const h=this.colorAttachment.get();h&&s.deleteTexture(h)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const h=this.depthAttachment.get();h&&s.deleteRenderbuffer(h)}else{const h=this.depthAttachment.get();h&&s.deleteTexture(h)}s.deleteFramebuffer(this.framebuffer)}}class pd{constructor(s,h){this.gl=s,this.clearColor=new yI(this),this.clearDepth=new _I(this),this.clearStencil=new vI(this),this.colorMask=new sS(this),this.depthMask=new xI(this),this.stencilMask=new bg(this),this.stencilFunc=new bI(this),this.stencilOp=new lS(this),this.stencilTest=new u0(this),this.depthRange=new wg(this),this.depthTest=new h0(this),this.depthFunc=new Wu(this),this.blend=new d0(this),this.blendFunc=new cS(this),this.blendColor=new ld(this),this.blendEquation=new gp(this),this.cullFace=new Sg(this),this.cullFaceSide=new Tg(this),this.frontFace=new cd(this),this.program=new Eg(this),this.activeTexture=new f0(this),this.viewport=new uS(this),this.bindFramebuffer=new p0(this),this.bindRenderbuffer=new Ag(this),this.bindTexture=new yp(this),this.bindVertexBuffer=new hS(this),this.bindElementBuffer=new dS(this),this.bindVertexArrayOES=new fS(this),this.pixelStoreUnpack=new ud(this),this.pixelStoreUnpackPremultiplyAlpha=new pS(this),this.pixelStoreUnpackFlipY=new wI(this),this.options=h?Object.assign({},h):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=h&&!!h.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,h,g){return new ic(this,s,h,g)}createVertexBuffer(s,h,g,x,w){return new P0(this,s,h,g,x,w)}createRenderbuffer(s,h,g){const x=this.gl,w=x.createRenderbuffer();return this.bindRenderbuffer.set(w),x.renderbufferStorage(x.RENDERBUFFER,s,h,g),this.bindRenderbuffer.set(null),w}createFramebuffer(s,h,g,x){return new Bg(this,s,h,g,x)}clear({color:s,depth:h,stencil:g,colorMask:x}){const w=this.gl;let E=0;s&&(E|=w.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(x||[!0,!0,!0,!0])),h!==void 0&&(E|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g!==void 0&&(E|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),w.clear(E)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){i.bv(s.blendFunction,Zn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Xu;function md(m,s,h,g,x,w,E){const C=m.context,O=C.gl,z=m.transform,F=m.getOrCreateProgram("collisionBox"),G=[];let U=0,Z=0;for(let be=0;be<g.length;be++){const Pe=g[be],Ee=s.getTile(Pe),Ae=Ee.getBucket(h);if(!Ae)continue;const we=fg(Pe,Ae,z);let Me=we;x[0]===0&&x[1]===0||(Me=m.translatePosMatrix(we,Ee,x,w));const ke=E?Ae.textCollisionBox:Ae.iconCollisionBox,Qe=Ae.collisionCircleArray;if(Qe.length>0){const qe=i.bz(),mt=Me;i.cB(qe,Ae.placementInvProjMatrix,z.glCoordMatrix),i.cB(qe,qe,Ae.placementViewportMatrix),G.push({circleArray:Qe,circleOffset:Z,transform:mt,invTransform:qe,projection:Ae.getProjection()}),U+=Qe.length/4,Z=U}ke&&(m.terrain&&m.terrain.setupElevationDraw(Ee,F),F.draw(m,O.LINES,Jt.disabled,In.disabled,m.colorModeForRenderPass(),Mn.disabled,vS(Me,z,Ee,Ae.getProjection()),h.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,z.zoom,null,[ke.collisionVertexBuffer,ke.collisionVertexBufferExt]))}if(!E||!G.length)return;const te=m.getOrCreateProgram("collisionCircle"),ee=new i.dI;ee.resize(4*U),ee._trim();let oe=0;for(const be of G)for(let Pe=0;Pe<be.circleArray.length/4;Pe++){const Ee=4*Pe,Ae=be.circleArray[Ee+0],we=be.circleArray[Ee+1],Me=be.circleArray[Ee+2],ke=be.circleArray[Ee+3];ee.emplace(oe++,Ae,we,Me,ke,0),ee.emplace(oe++,Ae,we,Me,ke,1),ee.emplace(oe++,Ae,we,Me,ke,2),ee.emplace(oe++,Ae,we,Me,ke,3)}(!Xu||Xu.length<2*U)&&(Xu=function(be){const Pe=2*be,Ee=new i.a_;Ee.resize(Pe),Ee._trim();for(let Ae=0;Ae<Pe;Ae++){const we=6*Ae;Ee.uint16[we+0]=4*Ae+0,Ee.uint16[we+1]=4*Ae+1,Ee.uint16[we+2]=4*Ae+2,Ee.uint16[we+3]=4*Ae+2,Ee.uint16[we+4]=4*Ae+3,Ee.uint16[we+5]=4*Ae+0}return Ee}(U));const re=C.createIndexBuffer(Xu,!0),fe=C.createVertexBuffer(ee,i.dJ.members,!0);for(const be of G){const Pe={u_matrix:be.transform,u_inv_matrix:be.invTransform,u_camera_to_center_distance:(_e=z).getCameraToCenterDistance(be.projection),u_viewport_size:[_e.width,_e.height]};te.draw(m,O.TRIANGLES,Jt.disabled,In.disabled,m.colorModeForRenderPass(),Mn.disabled,Pe,h.id,fe,re,i.bd.simpleSegment(0,2*be.circleOffset,be.circleArray.length,be.circleArray.length/2),null,z.zoom)}var _e;fe.destroy(),re.destroy()}const wp=i.bz();function Sp(m){const s=m._camera.getWorldToCamera(m.worldSize,1),h=i.az([],s,m.globeMatrix);i.bi(h,h);const g=[0,0,0],x=[0,1,0,0];return i.aA(x,x,h),g[0]=x[0],g[1]=x[1],g[2]=x[2],i.au(g,g),g}function jg({width:m,height:s,anchor:h,textOffset:g,textScale:x},w){const{horizontalAlign:E,verticalAlign:C}=i.bV(h),O=-(E-.5)*m,z=-(C-.5)*s,F=i.bU(h,g);return new i.P((O/x+F[0])*w,(z/x+F[1])*w)}function C0(m,s,h,g,x,w,E,C,O,z){const F=m.text.placedSymbolArray,G=m.text.dynamicLayoutVertexArray,U=m.icon.dynamicLayoutVertexArray,Z={},te=m.getProjection(),ee=sp(E,te,x),oe=x.elevation,re=te.upVectorScale(E.canonical,x.center.lat,x.worldSize).metersToTile;G.clear();for(let fe=0;fe<F.length;fe++){const _e=F.get(fe),{tileAnchorX:be,tileAnchorY:Pe,numGlyphs:Ee}=_e,Ae=_e.hidden||!_e.crossTileID||m.allowVerticalPlacement&&!_e.placedOrientation?null:g[_e.crossTileID];if(Ae){let we=0,Me=0,ke=0;if(oe){const vt=oe?oe.getAtTileOffset(E,be,Pe):0,[at,Tt,gt]=te.upVector(E.canonical,be,Pe);we=vt*at*re,Me=vt*Tt*re,ke=vt*gt*re}let[Qe,qe,mt,dt]=Ba(_e.projectedAnchorX+we,_e.projectedAnchorY+Me,_e.projectedAnchorZ+ke,h?ee:w);const Ot=Vc(x.getCameraToCenterDistance(te),dt);let Ze=i.bJ(m.textSizeData,O,_e)*Ot/i.bO;h&&(Ze*=m.tilePixelRatio/C);const et=jg(Ae,Ze);h?({x:Qe,y:qe,z:mt}=te.projectTilePoint(be+et.x,Pe+et.y,E.canonical),[Qe,qe,mt]=Ba(Qe+we,qe+Me,mt+ke,w)):(s&&et._rotate(-x.angle),Qe+=et.x,qe+=et.y,mt=0);const We=m.allowVerticalPlacement&&_e.placedOrientation===i.bI.vertical?Math.PI/2:0;for(let vt=0;vt<Ee;vt++)i.bL(G,Qe,qe,mt,We);z&&_e.associatedIconIndex>=0&&(Z[_e.associatedIconIndex]={x:Qe,y:qe,z:mt,angle:We})}else wr(Ee,G)}if(z){U.clear();const fe=m.icon.placedSymbolArray;for(let _e=0;_e<fe.length;_e++){const be=fe.get(_e),{numGlyphs:Pe}=be,Ee=Z[_e];if(be.hidden||!Ee)wr(Pe,U);else{const{x:Ae,y:we,z:Me,angle:ke}=Ee;for(let Qe=0;Qe<Pe;Qe++)i.bL(U,Ae,we,Me,ke)}}m.icon.dynamicLayoutVertexBuffer.updateData(U)}m.text.dynamicLayoutVertexBuffer.updateData(G)}function $g(m,s,h,g,x,w,E={}){const C=h.paint.get("icon-translate"),O=h.paint.get("text-translate"),z=h.paint.get("icon-translate-anchor"),F=h.paint.get("text-translate-anchor"),G=h.layout.get("icon-rotation-alignment"),U=h.layout.get("text-rotation-alignment"),Z=h.layout.get("icon-pitch-alignment"),te=h.layout.get("text-pitch-alignment"),ee=h.layout.get("icon-keep-upright"),oe=h.layout.get("text-keep-upright"),re=h.paint.get("icon-color-saturation"),fe=h.paint.get("icon-color-contrast"),_e=h.paint.get("icon-color-brightness-min"),be=h.paint.get("icon-color-brightness-max"),Pe=h.layout.get("symbol-elevation-reference")==="sea",Ee=m.context,Ae=Ee.gl,we=m.transform,Me=G==="map",ke=U==="map",Qe=Z==="map",qe=te==="map",mt=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let dt=!1;const Ot=m.depthModeForSublayer(0,Jt.ReadOnly),Ze=new Jt(m.context.gl.LEQUAL,Jt.ReadOnly,m.depthRangeFor3D),et=[i.ay(we.center.lng),i.aH(we.center.lat)],We=h.layout.get("text-variable-anchor"),vt=we.projection.name==="globe",at=[],Tt=[0,-1,0];for(const gt of g){const Et=s.getTile(gt),At=Et.getBucket(h);if(!At||At.projection.name==="mercator"&&vt||At.fullyClipped)continue;const Yt=At.projection.name==="globe",an=Yt?i.ah(we.zoom):0,Xt=sp(gt,At.getProjection(),we),ln=we.calculatePixelsToTileUnitsMatrix(Et),Qt=We&&At.hasTextData(),Sn=At.hasIconTextFit()&&Qt&&At.hasIconData(),Rn=At.elevationType==="road"?Ze:Ot,tr=At.getProjection().createInversionMatrix(we,gt.canonical),Nr=m.shadowRenderer,kr=At.elevationType==="road"&&!!Nr&&Nr.enabled;let rr=[0,0,0];if(kr){const _i=m.style.directionalLight,Vn=m.style.ambientLight;_i&&Vn&&(rr=Sl(m.style,_i,Vn))}const Oi=_i=>{we.depthOcclusionForSymbolsAndCircles&&(h.hasInitialOcclusionOpacityProperties||m.terrain)&&(_i.push("DEPTH_D24"),_i.push("DEPTH_OCCLUSION"))},wi=()=>{const _i=Me&&h.layout.get("symbol-placement")!=="point",Vn=[];Oi(Vn);const fi=_i||Sn,mr=h.paint.get("icon-image-cross-fade");m.terrainRenderModeElevated()&&Qe&&Vn.push("PITCH_WITH_MAP_TERRAIN"),Yt&&(Vn.push("PROJECTION_GLOBE_VIEW"),fi&&Vn.push("PROJECTED_POS_ON_VIEWPORT")),mr>0&&Vn.push("ICON_TRANSITION"),At.icon.zOffsetVertexBuffer&&Vn.push("Z_OFFSET"),re===0&&fe===0&&_e===0&&be===1||Vn.push("COLOR_ADJUSTMENT"),At.sdfIcons&&Vn.push("RENDER_SDF"),kr&&Vn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const pi=At.icon.programConfigurations.get(h.id),Sr=m.getOrCreateProgram("symbol",{config:pi,defines:Vn}),vi=Et.imageAtlasTexture?Et.imageAtlasTexture.size:[0,0],wo=At.iconSizeData,ri=i.bH(wo,we.zoom),Mo=Qe||we.pitch!==0,Ui=Qh(Xt,Et.tileID.canonical,Qe,Me,we,At.getProjection(),ln),No=Kv(Xt,Et.tileID.canonical,Qe,Me,we,At.getProjection(),ln),il=m.translatePosMatrix(No,Et,C,z,!0),lc=m.translatePosMatrix(Xt,Et,C,z),Ua=fi?wp:Ui,Is=Me&&!Qe&&!_i;let Pl=Tt;!vt&&!we.mercatorFromTransition||Me||(Pl=Sp(we));const Cl=Yt?Pl:Tt,ol=h.getColorAdjustmentMatrix(re,fe,_e,be),Pd=zg(wo.kind,ri,Is,Qe,m,lc,Ua,il,Pe,!1,vi,[0,0],!0,gt,an,et,tr,Cl,At.getProjection(),rr,ol,mr),oh=Et.imageAtlasTexture?Et.imageAtlasTexture:null,iy=h.layout.get("icon-size").constantOr(0)!==1||At.iconsNeedLinear,oy=At.sdfIcons||m.options.rotating||m.options.zooming||iy||Mo?Ae.LINEAR:Ae.NEAREST,ay=At.sdfIcons&&h.paint.get("icon-halo-width").constantOr(1)!==0,Bp=m.terrain&&Qe&&_i?i.bi(i.bz(),Ui):wp;if(_i&&At.icon){const mi=we.elevation,Cd=mi?mi.getAtTileOffsetFunc(gt,we.center.lat,we.worldSize,At.getProjection()):null,J0=cg(Xt,Et.tileID.canonical,Qe,Me,we,At.getProjection(),ln);Jv(At,Xt,m,!1,J0,No,Qe,ee,Cd,gt)}return{program:Sr,buffers:At.icon,uniformValues:Pd,atlasTexture:oh,atlasTextureIcon:null,atlasInterpolation:oy,atlasInterpolationIcon:null,isSDF:At.sdfIcons,hasHalo:ay,depthMode:Rn,tile:Et,renderWithShadows:kr,labelPlaneMatrixInv:Bp}},Fn=()=>{const _i=ke&&h.layout.get("symbol-placement")!=="point",Vn=[],fi=_i||We||Sn;m.terrainRenderModeElevated()&&qe&&Vn.push("PITCH_WITH_MAP_TERRAIN"),Yt&&(Vn.push("PROJECTION_GLOBE_VIEW"),fi&&Vn.push("PROJECTED_POS_ON_VIEWPORT")),At.text.zOffsetVertexBuffer&&Vn.push("Z_OFFSET"),At.iconsInText&&Vn.push("RENDER_TEXT_AND_SYMBOL"),Vn.push("RENDER_SDF"),kr&&Vn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Oi(Vn);const mr=At.text.programConfigurations.get(h.id),pi=m.getOrCreateProgram("symbol",{config:mr,defines:Vn});let Sr,vi=[0,0],wo=null;const ri=At.textSizeData;At.iconsInText&&(vi=Et.imageAtlasTexture?Et.imageAtlasTexture.size:[0,0],wo=Et.imageAtlasTexture?Et.imageAtlasTexture:null,Sr=qe||we.pitch!==0||m.options.rotating||m.options.zooming||ri.kind==="composite"||ri.kind==="camera"?Ae.LINEAR:Ae.NEAREST);const Mo=Et.glyphAtlasTexture?Et.glyphAtlasTexture.size:[0,0],Ui=h.layout.get("text-size-scale-range"),No=i.aD(m.scaleFactor,Ui[0],Ui[1]),il=i.bH(ri,we.zoom,No),lc=Qh(Xt,Et.tileID.canonical,qe,ke,we,At.getProjection(),ln),Ua=Kv(Xt,Et.tileID.canonical,qe,ke,we,At.getProjection(),ln),Is=m.translatePosMatrix(Ua,Et,O,F,!0),Pl=m.translatePosMatrix(Xt,Et,O,F),Cl=fi?wp:lc,ol=ke&&!qe&&!_i;let Pd=Tt;!vt&&!we.mercatorFromTransition||ke||(Pd=Sp(we));const oh=zg(ri.kind,il,ol,qe,m,Pl,Cl,Is,Pe,!0,Mo,vi,!0,gt,an,et,tr,Yt?Pd:Tt,At.getProjection(),rr,null,null,No),iy=Et.glyphAtlasTexture?Et.glyphAtlasTexture:null,oy=Ae.LINEAR,ay=h.paint.get("text-halo-width").constantOr(1)!==0,Bp=m.terrain&&qe&&_i?i.bi(i.bz(),lc):wp;if(_i&&At.text){const mi=we.elevation,Cd=mi?mi.getAtTileOffsetFunc(gt,we.center.lat,we.worldSize,At.getProjection()):null,J0=cg(Xt,Et.tileID.canonical,qe,ke,we,At.getProjection(),ln);Jv(At,Xt,m,!0,J0,Ua,qe,oe,Cd,gt)}return{program:pi,buffers:At.text,uniformValues:oh,atlasTexture:iy,atlasTextureIcon:wo,atlasInterpolation:oy,atlasInterpolationIcon:Sr,isSDF:!0,hasHalo:ay,depthMode:Rn,tile:Et,renderWithShadows:kr,labelPlaneMatrixInv:Bp}},hr=At.icon.segments.get().length,yr=At.text.segments.get().length,Fr=hr&&!E.onlyText?wi():null,Xi=yr&&!E.onlyIcons?Fn():null,Li=h.paint.get("icon-opacity").constantOr(1),qi=h.paint.get("text-opacity").constantOr(1);if(mt&&At.canOverlap){dt=!0;const _i=Li&&!E.onlyText?At.icon.segments.get():[],Vn=qi&&!E.onlyIcons?At.text.segments.get():[];for(const fi of _i)at.push({segments:new i.bd([fi]),sortKey:fi.sortKey,state:Fr});for(const fi of Vn)at.push({segments:new i.bd([fi]),sortKey:fi.sortKey,state:Xi})}else E.onlyText||at.push({segments:Li?At.icon.segments:new i.bd([]),sortKey:0,state:Fr}),E.onlyIcons||at.push({segments:qi?At.text.segments:new i.bd([]),sortKey:0,state:Xi})}dt&&at.sort((gt,Et)=>gt.sortKey-Et.sortKey);for(const gt of at){const Et=gt.state;if(Et)if(m.terrain?m.terrain.setupElevationDraw(Et.tile,Et.program,{useDepthForOcclusion:we.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Et.labelPlaneMatrixInv}):m.setupDepthForOcclusion(we.depthOcclusionForSymbolsAndCircles,Et.program),Ee.activeTexture.set(Ae.TEXTURE0),Et.atlasTexture&&Et.atlasTexture.bind(Et.atlasInterpolation,Ae.CLAMP_TO_EDGE,!0),Et.atlasTextureIcon&&(Ee.activeTexture.set(Ae.TEXTURE1),Et.atlasTextureIcon&&Et.atlasTextureIcon.bind(Et.atlasInterpolationIcon,Ae.CLAMP_TO_EDGE,!0)),Et.renderWithShadows&&m.shadowRenderer.setupShadows(Et.tile.tileID.toUnwrapped(),Et.program,"vector-tile",Et.tile.tileID.overscaledZ),m.uploadCommonLightUniforms(m.context,Et.program),Et.hasHalo){const At=Et.uniformValues;At.u_is_halo=1,I0(Et.buffers,gt.segments,h,m,Et.program,Et.depthMode,x,w,At,2),At.u_is_halo=0}else{if(Et.isSDF){const At=Et.uniformValues;Et.hasHalo&&(At.u_is_halo=1,I0(Et.buffers,gt.segments,h,m,Et.program,Et.depthMode,x,w,At,1)),At.u_is_halo=0}I0(Et.buffers,gt.segments,h,m,Et.program,Et.depthMode,x,w,Et.uniformValues,1)}}}function I0(m,s,h,g,x,w,E,C,O,z){const F=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer];x.draw(g,g.context.gl.TRIANGLES,w,E,C,Mn.disabled,O,h.id,m.layoutVertexBuffer,m.indexBuffer,s,h.paint,g.transform.zoom,m.programConfigurations.get(h.id),F,z)}function gd(m,s){const h=1<<m.canonical.z,g=(s.x*h-m.canonical.x-m.wrap*h)*i.aj,x=(s.y*h-m.canonical.y)*i.aj,w=i.dS(s.z,s.y);return i.cS(g,x,w)}function Tp(m,s,h,g,x){if(!h.layout||h.layout.get("fill-elevation-reference")==="none")return;const w=m.context.gl,E=new Jt(m.context.gl.LEQUAL,Jt.ReadWrite,m.depthRangeFor3D),C=new Jt(m.context.gl.GREATER,Jt.ReadWrite,m.depthRangeFor3D),O=function(Z){const te=i.cJ(Z.pitch);let ee=.01;return Z.isOrthographic&&(ee=i.ai(1e-4,ee,i.cO(te>=qc?1:te/qc))),2*ee}(m.transform),z=m.transform.getFreeCameraOptions().position,F="elevatedStructuresDepthReconstruct",G=m.getOrCreateProgram(F,{defines:["DEPTH_RECONSTRUCTION"]}),U=m.getOrCreateProgram(F);for(const Z of g){const te=s.getTile(Z),ee=te.getBucket(h);if(!ee)continue;const oe=ee.elevatedStructures;if(!oe)continue;const re=ee.elevationBufferData.heightRange,fe=gd(Z.toUnwrapped(),z),_e=m.translatePosMatrix(Z.projMatrix,te,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));let be,Pe,Ee,Ae;if(x==="initialize"){if(!re||re.min>=1||oe.depthSegments.segments[0].primitiveLength===0)continue;be=bp(_e,fe,O,1,0),Pe=E,Ee=oe.depthSegments,Ae=G}else if(x==="reset"){if(!re||re.min>=0||oe.maskSegments.segments[0].primitiveLength===0)continue;be=bp(_e,fe,0,0,1),Pe=C,Ee=oe.maskSegments,Ae=G}else if(x==="geometry"){if(oe.depthSegments.segments[0].primitiveLength===0)continue;be=bp(_e,fe,O,1,0),Pe=E,Ee=oe.depthSegments,Ae=U}Ae.draw(m,w.TRIANGLES,Pe,In.disabled,Zn.disabled,Mn.disabled,be,h.id,oe.vertexBuffer,oe.indexBuffer,Ee,h.paint,m.transform.zoom)}}function Zt(m,s,h){const{painter:g,sourceCache:x,layer:w,coords:E,colorMode:C,elevationType:O,terrainEnabled:z,pass:F}=m,G=g.context.gl,U=w.paint.get("fill-pattern"),Z=w.paint.get("fill-pattern-cross-fade"),te=U.constantOr(null);let ee=O;O!=="road"||s&&!z||(ee="none");const oe=ee==="road",re=m.painter.shadowRenderer,fe=oe&&!!re&&re.enabled,_e=new Jt(g.context.gl.LEQUAL,Jt.ReadOnly,g.depthRangeFor3D);let be=[0,0,0];if(fe){const Ae=g.style.directionalLight,we=g.style.ambientLight;Ae&&we&&(be=Sl(g.style,Ae,we))}const Pe=U&&U.constantOr(1),Ee=(Ae,we)=>{let Me,ke,Qe,qe,mt;we?(Me=Pe&&!w.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Qe=G.LINES):(Me=Pe?"fillPattern":"fill",Qe=G.TRIANGLES);for(const dt of E){const Ot=x.getTile(dt);if(Pe&&!Ot.patternsLoaded())continue;const Ze=Ot.getBucket(w);if(!Ze)continue;const et=s?Ze.elevationBufferData:Ze.bufferData;if(et.isEmpty())continue;g.prepareDrawTile();const We=et.programConfigurations.get(w.id),vt=g.isTileAffectedByFog(dt),at=[],Tt=[];oe&&(at.push("ELEVATED_ROADS"),Tt.push(et.elevatedLayoutVertexBuffer)),fe&&at.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Pe&&(g.context.activeTexture.set(G.TEXTURE0),Ot.imageAtlasTexture&&Ot.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),We.updatePaintBuffers());let gt=!1;if(te&&Ot.imageAtlas){const Xt=Ot.imageAtlas,ln=i.dN.from(te),Qt=ln.getPrimary().scaleSelf(i.q.devicePixelRatio).toString(),Sn=ln.getSecondary(),Rn=Xt.patternPositions.get(Qt),tr=Sn?Xt.patternPositions.get(Sn.scaleSelf(i.q.devicePixelRatio).toString()):null;gt=!!Rn&&!!tr,Rn&&We.setConstantPatternPositions(Rn,tr)}Z>0&&(gt||We.getPatternTransitionVertexBuffer("fill-pattern"))&&at.push("FILL_PATTERN_TRANSITION");const Et=g.getOrCreateProgram(Me,{config:We,overrideFog:vt,defines:at}),At=g.translatePosMatrix(dt.projMatrix,Ot,w.paint.get("fill-translate"),w.paint.get("fill-translate-anchor"));fe&&re.setupShadows(Ot.tileID.toUnwrapped(),Et,"vector-tile",Ot.tileID.overscaledZ);const Yt=w.paint.get("fill-emissive-strength");if(we){qe=et.lineIndexBuffer,mt=et.lineSegments;const Xt=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[G.drawingBufferWidth,G.drawingBufferHeight];ke=Me==="fillOutlinePattern"&&Pe?PI(At,Yt,g,Ot,Xt,be,Z):AI(At,Yt,Xt,be)}else qe=et.indexBuffer,mt=et.triangleSegments,ke=Pe?_S(At,Yt,g,Ot,be,Z):yS(At,Yt,be);g.uploadCommonUniforms(g.context,Et,dt.toUnwrapped());let an=Ae;(O==="road"&&!z||O==="offset")&&(an=_e),Et.draw(g,Qe,an,h||g.stencilModeForClipping(dt),C,Mn.disabled,ke,w.id,et.layoutVertexBuffer,qe,mt,w.paint,g.transform.zoom,We,Tt)}};g.renderPass===F&&Ee(g.depthModeForSublayer(1,g.renderPass==="opaque"?Jt.ReadWrite:Jt.ReadOnly),!1),ee==="none"&&g.renderPass==="translucent"&&w.paint.get("fill-antialias")&&Ee(g.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Jt.ReadOnly),!0)}function Ep(m,s,h,g,x,w,E,C){h.resetLayerRenderingStats(m);const O=m.context,z=O.gl,F=m.transform,G=h.paint.get("fill-extrusion-pattern"),U=h.paint.get("fill-extrusion-pattern-cross-fade"),Z=G.constantOr(null),te=G.constantOr(1),ee=h.paint.get("fill-extrusion-opacity"),oe=m.style.enable3dLights(),re=h.paint.get(oe&&!te?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),fe=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),re],_e=h.layout.get("fill-extrusion-edge-radius"),be=_e>0&&!h.paint.get("fill-extrusion-rounded-roof"),Pe=be?0:_e,Ee=F.projection.name==="globe"?i.dT():0,Ae=F.projection.name==="globe",we=Ae?i.ah(F.zoom):0,Me=[i.ay(F.center.lng),i.aH(F.center.lat)],ke=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Qe=h.paint.get("fill-extrusion-flood-light-color").toRenderColor(ke?null:h.lut).toArray01().slice(0,3),qe=h.paint.get("fill-extrusion-flood-light-intensity"),mt=h.paint.get("fill-extrusion-vertical-scale"),dt=h.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Ot=h.paint.get("fill-extrusion-height-alignment"),Ze=h.paint.get("fill-extrusion-base-alignment"),et=Uu(m,h.paint.get("fill-extrusion-cutoff-fade-range")),We=[];let vt;Ae&&We.push("PROJECTION_GLOBE_VIEW"),fe[0]>0&&We.push("FAUX_AO"),be&&We.push("ZERO_ROOF_RADIUS"),C&&We.push("HAS_CENTROID"),qe>0&&We.push("FLOOD_LIGHT"),et.shouldRenderCutoff&&We.push("RENDER_CUTOFF"),dt&&We.push("RENDER_WALL_MODE");const at=m.renderPass==="shadow",Tt=m.shadowRenderer,gt=at&&!!Tt,Et=at?Mn.disabled:Mn.backCCW;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let At=[0,0,0];if(Tt){const Xt=m.style.directionalLight,ln=m.style.ambientLight;Xt&&ln&&(At=Sl(m.style,Xt,ln)),at||(We.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Tt.useNormalOffset&&We.push("NORMAL_OFFSET")),vt=We.concat(["SHADOWS_SINGLE_CASCADE"])}const Yt=gt?"fillExtrusionDepth":te?"fillExtrusionPattern":"fillExtrusion",an=h.getLayerRenderingStats();for(const Xt of g){const ln=s.getTile(Xt),Qt=ln.getBucket(h);if(!Qt||Qt.projection.name!==F.projection.name)continue;let Sn=!1;Tt&&(Sn=Tt.getMaxCascadeForTile(Xt.toUnwrapped())===0);const Rn=m.isTileAffectedByFog(Xt),tr=Qt.programConfigurations.get(h.id);let Nr=!1;if(Z&&ln.imageAtlas){const yr=ln.imageAtlas,Fr=i.dN.from(Z),Xi=Fr.getPrimary().scaleSelf(i.q.devicePixelRatio).toString(),Li=Fr.getSecondary(),qi=yr.patternPositions.get(Xi),_i=Li?yr.patternPositions.get(Li.scaleSelf(i.q.devicePixelRatio).toString()):null;Nr=!!qi&&!!_i,qi&&tr.setConstantPatternPositions(qi,_i)}U>0&&(Nr||tr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&We.push("FILL_EXTRUSION_PATTERN_TRANSITION");const kr=m.getOrCreateProgram(Yt,{config:tr,defines:Sn?vt:We,overrideFog:Rn});if(m.terrain&&m.terrain.setupElevationDraw(ln,kr,{useMeterToDem:!0}),!Qt.centroidVertexBuffer){const yr=kr.attributes.a_centroid_pos;yr!==void 0&&z.vertexAttrib2f(yr,0,0)}!at&&Tt&&Tt.setupShadows(ln.tileID.toUnwrapped(),kr,"vector-tile",ln.tileID.overscaledZ),te&&(m.context.activeTexture.set(z.TEXTURE0),ln.imageAtlasTexture&&ln.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),tr.updatePaintBuffers());const rr=h.paint.get("fill-extrusion-vertical-gradient"),Oi=1/Qt.tileToMeter;let wi;if(at&&Tt){if(MI(ln.tileID,Qt,m))continue;const yr=Tt.calculateShadowPassMatrixFromTile(ln.tileID.toUnwrapped());wi=TI(yr,Pe,Oi,mt,Ot,Ze)}else{const yr=m.translatePosMatrix(Xt.expandedProjMatrix,ln,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Fr=F.projection.createInversionMatrix(F,Xt.canonical);wi=te?EI(yr,m,rr,ee,fe,Pe,Oi,Xt,ln,Ee,Ot,Ze,we,Me,Fr,Qe,mt,U):Hu(yr,m,rr,ee,fe,Pe,Oi,Xt,Ee,Ot,Ze,we,Me,Fr,Qe,mt,qe,At)}m.uploadCommonUniforms(O,kr,Xt.toUnwrapped(),null,et);let Fn=Qt.segments;if(F.projection.name==="mercator"&&!at&&(Fn=Qt.getVisibleSegments(ln.tileID,m.terrain,m.transform.getFrustum(0)),!Fn.get().length))continue;if(an)if(at)for(const yr of Fn.get())an.numRenderedVerticesInShadowPass+=yr.primitiveLength;else for(const yr of Fn.get())an.numRenderedVerticesInTransparentPass+=yr.primitiveLength;const hr=[];(m.terrain||C)&&hr.push(Qt.centroidVertexBuffer),Ae&&hr.push(Qt.layoutVertexExtBuffer),dt&&hr.push(Qt.wallVertexBuffer),kr.draw(m,O.gl.TRIANGLES,x,w,E,Et,wi,h.id,Qt.layoutVertexBuffer,Qt.indexBuffer,Fn,h.paint,m.transform.zoom,tr,hr)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function Ku(m,s,h,g,x,w,E,C,O,z,F,G,U,Z,te,ee,oe,re,fe){const _e=m.context,be=_e.gl,Pe=m.transform,Ee=m.transform.zoom,Ae=[],we=Uu(m,h.paint.get("fill-extrusion-cutoff-fade-range"));z==="clear"?(Ae.push("CLEAR_SUBPASS"),fe&&(Ae.push("CLEAR_FROM_TEXTURE"),_e.activeTexture.set(be.TEXTURE0),fe.bind(be.LINEAR,be.CLAMP_TO_EDGE))):z==="sdf"&&Ae.push("SDF_SUBPASS"),oe&&Ae.push("HAS_CENTROID"),we.shouldRenderCutoff&&Ae.push("RENDER_CUTOFF");const Me=h.layout.get("fill-extrusion-edge-radius"),ke=(Qe,qe,mt,dt,Ot)=>{const Ze=qe.programConfigurations.get(h.id),et=m.isTileAffectedByFog(Qe),We=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:Ze,defines:Ae,overrideFog:et}),vt=((Tt,gt,Et,At,Yt,an,Xt,ln,Qt,Sn,Rn)=>({u_matrix:gt,u_opacity:Et,u_ao_pass:At?1:0,u_meter_to_tile:Yt,u_ao:an,u_flood_light_intensity:Xt,u_flood_light_color:ln,u_attenuation:Qt,u_edge_radius:Sn,u_fb:0,u_fb_size:Rn,u_dynamic_offset:1}))(0,dt,F,O,Ot,[G,U*Ot],Z,te,ee,Ee>=17?0:Me*Ot,fe?fe.size[0]:0),at=[];oe&&at.push(qe.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(_e,We,Qe.toUnwrapped(),null,we),We.draw(m,_e.gl.TRIANGLES,x,w,E,C,vt,h.id,qe.vertexBuffer,qe.indexBuffer,mt,h.paint,Ee,Ze,at)};for(const Qe of g){const qe=s.getTile(Qe),mt=qe.getBucket(h);if(!mt||mt.projection.name!==Pe.projection.name||!mt.groundEffect||mt.groundEffect&&!mt.groundEffect.hasData())continue;const dt=mt.groundEffect,Ot=1/mt.tileToMeter;{const Ze=m.translatePosMatrix(Qe.projMatrix,qe,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),et=dt.getDefaultSegment();ke(Qe,dt,et,Ze,Ot)}if(re)for(let Ze=0;Ze<4;Ze++){const et=i.dU[Ze](Qe),We=s.getTile(et);if(!We)continue;const vt=We.getBucket(h);if(!vt||vt.projection.name!==Pe.projection.name||!vt.groundEffect||vt.groundEffect&&!vt.groundEffect.hasData())continue;const at=vt.groundEffect;let Tt,gt;Ze===0?(Tt=[-i.aj,0,0],gt=1):Ze===1?(Tt=[i.aj,0,0],gt=0):Ze===2?(Tt=[0,-i.aj,0],gt=3):(Tt=[0,i.aj,0],gt=2);const Et=at.regionSegments[gt];if(!Et)continue;const At=new Float32Array(16);i.bo(At,Qe.projMatrix,Tt),ke(Qe,at,Et,m.translatePosMatrix(At,qe,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Ot)}}}function Jc(m,s,h,g,x,w,E){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();const C=w?w.findDEMTileFor(h):null;if(!(C&&C.dem||E))return;w&&C&&C.dem&&g.selfDEMTileTimestamp!==C.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=C.dem._timestamp);const O=re=>new i.P(Math.ceil((re+i.dX)*i.dY),0),z=re=>{const fe=s.getSource().minzoom,_e=Pe=>{const Ee=s.getTileByID(Pe);if(Ee&&Ee.hasData())return Ee.getBucket(x)},be=[0,-1,1];for(const Pe of be){if(re.overscaledZ+Pe<fe)continue;const Ee=_e(re.calculateScaledKey(re.overscaledZ+Pe));if(Ee)return Ee}},F=[0,0,0],G=(re,fe)=>(F[0]=Math.min(re.min.y,fe.min.y),F[1]=Math.max(re.max.y,fe.max.y),F[2]=i.aj-fe.min.x>re.max.x?fe.min.x-i.aj:re.max.x,F),U=(re,fe)=>(F[0]=Math.min(re.min.x,fe.min.x),F[1]=Math.max(re.max.x,fe.max.x),F[2]=i.aj-fe.min.y>re.max.y?fe.min.y-i.aj:re.max.y,F),Z=[(re,fe)=>G(re,fe),(re,fe)=>G(fe,re),(re,fe)=>U(re,fe),(re,fe)=>U(fe,re)],te=(re,fe,_e,be,Pe,Ee,Ae)=>{if(!w)return 0;const we=[[Ee?_e:re,Ee?re:_e,0],[Ee?_e:fe,Ee?fe:_e,0]],Me=Ae<0?i.aj+Ae:Ae,ke=[Ee?Me:(re+fe)/2,Ee?(re+fe)/2:Me,0];return _e===0&&Ae<0||_e!==0&&Ae>0?w.getForTilePoints(Pe,[ke],!0,be):we.push(ke),w.getForTilePoints(h,we,!0,C),Math.max(we[0][2],we[1][2],ke[2])/w.exaggeration()};for(let re=0;re<4;re++){const fe=g.borderFeatureIndices[re];if(fe.length===0)continue;const _e=i.dU[re](h),be=z(_e);if(!(be&&be instanceof i.dV))continue;const Pe=w?w.findDEMTileFor(_e):null;if(!(Pe&&Pe.dem||E)||(w&&Pe&&Pe.dem&&g.borderDEMTileTimestamp[re]!==Pe.dem._timestamp&&(g.borderDoneWithNeighborZ[re]=-1,g.borderDEMTileTimestamp[re]=Pe.dem._timestamp),g.borderDoneWithNeighborZ[re]===be.canonical.z))continue;be.centroidVertexArray.length===0&&be.createCentroidsBuffer();const Ee=(re<2?1:5)-re,Ae=be.borderDoneWithNeighborZ[Ee]!==g.canonical.z,we=be.borderFeatureIndices[Ee];let Me=0;if(g.canonical.z!==be.canonical.z){for(const ke of fe)g.showCentroid(g.featuresOnBorder[ke]);if(Ae)for(const ke of we)be.showCentroid(be.featuresOnBorder[ke]);g.borderDoneWithNeighborZ[re]=be.canonical.z,be.borderDoneWithNeighborZ[Ee]=g.canonical.z}for(const ke of fe){const Qe=g.featuresOnBorder[ke],qe=g.centroidData[Qe.centroidDataIndex],mt=Qe.borders[re];let dt;for(;Me<we.length;){dt=be.featuresOnBorder[we[Me]];const Ot=dt.borders[Ee];if(Ot[1]>mt[0]+3||Ot[0]>mt[0]-3)break;be.showCentroid(dt),Me++}if(dt&&Me<we.length){const Ot=Me;let Ze=0;for(;!(dt.borders[Ee][0]>mt[1]-3)&&(Ze++,++Me!==we.length);)dt=be.featuresOnBorder[we[Me]];dt=be.featuresOnBorder[we[Ot]];let et=!1;if(Ze>=1){const at=dt.borders[Ee];Math.abs(mt[0]-at[0])<3&&Math.abs(mt[1]-at[1])<3&&(Ze=1,et=!0,Me=Ot+1)}else if(Ze===0){g.showCentroid(Qe);continue}const We=be.centroidData[dt.centroidDataIndex];E&&et&&(((ee=qe).flags|(oe=We).flags)&i.dW?(ee.flags|=i.dW,oe.flags|=i.dW):(ee.flags&=~i.dW,oe.flags&=~i.dW));const vt=Qe.intersectsCount()>1||dt.intersectsCount()>1;if(Ze>1)Me=Ot,qe.centroidXY=We.centroidXY=new i.P(0,0);else if(Pe&&Pe.dem&&!vt){const at=Z[re](qe,We),Tt=re%2?i.aj-1:0,gt=te(at[0],Math.min(i.aj-1,at[1]),Tt,Pe,_e,re<2,at[2]);qe.centroidXY=We.centroidXY=O(gt)}else vt?qe.centroidXY=We.centroidXY=new i.P(0,0):(qe.centroidXY=g.encodeBorderCentroid(Qe),We.centroidXY=be.encodeBorderCentroid(dt));g.writeCentroidToBuffer(qe),be.writeCentroidToBuffer(We)}else g.showCentroid(Qe)}g.borderDoneWithNeighborZ[re]=be.canonical.z,be.borderDoneWithNeighborZ[Ee]=g.canonical.z}var ee,oe;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(m)}const Qc=[1,0,0],bn=[0,1,0],M0=[0,0,1];function MI(m,s,h){const g=h.transform,x=h.shadowRenderer;if(!x)return!0;const w=m.toUnwrapped(),E=g.tileSize*x._cascades[h.currentShadowCascade].scale;let C=s.maxHeight;if(g.elevation){const ee=g.elevation.getMinMaxForTile(m);ee&&(C+=ee.max)}const O=[...x.shadowDirection];O[2]=-O[2];const z=x.computeSimplifiedTileShadowVolume(w,C,E,O);if(!z)return!1;const F=[Qc,bn,M0,O,[O[0],0,O[2]],[0,O[1],O[2]]],G=g.projection.name==="globe",U=g.scaleZoom(E),Z=i.cn.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,U,!G),te=x.getCurrentCascadeFrustum();return Z.intersectsPrecise(z.vertices,z.planes,F)===0||te.intersectsPrecise(z.vertices,z.planes,F)===0}function AS(m){return[m[0]*i.dZ,m[1]*i.dZ,m[2]*i.dZ,0]}function Ap(m,s,h,g,x,w,E,C,O){const z=g.getSource(),F=h.globeSharedBuffers;if(!F)return;let G,U,Z;if(s&&(G=g.getTile(s)),z instanceof i.aP?(U=z.texture,Z=i.ds(0,0,h.transform)):G&&s&&(U=G.texture,Z=i.ds(s.canonical.z,s.canonical.x,h.transform)),!U||!Z)return;m||(Z=i.cE(i.bz(),Z,[1,-1,1]));const te=h.context,ee=te.gl,oe=x.paint.get("raster-resampling")==="nearest"?ee.NEAREST:ee.LINEAR,re=h.colorModeForDrapableLayerRenderPass(w),fe=E.defines;fe.push("GLOBE_POLES");const _e=new Jt(ee.LEQUAL,Jt.ReadWrite,h.depthRangeFor3D),be=Float32Array.from(h.transform.expandedFarZProjMatrix),Pe=Float32Array.from(i.bh(i.dr(new i.cp(0,0,0))));h.terrain&&h.terrain.prepareDrawTile(),te.activeTexture.set(ee.TEXTURE0),U.bind(oe,ee.CLAMP_TO_EDGE),te.activeTexture.set(ee.TEXTURE1),U.bind(oe,ee.CLAMP_TO_EDGE),"useMipmap"in U&&te.extTextureFilterAnisotropic&&h.transform.pitch>20&&ee.texParameterf(ee.TEXTURE_2D,te.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,te.extTextureFilterAnisotropicMax);const[Ee,Ae,we,Me]=s?F.getPoleBuffers(s.canonical.z,!1):F.getPoleBuffers(0,!0),ke=x.paint.get("raster-elevation");let Qe;m?(Qe=Ee,h.renderDefaultNorthPole=ke!==0):(Qe=Ae,h.renderDefaultSouthPole=ke!==0);const qe=AS(E.mix),mt=((Ot,Ze,et,We,vt,at,Tt,gt,Et,At,Yt,an,Xt)=>Yc(Ot,Ze,et,new Float32Array(16),new Float32Array(9),[0,0],We,[0,0],[0,0,0,0],1,{opacity:1,mix:0},at,[0,0],gt,2,At,Yt,an,1,0,Xt))(be,Pe,Z,i.ah(h.transform.zoom),0,x,0,ke,0,qe,E.offset,E.range,w),dt=h.getOrCreateProgram("raster",{defines:fe});h.uploadCommonUniforms(te,dt,null),dt.draw(h,ee.TRIANGLES,_e,O,re,C,mt,x.id,Qe,we,Me)}function PS(m){const s=m._nearZ,h=m.projection.farthestPixelDistance(m),g=h-s,x=.2*m.height,w=s+x;return[s,h,(w-x-s)/g,(w-s)/g]}function OI(m,s,h,g){if(m)return s instanceof Ru&&m instanceof rp?s.getTextureDescriptor(m,h,!0):{texture:m.texture,mix:AS(g.mix),offset:g.offset,buffer:0,tileSize:1}}var CS=i.d_([{name:"a_index",type:"Int16",components:1}]);class kI{constructor(s,h,g,x){const w={width:g[0],height:g[1],data:null},E=s.gl;this.targetColorTexture=new i.T(s,w,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(s,w,E.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(h,x),this.lastInvalidatedAt=0}updateParticleTexture(s,h){if(this.particleTextureDimension===h.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,x=h.width*h.height;this.particleTexture0=new i.T(this.context,h,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,h,g.RGBA8,{premultiply:!1,useMipmap:!1});const w=new i.d$;w.reserve(x);for(let E=0;E<x;E++)w.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(w,CS.members,!0),this.particleSegment=i.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=h.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function RI(m,s,h){if(!m)return null;const g=s.getTextureDescriptor(m,h,!0);if(!g)return null;let{texture:x,mix:w,offset:E,tileSize:C,buffer:O,format:z}=g;if(!x||!z)return null;let F=!1;return z==="uint32"&&(F=!0,w[3]=0,w=T0(i.e0,w,[0,h.paint.get("raster-particle-max-speed")]),E=Dg(i.e0,E,[0,h.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[O/(C+2*O),C/(C+2*O)],tileSize:C,scalarData:F,scale:w,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[z]]}}function O0(m){const s=m._nearZ,h=m.projection.farthestPixelDistance(m),g=h-s,x=.2*m.height,w=s+x;return[s,h,(w-x-s)/g,(w-s)/g]}const k0=new i.am(1,0,0,1),R0=new i.am(0,1,0,1),D0=new i.am(0,0,1,1),$a=new i.am(1,0,1,1),eu=new i.am(0,1,1,1);function Yu(m,s,h,g,x,w,E){const C=m.context,O=m.transform,z=C.gl,F=O.projection.name==="globe",G=F?["PROJECTION_GLOBE_VIEW"]:[];let U=i.bw(h.projMatrix);if(F&&i.ah(O.zoom)>0){const qe=i.bg(h.canonical,O),mt=i.e1(qe);U=i.az(new Float32Array(16),O.globeMatrix,mt),i.az(U,O.projMatrix,U)}const Z=i.bz();Z[12]+=2*x/(i.q.devicePixelRatio*O.width),Z[13]+=2*w/(i.q.devicePixelRatio*O.height),i.az(U,Z,U);const te=m.getOrCreateProgram("debug",{defines:G}),ee=s.getTileByID(h.key);m.terrain&&m.terrain.setupElevationDraw(ee,te);const oe=Jt.disabled,re=In.disabled,fe=m.colorModeForRenderPass(),_e="$debug";C.activeTexture.set(z.TEXTURE0),m.emptyTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),F?ee._makeGlobeTileDebugBuffers(m.context,O):ee._makeDebugTileBoundsBuffers(m.context,O.projection);const be=ee._tileDebugBuffer||m.debugBuffer,Pe=ee._tileDebugIndexBuffer||m.debugIndexBuffer,Ee=ee._tileDebugSegments||m.debugSegments;if(te.draw(m,z.LINE_STRIP,oe,re,fe,Mn.disabled,qu(U,g),_e,be,Pe,Ee,null,null,null,[ee._globeTileDebugBorderBuffer]),E){const qe=ee.latestRawTileData,mt=Math.floor((qe&&qe.byteLength||0)/1024);let dt=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(dt+=` => ${h.overscaledZ}`),dt+=` ${ee.state}`,dt+=` ${mt}kb`,function(Ot,Ze){Ot.initDebugOverlayCanvas();const et=Ot.debugOverlayCanvas,We=Ot.context.gl,vt=Ot.debugOverlayCanvas.getContext("2d");vt.clearRect(0,0,et.width,et.height),vt.shadowColor="white",vt.shadowBlur=2,vt.lineWidth=1.5,vt.strokeStyle="white",vt.textBaseline="top",vt.font="bold 36px Open Sans, sans-serif",vt.fillText(Ze,5,5),vt.strokeText(Ze,5,5),Ot.debugOverlayTexture.update(et),Ot.debugOverlayTexture.bind(We.LINEAR,We.CLAMP_TO_EDGE)}(m,dt)}const Ae=s.getTile(h).tileSize,we=512/Math.min(Ae,512)*(h.overscaledZ/O.zoom)*.5,Me=ee._tileDebugTextBuffer||m.debugBuffer,ke=ee._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Qe=ee._tileDebugTextSegments||m.debugSegments;te.draw(m,z.TRIANGLES,oe,re,Zn.alphaBlended,Mn.disabled,qu(U,i.am.transparent,we),_e,Me,ke,Qe,null,null,null,[ee._globeTileDebugTextBuffer])}function Ug(m,s,h,g){yd(m,0,s+h/2,m.transform.width,h,g)}function Vg(m,s,h,g){yd(m,s-h/2,0,h,m.transform.height,g)}function yd(m,s,h,g,x,w){const E=m.context,C=E.gl;C.enable(C.SCISSOR_TEST),C.scissor(s*i.q.devicePixelRatio,h*i.q.devicePixelRatio,g*i.q.devicePixelRatio,x*i.q.devicePixelRatio),E.clear({color:w}),C.disable(C.SCISSOR_TEST)}const IS=i.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ps}=IS;function zr(m,s,h,g){m.emplaceBack(s,h,g)}class Pp{constructor(s){this.vertexArray=new i.e2,this.indices=new i.a_,zr(this.vertexArray,-1,-1,1),zr(this.vertexArray,1,-1,1),zr(this.vertexArray,-1,1,1),zr(this.vertexArray,1,1,1),zr(this.vertexArray,-1,-1,-1),zr(this.vertexArray,1,-1,-1),zr(this.vertexArray,-1,1,-1),zr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Ps),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=i.bd.simpleSegment(0,0,36,12)}}function tu(m,s,h,g,x,w){const E=m.context.gl,C=s.paint.get("sky-atmosphere-color"),O=s.paint.get("sky-atmosphere-halo-color"),z=s.paint.get("sky-atmosphere-sun-intensity"),F=((G,U,Z,te,ee)=>({u_matrix_3f:G,u_sun_direction:U,u_sun_intensity:Z,u_color_tint_r:[te.r,te.g,te.b,te.a],u_color_tint_m:[ee.r,ee.g,ee.b,ee.a],u_luminance:5e-5}))(i.e4(i.dx(),g),x,z,C,O);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+w,s.skyboxTexture,0),h.draw(m,E.TRIANGLES,Jt.disabled,In.disabled,Zn.unblended,Mn.frontCW,F,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const MS=i.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class OS{constructor(s){const h=new i.e5;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const g=new i.a_;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(h,MS.members),this.indexBuffer=s.createIndexBuffer(g),this.segments=i.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const kS=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class DI{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class _d{constructor(s){this.colorModeAlphaBlendedWriteRGB=new Zn([1,da,1,da],i.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Zn([1,0,1,0],i.am.transparent,[!1,!1,!1,!0]),this.params=new DI,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const h=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new OS(h);const g=this.params.sizeRange,x=this.params.intensityRange,w=function(F){const G=i.ea(30),U=[];for(let Z=0;Z<F;++Z){const te=2*Math.PI*G(),ee=Math.acos(1-2*G())-.5*Math.PI;U.push(i.cS(Math.cos(ee)*Math.cos(te),Math.cos(ee)*Math.sin(te),Math.sin(ee)))}return U}(this.params.starsCount),E=i.ea(300),C=new i.e6,O=new i.a_;let z=0;for(let F=0;F<w.length;++F){const G=i.b$([],w[F],200),U=Math.max(0,1+.01*g*(1*E()-.5)),Z=Math.max(0,1+.01*x*(1*E()-.5));C.emplaceBack(G[0],G[1],G[2],-1,-1,U,Z),C.emplaceBack(G[0],G[1],G[2],1,-1,U,Z),C.emplaceBack(G[0],G[1],G[2],1,1,U,Z),C.emplaceBack(G[0],G[1],G[2],-1,1,U,Z),O.emplaceBack(z+0,z+1,z+2),O.emplaceBack(z+0,z+2,z+3),z+=4}this.starsVx=h.createVertexBuffer(C,kS.members),this.starsIdx=h.createIndexBuffer(O),this.starsSegments=i.bd.simpleSegment(0,0,C.length,O.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,h){const g=s.context,x=g.gl,w=s.transform,E=new Jt(x.LEQUAL,Jt.ReadOnly,[0,1]),C=i.ah(w.zoom),O=s.style.getLut(h.scope),z=h.properties.get("color-use-theme")==="none",F=h.properties.get("color").toRenderColor(z?null:O).toArray01(),G=h.properties.get("high-color-use-theme")==="none",U=h.properties.get("high-color").toRenderColor(G?null:O).toArray01(),Z=h.properties.get("space-color-use-theme")==="none",te=h.properties.get("space-color").toRenderColor(Z?null:O).toArray01PremultipliedAlpha(),ee=5e-4,oe=i.e7(h.properties.get("horizon-blend"),0,1,ee,.25),re=i.dl(s,g,w)&&oe===ee?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,fe=s.frameCounter/1e3%1,_e=i.ae(w.globeCenterInViewSpace),be=Math.sqrt(Math.pow(_e,2)-Math.pow(re,2)),Pe=Math.acos(be/_e),Ee=Ae=>{const we=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ae&&we.push("ALPHA_PASS");const Me=s.getOrCreateProgram("globeAtmosphere",{defines:we}),ke=((qe,mt,dt,Ot,Ze,et,We,vt,at,Tt,gt,Et)=>({u_frustum_tl:qe,u_frustum_tr:mt,u_frustum_br:dt,u_frustum_bl:Ot,u_horizon:Ze,u_transition:et,u_fadeout_range:We,u_color:vt,u_high_color:at,u_space_color:Tt,u_temporal_offset:gt,u_horizon_angle:Et}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,C,oe,F,U,te,fe,Pe);s.uploadCommonUniforms(g,Me);const Qe=this.atmosphereBuffer;Qe&&Me.draw(s,x.TRIANGLES,E,In.disabled,Ae?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Mn.backCW,ke,Ae?"atmosphere_glow_alpha":"atmosphere_glow",Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)};Ee(!1),Ee(!0)}drawStars(s,h){const g=i.aD(h.properties.get("star-intensity"),0,1);if(g===0)return;const x=s.context,w=x.gl,E=s.transform,C=s.getOrCreateProgram("stars"),O=i.bY([]);i.b_(O,O,-E._pitch),i.bZ(O,O,-E.angle),i.b_(O,O,i.al(E._center.lat)),i.e8(O,O,-i.al(E._center.lng));const z=i.c3(new Float32Array(16),O),F=i.az([],E.starsProjMatrix,z),G=i.e4([],z),U=i.e9([],G),Z=[0,1,0];i.dz(Z,Z,U),i.b$(Z,Z,this.params.sizeMultiplier);const te=[1,0,0];i.dz(te,te,U),i.b$(te,te,this.params.sizeMultiplier);const ee=(oe=Z,re=te,fe=g,{u_matrix:Float32Array.from(F),u_up:oe,u_right:re,u_intensity_multiplier:fe});var oe,re,fe;s.uploadCommonUniforms(x,C),this.starsVx&&this.starsIdx&&C.draw(s,w.TRIANGLES,Jt.disabled,In.disabled,this.colorModeAlphaBlendedWriteRGB,Mn.disabled,ee,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Ju(m,s){const h=[...m],g=s.cameraWorldSizeForFog/s.worldSize,x=i.bx([]);return i.cE(x,x,[g,g,1]),i.az(h,x,h),i.az(h,s.worldToFogMatrix,h),h}function Dt(m,s,h,g,x){const w=h.material,E=g.context,{baseColorTexture:C,metallicRoughnessTexture:O}=w.pbrMetallicRoughness,{normalTexture:z,occlusionTexture:F,emissionTexture:G}=w;function U(te,ee,oe){if(te&&(m.push(ee),E.activeTexture.set(E.gl.TEXTURE0+oe),te.gfxTexture)){const{minFilter:re,magFilter:fe,wrapS:_e,wrapT:be}=te.sampler;te.gfxTexture.bindExtraParam(re,fe,_e,be)}}U(C,"HAS_TEXTURE_u_baseColorTexture",fa.BaseColor),U(O,"HAS_TEXTURE_u_metallicRoughnessTexture",fa.MetallicRoughness),U(z,"HAS_TEXTURE_u_normalTexture",fa.Normal),U(F,"HAS_TEXTURE_u_occlusionTexture",fa.Occlusion),U(G,"HAS_TEXTURE_u_emissionTexture",fa.Emission),x&&(x.texture||(x.texture=new i.ed(g.context,x.image,[x.image.height,x.image.height,x.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+fa.LUT),x.texture&&x.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),h.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(h.texcoordBuffer)),h.colorBuffer&&(m.push(h.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(h.colorBuffer)),h.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(h.normalBuffer)),h.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(h.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||m.push("DIFFUSE_SHADED");const Z=g.shadowRenderer;Z&&(m.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Z.useNormalOffset&&m.push("NORMAL_OFFSET"))}function qt(m,s,h,g,x,w){const E=h.paint.get("model-opacity").constantOr(1),C=s.context,O=new Jt(s.context.gl.LEQUAL,Jt.ReadWrite,s.depthRangeFor3D),z=s.transform,F=m.mesh,G=F.material,U=G.pbrMetallicRoughness,Z=s.style.fog;let te;te=s.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:i.az([],g.zScaleMatrix,m.nodeModelMatrix),i.az(te,g.negCameraPosMatrix,te);const ee=i.bi([],te);i.ee(ee,ee);const oe=h.paint.get("model-color-use-theme").constantOr("default")==="none",re=h.paint.get("model-emissive-strength").constantOr(0),fe=Zu(new Float32Array(m.worldViewProjection),new Float32Array(te),new Float32Array(ee),null,s,E,U.baseColorFactor.toRenderColor(null),G.emissiveFactor,U.metallicFactor,U.roughnessFactor,G,re,h),_e={defines:[]},be=[],Pe=s.shadowRenderer;Pe&&(Pe.useNormalOffset=!1),Dt(_e.defines,be,F,s,oe?null:h.lut);let Ee=null;if(Z){const Me=Ju(m.nodeModelMatrix,s.transform);if(Ee=new Float32Array(Me),z.projection.name!=="globe"){const ke=F.aabb.min,Qe=F.aabb.max,[qe,mt]=Z.getOpacityForBounds(Me,ke[0],ke[1],Qe[0],Qe[1]);_e.overrideFog=qe>=Ht||mt>=Ht}}const Ae=Uu(s,h.paint.get("model-cutoff-fade-range"));Ae.shouldRenderCutoff&&_e.defines.push("RENDER_CUTOFF");const we=s.getOrCreateProgram("model",_e);s.uploadCommonUniforms(C,we,null,Ee,Ae),s.renderPass!=="shadow"&&Pe&&Pe.setupShadowsFromMatrix(m.nodeModelMatrix,we),we.draw(s,C.gl.TRIANGLES,O,x,w,F.material.doubleSided?Mn.disabled:Mn.backCCW,fe,h.id,F.vertexBuffer,F.indexBuffer,F.segments,h.paint,s.transform.zoom,void 0,be)}function Qu(m,s,h,g,x,w,E){let C;C=m.projection.name==="globe"?i.ef(h,m):[...h],i.az(C,C,s.matrix);const O=i.az([],g,C);if(s.meshes)for(const z of s.meshes){if(z.material.alphaMode!=="BLEND"){E.push({mesh:z,depth:0,modelIndex:x,worldViewProjection:O,nodeModelMatrix:C});continue}const F=i.ad([],z.centroid,O);!m.isOrthographic&&F[2]<=0||w.push({mesh:z,depth:F[2],modelIndex:x,worldViewProjection:O,nodeModelMatrix:C})}if(s.children)for(const z of s.children)Qu(m,z,h,g,x,w,E)}function Di(m,s,h,g){const x=h.shadowRenderer;if(!x)return;const w=x.getShadowPassDepthMode(),E=x.getShadowPassColorMode(),C=x.calculateShadowPassMatrixFromMatrix(s),O=ES(C);h.getOrCreateProgram("modelDepth",{defines:h._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(h,h.context.gl.TRIANGLES,w,In.disabled,E,Mn.backCCW,O,g.id,m.vertexBuffer,m.indexBuffer,m.segments,g.paint,h.transform.zoom,void 0,void 0)}function Ke(m,s,h){const g=s.updateZoomBasedPaintProperties(),x=function(w,E,C){let O,z,F,G=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&G>0){const U=w.terrain,Z=U.findDEMTileFor(C);Z&&Z.dem?O=i.el.create(U,C,Z):G=0}if(G===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),G===E.validForExaggeration&&(G===0||O&&O._demTile&&O._demTile.tileID===E.validForDEMTile.id&&O._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const U in E.instancesPerModel){const Z=E.instancesPerModel[U];for(let te=0;te<Z.instancedDataArray.length;++te){const ee=(O?G*O.getElevationAt(0|Z.instancedDataArray.float32[16*te],0|Z.instancedDataArray.float32[16*te+1],!0,!0):0)+Z.instancesEvaluatedElevation[te];Z.instancedDataArray.float32[16*te+6]=ee,z=z?Math.min(E.terrainElevationMin,ee):ee,F=F?Math.max(E.terrainElevationMax,ee):ee}}return E.terrainElevationMin=z||0,E.terrainElevationMax=F||0,E.validForExaggeration=G,E.validForDEMTile=O&&O._demTile?{id:O._demTile.tileID,timestamp:O._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,s,h);(g||x)&&(s.uploaded=!1,s.upload(m.context))}const el={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cV([0,0,0],[i.aj,i.aj,0])};function Gg(m,s){const h=1<<m.canonical.z,g=s.getFreeCameraOptions().position,x=s.elevation,w=m.canonical.x/h,E=(m.canonical.x+1)/h,C=m.canonical.y/h,O=(m.canonical.y+1)/h;let z=s._centerAltitude;if(x){const Z=x.getMinMaxForTile(m);Z&&Z.max>z&&(z=Z.max)}const F=i.aD(g.x,w,E)-g.x,G=i.aD(g.y,C,O)-g.y,U=i.c6(z,s.center.lat)-g.z;return s._zoomFromMercatorZ(Math.sqrt(F*F+G*G+U*U))}function Wg(m,s,h,g,x,w,E){const C=m.context,O=m.renderPass==="shadow",z=m.shadowRenderer,F=O&&z?z.getShadowPassDepthMode():new Jt(C.gl.LEQUAL,Jt.ReadWrite,m.depthRangeFor3D),G=m.isTileAffectedByFog(w);if(h.meshes)for(const U of h.meshes){const Z=["MODEL_POSITION_ON_GPU"],te=[];let ee,oe,re;g.instancedDataArray.length>20&&Z.push("INSTANCED_ARRAYS");const fe=Uu(m,s.paint.get("model-cutoff-fade-range"));if(fe.shouldRenderCutoff&&Z.push("RENDER_CUTOFF"),O&&z)ee=m.getOrCreateProgram("modelDepth",{defines:Z}),oe=ES(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(h.matrix)),re=z.getShadowPassColorMode();else{Dt(Z,te,U,m,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),ee=m.getOrCreateProgram("model",{defines:Z,overrideFog:G});const be=U.material,Pe=be.pbrMetallicRoughness,Ee=s.paint.get("model-opacity").constantOr(1),Ae=s.paint.get("model-emissive-strength").constantOr(0);oe=Zu(w.expandedProjMatrix,Float32Array.from(h.matrix),new Float32Array(16),null,m,Ee,Pe.baseColorFactor.toRenderColor(null),be.emissiveFactor,Pe.metallicFactor,Pe.roughnessFactor,be,Ae,s,x),z&&(E.shadowUniformsInitialized?ee.setShadowUniformValues(C,z.getShadowUniformValues()):(z.setupShadows(w.toUnwrapped(),ee,"model-tile",w.overscaledZ),E.shadowUniformsInitialized=!0)),re=fe.shouldRenderCutoff||Ee<1||be.alphaMode!=="OPAQUE"?Zn.alphaBlended:Zn.unblended}m.uploadCommonUniforms(C,ee,w.toUnwrapped(),null,fe);const _e=U.material.doubleSided?Mn.disabled:Mn.backCCW;if(g.instancedDataArray.length>20)te.push(g.instancedDataBuffer),ee.draw(m,C.gl.TRIANGLES,F,In.disabled,re,_e,oe,s.id,U.vertexBuffer,U.indexBuffer,U.segments,s.paint,m.transform.zoom,void 0,te,g.instancedDataArray.length);else{const be=O?"u_instance":"u_normal_matrix";for(let Pe=0;Pe<g.instancedDataArray.length;++Pe)oe[be]=new Float32Array(g.instancedDataArray.arrayBuffer,64*Pe,16),ee.draw(m,C.gl.TRIANGLES,F,In.disabled,re,_e,oe,s.id,U.vertexBuffer,U.indexBuffer,U.segments,s.paint,m.transform.zoom,void 0,te)}}if(h.children)for(const U of h.children)Wg(m,s,U,g,x,w,E)}const L0=[1,-1,1];function RS(m,s,h,g){if(!h.modelManager)return!0;const x=h.modelManager;if(!h.shadowRenderer)return!0;const w=h.shadowRenderer,E=s.aabb;let C=!0,O=m.maxHeight;if(O===0){let F=0;for(const G in m.instancesPerModel){const U=x.getModel(G,g);U?F=Math.max(F,Math.max(Math.max(U.aabb.max[0],U.aabb.max[1]),U.aabb.max[2])):C=!1}O=m.maxScale*F*1.41+m.maxVerticalOffset,C&&(m.maxHeight=O)}E.max[2]=O,E.min[2]+=m.terrainElevationMin,E.max[2]+=m.terrainElevationMax,i.ad(E.min,E.min,s.tileMatrix),i.ad(E.max,E.max,s.tileMatrix);const z=E.intersects(w.getCurrentCascadeFrustum());return h.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=z===2),z===0}function DS(m,s){const h=m.uniformValues.u_cutoff_params[0],g=m.uniformValues.u_cutoff_params[1],x=m.uniformValues.u_cutoff_params[2],w=m.uniformValues.u_cutoff_params[3];return g===h||w===x?1:i.aD(((s-h)/(g-h)-x)/(w-x),0,1)}function vd(m,s,h,g){if(s.pitch<20)return 1;const x=s.getWorldToCameraMatrix();i.az(x,x,m);const w=i.ei(h.min[0],h.min[1],h.min[2],1);let E=i.aA(i.ej(),w,x),C=E,O=E;w[1]=h.max[1],E=i.aA(i.ej(),w,x),C=E[1]<C[1]?E:C,O=E[1]>O[1]?E:O,w[0]=h.max[0],E=i.aA(i.ej(),w,x),C=E[1]<C[1]?E:C,O=E[1]>O[1]?E:O,w[1]=h.min[1],E=i.aA(i.ej(),w,x),C=E[1]<C[1]?E:C,O=E[1]>O[1]?E:O;const z=i.aD(g[0],0,1),F=100*s.pixelsPerMeter*i.aD(g[1],0,1),G=i.aD(g[2],0,1),U=i.ek(i.ej(),C,O,z),Z=Math.tan(.5*s.fovX),te=-U[2]*Z;if(F===0)return U[1]<-Math.abs(te)?G:1;const ee=(-Math.abs(te)-U[1])/F,oe=(fe,_e,be)=>(1-be)*fe+be*_e,re=i.aD(oe(1,G,ee),G,1);return oe(1,re,i.aD((s.pitch-20)/20,0,1))}class LI{}class zI{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,h,g){{const G=this._storage.get(h.id);if(G)return G.lastUsedFrameIdx=s,G.buf}const x=g.gl,w=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),E=new ArrayBuffer(w),C=new Int16Array(E);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const O=new i.en;for(let G=0;G<w/2;G+=3){const U=C[G],Z=C[G+1],te=C[G+2];O.emplaceBack(U,Z),O.emplaceBack(Z,te),O.emplaceBack(te,U)}const z=g.bindVertexArrayOES.current,F=new LI;return F.buf=new ic(g,O),F.lastUsedFrameIdx=s,this._storage.set(h.id,F),g.bindVertexArrayOES.set(z),F.buf}update(s){for(const[h,g]of this._storage)s-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(h))}destroy(){for(const[s,h]of this._storage)h.buf.destroy(),this._storage.delete(s)}}class LS{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Hg=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class z0{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class N0{constructor(s,h){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...h,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...h,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const zS=i.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class qg{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,h){const g=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const E=new i.eo,C=new i.a_;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(1,1),E.emplaceBack(-1,1),C.emplaceBack(0,1,2),C.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(E,zS.members),this.vignetteIdx=s.context.createIndexBuffer(C)}const x=i.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,g);const E={u_vignetteShape:(w={vignetteShape:[h.start,h.range,Math.pow(10,h.fadePower)],vignetteColor:[h.color.r,h.color.g,h.color.b,h.color.a*h.strength]}).vignetteShape,u_vignetteColor:w.vignetteColor};g.draw(s,s.context.gl.TRIANGLES,Jt.disabled,In.disabled,Zn.alphaBlended,Mn.disabled,E,"vignette",this.vignetteVx,this.vignetteIdx,x)}var w}}class Cp{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,h){const g=s.getFreeCameraOptions().position,x=g.toAltitude(),w=g.toLngLat(),E=i.al(w.lng),C=i.al(w.lat),O=s.pixelsPerMeter/h,z=E*i.eq,F=i.eq*Math.log(Math.tan(Math.PI/4+C/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const G=-this._offsetYPrev+F,U=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+z)*O,this._accumulatedOffsetY+=G*O,this._accumulatedElevation+=U*O,this._offsetXPrev=z,this._offsetYPrev=F,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function eh(m,s){return[-(m[0]-Math.floor(m[0]/s)*s),-(m[1]-Math.floor(m[1]/s)*s),-(m[2]-Math.floor(m[2]/s)*s)]}function F0(m){const s=i.ea(1323123451230),h=[];for(let g=0;g<m;++g){const x=2*s()-1,w=2*s()-1,E=2*s()-1;h.push(i.cS(x,w,E))}return h}function nu(m,s,h,g,x){const w=i.aD((x-h)/(g-h),0,1);return(1-w)*m+w*s}class ma{constructor(s){this._movement=new Cp,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new qg,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,h){const g=s.transform;this._movement.update(g,this._ppmScaleFactor);const x=g.starsProjMatrix,w=i.bY([]);i.b_(w,w,i.al(90)-g._pitch),i.bZ(w,w,-g.angle);const E=i.c3(new Float32Array(16),w),C=i.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),O=i.ee([],C),z=i.az([],O,E),F=Date.now()/1e3;return this._accumulatedTimeFromStart+=(F-this._prevTime)*h,this._prevTime=F,{projectionMatrix:x,modelviewMatrix:z}}}class NI extends ma{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new N0(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const h=s.context;if(!this.particlesVx){const g=F0(this.particlesCount),x=new i.er,w=new i.a_;let E=0;const C=i.ea(1323123451230);for(let O=0;O<g.length;++O){const z=g[O],F=[2*C()-1,C(),C(),C()];x.emplaceBack(z[0],z[1],z[2],-1,-1,...F),x.emplaceBack(z[0],z[1],z[2],1,-1,...F),x.emplaceBack(z[0],z[1],z[2],1,1,...F),x.emplaceBack(z[0],z[1],z[2],-1,1,...F),w.emplaceBack(E+0,E+1,E+2),w.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=h.createVertexBuffer(x,Hg.members),this.particlesIdx=h.createIndexBuffer(w)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const h=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=s.transform.zoom;if(h.revealStart>g)return;const x=nu(0,1,h.revealStart,h.revealStart+h.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const w=structuredClone(this._params);let E=[-w.direction.x,w.direction.y,-100];i.au(E,E);const C=structuredClone(this._vignetteParams);C.strength*=x,w.overrideStyleParameters||(w.intensity=s.style.rain.state.density,w.timeFactor=s.style.rain.state.intensity,w.color=structuredClone(s.style.rain.state.color),E=structuredClone(s.style.rain.state.direction),w.screenThinning.intensity=s.style.rain.state.centerThinning,w.dropletSizeX=s.style.rain.state.dropletSize[0],w.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],w.distortionStrength=100*s.style.rain.state.distortionStrength,C.strength=1,C.color=structuredClone(s.style.rain.state.vignetteColor));const O=this.updateOnRender(s,w.timeFactor),z=s.context,F=z.gl,G=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new i.T(z,{width:s.width,height:s.height,data:null},F.RGBA8)),w.distortionStrength>0&&(z.activeTexture.set(F.TEXTURE0),this.screenTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),F.copyTexSubImage2D(F.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const U=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(z,U),z.activeTexture.set(F.TEXTURE0),this.screenTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE);const Z=[w.color.r,w.color.g,w.color.b,w.color.a],te=(ee,oe)=>{const re=eh(this._movement.getPosition(),ee),fe=w.dropletSizeX,_e=w.dropletSizeX*w.dropletSizeYScale,be=s.width/2,Pe=s.height/2,Ee=nu(0,w.screenThinning.start,0,1,w.screenThinning.intensity),Ae=nu(.001,w.screenThinning.range,0,1,w.screenThinning.intensity),we=nu(0,w.screenThinning.particleOffset,0,1,w.screenThinning.intensity),Me=(ke={modelview:O.modelviewMatrix,projection:O.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:re,velocityConeAperture:w.velocityConeAperture,velocity:w.velocity,boxSize:ee,rainDropletSize:[fe,_e],distortionStrength:w.distortionStrength,rainDirection:E,color:Z,screenSize:[G.width,G.height],thinningCenterPos:[be,Pe],thinningShape:[Ee,Ae,Math.pow(10,w.screenThinning.fadePower)],thinningAffectedRatio:w.screenThinning.affectedRatio,thinningParticleOffset:we,shapeDirectionalPower:w.shapeDirPower,shapeNormalPower:w.shapeNormalPower,mode:oe?0:1},{u_modelview:Float32Array.from(ke.modelview),u_projection:Float32Array.from(ke.projection),u_time:ke.time,u_cam_pos:ke.camPos,u_texScreen:0,u_velocityConeAperture:ke.velocityConeAperture,u_velocity:ke.velocity,u_boxSize:ke.boxSize,u_rainDropletSize:ke.rainDropletSize,u_distortionStrength:ke.distortionStrength,u_rainDirection:ke.rainDirection,u_color:ke.color,u_screenSize:ke.screenSize,u_thinningCenterPos:ke.thinningCenterPos,u_thinningShape:ke.thinningShape,u_thinningAffectedRatio:ke.thinningAffectedRatio,u_thinningParticleOffset:ke.thinningParticleOffset,u_shapeDirectionalPower:ke.shapeDirectionalPower,u_shapeNormalPower:ke.shapeNormalPower,u_mode:ke.mode});var ke;const Qe=Math.round(w.intensity*this.particlesCount),qe=i.bd.simpleSegment(0,0,4*Qe,2*Qe);U.draw(s,F.TRIANGLES,Jt.disabled,In.disabled,Zn.alphaBlended,Mn.disabled,Me,"rain_particles",this.particlesVx,this.particlesIdx,qe)};w.distortionStrength>0&&te(w.boxSize,!0),te(w.boxSize,!1),this._vignette.draw(s,C)}}const Ip=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class yi extends ma{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new N0(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const h=s.context;if(!this.particlesVx){const g=F0(this.particlesCount),x=new i.es,w=new i.a_;let E=0;const C=i.ea(1323123451230);for(let O=0;O<g.length;++O){const z=g[O],F=C(),G=C(),U=C(),Z=[O/g.length,F,G,U],te=[C(),C()];x.emplaceBack(z[0],z[1],z[2],-1,-1,...Z,...te),x.emplaceBack(z[0],z[1],z[2],1,-1,...Z,...te),x.emplaceBack(z[0],z[1],z[2],1,1,...Z,...te),x.emplaceBack(z[0],z[1],z[2],-1,1,...Z,...te),w.emplaceBack(E+0,E+1,E+2),w.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=h.createVertexBuffer(x,Ip.members),this.particlesIdx=h.createIndexBuffer(w)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const h=structuredClone(this._params);let g=[-h.direction.x,h.direction.y,-100];i.au(g,g);const x=structuredClone(this._vignetteParams),w=h.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},E=s.transform.zoom;if(w.revealStart>E)return;const C=nu(0,1,w.revealStart,w.revealStart+w.revealRange,E);x.strength*=C,h.overrideStyleParameters||(h.intensity=s.style.snow.state.density,h.timeFactor=s.style.snow.state.intensity,h.color=structuredClone(s.style.snow.state.color),g=structuredClone(s.style.snow.state.direction),h.screenThinning.intensity=s.style.snow.state.centerThinning,h.billboardSize=2.79*s.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(s.style.snow.state.vignetteColor));const O=this.updateOnRender(s,h.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const z=s.context,F=z.gl,G=s.transform,U=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(z,U),((Z,te,ee)=>{const oe=eh(this._movement.getPosition(),Z),re=G.width/2,fe=G.height/2,_e=nu(0,ee.screenThinning.start,0,1,ee.screenThinning.intensity),be=nu(.001,ee.screenThinning.range,0,1,ee.screenThinning.intensity),Pe=nu(0,ee.screenThinning.particleOffset,0,1,ee.screenThinning.intensity),Ee=(Ae={modelview:O.modelviewMatrix,projection:O.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:oe,velocityConeAperture:ee.velocityConeAperture,velocity:ee.velocity,horizontalOscillationRadius:ee.horizontalOscillationRadius,horizontalOscillationRate:ee.horizontalOscillationRate,boxSize:Z,billboardSize:1*ee.billboardSize,simpleShapeParameters:[ee.shapeFadeStart,ee.shapeFadePower],screenSize:[G.width,G.height],thinningCenterPos:[re,fe],thinningShape:[_e,be,Math.pow(10,ee.screenThinning.fadePower)],thinningAffectedRatio:ee.screenThinning.affectedRatio,thinningParticleOffset:Pe,color:[ee.color.r,ee.color.g,ee.color.b,ee.color.a],direction:g},{u_modelview:Float32Array.from(Ae.modelview),u_projection:Float32Array.from(Ae.projection),u_time:Ae.time,u_cam_pos:Ae.camPos,u_velocityConeAperture:Ae.velocityConeAperture,u_velocity:Ae.velocity,u_horizontalOscillationRadius:Ae.horizontalOscillationRadius,u_horizontalOscillationRate:Ae.horizontalOscillationRate,u_boxSize:Ae.boxSize,u_billboardSize:Ae.billboardSize,u_simpleShapeParameters:Ae.simpleShapeParameters,u_screenSize:Ae.screenSize,u_thinningCenterPos:Ae.thinningCenterPos,u_thinningShape:Ae.thinningShape,u_thinningAffectedRatio:Ae.thinningAffectedRatio,u_thinningParticleOffset:Ae.thinningParticleOffset,u_particleColor:Ae.color,u_direction:Ae.direction});var Ae;const we=Math.round(ee.intensity*this.particlesCount),Me=i.bd.simpleSegment(0,0,4*we,2*we);this.particlesVx&&this.particlesIdx&&U.draw(s,F.TRIANGLES,Jt.disabled,In.disabled,Zn.alphaBlended,Mn.disabled,Ee,"snow_particles",this.particlesVx,this.particlesIdx,Me)})(h.boxSize,0,h),this._vignette.draw(s,x)}}const vr={symbol:function(m,s,h,g,x){if(m.renderPass!=="translucent")return;const w=In.disabled,E=m.colorModeForRenderPass(),C=h.layout.get("text-variable-anchor"),O=h.layout.get("text-size-scale-range"),z=i.aD(m.scaleFactor,O[0],O[1]);C&&function(U,Z,te,ee,oe,re,fe,_e){const be=Z.transform,Pe=oe==="map",Ee=re==="map";for(const Ae of U){const we=ee.getTile(Ae),Me=we.getBucket(te);if(!Me||!Me.text||!Me.text.segments.get().length)continue;const ke=i.bH(Me.textSizeData,be.zoom,_e),Qe=sp(Ae,Me.getProjection(),be),qe=be.calculatePixelsToTileUnitsMatrix(we),mt=Qh(Qe,we.tileID.canonical,Ee,Pe,be,Me.getProjection(),qe),dt=Me.hasIconTextFit()&&Me.hasIconData();ke&&C0(Me,Pe,Ee,fe,be,mt,Ae,Math.pow(2,be.zoom-we.tileID.overscaledZ),ke,dt)}}(g,m,h,s,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),x,z);const F=h.paint.get("icon-opacity").constantOr(1)!==0,G=h.paint.get("text-opacity").constantOr(1)!==0;h.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(F||G)?$g(m,s,h,g,w,E):(F&&$g(m,s,h,g,w,E,{onlyIcons:!0}),G&&$g(m,s,h,g,w,E,{onlyText:!0})),s.map.showCollisionBoxes&&(md(m,s,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),md(m,s,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,s,h,g){if(m.renderPass!=="translucent")return;const x=h.paint.get("circle-opacity"),w=h.paint.get("circle-stroke-width"),E=h.paint.get("circle-stroke-opacity"),C=h.layout.get("circle-sort-key").constantOr(1)!==void 0,O=h.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(w.constantOr(1)===0||E.constantOr(1)===0))return;const z=m.context,F=z.gl,G=m.transform,U=m.depthModeForSublayer(0,Jt.ReadOnly),Z=In.disabled,te=m.colorModeForDrapableLayerRenderPass(O),ee=G.projection.name==="globe",oe=[i.ay(G.center.lng),i.aH(G.center.lat)],re=[];for(let _e=0;_e<g.length;_e++){const be=g[_e],Pe=s.getTile(be),Ee=Pe.getBucket(h);if(!Ee||Ee.projection.name!==G.projection.name)continue;const Ae=Ee.programConfigurations.get(h.id),we=i.dK(h),Me=m.isTileAffectedByFog(be);ee&&we.push("PROJECTION_GLOBE_VIEW"),we.push("DEPTH_D24"),m.terrain&&G.depthOcclusionForSymbolsAndCircles&&we.push("DEPTH_OCCLUSION");const ke=m.getOrCreateProgram("circle",{config:Ae,defines:we,overrideFog:Me}),Qe=Ee.layoutVertexBuffer,qe=Ee.globeExtVertexBuffer,mt=Ee.indexBuffer,dt=G.projection.createInversionMatrix(G,be.canonical),Ot={programConfiguration:Ae,program:ke,layoutVertexBuffer:Qe,globeExtVertexBuffer:qe,indexBuffer:mt,uniformValues:i.dL(m,be,Pe,dt,oe,h),tile:Pe};if(C){const Ze=Ee.segments.get();for(const et of Ze)re.push({segments:new i.bd([et]),sortKey:et.sortKey,state:Ot})}else re.push({segments:Ee.segments,sortKey:0,state:Ot})}C&&re.sort((_e,be)=>_e.sortKey-be.sortKey);const fe={useDepthForOcclusion:G.depthOcclusionForSymbolsAndCircles};for(const _e of re){const{programConfiguration:be,program:Pe,layoutVertexBuffer:Ee,globeExtVertexBuffer:Ae,indexBuffer:we,uniformValues:Me,tile:ke}=_e.state,Qe=_e.segments;m.terrain&&m.terrain.setupElevationDraw(ke,Pe,fe),m.uploadCommonUniforms(z,Pe,ke.tileID.toUnwrapped()),Pe.draw(m,F.TRIANGLES,U,Z,te,Mn.disabled,Me,h.id,Ee,we,Qe,h.paint,G.zoom,be,[Ae])}},heatmap:function(m,s,h,g){if(h.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const x=m.context,w=x.gl,E=In.disabled,C=new Zn([w.ONE,w.ONE,w.ONE,w.ONE],i.am.transparent,[!0,!0,!0,!0]);(function(Z,te,ee,oe){const re=Z.gl,fe=te.width*oe,_e=te.height*oe;Z.activeTexture.set(re.TEXTURE1),Z.viewport.set([0,0,fe,_e]);let be=ee.heatmapFbo;if(!be||be&&(be.width!==fe||be.height!==_e)){be&&be.destroy();const Pe=re.createTexture();re.bindTexture(re.TEXTURE_2D,Pe),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_S,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_T,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,re.LINEAR),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,re.LINEAR),be=ee.heatmapFbo=Z.createFramebuffer(fe,_e,!0,null),function(Ee,Ae,we,Me,ke,Qe){const qe=Ee.gl;qe.texImage2D(qe.TEXTURE_2D,0,Ee.extRenderToTextureHalfFloat?qe.RGBA16F:qe.RGBA,ke,Qe,0,qe.RGBA,Ee.extRenderToTextureHalfFloat?qe.HALF_FLOAT:qe.UNSIGNED_BYTE,null),Me.colorAttachment.set(we)}(Z,0,Pe,be,fe,_e)}else re.bindTexture(re.TEXTURE_2D,be.colorAttachment.get()),Z.bindFramebuffer.set(be.framebuffer)})(x,m,h,m.transform.projection.name==="globe"?.5:.25),x.clear({color:i.am.transparent});const O=m.transform,z=O.projection.name==="globe",F=z?["PROJECTION_GLOBE_VIEW"]:[],G=z?Mn.frontCCW:Mn.disabled,U=[i.ay(O.center.lng),i.aH(O.center.lat)];for(let Z=0;Z<g.length;Z++){const te=g[Z];if(s.hasRenderableParent(te))continue;const ee=s.getTile(te),oe=ee.getBucket(h);if(!oe||oe.projection.name!==O.projection.name)continue;const re=m.isTileAffectedByFog(te),fe=oe.programConfigurations.get(h.id),_e=m.getOrCreateProgram("heatmap",{config:fe,defines:F,overrideFog:re}),{zoom:be}=m.transform;m.terrain&&m.terrain.setupElevationDraw(ee,_e),m.uploadCommonUniforms(x,_e,te.toUnwrapped());const Pe=O.projection.createInversionMatrix(O,te.canonical);_e.draw(m,w.TRIANGLES,Jt.disabled,E,C,G,bS(m,te,ee,Pe,U,be,h.paint.get("heatmap-intensity")),h.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,h.paint,m.transform.zoom,fe,z?[oe.globeExtVertexBuffer]:null)}x.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(x,w){const E=x.context,C=E.gl,O=w.heatmapFbo;if(!O)return;E.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,O.colorAttachment.get()),E.activeTexture.set(C.TEXTURE1);let z=w.colorRampTexture;z||(z=w.colorRampTexture=new i.T(E,w.colorRamp,C.RGBA8)),z.bind(C.LINEAR,C.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,C.TRIANGLES,Jt.disabled,In.disabled,x.colorModeForRenderPass(),Mn.disabled,((F,G,U,Z)=>({u_image:0,u_color_ramp:1,u_opacity:G.paint.get("heatmap-opacity")}))(0,w),w.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,w.paint,x.transform.zoom)}(m,h))},line:function(m,s,h,g){if(m.renderPass!=="translucent")return;const x=h.paint.get("line-opacity"),w=h.paint.get("line-width");if(x.constantOr(1)===0||w.constantOr(1)===0)return;const E=h.paint.get("line-emissive-strength"),C=h.paint.get("line-occlusion-opacity"),O=h.layout.get("line-elevation-reference"),z=h.layout.get("line-width-unit")==="meters",F=O==="sea",G=!(!m.terrain||!m.terrain.enabled),U=m.context,Z=U.gl;if(h.hasElevatedBuckets&&m.transform.projection.name==="globe")return;const te=h.layout.get("line-cross-slope"),ee=te!==void 0,oe=te<1,re=m.colorModeForDrapableLayerRenderPass(E),fe=m.terrain&&m.terrain.renderingToTexture,_e=fe?1:i.q.devicePixelRatio,be=h.paint.get("line-dasharray"),Pe=be.constantOr(1),Ee=h.layout.get("line-cap"),Ae=be.constantOr(null),we=Ee.constantOr(null),Me=h.paint.get("line-pattern"),ke=Me.constantOr(1),Qe=h.paint.get("line-pattern-cross-fade"),qe=Me.constantOr(null),mt=h.paint.get("line-opacity").constantOr(1);let dt=!ke&&mt!==1||m.depthOcclusion&&C>0&&C<1;const Ot=h.paint.get("line-gradient"),Ze=ke?"linePattern":"line",et=i.dM(h);let We;if(fe&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(dt=!1),C!==0&&m.depthOcclusion){const gt=h.paint._values["line-opacity"];gt&&gt.value&&gt.value.kind==="constant"?We=gt.value:i.w(`Occlusion opacity for layer ${h.id} is supported only when line-opacity isn't data-driven.`)}w.value.kind!=="constant"&&w.value.isLineProgressConstant===!1&&et.push("VARIABLE_LINE_WIDTH");const vt=(gt,Et,At,Yt,an,Xt)=>{for(const ln of gt){const Qt=s.getTile(ln);if(ke&&!Qt.patternsLoaded())continue;const Sn=Qt.getBucket(h);if(!Sn||Sn.elevationType!=="none"&&!an||Sn.elevationType==="none"&&an)continue;m.prepareDrawTile();const Rn=[...Et],tr=m.shadowRenderer,Nr=Sn.elevationType==="road"&&!!tr&&tr.enabled;let kr=[0,0,0];if(Nr){const Vn=m.style.directionalLight,fi=m.style.ambientLight;Vn&&fi&&(kr=Sl(m.style,Vn,fi)),Rn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const rr=Sn.programConfigurations.get(h.id);let Oi=!1;if(qe&&Qt.imageAtlas){const Vn=i.dN.from(qe),fi=Vn.getPrimary().scaleSelf(_e).toString(),mr=Qt.imageAtlas.patternPositions.get(fi),pi=Vn.getSecondary(),Sr=pi?Qt.imageAtlas.patternPositions.get(pi.scaleSelf(_e).toString()):null;Oi=!!mr&&!!Sr,mr&&rr.setConstantPatternPositions(mr,Sr)}Qe>0&&(Oi||rr.getPatternTransitionVertexBuffer("line-pattern"))&&Rn.push("LINE_PATTERN_TRANSITION");const wi=m.isTileAffectedByFog(ln),Fn=m.getOrCreateProgram(Ze,{config:rr,defines:Rn,overrideFog:wi,overrideRtt:!an&&void 0});if(!ke&&Ae&&we&&Qt.lineAtlas){const Vn=Qt.lineAtlas.getDash(Ae,we);Vn&&rr.setConstantPatternPositions(Vn)}Nr&&tr.setupShadows(Qt.tileID.toUnwrapped(),Fn,"vector-tile",Qt.tileID.overscaledZ);let[hr,yr]=h.paint.get("line-trim-offset");(we==="round"||we==="square")&&hr!==yr&&(hr===0&&(hr-=1),yr===1&&(yr+=1));const Fr=fe?ln.projMatrix:null,Xi=z?1/Sn.tileToMeter/i.aw(Qt,1,m.transform.zoom):1,Li=z?1/Sn.tileToMeter/i.aw(Qt,1,Math.floor(m.transform.zoom)):1,qi=ke?i.dO(m,Qt,h,Fr,_e,Xi,Li,[hr,yr],kr,Qe):i.dP(m,Qt,h,Fr,Sn.lineClipsArray.length,_e,Xi,Li,[hr,yr],kr);if(Ot){const Vn=Sn.gradients[h.id];let fi=Vn.texture;if(h.gradientVersion!==Vn.version){let mr=256;if(h.stepInterpolant){const pi=s.getSource().maxzoom,Sr=ln.canonical.z===pi?Math.ceil(1<<m.transform.maxZoom-ln.canonical.z):1;mr=i.aD(i.dQ(Sn.maxLineLength/i.aj*1024*Sr),256,U.maxTextureSize)}Vn.gradient=i.dR({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:mr,image:Vn.gradient||void 0,clips:Sn.lineClipsArray}),Vn.texture?Vn.texture.update(Vn.gradient):Vn.texture=new i.T(U,Vn.gradient,Z.RGBA8),Vn.version=h.gradientVersion,fi=Vn.texture}U.activeTexture.set(Z.TEXTURE1),fi.bind(h.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}Pe&&(U.activeTexture.set(Z.TEXTURE0),Qt.lineAtlasTexture&&Qt.lineAtlasTexture.bind(Z.LINEAR,Z.REPEAT),rr.updatePaintBuffers()),ke&&(U.activeTexture.set(Z.TEXTURE0),Qt.imageAtlasTexture&&Qt.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),rr.updatePaintBuffers()),an&&!F&&m.terrain.setupElevationDraw(Qt,Fn),m.uploadCommonUniforms(U,Fn,ln.toUnwrapped());const _i=Vn=>{We!=null&&(We.value=mt*C),Fn.draw(m,Z.TRIANGLES,At,Vn,re,Mn.disabled,qi,h.id,Sn.layoutVertexBuffer,Sn.indexBuffer,Sn.segments,h.paint,m.transform.zoom,rr,[Sn.layoutVertexBuffer2,Sn.patternVertexBuffer,Sn.zOffsetVertexBuffer]),We!=null&&(We.value=mt)};if(dt&&!an){const Vn=m.stencilModeForClipping(ln).ref;Vn===0&&fe&&U.clear({stencil:0});const fi={func:Z.EQUAL,mask:255};qi.u_alpha_discard_threshold=.8,_i(new In(fi,Vn,255,Z.KEEP,Z.KEEP,Z.INVERT)),qi.u_alpha_discard_threshold=0,_i(new In(fi,Vn,255,Z.KEEP,Z.KEEP,Z.KEEP))}else qi.u_alpha_discard_threshold=dt&&an&&Xt?.8:0,_i(an?Yt:m.stencilModeForClipping(ln))}};let at=m.depthModeForSublayer(0,Jt.ReadOnly);const Tt=new Jt(m.depthOcclusion?Z.GREATER:Z.LEQUAL,Jt.ReadOnly,m.depthRangeFor3D);if(h.hasNonElevatedBuckets){const gt=!fe&&m.terrain;C!==0&&gt?i.w(`Occlusion opacity for layer ${h.id} is supported on terrain only if the layer has line-z-offset enabled.`):gt?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${h.id}.`):vt(g,et,at,In.disabled,!1,!0)}if(h.hasElevatedBuckets){O==="hd-road-markup"?G||(at=Tt,et.push("ELEVATED_ROADS")):(et.push("ELEVATED"),at=Tt,ee&&et.push(oe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),F&&et.push("ELEVATION_REFERENCE_SEA"));const gt=dt?m.stencilModeFor3D():In.disabled;m.forceTerrainMode=!0,vt(g,et,at,gt,!0,!0),dt&&vt(g,et,at,gt,!0,!1),m.forceTerrainMode=!1}dt&&(m.resetStencilClippingMasks(),fe&&U.clear({stencil:0})),C===0||m.depthOcclusion||fe||m.layersWithOcclusionOpacity.push(m.currentLayer)},fill:function(m,s,h,g){const x=h.paint.get("fill-color"),w=h.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const E=h.paint.get("fill-emissive-strength"),C=m.colorModeForDrapableLayerRenderPass(E),O=h.paint.get("fill-pattern"),z=m.opaquePassEnabledForLayer()&&!O.constantOr(1)&&x.constantOr(i.am.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";let F="none";h.layout.get("fill-elevation-reference")!=="none"?F="road":h.paint.get("fill-z-offset").constantOr(1)!==0&&(F="offset");const G=!(!m.terrain||!m.terrain.enabled),U={painter:m,sourceCache:s,layer:h,coords:g,colorMode:C,elevationType:F,terrainEnabled:G,pass:z};if(m.renderPass!=="shadow")if(F!=="offset"){if(Zt(U,!1),F==="road"){const Z=!G&&m.renderPass==="translucent";Z&&Tp(m,s,h,g,"geometry"),Zt(U,!0,In.disabled),Z&&function(te){const{painter:ee,sourceCache:oe,layer:re,coords:fe,colorMode:_e}=te,be=ee.context.gl,Pe=te.painter.shadowRenderer,Ee=!!Pe&&Pe.enabled,Ae=new Jt(ee.context.gl.LEQUAL,Jt.ReadOnly,ee.depthRangeFor3D);let we=[0,0,0];if(Ee){const Me=ee.style.directionalLight,ke=ee.style.ambientLight;Me&&ke&&(we=Sl(ee.style,Me,ke))}for(const Me of fe){const ke=oe.getTile(Me),Qe=ke.getBucket(re);if(!Qe)continue;const qe=Qe.elevatedStructures;if(!qe||!qe.renderableSegments||qe.renderableSegments.segments[0].primitiveLength===0)continue;ee.prepareDrawTile();const mt=Qe.bufferData.programConfigurations.get(re.id),dt=ee.isTileAffectedByFog(Me),Ot=[];Ee&&Ot.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const Ze=ee.getOrCreateProgram("elevatedStructures",{config:mt,overrideFog:dt,defines:Ot}),et=ee.translatePosMatrix(Me.projMatrix,ke,re.paint.get("fill-translate"),re.paint.get("fill-translate-anchor"));Ee&&Pe.setupShadows(ke.tileID.toUnwrapped(),Ze,"vector-tile",ke.tileID.overscaledZ);const We=S0(et,we);ee.uploadCommonUniforms(ee.context,Ze,Me.toUnwrapped()),Ze.draw(ee,be.TRIANGLES,Ae,In.disabled,_e,Mn.backCCW,We,re.id,qe.vertexBuffer,qe.indexBuffer,qe.renderableSegments,re.paint,ee.transform.zoom,mt,[qe.vertexBufferNormal])}}(U)}}else Zt(U,!1,m.stencilModeFor3D());else m.shadowRenderer&&F==="road"&&!G&&function(Z){const{painter:te,sourceCache:ee,layer:oe,coords:re}=Z,fe=te.context.gl,_e=Z.painter.shadowRenderer;for(const be of re){const Pe=ee.getTile(be),Ee=Pe.getBucket(oe);if(!Ee)continue;const Ae=Ee.elevatedStructures;if(!Ae||!Ae.shadowCasterSegments||Ae.shadowCasterSegments.segments[0].primitiveLength===0)continue;te.prepareDrawTile();const we=Ee.bufferData.programConfigurations.get(oe.id),Me=te.isTileAffectedByFog(be),ke=te.getOrCreateProgram("elevatedStructuresDepth",{config:we,overrideFog:Me}),Qe=_e.calculateShadowPassMatrixFromTile(Pe.tileID.toUnwrapped());te.uploadCommonUniforms(te.context,ke,be.toUnwrapped());const qe={u_matrix:Qe,u_depth_bias:.001};ke.draw(te,fe.TRIANGLES,_e.getShadowPassDepthMode(),In.disabled,_e.getShadowPassColorMode(),Mn.disabled,qe,oe.id,Ae.vertexBuffer,Ae.indexBuffer,Ae.shadowCasterSegments,oe.paint,te.transform.zoom,we)}}(U)},"fill-extrusion":function(m,s,h,g){const x=h.paint.get("fill-extrusion-opacity"),w=m.context,E=w.gl,C=m.terrain,O=C&&C.renderingToTexture;if(x===0)return;const z=m.conflationActive&&m.style.isLayerClipped(h,s.getSource()),F=m.style.order.indexOf(h.fqid);if(z&&function(G,U,Z,te,ee){for(const oe of te){const re=U.getTile(oe).getBucket(Z);re&&(re.updateReplacement(oe,G.replacementSource,ee),re.uploadCentroid(G.context))}}(m,s,h,g,F),C||z)for(const G of g){const U=s.getTile(G).getBucket(h);U&&Jc(m.context,s,G,U,h,C,z)}if(m.renderPass==="shadow"&&m.shadowRenderer){const G=m.shadowRenderer;if(C&&x<.65&&h._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ab)return;const U=G.getShadowPassDepthMode(),Z=G.getShadowPassColorMode();Ep(m,s,h,g,U,In.disabled,Z,z)}else if(m.renderPass==="translucent"){const G=!h.paint.get("fill-extrusion-pattern").constantOr(1),U=h.paint.get("fill-extrusion-color").constantOr(i.am.white);if(!O&&U.a!==0){const Z=new Jt(m.context.gl.LEQUAL,Jt.ReadWrite,m.depthRangeFor3D);x===1&&G?Ep(m,s,h,g,Z,In.disabled,Zn.unblended,z):(Ep(m,s,h,g,Z,In.disabled,Zn.disabled,z),Ep(m,s,h,g,Z,m.stencilModeFor3D(),m.colorModeForRenderPass(),z),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&G&&(!C&&m.transform.projection.name!=="globe"||O)){const Z=h.paint.get("fill-extrusion-opacity"),te=h.paint.get("fill-extrusion-ambient-occlusion-intensity"),ee=h.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),oe=h.paint.get("fill-extrusion-flood-light-intensity"),re=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",fe=h.paint.get("fill-extrusion-flood-light-color").toRenderColor(re?null:h.lut).toArray01().slice(0,3),_e=te>0&&ee>0,be=oe>0,Pe=(Ae,we,Me)=>(1-Me)*Ae+Me*we,Ee=Ae=>{const we=m.depthModeForSublayer(1,Jt.ReadOnly,E.LEQUAL,!0),Me=h.paint.get(Ae?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ke=Pe(.1,3,Me),Qe=m._showOverdrawInspector;if(!Qe){const qe=new In({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),mt=new Zn([E.ONE,E.ONE,E.ONE,E.ONE],i.am.transparent,[!1,!1,!1,!0],E.MIN);Ku(m,s,h,g,we,qe,mt,Mn.disabled,Ae,"sdf",Z,te,ee,oe,fe,ke,z,!1)}{const qe=Qe?In.disabled:new In({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),mt=Qe?m.colorModeForRenderPass():new Zn([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],i.am.transparent,[!0,!0,!0,!0]);Ku(m,s,h,g,we,qe,mt,Mn.disabled,Ae,"color",Z,te,ee,oe,fe,ke,z,!1)}};if(O){const Ae=(we,Me,ke)=>{const Qe=m.depthModeForSublayer(1,Jt.ReadOnly,E.LEQUAL,!1),qe=h.paint.get(we?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),mt=Pe(.1,3,qe);{const dt=new Zn([E.ONE,E.ONE,E.ONE,E.ONE],i.am.transparent,[!1,!1,!1,!0]);Ku(m,s,h,g,Qe,In.disabled,dt,Mn.disabled,we,"clear",Z,te,ee,oe,fe,mt,z,Me)}{const dt=new In({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Ot=new Zn([E.ONE,E.ONE,E.ONE,E.ONE],i.am.transparent,[!1,!1,!1,!0],E.MIN);Ku(m,s,h,g,Qe,dt,Ot,Mn.disabled,we,"sdf",Z,te,ee,oe,fe,mt,z,Me)}{const dt=we?E.ZERO:E.ONE_MINUS_DST_ALPHA,Ot=new In({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),Ze=new Zn([dt,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],i.am.transparent,[!0,!0,!0,!0]);Ku(m,s,h,g,Qe,Ot,Ze,Mn.disabled,we,"color",Z,te,ee,oe,fe,mt,z,Me)}{const dt=new Zn([E.ONE,E.ONE,E.ONE,we?E.ZERO:E.ONE],i.am.transparent,[!1,!1,!1,!0],we?E.FUNC_ADD:E.MAX);Ku(m,s,h,g,Qe,In.disabled,dt,Mn.disabled,we,"clear",Z,te,ee,oe,fe,mt,z,Me,ke)}};if(_e||be){let we;if(m.prepareDrawTile(),C){const Me=C.drapeBufferSize[0],ke=C.drapeBufferSize[1];we=C.framebufferCopyTexture,we&&(!we||we.size[0]===Me&&we.size[1]===ke)||(we&&we.destroy(),we=C.framebufferCopyTexture=new i.T(w,new i.r({width:Me,height:ke}),E.RGBA8)),we.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,Me,ke)}_e&&Ae(!0,!1,we),be&&Ae(!1,!0,we)}}else _e&&Ee(!0),be&&Ee(!1),(_e||be)&&m.resetStencilClippingMasks()}}},hillshade:function(m,s,h,g){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;const x=m.context,w=m.terrain&&m.terrain.renderingToTexture,[E,C]=m.renderPass!=="translucent"||w?[{},g]:m.stencilConfigForOverlap(g);for(const O of C){const z=s.getTile(O);if(z.needsHillshadePrepare&&m.renderPass==="offscreen")c0(m,z,h);else if(m.renderPass==="translucent"){const F=m.depthModeForSublayer(0,Jt.ReadOnly),G=h.paint.get("hillshade-emissive-strength"),U=m.colorModeForDrapableLayerRenderPass(G),Z=w&&m.terrain?m.terrain.stencilModeForRTTOverlap(O):E[O.overscaledZ];aS(m,O,z,h,F,Z,U)}}x.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,s,h,g,x,w){if(m.renderPass!=="translucent"||h.paint.get("raster-opacity")===0)return;const E=m.transform.projection.name==="globe",C=h.paint.get("raster-elevation")!==0,O=C&&E;if(m.renderElevatedRasterBackface&&!O)return;const z=m.context,F=z.gl,G=s.getSource(),U=function(Ee,Ae,we,Me){const ke=Ae.paint.get("raster-color"),Qe=Ee.type==="raster-array",qe=[],mt=Ae.paint.get("raster-resampling"),dt=Ae.paint.get("raster-color-mix");let Ot=Ae.paint.get("raster-color-range");const Ze=[dt[0],dt[1],dt[2],0],et=dt[3];let We=mt==="nearest"?Me.NEAREST:Me.LINEAR;if(Qe&&(qe.push("RASTER_ARRAY"),ke||qe.push("RASTER_COLOR"),mt==="linear"&&qe.push("RASTER_ARRAY_LINEAR"),We=Me.NEAREST,!Ot&&Ee.rasterLayers)){const vt=Ee.rasterLayers.find(({id:at})=>at===Ae.sourceLayer);vt&&vt.fields&&vt.fields.range&&(Ot=vt.fields.range)}if(Ot=Ot||[0,1],ke){qe.push("RASTER_COLOR"),we.activeTexture.set(Me.TEXTURE2),Ae.updateColorRamp(Ot);let vt=Ae.colorRampTexture;vt||(vt=Ae.colorRampTexture=new i.T(we,Ae.colorRamp,Me.RGBA8)),vt.bind(Me.LINEAR,Me.CLAMP_TO_EDGE)}return{mix:Ze,range:Ot,offset:et,defines:qe,resampling:We}}(G,h,z,F);if(G instanceof i.aP&&!g.length&&!E)return;const Z=h.paint.get("raster-emissive-strength"),te=m.colorModeForDrapableLayerRenderPass(Z),ee=m.terrain&&m.terrain.renderingToTexture,oe=!m.options.moving,re=h.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;if(G instanceof i.aP&&!g.length&&(G.onNorthPole||G.onSouthPole)){const Ee=C?m.stencilModeFor3D():In.disabled;return void Ap(!!G.onNorthPole,null,m,s,h,Z,U,Mn.disabled,Ee)}if(!g.length)return;const[fe,_e]=G instanceof i.aP||ee?[{},g]:m.stencilConfigForOverlap(g),be=_e[_e.length-1].overscaledZ;O&&U.defines.push("PROJECTION_GLOBE_VIEW"),C&&U.defines.push("RENDER_CUTOFF");const Pe=(Ee,Ae,we)=>{for(const Me of Ee){const ke=Me.toUnwrapped(),Qe=s.getTile(Me);if(ee&&(!Qe||!Qe.hasData()))continue;z.activeTexture.set(F.TEXTURE0);const qe=OI(Qe,G,h,U);if(!qe||!qe.texture)continue;const{texture:mt,mix:dt,offset:Ot,tileSize:Ze,buffer:et}=qe;let We,vt;ee?(We=Jt.disabled,vt=Me.projMatrix):C?(We=new Jt(F.LEQUAL,Jt.ReadWrite,m.depthRangeFor3D),vt=E?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(ke,oe)):(We=m.depthModeForSublayer(Me.overscaledZ-be,h.paint.get("raster-opacity")===1?Jt.ReadWrite:Jt.ReadOnly,F.LESS),vt=m.transform.calculateProjMatrix(ke,oe));const at=m.terrain&&ee?m.terrain.stencilModeForRTTOverlap(Me):fe[Me.overscaledZ],Tt=w?0:h.paint.get("raster-fade-duration");Qe.registerFadeDuration(Tt);const gt=s.findLoadedParent(Me,0),Et=_p(Qe,gt,s,m.transform,Tt);let At,Yt;m.terrain&&m.terrain.prepareDrawTile(),z.activeTexture.set(F.TEXTURE0),mt.bind(re,F.CLAMP_TO_EDGE),z.activeTexture.set(F.TEXTURE1),gt?(gt.texture&&gt.texture.bind(re,F.CLAMP_TO_EDGE),At=Math.pow(2,gt.tileID.overscaledZ-Qe.tileID.overscaledZ),Yt=[Qe.tileID.canonical.x*At%1,Qe.tileID.canonical.y*At%1]):mt.bind(re,F.CLAMP_TO_EDGE),"useMipmap"in mt&&z.extTextureFilterAnisotropic&&m.transform.pitch>20&&F.texParameterf(F.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax);const an=m.transform;let Xt;const ln=C?PS(an):[0,0,0,0];let Qt,Sn,Rn,tr,Nr,kr=0;if(O&&G instanceof i.aP&&G.coordinates.length>3)Qt=Float32Array.from(i.bh(i.dr(new i.cp(0,0,0)))),Sn=Float32Array.from(an.globeMatrix),Rn=Float32Array.from(i.dm(an)),tr=[i.ay(an.center.lng),i.aH(an.center.lat)],Xt=G.elevatedGlobePerspectiveTransform,Nr=G.elevatedGlobeGridMatrix||new Float32Array(9);else if(O){const Fn=i.dn(Me.canonical);kr=i.dp(Fn.getCenter().lat),Qt=Float32Array.from(i.bh(i.dr(Me.canonical))),Sn=Float32Array.from(an.globeMatrix),Rn=Float32Array.from(i.dm(an)),tr=[i.ay(an.center.lng),i.aH(an.center.lat)],Xt=[0,0],Nr=Float32Array.from(i.dq(Me.canonical,Fn,kr,an.worldSize/an._pixelsPerMercatorPixel))}else Xt=G instanceof i.aP?G.perspectiveTransform:[0,0],Qt=new Float32Array(16),Sn=new Float32Array(9),Rn=new Float32Array(16),tr=[0,0],Nr=new Float32Array(9);const rr=Yc(vt,Qt,Sn,Rn,Nr,Yt||[0,0],i.ah(m.transform.zoom),tr,ln,At||1,Et,h,Xt,C?h.paint.get("raster-elevation"):0,2,dt,Ot,U.range,Ze,et,Z),Oi=m.isTileAffectedByFog(Me),wi=m.getOrCreateProgram("raster",{defines:U.defines,overrideFog:Oi});if(m.uploadCommonUniforms(z,wi,ke),G instanceof i.aP){const Fn=G.elevatedGlobeVertexBuffer,hr=G.elevatedGlobeIndexBuffer;if(ee||!E)G.boundsBuffer&&G.boundsSegments&&wi.draw(m,F.TRIANGLES,We,In.disabled,te,Mn.disabled,rr,h.id,G.boundsBuffer,m.quadTriangleIndexBuffer,G.boundsSegments);else if(Fn&&hr){const yr=an.zoom<=i.cL?G.elevatedGlobeSegments:G.getSegmentsForLongitude(an.center.lng);yr&&wi.draw(m,F.TRIANGLES,We,In.disabled,te,Ae,rr,h.id,Fn,hr,yr)}}else if(O){We=new Jt(F.LEQUAL,Jt.ReadOnly,m.depthRangeFor3D);const Fn=m.globeSharedBuffers;if(Fn){const[hr,yr,Fr]=Fn.getGridBuffers(kr,!1);wi.draw(m,F.TRIANGLES,We,we||at,m.colorModeForRenderPass(),Ae,rr,h.id,hr,yr,Fr)}}else{const{tileBoundsBuffer:Fn,tileBoundsIndexBuffer:hr,tileBoundsSegments:yr}=m.getTileBoundsBuffers(Qe);wi.draw(m,F.TRIANGLES,We,at,te,Mn.disabled,rr,h.id,Fn,hr,yr)}}if(!(G instanceof i.aP)&&O)for(const Me of Ee){const ke=Me.canonical.y===(1<<Me.canonical.z)-1;Me.canonical.y===0&&Ap(!0,Me,m,s,h,Z,U,Ae,we||In.disabled),ke&&Ap(!1,Me,m,s,h,Z,U,Ae===Mn.frontCW?Mn.backCW:Mn.frontCW,we||In.disabled)}};O?Pe(_e,m.renderElevatedRasterBackface?Mn.backCW:Mn.frontCW,m.stencilModeFor3D()):Pe(_e,Mn.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,s,h,g,x,w){m.renderPass==="offscreen"&&function(E,C,O,z){if(!z.length)return;const F=E.context,G=F.gl,U=C.getSource();if(!(U instanceof Ru))return;const Z=Math.ceil(Math.sqrt(O.paint.get("raster-particle-count")));let te=O.particlePositionRGBAImage;if(!te||te.width!==Z){const _e=function(be){const Pe=be*be,Ee=new Uint8Array(4*Pe),Ae=function(Me){return Me|=0,Me=Math.imul(2747636419^Me,2654435769),Me=Math.imul(Me^Me>>>16,2654435769),((Me=Math.imul(Me^Me>>>16,2654435769))>>>0)/4294967296},we=1/1.1;for(let Me=0;Me<Pe;Me++){const ke=we*(Ae(2*Me+0)+as),Qe=we*(Ae(2*Me+1)+as),qe=255*ke%1,mt=255*Qe%1,dt=qe,Ot=Qe-mt/255,Ze=mt;Ee[4*Me+0]=255*(ke-qe/255),Ee[4*Me+1]=255*dt,Ee[4*Me+2]=255*Ot,Ee[4*Me+3]=255*Ze}return Ee}(Z);te=O.particlePositionRGBAImage=new i.r({width:Z,height:Z},_e)}let ee=O.particleFramebuffer;ee?ee.width!==Z&&(ee.destroy(),ee=O.particleFramebuffer=F.createFramebuffer(Z,Z,!0,null)):ee=O.particleFramebuffer=F.createFramebuffer(Z,Z,!0,null);const oe=[];for(const _e of z){const be=C.getTile(_e);if(!(be instanceof rp))continue;const Pe=RI(be,U,O);if(!Pe)continue;const Ee=[be.tileSize,be.tileSize];let Ae=O.tileFramebuffer;Ae||(Ae=O.tileFramebuffer=F.createFramebuffer(Ee[0],Ee[1],!0,null));let we=be.rasterParticleState;we||(we=be.rasterParticleState=new kI(F,_e,Ee,te));const Me=we.update(O.lastInvalidatedAt);we.particleTextureDimension!==Z&&we.updateParticleTexture(_e,te);const ke=we.targetColorTexture;we.targetColorTexture=we.backgroundColorTexture,we.backgroundColorTexture=ke;const Qe=we.particleTexture0;we.particleTexture0=we.particleTexture1,we.particleTexture1=Qe,oe.push([_e,Pe,we,Me])}if(oe.length===0)return;const re=i.q.now(),fe=O.previousDrawTimestamp?.001*(re-O.previousDrawTimestamp):.0167;if(O.previousDrawTimestamp=re,O.hasColorMap()){F.activeTexture.set(G.TEXTURE0+2);let _e=O.colorRampTexture;_e||(_e=O.colorRampTexture=new i.T(F,O.colorRamp,G.RGBA8)),_e.bind(G.LINEAR,G.CLAMP_TO_EDGE)}F.bindFramebuffer.set(O.tileFramebuffer.framebuffer),function(_e,be,Pe){const Ee=_e.context,Ae=Ee.gl,we=be.tileFramebuffer;Ee.activeTexture.set(Ae.TEXTURE0);const Me={u_texture:0,u_opacity:1.05*(Qe=be.paint.get("raster-particle-fade-opacity-factor"))/(Qe+.05)},ke=_e.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Qe;for(const qe of Pe){const[,,mt,dt]=qe;we.colorAttachment.set(mt.targetColorTexture.texture),Ee.viewport.set([0,0,we.width,we.height]),Ee.clear({color:i.am.transparent}),dt&&(mt.backgroundColorTexture.bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE),ke.draw(_e,Ae.TRIANGLES,Jt.disabled,In.disabled,Zn.alphaBlended,Mn.disabled,Me,be.id,_e.viewportBuffer,_e.quadTriangleIndexBuffer,_e.viewportSegments))}}(E,O,oe),function(_e,be,Pe,Ee){const Ae=_e.context,we=Ae.gl,Me=Pe.tileFramebuffer,ke=_e.transform.projection.name==="globe",Qe=Pe.paint.get("raster-particle-max-speed");for(const qe of Ee){const[mt,dt,Ot]=qe;Ae.activeTexture.set(we.TEXTURE0+0),dt.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE),Me.colorAttachment.set(Ot.targetColorTexture.texture);const Ze=_e.getOrCreateProgram("rasterParticleDraw",{defines:dt.defines,overrideFog:!1});Ae.activeTexture.set(we.TEXTURE0+1);const et=dt.scalarData?[]:[0,1,2,3].map(at=>i.dU[at](mt));et.push(mt);const We=mt.canonical.x,vt=mt.canonical.y;for(const at of et){const Tt=be.getTile(ke?at.wrapped():at);if(!Tt)continue;const gt=Tt.rasterParticleState;if(!gt)continue;const Et=at.canonical.x+(1<<at.canonical.z)*(at.wrap-mt.wrap),At=at.canonical.y;gt.particleTexture0.bind(we.NEAREST,we.CLAMP_TO_EDGE);const Yt=Lg(1,gt.particleTexture0.size[0],[Et-We,At-vt],0,dt.texture.size,2,Qe,dt.textureOffset,dt.scale,dt.offset);Ze.draw(_e,we.POINTS,Jt.disabled,In.disabled,Zn.alphaBlended,Mn.disabled,Yt,Pe.id,gt.particleIndexBuffer,void 0,gt.particleSegment)}}}(E,C,O,oe),F.bindFramebuffer.set(O.particleFramebuffer.framebuffer),function(_e,be,Pe,Ee){const Ae=_e.context,we=Ae.gl,Me=be.paint.get("raster-particle-max-speed"),ke=Ee*be.paint.get("raster-particle-speed-factor")*.15,Qe=function(mt){return Math.pow(mt,6)}(.01+1*be.paint.get("raster-particle-reset-rate-factor")),qe=be.particleFramebuffer;Ae.viewport.set([0,0,qe.width,qe.height]);for(const mt of Pe){const[,dt,Ot]=mt;Ae.activeTexture.set(we.TEXTURE0+0),dt.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE),Ae.activeTexture.set(we.TEXTURE0+1);const Ze=Ot.particleTexture0;Ze.bind(we.NEAREST,we.CLAMP_TO_EDGE);const et=SS(1,Ze.size[0],0,dt.texture.size,Me,ke,Qe,dt.textureOffset,dt.scale,dt.offset);qe.colorAttachment.set(Ot.particleTexture1.texture),Ae.clear({color:i.am.transparent}),_e.getOrCreateProgram("rasterParticleUpdate",{defines:dt.defines}).draw(_e,we.TRIANGLES,Jt.disabled,In.disabled,Zn.unblended,Mn.disabled,et,be.id,_e.viewportBuffer,_e.quadTriangleIndexBuffer,_e.viewportSegments)}}(E,O,oe,fe)}(m,s,h,g),m.renderPass==="translucent"&&(function(E,C,O,z,F){const G=E.context,U=G.gl,Z=C.getSource().tileSize,te=5*(1-i.af(i.cx,i.cx+1,E.transform.zoom))*Z+O.paint.get("raster-particle-elevation"),ee=!E.options.moving,oe=E.transform.projection.name==="globe";if(!z.length)return;const[re,fe]=E.stencilConfigForOverlap(z),_e=[];oe&&_e.push("PROJECTION_GLOBE_VIEW");const be=E.stencilModeFor3D();for(const Pe of fe){const Ee=Pe.toUnwrapped(),Ae=C.getTile(Pe);if(!Ae.rasterParticleState)continue;const we=Ae.rasterParticleState,Me=100;Ae.registerFadeDuration(Me);const ke=C.findLoadedParent(Pe,0),Qe=_p(Ae,ke,C,E.transform,Me);let qe,mt;E.terrain&&E.terrain.prepareDrawTile(),G.activeTexture.set(U.TEXTURE0),we.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),G.activeTexture.set(U.TEXTURE1),ke&&ke.rasterParticleState?(ke.rasterParticleState.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),qe=Math.pow(2,ke.tileID.overscaledZ-Ae.tileID.overscaledZ),mt=[Ae.tileID.canonical.x*qe%1,Ae.tileID.canonical.y*qe%1]):we.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE);const dt=oe?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(Ee,ee),Ot=E.transform,Ze=O0(Ot),et=i.dn(Pe.canonical),We=i.dp(et.getCenter().lat);let vt,at,Tt,gt,Et;oe?(vt=Float32Array.from(i.bh(i.dr(Pe.canonical))),at=Float32Array.from(Ot.globeMatrix),Tt=Float32Array.from(i.dm(Ot)),gt=[i.ay(Ot.center.lng),i.aH(Ot.center.lat)],Et=Float32Array.from(i.dq(Pe.canonical,et,We,Ot.worldSize/Ot._pixelsPerMercatorPixel))):(vt=new Float32Array(16),at=new Float32Array(9),Tt=new Float32Array(16),gt=[0,0],Et=new Float32Array(9));const At=E0(dt,vt,at,Tt,Et,mt||[0,0],i.ah(E.transform.zoom),gt,Ze,qe||1,Qe,te),Yt=E.isTileAffectedByFog(Pe),an=E.getOrCreateProgram("rasterParticle",{defines:_e,overrideFog:Yt});if(E.uploadCommonUniforms(G,an,Ee),oe){const Xt=new Jt(U.LEQUAL,Jt.ReadOnly,E.depthRangeFor3D),ln=0,Qt=E.globeSharedBuffers;if(Qt){const[Sn,Rn,tr]=Qt.getGridBuffers(We,ln!==0);an.draw(E,U.TRIANGLES,Xt,be,Zn.alphaBlended,E.renderElevatedRasterBackface?Mn.frontCCW:Mn.backCCW,At,O.id,Sn,Rn,tr)}}else{const Xt=E.depthModeForSublayer(0,Jt.ReadOnly),ln=re[Pe.overscaledZ],{tileBoundsBuffer:Qt,tileBoundsIndexBuffer:Sn,tileBoundsSegments:Rn}=E.getTileBoundsBuffers(Ae);an.draw(E,U.TRIANGLES,Xt,ln,Zn.alphaBlended,Mn.disabled,At,O.id,Qt,Sn,Rn)}}E.resetStencilClippingMasks()}(m,s,h,g),m.style.map.triggerRepaint())},background:function(m,s,h,g){const x=h.paint.get("background-color"),w=h.paint.get("background-color-use-theme").constantOr("default")==="none",E=h.paint.get("background-opacity"),C=h.paint.get("background-emissive-strength"),O=h.paint.get("background-pitch-alignment")==="viewport";if(E===0)return;const z=m.context,F=z.gl,G=m.transform,U=G.tileSize,Z=h.paint.get("background-pattern");let te;if(Z!==void 0&&(Z===null||(te=m.imageManager.getPattern(i.I.from(Z.toString()),h.scope,m.style.getLut(h.scope)),!te)))return;const ee=!Z&&x.a===1&&E===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ee)return;const oe=In.disabled,re=m.depthModeForSublayer(0,ee==="opaque"?Jt.ReadWrite:Jt.ReadOnly),fe=m.colorModeForDrapableLayerRenderPass(C),_e=Z?"backgroundPattern":"background";let be,Pe=g;if(Pe||(be=m.getBackgroundTiles(),Pe=Object.values(be).map(Ee=>Ee.tileID)),Z&&(z.activeTexture.set(F.TEXTURE0),m.imageManager.bind(m.context,h.scope)),O){const Ee=m.getOrCreateProgram(_e,{overrideFog:!1,overrideRtt:!0}),Ae=new Float32Array(i.bx([])),we=new i.aM(0,0,0,0,0),Me=Z?TS(Ae,C,E,m,0,h.scope,te,O,{tileID:we,tileSize:U}):Ng(Ae,C,E,x.toRenderColor(w?null:h.lut));Ee.draw(m,F.TRIANGLES,re,oe,fe,Mn.disabled,Me,h.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments)}else for(const Ee of Pe){const Ae=m.isTileAffectedByFog(Ee),we=m.getOrCreateProgram(_e,{overrideFog:Ae}),Me=Ee.toUnwrapped(),ke=g?Ee.projMatrix:m.transform.calculateProjMatrix(Me);m.prepareDrawTile();const Qe=s?s.getTile(Ee):be?be[Ee.key]:new tc(Ee,U,G.zoom,m),qe=Z?TS(ke,C,E,m,0,h.scope,te,O,{tileID:Ee,tileSize:U}):Ng(ke,C,E,x.toRenderColor(w?null:h.lut));m.uploadCommonUniforms(z,we,Me);const{tileBoundsBuffer:mt,tileBoundsIndexBuffer:dt,tileBoundsSegments:Ot}=m.getTileBoundsBuffers(Qe);we.draw(m,F.TRIANGLES,re,oe,fe,Mn.disabled,qe,h.id,mt,dt,Ot)}},sky:function(m,s,h){const g=m._atmosphere?i.ah(m.transform.zoom):1,x=h.paint.get("sky-opacity")*g;if(x===0)return;const w=m.context,E=h.paint.get("sky-type"),C=new Jt(w.gl.LEQUAL,Jt.ReadOnly,[0,1]),O=m.frameCounter/1e3%1;E==="atmosphere"?m.renderPass==="offscreen"?h.needsSkyboxCapture(m)&&(function(z,F,G,U){const Z=z.context,te=Z.gl;let ee=F.skyboxFbo;if(!ee){ee=F.skyboxFbo=Z.createFramebuffer(32,32,!0,null),F.skyboxGeometry=new Pp(Z),F.skyboxTexture=Z.gl.createTexture(),te.bindTexture(te.TEXTURE_CUBE_MAP,F.skyboxTexture),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_WRAP_S,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_WRAP_T,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_MIN_FILTER,te.LINEAR),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_MAG_FILTER,te.LINEAR);for(let _e=0;_e<6;++_e)te.texImage2D(te.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,te.RGBA,32,32,0,te.RGBA,te.UNSIGNED_BYTE,null)}Z.bindFramebuffer.set(ee.framebuffer),Z.viewport.set([0,0,32,32]);const oe=F.getCenter(z,!0),re=z.getOrCreateProgram("skyboxCapture"),fe=new Float64Array(16);i.bx(fe),i.e3(fe,fe,.5*-Math.PI),tu(z,F,re,fe,oe,0),i.bx(fe),i.e3(fe,fe,.5*Math.PI),tu(z,F,re,fe,oe,1),i.bx(fe),i.cG(fe,fe,.5*-Math.PI),tu(z,F,re,fe,oe,2),i.bx(fe),i.cG(fe,fe,.5*Math.PI),tu(z,F,re,fe,oe,3),i.bx(fe),tu(z,F,re,fe,oe,4),i.bx(fe),i.e3(fe,fe,Math.PI),tu(z,F,re,fe,oe,5),Z.viewport.set([0,0,z.width,z.height])}(m,h),h.markSkyboxValid(m)):m.renderPass==="sky"&&function(z,F,G,U,Z){const te=z.context,ee=te.gl,oe=z.transform,re=z.getOrCreateProgram("skybox");te.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_CUBE_MAP,F.skyboxTexture);const fe=((_e,be,Pe,Ee,Ae)=>({u_matrix:_e,u_sun_direction:be,u_cubemap:0,u_opacity:Ee,u_temporal_offset:Ae}))(oe.skyboxMatrix,F.getCenter(z,!1),0,U,Z);z.uploadCommonUniforms(te,re),re.draw(z,ee.TRIANGLES,G,In.disabled,z.colorModeForRenderPass(),Mn.backCW,fe,"skybox",F.skyboxGeometry.vertexBuffer,F.skyboxGeometry.indexBuffer,F.skyboxGeometry.segment)}(m,h,C,x,O):E==="gradient"&&m.renderPass==="sky"&&function(z,F,G,U,Z){const te=z.context,ee=te.gl,oe=z.transform,re=z.getOrCreateProgram("skyboxGradient");F.skyboxGeometry||(F.skyboxGeometry=new Pp(te)),te.activeTexture.set(ee.TEXTURE0);let fe=F.colorRampTexture;fe||(fe=F.colorRampTexture=new i.T(te,F.colorRamp,ee.RGBA8)),fe.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const _e=((be,Pe,Ee,Ae,we)=>({u_matrix:be,u_color_ramp:0,u_center_direction:Pe,u_radius:i.al(Ee),u_opacity:Ae,u_temporal_offset:we}))(oe.skyboxMatrix,F.getCenter(z,!1),F.paint.get("sky-gradient-radius"),U,Z);z.uploadCommonUniforms(te,re),re.draw(z,ee.TRIANGLES,G,In.disabled,z.colorModeForRenderPass(),Mn.backCW,_e,"skyboxGradient",F.skyboxGeometry.vertexBuffer,F.skyboxGeometry.indexBuffer,F.skyboxGeometry.segment)}(m,h,C,x,O)},debug:function(m,s,h,g,x,w){for(let E=0;E<h.length;E++)if(x){const z=new i.am(g.r*.8,g.g*.8,g.b*.8,1);Yu(m,s,h[E],g,-1,-1,w),Yu(m,s,h[E],g,-1,1,w),Yu(m,s,h[E],g,1,1,w),Yu(m,s,h[E],g,1,-1,w),Yu(m,s,h[E],z,0,0,w)}else Yu(m,s,h[E],g,0,0,w)},custom:function(m,s,h,g){const x=m.context,w=h.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&h.isDraped(s)){if(m.renderPass==="offscreen"){const E=w.prerender;if(E){if(m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const C=m.transform.pointMerc;E.call(w,x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),i.ah(m.transform.zoom),[C.x,C.y],m.transform.pixelsPerMeterRatio)}else E.call(w,x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const C=w.renderToTile;if(C){const O=g[0].canonical,z={x:O.x+g[0].wrap*(w.wrapTileId?0:1<<O.z),y:O.y,z:O.z};x.setDepthMode(Jt.disabled),x.setStencilMode(In.disabled),x.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),C.call(w,x.gl,z),x.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),x.setStencilMode(In.disabled);const E=w.renderingMode==="3d"?new Jt(m.context.gl.LEQUAL,Jt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Jt.ReadOnly);if(x.setDepthMode(E),m.transform.projection.name==="globe"){const C=m.transform.pointMerc;w.render(x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),i.ah(m.transform.zoom),[C.x,C.y],m.transform.pixelsPerMeterRatio)}else w.render(x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState(),x.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,s,h,g){if(m.renderPass==="opaque")return;const x=h.paint.get("model-opacity").constantOr(1);if(x===0)return;const w=h.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!w||m.terrain&&x<.65&&h._transitionablePaint._values["model-opacity"].value.expression instanceof i.ab))return;const E=m.shadowRenderer,C=h.paint.get("model-receive-shadows");E&&(E.useNormalOffset=!0,C||(E.enabled=!1));const O=()=>{E&&(E.useNormalOffset=!0,C||(E.enabled=!0))},z=s.getSource();if(m.renderPass==="light-beam"&&z.type!=="batched-model")return;if(z.type==="vector"||z.type==="geojson")return function(re,fe,_e,be,Pe){const Ee=re.transform;if(Ee.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Ee.projection.name} projection is not yet implemented`);const Ae=Ee.getFreeCameraOptions().position;if(!re.modelManager)return;const we=re.modelManager;_e.modelManager=we;const Me=re.shadowRenderer;if(!_e._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ke=_e._unevaluatedLayout._values["model-id"],Qe=Object.assign({},_e.layout.get("model-id").parameters),qe=re.style.order.indexOf(_e.fqid);for(const mt of be){const dt=fe.getTile(mt).getBucket(_e);if(!dt||dt.projection.name!==Ee.projection.name)continue;const Ot=dt.getModelUris();Ot&&!dt.modelsRequested&&(we.addModelsFromBucket(Ot,Pe),dt.modelsRequested=!0);const Ze=Gg(mt,Ee);Qe.zoom=Ze;const et=ke.possiblyEvaluate(Qe);if(Ke(re,dt,mt),el.shadowUniformsInitialized=!1,el.useSingleShadowCascade=!!Me&&Me.getMaxCascadeForTile(mt.toUnwrapped())===0,re.renderPass==="shadow"&&Me){if(re.currentShadowCascade===1&&dt.isInsideFirstShadowMapFrustum)continue;const at=Ee.calculatePosMatrix(mt.toUnwrapped(),Ee.worldSize);if(el.tileMatrix.set(at),el.shadowTileMatrix=Float32Array.from(Me.calculateShadowPassMatrixFromMatrix(at)),el.aabb.min.fill(0),el.aabb.max[0]=el.aabb.max[1]=i.aj,el.aabb.max[2]=0,RS(dt,el,re,_e.scope))continue}const We=1<<mt.canonical.z,vt=[((Ae.x-mt.wrap)*We-mt.canonical.x)*i.aj,(Ae.y*We-mt.canonical.y)*i.aj,Ae.z*We*i.aj];re.conflationActive&&Object.keys(dt.instancesPerModel).length>0&&re.style.isLayerClipped(_e,fe.getSource())&&dt.updateReplacement(mt,re.replacementSource,qe,Pe)&&(dt.uploaded=!1,dt.upload(re.context));for(let at in dt.instancesPerModel){const Tt=dt.instancesPerModel[at];Tt.features.length>0&&(at=et.evaluate(Tt.features[0].feature,{}));const gt=we.getModel(at,Pe);if(gt||we.hasURLBeenRequested(at)||dt.modelUris.includes(at)||(dt.modelUris.push(at),dt.modelsRequested=!1),gt&&gt.uploaded)for(const Et of gt.nodes)Wg(re,_e,Et,Tt,vt,mt,el)}}}(m,s,h,g,z.type==="vector"?h.scope:""),void O();if(!z.loaded())return;if(z.type==="batched-model")return function(re,fe,_e,be){_e.resetLayerRenderingStats(re);const Pe=re.context,Ee=re.transform,Ae=re.style.fog,we=re.shadowRenderer;if(Ee.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Ee.projection.name} projection is not yet implemented`);const Me=re.transform.getFreeCameraOptions().position,ke=i.b$([],[Me.x,Me.y,Me.z],re.transform.worldSize),Qe=i.eb([],ke),qe=i.bx([]),mt=i.ec(Ee.center.lat,Ee.zoom),dt=i.bn([],[1,1,1/mt]);i.bo(qe,qe,Qe);const Ot=_e.paint.get("model-opacity").constantOr(1),Ze=new Jt(Pe.gl.LEQUAL,Jt.ReadWrite,re.depthRangeFor3D),et=new Jt(Pe.gl.LEQUAL,Jt.ReadOnly,re.depthRangeFor3D),We=new i.cV([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),vt=re.renderPass==="shadow",at=vt&&we?we.getCurrentCascadeFrustum():Ee.getFrustum(Ee.scaleZoom(Ee.worldSize)),Tt=_e.paint.get("model-front-cutoff"),gt=Tt[2]<1,Et=Uu(re,_e.paint.get("model-cutoff-fade-range")),At=_e.getLayerRenderingStats();(function(Yt,an,Xt,ln){const Qt=Yt.terrain?Yt.terrain.exaggeration():0,Sn=Yt.transform.zoom;for(const Rn of ln){const tr=an.getTile(Rn).getBucket(Xt);tr&&(tr.setFilter(Xt.filter),Yt.conflationActive&&tr.updateReplacement(Rn,Yt.replacementSource),tr.evaluateScale(Yt,Xt),Yt.terrain&&Qt>0&&tr.elevationUpdate(Yt.terrain,Qt,Rn,Xt.source),tr.needsReEvaluation(Yt,Sn,Xt)&&tr.evaluate(Xt))}})(re,fe,_e,be),function(){let Yt,an,Xt;gt?(Yt=be.length-1,an=-1,Xt=-1):(Yt=0,an=be.length,Xt=1);const ln=new Float64Array(16),Qt=i.eg(),Sn=new i.P(0,0);for(let Rn=Yt;Rn!==an;Rn+=Xt){const tr=be[Rn],Nr=fe.getTile(tr).getBucket(_e);if(!Nr||!Nr.uploaded)continue;let kr=!1;we&&(kr=we.getMaxCascadeForTile(tr.toUnwrapped())===0);const rr=Ee.calculatePosMatrix(tr.toUnwrapped(),Ee.worldSize),Oi=Nr.modelTraits;!vt&&gt&&(i.bi(ln,rr),i.ad(Qt,ke,ln),Sn.x=Qt[0],Sn.y=Qt[1]);const wi=[];Nr.setFilter(_e.filter);for(const Fn of Nr.getNodesInfo()){if(Fn.hiddenByReplacement||!Fn.node.meshes)continue;const hr=Fn.node;let yr=0;re.terrain&&hr.elevation&&(yr=hr.elevation*re.terrain.exaggeration());const Fr=(()=>{const vi=Fn.aabb;return We.min=[...vi.min],We.max=[...vi.max],We.min[2]+=yr,We.max[2]+=yr,i.ad(We.min,We.min,rr),i.ad(We.max,We.max,rr),We})(),Xi=Fn.evaluatedScale;if(Xi[0]<=1&&Xi[1]<=1&&Xi[2]<=1&&Fr.intersects(at)===0)continue;if(!vt&&gt){const vi=.16666666666666666;Fn.cameraCollisionOpacity=ke[0]>Fr.min[0]&&ke[0]<Fr.max[0]&&ke[1]>Fr.min[1]&&ke[1]<Fr.max[1]&&ke[2]*mt<Fr.max[2]&&hr.footprint&&i.bS(Sn,hr.footprint)?Math.max(Fn.cameraCollisionOpacity-vi,0):Math.min(1,Fn.cameraCollisionOpacity+vi)}const Li=[...rr],qi=hr.anchor?hr.anchor[0]:0,_i=hr.anchor?hr.anchor[1]:0;i.bo(Li,Li,[qi*(Xi[0]-1),_i*(Xi[1]-1),yr]),i.ci(Xi,i.eh)||i.cE(Li,Li,Xi);const Vn=i.az([],Li,hr.matrix),fi=i.az([],Ee.expandedFarZProjMatrix,Vn),mr=i.az([],Ee.expandedFarZProjMatrix,Li),pi=i.aA([],[qi,_i,yr,1],fi)[2];hr.hidden=!1;let Sr=Ot;vt||(gt&&(Sr*=Fn.cameraCollisionOpacity,Sr*=vd(Li,Ee,Fn.aabb,Tt)),Sr*=DS(Et,pi)),Sr!==0?wi.push({nodeInfo:Fn,depth:pi,opacity:Sr,wvpForNode:fi,wvpForTile:mr,nodeModelMatrix:Vn,tileModelMatrix:Li}):hr.hidden=!0}vt||wi.sort((Fn,hr)=>!gt||Fn.opacity===1&&hr.opacity===1?Fn.depth<hr.depth?-1:1:Fn.opacity===1?-1:hr.opacity===1?1:Fn.depth>hr.depth?-1:1);for(const Fn of wi){const hr=Fn.nodeInfo,yr=hr.node;let Fr=i.az([],dt,Fn.tileModelMatrix);i.az(Fr,qe,Fr);const Xi=i.bi([],Fr);i.ee(Xi,Xi),i.cE(Xi,Xi,L0),Fr=i.az(Fr,Fr,yr.matrix);const Li=re.renderPass==="light-beam",qi=_e.paint.get("model-color-use-theme").constantOr("default")==="none",_i=Oi&i.em.HasMapboxMeshFeatures,Vn=_i?0:hr.evaluatedRMEA[0][2];for(let fi=0;fi<yr.meshes.length;++fi){const mr=yr.meshes[fi],pi=fi===yr.lightMeshIndex;let Sr=Fn.wvpForNode;if(pi){if(!Li&&!re.terrain&&re.shadowRenderer){re.currentLayer<re.firstLightBeamLayer&&(re.firstLightBeamLayer=re.currentLayer);continue}Sr=Fn.wvpForTile}else if(Li)continue;const vi={defines:[]},wo=[];if(!vt&&we&&(we.useNormalOffset=!!mr.normalBuffer),Dt(vi.defines,wo,mr,re,qi?null:_e.lut),_i||vi.defines.push("DIFFUSE_SHADED"),kr&&vi.defines.push("SHADOWS_SINGLE_CASCADE"),At&&(vt?At.numRenderedVerticesInShadowPass+=mr.vertexArray.length:At.numRenderedVerticesInTransparentPass+=mr.vertexArray.length),vt){Di(mr,Fn.nodeModelMatrix,re,_e);continue}let ri=null;if(Ae){const Ua=Ju(Fn.nodeModelMatrix,re.transform);if(ri=new Float32Array(Ua),Ee.projection.name!=="globe"){const Is=mr.aabb.min,Pl=mr.aabb.max,[Cl,ol]=Ae.getOpacityForBounds(Ua,Is[0],Is[1],Pl[0],Pl[1]);vi.overrideFog=Cl>=Ht||ol>=Ht}}const Mo=mr.material;let Ui;Mo.occlusionTexture&&Mo.occlusionTexture.offsetScale&&(Ui=Mo.occlusionTexture.offsetScale,vi.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const No=re.getOrCreateProgram("model",vi);!vt&&we&&we.setupShadowsFromMatrix(Fn.tileModelMatrix,No,we.useNormalOffset),re.uploadCommonUniforms(Pe,No,null,ri);const il=Mo.pbrMetallicRoughness;il.metallicFactor=.9,il.roughnessFactor=.5;const lc=Zu(new Float32Array(Sr),new Float32Array(Fr),new Float32Array(Xi),new Float32Array(yr.matrix),re,Fn.opacity,il.baseColorFactor.toRenderColor(null),Mo.emissiveFactor,il.metallicFactor,il.roughnessFactor,Mo,Vn,_e,[0,0,0],Ui);!pi&&(hr.hasTranslucentParts||Fn.opacity<1)&&No.draw(re,Pe.gl.TRIANGLES,Ze,In.disabled,Zn.disabled,Mn.backCCW,lc,_e.id,mr.vertexBuffer,mr.indexBuffer,mr.segments,_e.paint,re.transform.zoom,void 0,wo),No.draw(re,Pe.gl.TRIANGLES,pi?et:Ze,In.disabled,pi||Fn.opacity<1||hr.hasTranslucentParts?Zn.alphaBlended:Zn.unblended,Mn.backCCW,lc,_e.id,mr.vertexBuffer,mr.indexBuffer,mr.segments,_e.paint,re.transform.zoom,void 0,wo)}}}}()}(m,s,h,g),void O();if(z.type!=="model")return;const F=z.getModels(),G=[],U=m.transform.getFreeCameraOptions().position,Z=i.b$([],[U.x,U.y,U.z],m.transform.worldSize);i.eb(Z,Z);const te=[],ee=[];let oe=0;for(const re of F){const fe=h.paint.get("model-rotation").constantOr(null),_e=h.paint.get("model-scale").constantOr(null),be=h.paint.get("model-translation").constantOr(null);re.computeModelMatrix(m,fe,_e,be,!0,!0,!1);const Pe=i.bx([]),Ee=i.ec(re.position.lat,m.transform.zoom),Ae=i.bn([],[1,1,1/Ee]);i.bo(Pe,Pe,Z),G.push({zScaleMatrix:Ae,negCameraPosMatrix:Pe});for(const we of re.nodes)Qu(m.transform,we,re.matrix,m.transform.expandedFarZProjMatrix,oe,te,ee);oe++}if(te.sort((re,fe)=>fe.depth-re.depth),m.renderPass!=="shadow"){if(x===1)for(const re of ee)qt(re,m,h,G[re.modelIndex],In.disabled,m.colorModeForRenderPass());else{for(const re of ee)qt(re,m,h,G[re.modelIndex],In.disabled,Zn.disabled);for(const re of ee)qt(re,m,h,G[re.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(const re of te)qt(re,m,h,G[re.modelIndex],In.disabled,m.colorModeForRenderPass());O()}else{for(const re of ee)Di(re.mesh,re.nodeModelMatrix,m,h);for(const re of te)Di(re.mesh,re.nodeModelMatrix,m,h);O()}}},B0={line:function(m,s,h){if(m.hasElevatedBuckets=!1,m.hasNonElevatedBuckets=!1,m._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||m._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){const g=s.getVisibleCoordinates();for(const x of g){const w=s.getTile(x).getBucket(m);if(w&&(w.elevationType!=="none"?m.hasElevatedBuckets=!0:m.hasNonElevatedBuckets=!0,m.hasElevatedBuckets&&m.hasNonElevatedBuckets))break}}}else m.hasNonElevatedBuckets=!0},model:function(m,s,h){const g=s.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(h.modelManager&&h.modelManager.upload(h,g.type==="vector"?m.scope:""));if(g.type==="batched-model"||g.type!=="model")return;const x=g.getModels();for(const w of x)w.upload(h.context)},raster:function(m,s,h){const g=s.getSource();if(!(g instanceof Ru&&g.loaded()))return;const x=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const w=m.paint.get("raster-array-band")||g.getInitialBand(x);if(w==null)return;const E=s.getIds().map(C=>s.getTileByID(C));for(const C of E)C.updateNeeded(x,w)&&g.prepareTile(C,x,w)},"raster-particle":function(m,s,h){const g=s.getSource();if(!(g instanceof Ru&&g.loaded()))return;const x=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const w=m.paint.get("raster-particle-array-band")||g.getInitialBand(x);if(w==null)return;const E=s.getIds().map(C=>s.getTileByID(C));for(const C of E)C.updateNeeded(x,w)&&g.prepareTile(C,x,w)}},oc={fill:Tp};class Zg{constructor(s,h,g,x,w){this.context=new pd(s,h),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const O of E)this._debugParams.enabledLayers[O]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const O of E)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],O);this.occlusionParams=new LS(w),this.setup(),this.numSublayers=ca.maxUnderzooming+ca.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new dI(this),this._wireframeDebugCache=new zI,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const C=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,C,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x}updateTerrain(s,h){const g=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Og(this,s));const x=this._terrain;this.transform.elevation=g?x:null,x.update(s,this.transform,h),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(s){const h=s.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,x]=h.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);const w=g+.78*(x-g);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new Og(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,h){if(this.width=s*i.q.devicePixelRatio,this.height=h*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const s=this.context,h=new i.ba;h.emplaceBack(0,0),h.emplaceBack(i.aj,0),h.emplaceBack(0,i.aj),h.emplaceBack(i.aj,i.aj),this.tileExtentBuffer=s.createVertexBuffer(h,i.bc.members),this.tileExtentSegments=i.bd.simpleSegment(0,0,4,2);const g=new i.ba;g.emplaceBack(0,0),g.emplaceBack(i.aj,0),g.emplaceBack(0,i.aj),g.emplaceBack(i.aj,i.aj),this.debugBuffer=s.createVertexBuffer(g,i.bc.members),this.debugSegments=i.bd.simpleSegment(0,0,4,5);const x=new i.ba;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(x,i.bc.members),this.viewportSegments=i.bd.simpleSegment(0,0,4,2);const w=new i.aZ;w.emplaceBack(0,0,0,0),w.emplaceBack(i.aj,0,i.aj,0),w.emplaceBack(0,i.aj,0,i.aj),w.emplaceBack(i.aj,i.aj,i.aj,i.aj),this.mercatorBoundsBuffer=s.createVertexBuffer(w,i.bf.members),this.mercatorBoundsSegments=i.bd.simpleSegment(0,0,4,2);const E=new i.a_;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(E);const C=new i.bb;for(const z of[0,1,3,2,0])C.emplaceBack(z);this.debugIndexBuffer=s.createIndexBuffer(C),this.emptyTexture=new i.T(s,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=i.bz();const O=this.context.gl;this.stencilClearMode=new In({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,Jt.disabled,this.stencilClearMode,Zn.disabled,Mn.disabled,Pa(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,h,g){if(!h||this.currentStencilSource===h.id||!s.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(const O of g)if(this._tileClippingMaskIDs[O.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=h.id;const x=this.context,w=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(Zn.disabled),x.setDepthMode(Jt.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const C of g){const O=h.getTile(C),z=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:G,tileBoundsSegments:U}=this.getTileBoundsBuffers(O);E.draw(this,w.TRIANGLES,Jt.disabled,new In({func:w.ALWAYS,mask:0},z,255,w.KEEP,w.KEEP,w.REPLACE),Zn.disabled,Mn.disabled,Pa(C.projMatrix),"$clipping",F,G,U)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,h=this.context.gl;return new In({func:h.NOTEQUAL,mask:255},s,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const h=this.context.gl;return new In({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(s){const h=this.context.gl,g=s.sort((E,C)=>C.overscaledZ-E.overscaledZ),x=g[g.length-1].overscaledZ,w=g[0].overscaledZ-x+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let C=0;C<w;C++)E[C+x]=new In({func:h.GEQUAL,mask:255},C+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=w,[E,g]}return[{[x]:In.disabled},g]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new Zn([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new i.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Zn.unblended:Zn.alphaBlended}colorModeForDrapableLayerRenderPass(s){const h=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Zn([h.ONE,h.ONE_MINUS_SRC_ALPHA,h.CONSTANT_ALPHA,h.ONE_MINUS_SRC_ALPHA],new i.am(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,h,g,x=!1){if(this.depthOcclusion)return new Jt(this.context.gl.GREATER,Jt.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return Jt.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Jt(g||this.context.gl.LEQUAL,h,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,h=Math.ceil(this.width),g=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),w=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===h&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),h!==0&&g!==0&&(this.depthFBO=new Bg(this.context,h,g,!1,"texture"),this.depthTexture=new i.T(this.context,{width:h,height:g,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),s.bindTexture(s.TEXTURE_2D,w),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,h,g,0,0,h,g,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,h)=>s+h/this._fpsHistory.length,0))}render(s,h){const g=i.q.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=h;const x=this.style._mergedLayers,w=!(!this.terrain||!this.terrain.enabled),E=()=>this.style._getOrder(w).filter(Ze=>{const et=x[Ze];return!(et.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[et.type]});let C=E(),O=!1,z=!1;for(const Ze of C){const et=x[Ze];et.type==="circle"&&(O=!0),et.type==="symbol"&&(et.hasInitialOcclusionOpacityProperties?z=!0:O=!0)}let F=C.map(Ze=>x[Ze]);const G=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let U=0,Z=!1;for(const Ze in G){const et=G[Ze];et.used&&(et.prepare(this.context),et.getSource().usedInConflation&&++U)}let te=!1;for(const Ze of F)Ze.isHidden(this.transform.zoom)||(Ze.type==="clip"&&(te=!0),this.prepareLayer(Ze));const ee={},oe={},re={},fe={},_e={};for(const Ze in G){const et=G[Ze];ee[Ze]=et.getVisibleCoordinates(),oe[Ze]=ee[Ze].slice().reverse(),re[Ze]=et.getVisibleCoordinates(!0).reverse(),fe[Ze]=et.getShadowCasterCoordinates(),_e[Ze]=et.sortCoordinatesByDistance(ee[Ze])}const be=Ze=>{const et=this.style.getLayerSourceCache(Ze);return et&&et.used?et.getSource():null};if(U||te||this._clippingActiveLastFrame){const Ze=[],et=[];let We=0;for(const vt of F)this.isSourceForClippingOrConflation(vt,be(vt))&&(Ze.push(vt),et.push(We)),We++;if(Ze&&(te||Ze.length>1)||this._clippingActiveLastFrame){te=!1;const vt=[];for(let at=0;at<Ze.length;at++){const Tt=Ze[at],gt=et[at],Et=this.style.getLayerSourceCache(Tt);if(!Et||!Et.used||!Et.getSource().usedInConflation&&Tt.type!=="clip")continue;let At=i.ev,Yt=i.bQ.None;const an=[];let Xt=!0;if(Tt.type==="clip"){At=gt;for(const ln of Tt.layout.get("clip-layer-types"))Yt|=ln==="model"?i.bQ.Model:ln==="symbol"?i.bQ.Symbol:i.bQ.FillExtrusion;for(const ln of Tt.layout.get("clip-layer-scope"))an.push(ln);Tt.isHidden(this.transform.zoom)?Xt=!1:te=!0}Xt&&vt.push({layer:Tt.fqid,cache:Et,order:At,clipMask:Yt,clipScope:an})}this.replacementSource.setSources(vt),Z=!0}}this._clippingActiveLastFrame=te,Z||this.replacementSource.clear(),this.conflationActive=Z,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Ze=0;Ze<F.length;Ze++){const et=F[Ze],We=et.cutoffRange();if(this.longestCutoffRange=Math.max(We,this.longestCutoffRange),We>0){const vt=be(et);vt&&(this.minCutoffZoom=Math.max(vt.minzoom,this.minCutoffZoom)),et.minzoom&&(this.minCutoffZoom=Math.max(et.minzoom,this.minCutoffZoom))}et.is3D(w)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Ze),this._lastOcclusionLayer=Ze)}const Pe=this.style&&this.style.fog;Pe?(this._fogVisible=Pe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Pe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(re),this.opaquePassCutoff=0,C=E(),F=C.map(Ze=>x[Ze]));const Ee=this._shadowRenderer;if(Ee){Ee.updateShadowParameters(this.transform,this.style.directionalLight);for(const Ze in G)for(const et of ee[Ze]){let We={min:0,max:0};this.terrain&&(We=this.terrain.getMinMaxForTile(et)||We),Ee.addShadowReceiver(et.toUnwrapped(),We.min,We.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.eu(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new _d(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Ae=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),we=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ae&&!this._snow&&(this._snow=new yi(this)),!Ae&&this._snow&&(this._snow.destroy(),delete this._snow),we&&!this._rain&&(this._rain=new NI(this)),!we&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!xn.has(this.context.gl))return;this.renderPass="offscreen";for(const Ze of F){const et=s.getLayerSourceCache(Ze);if(!Ze.hasOffscreenPass()||Ze.isHidden(this.transform.zoom))continue;const We=et?oe[et.id]:void 0;(Ze.type==="custom"||Ze.type==="raster"||Ze.type==="raster-particle"||Ze.isSky()||We&&We.length)&&this.renderLayer(this,et,Ze,We)}this.depthRangeFor3D=[0,1-(F.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,fe)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Me=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),ke=(()=>{if(h.showOverdrawInspector)return i.am.black;const Ze=this.style.fog;if(Ze&&this.transform.projection.supportsFog){const et=this.style.getLut(Ze.scope);if(!Me){const We=Ze.properties.get("color-use-theme")==="none",vt=Ze.properties.get("color").toRenderColor(We?null:et).toArray01();return new i.am(...vt)}if(Me){const We=Ze.properties.get("space-color-use-theme")==="none",vt=Ze.properties.get("space-color").toRenderColor(We?null:et).toArray01();return new i.am(...vt)}}return i.am.transparent})();if(this.context.clear({color:ke,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Me&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=C.length-1;this.currentLayer>=0;this.currentLayer--){const Ze=F[this.currentLayer],et=s.getLayerSourceCache(Ze);if(Ze.isSky())continue;const We=et?(Ze.is3D(w)?_e:oe)[et.id]:void 0;this._renderTileClippingMasks(Ze,et,We),this.renderLayer(this,et,Ze,We)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Me&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<C.length;this.currentLayer++){const Ze=F[this.currentLayer],et=s.getLayerSourceCache(Ze);Ze.isSky()&&this.renderLayer(this,et,Ze,et?oe[et.id]:void 0)}function Qe(Ze,et){let We;return et&&(We=(Ze.type==="symbol"?re:Ze.is3D(w)?_e:oe)[et.id]),We}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<C.length;){const Ze=F[this.currentLayer];if(Ze.type==="raster"||Ze.type==="raster-particle"){const et=s.getLayerSourceCache(Ze);this.renderLayer(this,et,Ze,Qe(Ze,et))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let qe=0;Ee&&(qe=Ee.getShadowCastingLayerCount());let mt=!1,dt=-1;for(let Ze=0;Ze<C.length;++Ze){const et=F[Ze];et.isHidden(this.transform.zoom)||et.is3D(w)&&(dt=Ze)}z&&dt===-1&&(O=!0);let Ot=!1;for(;this.currentLayer<C.length;){const Ze=F[this.currentLayer],et=s.getLayerSourceCache(Ze);if(Ze.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Ze)){if(Ze.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Ot&&Ze.is3D(w)&&!w){const We=this.currentLayer,vt=at=>{for(this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){const Tt=F[this.currentLayer];if(oc[Tt.type]){const gt=this.style.getLayerSourceCache(Tt);oc[Tt.type](this,gt,Tt,Qe(Tt,gt),at)}}};vt("initialize"),vt("reset"),this.currentLayer=We,Ot=!0}if(O&&!mt&&this.terrain&&!this.transform.isOrthographic&&(mt=!0,this.blitDepth()),z&&dt!==-1&&this.currentLayer===dt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(Ze,et,et?ee[et.id]:void 0),this.renderLayer(this,et,Ze,Qe(Ze,et)),!this.terrain&&Ee&&qe>0&&Ze.hasShadowPass()&&--qe==0&&(Ee.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const We=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=We;this.currentLayer++){const vt=F[this.currentLayer];if(!vt.hasLightBeamPass())continue;const at=s.getLayerSourceCache(vt);this.renderLayer(this,at,vt,at?oe[at.id]:void 0)}this.currentLayer=We,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const We=this.currentLayer;this.depthOcclusion=!0;for(const vt of this.layersWithOcclusionOpacity){this.currentLayer=vt;const at=F[this.currentLayer],Tt=s.getLayerSourceCache(at),gt=Tt?oe[Tt.id]:void 0;this.terrain||this._renderTileClippingMasks(at,Tt,Tt?ee[Tt.id]:void 0),this.renderLayer(this,Tt,at,gt)}this.depthOcclusion=!1,this.currentLayer=We,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Ze=null;F.forEach(et=>{const We=s.getLayerSourceCache(et);We&&!et.isHidden(this.transform.zoom)&&We.getVisibleCoordinates().length&&(!Ze||Ze.getSource().maxzoom<We.getSource().maxzoom)&&(Ze=We)}),Ze&&this.options.showTileBoundaries&&vr.debug(this,Ze,Ze.getVisibleCoordinates(),i.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&vr.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Ze){const et=Ze.transform.padding;Ug(Ze,Ze.transform.height-(et.top||0),3,k0),Ug(Ze,et.bottom||0,3,R0),Vg(Ze,et.left||0,3,D0),Vg(Ze,Ze.transform.width-(et.right||0),3,$a);const We=Ze.transform.centerPoint;(function(vt,at,Tt,gt){yd(vt,at-1,Tt-10,2,20,gt),yd(vt,at-10,Tt-1,20,2,gt)})(Ze,We.x,Ze.transform.height-We.y,eu)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),Z||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:h}=this.transform.projection,g=!h||!h.includes(s.type);if(B0[s.type]&&(g||this.terrain&&s.type==="custom")){const x=this.style.getLayerSourceCache(s);B0[s.type](s,x,this)}this.gpuTimingEnd()}renderLayer(s,h,g,x){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(g.type)&&(!s.terrain||g.type!=="custom")||g.type==="clip"||vr[g.type](s,h,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery,g=this.context.gl;let x=this.gpuTimers[s.id];x||(x=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:g.createQuery()}),x.calls++,g.beginQuery(h.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,h=this.context.gl,g=h.createQuery();this.deferredRenderGpuTimeQueries.push(g),h.beginQuery(s.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const h={};for(const g in s){const x=s[g],w=this.context.extTimerQuery,E=w.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(x.query),h[g]=E}return h}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.gl;let g=0;for(const x of s)g+=h.getQueryParameter(x,h.QUERY_RESULT)/1e6,h.deleteQuery(x);return g}translatePosMatrix(s,h,g,x,w){if(!g[0]&&!g[1])return s;const E=w?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(E){const z=Math.sin(E),F=Math.cos(E);g=[g[0]*F-g[1]*z,g[0]*z+g[1]*F]}const C=[w?g[0]:i.aw(h,g[0],this.transform.zoom),w?g[1]:i.aw(h,g[1],this.transform.zoom),0],O=new Float32Array(16);return i.bo(O,s,C),O}saveTileTexture(s){const h=s.size[0],g=this._tileTextures[h];g?g.push(s):this._tileTextures[h]=[s]}getTileTexture(s){const h=this._tileTextures[s];return h&&h.length>0?h.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,h,g){const x=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,w=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||x||h!==void 0&&!h||w.push("FOG","FOG_DITHERING"),x&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(s,h){this.cache=this.cache||{};const g=h&&h.defines||[],x=h&&h.config,w=this.currentGlobalDefines(s,h&&h.overrideFog,h&&h.overrideRtt).concat(g),E=Rg.cacheKey(Gu[s],s,w,x);return this.cache[E]||(this.cache[E]=new Rg(this.context,s,Gu[s],x,CI[s],w)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,h){if(this.style.enable3dLights()){const g=this.style.directionalLight,x=this.style.ambientLight;if(g&&x){const w=((E,C,O)=>{const z=E.properties.get("direction"),F=E.properties.get("color-use-theme")==="none",G=E.properties.get("color").toRenderColor(F?null:O.getLut(E.scope)).toArray01(),U=E.properties.get("intensity"),Z=C.properties.get("color-use-theme")==="none",te=C.properties.get("color").toRenderColor(Z?null:O.getLut(C.scope)).toArray01(),ee=C.properties.get("intensity"),oe=[z.x,z.y,z.z],re=i.dw(te,ee),fe=i.dw(G,U);return{u_lighting_ambient_color:re,u_lighting_directional_dir:oe,u_lighting_directional_color:fe,u_ground_radiance:b0(oe,fe,re)}})(g,x,this.style);h.setLightsUniformValues(s,w)}}}uploadCommonUniforms(s,h,g,x,w){if(this.uploadCommonLightUniforms(s,h),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const C=E.getOpacity(this.transform.pitch),O=((z,F,G,U,Z,te,ee,oe,re,fe,_e,be)=>{const Pe=z.transform,Ee=F.properties.get("color-use-theme")==="none",Ae=F.properties.get("color").toRenderColor(Ee?null:z.style.getLut(F.scope)).toArray01();Ae[3]=U;const we=z.frameCounter/1e3%1,[Me,ke]=F.properties.get("vertical-range");return{u_fog_matrix:G?Pe.calculateFogTileMatrix(G):be||z.identityMat,u_fog_range:F.getFovAdjustedRange(Pe._fov),u_fog_color:Ae,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Me,ke),ke],u_fog_temporal_offset:we,u_frustum_tl:Z,u_frustum_tr:te,u_frustum_br:ee,u_frustum_bl:oe,u_globe_pos:re,u_globe_radius:fe,u_viewport:_e,u_globe_transition:i.ah(Pe.zoom),u_is_globe:+(Pe.projection.name==="globe")}})(this,E,g,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],x);h.setFogUniformValues(s,O)}w&&h.setCutoffUniformValues(s,w.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,h=s.createTexture();return s.bindTexture(s.TEXTURE_2D,h),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,h=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const x of g)h[x.key]=s[x.key]||new tc(x,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,h){return!(!s.is3D(!(!this.terrain||!this.terrain.enabled))||s.type!=="clip"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building")&&(!h||h.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let h=this._cachedTileFogOpacities[s.key];return h||(this._cachedTileFogOpacities[s.key]=h=this.style.fog.getOpacityForTile(s)),h[0]>=Ht||h[1]>=Ht}setupDepthForOcclusion(s,h,g){const x=this.context,w=x.gl,E=!!g;var C;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(w.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((C=this.depthRangeFor3D)[1]-C[0]),-1-2*C[0]/(C[1]-C[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),x.activeTexture.set(w.TEXTURE0),E||h.setTerrainUniformValues(x,g)}}function th(m,s){let h=!1,g=null;const x=()=>{g=null,h&&(m(),g=setTimeout(x,s),h=!1)};return()=>(h=!0,g||x(),g)}class xd{constructor(s){this._hashName=s&&encodeURIComponent(s),i.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=th(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const h=Xg(s);if(this._hashName){const g=this._hashName;let x=!1;const w=location.hash.slice(1).split("&").map(E=>{const C=E.split("=")[0];return C===g?(x=!0,`${C}=${h}`):E}).filter(E=>E);return x||w.push(`${g}=${h}`),`#${w.join("&")}`}return`#${h}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let h;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(h=g)}),(h&&h[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(g=>isNaN(Number(g)))){const g=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(h[3]||0):s.getBearing();return s.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:g,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Xg(m,s){const h=m.getCenter(),g=Math.round(100*m.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,x),E=Math.round(h.lng*w)/w,C=Math.round(h.lat*w)/w,O=m.getBearing(),z=m.getPitch();let F=s?`/${E}/${C}/${g}`:`${g}/${C}/${E}`;return(O||z)&&(F+="/"+Math.round(10*O)/10),z&&(F+=`/${Math.round(z)}`),F}const bd={linearity:.3,easing:i.ew(0,0,.3,1)},j0=i.l({deceleration:2500,maxSpeed:1400},bd),$0=i.l({deceleration:20,maxSpeed:1400},bd),Tl=i.l({deceleration:1e3,maxSpeed:360},bd),ac=i.l({deceleration:1e3,maxSpeed:90},bd);class Kg{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,h=i.q.now();for(;s.length>0&&h-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)h.zoom+=w.zoomDelta||0,h.bearing+=w.bearingDelta||0,h.pitch+=w.pitchDelta||0,w.panDelta&&h.pan._add(w.panDelta),w.around&&(h.around=w.around),w.pinchAround&&(h.pinchAround=w.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(h.pan.mag()){const w=wd(h.pan.mag(),g,i.l({},j0,s||{}));x.offset=h.pan.mult(w.amount/h.pan.mag()),x.center=this._map.transform.center,nh(x,w)}if(h.zoom){const w=wd(h.zoom,g,$0);x.zoom=this._map.transform.zoom+w.amount,nh(x,w)}if(h.bearing){const w=wd(h.bearing,g,Tl);x.bearing=this._map.transform.bearing+i.aD(w.amount,-179,179),nh(x,w)}if(h.pitch){const w=wd(h.pitch,g,ac);x.pitch=this._map.transform.pitch+w.amount,nh(x,w)}if(x.zoom||x.bearing){const w=h.pinchAround===void 0?h.around:h.pinchAround;x.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function nh(m,s){(!m.duration||m.duration<s.duration)&&(m.duration=s.duration,m.easing=s.easing)}function wd(m,s,h){const{maxSpeed:g,linearity:x,deceleration:w}=h,E=i.aD(m*x/(s/1e3),-g,g),C=Math.abs(E)/(w*x);return{easing:h.easing,duration:1e3*C,amount:E*(C/2)}}class Ca extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,g,x={}){const w=ye(h.getCanvasContainer(),g),E=h.unproject(w);super(s,i.l({point:w,lngLat:E,originalEvent:g},x)),this._defaultPrevented=!1,this.target=h}}class El extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,g){const x=s==="touchend"?g.changedTouches:g.touches,w=ze(h.getCanvasContainer(),x),E=w.map(O=>h.unproject(O)),C=w.reduce((O,z,F,G)=>O.add(z.div(G.length)),new i.P(0,0));super(s,{points:w,point:C,lngLats:E,lngLat:h.unproject(C),originalEvent:g}),this._defaultPrevented=!1}}class U0 extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h){super("wheel",{originalEvent:h}),this._defaultPrevented=!1}}class ru{constructor(s,h){this._map=s,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new U0(this._map,s))}mousedown(s,h){return this._mousedownPos=h,this._firePreventable(new Ca(s.type,this._map,s))}mouseup(s){this._map.fire(new Ca(s.type,this._map,s))}preclick(s){const h=i.l({},s);h.type="preclick",this._map.fire(new Ca(h.type,this._map,h))}click(s,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(s),this._map.fire(new Ca(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new Ca(s.type,this._map,s))}mouseover(s){this._map.fire(new Ca(s.type,this._map,s))}mouseout(s){this._map.fire(new Ca(s.type,this._map,s))}touchstart(s){return this._firePreventable(new El(s.type,this._map,s))}touchmove(s){this._map.fire(new El(s.type,this._map,s))}touchend(s){this._map.fire(new El(s.type,this._map,s))}touchcancel(s){this._map.fire(new El(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class V0{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new Ca(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ca("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new Ca(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Yg{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,h){this.isEnabled()&&s.shiftKey&&s.button===0&&(K(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(s,h){if(!this._active)return;const g=h,x=this._startPos,w=this._lastPos;if(!x||!w||w.equals(g)||!this._box&&g.dist(x)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=L("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const E=Math.min(x.x,g.x),C=Math.max(x.x,g.x),O=Math.min(x.y,g.y),z=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${O}px)`,this._box.style.width=C-E+"px",this._box.style.height=z-O+"px")})}mouseupWindow(s,h){if(!this._active)return;const g=this._startPos,x=h;if(g&&s.button===0){if(this.reset(),ce(),g.x!==x.x||g.y!==x.y)return this._map.fire(new i.A("boxzoomend",{originalEvent:s})),{cameraAnimation:w=>w.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Y(),delete this._startPos,delete this._lastPos}_fireEvent(s,h){return this._map.fire(new i.A(s,{originalEvent:h}))}}function Mp(m,s){const h={};for(let g=0;g<m.length;g++)h[m[g].identifier]=s[g];return h}class G0{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,h,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const w=new i.P(0,0);for(const E of x)w._add(E);return w.div(x.length)}(h),this.touches=Mp(g,h)))}touchmove(s,h,g){if(this.aborted||!this.centroid)return;const x=Mp(g,h);for(const w in this.touches){const E=x[w];(!E||E.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(s,h,g){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class bo{constructor(s){this.singleTap=new G0(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,h,g){this.singleTap.touchstart(s,h,g)}touchmove(s,h,g){this.singleTap.touchmove(s,h,g)}touchend(s,h,g){const x=this.singleTap.touchend(s,h,g);if(x){const w=s.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(x)<30;if(w&&E||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class W0{constructor(){this._zoomIn=new bo({numTouches:1,numTaps:2}),this._zoomOut=new bo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,h,g){this._zoomIn.touchstart(s,h,g),this._zoomOut.touchstart(s,h,g)}touchmove(s,h,g){this._zoomIn.touchmove(s,h,g),this._zoomOut.touchmove(s,h,g)}touchend(s,h,g){const x=this._zoomIn.touchend(s,h,g),w=this._zoomOut.touchend(s,h,g);return x?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(x)},{originalEvent:s})}):w?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(w)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const H0={0:1,2:2},iu={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class Op{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,h){return!1}_move(s,h){return{}}mousedown(s,h){if(this._lastPoint)return;const g=Le(s);this._correctButton(s,g)&&(this._lastPoint=h,this._eventButton=g)}mousemoveWindow(s,h){const g=this._lastPoint;if(g){if(s.preventDefault(),this._eventButton!=null&&function(x,w){const E=H0[w];return x.buttons===void 0||(x.buttons&E)!==E}(s,this._eventButton))this.reset();else if(this._moved||!(h.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(g,h)}}mouseupWindow(s){this._lastPoint&&Le(s)===this._eventButton&&(this._moved&&ce(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class q0 extends Op{mousedown(s,h){super.mousedown(s,h),this._lastPoint&&(this._active=!0)}_correctButton(s,h){return h===0&&!s.ctrlKey}_move(s,h){return{around:h,panDelta:h.sub(s)}}}class Jg extends Op{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?iu[s.pitchRotateKey]:void 0}_correctButton(s,h){return this._pitchRotateKey?h===0&&s[this._pitchRotateKey]:h===0&&s.ctrlKey||h===2}_move(s,h){const g=.8*(h.x-s.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class rh extends Op{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?iu[s.pitchRotateKey]:void 0}_correctButton(s,h){return this._pitchRotateKey?h===0&&s[this._pitchRotateKey]:h===0&&s.ctrlKey||h===2}_move(s,h){const g=-.5*(h.y-s.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Z0{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),i.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(s,h,g){return this._calculateTransform(s,h,g)}touchmove(s,h,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!i.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,h,g)}}touchend(s,h,g){this._calculateTransform(s,h,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,h,g){g.length>0&&(this._active=!0);const x=Mp(g,h),w=new i.P(0,0),E=new i.P(0,0);let C=0;for(const z in x){const F=x[z],G=this._touches[z];G&&(w._add(F),E._add(F.sub(G)),C++,x[z]=F)}if(this._touches=x,C<this._minTouches||!E.mag())return;const O=E.div(C);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(C),panDelta:O}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class kp{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,h,g){return{}}touchstart(s,h,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([h[0],h[1]]))}touchmove(s,h,g){const x=this._firstTwoTouches;if(!x)return;s.preventDefault();const[w,E]=x,C=Sd(g,h,w),O=Sd(g,h,E);if(!C||!O)return;const z=this._aroundCenter?null:C.add(O).div(2);return this._move([C,O],z,s)}touchend(s,h,g){if(!this._firstTwoTouches)return;const[x,w]=this._firstTwoTouches,E=Sd(g,h,x),C=Sd(g,h,w);E&&C||(this._active&&ce(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Sd(m,s,h){for(let g=0;g<m.length;g++)if(m[g].identifier===h)return s[g]}function Rp(m,s){return Math.log(m/s)/Math.LN2}class X0 extends kp{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,h){const g=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Rp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Rp(this._distance,g),pinchAround:h}}}function Qg(m,s){return 180*m.angleWith(s)/Math.PI}class NS extends kp{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,h){const g=this._vector;if(this._vector=s[0].sub(s[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Qg(this._vector,g),pinchAround:h}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const h=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const x=Qg(s,g);return Math.abs(x)<h}}function ey(m){return Math.abs(m.y)>Math.abs(m.x)}class FS extends kp{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,ey(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,h,g){const x=this._lastPoints;if(!x)return;const w=s[0].sub(x[0]),E=s[1].sub(x[1]);return this._map._cooperativeGestures&&!i.ex()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(w,E,g.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(w.y+E.y)/2*-.5})}gestureBeginsVertically(s,h,g){if(this._valid!==void 0)return this._valid;const x=s.mag()>=2,w=h.mag()>=2;if(!x&&!w)return;if(!x||!w)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const E=s.y>0==h.y>0;return ey(s)&&ey(h)&&E}}const BS={panStep:100,bearingStep:15,pitchStep:10};class jS{constructor(){const s=BS;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let h=0,g=0,x=0,w=0,E=0;switch(s.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:s.shiftKey?g=-1:(s.preventDefault(),w=-1);break;case 39:s.shiftKey?g=1:(s.preventDefault(),w=1);break;case 38:s.shiftKey?x=1:(s.preventDefault(),E=-1);break;case 40:s.shiftKey?x=-1:(s.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:C=>{const O=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:$S,zoom:h?Math.round(O)+h*(s.shiftKey?2:1):O,bearing:C.getBearing()+g*this._bearingStep,pitch:C.getPitch()+x*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:C.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function $S(m){return m*(2-m)}const K0=4.000244140625,US=1/450;class VS{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._handler=h,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=US,i.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||i.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const g=i.q.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,h!==0&&h%K0==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=h,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(x*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),s.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=s,this._delta-=h,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=ye(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>K0?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&F!==0&&(F=1/F);const G=h(),U=Math.pow(2,G),Z=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(Z*F))),this._type==="wheel"&&(this._startZoom=G,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:h(),x=this._startZoom,w=this._easing;let E,C=!1;if(this._type==="wheel"&&x&&w){const z=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),F=w(z);E=i.ai(x,g,F),z<1?this._frameId||(this._frameId=!0):C=!0}else E=g,C=!0;this._active=!0,C&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let O=E-h();return O*this._lastDelta<0&&(O=0),{noInertia:!0,needsRenderFrame:!C,zoomDelta:O,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let h=i.ey;if(this._prevEase){const g=this._prevEase,x=(i.q.now()-g.start)/g.duration,w=g.easing(x+.01)-g.easing(x),E=.27/Math.sqrt(w*w+1e-4)*.01,C=Math.sqrt(.0729-E*E);h=i.ew(E,C,.25,1)}return this._prevEase={start:i.q.now(),duration:s,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class GS{constructor(s,h){this._clickZoom=s,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class WS{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,h){return s.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(s.shiftKey?-1:1),around:g.unproject(h)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class HS{constructor(){this._tap=new bo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,h,g){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=h[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(s,h,g))}touchmove(s,h,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=h[0],w=x.y-this._swipePoint.y;return this._swipePoint=x,s.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(s,h,g)}touchend(s,h,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(s,h,g)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qS{constructor(s,h,g){this._el=s,this._mousePan=h,this._touchPan=g}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class FI{constructor(s,h,g){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=h,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class BI{constructor(s,h,g,x){this._el=s,this._touchZoom=h,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ti=m=>m.zoom||m.drag||m.pitch||m.rotate;class ZS extends i.A{}class jI{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,h){const g=i.at([],h,s);this.radius=i.ae(g[2]<0?i.eA([],g,this.constants):[g[0],g[1],0])}projectRay(s){i.eA(s,s,this.constants),i.au(s,s),i.eB(s,s,this.constants);const h=i.b$([],s,this.radius);if(h[2]>0){const g=i.b$([],[0,0,1],i.bE(h,[0,0,1])),x=i.b$([],i.au([],[h[0],h[1],0]),this.radius),w=i.cU([],h,i.b$([],i.at([],i.cU([],x,g),h),2));h[0]=w[0],h[1]=w[1]}return h}}function Td(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class $I{constructor(s,h){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Kg(s),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new jI,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),i.aV(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,w,E]of this._listeners){const C=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(w,C,E)}}destroy(){for(const[s,h,g]of this._listeners){const x=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(h,x,g)}}_addDefaultHandlers(s){const h=this._map,g=h.getCanvasContainer();this._add("mapEvent",new ru(h,s));const x=h.boxZoom=new Yg(h,s);this._add("boxZoom",x);const w=new W0,E=new WS;h.doubleClickZoom=new GS(E,w),this._add("tapZoom",w),this._add("clickZoom",E);const C=new HS;this._add("tapDragZoom",C);const O=h.touchPitch=new FS(h);this._add("touchPitch",O);const z=new Jg(s),F=new rh(s);h.dragRotate=new FI(s,z,F),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);const G=new q0(s),U=new Z0(h,s);h.dragPan=new qS(g,G,U),this._add("mousePan",G),this._add("touchPan",U,["touchZoom","touchRotate"]);const Z=new NS,te=new X0;h.touchZoomRotate=new BI(g,te,Z,C),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),this._add("blockableMapEvent",new V0(h));const ee=h.scrollZoom=new VS(h,this);this._add("scrollZoom",ee,["mousePan"]);const oe=h.keyboard=new jS;this._add("keyboard",oe);for(const re of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[re]&&h[re].enable(s[re])}_add(s,h,g){this._handlers.push({handlerName:s,handler:h,allowed:g}),this._handlersById[s]=h}stop(s){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ti(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,h,g){for(const x in s)if(x!==g&&(!h||h.indexOf(x)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const h=[];for(const g of s)this._el.contains(g.target)&&h.push(g);return h}handleEvent(s,h){this._updatingCamera=!0;const g=s.type==="renderFrame",x=g?void 0:s,w={needsRenderFrame:!1},E={},C={},O=s.touches?this._getMapTouches(s.touches):void 0,z=O?ze(this._el,O):g?void 0:ye(this._el,s);for(const{handlerName:U,handler:Z,allowed:te}of this._handlers){if(!Z.isEnabled())continue;let ee;this._blockedByActive(C,te,U)?Z.reset():Z[h||s.type]&&(ee=Z[h||s.type](s,z,O),this.mergeHandlerResult(w,E,ee,U,x),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||Z.isActive())&&(C[U]=Z)}const F={};for(const U in this._previousActiveHandlers)C[U]||(F[U]=x);this._previousActiveHandlers=C,(Object.keys(F).length||Td(w))&&(this._changes.push([w,E,F]),this._triggerRenderFrame()),(Object.keys(C).length||Td(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=w;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))}mergeHandlerResult(s,h,g,x,w){if(!g)return;i.l(s,g);const E={handlerName:x,originalEvent:g.originalEvent||w};g.zoomDelta!==void 0&&(h.zoom=E),g.panDelta!==void 0&&(h.drag=E),g.pitchDelta!==void 0&&(h.pitch=E),g.bearingDelta!==void 0&&(h.rotate=E)}_applyChanges(){const s={},h={},g={};for(const[x,w,E]of this._changes)x.panDelta&&(s.panDelta=(s.panDelta||new i.P(0,0))._add(x.panDelta)),x.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(s.around=x.around),x.aroundCoord!==void 0&&(s.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(s.pinchAround=x.pinchAround),x.noInertia&&(s.noInertia=x.noInertia),i.l(h,w),i.l(g,E);this._updateMapTransform(s,h,g),this._changes=[]}_updateMapTransform(s,h,g){const x=this._map,w=x.transform,E=fe=>[fe.x,fe.y,fe.z];if((fe=>{const _e=this._eventsInProgress.drag;return _e&&!this._handlersById[_e.handlerName].isActive()})()&&!Td(s)){const fe=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),fe!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&x._stop(!0),!Td(s))return void this._fireEvents(h,g,!0);let{panDelta:C,zoomDelta:O,bearingDelta:z,pitchDelta:F,around:G,aroundCoord:U,pinchAround:Z}=s;w._isCameraConstrained&&(O>0&&(O=0),w._isCameraConstrained=!1),Z!==void 0&&(G=Z),(O||(fe=>h[fe]&&!this._eventsInProgress[fe])("drag"))&&G&&(this._dragOrigin=E(w.pointCoordinate3D(G)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",x._stop(!0),G=G||x.transform.centerPoint,z&&(w.bearing+=z),F&&(w.pitch+=F),w._updateCameraState();const te=[0,0,0];if(C)if(w.projection.name==="mercator"){const fe=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(G).dir),_e=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(G.sub(C)).dir);te[0]=_e[0]-fe[0],te[1]=_e[1]-fe[1]}else{const fe=w.pointCoordinate(G);if(w.projection.name==="globe"){C=C.rotate(-w.angle);const _e=w._pixelsPerMercatorPixel/w.worldSize;te[0]=-C.x*i.ez(i.aY(fe.y))*_e,te[1]=-C.y*i.ez(w.center.lat)*_e}else{const _e=w.pointCoordinate(G.sub(C));fe&&_e&&(te[0]=_e.x-fe.x,te[1]=_e.y-fe.y)}}const ee=w.zoom,oe=[0,0,0];if(O){const fe=E(U||w.pointCoordinate3D(G)),_e={dir:i.au([],i.at([],fe,w._camera.position))};if(_e.dir[2]<0){const be=w.zoomDeltaToMovement(fe,O);i.b$(oe,_e.dir,be)}}const re=i.cU(te,te,oe);w._translateCameraConstrained(re),O&&Math.abs(w.zoom-ee)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(h,g,!0)}_fireEvents(s,h,g){const x=Ti(this._eventsInProgress),w=Ti(s),E={};for(const F in s){const{originalEvent:G}=s[F];this._eventsInProgress[F]||(E[`${F}start`]=G),this._eventsInProgress[F]=s[F]}!x&&w&&this._fireEvent("movestart",w.originalEvent);for(const F in E)this._fireEvent(F,E[F]);w&&this._fireEvent("move",w.originalEvent);for(const F in s){const{originalEvent:G}=s[F];this._fireEvent(F,G)}const C={};let O;for(const F in this._eventsInProgress){const{handlerName:G,originalEvent:U}=this._eventsInProgress[F];this._handlersById[G].isActive()||(delete this._eventsInProgress[F],O=h[G]||U,C[`${F}end`]=O)}for(const F in C)this._fireEvent(F,C[F]);const z=Ti(this._eventsInProgress);if(g&&(x||w)&&!z){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),G=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;F?(G(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:O})):(this._map.fire(new i.A("moveend",{originalEvent:O})),G(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,h){this._map.fire(new i.A(s,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new ZS("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ed="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class XS extends i.E{constructor(s,h){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,i.aV(["_renderFrameCallback"],this)}getCenter(){return new i.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(s,h){return this.jumpTo({center:s},h)}panBy(s,h,g){return s=i.P.convert(s).mult(-1),this.panTo(this.transform.center,i.l({offset:s},h),g)}panTo(s,h,g){return this.easeTo(i.l({center:s},h),g)}getZoom(){return this.transform.zoom}setZoom(s,h){return this.jumpTo({zoom:s},h),this}zoomTo(s,h,g){return this.easeTo(i.l({zoom:s},h),g)}zoomIn(s,h){return this.zoomTo(this.getZoom()+1,s,h),this}zoomOut(s,h){return this.zoomTo(this.getZoom()-1,s,h),this}getBearing(){return this.transform.bearing}setBearing(s,h){return this.jumpTo({bearing:s},h),this}getPadding(){return this.transform.padding}setPadding(s,h){return this.jumpTo({padding:s},h),this}rotateTo(s,h,g){return this.easeTo(i.l({bearing:s},h),g)}resetNorth(s,h){return this.rotateTo(0,i.l({duration:1e3},s),h),this}resetNorthPitch(s,h){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},s),h),this}snapToNorth(s,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,h):this}getPitch(){return this.transform.pitch}setPitch(s,h){return this.jumpTo({pitch:s},h),this}cameraForBounds(s,h){s=i.aG.convert(s);const g=h&&h.bearing||0,x=h&&h.pitch||0,w=s.getNorthWest(),E=s.getSouthEast();return this._cameraForBounds(this.transform,w,E,g,x,h)}_extendPadding(s){const h={top:0,right:0,bottom:0,left:0};return s==null?i.l({},h,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:i.l({},h,s)}_extendCameraOptions(s){return(s=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,h){const g=h.max[0]-h.min[0],x=h.max[1]-h.min[1];return g/x>s.aspect?g/(2*Math.tan(.5*s.fovX)*s.aspect):x/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,h,g,x,w,E){const C=s.clone(),O=this._extendCameraOptions(E);C.bearing=x,C.pitch=w;const z=i.cd.convert(h),F=i.cd.convert(g),G=.5*(z.lat+F.lat),U=.5*(z.lng+F.lng),Z=i.eC(G,U),te=i.au([],Z),ee=i.au([],i.bG([],te,[0,1,0])),oe=i.bG([],ee,te),re=[ee[0],ee[1],ee[2],0,oe[0],oe[1],oe[2],0,te[0],te[1],te[2],0,0,0,0,1],fe=[Z,i.eC(z.lat,z.lng),i.eC(F.lat,z.lng),i.eC(F.lat,F.lng),i.eC(z.lat,F.lng),i.eC(G,z.lng),i.eC(G,F.lng),i.eC(z.lat,U),i.eC(F.lat,U)];let _e=i.cV.fromPoints(fe.map(at=>[i.bE(ee,at),i.bE(oe,at),i.bE(te,at)]));const be=i.ad([],_e.center,re);i.eD(be)===0&&i.eE(be,0,0,1),i.au(be,be),i.b$(be,be,i.aE),C.center=i.eF(be);const Pe=C.getWorldToCameraMatrix(),Ee=i.bi(new Float64Array(16),Pe);_e=i.cV.applyTransform(_e,i.az([],Pe,re));const Ae=this._extendAABB(_e,C,O,x);if(!Ae)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");_e=Ae,i.ad(be,be,Pe);const we=.5*(_e.max[2]-_e.min[2]),Me=this._minimumAABBFrustumDistance(C,_e),ke=i.b$([],[0,0,1],we),Qe=i.cU(ke,be,ke),qe=Me+(C.pitch===0?0:i.bD(be,Qe)),mt=C.globeCenterInViewSpace,dt=i.at([],be,[mt[0],mt[1],mt[2]]);i.au(dt,dt),i.b$(dt,dt,qe);const Ot=i.cU([],be,dt);i.ad(Ot,Ot,Ee);const Ze=i.eq/i.aE,et=i.ae(Ot),We=i.c6(Math.max(et*Ze-i.eq,Number.EPSILON),0),vt=Math.min(C.zoomFromMercatorZAdjusted(We),O.maxZoom);return vt>.5*(i.cL+i.cx)?(C.setProjection({name:"mercator"}),C.zoom=vt,this._cameraForBounds(C,h,g,x,w,E)):{center:C.center,zoom:vt,bearing:x,pitch:w}}_extendAABB(s,h,g,x){const w=.5*((g.padding.left||0)+(g.padding.right||0)),E=.5*((g.padding.top||0)+(g.padding.bottom||0)),C=E,O=w,z=w,F=E,G=h.width-(O+z),U=h.height-(C+F),Z=i.at([],s.max,s.min),te=Math.min(G/Z[0],U/Z[1]),ee=Math.min(h.scaleZoom(h.scale*te),g.maxZoom);if(isNaN(ee))return null;const oe=h.scale/h.zoomScale(ee),re=new i.cV([s.min[0]-O*oe,s.min[1]-F*oe,s.min[2]],[s.max[0]+z*oe,s.max[1]+C*oe,s.max[2]]),fe=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new i.P(g.offset.x,g.offset.y):i.P.convert(g.offset)).rotate(-i.al(x));return re.center[0]-=fe.x*oe,re.center[1]+=fe.y*oe,re}queryTerrainElevation(s,h){const g=this.transform.elevation;return g?(h=i.l({},{exaggerated:!0},h),g.getAtPoint(i.ac.fromLngLat(s),null,h.exaggerated)):null}_cameraForBounds(s,h,g,x,w,E){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,h,g,x,w,E);const C=s.clone(),O=this._extendCameraOptions(E);C.bearing=x,C.pitch=w;const z=i.cd.convert(h),F=i.cd.convert(g),G=new i.cd(z.lng,F.lat),U=new i.cd(F.lng,z.lat),Z=C.project(z),te=C.project(F),ee=this.queryTerrainElevation(z),oe=this.queryTerrainElevation(F),re=this.queryTerrainElevation(G),fe=this.queryTerrainElevation(U),_e=[[Z.x,Z.y,Math.min(ee||0,oe||0,re||0,fe||0)],[te.x,te.y,Math.max(ee||0,oe||0,re||0,fe||0)]];let be=i.cV.fromPoints(_e);const Pe=C.getWorldToCameraMatrix(),Ee=i.bi(new Float64Array(16),Pe);be=i.cV.applyTransform(be,Pe);const Ae=this._extendAABB(be,C,O,x);if(!Ae)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");be=Ae;const we=.5*i.at([],be.max,be.min)[2],Me=this._minimumAABBFrustumDistance(C,be),ke=[0,0,1,0];i.aA(ke,ke,Pe),i.eG(ke,ke);const Qe=i.b$([],ke,Me+we),qe=i.cU([],be.center,Qe);i.ad(be.center,be.center,Ee),i.ad(qe,qe,Ee);const mt=C.unproject(new i.P(be.center[0],be.center[1])),dt=i.eH(C.projection,mt),Ot=Math.pow(2,dt),Ze=Math.min(C._zoomFromMercatorZ(qe[2]*C.pixelsPerMeter*Ot/C.worldSize),O.maxZoom);return C.mercatorFromTransition&&Ze<.5*(i.cL+i.cx)?(C.setProjection({name:"globe"}),C.zoom=Ze,this._cameraForBounds(C,h,g,x,w,E)):{center:mt,zoom:Ze,bearing:x,pitch:w}}fitBounds(s,h,g){const x=this.cameraForBounds(s,h);return this._fitInternal(x,h,g)}fitScreenCoordinates(s,h,g,x,w){const E=i.P.convert(s),C=i.P.convert(h),O=new i.P(Math.min(E.x,C.x),Math.min(E.y,C.y)),z=new i.P(Math.max(E.x,C.x),Math.max(E.y,C.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,C))return this;const F=this.transform.pointLocation3D(O),G=this.transform.pointLocation3D(z),U=this.transform.pointLocation3D(new i.P(O.x,z.y)),Z=this.transform.pointLocation3D(new i.P(z.x,O.y)),te=[Math.min(F.lng,G.lng,U.lng,Z.lng),Math.min(F.lat,G.lat,U.lat,Z.lat)],ee=[Math.max(F.lng,G.lng,U.lng,Z.lng),Math.max(F.lat,G.lat,U.lat,Z.lat)],oe=x&&x.pitch?x.pitch:this.getPitch(),re=this._cameraForBounds(this.transform,te,ee,g,oe,x);return this._fitInternal(re,x,w)}_fitInternal(s,h,g){return s?(h=i.l(s,h)).linear?this.easeTo(h,g):this.flyTo(h,g):this}jumpTo(s,h){this.stop();const g=s.preloadOnly?this.transform.clone():this.transform;let x=!1,w=!1,E=!1;"zoom"in s&&g.zoom!==+s.zoom&&(x=!0,g.zoom=+s.zoom),s.center!==void 0&&(g.center=i.cd.convert(s.center)),"bearing"in s&&g.bearing!==+s.bearing&&(w=!0,g.bearing=+s.bearing),"pitch"in s&&g.pitch!==+s.pitch&&(E=!0,g.pitch=+s.pitch);const C=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!g.isPaddingEqual(C))if(s.retainPadding===!1){const O=g.clone();O.padding=C,g.setLocationAtPoint(g.center,O.centerPoint)}else g.padding=C;return s.preloadOnly?(this._preloadTiles(g),this):(this.fire(new i.A("movestart",h)).fire(new i.A("move",h)),x&&this.fire(new i.A("zoomstart",h)).fire(new i.A("zoom",h)).fire(new i.A("zoomend",h)),w&&this.fire(new i.A("rotatestart",h)).fire(new i.A("rotate",h)).fire(new i.A("rotateend",h)),E&&this.fire(new i.A("pitchstart",h)).fire(new i.A("pitch",h)).fire(new i.A("pitchend",h)),this.fire(new i.A("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(Ed),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,h){const g=this.transform;if(!g.projection.supportsFreeCamera)return i.w(Ed),this;this.stop();const x=g.zoom,w=g.pitch,E=g.bearing;g.setFreeCameraOptions(s);const C=x!==g.zoom,O=w!==g.pitch,z=E!==g.bearing;return this.fire(new i.A("movestart",h)).fire(new i.A("move",h)),C&&this.fire(new i.A("zoomstart",h)).fire(new i.A("zoom",h)).fire(new i.A("zoomend",h)),z&&this.fire(new i.A("rotatestart",h)).fire(new i.A("rotate",h)).fire(new i.A("rotateend",h)),O&&this.fire(new i.A("pitchstart",h)).fire(new i.A("pitch",h)).fire(new i.A("pitchend",h)),this.fire(new i.A("moveend",h)),this}easeTo(s,h){this._stop(!1,s.easeId),((s=i.l({offset:[0,0],duration:500,easing:i.ey},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const g=this.transform,x=this.getZoom(),w=this.getBearing(),E=this.getPitch(),C=this.getPadding(),O="zoom"in s?+s.zoom:x,z="bearing"in s?this._normalizeBearing(s.bearing,w):w,F="pitch"in s?+s.pitch:E,G=this._extendPadding(s.padding),U=i.P.convert(s.offset);let Z,te,ee;if(g.projection.name==="globe"){const ke=i.ac.fromLngLat(g.center),Qe=U.rotate(-g.angle);ke.x+=Qe.x/g.worldSize,ke.y+=Qe.y/g.worldSize;const qe=ke.toLngLat(),mt=i.cd.convert(s.center||qe);this._normalizeCenter(mt),Z=g.centerPoint.add(Qe),te=new i.P(ke.x,ke.y).mult(g.worldSize),ee=new i.P(i.ay(mt.lng),i.aH(mt.lat)).mult(g.worldSize).sub(te)}else{Z=g.centerPoint.add(U);const ke=g.pointLocation(Z),Qe=i.cd.convert(s.center||ke);this._normalizeCenter(Qe),te=g.project(ke),ee=g.project(Qe).sub(te)}const oe=g.zoomScale(O-x);let re,fe;s.around&&(re=i.cd.convert(s.around),fe=g.locationPoint(re));const _e=this._zooming||O!==x,be=this._rotating||w!==z,Pe=this._pitching||F!==E,Ee=!g.isPaddingEqual(G),Ae=s.retainPadding===!1?g.clone():g,we=ke=>Qe=>{if(_e&&(ke.zoom=i.ai(x,O,Qe)),be&&(ke.bearing=i.ai(w,z,Qe)),Pe&&(ke.pitch=i.ai(E,F,Qe)),Ee&&(Ae.interpolatePadding(C,G,Qe),Z=Ae.centerPoint.add(U)),re)ke.setLocationAtPoint(re,fe);else{const qe=ke.zoomScale(ke.zoom-x),mt=O>x?Math.min(2,oe):Math.max(.5,oe),dt=Math.pow(mt,1-Qe),Ot=ke.unproject(te.add(ee.mult(Qe*dt)).mult(qe));ke.setLocationAtPoint(ke.renderWorldCopies?Ot.wrap():Ot,Z)}return s.preloadOnly||this._fireMoveEvents(h),ke};if(s.preloadOnly){const ke=this._emulate(we,s.duration,g);return this._preloadTiles(ke),this}const Me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_e,this._rotating=be,this._pitching=Pe,this._padding=Ee,this._easeId=s.easeId,this._prepareEase(h,s.noMoveStart,Me),this._ease(we(g),ke=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(h,ke)},s),this}_prepareEase(s,h,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),h||g.moving||this.fire(new i.A("movestart",s)),this._zooming&&!g.zooming&&this.fire(new i.A("zoomstart",s)),this._rotating&&!g.rotating&&this.fire(new i.A("rotatestart",s)),this._pitching&&!g.pitching&&this.fire(new i.A("pitchstart",s))}_fireMoveEvents(s){this.fire(new i.A("move",s)),this._zooming&&this.fire(new i.A("zoom",s)),this._rotating&&this.fire(new i.A("rotate",s)),this._pitching&&this.fire(new i.A("pitch",s))}_afterEase(s,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,x=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new i.A("zoomend",s)),x&&this.fire(new i.A("rotateend",s)),w&&this.fire(new i.A("pitchend",s)),this.fire(new i.A("moveend",s))}flyTo(s,h){if(this._prefersReducedMotion(s)){const at=i.aF(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(at,h)}this.stop(),s=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.ey},s);const g=this.transform,x=this.getZoom(),w=this.getBearing(),E=this.getPitch(),C=this.getPadding(),O="zoom"in s?i.aD(+s.zoom,g.minZoom,g.maxZoom):x,z="bearing"in s?this._normalizeBearing(s.bearing,w):w,F="pitch"in s?+s.pitch:E,G=this._extendPadding(s.padding),U=g.zoomScale(O-x),Z=i.P.convert(s.offset);let te=g.centerPoint.add(Z);const ee=g.pointLocation(te),oe=i.cd.convert(s.center||ee);this._normalizeCenter(oe);const re=g.project(ee),fe=g.project(oe).sub(re);let _e=s.curve;const be=Math.max(g.width,g.height),Pe=be/U,Ee=fe.mag();if("minZoom"in s){const at=i.aD(Math.min(s.minZoom,x,O),g.minZoom,g.maxZoom),Tt=be/g.zoomScale(at-x);_e=Math.sqrt(Tt/Ee*2)}const Ae=_e*_e;function we(at){const Tt=(Pe*Pe-be*be+(at?-1:1)*Ae*Ae*Ee*Ee)/(2*(at?Pe:be)*Ae*Ee);return Math.log(Math.sqrt(Tt*Tt+1)-Tt)}function Me(at){return(Math.exp(at)-Math.exp(-at))/2}function ke(at){return(Math.exp(at)+Math.exp(-at))/2}const Qe=we(0);let qe=function(at){return ke(Qe)/ke(Qe+_e*at)},mt=function(at){return be*((ke(Qe)*(Me(Tt=Qe+_e*at)/ke(Tt))-Me(Qe))/Ae)/Ee;var Tt},dt=(we(1)-Qe)/_e;if(Math.abs(Ee)<1e-6||!isFinite(dt)){if(Math.abs(be-Pe)<1e-6)return this.easeTo(s,h);const at=Pe<be?-1:1;dt=Math.abs(Math.log(Pe/be))/_e,mt=function(){return 0},qe=function(Tt){return Math.exp(at*_e*Tt)}}s.duration="duration"in s?+s.duration:1e3*dt/("screenSpeed"in s?+s.screenSpeed/_e:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const Ot=w!==z,Ze=F!==E,et=!g.isPaddingEqual(G),We=s.retainPadding===!1?g.clone():g,vt=at=>Tt=>{const gt=Tt*dt,Et=1/qe(gt);at.zoom=Tt===1?O:x+at.scaleZoom(Et),Ot&&(at.bearing=i.ai(w,z,Tt)),Ze&&(at.pitch=i.ai(E,F,Tt)),et&&(We.interpolatePadding(C,G,Tt),te=We.centerPoint.add(Z));const At=Tt===1?oe:at.unproject(re.add(fe.mult(mt(gt))).mult(Et));return at.setLocationAtPoint(at.renderWorldCopies?At.wrap():At,te),at._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(h),at};if(s.preloadOnly){const at=this._emulate(vt,s.duration,g);return this._preloadTiles(at),this}return this._zooming=!0,this._rotating=Ot,this._pitching=Ze,this._padding=et,this._prepareEase(h,!1),this._ease(vt(g),()=>this._afterEase(h),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,h)}if(!s){const g=this.handlers;g&&g.stop(!1)}return this}_ease(s,h,g){g.animate===!1||g.duration===0?(s(1),h()):(this._easeStart=i.q.now(),this._easeOptions=g,this._onEaseFrame=s,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,h){s=i.bX(s,-180,180);const g=Math.abs(s-h);return Math.abs(s-360-h)<g&&(s-=360),Math.abs(s+360-h)<g&&(s+=360),s}_normalizeCenter(s){const h=this.transform;if(h.maxBounds||h.projection.name!=="globe"&&!h.renderWorldCopies)return;const g=s.lng-h.center.lng;s.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,h,g){const x=Math.ceil(15*h/1e3),w=[],E=s(g.clone());for(let C=0;C<=x;C++){const O=E(C/x);w.push(O.clone())}return w}_preloadTiles(s,h){}}class ty{constructor(s={}){this.options=s,i.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const h=this.options&&this.options.compact,g=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const x=L("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",g),this._innerContainer=L("div","mapboxgl-ctrl-attrib-inner",this._container),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(s){const g=h.reduce((x,w,E)=>(w.value&&(x+=`${w.key}=${w.value}${E<h.length-1?"&":""}`),x),"?");s.href=`${i.e.FEEDBACK_URL}/${g}#${Xg(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const h=this._map.style._mergedSourceCaches;for(const x in h){const w=h[x];if(w.used){const E=w.getSource();E.attribution&&s.indexOf(E.attribution)<0&&s.push(E.attribution)}}s.sort((x,w)=>x.length-w.length),s=s.filter((x,w)=>{for(let E=w+1;E<s.length;E++)if(s[E].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const g=s.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,s.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Dp{constructor(){i.aV(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=L("div","mapboxgl-ctrl");const h=L("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const h in s){const g=s[h].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const h=s[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Al{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const h=++this._id;return this._queue.push({callback:s,id:h,cancelled:!1}),h}remove(s){const h=this._currentlyRunning,g=h?this._queue.concat(h):this._queue;for(const x of g)if(x.id===s)return void(x.cancelled=!0)}run(s=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const g of h)if(!g.cancelled&&(g.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class ny{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const h=i.dk((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,h,g){this._start=this.getValue(h),this._end=s,this._startTime=h,this._endTime=h+g}}const Hi={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class tl extends i.A{constructor(s,h,g,x){const{point:w,lngLat:E,originalEvent:C,target:O}=s;super(s.type,{point:w,lngLat:E,originalEvent:C,target:O}),this.preventDefault=()=>{s.preventDefault()},this.id=h,this.interaction=g,this.feature=x}}class Lp{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,h){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const g=h.filter;let x=h.type;g&&this.filters.set(s,i.b3(g)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const w=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,h)):w.size===0&&this.map.on(x,this.handleType),w.size===0&&this.interactionsByType.set(x,w),w.set(s,h),this.typeById.set(s,x)}get(s){const h=this.typeById.get(s);if(!h)return;const g=this.interactionsByType.get(h);return g?g.get(s):void 0}remove(s){const h=this.typeById.get(s);if(!h)return;this.typeById.delete(s),this.filters.delete(s);const g=this.interactionsByType.get(h);g&&(g.delete(s),h==="mouseenter"||h==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):g.size===0&&this.map.off(h,this.handleType))}queryTargets(s,h){const g=[];for(const[x,w]of h)w.target&&g.push({targetId:x,target:w.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(s,g,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const h=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());h.length&&(s.type="mouseenter",this.handleType(s,h));const g=new Map;for(const[x,{feature:w}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||g.set(w.id,w);g.size&&(s.type="mouseleave",this.handleType(s,Array.from(g.values())))}handleOut(s){const h=Array.from(this.hoveredFeatures.values()).map(({feature:g})=>g);h.length&&(s.type="mouseleave",this.handleType(s,h)),this.hoveredFeatures.clear()}handleType(s,h){const g=Array.from(this.interactionsByType.get(s.type)).reverse(),x=!!h;h=h||this.queryTargets(s.point,g);const w=s.type==="mouseenter";let E=!1;const C=new Set;for(const O of h){for(const[z,F]of g){if(!F.target)continue;const G=O.variants?O.variants[z]:null;if(G){for(const U of G){if(ep(U,O,C,z))continue;const Z=new i.df(O,U),te=ig(U,O,z);x&&(Z.state=this.map.getFeatureState(Z));const ee=w?this.prevHoveredFeatures.get(te):null,oe=new tl(s,z,F,Z),re=ee?ee.stop:F.handler(oe);if(w&&this.hoveredFeatures.set(te,{feature:O,stop:re}),re!==!1){E=!0;break}}if(E)break}}if(E)break}if(!E)for(const[O,z]of g){const{handler:F,target:G}=z;if(!G&&F(new tl(s,O,z,null))!==!1)break}}}function ry(m,s){if(Array.isArray(m)&&Array.isArray(s)){const h=new Set(m),g=new Set(s);return h.size===g.size&&m.every(x=>g.has(x))}return i.bv(m,s)}const KS={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},UI={showCompass:!0,showZoom:!0,visualizePitch:!1};class zp{constructor(s,h,g=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Jg({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,g&&(this.mousePitch=new rh({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),i.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(s,h){this.mouseRotate.mousedown(s,h),this.mousePitch&&this.mousePitch.mousedown(s,h),K()}move(s,h){const g=this.map,x=this.mouseRotate.mousemoveWindow(s,h),w=x&&x.bearingDelta;if(w&&g.setBearing(g.getBearing()+w),this.mousePitch){const E=this.mousePitch.mousemoveWindow(s,h),C=E&&E.pitchDelta;C&&g.setPitch(g.getPitch()+C)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Y(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(i.l({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),ye(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,ye(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ze(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=ze(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function YS(m,s,h){if(m=new i.cd(m.lng,m.lat),s){const g=new i.cd(m.lng-360,m.lat),x=new i.cd(m.lng+360,m.lat),w=360*Math.ceil(Math.abs(m.lng-h.center.lng)/360),E=h.locationPoint3D(m).distSqr(s),C=s.x<0||s.y<0||s.x>h.width||s.y>h.height;h.locationPoint3D(g).distSqr(s)<E&&(C||Math.abs(g.lng-h.center.lng)<w)?m=g:h.locationPoint3D(x).distSqr(s)<E&&(C||Math.abs(x.lng-h.center.lng)<w)&&(m=x)}for(;Math.abs(m.lng-h.center.lng)>180;){const g=h.locationPoint3D(m);if(g.x>=0&&g.y>=0&&g.x<=h.width&&g.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}const Y0={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Cs={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Np extends i.E{constructor(s,h){super(),(s instanceof HTMLElement||h)&&(s=i.l({element:s},h)),i.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:g="center",color:x="#3FB1CE",scale:w=1,draggable:E=!1,clickTolerance:C=0,rotation:O=Cs.rotation,rotationAlignment:z=Cs.rotationAlignment,pitchAlignment:F=Cs.pitchAlignment,occludedOpacity:G=Cs.occludedOpacity,altitude:U=Cs.altitude}=s||{};this._anchor=g,this._color=x,this._scale=w,this._draggable=E,this._clickTolerance=C,this._rotation=O,this._rotationAlignment=z,this._pitchAlignment=F,this._occludedOpacity=G,this._altitude=U,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),s&&s.element?(this._element=s.element,this._offset=i.P.convert(s&&s.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(s&&s.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",ee=>{ee.preventDefault()}),this._element.addEventListener("mousedown",ee=>{ee.preventDefault()});const Z=this._element.classList;for(const ee in Y0)Z.remove(`mapboxgl-marker-anchor-${ee}`);Z.add(`mapboxgl-marker-anchor-${this._anchor}`);const te=s&&s.className?s.className.trim().split(/\s+/):[];Z.add(...te),this._popup=null}_createDefaultMarker(){const s=L("div"),h=j("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},s);if(this._altitude===0){const g=j("radialGradient",{id:"shadowGradient"},j("defs",{},h));j("stop",{offset:"10%","stop-opacity":.4},g),j("stop",{offset:"100%","stop-opacity":.05},g),j("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},h)}return j("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},h),j("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},h),j("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},h),s}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=i.cd.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(s){return s===this._altitude||(this._defaultMarker&&(this._altitude===0&&s!==0||this._altitude!==0&&s===0)&&(this._element=this._createDefaultMarker()),this._altitude=s||Cs.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,s._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const h=s.code,g=s.charCode||s.keyCode;h!=="Space"&&h!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(s){const h=s.originalEvent.target,g=this._element;this._popup&&(h===g||g.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,h=this._pos;if(!s||!h)return!1;const g=s.unproject(h,this._altitude),x=s.getFreeCameraOptions();if(!x.position)return!1;const w=x.position.toLngLat();return w.distanceTo(g)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const h=this._pos;if(!h||h.x<0||h.x>s.transform.width||h.y<0||h.y>s.transform.height)return void this._clearFadeTimer();const g=s.unproject(h,this._altitude);let x;s._showingGlobe()&&i.eK(s.transform,this._lngLat)?x=0:(x=1-s._queryFogOpacity(g),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Y0[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const s=this._pos,h=this._map,g=this.getPitchAlignment();if(!h||!s||g!=="map")return"";if(!h._showingGlobe()){const O=h.getPitch();return O?`rotateX(${O}deg)`:""}const x=i.cJ(i.eL(h.transform,this._lngLat)),w=s.sub(i.eM(h.transform)),E=Math.abs(w.x)+Math.abs(w.y);if(E===0)return"";const C=x/E;return`rotateX(${-w.y*C}deg) rotateY(${w.x*C}deg)`}_calculateZTransform(){const s=this._pos,h=this._map;if(!h||!s)return"";let g=0;const x=this.getRotationAlignment();if(x==="map")if(h._showingGlobe()){const w=h.project(new i.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),E=h.project(new i.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(w);g=i.cJ(Math.atan2(E.y,E.x))-90}else g=-h.getBearing();else if(x==="horizon"){const w=i.af(4,6,h.getZoom()),E=i.eM(h.transform);E.y+=w*h.transform.height;const C=s.sub(E),O=i.cJ(Math.atan2(C.y,C.x));g=(O>90?O-270:O+90)*(1-w)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=YS(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat,this._altitude),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=i.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const h=this._map;if(!h)return;const g=this._pointerdownPos,x=this._positionDelta;if(g&&x){if(!this._isDragging){const w=this._clickTolerance||h._clickTolerance;if(s.point.dist(g)<w)return;this._isDragging=!0}this._pos=s.point.sub(x),this._lngLat=h.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.A("dragstart"))),this.fire(new i.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.A("dragend")),this._state="inactive"}_addDragHandler(s){const h=this._map,g=this._pos;h&&g&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(g),this._pointerdownPos=s.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const h=this._map;return h&&(s?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||Cs.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||Cs.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||Cs.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||Cs.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Fp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ad={maxWidth:100,unit:"metric"},sc={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},nl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},rl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ou(m=new i.P(0,0),s="bottom"){if(typeof m=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(s){case"top":return new i.P(0,m);case"top-left":return new i.P(h,h);case"top-right":return new i.P(-h,h);case"bottom":return new i.P(0,-m);case"bottom-left":return new i.P(h,-h);case"bottom-right":return new i.P(-h,-h);case"left":return new i.P(m,0);case"right":return new i.P(-m,0)}return new i.P(0,0)}return m instanceof i.P||Array.isArray(m)?i.P.convert(m):i.P.convert(m[s]||[0,0])}return{version:v,supported:B.supported,setRTLTextPlugin:i.eN,getRTLTextPluginStatus:i.eO,Map:class extends XS{constructor(m){T.mark(b.create);const s=m;if((m=i.l({},KS,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&i.eI(window)&&(m.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new $u(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies,null,null),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Al,this._domRenderTaskQueue=new Al,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.a$(),this._locale=i.l({},Hi,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=m.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ny(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=m.scaleFactor,this._requestManager=new Ge(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?Object.assign({},m.contextCreateOptions):{},typeof m.container=="string"){const h=document.getElementById(m.container);if(!h)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=h}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),this._spriteFormat=m.spriteFormat,i.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new z0),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new $I(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||i.e.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this.indoor=new nS(this),m.hash&&(this._hash=new xd(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});const h=m.bounds;h&&(this.resize(),this.fitBounds(h,i.l({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new ty({customAttribution:m.customAttribution})),this._logoControl=new Dp,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new i.A(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new i.A(`${h.dataType}dataloading`,h))}),this._interactions=new Lp(this)}_getMapId(){return this._mapId}addControl(m,s){if(s===void 0&&(s=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new i.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=m.onAdd(this);this._controls.push(m);const g=this._controlPositions[s];return s.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new i.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(m);return s>-1&&this._controls.splice(s,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new i.A("movestart",m)).fire(new i.A("move",m)),this.fire(new i.A("resize",m)),s&&this.fire(new i.A("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(i.aG.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(m){return this._scaleFactor=m,this.painter.scaleFactor=m,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(s=>s==="auto"?navigator.language:s):m}setLanguage(m){const s=this._parseLanguage(m);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,s=m.projection.name;let h;s==="globe"&&m.zoom>=i.cx?(m.setMercatorFromTransition(),h=!0):s==="mercator"&&m.zoom<i.cx&&(m.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,s){return this._updateProjection(m||s||{name:"mercator"})}_updateProjection(m){let s;return s=m.name==="globe"&&this.transform.zoom>=i.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m,s){return this.transform.locationPoint3D(i.cd.convert(m),s)}unproject(m,s){return this.transform.pointLocation3D(i.P.convert(m),s)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,s,h){const g=x=>{let w=[];if(Array.isArray(s)){const E=s.filter(C=>this.getLayer(C));w=E.length?this.queryRenderedFeatures(x,{layers:E}):[]}else w=this.queryRenderedFeatures(x,{target:s});return w};if(m==="mouseenter"||m==="mouseover"){let x=!1;return{listener:h,targets:s,delegates:{mousemove:E=>{const C=g(E.point);C.length?x||(x=!0,h.call(this,new Ca(m,this,E.originalEvent,{features:C}))):x=!1},mouseout:()=>{x=!1}}}}if(m==="mouseleave"||m==="mouseout"){let x=!1;return{listener:h,targets:s,delegates:{mousemove:C=>{g(C.point).length?x=!0:x&&(x=!1,h.call(this,new Ca(m,this,C.originalEvent)))},mouseout:C=>{x&&(x=!1,h.call(this,new Ca(m,this,C.originalEvent)))}}}}{const x=w=>{const E=g(w.point);E.length&&(w.features=E,h.call(this,w),delete w.features)};return{listener:h,targets:s,delegates:{[m]:x}}}}on(m,s,h){if(typeof s=="function"||h===void 0)return super.on(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(m,s,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(g);for(const x in g.delegates)this.on(x,g.delegates[x]);return this}once(m,s,h){if(typeof s=="function"||h===void 0)return super.once(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(m,s,h);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(m,s,h){if(typeof s=="function"||h===void 0)return super.off(m,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._delegatedListeners?this._delegatedListeners[m]:void 0;return g&&(x=>{for(let w=0;w<x.length;w++){const E=x[w];if(E.listener===h&&ry(E.targets,s)){for(const C in E.delegates)this.off(C,E.delegates[C]);return x.splice(w,1),this}}})(g),this}queryRenderedFeatures(m,s){if(!this.style)return[];if(m===void 0||m instanceof i.P||Array.isArray(m)||s!==void 0||(s=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],!s){const w=this.style.queryRenderedFeatures(m,void 0,this.transform),E=this.style.queryRenderedFeatureset(m,void 0,this.transform);return w.concat(E)}let h=!0;if(s.target&&(h=this._isTargetValid(s.target),h&&!s.layers))return this.style.queryRenderedFeatureset(m,s,this.transform);let g=!0;if(s.layers&&Array.isArray(s.layers)){for(const w of s.layers)if(!this._isValidId(w)){g=!1;break}if(g&&!s.target)return this.style.queryRenderedFeatures(m,s,this.transform)}let x=[];return g&&(x=x.concat(this.style.queryRenderedFeatures(m,s,this.transform))),h&&(x=x.concat(this.style.queryRenderedFeatureset(m,s,this.transform))),x}querySourceFeatures(m,s){return!m||typeof m=="string"&&!this._isValidId(m)?[]:this.style.querySourceFeatures(m,s)}isPointOnSurface(m){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&i.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(m))}addInteraction(m,s){return this._interactions.add(m,s),this}removeInteraction(m){return this._interactions.remove(m),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this}setStyle(m,s){return s=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&m&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(m,(h,g)=>{if(h){const x=typeof h=="string"?h:h instanceof Error?h.message:h.error;i.w(`Unable to perform style diff: ${x}. Rebuilding the style from scratch.`),this._updateStyle(m,s)}else g&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(m,s))}_getUIString(m){const s=this._locale[m];if(s==null)throw new Error(`Missing UI string '${m}'`);return s}_updateStyle(m,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){const h=i.l({},s);s&&s.config&&(h.initialConfig=s.config,delete h.config),this.style=new Es(this,h).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Es(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new i.z(new Error("IDs can't be empty."))),!1):!i.d9(m)||(this.fire(new i.z(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}_isTargetValid(m){return"featuresetId"in m?this._isValidId("importId"in m?m.importId:m.featuresetId):"layerId"in m&&this._isValidId(m.layerId)}_areTargetsValid(m){if(Array.isArray(m)){for(const s of m)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(m)}addSource(m,s){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,s),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,s,h){this._lazyInitEmptyStyle(),this.style.addSourceType(m,s,h)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,s,{pixelRatio:h=1,sdf:g=!1,stretchX:x,stretchY:w,content:E}={}){this._lazyInitEmptyStyle();const C=i.I.from(m);if(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:O,height:z,data:F}=i.q.getImageData(s);this.style.addImage(C,{data:new i.r({width:O,height:z},F),pixelRatio:h,stretchX:x,stretchY:w,content:E,sdf:g,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new i.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:z}=s,F=s;this.style.addImage(C,{data:new i.r({width:O,height:z},new Uint8Array(F.data)),pixelRatio:h,stretchX:x,stretchY:w,content:E,sdf:g,usvg:!1,version:0,userImage:F}),F.onAdd&&F.onAdd(this,m)}}updateImage(m,s){this._lazyInitEmptyStyle();const h=i.I.from(m),g=this.style.getImage(h);if(!g)return void this.fire(new i.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?i.q.getImageData(s):s,{width:w,height:E,data:C}=x;if(w===void 0||E===void 0)return void this.fire(new i.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==(g.usvg?g.icon.usvg_tree.width:g.data.width)||E!==(g.usvg?g.icon.usvg_tree.height:g.data.height))return void this.fire(new i.z(new Error(`The width and height of the updated image (${w}, ${E})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const O=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let z=!1;g.usvg?(g.data=new i.r({width:w,height:E},new Uint8Array(C)),g.usvg=!1,g.icon=void 0,z=!0):g.data.replace(C,O),this.style.updateImage(h,g,z)}hasImage(m){return m?!!this.style&&!!this.style.getImage(i.I.from(m)):(this.fire(new i.z(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(i.I.from(m))}loadImage(m,s){i.o(this._requestManager.transformRequest(m,i.R.Image),(h,g)=>{s(h,g instanceof HTMLImageElement?i.q.getImageData(g):g)})}listImages(){return this.style.listImages().map(m=>m.name)}addModel(m,s){this._lazyInitEmptyStyle(),this.style.addModel(m,s)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new i.z(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,s){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,s),this._update(!0)):this}getSlot(m){const s=this.getLayer(m);return s&&s.slot||null}setSlot(m,s){return this.style.setSlot(m,s),this.style.mergeLayers(),this._update(!0)}addImport(m,s){return this.style.addImport(m,s).catch(h=>this.fire(new i.z(new Error("Failed to add import",h)))),this}updateImport(m,s){return typeof s!="string"&&s.id!==m?(this.removeImport(m),this.addImport(s)):(this.style.updateImport(m,s),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,s){return this.style.moveImport(m,s),this._update(!0)}moveLayer(m,s){return this._isValidId(m)?(this.style.moveLayer(m,s),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){if(!this._isValidId(m))return null;const s=this.style.getOwnLayer(m);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,s,h){return this._isValidId(m)?(this.style.setLayerZoomRange(m,s,h),this._update(!0)):this}setFilter(m,s,h={}){return this._isValidId(m)?(this.style.setFilter(m,s,h),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,s,h,g={}){return this._isValidId(m)?(this.style.setPaintProperty(m,s,h,g),this._update(!0)):this}getPaintProperty(m,s){return this._isValidId(m)?this.style.getPaintProperty(m,s):null}setLayoutProperty(m,s,h,g={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,s,h,g),this._update(!0)):this}getLayoutProperty(m,s){return this._isValidId(m)?this.style.getLayoutProperty(m,s):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(m){return this.style.setGlyphsUrl(m),this._update(!0)}getSchema(m){return this.style.getSchema(m)}setSchema(m,s){return this.style.setSchema(m,s),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,s){return this.style.setConfig(m,s),this._update(!0)}getConfigProperty(m,s){return this.style.getConfigProperty(m,s)}setConfigProperty(m,s,h){return this.style.setConfigProperty(m,s,h),this._update(!0)}getFeaturesetDescriptors(m){return this.style.getFeaturesetDescriptors(m)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){const s=m[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(m){return this._lazyInitEmptyStyle(),this.style.setSnow(m),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(m){return this._lazyInitEmptyStyle(),this.style.setRain(m),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setImportColorTheme(m,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(m,s),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.cd.convert(m),this.transform):0}setFeatureState(m,s){return m.source&&!this._isValidId(m.source)?this:(this.style.setFeatureState(m,s),this._update())}removeFeatureState(m,s){return m.source&&!this._isValidId(m.source)?this:(this.style.removeFeatureState(m,s),this._update())}getFeatureState(m){return m.source&&!this._isValidId(m.source)?null:this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let h,g,x,w=this._container;for(;w&&(!g||!x);){const E=window.getComputedStyle(w).transform;E&&E!=="none"&&(h=E.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(g=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(x=h[3])),w=w.parentElement}this._containerWidth=g?Math.abs(m/g):m,this._containerHeight=x?Math.abs(s/x):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=L("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=L("div","mapboxgl-canvas-container",m);this._canvas=L("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=L("div","mapboxgl-control-container",m),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{g[x]=L("div",`mapboxgl-ctrl-${x}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,s){const h=i.q.devicePixelRatio||1;this._canvas.width=h*Math.ceil(m),this._canvas.height=h*Math.ceil(s),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${s}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const s=this._markers.indexOf(m);s!==-1&&this._markers.splice(s,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const s=this._popups.indexOf(m);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const m=i.l({},B.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",m);s?(kt(s,!0),this.painter=new Zg(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(s)):this.fire(new i.z(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.A("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new i.A("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let s;this.fire(new i.A("renderstart")),++this._frameId;const h=this.painter.context.extTimerQuery,g=i.q.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=x.createQuery(),x.beginQuery(h.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,F=this.transform.pitch,G=i.q.now(),U=new i.aa(z,{now:G,fadeDuration:w,pitch:F,transition:this.style.transition});this.style.update(U)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(g),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(g);const C=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),C&&(this._placementDirty=C.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,T.mark(b.load),this.fire(new i.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const z=i.q.now()-g;x.endQuery(h.TIME_ELAPSED_EXT),setTimeout(()=>{const F=x.getQueryParameter(s,x.QUERY_RESULT)/1e6;x.deleteQuery(s),this.fire(new i.A("gpu-timing-frame",{cpuTime:z,gpuTime:F}))},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(z);this.fire(new i.A("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const F=this.painter.queryGpuTimeDeferredRender(z);this.fire(new i.A("gpu-timing-deferred-render",{gpuTime:F}))},50)}const O=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(O||this._repaint)this.triggerRepaint();else{const z=this.idle();if(z&&(E=this._updateAverageElevation(g,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new i.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const F=this._calculateSpeedIndex();this.fire(new i.A("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,T.mark(b.fullLoad),this._performanceMetricsCollection&&lr(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const s of this._markers)m&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!m||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(m,s=!1){const h=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(s||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const x=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=m;const E=Math.abs(x-w);if(E>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(w),h(w);this._averageElevation.easeTo(w,m,300)}else if(E>1e-4)return this._averageElevation.jumpTo(w),h(w)}return!!this._averageElevation.isEasing(m)&&h(this._averageElevation.getValue(m))}_authenticate(){gn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===$e||m.status===401)){const s=this.painter.context.gl;kt(s,!1),this._logoControl instanceof Dp&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Tn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Cn(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const h=this.painter.context.gl,g=h.createFramebuffer();function x(w){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,w,0);const E=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,E),E}return h.bindFramebuffer(h.FRAMEBUFFER,g),this._canvasPixelComparison(x(m),s.canvasCopies.map(x),s.timeStamps)}_canvasPixelComparison(m,s,h){let g=h[1]-h[0];const x=m.length/4;for(let w=0;w<s.length;w++){const E=s[w];let C=0;for(let O=0;O<E.length;O+=4)E[O]===m[O]&&E[O+1]===m[O+1]&&E[O+2]===m[O+2]&&E[O+3]===m[O+3]&&(C+=1);g+=(h[w+2]-h[w+1])*(1-C/x)}return g}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),xn.delete(this.painter.context.gl),Nt.remove(),un.remove(),this._removed=!0,this.fire(new i.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=i.q.frame(s=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(s)}))}_preloadTiles(m){const s=this.style?this.style.getSourceCaches():[];return i.bt(s,(h,g)=>h._preloadTiles(m,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,s){i.eJ(m,s)}get version(){return v}},NavigationControl:class{constructor(m={}){this.options=i.l({},UI,m),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(i.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),L("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),L("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:s}):h.resetNorth({},{originalEvent:s}))}),this._compassIcon=L("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const s=m.getZoom(),h=s===m.getMaxZoom(),g=s===m.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zp(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,s){const h=L("button",m,this._container);return h.type="button",h.addEventListener("click",s),h}_setButtonTitle(m,s){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${s}`);m.setAttribute("aria-label",h),m.firstElementChild&&m.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends i.E{constructor(m={}){super();const s=navigator.geolocation;this.options=i.l({geolocation:s},Fp,m),i.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=th(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const s=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,m(h)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(h=>s(h.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(m){const s=this._map.getMaxBounds(),h=m.coords;return!!s&&(h.longitude<s.getWest()||h.longitude>s.getEast()||h.latitude<s.getSouth()||h.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new i.A("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("geolocate",m)),this._finish()}}_updateCamera(m){const s=new i.cd(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,g=this._map.getBearing(),x=i.l({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(h),x,{geolocateSource:!0})}_updateMarker(m){if(m){const s=new i.cd(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,s=i.c6(1,m._center.lat)*m.worldSize,h=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=L("button","mapboxgl-ctrl-geolocate",this._container),L("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L("div","mapboxgl-user-location"),this._dotElement.appendChild(L("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(L("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Np({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=L("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Np({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.A("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ty,ScaleControl:class{constructor(m={}){this.options=i.l({},Ad,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,s=this._map,h=s._containerHeight/2,g=s._containerWidth/2-m/2,x=s.unproject([g,h]),w=s.unproject([g+m,h]),E=x.distanceTo(w);if(this.options.unit==="imperial"){const C=3.2808*E;C>5280?this._setScale(m,C/5280,"mile"):this._setScale(m,C,"foot")}else this.options.unit==="nautical"?this._setScale(m,E/1852,"nautical-mile"):E>=1e3?this._setScale(m,E/1e3,"kilometer"):this._setScale(m,E,"meter")}_setScale(m,s,h){this._map._requestDomTask(()=>{const g=function(w){const E=Math.pow(10,`${Math.floor(w)}`.length-1);let C=w/E;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(O){const z=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*z)/z}(C),E*C}(s),x=g/s;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(g):`${g}&nbsp;${sc[h]}`,this._container.style.width=m*x+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m={}){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:i.w("Full screen control 'container' must be a DOM element.")),i.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=L("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(m){super(),this.options=i.l(Object.create(nl),m),this._altitude=this.options.altitude,i.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new i.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new i.A("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=i.cd.convert(m),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(m){return this._altitude=m,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const s=document.createDocumentFragment(),h=document.createElement("body");let g;for(h.innerHTML=m;g=h.firstChild,g;)s.appendChild(g);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=L("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(m),this.options.closeButton){const h=this._closeButton=L("button","mapboxgl-popup-close-button",s);h.type="button",h.setAttribute("aria-label","Close popup"),h.innerHTML='<span aria-hidden="true">&#215;</span>',h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let s;return this._classList.delete(m)?s=!1:(this._classList.add(m),s=!0),this._updateClassList(),s}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const s=this._map,h=this._container,g=this._pos;if(!s||!h||!g)return"bottom";const x=h.offsetWidth,w=h.offsetHeight,E=g.x<x/2,C=g.x>s.transform.width-x/2;if(g.y+m<w)return E?"top-left":C?"top-right":"top";if(g.y>s.transform.height-w){if(E)return"bottom-left";if(C)return"bottom-right"}return E?"left":C?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),m.className=s.join(" ")}_update(m){const s=this._map,h=this._content;if(!s||!this._lngLat&&!this._trackPointer||!h)return;let g=this._container;if(g||(g=this._container=L("div","mapboxgl-popup",s.getContainer()),this._tip=L("div","mapboxgl-popup-tip",g),g.appendChild(h)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=YS(this._lngLat,this._pos,s.transform)),!this._trackPointer||m){const x=this._pos=this._trackPointer&&m instanceof i.P?m:s.project(this._lngLat,this._altitude),w=ou(this.options.offset),E=this._anchor=this._getAnchor(w.y),C=ou(this.options.offset,E),O=x.add(C).round();s._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${Y0[E]} translate(${O.x}px,${O.y}px)`)})}if(!this._marker&&s._showingGlobe()){const x=i.eK(s.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(rl);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Np,Style:Es,LngLat:i.cd,LngLatBounds:i.aG,Point:i.P,MercatorCoordinate:i.ac,FreeCameraOptions:mg,Evented:i.E,config:i.e,prewarm:i.eP,clearPrewarmedResources:i.eQ,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(m){i.e.ACCESS_TOKEN=m},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(m){i.e.API_URL=m},get workerCount(){return i.eR.workerCount},set workerCount(m){i.eR.workerCount=m},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){i.e.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){i.eS(m)},get workerUrl(){return i.eT.workerUrl},set workerUrl(m){i.eT.workerUrl=m},get workerClass(){return i.eT.workerClass},set workerClass(m){i.eT.workerClass=m},get workerParams(){return i.eT.workerParams},set workerParams(m){i.eT.workerParams=m},get dracoUrl(){return i.eU()},set dracoUrl(m){i.eV(m)},get meshoptUrl(){return i.eW()},set meshoptUrl(m){i.eX(m)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var f=a;return f})})(wne);var Tne=wne.exports;const F7e=Bi(Tne),eKe=zW({__proto__:null,default:F7e},[Tne]),tKe=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{CZe as $,yZe as A,Hqe as B,zHe as C,U7e as D,Uqe as E,sHe as F,rZe as G,tZe as H,aHe as I,Tqe as J,CHe as K,pHe as L,Eqe as M,rH as N,aZe as O,dHe as P,Fqe as Q,oHe as R,Pf as S,hHe as T,sZe as U,xZe as V,_qe as W,AZe as X,PZe as Y,MZe as Z,uZe as _,G7e as a,wHe as a$,IZe as a0,EZe as a1,SZe as a2,TZe as a3,OZe as a4,SHe as a5,bqe as a6,Xqe as a7,ZHe as a8,Sqe as a9,mqe as aA,kHe as aB,Pqe as aC,sqe as aD,BHe as aE,cqe as aF,cZe as aG,$qe as aH,qZe as aI,XZe as aJ,rXe as aK,NHe as aL,iXe as aM,KZe as aN,YZe as aO,JZe as aP,QZe as aQ,eXe as aR,nXe as aS,tXe as aT,oXe as aU,HZe as aV,ZZe as aW,Se as aX,OHe as aY,FHe as aZ,Rqe as a_,DZe as aa,LZe as ab,zZe as ac,RZe as ad,Iqe as ae,Mqe as af,dqe as ag,Zqe as ah,MHe as ai,xqe as aj,JHe as ak,NZe as al,GHe as am,vqe as an,Yqe as ao,fqe as ap,tqe as aq,THe as ar,$Ze as as,UZe as at,BZe as au,jZe as av,GZe as aw,LHe as ax,oqe as ay,Lqe as az,rHe as b,OXe as b$,lZe as b0,Aqe as b1,eqe as b2,IHe as b3,Wqe as b4,_w as b5,uqe as b6,wqe as b7,V7e as b8,AHe as b9,YC as bA,UHe as bB,PHe as bC,Cqe as bD,CXe as bE,EXe as bF,AXe as bG,PXe as bH,jHe as bI,rqe as bJ,Bqe as bK,wXe as bL,rg as bM,lqe as bN,Oqe as bO,eZe as bP,Kqe as bQ,kqe as bR,Vqe as bS,RXe as bT,DXe as bU,NXe as bV,FXe as bW,LXe as bX,zXe as bY,kXe as bZ,MXe as b_,Gqe as ba,QHe as bb,pqe as bc,nZe as bd,zqe as be,iqe as bf,fN as bg,sXe as bh,lXe as bi,dXe as bj,fXe as bk,aXe as bl,cXe as bm,uXe as bn,gXe as bo,vXe as bp,lVe as bq,Vv as br,Gv as bs,_h as bt,p_ as bu,$v as bv,xXe as bw,Jf as bx,CC as by,_Xe as bz,jr as c,Qqe as c0,hqe as c1,gw as c2,Jqe as c3,KHe as c4,nqe as c5,XHe as c6,iZe as c7,bXe as c8,QC as c9,KXe as cA,YXe as cB,JXe as cC,QXe as cD,XXe as cE,oZe as cF,Dqe as cG,aqe as cH,$He as cI,$7e as cJ,j7e as cK,Yle as cL,qXe as cM,sle as cN,tKe as cO,jqe as ca,jXe as cb,$Xe as cc,VZe as cd,YHe as ce,GXe as cf,Nb as cg,wA as ch,X6 as ci,UXe as cj,VXe as ck,$N as cl,WXe as cm,mXe as cn,pXe as co,yXe as cp,TY as cq,EHe as cr,HHe as cs,gqe as ct,yqe as cu,hZe as cv,qHe as cw,Nqe as cx,WHe as cy,HXe as cz,xHe as d,bHe as e,fHe as f,mHe as g,gHe as h,_He as i,he as j,RHe as k,yHe as l,eKe as m,VHe as n,vHe as o,uHe as p,qqe as q,X as r,fZe as s,W7e as t,pZe as u,gZe as v,DHe as w,vZe as x,_Ze as y,mZe as z};
